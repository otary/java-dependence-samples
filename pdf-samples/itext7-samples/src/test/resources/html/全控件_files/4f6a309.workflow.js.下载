var workflow=function(t){function e(n){if(i[n])return i[n].exports;var o=i[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var i={};return e.m=t,e.c=i,e.d=function(t,i,n){e.o(t,i)||Object.defineProperty(t,i,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=1)}([function(t,e){t.exports=fi},function(t,e,i){t.exports=i},function(module,exports,__webpack_require__){module.exports=function(t){function e(n){if(i[n])return i[n].exports;var o=i[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var i={};return e.m=t,e.c=i,e.d=function(t,i,n){e.o(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:n})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,i){if(1&i&&(t=e(t)),8&i)return t;if(4&i&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(e.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&i&&"string"!=typeof t)for(var o in t)e.d(n,o,function(e){return t[e]}.bind(null,o));return n},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s="fb15")}({"00fd":function(t,e,i){function n(t){var e=a.call(t,l),i=t[l];try{t[l]=void 0;var n=!0}catch(t){}var o=s.call(t);return n&&(e?t[l]=i:delete t[l]),o}var o=i("9e69"),r=Object.prototype,a=r.hasOwnProperty,s=r.toString,l=o?o.toStringTag:void 0;t.exports=n},"03dd":function(t,e,i){function n(t){if(!o(t))return r(t);var e=[];for(var i in Object(t))s.call(t,i)&&"constructor"!=i&&e.push(i);return e}var o=i("eac5"),r=i("57a5"),a=Object.prototype,s=a.hasOwnProperty;t.exports=n},"0644":function(t,e,i){function n(t){return o(t,r|a)}var o=i("3818"),r=1,a=4;t.exports=n},"07c7":function(t,e){function i(){return!1}t.exports=i},"087d":function(t,e){function i(t,e){for(var i=-1,n=e.length,o=t.length;++i<n;)t[o+i]=e[i];return t}t.exports=i},"090b":function(t,e,i){"use strict";i.r(e),e.default={workflow:{confirm_submit:"Are you sure to commit",confirm_question:"Are you sure to withdraw?",confirm_title:"Prompt",confirm_btn:"Confirm",cancel_btn:"Cancel",read:"Have been read",tableSaveTip:"The current form also has form data that is not completed",tableHasSave:"Please save the new records in the form first",hangupTip:"The currently pending approval has not been completed and cannot be submitted"},workflow_approve:{tache_cc:"Step circulating",cc_opinion:"Circulate opinions",notify_staff:"Notify staff",return_menu:"Return menu",data_loading:"Data requested, please wait",submit:"Submit",submit_success:"Submit successfully",cc_opinion_null_tip:"The circulation of comments cannot be empty"},workflow_flow_opinion:{save_as_common_opinion:"Save as common opinion",common_opinion:"Common opinion",manager_opinion:"Manager opinion",handle_opinion:"Handle opinion",placeholder:"Please enter your opinion",opinion_is_null_tip:"Opinion cannot be empty",common_opinion_size_exceed_before:"Common opinions cannot exceed",common_opinion_size_exceed_after:"word"},workflow_staff_pick:{region_name:"Region",org_name:"Department",email:"Email",placeholder:"Please enter the employee name, login name, phone number, email address and other information, separated by spaces, such as: Zhang San, Beijing"},workflow_tch_selector_item:{select_other_staff:"+Choose someone",more:"More",packUp:"Pack up",remind_type:"Reminder:",email:"Email",sms:"SMS",switch_on:"Y",switch_off:"N",notifyPlaceholder:"xx work order“xxx content”,Please promptly handle the treatment. xx department xx people x year x month x day",delete_success:"Successfully deleted"},workflow_menu:{more:"More",tchName:"Current TachName"},workflow_dialog:{return_form:"Return form",submit:"Submit",save_success:"Successfully saved",submit_success:"Submitted successfully",select_next_tache_tip:"Please choose the next tache",select_executer_tip_before:"Please choose",select_executer_tip_after:"Executive of the tache",notify_content_tip:"The custom SMS content of the tache cannot be empty."},workflow_exec_desc:{exec_desc:"Execute description:"},workflow_opinion_console:{title:"Configure Personal Opinions",header:"Apply Scope",add:"Add",delete:"Delete",refresh:"Refresh",save:"Save",common_opinion:"Common Opinion",edit:"Edit",current_flow:"Current Process",current_tache:"Current Step",all_flows:"All Processes",common_opinion_is_null_tip:"Typical comments can not be empty",common_opinion_size_tip:"The number of commonly used opinions cannot exceed 100 words."},workflow_process:{show_complete_flow:"Show the complete process",show_layer_flow:"Show this layer process",name:"Name",phs:"Tianyi",mobile:"Mobile",tel:"Telphone",org_name:"Organization",region_name:"Region",opinion:"Opinion",update_time:"Update Time",tch_name:"Step Name",executer:"Processing Staff",handle_opinion:"Processing Opinions",cc_opinion:"Circulate Opinions",attach:"Attach",finish_date:"Complete Time",submit_info:"Submit Information",dispose_time:"Processing Time",group:"Group"},workflow_process_legend:{created:"Created",executed:"Executed",withdrawn:"Withdrawn",executing:"Executing",completed:"Completed",be_created:"The link has been generated and the user has not processed it yet.",be_excuted:"The user has finished executing, but is retrieved by the administrator or himself.",be_withdrawn:"The link has been withdrawn",be_excuting:"The work order pool link, the status of the link after the user receives, indicating that the link is being processed.",be_completed:"The link has been processed normally"},workflow_receiving:{protocol:"Confidentiality agreement",protocol_title:"The recipient hereby agrees to the confidential information disclosed by the disclosing party:",protocol_one:"1. Adhere to the confidentiality of confidential information and take all precautions to protect the confidential information (including but not limited to the measures taken by the recipient to protect its self-contained materials).",protocol_two:"2. Do not disclose any confidential information or any information derived from confidential information to any third party.",protocol_three:"3. Except for the internal evaluation of its relationship with the Disclosing Party, the Confidential Information shall not be used at all times and the Confidential Information shall not be copied or reversed.",protocol_four:"4. The Recipient shall seek to sign a confidentiality agreement or similar agreement between the employee, agent, and subcontractor who accepts the confidential information or has access to the confidential information. The substance of the agreement shall be similar to this Agreement.",protocol_confirm_tip:"Do you accept this agreement?",protocol_confirm_btn:"Receive",protocol_confirm_cancel:"Cancel"},workflow_tch_panel:{next_tache:"NextStep"},workflow_tch_selector:{executer:"Hander",notify_staff:"Notify",recommender:"Recommender"},workflow_candidate:{confirm_delete:"Are you sure you want to remove this person from the usual people?",confirm:"Confirm",cancel:"Cancel"},workflow_upload:{label:"Keep Adding",placeholder:"Please click on the right to add attachments to add",btn_label:"Add attachments",do_error_tip:"File upload failed, please re-upload or contact administrator",error_message:"File upload failed",file_size_exceed_tip:"Upload file size cannot  exceed"},form_rule:{input_tip:"please enter ",lengIn:"length in",to:"to",morethen:"length more than",leng_size_exceed_before:" no more than ",leng_size_exceed_after:"length",must_be_number:" must be a number",decimal_size_exceed_before:"'s decimal number does not exceed",decimal_size_exceed_after:"length",small:"less than",large:"large than"},create_next_tch_info:{common_staff:"Common staff",click_select:"Click to select",recommender:"Recommender"},create_tch_data:{agree:"Agree",disagree:"Disagree",tch_handle:"Link processing"},tool:{error_message_before:"Misconfigured, no ",error_message_after:" 's type of match",update:"update",add:"add",delete:"delete"},workflow_context:{current_tache:"Current Tache:"},workflow_hangup:{submit:"submit",reject:"reject",hangUp:"hang up",hangup_time:"hang up time：",approval_per:"approval person：",hangup_reason:"hang up reason：",approval_reason:"approval advice：",day:"day",hour:"hour",minute:"minute",approvalInfo:"You have a pending message to approve"}}},"0a06":function(t,e,i){"use strict";function n(t){this.defaults=t,this.interceptors={request:new a,response:new a}}var o=i("2444"),r=i("c532"),a=i("f6b4"),s=i("5270");n.prototype.request=function(t){"string"==typeof t&&(t=r.merge({url:arguments[0]},arguments[1])),t=r.merge(o,{method:"get"},this.defaults,t),t.method=t.method.toLowerCase();var e=[s,void 0],i=Promise.resolve(t);for(this.interceptors.request.forEach(function(t){e.unshift(t.fulfilled,t.rejected)}),this.interceptors.response.forEach(function(t){e.push(t.fulfilled,t.rejected)});e.length;)i=i.then(e.shift(),e.shift());return i},r.forEach(["delete","get","head","options"],function(t){n.prototype[t]=function(e,i){return this.request(r.merge(i||{},{method:t,url:e}))}}),r.forEach(["post","put","patch"],function(t){n.prototype[t]=function(e,i,n){return this.request(r.merge(n||{},{method:t,url:e,data:i}))}}),t.exports=n},"0b07":function(t,e,i){function n(t,e){var i=r(t,e);return o(i)?i:void 0}var o=i("34ac"),r=i("3698");t.exports=n},"0d24":function(t,e,i){(function(t){var n=i("2b3e"),o=i("07c7"),r=e&&!e.nodeType&&e,a=r&&"object"==typeof t&&t&&!t.nodeType&&t,s=a&&a.exports===r,l=s?n.Buffer:void 0,h=l?l.isBuffer:void 0,c=h||o;t.exports=c}).call(this,i("62e4")(t))},"0df6":function(t,e,i){"use strict";t.exports=function(t){return function(e){return t.apply(null,e)}}},"0f0f":function(t,e,i){function n(t,e){return t&&o(e,r(e),t)}var o=i("8eeb"),r=i("9934");t.exports=n},1041:function(t,e,i){function n(t,e){return o(t,r(t),e)}var o=i("8eeb"),r=i("a029");t.exports=n},1290:function(t,e){function i(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}t.exports=i},1310:function(t,e){function i(t){return null!=t&&"object"==typeof t}t.exports=i},1368:function(t,e,i){function n(t){return!!r&&r in t}var o=i("da03"),r=function(){var t=/[^.]+$/.exec(o&&o.keys&&o.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();t.exports=n},"1a2d":function(t,e,i){function n(t){return r(t)&&o(t)==a}var o=i("42a2"),r=i("1310"),a="[object Map]";t.exports=n},"1a8c":function(t,e){function i(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}t.exports=i},"1bac":function(t,e,i){function n(t){return o(t,a,r)}var o=i("7d1f"),r=i("a029"),a=i("9934");t.exports=n},"1cec":function(t,e,i){var n=i("0b07"),o=i("2b3e"),r=n(o,"Promise");t.exports=r},"1d2b":function(t,e,i){"use strict";t.exports=function(t,e){return function(){for(var i=new Array(arguments.length),n=0;n<i.length;n++)i[n]=arguments[n];return t.apply(e,i)}}},"1efc":function(t,e){function i(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}t.exports=i},"1fc8":function(t,e,i){function n(t,e){var i=o(this,t),n=i.size;return i.set(t,e),this.size+=i.size==n?0:1,this}var o=i("4245");t.exports=n},2166:function(t,e){t.exports=__webpack_require__(3)},2444:function(t,e,i){"use strict";(function(e){function n(t,e){!o.isUndefined(t)&&o.isUndefined(t["Content-Type"])&&(t["Content-Type"]=e)}var o=i("c532"),r=i("c8af"),a={"Content-Type":"application/x-www-form-urlencoded"},s={adapter:function(){var t;return"undefined"!=typeof XMLHttpRequest?t=i("b50d"):void 0!==e&&(t=i("b50d")),t}(),transformRequest:[function(t,e){return r(e,"Content-Type"),o.isFormData(t)||o.isArrayBuffer(t)||o.isBuffer(t)||o.isStream(t)||o.isFile(t)||o.isBlob(t)?t:o.isArrayBufferView(t)?t.buffer:o.isURLSearchParams(t)?(n(e,"application/x-www-form-urlencoded;charset=utf-8"),t.toString()):o.isObject(t)?(n(e,"application/json;charset=utf-8"),JSON.stringify(t)):t}],transformResponse:[function(t){if("string"==typeof t)try{t=JSON.parse(t)}catch(t){}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(t){return t>=200&&t<300}};s.headers={common:{Accept:"application/json, text/plain, */*"}},o.forEach(["delete","get","head"],function(t){s.headers[t]={}}),o.forEach(["post","put","patch"],function(t){s.headers[t]=o.merge(a)}),t.exports=s}).call(this,i("f28c"))},2474:function(t,e,i){var n=i("2b3e"),o=n.Uint8Array;t.exports=o},2478:function(t,e,i){function n(t){return o(this,t).get(t)}var o=i("4245");t.exports=n},2524:function(t,e,i){function n(t,e){var i=this.__data__;return this.size+=this.has(t)?0:1,i[t]=o&&void 0===e?r:e,this}var o=i("6044"),r="__lodash_hash_undefined__";t.exports=n},"253c":function(t,e,i){function n(t){return r(t)&&o(t)==a}var o=i("3729"),r=i("1310"),a="[object Arguments]";t.exports=n},"28c9":function(t,e){function i(){this.__data__=[],this.size=0}t.exports=i},"29f3":function(t,e){function i(t){return o.call(t)}var n=Object.prototype,o=n.toString;t.exports=i},"2b3e":function(t,e,i){var n=i("585a"),o="object"==typeof self&&self&&self.Object===Object&&self,r=n||o||Function("return this")();t.exports=r},"2d7c":function(t,e){function i(t,e){for(var i=-1,n=null==t?0:t.length,o=0,r=[];++i<n;){var a=t[i];e(a,i,t)&&(r[o++]=a)}return r}t.exports=i},"2d83":function(t,e,i){"use strict";var n=i("387f");t.exports=function(t,e,i,o,r){var a=new Error(t);return n(a,e,i,o,r)}},"2dcb":function(t,e,i){var n=i("91e9"),o=n(Object.getPrototypeOf,Object);t.exports=o},"2e67":function(t,e,i){"use strict";t.exports=function(t){return!(!t||!t.__CANCEL__)}},"2ee6":function(t,e,i){"use strict";function n(t,e,i,n,o){var r=!n&&g(i);return t.reduce(function(i,n){var a=n.name;return i.tableMap[a]={},t.length>1&&(i.model[a]={},i.rules[a]={},i.appendRules[a]={},i.attrs[a]={},i.append[a]={},i.tableFields[a]=[]),n.field.reduce(function(i,n){var s=n.elementName,l=n.fieldName,c=n.isAppend,d=n.elementType;return i.tableMap[a][l]=s,t.length>1?(i.model[a][s]=f(n),i.attrs[a][s]=_(n,e,r,o),"T"===c&&(i.appendRules[a][s]=u(n),i.append[a][s]=!0),i.rules[a][s]=u(n),d===h.table&&i.tableFields[a].push(s)):(i.model[s]=f(n),i.attrs[s]=_(n,e,r,o),"T"===c&&(i.appendRules[s]=u(n),i.append[s]=!0),i.rules[s]=u(n),d===h.table&&i.tableFields.push(s)),i},i),i},{model:{},tableMap:{},rules:{},attrs:{},append:{},appendRules:{},tableFields:[]})}function o(t){s=t}function r(){return s}function a(t,e,i,n){var o=!n&&g(i),r=!1;return"T"===e||o?r=!0:t.forEach(function(t){if(!r){var e=t.field.filter(function(t){return"F"===t.isAppend});r=e.every(function(t){return"T"===t.isReadOnly})}}),r}i.d(e,"a",function(){return n}),i.d(e,"d",function(){return o}),i.d(e,"b",function(){return r}),i.d(e,"c",function(){return a});var s,l=i("4642"),h={input:"1",textarea:"2",select:"3",multipleSelect:"4",hide:"5",radio:"6",checkbox:"7",date:"8",selectTree:"9",attach:"12",attaches:"13",richText:"20",staffSelect:"24",cmdbStaffSelect:"27",cmdbCommonSelect:"29",cmdbSystemSelect:"30",table:"38"},c=function(t){var e=t.match(/[^\x00-\xff]/gi);return t.length+(null===e?0:e.length)},u=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=t.fieldType,n=t.fieldLength,o=t.fieldScale,r=t.isEmpty,a=t.isRequire,l=t.elementLabel,h=t.elementNameCn,u=t.elementType,d=t.fieldRule,f=["change","blur"],p=["1","2","14"].includes(u),g=[];return e&&("F"===r||"T"===a)&&g.push({required:!0,message:"".concat(s("form_rule.input_tip")).concat(l||h),trigger:f}),!e&&"T"===a&&g.push({required:!0,message:"".concat(s("form_rule.input_tip")).concat(l||h),trigger:f}),"VARCHAR2"===i&&p&&g.push({validator:function(t,e,i){e&&"string"==typeof e&&c(e)>n?i("".concat(l||h).concat(s("form_rule.leng_size_exceed_before")," ").concat(n," ").concat(s("form_rule.leng_size_exceed_after"))):i()},trigger:f}),"NUMBER"===i&&p&&g.push({validator:function(t,e,i){if(isNaN(e))i(new Error("".concat(l||h).concat(s("form_rule.must_be_number"))));else if(o){var n="".concat(e).split(".")[1];n&&n.length>o&&i(new Error("".concat(l||h).concat(s("form_rule.decimal_size_exceed_before")," ").concat(o," ").concat(s("form_rule.decimal_size_exceed_after"))))}if(d&&(d.minVal||d.maxVal)){var r=Number(d.minVal||0),a=Number(d.maxVal);e&&Number(e)&&(Number(e)<r||Number(e)>a)?i(new Error("".concat(l||h).concat(s("form_rule.small")," ").concat(r," ").concat(s("form_rule.large")).concat(a))):i()}else i()},trigger:f}),"VARCHAR2"===i&&p&&d&&(d.minVal||d.maxVal)&&g.push({min:Number(d.minVal||0),max:d.maxVal&&Number(d.maxVal),message:d.maxVal?"".concat(s("form_rule.lengIn")).concat(d.minVal).concat(s("form_rule.to")).concat(d.maxVal).concat(s("form_rule.leng_size_exceed_after")):"".concat(s("form_rule.morethen")).concat(d.minVal).concat(s("form_rule.leng_size_exceed_after"))}),d&&d.regExp&&g.push({pattern:d.regExp,message:d.regExpDesc,trigger:f}),g},d=function(t){var e=function(t){var e=Object(l.f)(t),i=e.isChange,n=e.changeValue,o=t.elementType,r=t.value;switch(o){case h.multipleSelect:case h.checkbox:return"T"===i?n?n.split(","):[]:r?r.split(","):[];case h.attach:case h.attaches:return"T"===i?n||[]:r||[];default:return"T"===i?n:r}};return{name:t.name,formId:t.formId,field:t.field.map(function(t){var i=t.elementName,n=t.elementNameLabel,o=t.elementNameCn,r=t.elementType,a=t.param,s=u(t,!0),l=e(t);return{prop:i,label:o,labelUs:n,elementType:r,options:a||[],rules:s,value:l}})}},f=function(t){var e=Object(l.f)(t),i=e.isChange,n=e.changeValue,o=t.elementType,r=t.value;switch(o){case h.multipleSelect:case h.checkbox:return"T"===i?n?n.split(","):[]:r?r.split(","):[];case h.attach:case h.attaches:return"T"===i?n||[]:r||[];case h.table:return r?d(r):[];default:return"T"===i?n:r}},p=function(t){return t?[{key:"YYYY",value:"yyyy",i:!1},{key:"-mm",value:"-MM",i:!1},{key:"-DD",value:"-dd",i:!1},{key:"HH",value:"hh",i:!1},{key:"hh12",value:"hh",i:!1},{key:"hh12",value:"hh",i:!1},{key:"hh24",value:"HH",i:!1},{key:"mi",value:"mm",i:!0},{key:"SS",value:"ss",i:!1}].reduce(function(t,e){var i=e.i?RegExp(e.key,"i"):RegExp(e.key);return t.replace(i,e.value)},t):t},g=function(t){return t.isEnableForword()},_=function(t,e,i,n){var o,r=Object(l.f)(t),a=r.isChange,s=t.isShow,h=t.isReadOnly,c=t.isAppend,u=t.elementNameCn,d=t.param,f=t.fieldFormat,g=t.elementLabel,_=t.elementUnits,m=t.attr,v=t.elementType,y=t.value,w=t.label,b=n;o=h?"T"===h:"R"===e,("T"===b||i)&&(o=!0);var x={isAppend:"T"===c,disabled:o,isChange:a,elementUnits:_,isShow:"T"===s,label:g||u,elementType:v,value:y,valueLabel:w,fieldFormat:p(f)};return x.options=d||[],x.attr=m||{},x}},"2f6e":function(t,e,i){"use strict";i.r(e),e.default={workflow:{confirm_submit:"确定提交吗？",confirm_question:"确定撤回吗？",confirm_title:"提示",confirm_btn:"确定",cancel_btn:"取消",read:"已阅毕",tableSaveTip:"当前表单还有表格数据未填写完整",tableHasSave:"请先保存表格中新增的记录",hangupTip:"当前挂起的审批尚未完成，无法提交"},workflow_approve:{tache_cc:"环节传阅",cc_opinion:"传阅意见",notify_staff:"抄送人",return_menu:"返回菜单",data_loading:"数据请求中，请稍后",submit:"提 交",submit_success:"提交成功",cc_opinion_null_tip:"传阅意见不能为空"},workflow_flow_opinion:{save_as_common_opinion:"保存为常用意见",common_opinion:"常用意见",manager_opinion:"管理意见",handle_opinion:"处理意见",placeholder:"请输入处理意见",opinion_is_null_tip:"处理意见不能为空",common_opinion_size_exceed_before:"常用意见不能超过",common_opinion_size_exceed_after:"个字"},workflow_staff_pick:{region_name:"区域",org_name:"部门",email:"邮箱",placeholder:"请输入员工姓名、登录名、电话、邮箱等信息查询，中间利用空格隔开，如:张三,北京"},workflow_tch_selector_item:{select_other_staff:"+选择其他人",more:"更多",packUp:"收起",remind_type:"提醒方式:",email:"邮件",sms:"短信",switch_on:"是",switch_off:"否",notifyPlaceholder:"xx工单“xxx内容”,请您及时督促处理 xx部门 xx人 x年x月x日",delete_success:"删除成功"},workflow_menu:{more:"更多",tchName:"当前环节"},workflow_dialog:{return_form:"返回表单",submit:"提交",save_success:"保存成功",submit_success:"提交成功",select_next_tache_tip:"请选择下一环节",select_executer_tip_before:"请选择",select_executer_tip_after:"环节的执行人",notify_content_tip:"环节的自定义短信内容不能为空"},workflow_exec_desc:{exec_desc:"执行说明："},workflow_opinion_console:{title:"配置个人常用意见",header:"应用范围",add:"新增",delete:"删除",refresh:"刷新",save:"保存",common_opinion:"常用意见",edit:"编辑",current_flow:"当前流程",current_tache:"当前环节",all_flows:"所有流程",common_opinion_is_null_tip:"常用意见不能为空",common_opinion_size_tip:"常用意见字数不能超过100字"},workflow_process:{show_complete_flow:"展示完整流程",show_layer_flow:"展示本层流程",name:"姓名",phs:"天翼",mobile:"固话",tel:"其他手机",org_name:"组织架构",region_name:"区域",opinion:"意见",update_time:"修改时间",tch_name:"环节名称",executer:"处理人员",handle_opinion:"处理意见",cc_opinion:"传阅意见",attach:"附件",finish_date:"完成时间",submit_info:"提交信息",dispose_time:"处理时长",group:"集团"},workflow_process_legend:{created:"已创建",executed:"已执行",withdrawn:"已撤回",executing:"执行中",completed:"竣工",be_created:"环节已生成,用户还未处理",be_excuted:"用户已执行完毕，但被管理员,或者自己取回重新处理",be_withdrawn:"环节已被撤回",be_excuting:"工单池环节,用户接收后的环节状态,表示环节正在处理中",be_completed:"环节已正常结束处理"},workflow_receiving:{protocol:"保密协议",protocol_title:"对披露方披露的保密资料，接受方在此同意：",protocol_one:"1. 严守保密资料机密，并采取所有预防措施保护该保密资料（包括但不仅限于接受方为保护其自有机密材料所采用的措施）。",protocol_two:"2. 不泄露任何保密资料或源自于保密资料的任何资料给任何第三方。",protocol_three:"3. 除用于内部评估其与披露方的关系之外，任何时候均不得利用该保密资料，以及不复制或颠倒设计该保密资料。",protocol_four:"4.接受方应争取其接受保密资料或能接触保密资料的雇员、代理、和分包商签订一份保密协议或类似的协议，此协议的实质内容应与本协议相似。",protocol_confirm_tip:"请问您是否接收此协议？",protocol_confirm_btn:"接收",protocol_confirm_cancel:"取消"},workflow_tch_panel:{next_tache:"后续环节"},workflow_tch_selector:{executer:"处理人",notify_staff:"抄送人",recommender:"推荐人"},workflow_candidate:{confirm_delete:"确定将该人员从常用人员中删除吗？",confirm:"确定",cancel:"取消"},workflow_upload:{label:"继续添加",placeholder:"请点击右侧添加附件进行添加",btn_label:"添加附件",do_error_tip:"文件上传失败，请重新上传或联系管理员",error_message:"文件上传失败",file_size_exceed_tip:"上传文件大小不能超过"},form_rule:{input_tip:"请输入",lengIn:"长度在",to:"到",morethen:"长度至少",leng_size_exceed_before:"长度不超过",leng_size_exceed_after:"个字符",must_be_number:"必须是数字",decimal_size_exceed_before:"小数不超过",decimal_size_exceed_after:"位",small:"必须小于",large:"大于"},create_next_tch_info:{common_staff:"常用人员",click_select:"单击选人",recommender:"推荐人员"},create_tch_data:{agree:"同意",disagree:"不同意",tch_handle:"环节处理"},tool:{error_message_before:"配置有误，没有",error_message_after:"匹配的类型",update:"修改",add:"新增",delete:"删除"},workflow_context:{current_tache:"当前环节:"},workflow_hangup:{submit:"提交",reject:"驳回",hangUp:"挂起",hangup_time:"挂起时间：",approval_per:"审批人员：",hangup_reason:"挂起原因：",approval_reason:"审批意见：",day:"天",hour:"小时",minute:"分钟",approvalInfo:"您有一条挂起信息需要 审批"}}},"2fcc":function(t,e){function i(t){var e=this.__data__,i=e.delete(t);return this.size=e.size,i}t.exports=i},"30b5":function(t,e,i){"use strict";function n(t){return encodeURIComponent(t).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var o=i("c532");t.exports=function(t,e,i){if(!e)return t;var r;if(i)r=i(e);else if(o.isURLSearchParams(e))r=e.toString();else{var a=[];o.forEach(e,function(t,e){null!==t&&void 0!==t&&(o.isArray(t)?e+="[]":t=[t],o.forEach(t,function(t){o.isDate(t)?t=t.toISOString():o.isObject(t)&&(t=JSON.stringify(t)),a.push(n(e)+"="+n(t))}))}),r=a.join("&")}return r&&(t+=(-1===t.indexOf("?")?"?":"&")+r),t}},"30c9":function(t,e,i){function n(t){return null!=t&&r(t.length)&&!o(t)}var o=i("9520"),r=i("b218");t.exports=n},"323e":function(t,e,i){var n,o;!function(r,a){n=a,void 0!==(o="function"==typeof n?n.call(e,i,e,t):n)&&(t.exports=o)}(0,function(){function t(t,e,i){return t<e?e:t>i?i:t}function e(t){return 100*(-1+t)}function i(t,i,n){var o;return o="translate3d"===h.positionUsing?{transform:"translate3d("+e(t)+"%,0,0)"}:"translate"===h.positionUsing?{transform:"translate("+e(t)+"%,0)"}:{"margin-left":e(t)+"%"},o.transition="all "+i+"ms "+n,o}function n(t,e){return("string"==typeof t?t:a(t)).indexOf(" "+e+" ")>=0}function o(t,e){var i=a(t),o=i+e;n(i,e)||(t.className=o.substring(1))}function r(t,e){var i,o=a(t);n(t,e)&&(i=o.replace(" "+e+" "," "),t.className=i.substring(1,i.length-1))}function a(t){return(" "+(t.className||"")+" ").replace(/\s+/gi," ")}function s(t){t&&t.parentNode&&t.parentNode.removeChild(t)}var l={};l.version="0.2.0";var h=l.settings={minimum:.08,easing:"ease",positionUsing:"",speed:200,trickle:!0,trickleRate:.02,trickleSpeed:800,showSpinner:!0,barSelector:'[role="bar"]',spinnerSelector:'[role="spinner"]',parent:"body",template:'<div class="bar" role="bar"><div class="peg"></div></div><div class="spinner" role="spinner"><div class="spinner-icon"></div></div>'};l.configure=function(t){var e,i;for(e in t)void 0!==(i=t[e])&&t.hasOwnProperty(e)&&(h[e]=i);return this},l.status=null,l.set=function(e){var n=l.isStarted();e=t(e,h.minimum,1),l.status=1===e?null:e;var o=l.render(!n),r=o.querySelector(h.barSelector),a=h.speed,s=h.easing;return o.offsetWidth,c(function(t){""===h.positionUsing&&(h.positionUsing=l.getPositioningCSS()),u(r,i(e,a,s)),1===e?(u(o,{transition:"none",opacity:1}),o.offsetWidth,setTimeout(function(){u(o,{transition:"all "+a+"ms linear",opacity:0}),setTimeout(function(){l.remove(),t()},a)},a)):setTimeout(t,a)}),this},l.isStarted=function(){return"number"==typeof l.status},l.start=function(){l.status||l.set(0);var t=function(){setTimeout(function(){l.status&&(l.trickle(),t())},h.trickleSpeed)};return h.trickle&&t(),this},l.done=function(t){return t||l.status?l.inc(.3+.5*Math.random()).set(1):this},l.inc=function(e){var i=l.status;return i?("number"!=typeof e&&(e=(1-i)*t(Math.random()*i,.1,.95)),i=t(i+e,0,.994),l.set(i)):l.start()},l.trickle=function(){return l.inc(Math.random()*h.trickleRate)},function(){var t=0,e=0;l.promise=function(i){return i&&"resolved"!==i.state()?(0===e&&l.start(),t++,e++,i.always(function(){e--,0===e?(t=0,l.done()):l.set((t-e)/t)}),this):this}}(),l.render=function(t){if(l.isRendered())return document.getElementById("nprogress");o(document.documentElement,"nprogress-busy");var i=document.createElement("div");i.id="nprogress",i.innerHTML=h.template;var n,r=i.querySelector(h.barSelector),a=t?"-100":e(l.status||0),c=document.querySelector(h.parent);return u(r,{transition:"all 0 linear",transform:"translate3d("+a+"%,0,0)"}),h.showSpinner||(n=i.querySelector(h.spinnerSelector))&&s(n),c!=document.body&&o(c,"nprogress-custom-parent"),c.appendChild(i),i},l.remove=function(){r(document.documentElement,"nprogress-busy"),r(document.querySelector(h.parent),"nprogress-custom-parent");var t=document.getElementById("nprogress");t&&s(t)},l.isRendered=function(){return!!document.getElementById("nprogress")},l.getPositioningCSS=function(){var t=document.body.style,e="WebkitTransform"in t?"Webkit":"MozTransform"in t?"Moz":"msTransform"in t?"ms":"OTransform"in t?"O":"";return e+"Perspective"in t?"translate3d":e+"Transform"in t?"translate":"margin"};var c=function(){function t(){var i=e.shift();i&&i(t)}var e=[];return function(i){e.push(i),1==e.length&&t()}}(),u=function(){function t(t){return t.replace(/^-ms-/,"ms-").replace(/-([\da-z])/gi,function(t,e){return e.toUpperCase()})}function e(t){var e=document.body.style;if(t in e)return t;for(var i,n=o.length,r=t.charAt(0).toUpperCase()+t.slice(1);n--;)if((i=o[n]+r)in e)return i;return t}function i(i){return i=t(i),r[i]||(r[i]=e(i))}function n(t,e,n){e=i(e),t.style[e]=n}var o=["Webkit","O","Moz","ms"],r={};return function(t,e){var i,o,r=arguments;if(2==r.length)for(i in e)void 0!==(o=e[i])&&e.hasOwnProperty(i)&&n(t,i,o);else n(t,r[1],r[2])}}();return l})},"32b3":function(t,e,i){function n(t,e,i){var n=t[e];s.call(t,e)&&r(n,i)&&(void 0!==i||e in t)||o(t,e,i)}var o=i("872a"),r=i("9638"),a=Object.prototype,s=a.hasOwnProperty;t.exports=n},"32f4":function(t,e,i){var n=i("2d7c"),o=i("d327"),r=Object.prototype,a=r.propertyIsEnumerable,s=Object.getOwnPropertySymbols,l=s?function(t){return null==t?[]:(t=Object(t),n(s(t),function(e){return a.call(t,e)}))}:o;t.exports=l},"34ac":function(t,e,i){function n(t){return!(!a(t)||r(t))&&(o(t)?p:h).test(s(t))}var o=i("9520"),r=i("1368"),a=i("1a8c"),s=i("dc57"),l=/[\\^$.*+?()[\]{}|]/g,h=/^\[object .+?Constructor\]$/,c=Function.prototype,u=Object.prototype,d=c.toString,f=u.hasOwnProperty,p=RegExp("^"+d.call(f).replace(l,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");t.exports=n},3698:function(t,e){function i(t,e){return null==t?void 0:t[e]}t.exports=i},3729:function(t,e,i){function n(t){return null==t?void 0===t?l:s:h&&h in Object(t)?r(t):a(t)}var o=i("9e69"),r=i("00fd"),a=i("29f3"),s="[object Null]",l="[object Undefined]",h=o?o.toStringTag:void 0;t.exports=n},3818:function(t,e,i){function n(t,e,i,O,D,M){var N,B=e&T,F=e&k,z=e&S;if(i&&(N=D?i(t,O,D,M):i(t)),void 0!==N)return N;if(!x(t))return t;var V=y(t);if(V){if(N=_(t),!B)return c(t,N)}else{var U=g(t),j=U==I||U==L;if(w(t))return h(t,B);if(U==R||U==E||j&&!D){if(N=F||j?{}:v(t),!B)return F?d(t,l(N,t)):u(t,s(N,t))}else{if(!P[U])return D?t:{};N=m(t,U,B)}}M||(M=new o);var H=M.get(t);if(H)return H;M.set(t,N),A(t)?t.forEach(function(o){N.add(n(o,e,i,o,t,M))}):b(t)&&t.forEach(function(o,r){N.set(r,n(o,e,i,r,t,M))});var W=z?F?p:f:F?keysIn:C,G=V?void 0:W(t);return r(G||t,function(o,r){G&&(r=o,o=t[r]),a(N,r,n(o,e,i,r,t,M))}),N}var o=i("7e64"),r=i("8057"),a=i("32b3"),s=i("5b01"),l=i("0f0f"),h=i("e538"),c=i("4359"),u=i("54eb"),d=i("1041"),f=i("a994"),p=i("1bac"),g=i("42a2"),_=i("c87c"),m=i("c2b6"),v=i("fa21"),y=i("6747"),w=i("0d24"),b=i("cc45"),x=i("1a8c"),A=i("d7ee"),C=i("ec69"),T=1,k=2,S=4,E="[object Arguments]",I="[object Function]",L="[object GeneratorFunction]",R="[object Object]",P={};P[E]=P["[object Array]"]=P["[object ArrayBuffer]"]=P["[object DataView]"]=P["[object Boolean]"]=P["[object Date]"]=P["[object Float32Array]"]=P["[object Float64Array]"]=P["[object Int8Array]"]=P["[object Int16Array]"]=P["[object Int32Array]"]=P["[object Map]"]=P["[object Number]"]=P[R]=P["[object RegExp]"]=P["[object Set]"]=P["[object String]"]=P["[object Symbol]"]=P["[object Uint8Array]"]=P["[object Uint8ClampedArray]"]=P["[object Uint16Array]"]=P["[object Uint32Array]"]=!0,P["[object Error]"]=P[I]=P["[object WeakMap]"]=!1,t.exports=n},"387f":function(t,e,i){"use strict";t.exports=function(t,e,i,n,o){return t.config=e,i&&(t.code=i),t.request=n,t.response=o,t}},3934:function(t,e,i){"use strict";var n=i("c532");t.exports=n.isStandardBrowserEnv()?function(){function t(t){var e=t;return i&&(o.setAttribute("href",e),e=o.href),o.setAttribute("href",e),{href:o.href,protocol:o.protocol?o.protocol.replace(/:$/,""):"",host:o.host,search:o.search?o.search.replace(/^\?/,""):"",hash:o.hash?o.hash.replace(/^#/,""):"",hostname:o.hostname,port:o.port,pathname:"/"===o.pathname.charAt(0)?o.pathname:"/"+o.pathname}}var e,i=/(msie|trident)/i.test(navigator.userAgent),o=document.createElement("a");return e=t(window.location.href),function(i){var o=n.isString(i)?t(i):i;return o.protocol===e.protocol&&o.host===e.host}}():function(){return function(){return!0}}()},"39ff":function(t,e,i){var n=i("0b07"),o=i("2b3e"),r=n(o,"WeakMap");t.exports=r},"3b4a":function(t,e,i){var n=i("0b07"),o=function(){try{var t=n(Object,"defineProperty");return t({},"",{}),t}catch(t){}}();t.exports=o},"41c3":function(t,e,i){function n(t){if(!o(t))return a(t);var e=r(t),i=[];for(var n in t)("constructor"!=n||!e&&l.call(t,n))&&i.push(n);return i}var o=i("1a8c"),r=i("eac5"),a=i("ec8c"),s=Object.prototype,l=s.hasOwnProperty;t.exports=n},4245:function(t,e,i){function n(t,e){var i=t.__data__;return o(e)?i["string"==typeof e?"string":"hash"]:i.map}var o=i("1290");t.exports=n},"42a2":function(t,e,i){var n=i("b5a7"),o=i("79bc"),r=i("1cec"),a=i("c869"),s=i("39ff"),l=i("3729"),h=i("dc57"),c=h(n),u=h(o),d=h(r),f=h(a),p=h(s),g=l;(n&&"[object DataView]"!=g(new n(new ArrayBuffer(1)))||o&&"[object Map]"!=g(new o)||r&&"[object Promise]"!=g(r.resolve())||a&&"[object Set]"!=g(new a)||s&&"[object WeakMap]"!=g(new s))&&(g=function(t){var e=l(t),i="[object Object]"==e?t.constructor:void 0,n=i?h(i):"";if(n)switch(n){case c:return"[object DataView]";case u:return"[object Map]";case d:return"[object Promise]";case f:return"[object Set]";case p:return"[object WeakMap]"}return e}),t.exports=g},4359:function(t,e){function i(t,e){var i=-1,n=t.length;for(e||(e=Array(n));++i<n;)e[i]=t[i];return e}t.exports=i},4642:function(module,__webpack_exports__,__webpack_require__){"use strict";function _typeof(t){"@babel/helpers - typeof";return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function genrateJSExpr(t){var e=t;return(t.match(/(([_$a-zA-Z][_$a-zA-Z0-9]*\.)?[_$a-zA-Z][_$a-zA-Z0-9]*)\(/g)||[]).forEach(function(t){e=e.replace(t,"this.".concat(t))}),e}function execCustomJs(){var func=eval(arguments[0]);return"function"==typeof func?func():func}function generateJavaParam(t){var e=t.match(/([\w.]+\.)(\w+)\((([^,]*,?)*)\)/),i=e&&e[3]?e[3].split(",").map(function(t){var e=t;return"string"==typeof t&&(e=t.trim(),e=e.replace(/^'(.*)'$|^"(.*)"$/,function(t,e,i){return e||i})),e="null"===e?null:e}):[];return{type:"java",event:t,class:e&&e[1].substr(0,e[1].length-1),method:e&&e[2],param:i}}function generateSqlParam(t,e,i){var n=t.activeParams.length?t.activeParams.map(function(t){var e=t;return"string"==typeof t&&(e=t.trim()),e="null"===e?null:e}):void 0,o={exprName:i,params:n,exprType:"DEFAULT_FLOW_NAME_VALUE"===i?"flowModelAttr":"tchModelAttr"};return"DEFAULT_FLOW_NAME_VALUE"===i?o.flowMod=e.flow.flowMod:o.tchMod=e.nextItemTchMod||e.flow.tchMod,o}function execExpression(t,e,i){switch(e){case ScriptType.form:case ScriptType.fix:return t.template;case ScriptType.js:var n=genrateJSExpr(t.template);try{return execCustomJs.call(i,n)}catch(t){return Object(ffitm_vue_ui__WEBPACK_IMPORTED_MODULE_0__.Message)({message:t.message,type:"error"}),console.error(t)}case ScriptType.sqlFunc:case ScriptType.sqlProc:return{type:e,event:t.template};case ScriptType.java:return generateJavaParam(t.template);default:return t.template}}function execAsyncExpression(t,e,i,n){var o=Object(_createFormData__WEBPACK_IMPORTED_MODULE_3__.b)();switch(e){case ScriptType.form:case ScriptType.fix:return new Promise(function(e){e(t.template)});case ScriptType.js:var r=genrateJSExpr(t.template);return new Promise(function(t,e){try{return t(execCustomJs.call(i.context,r))}catch(t){return Object(ffitm_vue_ui__WEBPACK_IMPORTED_MODULE_0__.Message)({message:t.message,type:"error"}),console.error(t),e(t)}});case ScriptType.sqlFunc:var a=generateSqlParam(t,i,n);return Object(_api_workflow__WEBPACK_IMPORTED_MODULE_2__.w)(a);case ScriptType.sqlProc:var s=generateSqlParam(t,i,n);return Object(_api_workflow__WEBPACK_IMPORTED_MODULE_2__.l)(s);default:return new Promise(function(t,i){i(new Error("".concat(o("tool.error_message_before")).concat(e).concat(o("tool.error_message_after"))))})}}function matchJsParam(t,e){var i=new RegExp("{([^{}]*)}",e);return t.match(i)}function matchDynamicParam(t){return t.match(/\$(\w+\.)*(\w+)|formContext\.(\w+\.)*(\w+)|{([^{}]*)}/g)||[]}function renderTemplate(t,e,i,n){if("fix"===e)return{template:t};var o=n||i.context,r=matchDynamicParam(t),a=[];return{template:r.reduce(function(t,r){var s=i,l=matchJsParam(r);if(l){var h=l[1];matchDynamicParam(h).length&&(h=renderTemplate(h,e,i,n).template),s=execExpression({template:h},"js",o)}else{var c="$"===r[0]?r.substr(1).split("."):r.replace(/formContext\./,"").split(".");"QUERY"===c[0]?(s=s.query,c[1]&&(s=s[c[1]]||"")):(c.forEach(function(t){s=s[Object(_index__WEBPACK_IMPORTED_MODULE_1__.f)(t)]}),/^\$TABLE\./.test(r)&&Array.isArray(s)&&(s=s.length?JSON.stringify(s):""))}if("object"===_typeof(s)&&s&&(s=JSON.stringify(s)),s=null===s||void 0===s?"":s,!["fix","form"].includes(e)&&"".concat(s).includes("'")){var u=["java","js"].includes(e)?"\\'":"''";s=s.replace(/'/g,u)}return a.push(s),t.replace(r,s)},t),activeParams:a}}function getExpressionValue(t){var e=t.template,i=t.type,n=t.$global;if(e&&i){return execExpression(renderTemplate(e,i,n),i,n.context)}return e}function getExpressionValueToParam(t){var e=t.template,i=t.type,n=t.$global;if(e&&i){return execExpression(renderTemplate(e,i,n),i,n.context)}return null}function getAsyncExpressionValue(t){var e=t.template,i=t.type,n=t.$global,o=t.nullValue,r=t.key;if(i&&"rule"===i&&"defaultStaffName"!==r)return new Promise(function(t){t(n.context.parent.getConditionCampare(o.tchMod,o.ruleType,r,o.opinionCfg))});if(e&&i){return execAsyncExpression(renderTemplate(e,i,n),i,n,Object(_index__WEBPACK_IMPORTED_MODULE_1__.a)(r))}return new Promise(function(t){return t(o)})}function excJsExpression(t,e,i){if(t&&e&&i){return execExpression(renderTemplate(t,"js",e,i),"js",i)}return t}function getHisDataState(t){var e=Object(_createFormData__WEBPACK_IMPORTED_MODULE_3__.b)(),i={isChange:"F",changeValue:"",curValue:""},n=t.fieldHistory||{},o=n.action,r=n.curRealValue,a=n.curValue,s=n.preRealValue,l={E:e("tool.update"),C:e("tool.add"),D:e("tool.delete")},h=!!o;switch(i.isChange=h?"T":"F",o){case"C":i.changeValue="".concat(r,"(").concat(l[o],")");break;case"E":i.changeValue="".concat(s," -> ").concat(r,"(").concat(l[o],")");break;case"D":i.changeValue="".concat(s,"(").concat(l[o],")");break;default:i.changeValue=""}return i.curValue=a,i}__webpack_require__.d(__webpack_exports__,"b",function(){return execAsyncExpression}),__webpack_require__.d(__webpack_exports__,"g",function(){return renderTemplate}),__webpack_require__.d(__webpack_exports__,"d",function(){return getExpressionValue}),__webpack_require__.d(__webpack_exports__,"e",function(){return getExpressionValueToParam}),__webpack_require__.d(__webpack_exports__,"c",function(){return getAsyncExpressionValue}),__webpack_require__.d(__webpack_exports__,"a",function(){return excJsExpression}),__webpack_require__.d(__webpack_exports__,"f",function(){return getHisDataState});var ffitm_vue_ui__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("6194"),ffitm_vue_ui__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(ffitm_vue_ui__WEBPACK_IMPORTED_MODULE_0__),_index__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("ed08"),_api_workflow__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("f36f"),_createFormData__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("2ee6"),ScriptType={js:"js",sqlProc:"sqlProc",sqlFunc:"sqlFunc",java:"java",fix:"fix",form:"form"}},"467f":function(t,e,i){"use strict";var n=i("2d83");t.exports=function(t,e,i){var o=i.config.validateStatus;i.status&&o&&!o(i.status)?e(n("Request failed with status code "+i.status,i.config,null,i.request,i)):t(i)}},4790:function(t,e,i){function n(t){var e=o(t);return i(e)}function o(t){if(!i.o(r,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return r[t]}var r={"./en.js":"090b","./zh-CN.js":"2f6e"};n.keys=function(){return Object.keys(r)},n.resolve=o,t.exports=n,n.id="4790"},"49f4":function(t,e,i){function n(){this.__data__=o?o(null):{},this.size=0}var o=i("6044");t.exports=n},"50d8":function(t,e){function i(t,e){for(var i=-1,n=Array(t);++i<t;)n[i]=e(i);return n}t.exports=i},5270:function(t,e,i){"use strict";function n(t){t.cancelToken&&t.cancelToken.throwIfRequested()}var o=i("c532"),r=i("c401"),a=i("2e67"),s=i("2444"),l=i("d925"),h=i("e683");t.exports=function(t){return n(t),t.baseURL&&!l(t.url)&&(t.url=h(t.baseURL,t.url)),t.headers=t.headers||{},t.data=r(t.data,t.headers,t.transformRequest),t.headers=o.merge(t.headers.common||{},t.headers[t.method]||{},t.headers||{}),o.forEach(["delete","get","head","post","put","patch","common"],function(e){delete t.headers[e]}),(t.adapter||s.adapter)(t).then(function(e){return n(t),e.data=r(e.data,e.headers,t.transformResponse),e},function(e){return a(e)||(n(t),e&&e.response&&(e.response.data=r(e.response.data,e.response.headers,t.transformResponse))),Promise.reject(e)})}},"54eb":function(t,e,i){function n(t,e){return o(t,r(t),e)}var o=i("8eeb"),r=i("32f4");t.exports=n},"55a3":function(t,e){function i(t){return this.__data__.has(t)}t.exports=i},"57a5":function(t,e,i){var n=i("91e9"),o=n(Object.keys,Object);t.exports=o},"585a":function(t,e,i){(function(e){var i="object"==typeof e&&e&&e.Object===Object&&e;t.exports=i}).call(this,i("c8ba"))},"5b01":function(t,e,i){function n(t,e){return t&&o(e,r(e),t)}var o=i("8eeb"),r=i("ec69");t.exports=n},"5d89":function(t,e,i){function n(t,e){var i=e?o(t.buffer):t.buffer;return new t.constructor(i,t.byteOffset,t.byteLength)}var o=i("f8af");t.exports=n},"5e2e":function(t,e,i){function n(t){var e=-1,i=null==t?0:t.length;for(this.clear();++e<i;){var n=t[e];this.set(n[0],n[1])}}var o=i("28c9"),r=i("69d5"),a=i("b4c0"),s=i("fba5"),l=i("67ca");n.prototype.clear=o,n.prototype.delete=r,n.prototype.get=a,n.prototype.has=s,n.prototype.set=l,t.exports=n},6044:function(t,e,i){var n=i("0b07"),o=n(Object,"create");t.exports=o},6194:function(t,e){t.exports=__webpack_require__(4)},"62e4":function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},6747:function(t,e){var i=Array.isArray;t.exports=i},"67ca":function(t,e,i){function n(t,e){var i=this.__data__,n=o(i,t);return n<0?(++this.size,i.push([t,e])):i[n][1]=e,this}var o=i("cb5a");t.exports=n},"69d5":function(t,e,i){function n(t){var e=this.__data__,i=o(e,t);return!(i<0)&&(i==e.length-1?e.pop():a.call(e,i,1),--this.size,!0)}var o=i("cb5a"),r=Array.prototype,a=r.splice;t.exports=n},"6f6c":function(t,e){function i(t){var e=new t.constructor(t.source,n.exec(t));return e.lastIndex=t.lastIndex,e}var n=/\w*$/;t.exports=i},"6fcd":function(t,e,i){function n(t,e){var i=a(t),n=!i&&r(t),c=!i&&!n&&s(t),d=!i&&!n&&!c&&h(t),f=i||n||c||d,p=f?o(t.length,String):[],g=p.length;for(var _ in t)!e&&!u.call(t,_)||f&&("length"==_||c&&("offset"==_||"parent"==_)||d&&("buffer"==_||"byteLength"==_||"byteOffset"==_)||l(_,g))||p.push(_);return p}var o=i("50d8"),r=i("d370"),a=i("6747"),s=i("0d24"),l=i("c098"),h=i("73ac"),c=Object.prototype,u=c.hasOwnProperty;t.exports=n},"73ac":function(t,e,i){var n=i("743f"),o=i("b047"),r=i("99d3"),a=r&&r.isTypedArray,s=a?o(a):n;t.exports=s},"743f":function(t,e,i){function n(t){return a(t)&&r(t.length)&&!!s[o(t)]}var o=i("3729"),r=i("b218"),a=i("1310"),s={};s["[object Float32Array]"]=s["[object Float64Array]"]=s["[object Int8Array]"]=s["[object Int16Array]"]=s["[object Int32Array]"]=s["[object Uint8Array]"]=s["[object Uint8ClampedArray]"]=s["[object Uint16Array]"]=s["[object Uint32Array]"]=!0,s["[object Arguments]"]=s["[object Array]"]=s["[object ArrayBuffer]"]=s["[object Boolean]"]=s["[object DataView]"]=s["[object Date]"]=s["[object Error]"]=s["[object Function]"]=s["[object Map]"]=s["[object Number]"]=s["[object Object]"]=s["[object RegExp]"]=s["[object Set]"]=s["[object String]"]=s["[object WeakMap]"]=!1,t.exports=n},7530:function(t,e,i){var n=i("1a8c"),o=Object.create,r=function(){function t(){}return function(e){if(!n(e))return{};if(o)return o(e);t.prototype=e;var i=new t;return t.prototype=void 0,i}}();t.exports=r},"79bc":function(t,e,i){var n=i("0b07"),o=i("2b3e"),r=n(o,"Map");t.exports=r},"7a48":function(t,e,i){function n(t){var e=this.__data__;return o?void 0!==e[t]:a.call(e,t)}var o=i("6044"),r=Object.prototype,a=r.hasOwnProperty;t.exports=n},"7a77":function(t,e,i){"use strict";function n(t){this.message=t}n.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},n.prototype.__CANCEL__=!0,t.exports=n},"7aac":function(t,e,i){"use strict";var n=i("c532");t.exports=n.isStandardBrowserEnv()?function(){return{write:function(t,e,i,o,r,a){var s=[];s.push(t+"="+encodeURIComponent(e)),n.isNumber(i)&&s.push("expires="+new Date(i).toGMTString()),n.isString(o)&&s.push("path="+o),n.isString(r)&&s.push("domain="+r),!0===a&&s.push("secure"),document.cookie=s.join("; ")},read:function(t){var e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove:function(t){this.write(t,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}()},"7b83":function(t,e,i){function n(t){var e=-1,i=null==t?0:t.length;for(this.clear();++e<i;){var n=t[e];this.set(n[0],n[1])}}var o=i("7c64"),r=i("93ed"),a=i("2478"),s=i("a524"),l=i("1fc8");n.prototype.clear=o,n.prototype.delete=r,n.prototype.get=a,n.prototype.has=s,n.prototype.set=l,t.exports=n},"7c64":function(t,e,i){function n(){this.size=0,this.__data__={hash:new o,map:new(a||r),string:new o}}var o=i("e24b"),r=i("5e2e"),a=i("79bc");t.exports=n},"7d1f":function(t,e,i){function n(t,e,i){var n=e(t);return r(t)?n:o(n,i(t))}var o=i("087d"),r=i("6747");t.exports=n},"7e64":function(t,e,i){function n(t){var e=this.__data__=new o(t);this.size=e.size}var o=i("5e2e"),r=i("efb6"),a=i("2fcc"),s=i("802a"),l=i("55a3"),h=i("d02c");n.prototype.clear=r,n.prototype.delete=a,n.prototype.get=s,n.prototype.has=l,n.prototype.set=h,t.exports=n},"802a":function(t,e){function i(t){return this.__data__.get(t)}t.exports=i},8057:function(t,e){function i(t,e){for(var i=-1,n=null==t?0:t.length;++i<n&&!1!==e(t[i],i,t););return t}t.exports=i},"872a":function(t,e,i){function n(t,e,i){"__proto__"==e&&o?o(t,e,{configurable:!0,enumerable:!0,value:i,writable:!0}):t[e]=i}var o=i("3b4a");t.exports=n},"8bbf":function(t,e){t.exports=__webpack_require__(5)},"8df4":function(t,e,i){"use strict";function n(t){if("function"!=typeof t)throw new TypeError("executor must be a function.");var e;this.promise=new Promise(function(t){e=t});var i=this;t(function(t){i.reason||(i.reason=new o(t),e(i.reason))})}var o=i("7a77");n.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},n.source=function(){var t;return{token:new n(function(e){t=e}),cancel:t}},t.exports=n},"8eeb":function(t,e,i){function n(t,e,i,n){var a=!i;i||(i={});for(var s=-1,l=e.length;++s<l;){var h=e[s],c=n?n(i[h],t[h],h,i,t):void 0;void 0===c&&(c=t[h]),a?r(i,h,c):o(i,h,c)}return i}var o=i("32b3"),r=i("872a");t.exports=n},"91e9":function(t,e){function i(t,e){return function(i){return t(e(i))}}t.exports=i},"93ed":function(t,e,i){function n(t){var e=o(this,t).delete(t);return this.size-=e?1:0,e}var o=i("4245");t.exports=n},9520:function(t,e,i){function n(t){if(!r(t))return!1;var e=o(t);return e==s||e==l||e==a||e==h}var o=i("3729"),r=i("1a8c"),a="[object AsyncFunction]",s="[object Function]",l="[object GeneratorFunction]",h="[object Proxy]";t.exports=n},9638:function(t,e){function i(t,e){return t===e||t!==t&&e!==e}t.exports=i},"98b8":function(t,e,i){var n=function(t){"use strict";function e(t,e,i,o){var r=e&&e.prototype instanceof n?e:n,a=Object.create(r.prototype),s=new d(o||[]);return a._invoke=l(t,i,s),a}function i(t,e,i){try{return{type:"normal",arg:t.call(e,i)}}catch(t){return{type:"throw",arg:t}}}function n(){}function o(){}function r(){}function a(t){["next","throw","return"].forEach(function(e){t[e]=function(t){return this._invoke(e,t)}})}function s(t,e){function n(o,r,a,s){var l=i(t[o],t,r);if("throw"!==l.type){var h=l.arg,c=h.value;return c&&"object"==typeof c&&m.call(c,"__await")?e.resolve(c.__await).then(function(t){n("next",t,a,s)},function(t){n("throw",t,a,s)}):e.resolve(c).then(function(t){h.value=t,a(h)},function(t){return n("throw",t,a,s)})}s(l.arg)}function o(t,i){function o(){return new e(function(e,o){n(t,i,e,o)})}return r=r?r.then(o,o):o()}var r;this._invoke=o}function l(t,e,n){var o=x;return function(r,a){if(o===C)throw new Error("Generator is already running");if(o===T){if("throw"===r)throw a;return p()}for(n.method=r,n.arg=a;;){var s=n.delegate;if(s){var l=h(s,n);if(l){if(l===k)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===x)throw o=T,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=C;var c=i(t,e,n);if("normal"===c.type){if(o=n.done?T:A,c.arg===k)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=T,n.method="throw",n.arg=c.arg)}}}function h(t,e){var n=t.iterator[e.method];if(n===g){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=g,h(t,e),"throw"===e.method))return k;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return k}var o=i(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,k;var r=o.arg;return r?r.done?(e[t.resultName]=r.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=g),e.delegate=null,k):r:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,k)}function c(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function u(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function d(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(c,this),this.reset(!0)}function f(t){if(t){var e=t[y];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,n=function e(){for(;++i<t.length;)if(m.call(t,i))return e.value=t[i],e.done=!1,e;return e.value=g,e.done=!0,e};return n.next=n}}return{next:p}}function p(){return{value:g,done:!0}}var g,_=Object.prototype,m=_.hasOwnProperty,v="function"==typeof Symbol?Symbol:{},y=v.iterator||"@@iterator",w=v.asyncIterator||"@@asyncIterator",b=v.toStringTag||"@@toStringTag";t.wrap=e;var x="suspendedStart",A="suspendedYield",C="executing",T="completed",k={},S={};S[y]=function(){return this};var E=Object.getPrototypeOf,I=E&&E(E(f([])));I&&I!==_&&m.call(I,y)&&(S=I);var L=r.prototype=n.prototype=Object.create(S);return o.prototype=L.constructor=r,r.constructor=o,r[b]=o.displayName="GeneratorFunction",t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===o||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,r):(t.__proto__=r,b in t||(t[b]="GeneratorFunction")),t.prototype=Object.create(L),t},t.awrap=function(t){return{__await:t}},a(s.prototype),s.prototype[w]=function(){return this},t.AsyncIterator=s,t.async=function(i,n,o,r,a){void 0===a&&(a=Promise);var l=new s(e(i,n,o,r),a);return t.isGeneratorFunction(n)?l:l.next().then(function(t){return t.done?t.value:l.next()})},a(L),L[b]="Generator",L[y]=function(){return this},L.toString=function(){return"[object Generator]"},t.keys=function(t){var e=[];for(var i in t)e.push(i);return e.reverse(),function i(){for(;e.length;){var n=e.pop();if(n in t)return i.value=n,i.done=!1,i}return i.done=!0,i}},t.values=f,d.prototype={constructor:d,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=g,this.done=!1,this.delegate=null,this.method="next",this.arg=g,this.tryEntries.forEach(u),!t)for(var e in this)"t"===e.charAt(0)&&m.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=g)},stop:function(){this.done=!0;var t=this.tryEntries[0],e=t.completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){function e(e,n){return r.type="throw",r.arg=t,i.next=e,n&&(i.method="next",i.arg=g),!!n}if(this.done)throw t;for(var i=this,n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n],r=o.completion;if("root"===o.tryLoc)return e("end");if(o.tryLoc<=this.prev){var a=m.call(o,"catchLoc"),s=m.call(o,"finallyLoc");if(a&&s){if(this.prev<o.catchLoc)return e(o.catchLoc,!0);if(this.prev<o.finallyLoc)return e(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return e(o.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return e(o.finallyLoc)}}}},abrupt:function(t,e){for(var i=this.tryEntries.length-1;i>=0;--i){var n=this.tryEntries[i];if(n.tryLoc<=this.prev&&m.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var r=o?o.completion:{};return r.type=t,r.arg=e,o?(this.method="next",this.next=o.finallyLoc,k):this.complete(r)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),k},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.finallyLoc===t)return this.complete(i.completion,i.afterLoc),u(i),k}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.tryLoc===t){var n=i.completion;if("throw"===n.type){var o=n.arg;u(i)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,i){return this.delegate={iterator:f(t),resultName:e,nextLoc:i},"next"===this.method&&(this.arg=g),k}},t}(t.exports);try{regeneratorRuntime=n}catch(t){Function("r","regeneratorRuntime = r")(n)}},9934:function(t,e,i){function n(t){return a(t)?o(t,!0):r(t)}var o=i("6fcd"),r=i("41c3"),a=i("30c9");t.exports=n},"99d3":function(t,e,i){(function(t){var n=i("585a"),o=e&&!e.nodeType&&e,r=o&&"object"==typeof t&&t&&!t.nodeType&&t,a=r&&r.exports===o,s=a&&n.process,l=function(){try{var t=r&&r.require&&r.require("util").types;return t||s&&s.binding&&s.binding("util")}catch(t){}}();t.exports=l}).call(this,i("62e4")(t))},"9cad":function(t,e,i){t.exports=function(t){function e(n){if(i[n])return i[n].exports;var o=i[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var i={};return e.m=t,e.c=i,e.d=function(t,i,n){e.o(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:n})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,i){if(1&i&&(t=e(t)),8&i)return t;if(4&i&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(e.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&i&&"string"!=typeof t)for(var o in t)e.d(n,o,function(e){return t[e]}.bind(null,o));return n},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s="fb15")}({"014b":function(t,e,i){"use strict";var n=i("e53d"),o=i("07e3"),r=i("8e60"),a=i("63b6"),s=i("9138"),l=i("ebfd").KEY,h=i("294c"),c=i("dbdb"),u=i("45f2"),d=i("62a0"),f=i("5168"),p=i("ccb9"),g=i("6718"),_=i("47ee"),m=i("9003"),v=i("e4ae"),y=i("f772"),w=i("241e"),b=i("36c3"),x=i("1bc3"),A=i("aebd"),C=i("a159"),T=i("0395"),k=i("bf0b"),S=i("9aa9"),E=i("d9f6"),I=i("c3a1"),L=k.f,R=E.f,P=T.f,O=n.Symbol,D=n.JSON,M=D&&D.stringify,N=f("_hidden"),B=f("toPrimitive"),F={}.propertyIsEnumerable,z=c("symbol-registry"),V=c("symbols"),U=c("op-symbols"),j=Object.prototype,H="function"==typeof O&&!!S.f,W=n.QObject,G=!W||!W.prototype||!W.prototype.findChild,Z=r&&h(function(){return 7!=C(R({},"a",{get:function(){return R(this,"a",{value:7}).a}})).a})?function(t,e,i){var n=L(j,e);n&&delete j[e],R(t,e,i),n&&t!==j&&R(j,e,n)}:R,X=function(t){var e=V[t]=C(O.prototype);return e._k=t,e},Y=H&&"symbol"==typeof O.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof O},$=function(t,e,i){return t===j&&$(U,e,i),v(t),e=x(e,!0),v(i),o(V,e)?(i.enumerable?(o(t,N)&&t[N][e]&&(t[N][e]=!1),i=C(i,{enumerable:A(0,!1)})):(o(t,N)||R(t,N,A(1,{})),t[N][e]=!0),Z(t,e,i)):R(t,e,i)},q=function(t,e){v(t);for(var i,n=_(e=b(e)),o=0,r=n.length;r>o;)$(t,i=n[o++],e[i]);return t},K=function(t,e){return void 0===e?C(t):q(C(t),e)},J=function(t){var e=F.call(this,t=x(t,!0));return!(this===j&&o(V,t)&&!o(U,t))&&(!(e||!o(this,t)||!o(V,t)||o(this,N)&&this[N][t])||e)},Q=function(t,e){if(t=b(t),e=x(e,!0),t!==j||!o(V,e)||o(U,e)){var i=L(t,e);return!i||!o(V,e)||o(t,N)&&t[N][e]||(i.enumerable=!0),i}},tt=function(t){for(var e,i=P(b(t)),n=[],r=0;i.length>r;)o(V,e=i[r++])||e==N||e==l||n.push(e);return n},et=function(t){for(var e,i=t===j,n=P(i?U:b(t)),r=[],a=0;n.length>a;)!o(V,e=n[a++])||i&&!o(j,e)||r.push(V[e]);return r};H||(O=function(){if(this instanceof O)throw TypeError("Symbol is not a constructor!");var t=d(arguments.length>0?arguments[0]:void 0),e=function(i){this===j&&e.call(U,i),o(this,N)&&o(this[N],t)&&(this[N][t]=!1),Z(this,t,A(1,i))};return r&&G&&Z(j,t,{configurable:!0,set:e}),X(t)},s(O.prototype,"toString",function(){return this._k}),k.f=Q,E.f=$,i("6abf").f=T.f=tt,i("355d").f=J,S.f=et,r&&!i("b8e3")&&s(j,"propertyIsEnumerable",J,!0),p.f=function(t){return X(f(t))}),a(a.G+a.W+a.F*!H,{Symbol:O});for(var it="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),nt=0;it.length>nt;)f(it[nt++]);for(var ot=I(f.store),rt=0;ot.length>rt;)g(ot[rt++]);a(a.S+a.F*!H,"Symbol",{for:function(t){return o(z,t+="")?z[t]:z[t]=O(t)},keyFor:function(t){if(!Y(t))throw TypeError(t+" is not a symbol!");for(var e in z)if(z[e]===t)return e},useSetter:function(){G=!0},useSimple:function(){G=!1}}),a(a.S+a.F*!H,"Object",{create:K,defineProperty:$,defineProperties:q,getOwnPropertyDescriptor:Q,getOwnPropertyNames:tt,getOwnPropertySymbols:et});var at=h(function(){S.f(1)});a(a.S+a.F*at,"Object",{getOwnPropertySymbols:function(t){return S.f(w(t))}}),D&&a(a.S+a.F*(!H||h(function(){var t=O();return"[null]"!=M([t])||"{}"!=M({a:t})||"{}"!=M(Object(t))})),"JSON",{stringify:function(t){for(var e,i,n=[t],o=1;arguments.length>o;)n.push(arguments[o++]);if(i=e=n[1],(y(e)||void 0!==t)&&!Y(t))return m(e)||(e=function(t,e){if("function"==typeof i&&(e=i.call(this,t,e)),!Y(e))return e}),n[1]=e,M.apply(D,n)}}),O.prototype[B]||i("35e8")(O.prototype,B,O.prototype.valueOf),u(O,"Symbol"),u(Math,"Math",!0),u(n.JSON,"JSON",!0)},"01f9":function(t,e,i){"use strict";var n=i("2d00"),o=i("5ca1"),r=i("2aba"),a=i("32e9"),s=i("84f2"),l=i("41a0"),h=i("7f20"),c=i("38fd"),u=i("2b4c")("iterator"),d=!([].keys&&"next"in[].keys()),f=function(){return this};t.exports=function(t,e,i,p,g,_,m){l(i,e,p);var v,y,w,b=function(t){if(!d&&t in T)return T[t];switch(t){case"keys":case"values":return function(){return new i(this,t)}}return function(){return new i(this,t)}},x=e+" Iterator",A="values"==g,C=!1,T=t.prototype,k=T[u]||T["@@iterator"]||g&&T[g],S=k||b(g),E=g?A?b("entries"):S:void 0,I="Array"==e?T.entries||k:k;if(I&&(w=c(I.call(new t)))!==Object.prototype&&w.next&&(h(w,x,!0),n||"function"==typeof w[u]||a(w,u,f)),A&&k&&"values"!==k.name&&(C=!0,S=function(){return k.call(this)}),n&&!m||!d&&!C&&T[u]||a(T,u,S),s[e]=S,s[x]=f,g)if(v={values:A?S:b("values"),keys:_?S:b("keys"),entries:E},m)for(y in v)y in T||r(T,y,v[y]);else o(o.P+o.F*(d||C),e,v);return v}},"02f4":function(t,e,i){var n=i("4588"),o=i("be13");t.exports=function(t){return function(e,i){var r,a,s=String(o(e)),l=n(i),h=s.length;return l<0||l>=h?t?"":void 0:(r=s.charCodeAt(l),r<55296||r>56319||l+1===h||(a=s.charCodeAt(l+1))<56320||a>57343?t?s.charAt(l):r:t?s.slice(l,l+2):a-56320+(r-55296<<10)+65536)}}},"0390":function(t,e,i){"use strict";var n=i("02f4")(!0);t.exports=function(t,e,i){return e+(i?n(t,e).length:1)}},"0395":function(t,e,i){var n=i("36c3"),o=i("6abf").f,r={}.toString,a="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],s=function(t){try{return o(t)}catch(t){return a.slice()}};t.exports.f=function(t){return a&&"[object Window]"==r.call(t)?s(t):o(n(t))}},"07e3":function(t,e){var i={}.hasOwnProperty;t.exports=function(t,e){return i.call(t,e)}},"0a49":function(t,e,i){var n=i("9b43"),o=i("626a"),r=i("4bf8"),a=i("9def"),s=i("cd1c");t.exports=function(t,e){var i=1==t,l=2==t,h=3==t,c=4==t,u=6==t,d=5==t||u,f=e||s;return function(e,s,p){for(var g,_,m=r(e),v=o(m),y=n(s,p,3),w=a(v.length),b=0,x=i?f(e,w):l?f(e,0):void 0;w>b;b++)if((d||b in v)&&(g=v[b],_=y(g,b,m),t))if(i)x[b]=_;else if(_)switch(t){case 3:return!0;case 5:return g;case 6:return b;case 2:x.push(g)}else if(c)return!1;return u?-1:h||c?c:x}}},"0bfb":function(t,e,i){"use strict";var n=i("cb7c");t.exports=function(){var t=n(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}},"0d58":function(t,e,i){var n=i("ce10"),o=i("e11e");t.exports=Object.keys||function(t){return n(t,o)}},"0fc9":function(t,e,i){var n=i("3a38"),o=Math.max,r=Math.min;t.exports=function(t,e){return t=n(t),t<0?o(t+e,0):r(t,e)}},1169:function(t,e,i){var n=i("2d95");t.exports=Array.isArray||function(t){return"Array"==n(t)}},1388:function(t,e,i){t.exports=function(t){function e(n){if(i[n])return i[n].exports;var o=i[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var i={};return e.m=t,e.c=i,e.d=function(t,i,n){e.o(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:n})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,i){if(1&i&&(t=e(t)),8&i)return t;if(4&i&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(e.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&i&&"string"!=typeof t)for(var o in t)e.d(n,o,function(e){return t[e]}.bind(null,o));return n},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="/dist/",e(e.s=124)}({0:function(t,e,i){"use strict";function n(t,e,i,n,o,r,a,s){var l="function"==typeof t?t.options:t;e&&(l.render=e,l.staticRenderFns=i,l._compiled=!0),n&&(l.functional=!0),r&&(l._scopeId="data-v-"+r);var h;if(a?(h=function(t){t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,t||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),o&&o.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(a)},l._ssrRegister=h):o&&(h=s?function(){o.call(this,this.$root.$options.shadowRoot)}:o),h)if(l.functional){l._injectStyles=h;var c=l.render;l.render=function(t,e){return h.call(e),c(t,e)}}else{var u=l.beforeCreate;l.beforeCreate=u?[].concat(u,h):[h]}return{exports:t,options:l}}i.d(e,"a",function(){return n})},124:function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement;return(t._self._c||e)("div",{staticClass:"el-button-group"},[t._t("default")],2)},o=[];n._withStripped=!0;var r={name:"ElButtonGroup"},a=r,s=i(0),l=Object(s.a)(a,n,o,!1,null,null,null);l.options.__file="packages/button/src/button-group.vue";var h=l.exports;h.install=function(t){t.component(h.name,h)},h.name="FiButtonGroup";e.default=h}})},1495:function(t,e,i){var n=i("86cc"),o=i("cb7c"),r=i("0d58");t.exports=i("9e1e")?Object.defineProperties:function(t,e){o(t);for(var i,a=r(e),s=a.length,l=0;s>l;)n.f(t,i=a[l++],e[i]);return t}},1654:function(t,e,i){"use strict";var n=i("71c1")(!0);i("30f1")(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,e=this._t,i=this._i;return i>=e.length?{value:void 0,done:!0}:(t=n(e,i),this._i+=t.length,{value:t,done:!1})})},1691:function(t,e){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},"1bc3":function(t,e,i){var n=i("f772");t.exports=function(t,e){if(!n(t))return t;var i,o;if(e&&"function"==typeof(i=t.toString)&&!n(o=i.call(t)))return o;if("function"==typeof(i=t.valueOf)&&!n(o=i.call(t)))return o;if(!e&&"function"==typeof(i=t.toString)&&!n(o=i.call(t)))return o;throw TypeError("Can't convert object to primitive value")}},"1ec9":function(t,e,i){var n=i("f772"),o=i("e53d").document,r=n(o)&&n(o.createElement);t.exports=function(t){return r?o.createElement(t):{}}},"214f":function(t,e,i){"use strict";i("b0c5");var n=i("2aba"),o=i("32e9"),r=i("79e5"),a=i("be13"),s=i("2b4c"),l=i("520a"),h=s("species"),c=!r(function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")}),u=function(){var t=/(?:)/,e=t.exec;t.exec=function(){return e.apply(this,arguments)};var i="ab".split(t);return 2===i.length&&"a"===i[0]&&"b"===i[1]}();t.exports=function(t,e,i){var d=s(t),f=!r(function(){var e={};return e[d]=function(){return 7},7!=""[t](e)}),p=f?!r(function(){var e=!1,i=/a/;return i.exec=function(){return e=!0,null},"split"===t&&(i.constructor={},i.constructor[h]=function(){return i}),i[d](""),!e}):void 0;if(!f||!p||"replace"===t&&!c||"split"===t&&!u){var g=/./[d],_=i(a,d,""[t],function(t,e,i,n,o){return e.exec===l?f&&!o?{done:!0,value:g.call(e,i,n)}:{done:!0,value:t.call(i,e,n)}:{done:!1}}),m=_[0],v=_[1];n(String.prototype,t,m),o(RegExp.prototype,d,2==e?function(t,e){return v.call(t,this,e)}:function(t){return v.call(t,this)})}}},"230e":function(t,e,i){var n=i("d3f4"),o=i("7726").document,r=n(o)&&n(o.createElement);t.exports=function(t){return r?o.createElement(t):{}}},"23af":function(t,e,i){"use strict";function n(){}function o(t,e){return u.call(t,e)}function r(t,e){for(var i in e)t[i]=e[i];return t}function a(t){for(var e={},i=0;i<t.length;i++)t[i]&&r(e,t[i]);return e}function s(t,e,i){var n=t;e=e.replace(/\[(\w+)\]/g,".$1"),e=e.replace(/^\./,"");for(var o=e.split("."),r=0,a=o.length;r<a-1&&(n||i);++r){var s=o[r];if(!(s in n)){if(i)throw new Error("please transfer a valid prop path to form item!");break}n=n[s]}return{o:n,k:o[r],v:n?n[o[r]]:null}}e.__esModule=!0,e.kebabCase=e.autoprefixer=e.isEdge=e.isIE=e.coerceTruthyValueToArray=e.arrayFind=e.arrayFindIndex=e.escapeRegexpString=e.valueEquals=e.generateId=e.getValueByPath=void 0;var l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.noop=n,e.hasOwn=o,e.toObject=a,e.getPropByPath=s;var h=i("8bbf"),c=function(t){return t&&t.__esModule?t:{default:t}}(h),u=Object.prototype.hasOwnProperty,d=(e.getValueByPath=function(t,e){e=e||"";for(var i=e.split("."),n=t,o=null,r=0,a=i.length;r<a;r++){var s=i[r];if(!n)break;if(r===a-1){o=n[s];break}n=n[s]}return o},e.generateId=function(){return Math.floor(1e4*Math.random())},e.valueEquals=function(t,e){if(t===e)return!0;if(!(t instanceof Array))return!1;if(!(e instanceof Array))return!1;if(t.length!==e.length)return!1;for(var i=0;i!==t.length;++i)if(t[i]!==e[i])return!1;return!0},e.escapeRegexpString=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return String(t).replace(/[|\\{}()[\]^$+*?.]/g,"\\$&")},e.arrayFindIndex=function(t,e){for(var i=0;i!==t.length;++i)if(e(t[i]))return i;return-1});e.arrayFind=function(t,e){var i=d(t,e);return-1!==i?t[i]:void 0},e.coerceTruthyValueToArray=function(t){return Array.isArray(t)?t:t?[t]:[]},e.isIE=function(){return!c.default.prototype.$isServer&&!isNaN(Number(document.documentMode))},e.isEdge=function(){return!c.default.prototype.$isServer&&navigator.userAgent.indexOf("Edge")>-1},e.autoprefixer=function(t){if("object"!==(void 0===t?"undefined":l(t)))return t;var e=["ms-","webkit-"];return["transform","transition","animation"].forEach(function(i){var n=t[i];i&&n&&e.forEach(function(e){t[e+i]=n})}),t},e.kebabCase=function(t){var e=/([^-])([A-Z])/g;return t.replace(e,"$1-$2").replace(e,"$1-$2").toLowerCase()}},"23c6":function(t,e,i){var n=i("2d95"),o=i("2b4c")("toStringTag"),r="Arguments"==n(function(){return arguments}()),a=function(t,e){try{return t[e]}catch(t){}};t.exports=function(t){var e,i,s;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(i=a(e=Object(t),o))?i:r?n(e):"Object"==(s=n(e))&&"function"==typeof e.callee?"Arguments":s}},"241e":function(t,e,i){var n=i("25eb");t.exports=function(t){return Object(n(t))}},"25eb":function(t,e){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},"28a5":function(t,e,i){"use strict";var n=i("aae3"),o=i("cb7c"),r=i("ebd6"),a=i("0390"),s=i("9def"),l=i("5f1b"),h=i("520a"),c=i("79e5"),u=Math.min,d=[].push,f="length",p=!c(function(){RegExp(4294967295,"y")});i("214f")("split",2,function(t,e,i,c){var g;return g="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1)[f]||2!="ab".split(/(?:ab)*/)[f]||4!=".".split(/(.?)(.?)/)[f]||".".split(/()()/)[f]>1||"".split(/.?/)[f]?function(t,e){var o=String(this);if(void 0===t&&0===e)return[];if(!n(t))return i.call(o,t,e);for(var r,a,s,l=[],c=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),u=0,p=void 0===e?4294967295:e>>>0,g=new RegExp(t.source,c+"g");(r=h.call(g,o))&&!((a=g.lastIndex)>u&&(l.push(o.slice(u,r.index)),r[f]>1&&r.index<o[f]&&d.apply(l,r.slice(1)),s=r[0][f],u=a,l[f]>=p));)g.lastIndex===r.index&&g.lastIndex++;return u===o[f]?!s&&g.test("")||l.push(""):l.push(o.slice(u)),l[f]>p?l.slice(0,p):l}:"0".split(void 0,0)[f]?function(t,e){return void 0===t&&0===e?[]:i.call(this,t,e)}:i,[function(i,n){var o=t(this),r=void 0==i?void 0:i[e];return void 0!==r?r.call(i,o,n):g.call(String(o),i,n)},function(t,e){var n=c(g,t,this,e,g!==i);if(n.done)return n.value;var h=o(t),d=String(this),f=r(h,RegExp),_=h.unicode,m=(h.ignoreCase?"i":"")+(h.multiline?"m":"")+(h.unicode?"u":"")+(p?"y":"g"),v=new f(p?h:"^(?:"+h.source+")",m),y=void 0===e?4294967295:e>>>0;if(0===y)return[];if(0===d.length)return null===l(v,d)?[d]:[];for(var w=0,b=0,x=[];b<d.length;){v.lastIndex=p?b:0;var A,C=l(v,p?d:d.slice(b));if(null===C||(A=u(s(v.lastIndex+(p?0:b)),d.length))===w)b=a(d,b,_);else{if(x.push(d.slice(w,b)),x.length===y)return x;for(var T=1;T<=C.length-1;T++)if(x.push(C[T]),x.length===y)return x;b=w=A}}return x.push(d.slice(w)),x}]})},"294c":function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},"2aba":function(t,e,i){var n=i("7726"),o=i("32e9"),r=i("69a8"),a=i("ca5a")("src"),s=i("fa5b"),l=(""+s).split("toString");i("8378").inspectSource=function(t){return s.call(t)},(t.exports=function(t,e,i,s){var h="function"==typeof i;h&&(r(i,"name")||o(i,"name",e)),t[e]!==i&&(h&&(r(i,a)||o(i,a,t[e]?""+t[e]:l.join(String(e)))),t===n?t[e]=i:s?t[e]?t[e]=i:o(t,e,i):(delete t[e],o(t,e,i)))})(Function.prototype,"toString",function(){return"function"==typeof this&&this[a]||s.call(this)})},"2aeb":function(t,e,i){var n=i("cb7c"),o=i("1495"),r=i("e11e"),a=i("613b")("IE_PROTO"),s=function(){},l=function(){var t,e=i("230e")("iframe"),n=r.length;for(e.style.display="none",i("fab2").appendChild(e),e.src="javascript:",t=e.contentWindow.document,t.open(),t.write("<script>document.F=Object<\/script>"),t.close(),l=t.F;n--;)delete l.prototype[r[n]];return l()};t.exports=Object.create||function(t,e){var i;return null!==t?(s.prototype=n(t),i=new s,s.prototype=null,i[a]=t):i=l(),void 0===e?i:o(i,e)}},"2b4c":function(t,e,i){var n=i("5537")("wks"),o=i("ca5a"),r=i("7726").Symbol,a="function"==typeof r;(t.exports=function(t){return n[t]||(n[t]=a&&r[t]||(a?r:o)("Symbol."+t))}).store=n},"2d00":function(t,e){t.exports=!1},"2d95":function(t,e){var i={}.toString;t.exports=function(t){return i.call(t).slice(8,-1)}},"30f1":function(t,e,i){"use strict";var n=i("b8e3"),o=i("63b6"),r=i("9138"),a=i("35e8"),s=i("481b"),l=i("8f60"),h=i("45f2"),c=i("53e2"),u=i("5168")("iterator"),d=!([].keys&&"next"in[].keys()),f=function(){return this};t.exports=function(t,e,i,p,g,_,m){l(i,e,p);var v,y,w,b=function(t){if(!d&&t in T)return T[t];switch(t){case"keys":case"values":return function(){return new i(this,t)}}return function(){return new i(this,t)}},x=e+" Iterator",A="values"==g,C=!1,T=t.prototype,k=T[u]||T["@@iterator"]||g&&T[g],S=k||b(g),E=g?A?b("entries"):S:void 0,I="Array"==e?T.entries||k:k;if(I&&(w=c(I.call(new t)))!==Object.prototype&&w.next&&(h(w,x,!0),n||"function"==typeof w[u]||a(w,u,f)),A&&k&&"values"!==k.name&&(C=!0,S=function(){return k.call(this)}),n&&!m||!d&&!C&&T[u]||a(T,u,S),s[e]=S,s[x]=f,g)if(v={values:A?S:b("values"),keys:_?S:b("keys"),entries:E},m)for(y in v)y in T||r(T,y,v[y]);else o(o.P+o.F*(d||C),e,v);return v}},"32e9":function(t,e,i){var n=i("86cc"),o=i("4630");t.exports=i("9e1e")?function(t,e,i){return n.f(t,e,o(1,i))}:function(t,e,i){return t[e]=i,t}},"32fc":function(t,e,i){var n=i("e53d").document;t.exports=n&&n.documentElement},"335c":function(t,e,i){var n=i("6b4c");t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==n(t)?t.split(""):Object(t)}},"355d":function(t,e){e.f={}.propertyIsEnumerable},"35e8":function(t,e,i){var n=i("d9f6"),o=i("aebd");t.exports=i("8e60")?function(t,e,i){return n.f(t,e,o(1,i))}:function(t,e,i){return t[e]=i,t}},"36c3":function(t,e,i){var n=i("335c"),o=i("25eb");t.exports=function(t){return n(o(t))}},"38fd":function(t,e,i){var n=i("69a8"),o=i("4bf8"),r=i("613b")("IE_PROTO"),a=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=o(t),n(t,r)?t[r]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?a:null}},"39d2":function(t,e,i){"use strict";e.__esModule=!0;var n=i("8bbf"),o=function(t){return t&&t.__esModule?t:{default:t}}(n),r=i("73fa"),a=!1,s=!1,l=2e3,h=function(){if(!o.default.prototype.$isServer){var t=u.modalDom;return t?a=!0:(a=!1,t=document.createElement("div"),u.modalDom=t,t.addEventListener("touchmove",function(t){t.preventDefault(),t.stopPropagation()}),t.addEventListener("click",function(){u.doOnModalClick&&u.doOnModalClick()})),t}},c={},u={modalFade:!0,getInstance:function(t){return c[t]},register:function(t,e){t&&e&&(c[t]=e)},deregister:function(t){t&&(c[t]=null,delete c[t])},nextZIndex:function(){return u.zIndex++},modalStack:[],doOnModalClick:function(){var t=u.modalStack[u.modalStack.length-1];if(t){var e=u.getInstance(t.id);e&&e.closeOnClickModal&&e.close()}},openModal:function(t,e,i,n,s){if(!o.default.prototype.$isServer&&t&&void 0!==e){this.modalFade=s;for(var l=this.modalStack,c=0,u=l.length;c<u;c++){if(l[c].id===t)return}var d=h();if((0,r.addClass)(d,"v-modal"),this.modalFade&&!a&&(0,r.addClass)(d,"v-modal-enter"),n){n.trim().split(/\s+/).forEach(function(t){return(0,r.addClass)(d,t)})}setTimeout(function(){(0,r.removeClass)(d,"v-modal-enter")},200),i&&i.parentNode&&11!==i.parentNode.nodeType?i.parentNode.appendChild(d):document.body.appendChild(d),e&&(d.style.zIndex=e),d.tabIndex=0,d.style.display="",this.modalStack.push({id:t,zIndex:e,modalClass:n})}},closeModal:function(t){var e=this.modalStack,i=h();if(e.length>0){var n=e[e.length-1];if(n.id===t){if(n.modalClass){n.modalClass.trim().split(/\s+/).forEach(function(t){return(0,r.removeClass)(i,t)})}e.pop(),e.length>0&&(i.style.zIndex=e[e.length-1].zIndex)}else for(var o=e.length-1;o>=0;o--)if(e[o].id===t){e.splice(o,1);break}}0===e.length&&(this.modalFade&&(0,r.addClass)(i,"v-modal-leave"),setTimeout(function(){0===e.length&&(i.parentNode&&i.parentNode.removeChild(i),i.style.display="none",u.modalDom=void 0),(0,r.removeClass)(i,"v-modal-leave")},200))}};Object.defineProperty(u,"zIndex",{configurable:!0,get:function(){return s||(l=(o.default.prototype.$ELEMENT||{}).zIndex||l,s=!0),l},set:function(t){l=t}});var d=function(){if(!o.default.prototype.$isServer&&u.modalStack.length>0){var t=u.modalStack[u.modalStack.length-1];if(!t)return;return u.getInstance(t.id)}};o.default.prototype.$isServer||window.addEventListener("keydown",function(t){if(27===t.keyCode){var e=d();e&&e.closeOnPressEscape&&(e.handleClose?e.handleClose():e.handleAction?e.handleAction("cancel"):e.close())}}),e.default=u},"3a38":function(t,e){var i=Math.ceil,n=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?n:i)(t)}},"3aff":function(t,e,i){"use strict";var n=i("7144"),o=i.n(n);o.a},"3eaf":function(t,e,i){"use strict";e.__esModule=!0,e.default=function(t){for(var e=1,i=arguments.length;e<i;e++){var n=arguments[e]||{};for(var o in n)if(n.hasOwnProperty(o)){var r=n[o];void 0!==r&&(t[o]=r)}}return t}},"41a0":function(t,e,i){"use strict";var n=i("2aeb"),o=i("4630"),r=i("7f20"),a={};i("32e9")(a,i("2b4c")("iterator"),function(){return this}),t.exports=function(t,e,i){t.prototype=n(a,{next:o(1,i)}),r(t,e+" Iterator")}},"437e":function(t,e,i){"use strict";var n,o;"function"==typeof Symbol&&Symbol.iterator;!function(r,a){n=a,void 0!==(o="function"==typeof n?n.call(e,i,e,t):n)&&(t.exports=o)}(0,function(){function t(t,e,i){this._reference=t.jquery?t[0]:t,this.state={};var n=void 0===e||null===e,o=e&&"[object Object]"===Object.prototype.toString.call(e);return this._popper=n||o?this.parse(o?e:{}):e.jquery?e[0]:e,this._options=Object.assign({},_,i),this._options.modifiers=this._options.modifiers.map(function(t){if(-1===this._options.modifiersIgnored.indexOf(t))return"applyStyle"===t&&this._popper.setAttribute("x-placement",this._options.placement),this.modifiers[t]||t}.bind(this)),this.state.position=this._getPosition(this._popper,this._reference),h(this._popper,{position:this.state.position,top:0}),this.update(),this._setupEventListeners(),this}function e(t){var e=t.style.display,i=t.style.visibility;t.style.display="block",t.style.visibility="hidden";var n=(t.offsetWidth,g.getComputedStyle(t)),o=parseFloat(n.marginTop)+parseFloat(n.marginBottom),r=parseFloat(n.marginLeft)+parseFloat(n.marginRight),a={width:t.offsetWidth+r,height:t.offsetHeight+o};return t.style.display=e,t.style.visibility=i,a}function i(t){var e={left:"right",right:"left",bottom:"top",top:"bottom"};return t.replace(/left|right|bottom|top/g,function(t){return e[t]})}function n(t){var e=Object.assign({},t);return e.right=e.left+e.width,e.bottom=e.top+e.height,e}function o(t,e){var i,n=0;for(i in t){if(t[i]===e)return n;n++}return null}function r(t,e){return g.getComputedStyle(t,null)[e]}function a(t){var e=t.offsetParent;return e!==g.document.body&&e?e:g.document.documentElement}function s(t){var e=t.parentNode;return e?e===g.document?g.document.body.scrollTop||g.document.body.scrollLeft?g.document.body:g.document.documentElement:-1!==["scroll","auto"].indexOf(r(e,"overflow"))||-1!==["scroll","auto"].indexOf(r(e,"overflow-x"))||-1!==["scroll","auto"].indexOf(r(e,"overflow-y"))?e:s(t.parentNode):t}function l(t){return t!==g.document.body&&("fixed"===r(t,"position")||(t.parentNode?l(t.parentNode):t))}function h(t,e){function i(t){return""!==t&&!isNaN(parseFloat(t))&&isFinite(t)}Object.keys(e).forEach(function(n){var o="";-1!==["width","height","top","right","bottom","left"].indexOf(n)&&i(e[n])&&(o="px"),t.style[n]=e[n]+o})}function c(t){var e={};return t&&"[object Function]"===e.toString.call(t)}function u(t){var e={width:t.offsetWidth,height:t.offsetHeight,left:t.offsetLeft,top:t.offsetTop};return e.right=e.left+e.width,e.bottom=e.top+e.height,e}function d(t){var e=t.getBoundingClientRect(),i=-1!=navigator.userAgent.indexOf("MSIE"),n=i&&"HTML"===t.tagName?-t.scrollTop:e.top;return{left:e.left,top:n,right:e.right,bottom:e.bottom,width:e.right-e.left,height:e.bottom-n}}function f(t,e,i){var n=d(t),o=d(e);if(i){var r=s(e);o.top+=r.scrollTop,o.bottom+=r.scrollTop,o.left+=r.scrollLeft,o.right+=r.scrollLeft}return{top:n.top-o.top,left:n.left-o.left,bottom:n.top-o.top+n.height,right:n.left-o.left+n.width,width:n.width,height:n.height}}function p(t){for(var e=["","ms","webkit","moz","o"],i=0;i<e.length;i++){var n=e[i]?e[i]+t.charAt(0).toUpperCase()+t.slice(1):t;if(void 0!==g.document.body.style[n])return n}return null}var g=window,_={placement:"bottom",gpuAcceleration:!0,offset:0,boundariesElement:"viewport",boundariesPadding:5,preventOverflowOrder:["left","right","top","bottom"],flipBehavior:"flip",arrowElement:"[x-arrow]",arrowOffset:0,modifiers:["shift","offset","preventOverflow","keepTogether","arrow","flip","applyStyle"],modifiersIgnored:[],forceAbsolute:!1};return t.prototype.destroy=function(){return this._popper.removeAttribute("x-placement"),this._popper.style.left="",this._popper.style.position="",this._popper.style.top="",this._popper.style[p("transform")]="",this._removeEventListeners(),this._options.removeOnDestroy&&this._popper.remove(),this},t.prototype.update=function(){var t={instance:this,styles:{}};t.placement=this._options.placement,t._originalPlacement=this._options.placement,t.offsets=this._getOffsets(this._popper,this._reference,t.placement),t.boundaries=this._getBoundaries(t,this._options.boundariesPadding,this._options.boundariesElement),t=this.runModifiers(t,this._options.modifiers),"function"==typeof this.state.updateCallback&&this.state.updateCallback(t)},t.prototype.onCreate=function(t){return t(this),this},t.prototype.onUpdate=function(t){return this.state.updateCallback=t,this},t.prototype.parse=function(t){function e(t,e){e.forEach(function(e){t.classList.add(e)})}function i(t,e){e.forEach(function(e){t.setAttribute(e.split(":")[0],e.split(":")[1]||"")})}var n={tagName:"div",classNames:["popper"],attributes:[],parent:g.document.body,content:"",contentType:"text",arrowTagName:"div",arrowClassNames:["popper__arrow"],arrowAttributes:["x-arrow"]};t=Object.assign({},n,t);var o=g.document,r=o.createElement(t.tagName);if(e(r,t.classNames),i(r,t.attributes),"node"===t.contentType?r.appendChild(t.content.jquery?t.content[0]:t.content):"html"===t.contentType?r.innerHTML=t.content:r.textContent=t.content,t.arrowTagName){var a=o.createElement(t.arrowTagName);e(a,t.arrowClassNames),i(a,t.arrowAttributes),r.appendChild(a)}var s=t.parent.jquery?t.parent[0]:t.parent;if("string"==typeof s){if(s=o.querySelectorAll(t.parent),s.length>1&&console.warn("WARNING: the given `parent` query("+t.parent+") matched more than one element, the first one will be used"),0===s.length)throw"ERROR: the given `parent` doesn't exists!";s=s[0]}return s.length>1&&s instanceof Element==!1&&(console.warn("WARNING: you have passed as parent a list of elements, the first one will be used"),s=s[0]),s.appendChild(r),r},t.prototype._getPosition=function(t,e){var i=a(e);return this._options.forceAbsolute?"absolute":l(e,i)?"fixed":"absolute"},t.prototype._getOffsets=function(t,i,n){n=n.split("-")[0];var o={};o.position=this.state.position;var r="fixed"===o.position,s=f(i,a(t),r),l=e(t);return-1!==["right","left"].indexOf(n)?(o.top=s.top+s.height/2-l.height/2,o.left="left"===n?s.left-l.width:s.right):(o.left=s.left+s.width/2-l.width/2,o.top="top"===n?s.top-l.height:s.bottom),o.width=l.width,o.height=l.height,{popper:o,reference:s}},t.prototype._setupEventListeners=function(){if(this.state.updateBound=this.update.bind(this),g.addEventListener("resize",this.state.updateBound),"window"!==this._options.boundariesElement){var t=s(this._reference);t!==g.document.body&&t!==g.document.documentElement||(t=g),t.addEventListener("scroll",this.state.updateBound),this.state.scrollTarget=t}},t.prototype._removeEventListeners=function(){g.removeEventListener("resize",this.state.updateBound),"window"!==this._options.boundariesElement&&this.state.scrollTarget&&(this.state.scrollTarget.removeEventListener("scroll",this.state.updateBound),this.state.scrollTarget=null),this.state.updateBound=null},t.prototype._getBoundaries=function(t,e,i){var n,o,r={};if("window"===i){var l=g.document.body,h=g.document.documentElement;o=Math.max(l.scrollHeight,l.offsetHeight,h.clientHeight,h.scrollHeight,h.offsetHeight),n=Math.max(l.scrollWidth,l.offsetWidth,h.clientWidth,h.scrollWidth,h.offsetWidth),r={top:0,right:n,bottom:o,left:0}}else if("viewport"===i){var c=a(this._popper),d=s(this._popper),f=u(c),p="fixed"===t.offsets.popper.position?0:function(t){return t==document.body?Math.max(document.documentElement.scrollTop,document.body.scrollTop):t.scrollTop}(d),_="fixed"===t.offsets.popper.position?0:function(t){return t==document.body?Math.max(document.documentElement.scrollLeft,document.body.scrollLeft):t.scrollLeft}(d);r={top:0-(f.top-p),right:g.document.documentElement.clientWidth-(f.left-_),bottom:g.document.documentElement.clientHeight-(f.top-p),left:0-(f.left-_)}}else r=a(this._popper)===i?{top:0,left:0,right:i.clientWidth,bottom:i.clientHeight}:u(i);return r.left+=e,r.right-=e,r.top=r.top+e,r.bottom=r.bottom-e,r},t.prototype.runModifiers=function(t,e,i){var n=e.slice();return void 0!==i&&(n=this._options.modifiers.slice(0,o(this._options.modifiers,i))),n.forEach(function(e){c(e)&&(t=e.call(this,t))}.bind(this)),t},t.prototype.isModifierRequired=function(t,e){var i=o(this._options.modifiers,t);return!!this._options.modifiers.slice(0,i).filter(function(t){return t===e}).length},t.prototype.modifiers={},t.prototype.modifiers.applyStyle=function(t){var e,i={position:t.offsets.popper.position},n=Math.round(t.offsets.popper.left),o=Math.round(t.offsets.popper.top);return this._options.gpuAcceleration&&(e=p("transform"))?(i[e]="translate3d("+n+"px, "+o+"px, 0)",i.top=0,i.left=0):(i.left=n,i.top=o),Object.assign(i,t.styles),h(this._popper,i),this._popper.setAttribute("x-placement",t.placement),this.isModifierRequired(this.modifiers.applyStyle,this.modifiers.arrow)&&t.offsets.arrow&&h(t.arrowElement,t.offsets.arrow),t},t.prototype.modifiers.shift=function(t){var e=t.placement,i=e.split("-")[0],o=e.split("-")[1];if(o){var r=t.offsets.reference,a=n(t.offsets.popper),s={y:{start:{top:r.top},end:{top:r.top+r.height-a.height}},x:{start:{left:r.left},end:{left:r.left+r.width-a.width}}},l=-1!==["bottom","top"].indexOf(i)?"x":"y";t.offsets.popper=Object.assign(a,s[l][o])}return t},t.prototype.modifiers.preventOverflow=function(t){var e=this._options.preventOverflowOrder,i=n(t.offsets.popper),o={left:function(){var e=i.left;return i.left<t.boundaries.left&&(e=Math.max(i.left,t.boundaries.left)),{left:e}},right:function(){var e=i.left;return i.right>t.boundaries.right&&(e=Math.min(i.left,t.boundaries.right-i.width)),{left:e}},top:function(){var e=i.top;return i.top<t.boundaries.top&&(e=Math.max(i.top,t.boundaries.top)),{top:e}},bottom:function(){var e=i.top;return i.bottom>t.boundaries.bottom&&(e=Math.min(i.top,t.boundaries.bottom-i.height)),{top:e}}};return e.forEach(function(e){t.offsets.popper=Object.assign(i,o[e]())}),t},t.prototype.modifiers.keepTogether=function(t){var e=n(t.offsets.popper),i=t.offsets.reference,o=Math.floor;return e.right<o(i.left)&&(t.offsets.popper.left=o(i.left)-e.width),e.left>o(i.right)&&(t.offsets.popper.left=o(i.right)),e.bottom<o(i.top)&&(t.offsets.popper.top=o(i.top)-e.height),e.top>o(i.bottom)&&(t.offsets.popper.top=o(i.bottom)),t},t.prototype.modifiers.flip=function(t){if(!this.isModifierRequired(this.modifiers.flip,this.modifiers.preventOverflow))return console.warn("WARNING: preventOverflow modifier is required by flip modifier in order to work, be sure to include it before flip!"),t;if(t.flipped&&t.placement===t._originalPlacement)return t;var e=t.placement.split("-")[0],o=i(e),r=t.placement.split("-")[1]||"",a=[];return a="flip"===this._options.flipBehavior?[e,o]:this._options.flipBehavior,a.forEach(function(s,l){if(e===s&&a.length!==l+1){e=t.placement.split("-")[0],o=i(e);var h=n(t.offsets.popper),c=-1!==["right","bottom"].indexOf(e);(c&&Math.floor(t.offsets.reference[e])>Math.floor(h[o])||!c&&Math.floor(t.offsets.reference[e])<Math.floor(h[o]))&&(t.flipped=!0,t.placement=a[l+1],r&&(t.placement+="-"+r),t.offsets.popper=this._getOffsets(this._popper,this._reference,t.placement).popper,t=this.runModifiers(t,this._options.modifiers,this._flip))}}.bind(this)),t},t.prototype.modifiers.offset=function(t){var e=this._options.offset,i=t.offsets.popper;return-1!==t.placement.indexOf("left")?i.top-=e:-1!==t.placement.indexOf("right")?i.top+=e:-1!==t.placement.indexOf("top")?i.left-=e:-1!==t.placement.indexOf("bottom")&&(i.left+=e),t},t.prototype.modifiers.arrow=function(t){var i=this._options.arrowElement,o=this._options.arrowOffset;if("string"==typeof i&&(i=this._popper.querySelector(i)),!i)return t;if(!this._popper.contains(i))return console.warn("WARNING: `arrowElement` must be child of its popper element!"),t;if(!this.isModifierRequired(this.modifiers.arrow,this.modifiers.keepTogether))return console.warn("WARNING: keepTogether modifier is required by arrow modifier in order to work, be sure to include it before arrow!"),t;var r={},a=t.placement.split("-")[0],s=n(t.offsets.popper),l=t.offsets.reference,h=-1!==["left","right"].indexOf(a),c=h?"height":"width",u=h?"top":"left",d=h?"left":"top",f=h?"bottom":"right",p=e(i)[c];l[f]-p<s[u]&&(t.offsets.popper[u]-=s[u]-(l[f]-p)),l[u]+p>s[f]&&(t.offsets.popper[u]+=l[u]+p-s[f]);var g=l[u]+(o||l[c]/2-p/2),_=g-s[u];return _=Math.max(Math.min(s[c]-p-8,_),8),r[u]=_,r[d]="",t.offsets.arrow=r,t.arrowElement=i,t},Object.assign||Object.defineProperty(Object,"assign",{enumerable:!1,configurable:!0,writable:!0,value:function(t){if(void 0===t||null===t)throw new TypeError("Cannot convert first argument to object");for(var e=Object(t),i=1;i<arguments.length;i++){var n=arguments[i];if(void 0!==n&&null!==n){n=Object(n);for(var o=Object.keys(n),r=0,a=o.length;r<a;r++){var s=o[r],l=Object.getOwnPropertyDescriptor(n,s);void 0!==l&&l.enumerable&&(e[s]=n[s])}}}return e}}),t})},"456d":function(t,e,i){var n=i("4bf8"),o=i("0d58");i("5eda")("keys",function(){return function(t){return o(n(t))}})},4588:function(t,e){var i=Math.ceil,n=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?n:i)(t)}},"45f2":function(t,e,i){var n=i("d9f6").f,o=i("07e3"),r=i("5168")("toStringTag");t.exports=function(t,e,i){t&&!o(t=i?t:t.prototype,r)&&n(t,r,{configurable:!0,value:e})}},4630:function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},"47ee":function(t,e,i){var n=i("c3a1"),o=i("9aa9"),r=i("355d");t.exports=function(t){var e=n(t),i=o.f;if(i)for(var a,s=i(t),l=r.f,h=0;s.length>h;)l.call(t,a=s[h++])&&e.push(a);return e}},4800:function(t,e,i){t.exports=function(t){function e(n){if(i[n])return i[n].exports;var o=i[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var i={};return e.m=t,e.c=i,e.d=function(t,i,n){e.o(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:n})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,i){if(1&i&&(t=e(t)),8&i)return t;if(4&i&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(e.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&i&&"string"!=typeof t)for(var o in t)e.d(n,o,function(e){return t[e]}.bind(null,o));return n},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="/dist/",e(e.s=64)}({0:function(t,e,i){"use strict";function n(t,e,i,n,o,r,a,s){var l="function"==typeof t?t.options:t;e&&(l.render=e,l.staticRenderFns=i,l._compiled=!0),n&&(l.functional=!0),r&&(l._scopeId="data-v-"+r);var h;if(a?(h=function(t){t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,t||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),o&&o.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(a)},l._ssrRegister=h):o&&(h=s?function(){o.call(this,this.$root.$options.shadowRoot)}:o),h)if(l.functional){l._injectStyles=h;var c=l.render;l.render=function(t,e){return h.call(e),c(t,e)}}else{var u=l.beforeCreate;l.beforeCreate=u?[].concat(u,h):[h]}return{exports:t,options:l}}i.d(e,"a",function(){return n})},5:function(t,e){t.exports=i("c27e")},64:function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("transition",{attrs:{name:"el-zoom-in-top"},on:{"after-leave":t.doDestroy}},[i("ul",{directives:[{name:"show",rawName:"v-show",value:t.showPopper,expression:"showPopper"}],staticClass:"el-dropdown-menu el-popper",class:[t.size&&"el-dropdown-menu--"+t.size]},[t._t("default")],2)])},o=[];n._withStripped=!0;var r=i(5),a=i.n(r),s={name:"ElDropdownMenu",componentName:"ElDropdownMenu",mixins:[a.a],props:{visibleArrow:{type:Boolean,default:!0},arrowOffset:{type:Number,default:0}},data:function(){return{size:this.dropdown.dropdownSize}},inject:["dropdown"],created:function(){var t=this;this.$on("updatePopper",function(){t.showPopper&&t.updatePopper()}),this.$on("visible",function(e){t.showPopper=e})},mounted:function(){this.dropdown.popperElm=this.popperElm=this.$el,this.referenceElm=this.dropdown.$el,this.dropdown.initDomOperation()},watch:{"dropdown.placement":{immediate:!0,handler:function(t){this.currentPlacement=t}}}},l=s,h=i(0),c=Object(h.a)(l,n,o,!1,null,null,null);c.options.__file="packages/dropdown/src/dropdown-menu.vue";var u=c.exports;u.install=function(t){t.component(u.name,u)},u.name="FiDropdownMenu";e.default=u}})},"481b":function(t,e){t.exports={}},"4bf8":function(t,e,i){var n=i("be13");t.exports=function(t){return Object(n(t))}},"4ff6":function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0,e.PopupManager=void 0;var o=i("8bbf"),r=n(o),a=i("3eaf"),s=n(a),l=i("39d2"),h=n(l),c=i("9aea"),u=n(c),d=i("73fa"),f=1,p=void 0;e.default={props:{visible:{type:Boolean,default:!1},openDelay:{},closeDelay:{},zIndex:{},modal:{type:Boolean,default:!1},modalFade:{type:Boolean,default:!0},modalClass:{},modalAppendToBody:{type:Boolean,default:!1},lockScroll:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!1},closeOnClickModal:{type:Boolean,default:!1}},beforeMount:function(){this._popupId="popup-"+f++,h.default.register(this._popupId,this)},beforeDestroy:function(){h.default.deregister(this._popupId),h.default.closeModal(this._popupId),this.restoreBodyStyle()},data:function(){return{opened:!1,bodyPaddingRight:null,computedBodyPaddingRight:0,withoutHiddenClass:!0,rendered:!1}},watch:{visible:function(t){var e=this;if(t){if(this._opening)return;this.rendered?this.open():(this.rendered=!0,r.default.nextTick(function(){e.open()}))}else this.close()}},methods:{open:function(t){var e=this;this.rendered||(this.rendered=!0);var i=(0,s.default)({},this.$props||this,t);this._closeTimer&&(clearTimeout(this._closeTimer),this._closeTimer=null),clearTimeout(this._openTimer);var n=Number(i.openDelay);n>0?this._openTimer=setTimeout(function(){e._openTimer=null,e.doOpen(i)},n):this.doOpen(i)},doOpen:function(t){if(!this.$isServer&&(!this.willOpen||this.willOpen())&&!this.opened){this._opening=!0;var e=this.$el,i=t.modal,n=t.zIndex;if(n&&(h.default.zIndex=n),i&&(this._closing&&(h.default.closeModal(this._popupId),this._closing=!1),h.default.openModal(this._popupId,h.default.nextZIndex(),this.modalAppendToBody?void 0:e,t.modalClass,t.modalFade),t.lockScroll)){this.withoutHiddenClass=!(0,d.hasClass)(document.body,"el-popup-parent--hidden"),this.withoutHiddenClass&&(this.bodyPaddingRight=document.body.style.paddingRight,this.computedBodyPaddingRight=parseInt((0,d.getStyle)(document.body,"paddingRight"),10)),p=(0,u.default)();var o=document.documentElement.clientHeight<document.body.scrollHeight,r=(0,d.getStyle)(document.body,"overflowY");p>0&&(o||"scroll"===r)&&this.withoutHiddenClass&&(document.body.style.paddingRight=this.computedBodyPaddingRight+p+"px"),(0,d.addClass)(document.body,"el-popup-parent--hidden")}"static"===getComputedStyle(e).position&&(e.style.position="absolute"),e.style.zIndex=h.default.nextZIndex(),this.opened=!0,this.onOpen&&this.onOpen(),this.doAfterOpen()}},doAfterOpen:function(){this._opening=!1},close:function(){var t=this;if(!this.willClose||this.willClose()){null!==this._openTimer&&(clearTimeout(this._openTimer),this._openTimer=null),clearTimeout(this._closeTimer);var e=Number(this.closeDelay);e>0?this._closeTimer=setTimeout(function(){t._closeTimer=null,t.doClose()},e):this.doClose()}},doClose:function(){this._closing=!0,this.onClose&&this.onClose(),this.lockScroll&&setTimeout(this.restoreBodyStyle,200),this.opened=!1,this.doAfterClose()},doAfterClose:function(){h.default.closeModal(this._popupId),this._closing=!1},restoreBodyStyle:function(){this.modal&&this.withoutHiddenClass&&(document.body.style.paddingRight=this.bodyPaddingRight,(0,d.removeClass)(document.body,"el-popup-parent--hidden")),this.withoutHiddenClass=!0}}},e.PopupManager=h.default},"50ed":function(t,e){t.exports=function(t,e){return{value:e,done:!!t}}},5168:function(t,e,i){var n=i("dbdb")("wks"),o=i("62a0"),r=i("e53d").Symbol,a="function"==typeof r;(t.exports=function(t){return n[t]||(n[t]=a&&r[t]||(a?r:o)("Symbol."+t))}).store=n},"520a":function(t,e,i){"use strict";var n=i("0bfb"),o=RegExp.prototype.exec,r=String.prototype.replace,a=o,s=function(){var t=/a/,e=/b*/g;return o.call(t,"a"),o.call(e,"a"),0!==t.lastIndex||0!==e.lastIndex}(),l=void 0!==/()??/.exec("")[1];(s||l)&&(a=function(t){var e,i,a,h,c=this;return l&&(i=new RegExp("^"+c.source+"$(?!\\s)",n.call(c))),s&&(e=c.lastIndex),a=o.call(c,t),s&&a&&(c.lastIndex=c.global?a.index+a[0].length:e),l&&a&&a.length>1&&r.call(a[0],i,function(){for(h=1;h<arguments.length-2;h++)void 0===arguments[h]&&(a[h]=void 0)}),a}),t.exports=a},"53e2":function(t,e,i){var n=i("07e3"),o=i("241e"),r=i("5559")("IE_PROTO"),a=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=o(t),n(t,r)?t[r]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?a:null}},5537:function(t,e,i){var n=i("8378"),o=i("7726"),r=o["__core-js_shared__"]||(o["__core-js_shared__"]={});(t.exports=function(t,e){return r[t]||(r[t]=void 0!==e?e:{})})("versions",[]).push({version:n.version,mode:i("2d00")?"pure":"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})},5559:function(t,e,i){var n=i("dbdb")("keys"),o=i("62a0");t.exports=function(t){return n[t]||(n[t]=o(t))}},"584a":function(t,e){var i=t.exports={version:"2.6.9"};"number"==typeof __e&&(__e=i)},"5b4e":function(t,e,i){var n=i("36c3"),o=i("b447"),r=i("0fc9");t.exports=function(t){return function(e,i,a){var s,l=n(e),h=o(l.length),c=r(a,h);if(t&&i!=i){for(;h>c;)if((s=l[c++])!=s)return!0}else for(;h>c;c++)if((t||c in l)&&l[c]===i)return t||c||0;return!t&&-1}}},"5ca1":function(t,e,i){var n=i("7726"),o=i("8378"),r=i("32e9"),a=i("2aba"),s=i("9b43"),l=function(t,e,i){var h,c,u,d,f=t&l.F,p=t&l.G,g=t&l.S,_=t&l.P,m=t&l.B,v=p?n:g?n[e]||(n[e]={}):(n[e]||{}).prototype,y=p?o:o[e]||(o[e]={}),w=y.prototype||(y.prototype={});p&&(i=e);for(h in i)c=!f&&v&&void 0!==v[h],u=(c?v:i)[h],d=m&&c?s(u,n):_&&"function"==typeof u?s(Function.call,u):u,v&&a(v,h,u,t&l.U),y[h]!=u&&r(y,h,d),_&&w[h]!=u&&(w[h]=u)};n.core=o,l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,t.exports=l},"5d58":function(t,e,i){t.exports=i("d8d6")},"5eda":function(t,e,i){var n=i("5ca1"),o=i("8378"),r=i("79e5");t.exports=function(t,e){var i=(o.Object||{})[t]||Object[t],a={};a[t]=e(i),n(n.S+n.F*r(function(){i(1)}),"Object",a)}},"5f1b":function(t,e,i){"use strict";var n=i("23c6"),o=RegExp.prototype.exec;t.exports=function(t,e){var i=t.exec;if("function"==typeof i){var r=i.call(t,e);if("object"!=typeof r)throw new TypeError("RegExp exec method returned something other than an Object or null");return r}if("RegExp"!==n(t))throw new TypeError("RegExp#exec called on incompatible receiver");return o.call(t,e)}},"613b":function(t,e,i){var n=i("5537")("keys"),o=i("ca5a");t.exports=function(t){return n[t]||(n[t]=o(t))}},"626a":function(t,e,i){var n=i("2d95");t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==n(t)?t.split(""):Object(t)}},"62a0":function(t,e){var i=0,n=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++i+n).toString(36))}},"63b6":function(t,e,i){var n=i("e53d"),o=i("584a"),r=i("d864"),a=i("35e8"),s=i("07e3"),l=function(t,e,i){var h,c,u,d=t&l.F,f=t&l.G,p=t&l.S,g=t&l.P,_=t&l.B,m=t&l.W,v=f?o:o[e]||(o[e]={}),y=v.prototype,w=f?n:p?n[e]:(n[e]||{}).prototype;f&&(i=e);for(h in i)(c=!d&&w&&void 0!==w[h])&&s(v,h)||(u=c?w[h]:i[h],v[h]=f&&"function"!=typeof w[h]?i[h]:_&&c?r(u,n):m&&w[h]==u?function(t){var e=function(e,i,n){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(e);case 2:return new t(e,i)}return new t(e,i,n)}return t.apply(this,arguments)};return e.prototype=t.prototype,e}(u):g&&"function"==typeof u?r(Function.call,u):u,g&&((v.virtual||(v.virtual={}))[h]=u,t&l.R&&y&&!y[h]&&a(y,h,u)))};l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,t.exports=l},"66b5":function(t,e,i){},6718:function(t,e,i){var n=i("e53d"),o=i("584a"),r=i("b8e3"),a=i("ccb9"),s=i("d9f6").f;t.exports=function(t){var e=o.Symbol||(o.Symbol=r?{}:n.Symbol||{});"_"==t.charAt(0)||t in e||s(e,t,{value:a.f(t)})}},"67bb":function(t,e,i){t.exports=i("f921")},6821:function(t,e,i){var n=i("626a"),o=i("be13");t.exports=function(t){return n(o(t))}},"69a8":function(t,e){var i={}.hasOwnProperty;t.exports=function(t,e){return i.call(t,e)}},"69d3":function(t,e,i){i("6718")("asyncIterator")},"6a99":function(t,e,i){var n=i("d3f4");t.exports=function(t,e){if(!n(t))return t;var i,o;if(e&&"function"==typeof(i=t.toString)&&!n(o=i.call(t)))return o;if("function"==typeof(i=t.valueOf)&&!n(o=i.call(t)))return o;if(!e&&"function"==typeof(i=t.toString)&&!n(o=i.call(t)))return o;throw TypeError("Can't convert object to primitive value")}},"6abf":function(t,e,i){var n=i("e6f3"),o=i("1691").concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return n(t,o)}},"6b4c":function(t,e){var i={}.toString;t.exports=function(t){return i.call(t).slice(8,-1)}},"6b6b":function(t,e,i){"use strict";function n(t,e,i){this.$children.forEach(function(o){o.$options.componentName===t?o.$emit.apply(o,[e].concat(i)):n.apply(o,[t,e].concat([i]))})}e.__esModule=!0,e.default={methods:{dispatch:function(t,e,i){for(var n=this.$parent||this.$root,o=n.$options.componentName;n&&(!o||o!==t);)(n=n.$parent)&&(o=n.$options.componentName);n&&n.$emit.apply(n,[e].concat(i))},broadcast:function(t,e,i){n.call(this,t,e,i)}}}},"6c1c":function(t,e,i){i("c367");for(var n=i("e53d"),o=i("35e8"),r=i("481b"),a=i("5168")("toStringTag"),s="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),l=0;l<s.length;l++){var h=s[l],c=n[h],u=c&&c.prototype;u&&!u[a]&&o(u,a,h),r[h]=r.Array}},7144:function(t,e,i){},"71c1":function(t,e,i){var n=i("3a38"),o=i("25eb");t.exports=function(t){return function(e,i){var r,a,s=String(o(e)),l=n(i),h=s.length;return l<0||l>=h?t?"":void 0:(r=s.charCodeAt(l),r<55296||r>56319||l+1===h||(a=s.charCodeAt(l+1))<56320||a>57343?t?s.charAt(l):r:t?s.slice(l,l+2):a-56320+(r-55296<<10)+65536)}}},"73fa":function(t,e,i){"use strict";function n(t,e){if(!t||!e)return!1;if(-1!==e.indexOf(" "))throw new Error("className should not contain space.");return t.classList?t.classList.contains(e):(" "+t.className+" ").indexOf(" "+e+" ")>-1}function o(t,e){if(t){for(var i=t.className,o=(e||"").split(" "),r=0,a=o.length;r<a;r++){var s=o[r];s&&(t.classList?t.classList.add(s):n(t,s)||(i+=" "+s))}t.classList||(t.className=i)}}function r(t,e){if(t&&e){for(var i=e.split(" "),o=" "+t.className+" ",r=0,a=i.length;r<a;r++){var s=i[r];s&&(t.classList?t.classList.remove(s):n(t,s)&&(o=o.replace(" "+s+" "," ")))}t.classList||(t.className=p(o))}}function a(t,e,i){if(t&&e)if("object"===(void 0===e?"undefined":s(e)))for(var n in e)e.hasOwnProperty(n)&&a(t,n,e[n]);else e=g(e),"opacity"===e&&f<9?t.style.filter=isNaN(i)?"":"alpha(opacity="+100*i+")":t.style[e]=i}e.__esModule=!0,e.isInContainer=e.getScrollContainer=e.isScroll=e.getStyle=e.once=e.off=e.on=void 0;var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.hasClass=n,e.addClass=o,e.removeClass=r,e.setStyle=a;var l=i("8bbf"),h=function(t){return t&&t.__esModule?t:{default:t}}(l),c=h.default.prototype.$isServer,u=/([\:\-\_]+(.))/g,d=/^moz([A-Z])/,f=c?0:Number(document.documentMode),p=function(t){return(t||"").replace(/^[\s\uFEFF]+|[\s\uFEFF]+$/g,"")},g=function(t){return t.replace(u,function(t,e,i,n){return n?i.toUpperCase():i}).replace(d,"Moz$1")},_=e.on=function(){return!c&&document.addEventListener?function(t,e,i){t&&e&&i&&t.addEventListener(e,i,!1)}:function(t,e,i){t&&e&&i&&t.attachEvent("on"+e,i)}}(),m=e.off=function(){return!c&&document.removeEventListener?function(t,e,i){t&&e&&t.removeEventListener(e,i,!1)}:function(t,e,i){t&&e&&t.detachEvent("on"+e,i)}}(),v=(e.once=function(t,e,i){_(t,e,function n(){i&&i.apply(this,arguments),m(t,e,n)})},e.getStyle=f<9?function(t,e){if(!c){if(!t||!e)return null;e=g(e),"float"===e&&(e="styleFloat");try{switch(e){case"opacity":try{return t.filters.item("alpha").opacity/100}catch(t){return 1}default:return t.style[e]||t.currentStyle?t.currentStyle[e]:null}}catch(i){return t.style[e]}}}:function(t,e){if(!c){if(!t||!e)return null;e=g(e),"float"===e&&(e="cssFloat");try{var i=document.defaultView.getComputedStyle(t,"");return t.style[e]||i?i[e]:null}catch(i){return t.style[e]}}}),y=e.isScroll=function(t,e){if(!c){return(null!==e||void 0!==e?e?v(t,"overflow-y"):v(t,"overflow-x"):v(t,"overflow")).match(/(scroll|auto)/)}};e.getScrollContainer=function(t,e){if(!c){for(var i=t;i;){if([window,document,document.documentElement].includes(i))return window;if(y(i,e))return i;i=i.parentNode}return i}},e.isInContainer=function(t,e){if(c||!t||!e)return!1;var i=t.getBoundingClientRect(),n=void 0;return n=[window,document,document.documentElement,null,void 0].includes(e)?{top:0,right:window.innerWidth,bottom:window.innerHeight,left:0}:e.getBoundingClientRect(),i.top<n.bottom&&i.bottom>n.top&&i.right>n.left&&i.left<n.right}},7514:function(t,e,i){"use strict";var n=i("5ca1"),o=i("0a49")(5),r=!0;"find"in[]&&Array(1).find(function(){r=!1}),n(n.P+n.F*r,"Array",{find:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0)}}),i("9c6c")("find")},"765d":function(t,e,i){i("6718")("observable")},7726:function(t,e){var i=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=i)},"77f1":function(t,e,i){var n=i("4588"),o=Math.max,r=Math.min;t.exports=function(t,e){return t=n(t),t<0?o(t+e,0):r(t,e)}},"794b":function(t,e,i){t.exports=!i("8e60")&&!i("294c")(function(){return 7!=Object.defineProperty(i("1ec9")("div"),"a",{get:function(){return 7}}).a})},"797b":function(t,e,i){t.exports=function(t){function e(n){if(i[n])return i[n].exports;var o=i[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var i={};return e.m=t,e.c=i,e.d=function(t,i,n){e.o(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:n})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,i){if(1&i&&(t=e(t)),8&i)return t;if(4&i&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(e.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&i&&"string"!=typeof t)for(var o in t)e.d(n,o,function(e){return t[e]}.bind(null,o));return n},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="/dist/",e(e.s=115)}({0:function(t,e,i){"use strict";function n(t,e,i,n,o,r,a,s){var l="function"==typeof t?t.options:t;e&&(l.render=e,l.staticRenderFns=i,l._compiled=!0),n&&(l.functional=!0),r&&(l._scopeId="data-v-"+r);var h;if(a?(h=function(t){t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,t||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),o&&o.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(a)},l._ssrRegister=h):o&&(h=s?function(){o.call(this,this.$root.$options.shadowRoot)}:o),h)if(l.functional){l._injectStyles=h;var c=l.render;l.render=function(t,e){return h.call(e),c(t,e)}}else{var u=l.beforeCreate;l.beforeCreate=u?[].concat(u,h):[h]}return{exports:t,options:l}}i.d(e,"a",function(){return n})},115:function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("li",{staticClass:"el-dropdown-menu__item",class:{"is-disabled":t.disabled,"el-dropdown-menu__item--divided":t.divided},attrs:{"aria-disabled":t.disabled,tabindex:t.disabled?null:-1},on:{click:t.handleClick}},[t.icon?i("i",{class:t.icon}):t._e(),t._t("default")],2)},o=[];n._withStripped=!0;var r=i(3),a=i.n(r),s={name:"ElDropdownItem",mixins:[a.a],props:{command:{},disabled:Boolean,divided:Boolean,icon:String},methods:{handleClick:function(t){this.dispatch("ElDropdown","menu-item-click",[this.command,this])}}},l=s,h=i(0),c=Object(h.a)(l,n,o,!1,null,null,null);c.options.__file="packages/dropdown/src/dropdown-item.vue";var u=c.exports;u.install=function(t){t.component(u.name,u)},u.name="FiDropdownItem";e.default=u},3:function(t,e){t.exports=i("6b6b")}})},"79aa":function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},"79e5":function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},"7e90":function(t,e,i){var n=i("d9f6"),o=i("e4ae"),r=i("c3a1");t.exports=i("8e60")?Object.defineProperties:function(t,e){o(t);for(var i,a=r(e),s=a.length,l=0;s>l;)n.f(t,i=a[l++],e[i]);return t}},"7f20":function(t,e,i){var n=i("86cc").f,o=i("69a8"),r=i("2b4c")("toStringTag");t.exports=function(t,e,i){t&&!o(t=i?t:t.prototype,r)&&n(t,r,{configurable:!0,value:e})}},"7f7f":function(t,e,i){var n=i("86cc").f,o=Function.prototype,r=/^\s*function ([^ (]*)/;"name"in o||i("9e1e")&&n(o,"name",{configurable:!0,get:function(){try{return(""+this).match(r)[1]}catch(t){return""}}})},8306:function(t,e,i){},8378:function(t,e){var i=t.exports={version:"2.6.9"};"number"==typeof __e&&(__e=i)},8436:function(t,e){t.exports=function(){}},"84f2":function(t,e){t.exports={}},"86cc":function(t,e,i){var n=i("cb7c"),o=i("c69a"),r=i("6a99"),a=Object.defineProperty;e.f=i("9e1e")?Object.defineProperty:function(t,e,i){if(n(t),e=r(e,!0),n(i),o)try{return a(t,e,i)}catch(t){}if("get"in i||"set"in i)throw TypeError("Accessors not supported!");return"value"in i&&(t[e]=i.value),t}},"8bbf":function(t,e){t.exports=i("8bbf")},"8e60":function(t,e,i){t.exports=!i("294c")(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},"8f60":function(t,e,i){"use strict";var n=i("a159"),o=i("aebd"),r=i("45f2"),a={};i("35e8")(a,i("5168")("iterator"),function(){return this}),t.exports=function(t,e,i){t.prototype=n(a,{next:o(1,i)}),r(t,e+" Iterator")}},9003:function(t,e,i){var n=i("6b4c");t.exports=Array.isArray||function(t){return"Array"==n(t)}},9138:function(t,e,i){t.exports=i("35e8")},"9aa9":function(t,e){e.f=Object.getOwnPropertySymbols},"9aea":function(t,e,i){"use strict";e.__esModule=!0,e.default=function(){if(o.default.prototype.$isServer)return 0;if(void 0!==r)return r;var t=document.createElement("div");t.className="el-scrollbar__wrap",t.style.visibility="hidden",t.style.width="100px",t.style.position="absolute",t.style.top="-9999px",document.body.appendChild(t);var e=t.offsetWidth;t.style.overflow="scroll";var i=document.createElement("div");i.style.width="100%",t.appendChild(i);var n=i.offsetWidth;return t.parentNode.removeChild(t),r=e-n};var n=i("8bbf"),o=function(t){return t&&t.__esModule?t:{default:t}}(n),r=void 0},"9b43":function(t,e,i){var n=i("d8e8");t.exports=function(t,e,i){if(n(t),void 0===e)return t;switch(i){case 1:return function(i){return t.call(e,i)};case 2:return function(i,n){return t.call(e,i,n)};case 3:return function(i,n,o){return t.call(e,i,n,o)}}return function(){return t.apply(e,arguments)}}},"9c6c":function(t,e,i){var n=i("2b4c")("unscopables"),o=Array.prototype;void 0==o[n]&&i("32e9")(o,n,{}),t.exports=function(t){o[n][t]=!0}},"9def":function(t,e,i){var n=i("4588"),o=Math.min;t.exports=function(t){return t>0?o(n(t),9007199254740991):0}},"9e1e":function(t,e,i){t.exports=!i("79e5")(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},a159:function(t,e,i){var n=i("e4ae"),o=i("7e90"),r=i("1691"),a=i("5559")("IE_PROTO"),s=function(){},l=function(){var t,e=i("1ec9")("iframe"),n=r.length;for(e.style.display="none",i("32fc").appendChild(e),e.src="javascript:",t=e.contentWindow.document,t.open(),t.write("<script>document.F=Object<\/script>"),t.close(),l=t.F;n--;)delete l.prototype[r[n]];return l()};t.exports=Object.create||function(t,e){var i;return null!==t?(s.prototype=n(t),i=new s,s.prototype=null,i[a]=t):i=l(),void 0===e?i:o(i,e)}},a481:function(t,e,i){"use strict";var n=i("cb7c"),o=i("4bf8"),r=i("9def"),a=i("4588"),s=i("0390"),l=i("5f1b"),h=Math.max,c=Math.min,u=Math.floor,d=/\$([$&`']|\d\d?|<[^>]*>)/g,f=/\$([$&`']|\d\d?)/g,p=function(t){return void 0===t?t:String(t)};i("214f")("replace",2,function(t,e,i,g){function _(t,e,n,r,a,s){var l=n+t.length,h=r.length,c=f;return void 0!==a&&(a=o(a),c=d),i.call(s,c,function(i,o){var s;switch(o.charAt(0)){case"$":return"$";case"&":return t;case"`":return e.slice(0,n);case"'":return e.slice(l);case"<":s=a[o.slice(1,-1)];break;default:var c=+o;if(0===c)return i;if(c>h){var d=u(c/10);return 0===d?i:d<=h?void 0===r[d-1]?o.charAt(1):r[d-1]+o.charAt(1):i}s=r[c-1]}return void 0===s?"":s})}return[function(n,o){var r=t(this),a=void 0==n?void 0:n[e];return void 0!==a?a.call(n,r,o):i.call(String(r),n,o)},function(t,e){var o=g(i,t,this,e);if(o.done)return o.value;var u=n(t),d=String(this),f="function"==typeof e;f||(e=String(e));var m=u.global;if(m){var v=u.unicode;u.lastIndex=0}for(var y=[];;){var w=l(u,d);if(null===w)break;if(y.push(w),!m)break;""===String(w[0])&&(u.lastIndex=s(d,r(u.lastIndex),v))}for(var b="",x=0,A=0;A<y.length;A++){w=y[A];for(var C=String(w[0]),T=h(c(a(w.index),d.length),0),k=[],S=1;S<w.length;S++)k.push(p(w[S]));var E=w.groups;if(f){var I=[C].concat(k,T,d);void 0!==E&&I.push(E);var L=String(e.apply(void 0,I))}else L=_(C,d,T,k,E,e);T>=x&&(b+=d.slice(x,T)+L,x=T+C.length)}return b+d.slice(x)}]})},a78e:function(t,e,i){var n,o;!function(r){var a=!1;if(n=r,void 0!==(o="function"==typeof n?n.call(e,i,e,t):n)&&(t.exports=o),a=!0,t.exports=r(),a=!0,!a){var s=window.Cookies,l=window.Cookies=r();l.noConflict=function(){return window.Cookies=s,l}}}(function(){function t(){for(var t=0,e={};t<arguments.length;t++){var i=arguments[t];for(var n in i)e[n]=i[n]}return e}function e(i){function n(e,o,r){var a;if("undefined"!=typeof document){if(arguments.length>1){if(r=t({path:"/"},n.defaults,r),"number"==typeof r.expires){var s=new Date;s.setMilliseconds(s.getMilliseconds()+864e5*r.expires),r.expires=s}r.expires=r.expires?r.expires.toUTCString():"";try{a=JSON.stringify(o),/^[\{\[]/.test(a)&&(o=a)}catch(t){}o=i.write?i.write(o,e):encodeURIComponent(String(o)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),e=encodeURIComponent(String(e)),e=e.replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent),e=e.replace(/[\(\)]/g,escape);var l="";for(var h in r)r[h]&&(l+="; "+h,!0!==r[h]&&(l+="="+r[h]));return document.cookie=e+"="+o+l}e||(a={});for(var c=document.cookie?document.cookie.split("; "):[],u=/(%[0-9A-Z]{2})+/g,d=0;d<c.length;d++){var f=c[d].split("="),p=f.slice(1).join("=");this.json||'"'!==p.charAt(0)||(p=p.slice(1,-1));try{var g=f[0].replace(u,decodeURIComponent);if(p=i.read?i.read(p,g):i(p,g)||p.replace(u,decodeURIComponent),this.json)try{p=JSON.parse(p)}catch(t){}if(e===g){a=p;break}e||(a[g]=p)}catch(t){}}return a}}return n.set=n,n.get=function(t){return n.call(n,t)},n.getJSON=function(){return n.apply({json:!0},[].slice.call(arguments))},n.defaults={},n.remove=function(e,i){n(e,"",t(i,{expires:-1}))},n.withConverter=e,n}return e(function(){})})},aae3:function(t,e,i){var n=i("d3f4"),o=i("2d95"),r=i("2b4c")("match");t.exports=function(t){var e;return n(t)&&(void 0!==(e=t[r])?!!e:"RegExp"==o(t))}},ac6a:function(t,e,i){for(var n=i("cadf"),o=i("0d58"),r=i("2aba"),a=i("7726"),s=i("32e9"),l=i("84f2"),h=i("2b4c"),c=h("iterator"),u=h("toStringTag"),d=l.Array,f={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},p=o(f),g=0;g<p.length;g++){var _,m=p[g],v=f[m],y=a[m],w=y&&y.prototype;if(w&&(w[c]||s(w,c,d),w[u]||s(w,u,m),l[m]=d,v))for(_ in n)w[_]||r(w,_,n[_],!0)}},aebd:function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},b0c5:function(t,e,i){"use strict";var n=i("520a");i("5ca1")({target:"RegExp",proto:!0,forced:n!==/./.exec},{exec:n})},b447:function(t,e,i){var n=i("3a38"),o=Math.min;t.exports=function(t){return t>0?o(n(t),9007199254740991):0}},b8e3:function(t,e){t.exports=!0},bce7:function(t,e,i){"use strict";e.__esModule=!0;i("23af");e.default={mounted:function(){return},methods:{getMigratingConfig:function(){return{props:{},events:{}}}}}},be13:function(t,e){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},bf0b:function(t,e,i){var n=i("355d"),o=i("aebd"),r=i("36c3"),a=i("1bc3"),s=i("07e3"),l=i("794b"),h=Object.getOwnPropertyDescriptor;e.f=i("8e60")?h:function(t,e){if(t=r(t),e=a(e,!0),l)try{return h(t,e)}catch(t){}if(s(t,e))return o(!n.f.call(t,e),t[e])}},c207:function(t,e){},c27e:function(t,e,i){"use strict";e.__esModule=!0;var n=i("8bbf"),o=function(t){return t&&t.__esModule?t:{default:t}}(n),r=i("4ff6"),a=o.default.prototype.$isServer?function(){}:i("437e"),s=function(t){return t.stopPropagation()};e.default={props:{transformOrigin:{type:[Boolean,String],default:!0},placement:{type:String,default:"bottom"},boundariesPadding:{type:Number,default:5},reference:{},popper:{},offset:{default:0},value:Boolean,visibleArrow:Boolean,arrowOffset:{type:Number,default:35},appendToBody:{type:Boolean,default:!0},popperOptions:{type:Object,default:function(){return{gpuAcceleration:!1}}}},data:function(){return{showPopper:!1,currentPlacement:""}},watch:{value:{immediate:!0,handler:function(t){this.showPopper=t,this.$emit("input",t)}},showPopper:function(t){this.disabled||(t?this.updatePopper():this.destroyPopper(),this.$emit("input",t))}},methods:{createPopper:function(){var t=this;if(!this.$isServer&&(this.currentPlacement=this.currentPlacement||this.placement,/^(top|bottom|left|right)(-start|-end)?$/g.test(this.currentPlacement))){var e=this.popperOptions,i=this.popperElm=this.popperElm||this.popper||this.$refs.popper,n=this.referenceElm=this.referenceElm||this.reference||this.$refs.reference;!n&&this.$slots.reference&&this.$slots.reference[0]&&(n=this.referenceElm=this.$slots.reference[0].elm),i&&n&&(this.visibleArrow&&this.appendArrow(i),this.appendToBody&&document.body.appendChild(this.popperElm),this.popperJS&&this.popperJS.destroy&&this.popperJS.destroy(),e.placement=this.currentPlacement,e.offset=this.offset,e.arrowOffset=this.arrowOffset,this.popperJS=new a(n,i,e),this.popperJS.onCreate(function(e){t.$emit("created",t),t.resetTransformOrigin(),t.$nextTick(t.updatePopper)}),"function"==typeof e.onUpdate&&this.popperJS.onUpdate(e.onUpdate),this.popperJS._popper.style.zIndex=r.PopupManager.nextZIndex(),this.popperElm.addEventListener("click",s))}},updatePopper:function(){var t=this.popperJS;t?(t.update(),t._popper&&(t._popper.style.zIndex=r.PopupManager.nextZIndex())):this.createPopper()},doDestroy:function(t){!this.popperJS||this.showPopper&&!t||(this.popperJS.destroy(),this.popperJS=null)},destroyPopper:function(){this.popperJS&&this.resetTransformOrigin()},resetTransformOrigin:function(){if(this.transformOrigin){var t={top:"bottom",bottom:"top",left:"right",right:"left"},e=this.popperJS._popper.getAttribute("x-placement").split("-")[0],i=t[e];this.popperJS._popper.style.transformOrigin="string"==typeof this.transformOrigin?this.transformOrigin:["top","bottom"].indexOf(e)>-1?"center "+i:i+" center"}},appendArrow:function(t){var e=void 0;if(!this.appended){this.appended=!0;for(var i in t.attributes)if(/^_v-/.test(t.attributes[i].name)){e=t.attributes[i].name;break}var n=document.createElement("div");e&&n.setAttribute(e,""),n.setAttribute("x-arrow",""),n.className="popper__arrow",t.appendChild(n)}}},beforeDestroy:function(){this.doDestroy(!0),this.popperElm&&this.popperElm.parentNode===document.body&&(this.popperElm.removeEventListener("click",s),document.body.removeChild(this.popperElm))},deactivated:function(){this.$options.beforeDestroy[0].call(this)}}},c366:function(t,e,i){var n=i("6821"),o=i("9def"),r=i("77f1");t.exports=function(t){return function(e,i,a){var s,l=n(e),h=o(l.length),c=r(a,h);if(t&&i!=i){for(;h>c;)if((s=l[c++])!=s)return!0}else for(;h>c;c++)if((t||c in l)&&l[c]===i)return t||c||0;return!t&&-1}}},c367:function(t,e,i){"use strict";var n=i("8436"),o=i("50ed"),r=i("481b"),a=i("36c3");t.exports=i("30f1")(Array,"Array",function(t,e){this._t=a(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,i=this._i++;return!t||i>=t.length?(this._t=void 0,o(1)):"keys"==e?o(0,i):"values"==e?o(0,t[i]):o(0,[i,t[i]])},"values"),r.Arguments=r.Array,n("keys"),n("values"),n("entries")},c3a1:function(t,e,i){var n=i("e6f3"),o=i("1691");t.exports=Object.keys||function(t){return n(t,o)}},c69a:function(t,e,i){t.exports=!i("9e1e")&&!i("79e5")(function(){return 7!=Object.defineProperty(i("230e")("div"),"a",{get:function(){return 7}}).a})},ca5a:function(t,e){var i=0,n=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++i+n).toString(36))}},cadf:function(t,e,i){"use strict";var n=i("9c6c"),o=i("d53b"),r=i("84f2"),a=i("6821");t.exports=i("01f9")(Array,"Array",function(t,e){this._t=a(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,i=this._i++;return!t||i>=t.length?(this._t=void 0,o(1)):"keys"==e?o(0,i):"values"==e?o(0,t[i]):o(0,[i,t[i]])},"values"),r.Arguments=r.Array,n("keys"),n("values"),n("entries")},cb7c:function(t,e,i){var n=i("d3f4");t.exports=function(t){if(!n(t))throw TypeError(t+" is not an object!");return t}},ccb9:function(t,e,i){e.f=i("5168")},cd1c:function(t,e,i){var n=i("e853");t.exports=function(t,e){return new(n(t))(e)}},ce10:function(t,e,i){var n=i("69a8"),o=i("6821"),r=i("c366")(!1),a=i("613b")("IE_PROTO");t.exports=function(t,e){var i,s=o(t),l=0,h=[];for(i in s)i!=a&&n(s,i)&&h.push(i);for(;e.length>l;)n(s,i=e[l++])&&(~r(h,i)||h.push(i));return h}},d062:function(t,e,i){t.exports=function(t){function e(n){if(i[n])return i[n].exports;var o=i[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var i={};return e.m=t,e.c=i,e.d=function(t,i,n){e.o(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:n})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,i){if(1&i&&(t=e(t)),8&i)return t;if(4&i&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(e.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&i&&"string"!=typeof t)for(var o in t)e.d(n,o,function(e){return t[e]}.bind(null,o));return n},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="/dist/",e(e.s=122)}({0:function(t,e,i){"use strict";function n(t,e,i,n,o,r,a,s){var l="function"==typeof t?t.options:t;e&&(l.render=e,l.staticRenderFns=i,l._compiled=!0),n&&(l.functional=!0),r&&(l._scopeId="data-v-"+r);var h;if(a?(h=function(t){t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,t||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),o&&o.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(a)},l._ssrRegister=h):o&&(h=s?function(){o.call(this,this.$root.$options.shadowRoot)}:o),h)if(l.functional){l._injectStyles=h;var c=l.render;l.render=function(t,e){return h.call(e),c(t,e)}}else{var u=l.beforeCreate;l.beforeCreate=u?[].concat(u,h):[h]}return{exports:t,options:l}}i.d(e,"a",function(){return n})},122:function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("button",{staticClass:"el-button",class:[t.type?"el-button--"+t.type:"",t.buttonSize?"el-button--"+t.buttonSize:"",{"is-disabled":t.buttonDisabled,"is-loading":t.loading,"is-plain":t.plain,"is-round":t.round,"is-circle":t.circle}],attrs:{disabled:t.buttonDisabled||t.loading,autofocus:t.autofocus,type:t.nativeType},on:{click:t.handleClick}},[t.loading?i("i",{staticClass:"el-icon-loading"}):t._e(),t.icon&&!t.loading?i("i",{class:t.icon}):t._e(),t.$slots.default?i("span",[t._t("default")],2):t._e()])},o=[];n._withStripped=!0;var r={name:"ElButton",inject:{elForm:{default:""},elFormItem:{default:""}},props:{type:{type:String,default:"default"},size:String,icon:{type:String,default:""},nativeType:{type:String,default:"button"},loading:Boolean,disabled:Boolean,plain:Boolean,autofocus:Boolean,round:Boolean,circle:Boolean},computed:{_elFormItemSize:function(){return(this.elFormItem||{}).elFormItemSize},buttonSize:function(){return this.size||this._elFormItemSize||(this.$ELEMENT||{}).size},buttonDisabled:function(){return this.disabled||(this.elForm||{}).disabled}},methods:{handleClick:function(t){this.$emit("click",t)}}},a=r,s=i(0),l=Object(s.a)(a,n,o,!1,null,null,null);l.options.__file="packages/button/src/button.vue";var h=l.exports;h.install=function(t){t.component(h.name,h)},h.name="FiButton";e.default=h}})},d3f4:function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},d53b:function(t,e){t.exports=function(t,e){return{value:e,done:!!t}}},d864:function(t,e,i){var n=i("79aa");t.exports=function(t,e,i){if(n(t),void 0===e)return t;switch(i){case 1:return function(i){return t.call(e,i)};case 2:return function(i,n){return t.call(e,i,n)};case 3:return function(i,n,o){return t.call(e,i,n,o)}}return function(){return t.apply(e,arguments)}}},d8d6:function(t,e,i){i("1654"),i("6c1c"),t.exports=i("ccb9").f("iterator")},d8e8:function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},d9f6:function(t,e,i){var n=i("e4ae"),o=i("794b"),r=i("1bc3"),a=Object.defineProperty;e.f=i("8e60")?Object.defineProperty:function(t,e,i){if(n(t),e=r(e,!0),n(i),o)try{return a(t,e,i)}catch(t){}if("get"in i||"set"in i)throw TypeError("Accessors not supported!");return"value"in i&&(t[e]=i.value),t}},db7e:function(t,e,i){},dbdb:function(t,e,i){var n=i("584a"),o=i("e53d"),r=o["__core-js_shared__"]||(o["__core-js_shared__"]={});(t.exports=function(t,e){return r[t]||(r[t]=void 0!==e?e:{})})("versions",[]).push({version:n.version,mode:i("b8e3")?"pure":"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})},e0c7:function(t,e,i){t.exports=function(t){function e(n){if(i[n])return i[n].exports;var o=i[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var i={};return e.m=t,e.c=i,e.d=function(t,i,n){e.o(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:n})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,i){if(1&i&&(t=e(t)),8&i)return t;if(4&i&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(e.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&i&&"string"!=typeof t)for(var o in t)e.d(n,o,function(e){return t[e]}.bind(null,o));return n},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="/dist/",e(e.s=62)}({0:function(t,e,i){"use strict";function n(t,e,i,n,o,r,a,s){var l="function"==typeof t?t.options:t;e&&(l.render=e,l.staticRenderFns=i,l._compiled=!0),n&&(l.functional=!0),r&&(l._scopeId="data-v-"+r);var h;if(a?(h=function(t){t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,t||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),o&&o.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(a)},l._ssrRegister=h):o&&(h=s?function(){o.call(this,this.$root.$options.shadowRoot)}:o),h)if(l.functional){l._injectStyles=h;var c=l.render;l.render=function(t,e){return h.call(e),c(t,e)}}else{var u=l.beforeCreate;l.beforeCreate=u?[].concat(u,h):[h]}return{exports:t,options:l}}i.d(e,"a",function(){return n})},10:function(t,e){t.exports=i("bce7")},11:function(t,e){t.exports=i("e145")},18:function(t,e){t.exports=i("d062")},3:function(t,e){t.exports=i("6b6b")},4:function(t,e){t.exports=i("23af")},51:function(t,e){t.exports=i("1388")},62:function(t,e,i){"use strict";i.r(e);var n=i(11),o=i.n(n),r=i(3),a=i.n(r),s=i(10),l=i.n(s),h=i(18),c=i.n(h),u=i(51),d=i.n(u),f=i(4),p={name:"ElDropdown",componentName:"ElDropdown",mixins:[a.a,l.a],directives:{Clickoutside:o.a},components:{ElButton:c.a,ElButtonGroup:d.a},provide:function(){return{dropdown:this}},props:{trigger:{type:String,default:"hover"},type:String,size:{type:String,default:""},splitButton:Boolean,hideOnClick:{type:Boolean,default:!0},placement:{type:String,default:"bottom-end"},visibleArrow:{default:!0},showTimeout:{type:Number,default:250},hideTimeout:{type:Number,default:150},tabindex:{type:Number,default:0}},data:function(){return{timeout:null,visible:!1,triggerElm:null,menuItems:null,menuItemsArray:null,dropdownElm:null,focusing:!1,listId:"dropdown-menu-"+Object(f.generateId)()}},computed:{dropdownSize:function(){return this.size||(this.$ELEMENT||{}).size}},mounted:function(){this.$on("menu-item-click",this.handleMenuItemClick)},watch:{visible:function(t){this.broadcast("ElDropdownMenu","visible",t),this.$emit("visible-change",t)},focusing:function(t){var e=this.$el.querySelector(".el-dropdown-selfdefine");e&&(t?e.className+=" focusing":e.className=e.className.replace("focusing",""))}},methods:{getMigratingConfig:function(){return{props:{"menu-align":"menu-align is renamed to placement."}}},show:function(){var t=this;this.triggerElm.disabled||(clearTimeout(this.timeout),this.timeout=setTimeout(function(){t.visible=!0},"click"===this.trigger?0:this.showTimeout))},hide:function(){var t=this;this.triggerElm.disabled||(this.removeTabindex(),this.tabindex>=0&&this.resetTabindex(this.triggerElm),clearTimeout(this.timeout),this.timeout=setTimeout(function(){t.visible=!1},"click"===this.trigger?0:this.hideTimeout))},handleClick:function(){this.triggerElm.disabled||(this.visible?this.hide():this.show())},handleTriggerKeyDown:function(t){var e=t.keyCode;[38,40].indexOf(e)>-1?(this.removeTabindex(),this.resetTabindex(this.menuItems[0]),this.menuItems[0].focus(),t.preventDefault(),t.stopPropagation()):13===e?this.handleClick():[9,27].indexOf(e)>-1&&this.hide()},handleItemKeyDown:function(t){var e=t.keyCode,i=t.target,n=this.menuItemsArray.indexOf(i),o=this.menuItemsArray.length-1,r=void 0;[38,40].indexOf(e)>-1?(r=38===e?0!==n?n-1:0:n<o?n+1:o,this.removeTabindex(),this.resetTabindex(this.menuItems[r]),this.menuItems[r].focus(),t.preventDefault(),t.stopPropagation()):13===e?(this.triggerElmFocus(),i.click(),this.hideOnClick&&(this.visible=!1)):[9,27].indexOf(e)>-1&&(this.hide(),this.triggerElmFocus())},resetTabindex:function(t){this.removeTabindex(),t.setAttribute("tabindex","0")},removeTabindex:function(){this.triggerElm.setAttribute("tabindex","-1"),this.menuItemsArray.forEach(function(t){t.setAttribute("tabindex","-1")})},initAria:function(){this.dropdownElm.setAttribute("id",this.listId),this.triggerElm.setAttribute("aria-haspopup","list"),this.triggerElm.setAttribute("aria-controls",this.listId),this.splitButton||(this.triggerElm.setAttribute("role","button"),this.triggerElm.setAttribute("tabindex",this.tabindex),this.triggerElm.setAttribute("class",(this.triggerElm.getAttribute("class")||"")+" el-dropdown-selfdefine"))},initEvent:function(){var t=this,e=this.trigger,i=this.show,n=this.hide,o=this.handleClick,r=this.splitButton,a=this.handleTriggerKeyDown,s=this.handleItemKeyDown;this.triggerElm=r?this.$refs.trigger.$el:this.$slots.default[0].elm;var l=this.dropdownElm;this.triggerElm.addEventListener("keydown",a),l.addEventListener("keydown",s,!0),r||(this.triggerElm.addEventListener("focus",function(){t.focusing=!0}),this.triggerElm.addEventListener("blur",function(){t.focusing=!1}),this.triggerElm.addEventListener("click",function(){t.focusing=!1})),"hover"===e?(this.triggerElm.addEventListener("mouseenter",i),this.triggerElm.addEventListener("mouseleave",n),l.addEventListener("mouseenter",i),l.addEventListener("mouseleave",n)):"click"===e&&this.triggerElm.addEventListener("click",o)},handleMenuItemClick:function(t,e){this.hideOnClick&&(this.visible=!1),this.$emit("command",t,e)},triggerElmFocus:function(){this.triggerElm.focus&&this.triggerElm.focus()},initDomOperation:function(){this.dropdownElm=this.popperElm,this.menuItems=this.dropdownElm.querySelectorAll("[tabindex='-1']"),this.menuItemsArray=[].slice.call(this.menuItems),this.initEvent(),this.initAria()}},render:function(t){var e=this,i=this.hide,n=this.splitButton,o=this.type,r=this.dropdownSize,a=function(t){e.$emit("click",t),i()},s=n?t("el-button-group",[t("el-button",{attrs:{type:o,size:r},nativeOn:{click:a}},[this.$slots.default]),t("el-button",{ref:"trigger",attrs:{type:o,size:r},class:"el-dropdown__caret-button"},[t("i",{class:"el-dropdown__icon el-icon-arrow-down"})])]):this.$slots.default;return t("div",{class:"el-dropdown",directives:[{name:"clickoutside",value:i}]},[s,this.$slots.dropdown])}},g=p,_=i(0),m=Object(_.a)(g,void 0,void 0,!1,null,null,null);m.options.__file="packages/dropdown/src/dropdown.vue";var v=m.exports,y={props:{widthType:String},mounted:function(){this.initWidth()},methods:{show:function(){var t=this;this.triggerElm.getAttribute("disabled")||(clearTimeout(this.timeout),this.timeout=setTimeout(function(){t.visible=!0},"click"===this.trigger?0:this.showTimeout))},initWidth:function(){if(this.widthType){var t="follow"===this.widthType?this.$el.offsetWidth+"px":this.widthType;this.dropdownElm&&(this.dropdownElm.style.width=t)}}}},w={name:"FiDropdown",extends:v,mixins:[y]};w.install=function(t){t.component(w.name,w)};e.default=w}})},e11e:function(t,e){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},e145:function(t,e,i){"use strict";function n(t,e,i){return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!(i&&i.context&&n.target&&o.target)||t.contains(n.target)||t.contains(o.target)||t===n.target||i.context.popperElm&&(i.context.popperElm.contains(n.target)||i.context.popperElm.contains(o.target))||(e.expression&&t[l].methodName&&i.context[t[l].methodName]?i.context[t[l].methodName]():t[l].bindingFn&&t[l].bindingFn())}}e.__esModule=!0;var o=i("8bbf"),r=function(t){return t&&t.__esModule?t:{default:t}}(o),a=i("73fa"),s=[],l="@@clickoutsideContext",h=void 0,c=0;!r.default.prototype.$isServer&&(0,a.on)(document,"mousedown",function(t){return h=t}),!r.default.prototype.$isServer&&(0,a.on)(document,"mouseup",function(t){s.forEach(function(e){return e[l].documentHandler(t,h)})}),e.default={bind:function(t,e,i){s.push(t);var o=c++;t[l]={id:o,documentHandler:n(t,e,i),methodName:e.expression,bindingFn:e.value}},update:function(t,e,i){t[l].documentHandler=n(t,e,i),t[l].methodName=e.expression,t[l].bindingFn=e.value},unbind:function(t){for(var e=s.length,i=0;i<e;i++)if(s[i][l].id===t[l].id){s.splice(i,1);break}delete t[l]}}},e4ae:function(t,e,i){var n=i("f772");t.exports=function(t){if(!n(t))throw TypeError(t+" is not an object!");return t}},e53d:function(t,e){var i=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=i)},e6f3:function(t,e,i){var n=i("07e3"),o=i("36c3"),r=i("5b4e")(!1),a=i("5559")("IE_PROTO");t.exports=function(t,e){var i,s=o(t),l=0,h=[];for(i in s)i!=a&&n(s,i)&&h.push(i);for(;e.length>l;)n(s,i=e[l++])&&(~r(h,i)||h.push(i));return h}},e853:function(t,e,i){var n=i("d3f4"),o=i("1169"),r=i("2b4c")("species");t.exports=function(t){var e;return o(t)&&(e=t.constructor,"function"!=typeof e||e!==Array&&!o(e.prototype)||(e=void 0),n(e)&&null===(e=e[r])&&(e=void 0)),void 0===e?Array:e}},ebd6:function(t,e,i){var n=i("cb7c"),o=i("d8e8"),r=i("2b4c")("species");t.exports=function(t,e){var i,a=n(t).constructor;return void 0===a||void 0==(i=n(a)[r])?e:o(i)}},ebfd:function(t,e,i){var n=i("62a0")("meta"),o=i("f772"),r=i("07e3"),a=i("d9f6").f,s=0,l=Object.isExtensible||function(){return!0},h=!i("294c")(function(){return l(Object.preventExtensions({}))}),c=function(t){a(t,n,{value:{i:"O"+ ++s,w:{}}})},u=function(t,e){if(!o(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!r(t,n)){if(!l(t))return"F";if(!e)return"E";c(t)}return t[n].i},d=function(t,e){if(!r(t,n)){if(!l(t))return!0;if(!e)return!1;c(t)}return t[n].w},f=function(t){return h&&p.NEED&&l(t)&&!r(t,n)&&c(t),t},p=t.exports={KEY:n,NEED:!1,fastKey:u,getWeak:d,onFreeze:f}},f6fd:function(t,e){!function(t){var e=t.getElementsByTagName("script");"currentScript"in t||Object.defineProperty(t,"currentScript",{get:function(){try{throw new Error}catch(n){var t,i=(/.*at [^\(]*\((.*):.+:.+\)$/gi.exec(n.stack)||[!1])[1];for(t in e)if(e[t].src==i||"interactive"==e[t].readyState)return e[t];return null}}})}(document)},f772:function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},f921:function(t,e,i){i("014b"),i("c207"),i("69d3"),i("765d"),t.exports=i("584a").Symbol},fa5b:function(t,e,i){t.exports=i("5537")("native-function-to-string",Function.toString)},fab2:function(t,e,i){var n=i("7726").document;t.exports=n&&n.documentElement},fb15:function(t,e,i){"use strict";function n(){return $.a.get(q)||K}function o(t){$.a.set(q,t)}function r(){return J}function a(t){J=t}function s(t,e){"undefined"!=typeof console&&(console.warn("[vue-i18n] "+t),e&&console.warn(e.stack))}function l(t,e){"undefined"!=typeof console&&(console.error("[vue-i18n] "+t),e&&console.error(e.stack))}function h(t){return null!==t&&"object"==typeof t}function c(t){return at.call(t)===st}function u(t){return null===t||void 0===t}function d(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var i=null,n=null;return 1===t.length?h(t[0])||Array.isArray(t[0])?n=t[0]:"string"==typeof t[0]&&(i=t[0]):2===t.length&&("string"==typeof t[0]&&(i=t[0]),(h(t[1])||Array.isArray(t[1]))&&(n=t[1])),{locale:i,params:n}}function f(t){return JSON.parse(JSON.stringify(t))}function p(t,e){if(t.length){var i=t.indexOf(e);if(i>-1)return t.splice(i,1)}}function g(t,e){return lt.call(t,e)}function _(t){for(var e=arguments,i=Object(t),n=1;n<arguments.length;n++){var o=e[n];if(void 0!==o&&null!==o){var r=void 0;for(r in o)g(o,r)&&(h(o[r])?i[r]=_(i[r],o[r]):i[r]=o[r])}}return i}function m(t,e){if(t===e)return!0;var i=h(t),n=h(e);if(!i||!n)return!i&&!n&&String(t)===String(e);try{var o=Array.isArray(t),r=Array.isArray(e);if(o&&r)return t.length===e.length&&t.every(function(t,i){return m(t,e[i])});if(o||r)return!1;var a=Object.keys(t),s=Object.keys(e);return a.length===s.length&&a.every(function(i){return m(t[i],e[i])})}catch(t){return!1}}function v(t){t.prototype.hasOwnProperty("$i18n")||Object.defineProperty(t.prototype,"$i18n",{get:function(){return this._i18n}}),t.prototype.$t=function(t){for(var e=[],i=arguments.length-1;i-- >0;)e[i]=arguments[i+1];var n=this.$i18n;return n._t.apply(n,[t,n.locale,n._getMessages(),this].concat(e))},t.prototype.$tc=function(t,e){for(var i=[],n=arguments.length-2;n-- >0;)i[n]=arguments[n+2];var o=this.$i18n;return o._tc.apply(o,[t,o.locale,o._getMessages(),this,e].concat(i))},t.prototype.$te=function(t,e){var i=this.$i18n;return i._te(t,i.locale,i._getMessages(),e)},t.prototype.$d=function(t){for(var e,i=[],n=arguments.length-1;n-- >0;)i[n]=arguments[n+1];return(e=this.$i18n).d.apply(e,[t].concat(i))},t.prototype.$n=function(t){for(var e,i=[],n=arguments.length-1;n-- >0;)i[n]=arguments[n+1];return(e=this.$i18n).n.apply(e,[t].concat(i))}}function y(t,e,i){x(t,i)&&C(t,e,i)}function w(t,e,i,n){if(x(t,i)){var o=i.context.$i18n;A(t,i)&&m(e.value,e.oldValue)&&m(t._localeMessage,o.getLocaleMessage(o.locale))||C(t,e,i)}}function b(t,e,i,n){if(!i.context)return void s("Vue instance does not exists in VNode context");var o=i.context.$i18n||{};e.modifiers.preserve||o.preserveDirectiveContent||(t.textContent=""),t._vt=void 0,delete t._vt,t._locale=void 0,delete t._locale,t._localeMessage=void 0,delete t._localeMessage}function x(t,e){var i=e.context;return i?!!i.$i18n||(s("VueI18n instance does not exists in Vue instance"),!1):(s("Vue instance does not exists in VNode context"),!1)}function A(t,e){var i=e.context;return t._locale===i.$i18n.locale}function C(t,e,i){var n,o,r=e.value,a=T(r),l=a.path,h=a.locale,c=a.args,u=a.choice;if(!l&&!h&&!c)return void s("value type not supported");if(!l)return void s("`path` is required in v-t directive");var d=i.context;t._vt=t.textContent=u?(n=d.$i18n).tc.apply(n,[l,u].concat(k(h,c))):(o=d.$i18n).t.apply(o,[l].concat(k(h,c))),t._locale=d.$i18n.locale,t._localeMessage=d.$i18n.getLocaleMessage(d.$i18n.locale)}function T(t){var e,i,n,o;return"string"==typeof t?e=t:c(t)&&(e=t.path,i=t.locale,n=t.args,o=t.choice),{path:e,locale:i,args:n,choice:o}}function k(t,e){var i=[];return t&&i.push(t),e&&(Array.isArray(e)||c(e))&&i.push(e),i}function S(t){S.installed=!0,nt=t;nt.version&&Number(nt.version.split(".")[0]);v(nt),nt.mixin(ht),nt.directive("t",{bind:y,update:w,unbind:b}),nt.component(ct.name,ct),nt.component(ut.name,ut),nt.config.optionMergeStrategies.i18n=function(t,e){return void 0===e?t:e}}function E(t){for(var e=[],i=0,n="";i<t.length;){var o=t[i++];if("{"===o){n&&e.push({type:"text",value:n}),n="";var r="";for(o=t[i++];void 0!==o&&"}"!==o;)r+=o,o=t[i++];var a="}"===o,s=ft.test(r)?"list":a&&pt.test(r)?"named":"unknown";e.push({value:r,type:s})}else"%"===o?"{"!==t[i]&&(n+=o):n+=o}return n&&e.push({type:"text",value:n}),e}function I(t,e){var i=[],n=0,o=Array.isArray(e)?"list":h(e)?"named":"unknown";if("unknown"===o)return i;for(;n<t.length;){var r=t[n];switch(r.type){case"text":i.push(r.value);break;case"list":i.push(e[parseInt(r.value,10)]);break;case"named":"named"===o&&i.push(e[r.value])}n++}return i}function L(t){return kt.test(t)}function R(t){var e=t.charCodeAt(0);return e!==t.charCodeAt(t.length-1)||34!==e&&39!==e?t:t.slice(1,-1)}function P(t){if(void 0===t||null===t)return"eof";switch(t.charCodeAt(0)){case 91:case 93:case 46:case 34:case 39:return t;case 95:case 36:case 45:return"ident";case 9:case 10:case 13:case 160:case 65279:case 8232:case 8233:return"ws"}return"ident"}function O(t){var e=t.trim();return("0"!==t.charAt(0)||!isNaN(t))&&(L(e)?R(e):"*"+e)}function D(t){var e,i,n,o,r,a,s,l=[],h=-1,c=yt,u=0,d=[];for(d[_t]=function(){void 0!==i&&(l.push(i),i=void 0)},d[gt]=function(){void 0===i?i=n:i+=n},d[mt]=function(){d[gt](),u++},d[vt]=function(){if(u>0)u--,c=wt,d[gt]();else{if(u=0,!1===(i=O(i)))return!1;d[_t]()}};null!==c;)if(h++,"\\"!==(e=t[h])||!function(){var e=t[h+1];if(c===bt&&"'"===e||c===xt&&'"'===e)return h++,n="\\"+e,d[gt](),!0}()){if(o=P(e),s=Tt[c],(r=s[o]||s.else||Ct)===Ct)return;if(c=r[0],(a=d[r[1]])&&(n=r[2],n=void 0===n?e:n,!1===a()))return;if(c===At)return l}}function M(t,e){t.use(Bt);var i=n();return new Bt({locale:i,fallbackLocale:i,messages:e})}function N(t){return(N="function"==typeof Ht.a&&"symbol"==typeof Ut.a?function(t){return typeof t}:function(t){return t&&"function"==typeof Ht.a&&t.constructor===Ht.a&&t!==Ht.a.prototype?"symbol":typeof t})(t)}function B(t){return(B="function"==typeof Ht.a&&"symbol"===N(Ut.a)?function(t){return N(t)}:function(t){return t&&"function"==typeof Ht.a&&t.constructor===Ht.a&&t!==Ht.a.prototype?"symbol":N(t)})(t)}function F(t,e){return Object.prototype.hasOwnProperty.call(t,e)}if(i.r(e),"undefined"!=typeof window){i("f6fd");var z;(z=window.document.currentScript)&&(z=z.src.match(/(.+\/)[^\/]+\.js(\?.*)?$/))&&(i.p=z[1])}var V=(i("7f7f"),function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("dropdown",{staticClass:"fi-lang-select",on:{command:t.handleCommand}},[i("span",{staticClass:"fi-lang-select__link"},[i("span",{staticClass:"fi-lang-select__link__text"},[t._v(t._s(t.lang))]),i("i",{staticClass:"el-icon-arrow-down fi-lang-select__link__icon"})]),i("dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},t._l(t.localList,function(e,n){return i("dropdown-item",{key:n,attrs:{command:e.value}},[t._v(t._s(e.label))])}),1)],1)}),U=[],j=(i("ac6a"),i("cadf"),i("456d"),i("7514"),i("66b5"),i("8306"),i("797b")),H=i.n(j),W=(i("db7e"),i("4800")),G=i.n(W),Z=(i("ff3c"),i("e0c7")),X=i.n(Z),Y=i("a78e"),$=i.n(Y),q="LOCALE",K="zh-CN",J={"zh-CN":"简体中文",en:"English"},Q={name:"FiLangSelect",components:{Dropdown:X.a,DropdownMenu:G.a,DropdownItem:H.a},props:{options:{type:Array}},data:function(){return{langValue:n(),autoLocalList:[]}},computed:{localList:function(){return this.options?this.options:this.autoLocalList},lang:function(){var t=this;return(this.localList.find(function(e){return e.value===t.langValue})||{}).label}},created:function(){var t=this;if(!this.options&&this.$i18n){var e=Object.keys(this.$i18n._getMessages()),i=r();e.forEach(function(e){t.autoLocalList.push({value:e,label:i[e]})})}},methods:{handleCommand:function(t){t!==n()&&(this.langValue=t,this.$i18n.locale=t,o(t),this.$emit("change",t))}}},tt=Q,et=(i("3aff"),function(t,e,i,n,o,r,a,s){var l="function"==typeof t?t.options:t;e&&(l.render=e,l.staticRenderFns=i,l._compiled=!0),n&&(l.functional=!0),r&&(l._scopeId="data-v-"+r);var h;if(a?(h=function(t){t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,t||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),o&&o.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(a)},l._ssrRegister=h):o&&(h=s?function(){o.call(this,this.$root.$options.shadowRoot)}:o),h)if(l.functional){l._injectStyles=h;var c=l.render;l.render=function(t,e){return h.call(e),c(t,e)}}else{var u=l.beforeCreate;l.beforeCreate=u?[].concat(u,h):[h]}return{exports:t,options:l}}(tt,V,U,!1,null,"a687b908",null)),it=et.exports;it.install=function(t){t.component(it.name,it)};var nt,ot=it,rt=["style","currency","currencyDisplay","useGrouping","minimumIntegerDigits","minimumFractionDigits","maximumFractionDigits","minimumSignificantDigits","maximumSignificantDigits","localeMatcher","formatMatcher"],at=Object.prototype.toString,st="[object Object]",lt=Object.prototype.hasOwnProperty,ht={beforeCreate:function(){var t=this.$options;if(t.i18n=t.i18n||(t.__i18n?{}:null),t.i18n){if(t.i18n instanceof Dt){if(t.__i18n)try{var e={};t.__i18n.forEach(function(t){e=_(e,JSON.parse(t))}),Object.keys(e).forEach(function(i){t.i18n.mergeLocaleMessage(i,e[i])})}catch(t){}this._i18n=t.i18n,this._i18nWatcher=this._i18n.watchI18nData()}else if(c(t.i18n)){if(this.$root&&this.$root.$i18n&&this.$root.$i18n instanceof Dt&&(t.i18n.root=this.$root,t.i18n.formatter=this.$root.$i18n.formatter,t.i18n.fallbackLocale=this.$root.$i18n.fallbackLocale,t.i18n.silentTranslationWarn=this.$root.$i18n.silentTranslationWarn,t.i18n.silentFallbackWarn=this.$root.$i18n.silentFallbackWarn,t.i18n.pluralizationRules=this.$root.$i18n.pluralizationRules,t.i18n.preserveDirectiveContent=this.$root.$i18n.preserveDirectiveContent),t.__i18n)try{var i={};t.__i18n.forEach(function(t){i=_(i,JSON.parse(t))}),t.i18n.messages=i}catch(t){}this._i18n=new Dt(t.i18n),this._i18nWatcher=this._i18n.watchI18nData(),(void 0===t.i18n.sync||t.i18n.sync)&&(this._localeWatcher=this.$i18n.watchLocale())}}else this.$root&&this.$root.$i18n&&this.$root.$i18n instanceof Dt?this._i18n=this.$root.$i18n:t.parent&&t.parent.$i18n&&t.parent.$i18n instanceof Dt&&(this._i18n=t.parent.$i18n)},beforeMount:function(){var t=this.$options;t.i18n=t.i18n||(t.__i18n?{}:null),t.i18n?t.i18n instanceof Dt?(this._i18n.subscribeDataChanging(this),this._subscribing=!0):c(t.i18n)&&(this._i18n.subscribeDataChanging(this),this._subscribing=!0):this.$root&&this.$root.$i18n&&this.$root.$i18n instanceof Dt?(this._i18n.subscribeDataChanging(this),this._subscribing=!0):t.parent&&t.parent.$i18n&&t.parent.$i18n instanceof Dt&&(this._i18n.subscribeDataChanging(this),this._subscribing=!0)},beforeDestroy:function(){if(this._i18n){var t=this;this.$nextTick(function(){t._subscribing&&(t._i18n.unsubscribeDataChanging(t),delete t._subscribing),t._i18nWatcher&&(t._i18nWatcher(),t._i18n.destroyVM(),delete t._i18nWatcher),t._localeWatcher&&(t._localeWatcher(),delete t._localeWatcher),t._i18n=null})}}},ct={name:"i18n",functional:!0,props:{tag:{type:String,default:"span"},path:{type:String,required:!0},locale:{type:String},places:{type:[Array,Object]}},render:function(t,e){var i=e.props,n=e.data,o=e.children,r=e.parent,a=r.$i18n;if(o=(o||[]).filter(function(t){return t.tag||(t.text=t.text.trim())}),!a)return o;var s=i.path,l=i.locale,h={},c=i.places||{},u=(Array.isArray(c)?c.length:Object.keys(c).length,o.every(function(t){if(t.data&&t.data.attrs){var e=t.data.attrs.place;return void 0!==e&&""!==e}}));return Array.isArray(c)?c.forEach(function(t,e){h[e]=t}):Object.keys(c).forEach(function(t){h[t]=c[t]}),o.forEach(function(t,e){var i=u?""+t.data.attrs.place:""+e;h[i]=t}),t(i.tag,n,a.i(s,l,h))}},ut={name:"i18n-n",functional:!0,props:{tag:{type:String,default:"span"},value:{type:Number,required:!0},format:{type:[String,Object]},locale:{type:String}},render:function(t,e){var i=e.props,n=e.parent,o=e.data,r=n.$i18n;if(!r)return null;var a=null,s=null;"string"==typeof i.format?a=i.format:h(i.format)&&(i.format.key&&(a=i.format.key),s=Object.keys(i.format).reduce(function(t,e){var n;return rt.includes(e)?Object.assign({},t,(n={},n[e]=i.format[e],n)):t},null));var l=i.locale||r.locale,c=r._ntp(i.value,l,a,s),u=c.map(function(t,e){var i,n=o.scopedSlots&&o.scopedSlots[t.type];return n?n((i={},i[t.type]=t.value,i.index=e,i.parts=c,i)):t.value});return t(i.tag,{attrs:o.attrs,class:o.class,staticClass:o.staticClass},u)}},dt=function(){this._caches=Object.create(null)};dt.prototype.interpolate=function(t,e){if(!e)return[t];var i=this._caches[t];return i||(i=E(t),this._caches[t]=i),I(i,e)};var ft=/^(?:\d)+/,pt=/^(?:\w)+/,gt=0,_t=1,mt=2,vt=3,yt=0,wt=4,bt=5,xt=6,At=7,Ct=8,Tt=[];Tt[yt]={ws:[yt],ident:[3,gt],"[":[wt],eof:[At]},Tt[1]={ws:[1],".":[2],"[":[wt],eof:[At]},Tt[2]={ws:[2],ident:[3,gt],0:[3,gt],number:[3,gt]},Tt[3]={ident:[3,gt],0:[3,gt],number:[3,gt],ws:[1,_t],".":[2,_t],"[":[wt,_t],eof:[At,_t]},Tt[wt]={"'":[bt,gt],'"':[xt,gt],"[":[wt,mt],"]":[1,vt],eof:Ct,else:[wt,gt]},Tt[bt]={"'":[wt,gt],eof:Ct,else:[bt,gt]},Tt[xt]={'"':[wt,gt],eof:Ct,else:[xt,gt]};var kt=/^\s?(?:true|false|-?[\d.]+|'[^']*'|"[^"]*")\s?$/,St=function(){this._cache=Object.create(null)};St.prototype.parsePath=function(t){var e=this._cache[t];return e||(e=D(t))&&(this._cache[t]=e),e||[]},St.prototype.getPathValue=function(t,e){if(!h(t))return null;var i=this.parsePath(e);if(0===i.length)return null;for(var n=i.length,o=t,r=0;r<n;){var a=o[i[r]];if(void 0===a)return null;o=a,r++}return o};var Et=/<\/?[\w\s="\/.':;#-\/]+>/,It=/(?:@(?:\.[a-z]+)?:(?:[\w\-_|.]+|\([\w\-_|.]+\)))/g,Lt=/^@(?:\.([a-z]+))?:/,Rt=/[()]/g,Pt={upper:function(t){return t.toLocaleUpperCase()},lower:function(t){return t.toLocaleLowerCase()}},Ot=new dt,Dt=function(t){var e=this;void 0===t&&(t={}),!nt&&"undefined"!=typeof window&&window.Vue&&S(window.Vue);var i=t.locale||"en-US",n=t.fallbackLocale||"en-US",o=t.messages||{},r=t.dateTimeFormats||{},a=t.numberFormats||{};this._vm=null,this._formatter=t.formatter||Ot,this._missing=t.missing||null,this._root=t.root||null,this._sync=void 0===t.sync||!!t.sync,this._fallbackRoot=void 0===t.fallbackRoot||!!t.fallbackRoot,this._silentTranslationWarn=void 0!==t.silentTranslationWarn&&!!t.silentTranslationWarn,this._silentFallbackWarn=void 0!==t.silentFallbackWarn&&!!t.silentFallbackWarn,this._dateTimeFormatters={},this._numberFormatters={},this._path=new St,this._dataListeners=[],this._preserveDirectiveContent=void 0!==t.preserveDirectiveContent&&!!t.preserveDirectiveContent,this.pluralizationRules=t.pluralizationRules||{},this._warnHtmlInMessage=t.warnHtmlInMessage||"off",this._exist=function(t,i){return!(!t||!i)&&(!u(e._path.getPathValue(t,i))||!!t[i])},"warn"!==this._warnHtmlInMessage&&"error"!==this._warnHtmlInMessage||Object.keys(o).forEach(function(t){e._checkLocaleMessage(t,e._warnHtmlInMessage,o[t])}),this._initVM({locale:i,fallbackLocale:n,messages:o,dateTimeFormats:r,numberFormats:a})},Mt={vm:{configurable:!0},messages:{configurable:!0},dateTimeFormats:{configurable:!0},numberFormats:{configurable:!0},availableLocales:{configurable:!0},locale:{configurable:!0},fallbackLocale:{configurable:!0},missing:{configurable:!0},formatter:{configurable:!0},silentTranslationWarn:{configurable:!0},silentFallbackWarn:{configurable:!0},preserveDirectiveContent:{configurable:!0},warnHtmlInMessage:{configurable:!0}};Dt.prototype._checkLocaleMessage=function(t,e,i){var n=[],o=function(t,e,i,n){if(c(i))Object.keys(i).forEach(function(r){var a=i[r];c(a)?(n.push(r),n.push("."),o(t,e,a,n),n.pop(),n.pop()):(n.push(r),o(t,e,a,n),n.pop())});else if(Array.isArray(i))i.forEach(function(i,r){c(i)?(n.push("["+r+"]"),n.push("."),o(t,e,i,n),n.pop(),n.pop()):(n.push("["+r+"]"),o(t,e,i,n),n.pop())});else if("string"==typeof i){var r=Et.test(i);if(r){var a="Detected HTML in message '"+i+"' of keypath '"+n.join("")+"' at '"+e+"'. Consider component interpolation with '<i18n>' to avoid XSS. See https://bit.ly/2ZqJzkp";"warn"===t?s(a):"error"===t&&l(a)}}};o(e,t,i,n)},Dt.prototype._initVM=function(t){var e=nt.config.silent;nt.config.silent=!0,this._vm=new nt({data:t}),nt.config.silent=e},Dt.prototype.destroyVM=function(){this._vm.$destroy()},Dt.prototype.subscribeDataChanging=function(t){this._dataListeners.push(t)},Dt.prototype.unsubscribeDataChanging=function(t){p(this._dataListeners,t)},Dt.prototype.watchI18nData=function(){var t=this;return this._vm.$watch("$data",function(){for(var e=t._dataListeners.length;e--;)nt.nextTick(function(){t._dataListeners[e]&&t._dataListeners[e].$forceUpdate()})},{deep:!0})},Dt.prototype.watchLocale=function(){if(!this._sync||!this._root)return null;var t=this._vm;return this._root.$i18n.vm.$watch("locale",function(e){t.$set(t,"locale",e),t.$forceUpdate()},{immediate:!0})},Mt.vm.get=function(){return this._vm},Mt.messages.get=function(){return f(this._getMessages())},Mt.dateTimeFormats.get=function(){return f(this._getDateTimeFormats())},Mt.numberFormats.get=function(){return f(this._getNumberFormats())},Mt.availableLocales.get=function(){return Object.keys(this.messages).sort()},Mt.locale.get=function(){return this._vm.locale},Mt.locale.set=function(t){this._vm.$set(this._vm,"locale",t)},Mt.fallbackLocale.get=function(){return this._vm.fallbackLocale},Mt.fallbackLocale.set=function(t){this._vm.$set(this._vm,"fallbackLocale",t)},Mt.missing.get=function(){return this._missing},Mt.missing.set=function(t){this._missing=t},Mt.formatter.get=function(){return this._formatter},Mt.formatter.set=function(t){this._formatter=t},Mt.silentTranslationWarn.get=function(){return this._silentTranslationWarn},Mt.silentTranslationWarn.set=function(t){this._silentTranslationWarn=t},Mt.silentFallbackWarn.get=function(){return this._silentFallbackWarn},Mt.silentFallbackWarn.set=function(t){this._silentFallbackWarn=t},Mt.preserveDirectiveContent.get=function(){return this._preserveDirectiveContent},Mt.preserveDirectiveContent.set=function(t){this._preserveDirectiveContent=t},Mt.warnHtmlInMessage.get=function(){return this._warnHtmlInMessage},Mt.warnHtmlInMessage.set=function(t){var e=this,i=this._warnHtmlInMessage;if(this._warnHtmlInMessage=t,i!==t&&("warn"===t||"error"===t)){var n=this._getMessages();Object.keys(n).forEach(function(t){e._checkLocaleMessage(t,e._warnHtmlInMessage,n[t])})}},Dt.prototype._getMessages=function(){return this._vm.messages},Dt.prototype._getDateTimeFormats=function(){return this._vm.dateTimeFormats},Dt.prototype._getNumberFormats=function(){return this._vm.numberFormats},Dt.prototype._warnDefault=function(t,e,i,n,o){if(!u(i))return i;if(this._missing){var r=this._missing.apply(null,[t,e,n,o]);if("string"==typeof r)return r}return e},Dt.prototype._isFallbackRoot=function(t){return!t&&!u(this._root)&&this._fallbackRoot},Dt.prototype._isSilentFallback=function(t){return this._silentFallbackWarn&&(this._isFallbackRoot()||t!==this.fallbackLocale)},Dt.prototype._interpolate=function(t,e,i,n,o,r,a){if(!e)return null;var s=this._path.getPathValue(e,i);if(Array.isArray(s)||c(s))return s;var l;if(u(s)){if(!c(e))return null;if("string"!=typeof(l=e[i]))return null}else{if("string"!=typeof s)return null;l=s}return(l.indexOf("@:")>=0||l.indexOf("@.")>=0)&&(l=this._link(t,e,l,n,"raw",r,a)),this._render(l,o,r,i)},Dt.prototype._link=function(t,e,i,n,o,r,a){var s=i,l=s.match(It);for(var h in l)if(l.hasOwnProperty(h)){var c=l[h],u=c.match(Lt),d=u[0],f=u[1],p=c.replace(d,"").replace(Rt,"");if(a.includes(p))return s;a.push(p);var g=this._interpolate(t,e,p,n,"raw"===o?"string":o,"raw"===o?void 0:r,a);if(this._isFallbackRoot(g)){if(!this._root)throw Error("unexpected error");var _=this._root.$i18n;g=_._translate(_._getMessages(),_.locale,_.fallbackLocale,p,n,o,r)}g=this._warnDefault(t,p,g,n,Array.isArray(r)?r:[r]),Pt.hasOwnProperty(f)&&(g=Pt[f](g)),a.pop(),s=g?s.replace(c,g):s}return s},Dt.prototype._render=function(t,e,i,n){var o=this._formatter.interpolate(t,i,n);return o||(o=Ot.interpolate(t,i,n)),"string"===e?o.join(""):o},Dt.prototype._translate=function(t,e,i,n,o,r,a){var s=this._interpolate(e,t[e],n,o,r,a,[n]);return u(s)?(s=this._interpolate(i,t[i],n,o,r,a,[n]),u(s)?null:s):s},Dt.prototype._t=function(t,e,i,n){for(var o,r=[],a=arguments.length-4;a-- >0;)r[a]=arguments[a+4];if(!t)return"";var s=d.apply(void 0,r),l=s.locale||e,h=this._translate(i,l,this.fallbackLocale,t,n,"string",s.params);if(this._isFallbackRoot(h)){if(!this._root)throw Error("unexpected error");return(o=this._root).$t.apply(o,[t].concat(r))}return this._warnDefault(l,t,h,n,r)},Dt.prototype.t=function(t){for(var e,i=[],n=arguments.length-1;n-- >0;)i[n]=arguments[n+1];return(e=this)._t.apply(e,[t,this.locale,this._getMessages(),null].concat(i))},Dt.prototype._i=function(t,e,i,n,o){var r=this._translate(i,e,this.fallbackLocale,t,n,"raw",o);if(this._isFallbackRoot(r)){if(!this._root)throw Error("unexpected error");return this._root.$i18n.i(t,e,o)}return this._warnDefault(e,t,r,n,[o])},Dt.prototype.i=function(t,e,i){return t?("string"!=typeof e&&(e=this.locale),this._i(t,e,this._getMessages(),null,i)):""},Dt.prototype._tc=function(t,e,i,n,o){for(var r,a=[],s=arguments.length-5;s-- >0;)a[s]=arguments[s+5];if(!t)return"";void 0===o&&(o=1);var l={count:o,n:o},h=d.apply(void 0,a);return h.params=Object.assign(l,h.params),a=null===h.locale?[h.params]:[h.locale,h.params],this.fetchChoice((r=this)._t.apply(r,[t,e,i,n].concat(a)),o)},Dt.prototype.fetchChoice=function(t,e){if(!t&&"string"!=typeof t)return null;var i=t.split("|");return e=this.getChoiceIndex(e,i.length),i[e]?i[e].trim():t},Dt.prototype.getChoiceIndex=function(t,e){return this.locale in this.pluralizationRules?this.pluralizationRules[this.locale].apply(this,[t,e]):function(t,e){return t=Math.abs(t),2===e?t?t>1?1:0:1:t?Math.min(t,2):0}(t,e)},Dt.prototype.tc=function(t,e){for(var i,n=[],o=arguments.length-2;o-- >0;)n[o]=arguments[o+2];return(i=this)._tc.apply(i,[t,this.locale,this._getMessages(),null,e].concat(n))},Dt.prototype._te=function(t,e,i){for(var n=[],o=arguments.length-3;o-- >0;)n[o]=arguments[o+3];var r=d.apply(void 0,n).locale||e;return this._exist(i[r],t)},Dt.prototype.te=function(t,e){return this._te(t,this.locale,this._getMessages(),e)},Dt.prototype.getLocaleMessage=function(t){return f(this._vm.messages[t]||{})},Dt.prototype.setLocaleMessage=function(t,e){("warn"!==this._warnHtmlInMessage&&"error"!==this._warnHtmlInMessage||(this._checkLocaleMessage(t,this._warnHtmlInMessage,e),"error"!==this._warnHtmlInMessage))&&this._vm.$set(this._vm.messages,t,e)},Dt.prototype.mergeLocaleMessage=function(t,e){("warn"!==this._warnHtmlInMessage&&"error"!==this._warnHtmlInMessage||(this._checkLocaleMessage(t,this._warnHtmlInMessage,e),"error"!==this._warnHtmlInMessage))&&this._vm.$set(this._vm.messages,t,_(this._vm.messages[t]||{},e))},Dt.prototype.getDateTimeFormat=function(t){return f(this._vm.dateTimeFormats[t]||{})},Dt.prototype.setDateTimeFormat=function(t,e){this._vm.$set(this._vm.dateTimeFormats,t,e)},Dt.prototype.mergeDateTimeFormat=function(t,e){this._vm.$set(this._vm.dateTimeFormats,t,_(this._vm.dateTimeFormats[t]||{},e))},Dt.prototype._localizeDateTime=function(t,e,i,n,o){var r=e,a=n[r];if((u(a)||u(a[o]))&&(r=i,a=n[r]),u(a)||u(a[o]))return null;var s=a[o],l=r+"__"+o,h=this._dateTimeFormatters[l];return h||(h=this._dateTimeFormatters[l]=new Intl.DateTimeFormat(r,s)),h.format(t)},Dt.prototype._d=function(t,e,i){if(!i)return new Intl.DateTimeFormat(e).format(t);var n=this._localizeDateTime(t,e,this.fallbackLocale,this._getDateTimeFormats(),i);if(this._isFallbackRoot(n)){if(!this._root)throw Error("unexpected error");return this._root.$i18n.d(t,i,e)}return n||""},Dt.prototype.d=function(t){for(var e=[],i=arguments.length-1;i-- >0;)e[i]=arguments[i+1];var n=this.locale,o=null;return 1===e.length?"string"==typeof e[0]?o=e[0]:h(e[0])&&(e[0].locale&&(n=e[0].locale),e[0].key&&(o=e[0].key)):2===e.length&&("string"==typeof e[0]&&(o=e[0]),"string"==typeof e[1]&&(n=e[1])),this._d(t,n,o)},Dt.prototype.getNumberFormat=function(t){return f(this._vm.numberFormats[t]||{})},Dt.prototype.setNumberFormat=function(t,e){this._vm.$set(this._vm.numberFormats,t,e)},Dt.prototype.mergeNumberFormat=function(t,e){this._vm.$set(this._vm.numberFormats,t,_(this._vm.numberFormats[t]||{},e))},Dt.prototype._getNumberFormatter=function(t,e,i,n,o,r){var a=e,s=n[a];if((u(s)||u(s[o]))&&(a=i,s=n[a]),u(s)||u(s[o]))return null;var l,h=s[o];if(r)l=new Intl.NumberFormat(a,Object.assign({},h,r));else{var c=a+"__"+o;l=this._numberFormatters[c],l||(l=this._numberFormatters[c]=new Intl.NumberFormat(a,h))}return l},Dt.prototype._n=function(t,e,i,n){if(!Dt.availabilities.numberFormat)return"";if(!i){return(n?new Intl.NumberFormat(e,n):new Intl.NumberFormat(e)).format(t)}var o=this._getNumberFormatter(t,e,this.fallbackLocale,this._getNumberFormats(),i,n),r=o&&o.format(t);if(this._isFallbackRoot(r)){if(!this._root)throw Error("unexpected error");return this._root.$i18n.n(t,Object.assign({},{key:i,locale:e},n))}return r||""},Dt.prototype.n=function(t){for(var e=[],i=arguments.length-1;i-- >0;)e[i]=arguments[i+1];var n=this.locale,o=null,r=null;return 1===e.length?"string"==typeof e[0]?o=e[0]:h(e[0])&&(e[0].locale&&(n=e[0].locale),e[0].key&&(o=e[0].key),r=Object.keys(e[0]).reduce(function(t,i){var n;return rt.includes(i)?Object.assign({},t,(n={},n[i]=e[0][i],n)):t},null)):2===e.length&&("string"==typeof e[0]&&(o=e[0]),"string"==typeof e[1]&&(n=e[1])),this._n(t,n,o,r)},Dt.prototype._ntp=function(t,e,i,n){if(!Dt.availabilities.numberFormat)return[];if(!i){return(n?new Intl.NumberFormat(e,n):new Intl.NumberFormat(e)).formatToParts(t)}var o=this._getNumberFormatter(t,e,this.fallbackLocale,this._getNumberFormats(),i,n),r=o&&o.formatToParts(t);if(this._isFallbackRoot(r)){if(!this._root)throw Error("unexpected error");return this._root.$i18n._ntp(t,e,i,n)}return r||[]},Object.defineProperties(Dt.prototype,Mt);var Nt;Object.defineProperty(Dt,"availabilities",{get:function(){if(!Nt){var t="undefined"!=typeof Intl;Nt={dateTimeFormat:t&&void 0!==Intl.DateTimeFormat,numberFormat:t&&void 0!==Intl.NumberFormat}}return Nt}}),Dt.install=S,Dt.version="8.11.2";var Bt=Dt,Ft=(i("28a5"),i("8bbf")),zt=i.n(Ft),Vt=(i("a481"),i("5d58")),Ut=i.n(Vt),jt=i("67bb"),Ht=i.n(jt),Wt=/(%|)\{([0-9a-zA-Z_]+)\}/g,Gt=function(){function t(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];return 1===i.length&&"object"===B(i[0])&&(i=i[0]),i&&i.hasOwnProperty||(i={}),t.replace(Wt,function(e,n,o,r){if("{"===t[r-1]&&"}"===t[r+e.length])return o;var a=F(i,o)?i[o]:null;return null===a||void 0===a?"":a})}return t}(zt.a),Zt={},Xt=n(),Yt=!1,$t=function(t,e){var i=this;if(this.$i18n)return Yt||(Yt=!0,Object.keys(Zt).forEach(function(t){i.$i18n.mergeLocaleMessage(t,Zt[t])})),this.$t.apply(this,[t,e]);for(var n,o=t.split("."),r=Zt[Xt],a=0,s=o.length;a<s;a++){if(n=r[o[a]],a===s-1)return Gt(n,e);if(!n)return"";r=n}return""},qt=function(t){var e=t.messages,i=t.locale;Zt=e||Zt,Xt=i||Xt},Kt={use:qt},Jt={methods:{t:function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return $t.apply(this,e)}}},Qt=[ot],te={version:"0.1.0",install:function(t,e){te.i18n=M(t,e),Qt.map(function(e){return t.component(e.name,e)})},LangSelect:ot,i18n:null,setLocalMap:a,i18n4Lib:Kt,localeMixin:Jt};"undefined"!=typeof window&&window.Vue&&te.install(window.Vue);var ee=te;e.default=ee},ff3c:function(t,e,i){}}).default},"9e69":function(t,e,i){var n=i("2b3e"),o=n.Symbol;t.exports=o},a029:function(t,e,i){var n=i("087d"),o=i("2dcb"),r=i("32f4"),a=i("d327"),s=Object.getOwnPropertySymbols,l=s?function(t){for(var e=[];t;)n(e,r(t)),t=o(t);return e}:a;t.exports=l},a2db:function(t,e,i){function n(t){return a?Object(a.call(t)):{}}var o=i("9e69"),r=o?o.prototype:void 0,a=r?r.valueOf:void 0;t.exports=n},a34a:function(t,e,i){t.exports=i("98b8")},a524:function(t,e,i){function n(t){return o(this,t).has(t)}var o=i("4245");t.exports=n},a994:function(t,e,i){function n(t){return o(t,a,r)}var o=i("7d1f"),r=i("32f4"),a=i("ec69");t.exports=n},b047:function(t,e){function i(t){return function(e){return t(e)}}t.exports=i},b20f:function(t,e,i){},b218:function(t,e){function i(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=n}var n=9007199254740991;t.exports=i},b4c0:function(t,e,i){function n(t){var e=this.__data__,i=o(e,t);return i<0?void 0:e[i][1]}var o=i("cb5a");t.exports=n},b50d:function(t,e,i){"use strict";var n=i("c532"),o=i("467f"),r=i("30b5"),a=i("c345"),s=i("3934"),l=i("2d83");t.exports=function(t){return new Promise(function(e,h){var c=t.data,u=t.headers;n.isFormData(c)&&delete u["Content-Type"];var d=new XMLHttpRequest;if(t.auth){var f=t.auth.username||"",p=t.auth.password||"";u.Authorization="Basic "+btoa(f+":"+p)}if(d.open(t.method.toUpperCase(),r(t.url,t.params,t.paramsSerializer),!0),d.timeout=t.timeout,d.onreadystatechange=function(){if(d&&4===d.readyState&&(0!==d.status||d.responseURL&&0===d.responseURL.indexOf("file:"))){var i="getAllResponseHeaders"in d?a(d.getAllResponseHeaders()):null,n=t.responseType&&"text"!==t.responseType?d.response:d.responseText,r={data:n,status:d.status,statusText:d.statusText,headers:i,config:t,request:d};o(e,h,r),d=null}},d.onerror=function(){h(l("Network Error",t,null,d)),d=null},d.ontimeout=function(){h(l("timeout of "+t.timeout+"ms exceeded",t,"ECONNABORTED",d)),d=null},n.isStandardBrowserEnv()){var g=i("7aac"),_=(t.withCredentials||s(t.url))&&t.xsrfCookieName?g.read(t.xsrfCookieName):void 0;_&&(u[t.xsrfHeaderName]=_)}if("setRequestHeader"in d&&n.forEach(u,function(t,e){void 0===c&&"content-type"===e.toLowerCase()?delete u[e]:d.setRequestHeader(e,t)}),t.withCredentials&&(d.withCredentials=!0),t.responseType)try{d.responseType=t.responseType}catch(e){if("json"!==t.responseType)throw e}"function"==typeof t.onDownloadProgress&&d.addEventListener("progress",t.onDownloadProgress),"function"==typeof t.onUploadProgress&&d.upload&&d.upload.addEventListener("progress",t.onUploadProgress),t.cancelToken&&t.cancelToken.promise.then(function(t){d&&(d.abort(),h(t),d=null)}),void 0===c&&(c=null),d.send(c)})}},b5a7:function(t,e,i){var n=i("0b07"),o=i("2b3e"),r=n(o,"DataView");t.exports=r},b775:function(t,e,i){"use strict";function n(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,n)}return i}function o(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?n(Object(i),!0).forEach(function(e){r(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):n(Object(i)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}function r(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var a=i("bc3a"),s=i.n(a),l=i("6194"),h={headers:{Pragma:"no-cache","Cache-Control":"no-cache"}},c=s.a.create(h);c.interceptors.request.use(function(t){return o(o({},t),{},{params:o(o({},t.params||{}),{},{_t:+new Date})})},function(t){return Promise.reject(t)}),c.interceptors.response.use(function(t){var e=t.data||{},i=e.code,n=e.msg,o=e.errorMsg,r=e.resultCode,a=e.resultMsg;return i&&"0"!==i||o||r&&"0"!==r||a?(Object(l.Message)({showClose:!0,message:n||o||a,type:"error",duration:5e3}),Promise.reject(new Error(n))):Promise.resolve(t.data)},function(t){console.error(t);var e;return e=t.response&&t.response.data&&t.response.data.msg?t.response.data.msg:t.message,Object(l.Message)({showClose:!0,message:e,type:"error",duration:5e3}),Promise.reject(t)}),e.a=c},b934:function(t,e,n){t.exports=function(t){function e(n){if(i[n])return i[n].exports;var o=i[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var i={};return e.m=t,e.c=i,e.d=function(t,i,n){e.o(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:n})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,i){if(1&i&&(t=e(t)),8&i)return t;if(4&i&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(e.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&i&&"string"!=typeof t)for(var o in t)e.d(n,o,function(e){return t[e]}.bind(null,o));return n},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s="fb15")}({"00c2":function(t,e){function i(t){return null!=t&&"object"==typeof t}t.exports=i},"0418":function(t,e,i){},"07bd":function(t,e,i){function n(t){return o(t,a,r)}var o=i("b101"),r=i("7714"),a=i("3c3d");t.exports=n},"0809":function(t,e,i){},"084e":function(t,e){function i(t,e){var i=typeof t;return!!(e=null==e?n:e)&&("number"==i||"symbol"!=i&&o.test(t))&&t>-1&&t%1==0&&t<e}var n=9007199254740991,o=/^(?:0|[1-9]\d*)$/;t.exports=i},"090b":function(t,e,i){"use strict";i.r(e),e.default={tacheModel:{validateTaches:"At least one start, one end, and one execution",validateGroups_1:"Location of swimming lanes",validateGroups_2:"Empty lane",validateGroups_3:"The lane name on the location cannot be empty",aloneTache:"The link is isolated",startNode:"start",midstNode:"unnamed link",endNode:"end"},paths:{nameLength:"The path display name for this path is longer than 48"},link:{nodeLinking:"Completion of the link can not be returned, can not be used as the starting point of the link",canLinking:"This path already exists, please do not add it again!"},lane:{name:"Lane",min:"The smallest unit, you can't reduce it"},menu:{confirmDel1:"Confirm Delete",confirmDel2:"tache?",confirmDel3:"link?",confirmDel4:"lane？",the:"this",addBtn:"add",delBtn:"delete",editBtn:"edit",linkBtn:"link",renameBtn:"rename",delColBtn:"del-col",addColBtn:"add-col"},process:{created:"Created",executed:"Executed",withdrawn:"Withdrawn",executing:"Executing",completed:"Completed",linkAttrbutes:"Link Attributes",multiInstanceLink:"Multi-instance link",virtualLink:"Virtual link",currentLink:"Current link",flowedLink:"Executed link",beFlowLink:"Unexecuted link",completedLink:"Complete the link",unCompleteLink:"Unfinished link",returnLink:"Back link"},emptyData:{parallel:"parallel",serial:"serial",agree:"agree",disagree:"disagree"},utils:{currentValue:"current value",defaultValue:"default value",tableVar:"Form variables"},flowModel:{prevLabel:"last step",nextLabel:"next step",pause:"pause",play:"play"},toolbar:{link:"Ligature",disLink:"Cancel the attachment",showLane:"Show lane",hideLane:"Hidden lane",magnify:"Magnify",shrink:"Shrink",addLane:"Add lane"},editLink:{lunk:"lunk",baseInfo:"basic information",pathName:"pathname",inpuPathName:"Enter the path display name",mutexConfig:"Mutex configuration",convergentType:"Convergent Type",convergentTache:"Convergent Tache",close:"Close",cancle:"Cancel",confirm:"Confirm",divMulInst:"Divergent multiple instance",conMulInst:"Convergent multiple instance",parMulInst:"Parallel multiple instances",placeHolder:"Please select"},togetherComp:{linkBranchPeople:"Link co-organizer",rootOrgValueTip:"When staff generation is not complete, a node can be selected as the default and can be configured to change",roleConfig:"Role configuration",detailBtn:"Details",newCreateBtn:"Create",roleGroupPlace:"Select role group",roleMessage:"Please select the role group"},options:{allOrg:"All organizations",customMode:"Custom Mode",devMode:"Developer Mode",notyfyType:"notice way:",sms:"SMS",email:"EMAIL",staffCreateType:"Personnel selection：",beginOrgValue:"Selection of personnel：",rootOrgType:"Default node",errorMessage1:"Please enter a default node",errorMessage2:"Please enter the correct expression",errorMessage3:"Please select the default node expression type",staffDep:"Staff department",team:"Task force",dutyLine:"Duty Line",fix:"Fixed value",formElement:"Form element",sqlFunc:"SQL functions",jsFunc:"js function",sqlProc:"Stored procedure",placeHolder:"please choose",nextTache:"Follow-up",tacheHander:"Link handler",tacheCC:"CC",and:"and",or:"or",inputHolder:"Please enter content",handOption:"Handling opinions",delete:"delete",tacheName:"Link name",addNextTache:"Add follow-up",defaultHander:"Default handler",cancel:"cancel",confirm:"confirm",hour:"Hour",minute:"Minute",day:"Day"},importAnswer:{placeholder:"Please enter the answer",uploadAnswer:"Import matching answers"},tacheComp:{chooseHander:"Choose a handler",add:"+Add",update:"Update",notRule:"No rules configured",defaultRule:"Default rule already exists",delRule:"Please delete the default rule settings first",know:"Got it",editRule:"Please edit the rule",previousRole:"Previous role",unconditionally:"Unconditionally",time:"Time",handOption:"Processing opinion is",defaultSelect:"Selected by default",relFlow:"Association process",tache:"Link",unconditional:"Unconditional",clearConditions:"Clear conditions",setDefaultRule:"Set as default rule",rule:"When other rule conditions are not met",selectPerson:"Choose a person",selectDep:"Select department",hasExist:"The default rule already exists, please delete or cancel it first!",followCondition:"The following conditions",addCap:"Add caps for subsequent links!",addMessage:"This link has been added, please do not repeat it!！",staffSelectAttr:"People selection attributes",allowByOrg:"Allow selection from organization",orgSelType:"Organization selection method",orgScope:"Organization scope",openOrg:"Open organization by default",recommendHander:"Recommended handler",recommendMessage1:"If selecting people from the organization is not allowed and no recommendation handler is configured, then",recommendMessage2:"Users cannot make choices during process processing, but can only transfer to the configured default handler;",recommendMessage3:"If selection from the organization is not allowed and a recommendation handler is configured, then",recommendMessage4:"During process processing, the user can choose to transfer to the configured default process or recommender.",addRoleGroup:"New role group",enterRole:"Enter role group name",enterAddRole:"Please enter the added role group name",addSuccess:"Added successfully",roleConfig:"Role group user configuration",selectRoleGroup:"Select a role group",createStaff:"New person",selectRole:"Choose a role",allRole:"All characters",searchStaff:"Search for a name",name:"Name",enterName:"Enter name",dep:"department",role:"Roles",phone:"contact number",opertor:"operating",staff:"Staff",leader:"Office leader",manager:"Assistant manager",roleAddMessage:"This user already exists in the role group, please select again",saveMessage:"Unsaved data exists, please save first",selectRoleInfo:"Please select user information",selectRoleMessage:"Please select a role"},editNode:{cancel:"cancel",close:"close",confirm:"confirm",tacheAttr:"Link attributes",tacheRule:"Staff rules",nextTache:"Follow-up",fieldSetting:"Display settings",advanceSetting:"Advanced settings",parallel:"Parallel",serial:"Serial",agree:"Agree",disagree:"Disagree",validateMessage1:"Link attribute is incorrect, please check",validateMessage2:"The staff rules are incorrect, please check",validateMessage3:"The following links are incorrect, please check",validateMessage4:"Advanced configuration is incorrect, please check",tacheHander:"Link handler",tacheCC:"CC",branchStaff:"Co-organizer",and:"and",or:"or",previousRole:"Previous role",unconditionally:"Unconditionally,",time:"time",handOption:"Processing opinion is",defaultSelect:"Selected by default",relFlow:"Association process",tache:"tache",unconditional:"Unconditional",procedureFetch:"Stored procedure fetch",nextError1:"Please complete the follow-up links!",nextError2:"Configure at least one in the following links!",nextError3:"Custom mode, at least 1 rule is configured",transfer:"transfer",goto:"Advance to",backto:"Fall back to"},advanceSetting:{onCreate:"Pre-create event",onPlaceHolder:"Please select a function type",onAfterCreate:"Post event creation",placeHolder:"Please enter a function",onBeforeFinish:"Pre-completion event",onAfterFinish:"Event after completion",defaultOpinionValue:"Default opinion config",opinionPlace:"Please select the default method of obtaining comments",isAuto:"Whether to execute automatically",yes:"yes",no:"no",execDesc:"Perform configuration instructions",execStaffLabel:"Fallback link default performer",isDefaultTacheExecStaff:"Whether to rollback the default executor",opinionType:"Opinion display",H:"hide",SO:"Display and fill",SR:"Displayed and required",endTaskTitle:"End signing display chinese text",endTaskTitleUs:"End signing display english text",taskPlace:"Please enter the end signing chinese text, such as: end signing",taskPlaceUs:"Please enter the end signing english text, such as: end signing",sortId:"Sequence arrangement of links",isPool:"Whether to configure ticket pool",dialogLabel:"Pop-up window style",dialogWidth:"Configure popup box width",dialogHeight:"Configure pop-up box height",isFull:"fullScreen",countersignCfg:"Countersign configuration",parallelCfg:"Parallel configuration",isChecked:"selected",isShow:"show",parallelText:"Chinese text",parallelUs:"English text",serialCfg:"Serial configuration",multiInstMerge:"Whether to merge in parallel",isStartOa:"Whether it can be co-organized",validateMessage1:"Please enter the correct expression",validateMessage2:"Please enter an expression",validateMessage3:"Please select an expression type",isFreeFlow:"Whether is free flow"},displaySetting:{infoBlock:"Information block",fieldNameCn:"Field Name",show:"display",readonly:"readonly",isReadonly:"is readonly",require:"require",formAction1:"Creation mode: the beginning link can only be this mode",formAction2:"Filling mode: Use this mode for more than 4 link edit fields, the field is displayed by default, read-only, not required",formAction3:"Read-only mode: Use this mode for more than 4 link edit fields, the fields are displayed by default, not read-only, not required",formAction4:"Mixed mode: use this mode if there are more than 4 link edit fields, edit fields to the pop-up layer, and the form fields are read-only",displayMode:"Display mode",createMode:"create mode",writeMode:"fill mode",readMode:"read mode",mixMode:"mixed mode",staffInfo:"Employee Information Navigation"},nextTchRule:{handOption:"Handling opinions：",isShow:"isShow",delete:"delete",errorMessage1:"Option text cannot be empty",errorMessage2:"Option value cannot be empty",selectText:"Option text",textPlace:"Please enter option text",valuePlace:"Please enter an option value",valueText:"Option value",defaultSelect:"Selected by default",addOpinion:"Add processing comments",nextTache:"Follow-up",add:"add",addRule:"Add rule",defaultCfg:"default Config",allowUpdate:"allow update",hideOther:"Hide other links"},tacheAttr:{tchMod:"tchMod",tchNum:"tchNum",tchName:"tchNameCn",tchNameUs:"tchNameUs",tchType:"tchType",funcMenu:"Tool configuration",flowMode:"flowMode",parallel:"parallel",serial:"serial",model:"Window mode",layer:"Layer mode",form:"Form mode",subFlowMod:"subFlowMod",subFlowPlace:"Please select an associated sub-process",createNewChildFlow:"New sub-process",canCancelBack:"Whether the current link can be withdrawn",yes:"yes",no:"no",canReturn:"can be returned",canReturnTchs:"Returnable links",canTransfer:"Whether transferable",canMultiTransfer:"Allow transfer in countersignature",consultAdvices:"Advice",consultPlace:"Need to enter questions and matching answers",addQuestion:"Add question",delQuestion:"Delete this question",enterQuestion:"Please enter a question",flowHs:"Process Discourse",flowNamed:"Named by link name by default",flowContent:"The name displayed when the process is processing. Configurable all processing paths that can reach this link",enterNameCn:"Please enter Chinese name",enterNameUs:"Please enter English name",errorMessage1:"Link name cannot be empty",errorMessage2:"Cannot be longer than 48 characters",errorMessage3:"Link ID cannot be empty",errorMessage4:"Cannot be longer than 32 characters",errorMessage5:"Only English characters and numbers can be entered",goto:"Advance to：",back:"Fall back to：",transfer:"Transfer：",beginTch:"Start link",endTch:"Closing session",execTch:"Executive link",virTch:"Virtual link",procTimeoutRule:"Process Timeout rule",tchRemainsTimeOut:"This link remains in circulation for more than"},tchRule:{add:"add",addRule:"Add rule",rootOrgValueContent:"When the personnel generation method is not all, one node can be selected as the default and the configuration can be changed",allowUpdate:"allow update",filterHander:"Filter by filter",beginOrgValue:"Recommended by：",errorMessage1:"Please enter a default handler",errorMessage2:"Please enter the correct expression",errorMessage3:"Please select the default handler expression type",errorMessage4:"Please enter a default node",errorMessage5:"Please select the default node expression type",errorMessage6:"Please enter the processor filter sorl conditions",errorMessage7:"Please select a processor filter expression type",errorMessage8:"Please select default value type first",selectRecommend:"Please select recommend staff"},commonData:{flowStaff:"Process initiator",lastTacheStaff:"The previous link handler",lastTacheStaffOrg:"Previous organization",lastTacheStaffRegion:"Dealing with people in the previous session",relFlow:"Association process",leader:"Department heads",depAllPeople:"All members of the department",startPeople:"sponsor",formDim:"Form dimension",handerDim:"Handling people dimension",tacheDim:"Link dimension",equal:"equal",noEqual:"not equal to",dayu:"more than the",xiaoyu:"Less than",bigOrEqual:"greater than or equal to",smallOrEqual:"less than or equal to",include:"contain",noinclude:"Not included",inlist:"In",noinlist:"Not in",orgSelect:"Organization structure selection",getFlow:"Process instance acquisition",staff:"Staff",officeLeader:"Office leader",manager:"Assistant manager",lastTache:"Previous link",lastTchAction:"Transfer action in the previous link",goto:"Go ahead",backto:"Go back",transfer:"Transfer",allMeet:"All meet",arbSatify:"Arbitrary satisfaction",staffDep:"Staff department",team:"Task force",dutyLine:"Duty line",allOrg:"All organizations",noFilterRule:"No filtering rules",filterLeader:"Filtration department positive and negative values",handlerDep:"Processing department",haveChildLevel:"have sub sectors",nohaveChildLevel:"do not have sub sectors"}}},"0cad":function(t,e,i){"use strict";var n=i("26af"),o=i.n(n);o.a},"0d91":function(t,e,i){function n(t){var e=this.__data__=new o(t);this.size=e.size}var o=i("88f9"),r=i("19a9"),a=i("5052"),s=i("c8da"),l=i("1038"),h=i("def0");n.prototype.clear=r,n.prototype.delete=a,n.prototype.get=s,n.prototype.has=l,n.prototype.set=h,t.exports=n},"0e04":function(t,e,i){var n=i("2c74"),o=n["__core-js_shared__"];t.exports=o},"0e15":function(t,e,i){var n=i("597f");t.exports=function(t,e,i){return void 0===i?n(t,e,!1):n(t,i,!1!==e)}},"0ea7":function(t,e,i){function n(t){var e=this.__data__,i=o(e,t);return!(i<0)&&(i==e.length-1?e.pop():a.call(e,i,1),--this.size,!0)}var o=i("8d51"),r=Array.prototype,a=r.splice;t.exports=n},"0ee6":function(t,e){function i(t,e){for(var i=-1,n=null==t?0:t.length,o=0,r=[];++i<n;){var a=t[i];e(a,i,t)&&(r[o++]=a)}return r}t.exports=i},1038:function(t,e){function i(t){return this.__data__.has(t)}t.exports=i},"10eb":function(t,e,i){},"122e":function(t,e,i){function n(t){var e=-1,i=null==t?0:t.length;for(this.clear();++e<i;){var n=t[e];this.set(n[0],n[1])}}var o=i("8c04"),r=i("3016"),a=i("ce0f"),s=i("81cc"),l=i("1629");n.prototype.clear=o,n.prototype.delete=r,n.prototype.get=a,n.prototype.has=s,n.prototype.set=l,t.exports=n},1328:function(t,e,i){"use strict";var n=i("a729"),o=i.n(n);o.a},1513:function(t,e){function i(t){return function(e){return t(e)}}t.exports=i},1549:function(t,e,i){function n(t){var e=-1,i=null==t?0:t.length;for(this.clear();++e<i;){var n=t[e];this.set(n[0],n[1])}}var o=i("ce4b"),r=i("5c9a"),a=i("f6a0"),s=i("2c9a"),l=i("8d09");n.prototype.clear=o,n.prototype.delete=r,n.prototype.get=a,n.prototype.has=s,n.prototype.set=l,t.exports=n},1629:function(t,e,i){function n(t,e){var i=o(this,t),n=i.size;return i.set(t,e),this.size+=i.size==n?0:1,this}var o=i("6ca4");t.exports=n},1943:function(t,e){function i(t,e){return t===e||t!==t&&e!==e}t.exports=i},"19a9":function(t,e,i){function n(){this.__data__=new o,this.size=0}var o=i("88f9");t.exports=n},"1ac0":function(t,e){function i(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}t.exports=i},"1d14":function(t,e,i){"use strict";var n=i("9a0b"),o=i.n(n);o.a},"1fda":function(t,e,i){var n=i("43df"),o=i("1513"),r=i("519f"),a=r&&r.isSet,s=a?o(a):n;t.exports=s},"212a":function(t,e,i){},2166:function(t,e){t.exports=n("2166")},2206:function(t,e){function i(t){if(null!=t){try{return o.call(t)}catch(t){}try{return t+""}catch(t){}}return""}var n=Function.prototype,o=n.toString;t.exports=i},"26af":function(t,e,i){},"280b":function(t,e){function i(t,e){return null==t?void 0:t[e]}t.exports=i},2817:function(t,e,i){var n=i("e80d"),o=n(Object,"create");t.exports=o},"2aea":function(t,e,i){function n(t){if(!o(t))return r(t);var e=[];for(var i in Object(t))s.call(t,i)&&"constructor"!=i&&e.push(i);return e}var o=i("a20e"),r=i("e87a"),a=Object.prototype,s=a.hasOwnProperty;t.exports=n},"2c74":function(t,e,i){var n=i("c5f3"),o="object"==typeof self&&self&&self.Object===Object&&self,r=n||o||Function("return this")();t.exports=r},"2c9a":function(t,e,i){function n(t){var e=this.__data__;return o?void 0!==e[t]:a.call(e,t)}var o=i("2817"),r=Object.prototype,a=r.hasOwnProperty;t.exports=n},"2cfc":function(t,e,i){},"2f6e":function(t,e,i){"use strict";i.r(e),e.default={tacheModel:{validateTaches:"至少一个开始环节、一个结束环节、一个执行环节",validateGroups_1:"位置的泳道",validateGroups_2:"为空泳道",validateGroups_3:"位置上的泳道名称不能为空",aloneTache:"环节为孤立环节",startNode:"开始",midstNode:"未命名环节",endNode:"竣工"},paths:{nameLength:"此路径的路径显示名称长度超过48"},link:{nodeLinking:"竣工环节不可回退，不能作为连线起点环节",canLinking:"此路径已存在，请勿重复添加！"},lane:{name:"泳道",min:"最小单位，不能再减少"},menu:{confirmDel1:"确认删除",confirmDel2:"环节吗？",confirmDel3:"连线吗？",confirmDel4:"泳道吗？",the:"该",addBtn:"新增",delBtn:"删除",editBtn:"编辑",linkBtn:"连线",renameBtn:"重命名",delColBtn:"减少列",addColBtn:"增加列"},process:{created:"已创建",executed:"已执行",withdrawn:"已撤回",executing:"执行中",completed:"已完成",linkAttrbutes:"环节属性",multiInstanceLink:"多实例环节",virtualLink:"虚拟环节",currentLink:"当前环节",flowedLink:"已执行环节",beFlowLink:"未执行环节",completedLink:"完成环节",unCompleteLink:"未完成环节",returnLink:"回退环节"},emptyData:{parallel:"并行",serial:"串行",agree:"同意",disagree:"不同意"},utils:{currentValue:"当前值",defaultValue:"默认值",tableVar:"表单变量"},flowModel:{prevLabel:"上一步",nextLabel:"下一步",pause:"暂停",play:"播放"},toolbar:{link:"连线",disLink:"取消连线",showLane:"显示泳道",hideLane:"隐藏泳道",magnify:"放大",shrink:"缩小",addLane:"添加泳道"},editLink:{lunk:"连接线",baseInfo:"基本信息",pathName:"路径名称",inpuPathName:"输入路径显示名称",mutexConfig:"互斥配置",convergentType:"后续多实例环节敛散性",convergentTache:"多实例收敛点",close:"关闭",cancle:"取消",confirm:"确认",divMulInst:"发散多实例",conMulInst:"收敛多实例",parMulInst:"并行多实例",placeHolder:"请选择"},togetherComp:{linkBranchPeople:"环节协办人",rootOrgValueTip:"当人员生成方式为非全部时，可选择一个节点作为默认，并可配置是否可改变",roleConfig:"角色配置",detailBtn:"详情",newCreateBtn:"新建",roleGroupPlace:"选择角色组",roleMessage:"请选择角色组"},options:{allOrg:"全部组织",customMode:"自定义模式",devMode:"开发者模式",notyfyType:"通知方式：",sms:"短信",email:"邮件",staffCreateType:"人员选择方式：",beginOrgValue:"人员选择范围：",rootOrgType:"默认节点",errorMessage1:"请输入默认节点",errorMessage2:"请输入正确的表达式",errorMessage3:"请选择默认节点表达式类型",staffDep:"员工部门",team:"专项小组",dutyLine:"值班线",fix:"固定值",formElement:"表单元素",sqlFunc:"SQL函数",jsFunc:"js函数",sqlProc:"存储过程",placeHolder:"请选择",nextTache:"后续环节",tacheHander:"环节处理人",tacheCC:"环节抄送人",and:"和",or:"或",inputHolder:"请输入内容",handOption:"处理意见",delete:"删除",tacheName:"环节名称",addNextTache:"添加后续环节",defaultHander:"默认处理人",cancel:"取 消",confirm:"确 定",hour:"小时",minute:"分钟",day:"天"},importAnswer:{placeholder:"请输入答案",uploadAnswer:"导入匹配答案"},tacheComp:{chooseHander:"选择处理人",add:"+添加",update:"修改",notRule:"未配置规则",defaultRule:"默认规则已存在变更失败",delRule:"请先删除默认规则设置",know:"知道了",editRule:"请编辑规则",previousRole:"上一环节处理人角色",unconditionally:"无条件情况下",time:"时",handOption:"处理意见为",defaultSelect:"默认选中，",relFlow:"关联流程",tache:"环节",unconditional:"无条件",clearConditions:"清空条件",setDefaultRule:"设置为缺省规则",rule:"当其他规则条件不满足时，执行缺省规则",selectPerson:"选择一名人员",selectDep:"选择部门",hasExist:"已经存在默认规则，请先删除或取消！",followCondition:"下列条件",addCap:"后续环节添加上限!",addMessage:"该环节已添加，请勿重复操作！",staffSelectAttr:"人员选择属性",allowByOrg:"允许从组织上选人",orgSelType:"组织选择方式",orgScope:"组织范围",openOrg:"默认打开组织",recommendHander:"推荐处理人",recommendMessage1:"如果不允许从组织上选人且没有配置推荐处理人，则",recommendMessage2:"流程处理时用户不能做选择，只能转给配置的默认处理人；",recommendMessage3:"如果不允许从组织上选人且配置了推荐处理人，则",recommendMessage4:"流程处理时用户可选择流转给配置的默认处理或推荐人。",addRoleGroup:"新增角色组",enterRole:"输入角色组名称",enterAddRole:"请输入添加的角色组名称",addSuccess:"添加成功",roleConfig:"角色组用户配置",selectRoleGroup:"选择角色组",createStaff:"新建人员",selectRole:"选择角色",allRole:"所有角色",searchStaff:"搜索人名",name:"姓名",enterName:"输入姓名",dep:"部门",role:"角色",phone:"联系电话",opertor:"操作",staff:"职员",leader:"处室领导",manager:"副经理",roleAddMessage:"角色组已存在此用户，请重新选择",saveMessage:"存在未保存的数据，请先保存",selectRoleInfo:"请选择用户信息",selectRoleMessage:"请选择角色"},editNode:{cancel:"取消",close:"关闭",confirm:"确认",tacheAttr:"环节属性",tacheRule:"人员规则",nextTache:"后续环节",fieldSetting:"展示设置",advanceSetting:"高级设置",parallel:"并行",serial:"串行",agree:"同意",disagree:"不同意",validateMessage1:"环节属性填写有误，请检查",validateMessage2:"人员规则填写有误，请检查",validateMessage3:"后续环节填写有误，请检查",validateMessage4:"高级配置填写有误，请检查",tacheHander:"环节处理人",tacheCC:"环节抄送人",branchStaff:"协办人",and:"和",or:"或",previousRole:"上一环节处理人角色",unconditionally:"无条件情况下,",time:"时",handOption:"处理意见为",defaultSelect:"默认选中，",relFlow:"关联流程",tache:"环节",unconditional:"无条件",procedureFetch:"存储过程获取",nextError1:"后续环节请填写完整！",nextError2:"后续环节至少配置1条！",nextError3:"自定义模式，规则至少配置1条",transfer:"转交",goto:"前进到",backto:"回退到"},advanceSetting:{onCreate:"环节创建前事件",onPlaceHolder:"请选择函数类型",onAfterCreate:"环节创建后事件",placeHolder:"请输入函数",onBeforeFinish:"环节竣工前事件",onAfterFinish:"环节竣工后事件",defaultOpinionValue:"默认意见配置",opinionPlace:"请选择默认意见获取方式",isAuto:"是否自动执行",yes:"是",no:"否",execDesc:"执行配置说明",execStaffLabel:"回退环节默认执行人",isDefaultTacheExecStaff:"是否回退环节默认执行人",opinionType:"意见显示方式",H:"隐藏",SO:"显示并且可填",SR:"显示并且必填",endTaskTitle:"结束会签显示中文文本",endTaskTitleUs:"结束会签显示英文文本",taskPlace:"请输入结束会签显示中文文本，如：结束会签",taskPlaceUs:"请输入结束会签显示英文文本，如：end signing",sortId:"环节排列顺序配置",isPool:"是否配置工单池",dialogLabel:"弹出窗口样式",dialogWidth:"配置弹出框宽度",dialogHeight:"配置弹出框高度",isFull:"是否全屏",countersignCfg:"会签配置",parallelCfg:"并行配置",isChecked:"是否选中",isShow:"是否显示",parallelText:"中文文本",parallelUs:"英文文本",serialCfg:"串行配置",multiInstMerge:"并行是否合并",isStartOa:"是否可协办",validateMessage1:"请输入正确的表达式",validateMessage2:"请输入表达式",validateMessage3:"请选择表达式类型",isFreeFlow:"是否自由回退"},displaySetting:{infoBlock:"信息块",fieldNameCn:"字段名称",show:"显示",readonly:"只读",isReadonly:"是否只读",require:"必填",formAction1:"创建模式：开始环节仅能为本模式",formAction2:"填写模式：环节编辑字段超过4个以上使用该模式，字段默认为显示，只读，非必填",formAction3:"只读模式：环节编辑字段超过4个以上使用该模式，字段默认显示，非只读，非必填",formAction4:"混合模式：环节编辑字段超过4个以内使用该模式，编辑字段到弹出层，表单字段为只读",displayMode:"展示模式",createMode:"创建模式",writeMode:"填写模式",readMode:"只读模式",mixMode:"混合模式",staffInfo:"员工信息导航"},nextTchRule:{handOption:"处理意见：",isShow:"是否显示",delete:"删除",errorMessage1:"选项文本不能为空",errorMessage2:"选项值不能为空",selectText:"选项文本",textPlace:"请输入选项文本",valuePlace:"请输入选项值",valueText:"选项值",defaultSelect:"默认选中",addOpinion:"添加处理意见",nextTache:"后续环节",add:"添加",addRule:"添加规则",defaultCfg:"默认配置",allowUpdate:"允许修改",hideOther:"隐藏其它环节"},tacheAttr:{tchMod:"环节ID",tchNum:"环节编号",tchName:"环节中文名称",tchNameUs:"环节英文名称",tchType:"所属类型",funcMenu:"工具配置",flowMode:"流转方式",parallel:"并行",serial:"串行",model:"窗口模式",layer:"层模式",form:"表单模式",subFlowMod:"关联子流程",subFlowPlace:"请选择关联子流程",createNewChildFlow:"新建子流程",canCancelBack:"当前环节是否可撤回",yes:"是",no:"否",canReturn:"是否可退回",canReturnTchs:"可退回环节",canTransfer:"是否可转交",canMultiTransfer:"是否允许在会签中转交",consultAdvices:"咨询建议",consultPlace:"需要输入问题及匹配答案",addQuestion:"添加问题",delQuestion:"删除该问题",enterQuestion:"请输入问题",flowHs:"流程话术",flowNamed:"默认按照环节名称进行命名",flowContent:"流程处理时，展示的名称。可配置能走到本环节的所有处理路径",enterNameCn:"请输入中文名称",enterNameUs:"请输入英文名称",errorMessage1:"环节名称不能为空",errorMessage2:"长度不能大于48个字符",errorMessage3:"环节编号不能为空",errorMessage4:"长度不能大于32个字符",errorMessage5:"只能输入英文字符和数字",goto:"前进到：",back:"回退到：",transfer:"转交：",beginTch:"开始环节",endTch:"结束环节",execTch:"执行环节",virTch:"虚拟环节",procTimeoutRule:"流程超时规则",tchRemainsTimeOut:"本环节滞留流转超过"},tchRule:{add:"添加",addRule:"添加规则",rootOrgValueContent:"当人员生成方式为非全部时，可选择一个节点作为默认，并可配置是否可改变",allowUpdate:"允许修改",filterHander:"处理人过滤条件",beginOrgValue:"推荐人：",errorMessage1:"请输入默认处理人",errorMessage2:"请输入正确的表达式",errorMessage3:"请选择默认处理人表达式类型",errorMessage4:"请输入默认节点",errorMessage5:"请选择默认节点表达式类型",errorMessage6:"请输入处理人过滤sorl条件",errorMessage7:"请选择处理人过滤条件表达式类型",errorMessage8:"请先选择默认值类型",selectRecommend:"请选择推荐人"},commonData:{flowStaff:"流程发起人",lastTacheStaff:"上一环节处理人",lastTacheStaffOrg:"上一环节处理人组织",lastTacheStaffRegion:"上一环节处理人区域",relFlow:"关联流程",leader:"部门领导",depAllPeople:"部门所有成员",startPeople:"发起人",formDim:"表单维度",handerDim:"处理人维度",tacheDim:"环节维度",equal:"等于",noEqual:"不等于",dayu:"大于",xiaoyu:"小于",bigOrEqual:"大于或等于",smallOrEqual:"小于或等于",include:"包含",noinclude:"不包含",inlist:"在…中",noinlist:"不在…中",orgSelect:"组织架构选择",getFlow:"流程实例获取",staff:"职员",officeLeader:"处室领导",manager:"副经理",lastTache:"上一环节",lastTchAction:"上一环节流转动作",goto:"前进",backto:"回退",transfer:"转交",allMeet:"全部满足",arbSatify:"任意满足",staffDep:"员工部门",team:"专项小组",dutyLine:"值班线",allOrg:"全部组织",noFilterRule:"无过滤规则",filterLeader:"过滤部门正副值",handlerDep:"处理人所在部门",haveChildLevel:"存在子部门",nohaveChildLevel:"不存在子部门"}}},3016:function(t,e,i){function n(t){var e=o(this,t).delete(t);return this.size-=e?1:0,e}var o=i("6ca4");t.exports=n},"31f8":function(t,e,i){var n=i("e1e5"),o=i("00c2"),r=Object.prototype,a=r.hasOwnProperty,s=r.propertyIsEnumerable,l=n(function(){return arguments}())?n:function(t){return o(t)&&a.call(t,"callee")&&!s.call(t,"callee")};t.exports=l},"32b1":function(t,e,i){},"34cf":function(t,e,i){function n(t){return a?Object(a.call(t)):{}}var o=i("9991"),r=o?o.prototype:void 0,a=r?r.valueOf:void 0;t.exports=n},"386d":function(t,e,i){},"3bce":function(t,e,i){function n(t){return o(this.__data__,t)>-1}var o=i("8d51");t.exports=n},"3c3d":function(t,e,i){function n(t){return a(t)?o(t):r(t)}var o=i("df37"),r=i("2aea"),a=i("845f");t.exports=n},4034:function(t,e,i){"use strict";var n=i("2cfc"),o=i.n(n);o.a},"40a0":function(t,e,i){var n=i("e80d"),o=function(){try{var t=n(Object,"defineProperty");return t({},"",{}),t}catch(t){}}();t.exports=o},"43df":function(t,e,i){function n(t){return r(t)&&o(t)==a}var o=i("e688"),r=i("00c2"),a="[object Set]";t.exports=n},4534:function(t,e,i){var n=i("904b"),o=i("f989"),r=i("7714"),a=i("aa3b"),s=Object.getOwnPropertySymbols,l=s?function(t){for(var e=[];t;)n(e,r(t)),t=o(t);return e}:a;t.exports=l},"46cf":function(t,e,i){},4790:function(t,e,i){function n(t){var e=o(t);return i(e)}function o(t){if(!i.o(r,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return r[t]}var r={"./en.js":"090b","./zh-CN.js":"2f6e"};n.keys=function(){return Object.keys(r)},n.resolve=o,t.exports=n,n.id="4790"},"47e6":function(t,e){function i(t){var e=new t.constructor(t.source,n.exec(t));return e.lastIndex=t.lastIndex,e}var n=/\w*$/;t.exports=i},"4b04":function(t,e,i){function n(t){var e=a.call(t,l),i=t[l];try{t[l]=void 0;var n=!0}catch(t){}var o=s.call(t);return n&&(e?t[l]=i:delete t[l]),o}var o=i("9991"),r=Object.prototype,a=r.hasOwnProperty,s=r.toString,l=o?o.toStringTag:void 0;t.exports=n},"4bb3":function(t,e,i){var n=i("c1b0"),o=i("1513"),r=i("519f"),a=r&&r.isTypedArray,s=a?o(a):n;t.exports=s},"4f7e":function(t,e,i){"use strict";var n=i("0418"),o=i.n(n);o.a},5023:function(t,e,i){},5052:function(t,e){function i(t){var e=this.__data__,i=e.delete(t);return this.size=e.size,i}t.exports=i},"519f":function(t,e,i){(function(t){var n=i("c5f3"),o=e&&!e.nodeType&&e,r=o&&"object"==typeof t&&t&&!t.nodeType&&t,a=r&&r.exports===o,s=a&&n.process,l=function(){try{var t=r&&r.require&&r.require("util").types;return t||s&&s.binding&&s.binding("util")}catch(t){}}();t.exports=l}).call(this,i("62e4")(t))},"53a9":function(t,e,i){function n(t,e,i){var n=t.constructor;switch(e){case m:return o(t);case h:case c:return new n(+t);case v:return r(t,i);case y:case w:case b:case x:case A:case C:case T:case k:case S:return l(t,i);case u:return new n;case d:case g:return new n(t);case f:return a(t);case p:return new n;case _:return s(t)}}var o=i("9f1c"),r=i("f3ef"),a=i("47e6"),s=i("34cf"),l=i("ef66"),h="[object Boolean]",c="[object Date]",u="[object Map]",d="[object Number]",f="[object RegExp]",p="[object Set]",g="[object String]",_="[object Symbol]",m="[object ArrayBuffer]",v="[object DataView]",y="[object Float32Array]",w="[object Float64Array]",b="[object Int8Array]",x="[object Int16Array]",A="[object Int32Array]",C="[object Uint8Array]",T="[object Uint8ClampedArray]",k="[object Uint16Array]",S="[object Uint32Array]";t.exports=n},"570c":function(t,e,i){function n(t){return o(t,r|a)}var o=i("8bed"),r=1,a=4;t.exports=n},"597f":function(t,e){t.exports=function(t,e,i,n){function o(){function o(){a=Number(new Date),i.apply(l,c)}function s(){r=void 0}var l=this,h=Number(new Date)-a,c=arguments;n&&!r&&o(),r&&clearTimeout(r),void 0===n&&h>t?o():!0!==e&&(r=setTimeout(n?s:o,void 0===n?t-h:t))}var r,a=0;return"boolean"!=typeof e&&(n=i,i=e,e=void 0),o}},"5c9a":function(t,e){function i(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}t.exports=i},"60a3":function(t,e,i){"use strict";var n=i("46cf"),o=i.n(n);o.a},6194:function(t,e){t.exports=n("6194")},"620b":function(t,e,i){function n(t,e){return t&&o(e,r(e),t)}var o=i("f34d"),r=i("7117");t.exports=n},"62e4":function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},"62fb":function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA4RpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTM4IDc5LjE1OTgyNCwgMjAxNi8wOS8xNC0wMTowOTowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpmMzdjMzk2YS1mNmExLTUzNDktOThlNC04YWI1ZTI0ZjY4NmIiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NEFCMjYyQzM4QjI2MTFFODg2MEVGMjBDRTMwM0UyMkMiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NEFBMEZBMjg4QjI2MTFFODg2MEVGMjBDRTMwM0UyMkMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTcgKFdpbmRvd3MpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6MzhjMjFhMmQtM2EwZi1jMzRjLTgyZWYtOGQ1NDlkYjI2MmQwIiBzdFJlZjpkb2N1bWVudElEPSJhZG9iZTpkb2NpZDpwaG90b3Nob3A6Y2ExNGMyMjUtODk5ZS0xMWU4LWJiOWQtYjg2NDA5OWUzYTIzIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+F1OlDwAAAFJJREFUeNpi/P//PwM1ABMDlQALjOE4H6eaD1BaAJvk/kQ0g/AAfrp6bYQYBIqd/1gwDGCT+0C7dIQrnSC5inE01qgX2LjAR2IMYhx05RFAgAEA5asXC44UxQwAAAAASUVORK5CYII="},"65ab":function(t,e,i){function n(t,e){var i=this.__data__,n=o(i,t);return n<0?(++this.size,i.push([t,e])):i[n][1]=e,this}var o=i("8d51");t.exports=n},6678:function(t,e,i){"use strict";var n=i("a720"),o=i.n(n);o.a},"68f1":function(t,e,i){function n(t){if(!r(t))return!1;var e=o(t);return e==s||e==l||e==a||e==h}var o=i("92c7"),r=i("d5d3"),a="[object AsyncFunction]",s="[object Function]",l="[object GeneratorFunction]",h="[object Proxy]";t.exports=n},"6b5a":function(t,e){twaver.Util.validateLicense("l=1.0\ntype=3\ngis=1\n3d=0\nstart=2016-10-01\nlicensee=Fujian Fujitsu Communication Software Co., Ltd\nlicenseType=Annual TWAVER Software License\nlicensedSoftware=TWaver 2D for HTML5 and GIS and TWaver 3D for HTML5 (Include TWaver Make and TWaver Doodle)\nvalidity=Annual License is from 2016-10-01 to 2018-09-30\nmaintenance=24 Month\nbuyer=Fujian Fujitsu Communication Software Co., Ltd\nsignature=44f703702eac2b9b8431bbd9688613969fd48de365cea9b83c4ff127b69b1d5928b7474b42a1257bd63b7f19e65cc8b09c98133ee2c6428ad499282e6be549952f4c86d0c330d9a923aa17668f7677d5930e1d9802317e86ec1aef92bfc91680ea9fd870a6030c5c2850ba076fdfbe4538b8949a44ffe31d0adabde4008eb324079adaff9ad5c1524c3e2eeb6f985939e82e98d7ebbad644fe7c56634a95d516d15db0870d61ea9dbe3d1e92475bc62374aa7f11efd56d5edbc07fe69e42a277eb4c7509ad16c1f69a021ea57d937426d094841ea4e04cee90440b1537877818c29eb4a7a469c364e750c2dbbee88288e854954c8b3d725a5e7ae0298ada65f5575e0c7525ba22564c730f42163e8039be31f9a1256b0990e057c177a7e2bd47bf29671beb42e6ad8f9f2b9f617b21f3e4aefef4009f7a2ab1444fcec0c665a5d88db5a16d1109dee3b082720df2e9188a2e06669fff107e9ab2d0635169e1b6234d820b04d8d8f388cdee6f54f61d712757152c80f65655acae74775dde4d6615c1281595a194c6701b201bff9712fc0922cf55e1011a819b78028daa36b118381ebfce29344224c97208da933c75e59a9e0efe7ab0ccd3d1aceb75faf3e784109e7a6923af5a9de8f1603e2903c62131115c10dc39ed09cde46c0bdc8889cdab4c018c50afc767590370ce8642c64b6c5f29dfed529cb5e7768730214f05c0")},"6ca4":function(t,e,i){function n(t,e){var i=t.__data__;return o(e)?i["string"==typeof e?"string":"hash"]:i.map}var o=i("1ac0");t.exports=n},"6cb3":function(t,e,i){function n(t){return!(!a(t)||r(t))&&(o(t)?p:h).test(s(t))}var o=i("68f1"),r=i("cf09"),a=i("d5d3"),s=i("2206"),l=/[\\^$.*+?()[\]{}|]/g,h=/^\[object .+?Constructor\]$/,c=Function.prototype,u=Object.prototype,d=c.toString,f=u.hasOwnProperty,p=RegExp("^"+d.call(f).replace(l,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");t.exports=n},"6cef":function(t,e,i){"use strict";var n=i("bb61"),o=i.n(n);o.a},"6dc4":function(t,e,i){"use strict";var n=i("5023"),o=i.n(n);o.a},"6efc":function(t,e){function i(){return!1}t.exports=i},7117:function(t,e,i){function n(t){return a(t)?o(t,!0):r(t)}var o=i("df37"),r=i("eb19"),a=i("845f");t.exports=n},7714:function(t,e,i){var n=i("0ee6"),o=i("aa3b"),r=Object.prototype,a=r.propertyIsEnumerable,s=Object.getOwnPropertySymbols,l=s?function(t){return null==t?[]:(t=Object(t),n(s(t),function(e){return a.call(t,e)}))}:o;t.exports=l},7725:function(t,e){!function(t,e){function n(t,e,i){null!=t&&("number"==typeof t?this.fromNumber(t,e,i):null==e&&"string"!=typeof t?this.fromString(t,256):this.fromString(t,e))}function o(){return new n(null)}function r(t,e,i,n,o,r){for(;--r>=0;){var a=e*this[t++]+i[n]+o;o=Math.floor(a/67108864),i[n++]=67108863&a}return o}function a(t,e,i,n,o,r){for(var a=32767&e,s=e>>15;--r>=0;){var l=32767&this[t],h=this[t++]>>15,c=s*l+h*a;l=a*l+((32767&c)<<15)+i[n]+(1073741823&o),o=(l>>>30)+(c>>>15)+s*h+(o>>>30),i[n++]=1073741823&l}return o}function s(t,e,i,n,o,r){for(var a=16383&e,s=e>>14;--r>=0;){var l=16383&this[t],h=this[t++]>>14,c=s*l+h*a;l=a*l+((16383&c)<<14)+i[n]+o,o=(l>>28)+(c>>14)+s*h,i[n++]=268435455&l}return o}function l(t){return Qe.charAt(t)}function h(t,e){var i=ti[t.charCodeAt(e)];return null==i?-1:i}function c(t){for(var e=this.t-1;e>=0;--e)t[e]=this[e];t.t=this.t,t.s=this.s}function u(t){this.t=1,this.s=0>t?-1:0,t>0?this[0]=t:-1>t?this[0]=t+DV:this.t=0}function d(t){var e=o();return e.fromInt(t),e}function f(t,e){var i;if(16==e)i=4;else if(8==e)i=3;else if(256==e)i=8;else if(2==e)i=1;else if(32==e)i=5;else{if(4!=e)return void this.fromRadix(t,e);i=2}this.t=0,this.s=0;for(var o=t.length,r=!1,a=0;--o>=0;){var s=8==i?255&t[o]:h(t,o);0>s?"-"==t.charAt(o)&&(r=!0):(r=!1,0==a?this[this.t++]=s:a+i>this.DB?(this[this.t-1]|=(s&(1<<this.DB-a)-1)<<a,this[this.t++]=s>>this.DB-a):this[this.t-1]|=s<<a,(a+=i)>=this.DB&&(a-=this.DB))}8==i&&0!=(128&t[0])&&(this.s=-1,a>0&&(this[this.t-1]|=(1<<this.DB-a)-1<<a)),this.clamp(),r&&n.ZERO.subTo(this,this)}function p(){for(var t=this.s&this.DM;this.t>0&&this[this.t-1]==t;)--this.t}function g(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(16==t)e=4;else if(8==t)e=3;else if(2==t)e=1;else if(32==t)e=5;else{if(4!=t)return this.toRadix(t);e=2}var i,n=(1<<e)-1,o=!1,r="",a=this.t,s=this.DB-a*this.DB%e;if(a-- >0)for(s<this.DB&&(i=this[a]>>s)>0&&(o=!0,r=l(i));a>=0;)e>s?(i=(this[a]&(1<<s)-1)<<e-s,i|=this[--a]>>(s+=this.DB-e)):(i=this[a]>>(s-=e)&n,0>=s&&(s+=this.DB,--a)),i>0&&(o=!0),o&&(r+=l(i));return o?r:"0"}function _(){var t=o();return n.ZERO.subTo(this,t),t}function m(){return this.s<0?this.negate():this}function v(t){var e=this.s-t.s;if(0!=e)return e;var i=this.t;if(0!=(e=i-t.t))return e;for(;--i>=0;)if(0!=(e=this[i]-t[i]))return e;return 0}function y(t){var e,i=1;return 0!=(e=t>>>16)&&(t=e,i+=16),0!=(e=t>>8)&&(t=e,i+=8),0!=(e=t>>4)&&(t=e,i+=4),0!=(e=t>>2)&&(t=e,i+=2),0!=(e=t>>1)&&(t=e,i+=1),i}function w(){return this.t<=0?0:this.DB*(this.t-1)+y(this[this.t-1]^this.s&this.DM)}function b(t,e){var i;for(i=this.t-1;i>=0;--i)e[i+t]=this[i];for(i=t-1;i>=0;--i)e[i]=0;e.t=this.t+t,e.s=this.s}function x(t,e){for(var i=t;i<this.t;++i)e[i-t]=this[i];e.t=Math.max(this.t-t,0),e.s=this.s}function A(t,e){var i,n=t%this.DB,o=this.DB-n,r=(1<<o)-1,a=Math.floor(t/this.DB),s=this.s<<n&this.DM;for(i=this.t-1;i>=0;--i)e[i+a+1]=this[i]>>o|s,s=(this[i]&r)<<n;for(i=a-1;i>=0;--i)e[i]=0;e[a]=s,e.t=this.t+a+1,e.s=this.s,e.clamp()}function C(t,e){e.s=this.s;var i=Math.floor(t/this.DB);if(i>=this.t)return void(e.t=0);var n=t%this.DB,o=this.DB-n,r=(1<<n)-1;e[0]=this[i]>>n;for(var a=i+1;a<this.t;++a)e[a-i-1]|=(this[a]&r)<<o,e[a-i]=this[a]>>n;n>0&&(e[this.t-i-1]|=(this.s&r)<<o),e.t=this.t-i,e.clamp()}function T(t,e){for(var i=0,n=0,o=Math.min(t.t,this.t);o>i;)n+=this[i]-t[i],e[i++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n-=t.s;i<this.t;)n+=this[i],e[i++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;i<t.t;)n-=t[i],e[i++]=n&this.DM,n>>=this.DB;n-=t.s}e.s=0>n?-1:0,-1>n?e[i++]=this.DV+n:n>0&&(e[i++]=n),e.t=i,e.clamp()}function k(t,e){var i=this.abs(),o=t.abs(),r=i.t;for(e.t=r+o.t;--r>=0;)e[r]=0;for(r=0;r<o.t;++r)e[r+i.t]=i.am(0,o[r],e,r,0,i.t);e.s=0,e.clamp(),this.s!=t.s&&n.ZERO.subTo(e,e)}function S(t){for(var e=this.abs(),i=t.t=2*e.t;--i>=0;)t[i]=0;for(i=0;i<e.t-1;++i){var n=e.am(i,e[i],t,2*i,0,1);(t[i+e.t]+=e.am(i+1,2*e[i],t,2*i+1,n,e.t-i-1))>=e.DV&&(t[i+e.t]-=e.DV,t[i+e.t+1]=1)}t.t>0&&(t[t.t-1]+=e.am(i,e[i],t,2*i,0,1)),t.s=0,t.clamp()}function E(t,e,i){var r=t.abs();if(!(r.t<=0)){var a=this.abs();if(a.t<r.t)return null!=e&&e.fromInt(0),void(null!=i&&this.copyTo(i));null==i&&(i=o());var s=o(),l=this.s,h=t.s,c=this.DB-y(r[r.t-1]);c>0?(r.lShiftTo(c,s),a.lShiftTo(c,i)):(r.copyTo(s),a.copyTo(i));var u=s.t,d=s[u-1];if(0!=d){var f=d*(1<<this.F1)+(u>1?s[u-2]>>this.F2:0),p=this.FV/f,g=(1<<this.F1)/f,_=1<<this.F2,m=i.t,v=m-u,w=null==e?o():e;for(s.dlShiftTo(v,w),i.compareTo(w)>=0&&(i[i.t++]=1,i.subTo(w,i)),n.ONE.dlShiftTo(u,w),w.subTo(s,s);s.t<u;)s[s.t++]=0;for(;--v>=0;){var b=i[--m]==d?this.DM:Math.floor(i[m]*p+(i[m-1]+_)*g);if((i[m]+=s.am(0,b,i,v,0,u))<b)for(s.dlShiftTo(v,w),i.subTo(w,i);i[m]<--b;)i.subTo(w,i)}null!=e&&(i.drShiftTo(u,e),l!=h&&n.ZERO.subTo(e,e)),i.t=u,i.clamp(),c>0&&i.rShiftTo(c,i),0>l&&n.ZERO.subTo(i,i)}}}function I(t){var e=o();return this.abs().divRemTo(t,null,e),this.s<0&&e.compareTo(n.ZERO)>0&&t.subTo(e,e),e}function L(t){this.m=t}function R(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t}function P(t){return t}function O(t){t.divRemTo(this.m,null,t)}function D(t,e,i){t.multiplyTo(e,i),this.reduce(i)}function M(t,e){t.squareTo(e),this.reduce(e)}function N(){if(this.t<1)return 0;var t=this[0];if(0==(1&t))return 0;var e=3&t;return e=e*(2-(15&t)*e)&15,e=e*(2-(255&t)*e)&255,e=e*(2-((65535&t)*e&65535))&65535,e=e*(2-t*e%this.DV)%this.DV,e>0?this.DV-e:-e}function B(t){this.m=t,this.mp=t.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function F(t){var e=o();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&e.compareTo(n.ZERO)>0&&this.m.subTo(e,e),e}function z(t){var e=o();return t.copyTo(e),this.reduce(e),e}function V(t){for(;t.t<=this.mt2;)t[t.t++]=0;for(var e=0;e<this.m.t;++e){var i=32767&t[e],n=i*this.mpl+((i*this.mph+(t[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(i=e+this.m.t,t[i]+=this.m.am(0,n,t,e,0,this.m.t);t[i]>=t.DV;)t[i]-=t.DV,t[++i]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)}function U(t,e){t.squareTo(e),this.reduce(e)}function j(t,e,i){t.multiplyTo(e,i),this.reduce(i)}function H(){return 0==(this.t>0?1&this[0]:this.s)}function W(t,e){if(t>4294967295||1>t)return n.ONE;var i=o(),r=o(),a=e.convert(this),s=y(t)-1;for(a.copyTo(i);--s>=0;)if(e.sqrTo(i,r),(t&1<<s)>0)e.mulTo(r,a,i);else{var l=i;i=r,r=l}return e.revert(i)}function G(t,e){var i;return i=256>t||e.isEven()?new L(e):new B(e),this.exp(t,i)}function Z(){var t=o();return this.copyTo(t),t}function X(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function Y(){return 0==this.t?this.s:this[0]<<24>>24}function $(){return 0==this.t?this.s:this[0]<<16>>16}function q(t){return Math.floor(Math.LN2*this.DB/Math.log(t))}function K(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1}function J(t){if(null==t&&(t=10),0==this.signum()||2>t||t>36)return"0";var e=this.chunkSize(t),i=Math.pow(t,e),n=d(i),r=o(),a=o(),s="";for(this.divRemTo(n,r,a);r.signum()>0;)s=(i+a.intValue()).toString(t).substr(1)+s,r.divRemTo(n,r,a);return a.intValue().toString(t)+s}function Q(t,e){this.fromInt(0),null==e&&(e=10);for(var i=this.chunkSize(e),o=Math.pow(e,i),r=!1,a=0,s=0,l=0;l<t.length;++l){var c=h(t,l);0>c?"-"==t.charAt(l)&&0==this.signum()&&(r=!0):(s=e*s+c,++a>=i&&(this.dMultiply(o),this.dAddOffset(s,0),a=0,s=0))}a>0&&(this.dMultiply(Math.pow(e,a)),this.dAddOffset(s,0)),r&&n.ZERO.subTo(this,this)}function tt(t,e,i){if("number"==typeof e)if(2>t)this.fromInt(1);else for(this.fromNumber(t,i),this.testBit(t-1)||this.bitwiseTo(n.ONE.shiftLeft(t-1),lt,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(n.ONE.shiftLeft(t-1),this);else{var o=new Array,r=7&t;o.length=1+(t>>3),e.nextBytes(o),r>0?o[0]&=(1<<r)-1:o[0]=0,this.fromString(o,256)}}function et(){var t=this.t,e=new Array;e[0]=this.s;var i,n=this.DB-t*this.DB%8,o=0;if(t-- >0)for(n<this.DB&&(i=this[t]>>n)!=(this.s&this.DM)>>n&&(e[o++]=i|this.s<<this.DB-n);t>=0;)8>n?(i=(this[t]&(1<<n)-1)<<8-n,i|=this[--t]>>(n+=this.DB-8)):(i=this[t]>>(n-=8)&255,0>=n&&(n+=this.DB,--t)),0!=(128&i)&&(i|=-256),0==o&&(128&this.s)!=(128&i)&&++o,(o>0||i!=this.s)&&(e[o++]=i);return e}function it(t){return 0==this.compareTo(t)}function nt(t){return this.compareTo(t)<0?this:t}function ot(t){return this.compareTo(t)>0?this:t}function rt(t,e,i){var n,o,r=Math.min(t.t,this.t);for(n=0;r>n;++n)i[n]=e(this[n],t[n]);if(t.t<this.t){for(o=t.s&this.DM,n=r;n<this.t;++n)i[n]=e(this[n],o);i.t=this.t}else{for(o=this.s&this.DM,n=r;n<t.t;++n)i[n]=e(o,t[n]);i.t=t.t}i.s=e(this.s,t.s),i.clamp()}function at(t,e){return t&e}function st(t){var e=o();return this.bitwiseTo(t,at,e),e}function lt(t,e){return t|e}function ht(t){var e=o();return this.bitwiseTo(t,lt,e),e}function ct(t,e){return t^e}function ut(t){var e=o();return this.bitwiseTo(t,ct,e),e}function dt(t,e){return t&~e}function ft(t){var e=o();return this.bitwiseTo(t,dt,e),e}function pt(){for(var t=o(),e=0;e<this.t;++e)t[e]=this.DM&~this[e];return t.t=this.t,t.s=~this.s,t}function gt(t){var e=o();return 0>t?this.rShiftTo(-t,e):this.lShiftTo(t,e),e}function _t(t){var e=o();return 0>t?this.lShiftTo(-t,e):this.rShiftTo(t,e),e}function mt(t){if(0==t)return-1;var e=0;return 0==(65535&t)&&(t>>=16,e+=16),0==(255&t)&&(t>>=8,e+=8),0==(15&t)&&(t>>=4,e+=4),0==(3&t)&&(t>>=2,e+=2),0==(1&t)&&++e,e}function vt(){for(var t=0;t<this.t;++t)if(0!=this[t])return t*this.DB+mt(this[t]);return this.s<0?this.t*this.DB:-1}function yt(t){for(var e=0;0!=t;)t&=t-1,++e;return e}function wt(){for(var t=0,e=this.s&this.DM,i=0;i<this.t;++i)t+=yt(this[i]^e);return t}function bt(t){var e=Math.floor(t/this.DB);return e>=this.t?0!=this.s:0!=(this[e]&1<<t%this.DB)}function xt(t,e){var i=n.ONE.shiftLeft(t);return this.bitwiseTo(i,e,i),i}function At(t){return this.changeBit(t,lt)}function Ct(t){return this.changeBit(t,dt)}function Tt(t){return this.changeBit(t,ct)}function kt(t,e){for(var i=0,n=0,o=Math.min(t.t,this.t);o>i;)n+=this[i]+t[i],e[i++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n+=t.s;i<this.t;)n+=this[i],e[i++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;i<t.t;)n+=t[i],e[i++]=n&this.DM,n>>=this.DB;n+=t.s}e.s=0>n?-1:0,n>0?e[i++]=n:-1>n&&(e[i++]=this.DV+n),e.t=i,e.clamp()}function St(t){var e=o();return this.addTo(t,e),e}function Et(t){var e=o();return this.subTo(t,e),e}function It(t){var e=o();return this.multiplyTo(t,e),e}function Lt(){var t=o();return this.squareTo(t),t}function Rt(t){var e=o();return this.divRemTo(t,e,null),e}function Pt(t){var e=o();return this.divRemTo(t,null,e),e}function Ot(t){var e=o(),i=o();return this.divRemTo(t,e,i),new Array(e,i)}function Dt(t){this[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()}function Mt(t,e){if(0!=t){for(;this.t<=e;)this[this.t++]=0;for(this[e]+=t;this[e]>=this.DV;)this[e]-=this.DV,++e>=this.t&&(this[this.t++]=0),++this[e]}}function Nt(){}function Bt(t){return t}function Ft(t,e,i){t.multiplyTo(e,i)}function zt(t,e){t.squareTo(e)}function Vt(t){return this.exp(t,new Nt)}function Ut(t,e,i){var n=Math.min(this.t+t.t,e);for(i.s=0,i.t=n;n>0;)i[--n]=0;var o;for(o=i.t-this.t;o>n;++n)i[n+this.t]=this.am(0,t[n],i,n,0,this.t);for(o=Math.min(t.t,e);o>n;++n)this.am(0,t[n],i,n,0,e-n);i.clamp()}function jt(t,e,i){--e;var n=i.t=this.t+t.t-e;for(i.s=0;--n>=0;)i[n]=0;for(n=Math.max(e-this.t,0);n<t.t;++n)i[this.t+n-e]=this.am(e-n,t[n],i,0,0,this.t+n-e);i.clamp(),i.drShiftTo(1,i)}function Ht(t){this.r2=o(),this.q3=o(),n.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}function Wt(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var e=o();return t.copyTo(e),this.reduce(e),e}function Gt(t){return t}function Zt(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)}function Xt(t,e){t.squareTo(e),this.reduce(e)}function Yt(t,e,i){t.multiplyTo(e,i),this.reduce(i)}function $t(t,e){var i,n,r=t.bitLength(),a=d(1);if(0>=r)return a;i=18>r?1:48>r?3:144>r?4:768>r?5:6,n=8>r?new L(e):e.isEven()?new Ht(e):new B(e);var s=new Array,l=3,h=i-1,c=(1<<i)-1;if(s[1]=n.convert(this),i>1){var u=o();for(n.sqrTo(s[1],u);c>=l;)s[l]=o(),n.mulTo(u,s[l-2],s[l]),l+=2}var f,p,g=t.t-1,_=!0,m=o();for(r=y(t[g])-1;g>=0;){for(r>=h?f=t[g]>>r-h&c:(f=(t[g]&(1<<r+1)-1)<<h-r,g>0&&(f|=t[g-1]>>this.DB+r-h)),l=i;0==(1&f);)f>>=1,--l;if((r-=l)<0&&(r+=this.DB,--g),_)s[f].copyTo(a),_=!1;else{for(;l>1;)n.sqrTo(a,m),n.sqrTo(m,a),l-=2;l>0?n.sqrTo(a,m):(p=a,a=m,m=p),n.mulTo(m,s[f],a)}for(;g>=0&&0==(t[g]&1<<r);)n.sqrTo(a,m),p=a,a=m,m=p,--r<0&&(r=this.DB-1,--g)}return n.revert(a)}function qt(t){var e=this.s<0?this.negate():this.clone(),i=t.s<0?t.negate():t.clone();if(e.compareTo(i)<0){var n=e;e=i,i=n}var o=e.getLowestSetBit(),r=i.getLowestSetBit();if(0>r)return e;for(r>o&&(r=o),r>0&&(e.rShiftTo(r,e),i.rShiftTo(r,i));e.signum()>0;)(o=e.getLowestSetBit())>0&&e.rShiftTo(o,e),(o=i.getLowestSetBit())>0&&i.rShiftTo(o,i),e.compareTo(i)>=0?(e.subTo(i,e),e.rShiftTo(1,e)):(i.subTo(e,i),i.rShiftTo(1,i));return r>0&&i.lShiftTo(r,i),i}function Kt(t){if(0>=t)return 0;var e=this.DV%t,i=this.s<0?t-1:0;if(this.t>0)if(0==e)i=this[0]%t;else for(var n=this.t-1;n>=0;--n)i=(e*i+this[n])%t;return i}function Jt(t){var e=t.isEven();if(this.isEven()&&e||0==t.signum())return n.ZERO;for(var i=t.clone(),o=this.clone(),r=d(1),a=d(0),s=d(0),l=d(1);0!=i.signum();){for(;i.isEven();)i.rShiftTo(1,i),e?(r.isEven()&&a.isEven()||(r.addTo(this,r),a.subTo(t,a)),r.rShiftTo(1,r)):a.isEven()||a.subTo(t,a),a.rShiftTo(1,a);for(;o.isEven();)o.rShiftTo(1,o),e?(s.isEven()&&l.isEven()||(s.addTo(this,s),l.subTo(t,l)),s.rShiftTo(1,s)):l.isEven()||l.subTo(t,l),l.rShiftTo(1,l);i.compareTo(o)>=0?(i.subTo(o,i),e&&r.subTo(s,r),a.subTo(l,a)):(o.subTo(i,o),e&&s.subTo(r,s),l.subTo(a,l))}return 0!=o.compareTo(n.ONE)?n.ZERO:l.compareTo(t)>=0?l.subtract(t):l.signum()<0?(l.addTo(t,l),l.signum()<0?l.add(t):l):l}function Qt(t){var e,i=this.abs();if(1==i.t&&i[0]<=ei[ei.length-1]){for(e=0;e<ei.length;++e)if(i[0]==ei[e])return!0;return!1}if(i.isEven())return!1;for(e=1;e<ei.length;){for(var n=ei[e],o=e+1;o<ei.length&&ii>n;)n*=ei[o++];for(n=i.modInt(n);o>e;)if(n%ei[e++]==0)return!1}return i.millerRabin(t)}function te(t){var e=this.subtract(n.ONE),i=e.getLowestSetBit();if(0>=i)return!1;var r=e.shiftRight(i);(t=t+1>>1)>ei.length&&(t=ei.length);for(var a=o(),s=0;t>s;++s){a.fromInt(ei[Math.floor(De.Util.random()*ei.length)]);var l=a.modPow(r,this);if(0!=l.compareTo(n.ONE)&&0!=l.compareTo(e)){for(var h=1;h++<i&&0!=l.compareTo(e);)if(l=l.modPowInt(2,this),0==l.compareTo(n.ONE))return!1;if(0!=l.compareTo(e))return!1}}return!0}function ee(){this.i=0,this.j=0,this.S=new Array}function ie(t){var e,i,n;for(e=0;256>e;++e)this.S[e]=e;for(i=0,e=0;256>e;++e)i=i+this.S[e]+t[e%t.length]&255,n=this.S[e],this.S[e]=this.S[i],this.S[i]=n;this.i=0,this.j=0}function ne(){var t;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,t=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=t,this.S[t+this.S[this.i]&255]}function oe(){return new ee}function re(t){oi[ri++]^=255&t,oi[ri++]^=t>>8&255,oi[ri++]^=t>>16&255,oi[ri++]^=t>>24&255,ri>=ai&&(ri-=ai)}function ae(){re((new Date).getTime())}function se(){if(null==ni){for(ae(),ni=oe(),ni.init(oi),ri=0;ri<oi.length;++ri)oi[ri]=0;ri=0}return ni.next()}function le(t){var e;for(e=0;e<t.length;++e)t[e]=se()}function he(){}function ce(t,e){return new n(t,e)}function ue(t,e){if(e<t.length+11)return null;for(var i=new Array,o=t.length-1;o>=0&&e>0;){var r=t.charCodeAt(o--);128>r?i[--e]=r:r>127&&2048>r?(i[--e]=63&r|128,i[--e]=r>>6|192):(i[--e]=63&r|128,i[--e]=r>>6&63|128,i[--e]=r>>12|224)}i[--e]=0;for(var a=new he,s=new Array;e>2;){for(s[0]=0;0==s[0];)a.nextBytes(s);i[--e]=s[0]}return i[--e]=2,i[--e]=0,new n(i)}function de(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}function fe(t,e){this.n=ce(t,16),this.e=parseInt(e,16)}function pe(t){return t.modPowInt(this.e,this.n)}function ge(t){var e=ue(t,this.n.bitLength()+7>>3);if(null==e)return null;var i=this.doPrivate(e);if(null==i)return null;var n=i.toString(16);return 0==(1&n.length)?n:"0"+n}function _e(t,e){for(var i=t.toByteArray(),n=0;n<i.length&&0==i[n];)++n;if(i.length-n!=e-1||2!=i[n])return null;for(++n;0!=i[n];)if(++n>=i.length)return null;for(var o="";++n<i.length;){var r=255&i[n];128>r?o+=String.fromCharCode(r):r>191&&224>r?(o+=String.fromCharCode((31&r)<<6|63&i[n+1]),++n):(o+=String.fromCharCode((15&r)<<12|(63&i[n+1])<<6|63&i[n+2]),n+=2)}return o}function me(t,e,i){this.n=ce(t,16),this.e=parseInt(e,16),this.d=ce(i,16)}function ve(t,e,i,n,o,r,a,s){this.n=ce(t,16),this.e=parseInt(e,16),this.d=ce(i,16),this.p=ce(n,16),this.q=ce(o,16),this.dmp1=ce(r,16),this.dmq1=ce(a,16),this.coeff=ce(s,16)}function ye(t){if(null==this.p||null==this.q)return t.modPow(this.d,this.n);for(var e=t.mod(this.p).modPow(this.dmp1,this.p),i=t.mod(this.q).modPow(this.dmq1,this.q);e.compareTo(i)<0;)e=e.add(this.p);return e.subtract(i).multiply(this.coeff).mod(this.p).multiply(this.q).add(i)}function we(t){var e=ce(t,16),i=this.doPublic(e);return null==i?null:_e(i,this.n.bitLength()+7>>3)}function be(t,e,i){var n=0,o=0,r=e.split("\n"),a=2*t.measureText("e").width;return r.forEach(function(e){if(i){var r,s,l,h,c,u=e.split(" "),d=u.length,f="";for(l=0;d>l;l++)if(r=u[l]+(l===d-1?"":" "),s=f+r,h=t.measureText(s).width,i>h)f=s;else if(h==i)f="",o+=a;else{for(c=0;c<r.length;c++)if(s=f+r.substr(0,c+1),t.measureText(s).width>i){f=r.substring(c,r.length),o+=a;break}for(;f.length>0&&t.measureText(f).width>i;)for(c=0;c<f.length;c++)if(s=f.substr(0,c+1),t.measureText(s).width>i){f=f.substring(c,f.length),o+=a;break}}}else h=t.measureText(e).width,n=h>n?h:n;o+=a}),n=i||n,{w:n,h:o}}function xe(t,e,i,n){var o,r=t.animate,a=n._now,s=n._shapeDataIndex,l=i._animates;if(l||(l=i._animates={}),s.length)for(var h=0;h<s.length;h++){o=s[h];var c=l[o];c||(c=l[o]={}),l=c}else o=s;var u=l[o];u||(u=l[o]={},r.forEach(function(o){var r,s=o.attr,l=u[s];o={attr:s,to:o.to,type:o.type||"number",delay:o.delay||0,dur:o.dur||1e3,interval:o.interval||0,finish:o.finish,repeat:o.repeat||1,reverse:null==o.reverse||o.reverse,onDone:o.onDone,easing:o.easing,trigger:null==o.to,start:a,time:0,total:0,count:0,started:!1,stopped:!1,current:null},Array.isArray(o.dur)&&(o.groupDur=o.dur.slice(0,o.dur.length-1),o.dur=o.dur[o.dur.length-1],o.groupDurTotal=o.groupDur.reduce(function(t,e,i){return o.groupDur[i]=t+e},0),o.groupIndex=0,o.groupTime=0,o.groupStart=a),null==o.finish&&(o.finish=o.delay+o.dur+o.interval),l?Array.isArray(l)?(l.push(o),l=l[l.length-2]):u[s]=[l,o]:(r=Gi(i,e,t,s,n),u[s]=o),l&&(r=l.to,"group_set"===l.type&&(r=r[r.length-1])),o.from=r,o.trigger||(o.started=!0,Re(o),Pe(o))})),r=u,Object.keys(r).forEach(function(o){var s=r[o];if(Array.isArray(s)){var l=s[s.length-1];l.count+1===l.repeat?s.forEach(function(o){Ae(o,t,e,i,n,!0)}):l.count+1<l.repeat&&(l.total>=l.finish&&s.forEach(function(t){t.trigger||(t.started=!0),t.stopped=!1,t.time=0,t.start=a,t.total=0,"group_set"===t.type&&(t.groupIndex=0,t.groupTime=0,t.groupStart=a)}),s.forEach(function(o){Ae(o,t,e,i,n,!1)}))}else Ae(s,t,e,i,n,!0)})}function Ae(t,e,i,n,o,r){if(t.trigger){var a=Gi(n,i,e,t.attr,o,null,!1);if(!t.started){if(a===t.from)return;t.started=!0,t.start=o._now,t.to=a,Re(t),Pe(t)}t.started&&a!==t.to&&(t.start=o._now,t.from=t.current,t.to=a,t.time=0,t.total=0,t.count=0,Re(t),Pe(t))}if(t.started&&!t.stopped){var s=o._now,l=s-t.start;if(l>=t.delay&&(t.total=l,l-=t.delay,t.time=l>t.dur?t.dur:l,"group_set"===t.type&&(t.groupTime=s-t.groupStart,t.groupStart===t.start&&(t.groupTime-=t.delay),t.groupTime>=t.groupDur[t.groupIndex]&&t.groupIndex++,t.groupTime>=t.groupDurTotal&&(t.groupIndex=0,t.groupTime=t.groupTime-t.groupDurTotal,t.groupStart=s)),t.total>=t.finish))if(t.count++,t.type,t.count>=t.repeat)t.time=t.dur,t.stopped=!0,t.trigger&&(t.from=t.to,t.to=null,t.start=null,t.time=0,t.total=0,t.count=0,t.started=!1,t.stopped=!1),t.onDone&&t.onDone.call(i,n,o);else if(r&&(t.time=0,t.start=s,t.total=0,t.reverse)){var h=t.from;t.from=t.to,t.to=h,Pe(t)}o&&!o._invalidate&&(o._invalidate=!0)}}function Ce(t){if(!nn[t.id]){if(rn=!0,nn[t.id]=t,null==t.from&&t.attr&&t.source){var e;t.from=(e=t.attr.match(/^S[:@](.*)/i))?t.source.getStyle(e[1]):(e=t.attr.match(/^C[:@](.*)/i))?t.source.getClient(e[1]):De.Util.getValue(t.source,t.attr)}Re(t),Pe(t)}return t.resume(),t}function Te(t,e){return nn[t.id]&&(null==e&&(e=!0),e&&Le(t,t.to),t.onStop&&t.onStop(),t.time=0,t.total=0,t.start=null,t.count=0,t.started=!1,t.stopped=!1,t.paused=!1,t.pausedTime=null,t.pausedTotal=0,t._oldSpeed=null,t._speedTotal=0,t._speedTime=null,t._percent=0,t._percentSet=null,t._percentDiff=0,delete nn[t.id]),t}function ke(t){null==t&&(t=!0),Object.keys(nn).forEach(function(e){var i=nn[e];i&&(t&&Le(i,i.to),i.onStop&&i.onStop())}),nn={}}function Se(){Object.keys(nn).forEach(function(t){var e=nn[t];e&&e.pause()})}function Ee(){Object.keys(nn).forEach(function(t){var e=nn[t];e&&e.resume()})}function Ie(t){Object.keys(nn).forEach(function(e){var i=nn[e];if(i&&(null==i.start&&(i._speedTime=i.start=t),null!=i._percentSet&&(i._percentDiff+=(i._percentSet-i._percent)*i.finish),!i.paused||(i.pausedTime||(i.pausedTime=t),null!=i._percentSet))){if(null==i._percentSet&&i.pausedTime&&(i.pausedTotal+=(t-i.pausedTime)*(i._oldSpeed||i._speed),i.pausedTime=null),i._oldSpeed&&!i.pausedTime&&(i._speedTotal=(t-i._speedTime)*i._oldSpeed-i.pausedTotal+i._percentDiff+i._speedTotal,i._percentDiff=0,i.pausedTotal=0,i._speedTime=t,i._oldSpeed=null),i.total=(t-i._speedTime)*i._speed-i.pausedTotal+i._percentDiff+i._speedTotal,null!=i._percentSet&&i.pausedTime&&(i.total-=(t-i.pausedTime)*(i._oldSpeed||i._speed)),i._percent=i.total>=i.finish?1:i.total/i.finish,i.total>i.delay){i.time=i.total-i.delay;var n=!1;if(i.time>=i.dur&&(i.time=i.dur,i.total>=i.finish&&(n=!0)),!i.stopped&&Le(i,Oe(i)),i.stopped=n,i.total>=i.finish)if(++i.count>=i.repeat)Te(i,!1),i.onDone&&i.onDone();else if(i.time=0,i.total=0,i.start=null,i.stopped=!1,i.reverse){var o=i.from;i.from=i.to,i.to=o,Pe(i)}}i.paused||!rn&&(rn=!0),null!=i._percentSet&&(i._percentSet=null)}})}function Le(t,e){if(t.started||(t.started=!0,t.onPlay&&t.onPlay()),t.filter&&(e=t.filter(e)),t.attr&&t.source){var i;(i=t.attr.match(/^S[:@](.*)/i))?t.source.setStyle(i[1],e):(i=t.attr.match(/^C[:@](.*)/i))?t.source.setClient(i[1],e):De.Util.setValue(t.source,t.attr,e)}t.onUpdate&&t.onUpdate(e)}function Re(t){var e=t.type,i=t.from,n=t.to;"number"===e?(t.from=i||0,t.to=n||0):"point"===e?(i?i.length&&(t.from={x:i[0],y:i[1]}):t.from="scale"===t.attr?{x:1,y:1}:{x:0,y:0},n?n.length&&(t.to={x:n[0],y:n[1]}):t.to="scale"===t.attr?{x:1,y:1}:{x:0,y:0}):"rect"===e?(i?i.length&&(t.from={x:i[0],y:i[1],w:i[2],h:i[3]}):t.from={x:0,y:0,w:0,h:0},n?n.length&&(t.to={x:n[0],y:n[1],w:n[2],h:n[3]}):t.to={x:0,y:0,w:0,h:0}):"color"===e&&(t.from=pn(i),t.to=pn(n)),t.current=t.from}function Pe(t){var e=t.type,i=t.from,n=t.to;"number"===e?t.delta=n-i:"point"===e?t.delta={x:n.x-i.x,y:n.y-i.y}:"rect"===e?t.delta={x:n.x-i.x,y:n.y-i.y,w:n.w-i.w,h:n.h-i.h}:"color"===e&&(t.delta={r:n.r-i.r,g:n.g-i.g,b:n.b-i.b,a:n.a-i.a})}function Oe(t,e){var i=t.type,n=t.delta,o=t.from,r=t.time,a=t.dur,s=an[t.easing||"easeNone"];return s||(s=an.easeNone),"number"===i?e=s(r,o,n,a):"point"===i?e={x:s(r,o.x,n.x,a),y:s(r,o.y,n.y,a)}:"rect"===i?e={x:s(r,o.x,n.x,a),y:s(r,o.y,n.y,a),w:s(r,o.w,n.w,a),h:s(r,o.h,n.h,a)}:"color"===i?e="rgba("+Math.floor(s(r,o.r,n.r,a))+","+Math.floor(s(r,o.g,n.g,a))+","+Math.floor(s(r,o.b,n.b,a))+","+Math.floor(s(r,o.a,n.a,a))+")":"set"===i?t.time&&(e=t.to):"group_set"===i&&(e=t.to[t.groupIndex]),t.current=e,e}t.twaver&&(t.twaver.animateLoopId&&cancelAnimationFrame(t.twaver.animateLoopId),t.twaver.animateLoopId=null);var De={};De._isInitializing=!1;var Me={isDeserializing:!1,isCalculatingBus:!1,images:{},registerImage:function(t,e,i,n,o){Me.images[t]=new De.ImageAsset(t,e,i,n,o),wn(t)},getRegisteredImageNames:function(){return Object.keys(Me.images)},unregisterImage:function(t){delete Me.images[t]},getImageAsset:function(t){if("string"==typeof t){return Me.images[t]}},showVersion:function(t){Me.isCtrlDown(t)&&t.shiftKey&&76==t.keyCode&&alert("TWaver HTML5 "+De.Util.getVersion()+"\n"+Ne)},callLater:function(t,e,i,n){return setTimeout(function(){t.apply(e,i)},n||kn.CALL_LATER_DELAY)},isEmptyObject:function(t){for(var e in t)return!1;return!0},xml:function(e){if(t.DOMParser)return(new DOMParser).parseFromString(e,"text/xml");var i=new ActiveXObject("Microsoft.XmlDOM");return i.async=!1,i.loadXml(e),i},num:function(t){return"number"==typeof t&&!isNaN(t)&&isFinite(t)},getter:function(t){var e=t.charAt(0).toUpperCase()+t.slice(1);return(/ble$/.test(t)||/ed$/.test(t)?"is":"get")+e},setter:function(t){return"set"+(t.charAt(0).toUpperCase()+t.slice(1))},_id:["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F"],id:function(){for(var t=[],e=0;32>e;e++)t[e]=this._id[Math.floor(16*De.Util.random())];return t[12]="4",t[16]=this._id[3&t[16]|8],t.join("")},keys:function(t){var e=new hn;for(var i in t)e.add(i);return e},es:["toString","toLocaleString","valueOf"],ip:function(t,e){var i="_"+e;t[Me.getter(e)]=function(){return this[i]},t[Me.setter(e)]=function(t){var n=this[i];this[i]=t,this.firePropertyChange(e,n,t)}},validateLicense:function(t){Ne=t,hi()},ibool:function(t,e){var i="_"+e;t["is"+(e.charAt(0).toUpperCase()+e.slice(1))]=function(){return this[i]},t[Me.setter(e)]=function(t){var n=this[i];this[i]=t,this.firePropertyChange(e,n,t)}},getValue:function(t,e,i){var n=e.charAt(0).toUpperCase()+e.slice(1),o="get"+n,r="is"+n;return i?"boolean"===i?t[r]():t[o]():t[o]?t[o]():t[r]?t[r]():t[e]},setValue:function(t,e,i){t["set"+e.charAt(0).toUpperCase()+e.slice(1)](i)},clone:function(t){if(!t)return null;var e={};for(var i in t)e[i]=t[i];return e},cloneRect:function(t){return t?{x:t.x,y:t.y,width:t.width,height:t.height}:null},classCache:{},getClass:function(e){var i=Me.classCache[e];if(!i){var n=e.split("."),o=n.length;i=t;for(var r=0;o>r;r++)(i=i[n[r]])||"twaver"===n[r]&&(i=De);Me.classCache[e]=i}return i},newInstance:function(e){var i=Me.getClass(e)||t[e];if(!i)return null;var n=arguments.length,o=arguments;if(1===n)return new i;if(2===n)return new i(o[1]);if(3===n)return new i(o[1],o[2]);if(4===n)return new i(o[1],o[2],o[3]);if(5===n)return new i(o[1],o[2],o[3],o[4]);if(6===n)return new i(o[1],o[2],o[3],o[4],o[5]);if(7===n)return new i(o[1],o[2],o[3],o[4],o[5],o[6]);if(8===n)return new i(o[1],o[2],o[3],o[4],o[5],o[6],o[7]);throw"don't support args more than 7"},addMethod:function(t,e){var i=t.prototype;for(var n in e)i[n]=e[n]},ext:function(t,e,i){var n;if("string"==typeof t&&(n=t,t=Me.getClass(t)),e){var o=function(){};o.prototype=e.prototype,t.prototype=new o,t.prototype.constructor=t,t.superClass=e.prototype,e.prototype.constructor==Object.prototype.constructor&&(e.prototype.constructor=e)}if(n&&(t.prototype.getClassName=function(){return n}),i){var r=t.prototype;for(var a in i)je.ext(a,r,i);for(var s=Me.es.length,l=0;s>l;l++)a=Me.es[l],i.hasOwnProperty(a)&&!i.propertyIsEnumerable(a)&&(r[a]=i[a])}},setViewBounds:function(t,e){if(t)if(t.adjustBounds)t.adjustBounds(e);else{var i=t.style;!i&&t.getView()&&(i=t.getView().style),i&&(i.position="absolute",i.left=e.x+"px",i.top=e.y+"px",i.width=e.width+"px",i.height=e.height+"px")}},getImageSrc:function(t){var e=Me.getImageAsset(t);return e?e.getSrc()?e.getSrc():e.getImage().getAttribute("src"):t},nextColorCount:0,nextColor:function(){return Me.nextColorCount>=kn.COLORS.length&&(Me.nextColorCount=0),kn.COLORS[Me.nextColorCount++]},isCtrlDown:function(t){return t.ctrlKey||t.metaKey},isShiftDown:function(t){return t.shiftKey},isAltDown:function(t){return t.altKey},setText:function(t,e,i){i?Ue.isFirefox?t.textContent=e:t.innerText=e:t.innerHTML=e},fillDescendant:function(t,e){e.add(t),t.hasChildren()&&t.getChildren().forEach(function(t){Me.fillDescendant(t,e)})}},Ne=(Date,"l=1.0\ntype=1\ngis=1\n3d=0\nstart=2016-09-30\nend=2017-01-01\nnote=This license applies to the evaluation version of TWaver. The License is limited to noncommercial use. Noncommercial use relates only to educational, research, personal or evaluation purposes. Any other use is commercial use. You may not use the Software in connection with any business activities.And You are not permitted to modify the software or attempt to decipher, decompile, disassemble or reverse engineer this Software.\nsignature=695c686e7d50c0f8ecded011f058b902cf84aff3d1368b2e1a664f8932f86e22dd83ff55803420ab71a79f0e4ed4a7afceb7189400522e83a58b8ad7a9b0abf69f69496b85667c3ade5cb76c146b636a2169910aefb4799757c72e6343981abfe93e829dfd22206550280d1be949e7d60c107ca700da2c91d92f09b85335baa34e2452fe7d78e9272b10d1b0baf68a8b3650173cbf64217697497880e1049eb078e68de084df997a145e0acf65c0b3b622f07a58aecd7ef7e77c01ecc4c4542fb9d8ddfc77ff1f1f07a7b59587dd78ad8ff6fb596c2593443f647835312730166f0c98f8e42c1ccd45c7fbf28fbe617c94cf2ec0924d8e6de99287654d61cea117f3a21342631a3c729d8d9685b9b91e83d8102c5955346a7fbbc86e6ce733c9b438edbcc3bce9f1c49c679db2bff4e584e0100253a506b57be73deb50a727e8d27ed70dd94cd2bcfb957dd87b1474592ce2d9ebb6a3ea7166e1e64d14935701d7b525a3f14cdc80531dfb43c40791dd945ca0bb8792352ef35aebeeccdc1b4e59cf51229a0405041c8762ca7daeba097cd183110695d1db0121b0eee09217c4947c578aac95b068559dba36b11f9295672d2153343a9572a89d0fad499857bcab0ec5841747e8421fe69655aa86f78ce4dfd3309a3fb9653ae52b5cefd22ca3ea4bf73efcd60045677c05770e67d130b9523a2744ea799375ff6882154b4b455f481775c5f217704434ba8edf887b1a1087e405b209fc3ee7863a224d80284cd2770f2f580785f75c26a0dd3f90c3475b8109ea57a1d88a3af588f183e21d2f56c0b0e89bbbeb56703348545471c1d003e92ca467984b7ceed4f0b38a0ced25c16564522b72ac503074da0a808f5f776db5ff2a7e45fe56dd2f8acce0d3db06");t.twaver=De,t._twaver=Me,De.animate={},De.network={},De.network.interaction={},De.controls={},De.charts={},De.layout={};var Be,Fe=t.navigator,ze=t.document,Ve=t.Image;t.document;var Ue=function(){var t={},e=Fe.userAgent.toLowerCase();return t.isOpera=/opera/.test(e),t.isIE=/msie/.test(e)||/trident/.test(e)||/edge/.test(e),t.isFirefox=/firefox/i.test(e),t.isChrome=/chrome/i.test(e),t.isSafari=!t.isChrome&&/safari/i.test(e),t.isIPhone=/iphone/.test(e),t.isIPod=/ipod/.test(e),t.isIPad=/ipad/.test(e),t.isAndroid=/android/i.test(e),t.isWebOS=/webos/i.test(e),t.isMSTouchable=t.isIE&&(Fe.msMaxTouchPoints&&Fe.msMaxTouchPoints>1||Fe.maxTouchPoints&&Fe.maxTouchPoints>1),t.isTouchable="ontouchend"in ze||t.isMSTouchable,t}();Me.ua=Ue;var je={__accessor:function(t,e){for(var i=e.__accessor,n=i.length,o=0;n>o;o++)Me.ip(t,i[o])},__bool:function(t,e){for(var i=e.__bool,n=i.length,o=0;n>o;o++)Me.ibool(t,i[o])},__client:function(t,e){t.getClient=function(t){return this._clientMap[t]},t.setClient=function(t,e){var i=this._clientMap[t];return null==e?delete this._clientMap[t]:this._clientMap[t]=e,this.firePropertyChange("C:"+t,i,e)&&this.onClientChanged(t,i,e),this},t.getClientProperties=function(){return Me.keys(this._clientMap)},t.getClientMap=function(){return this._clientMap},t.onClientChanged=function(t,e,i){}},__style:function(t,i){t.getStyle=function(t,i){var n=this._styleMap[t];return i===e&&(i=!0),null==n&&i?De.Styles.getStyle(t):n},t.setStyle=function(t,e){var i=this._styleMap[t];return null==e?delete this._styleMap[t]:this._styleMap[t]=e,this.firePropertyChange("S:"+t,i,e)&&this.onStyleChanged(t,i,e),this},t.getStyleProperties=function(){return Me.keys(this._styleMap)},t.onStyleChanged=function(t,e,i){}},__new:function(t,e){t.newInstance=function(){var t=Me.getClass(this.getClassName());if(!t)return null;var e=arguments.length,i=arguments;if(0===e)return new t;if(1===e)return new t(i[0]);if(2===e)return new t(i[0],i[1]);if(3===e)return new t(i[0],i[1],i[2]);if(4===e)return new t(i[0],i[1],i[2],i[3]);if(5===e)return new t(i[0],i[1],i[2],i[3],i[4]);if(6===e)return new t(i[0],i[1],i[2],i[3],i[4],i[5]);if(7===e)return new t(i[0],i[1],i[2],i[3],i[4],i[5],i[6]);throw"don't support args more than 7"}},__property:function(t,e){t.getValue=function(t,e){return"accessor"===this._propertyType?Me.getValue(t,this._propertyName):"style"===this._propertyType&&t.getStyle?t.getStyle(this._propertyName):"client"===this._propertyType&&t.getClient?t.getClient(this._propertyName):"field"===this._propertyType?t[this._propertyName]:null},t.setValue=function(t,e,i){if("accessor"===this._propertyType)t[Me.setter(this._propertyName)](e);else{if("style"===this._propertyType&&t.setStyle)return t.setStyle(this._propertyName,e);if("client"===this._propertyType&&t.setClient)return t.setClient(this._propertyName,e);"field"===this._propertyType&&(t[this._propertyName]=e)}}},map:{__accessor:1,__bool:1,__client:1,__style:1,__new:1,__tree:1,__property:1},ext:function(t,e,i){1===je.map[t]?je[t](e,i):e[t]=i[t]}};Me.extend=je;var He=Me.Matrix=function(t,e,i,n,o,r){this.setMatrix(t,e,i,n,o,r)};He.identity=function(){return new He(1,0,0,1,0,0)},He.prototype.setMatrix=function(t,e,i,n,o,r){this._m11=t,this._m12=e,this._m21=i,this._m22=n,this._offsetX=o,this._offsetY=r,this._type=0,0!=this._m21||0!=this._m12?this._type=4:((1!=this._m11||1!=this._m22)&&(this._type=2),(0!=this._offsetX||0!=this._offsetY)&&(this._type|=1),0==(3&this._type)&&(this._type=0))},He.prototype.transform=function(){var t;if(!(t=2===arguments.length?{x:arguments[0],y:arguments[1]}:arguments[0])||!Me.num(t.x)||!Me.num(t.y))throw"arguments should contain x, y";switch(this._type){case 0:return{x:t.x,y:t.y};case 1:return{x:this._offsetX+t.x,y:this._offsetY+t.y};case 2:return{x:t.x*this._m11,y:t.y*this._m22};case 3:return{x:t.x*this._m11+this._offsetX,y:t.y*this._m22+this._offsetY}}return{x:this._m11*t.x+t.y*this._m21+this._offsetX,y:this._m22*t.y+t.x*this._m12+this._offsetY}},He.prototype.translate=function(t,e){this.multiply(new He(1,0,0,1,t,e))},He.prototype.scale=function(t,e){this.multiply(new He(t,0,0,e,0,0))},He.prototype.rotate=function(t,e,i){t=t*Math.PI/180;var n=Math.sin(t),o=Math.cos(t),r=e*(1-o)+i*n,a=i*(1-o)-e*n;this.multiply(new He(o,n,-n,o,r,a))},He.prototype.skew=function(t,e){this.multiply(new He(1,Math.tan(e*Math.PI/180),Math.tan(t*Math.PI/180),1,0,0))},He.prototype.multiply=function(t){var e=this,i=t,n=e._type,o=i._type;if(0!=o)if(0==n)e.setMatrix(i._m11,i._m12,i._m21,i._m22,i._offsetX,i._offsetY);else if(1==o)e._offsetX+=i._offsetX,e._offsetY+=i._offsetY,4!=n&&(e._type|=1);else if(1==n){var r=e._offsetX,a=e._offsetY;e.setMatrix(i._m11,i._m12,i._m21,i._m22,i._offsetX,i._offsetY),e._offsetX=r*i._m11+a*i._m21+i._offsetX,e._offsetY=r*i._m12+a*i._m22+i._offsetY,e._type=4==o?4:3}else switch(n<<4|o){case 34:return e._m11*=i._m11,void(e._m22*=i._m22);case 35:return e._m11*=i._m11,e._m22*=i._m22,e._offsetX=i._offsetX,e._offsetY=i._offsetY,void(e._type=3);case 36:case 52:case 66:case 67:case 68:return void e.setMatrix(e._m11*i._m11+e._m12*i._m21,e._m11*i._m12+e._m12*i._m22,e._m21*i._m11+e._m22*i._m21,e._m21*i._m12+e._m22*i._m22,e._offsetX*i._m11+e._offsetY*i._m21+i._offsetX,e._offsetX*i._m12+e._offsetY*i._m22+i._offsetY);case 50:return e._m11*=i._m11,e._m22*=i._m22,e._offsetX*=i._m11,void(e._offsetY*=i._m22);case 51:return e._m11*=i._m11,e._m22*=i._m22,e._offsetX=i._m11*e._offsetX+i._offsetX,void(e._offsetY=i._m22*e._offsetY+i._offsetY);default:console.log("Matrix multiply hit an invalid case: "+combinedType)}};var We={getDistance:function(t,e){var i=e.x-t.x,n=e.y-t.y;return Math.sqrt(i*i+n*n)},getCenterPoint:function(t,e){return t&&e?{x:(t.x+e.x)/2,y:(t.y+e.y)/2}:null==e&&t.width?{x:t.x+t.width/2,y:t.y+t.height/2}:void 0},isPointInPolygon:function(t,e){t=t._as?t._as:t;var i=0,n=0,o=!1,r=t.length;for(i=0,n=r-1;r>i;n=i++){var a=t[i],s=t[n];a.y>e.y!=s.y>e.y&&e.x<(s.x-a.x)*(e.y-a.y)/(s.y-a.y)+a.x&&(o=!o)}return o},unionRect:function(t,e){if(t&&!e)return Me.cloneRect(t);if(!t&&e)return Me.cloneRect(e);if(t&&e){var i={};return i.x=Math.min(t.x,e.x),i.y=Math.min(t.y,e.y),i.width=Math.max(t.x+t.width,e.x+e.width)-i.x,i.height=Math.max(t.y+t.height,e.y+e.height)-i.y,i}return null},intersects:function(t,e){if(!t||!e)return!1;var i=e.width,n=e.height,o=t.width,r=t.height;if(0>=o||0>=r||0>=i||0>=n)return!1;var a=e.x,s=e.y,l=t.x,h=t.y;return o+=l,r+=h,i+=a,n+=s,(l>o||o>a)&&(h>r||r>s)&&(a>i||i>l)&&(s>n||n>h)},intersection:function(t,e){if(!t||!e)return!1;var i=e.x,n=e.y,o=t.x,r=t.y,a=i;a+=e.width;var s=n;s+=e.height;var l=o;l+=t.width;var h=r;return h+=t.height,o>i&&(i=o),r>n&&(n=r),a>l&&(a=l),s>h&&(s=h),a-=i,s-=n,0===a||0===s?null:{x:i,y:n,width:a,height:s}},contains:function(t,e){var i=e.x,n=e.y,o=e.width,r=e.height,a=t.width,s=t.height;if(0>(a|s|o|r))return!1;var l=t.x,h=t.y;if(l>i||h>n)return!1;if(a+=l,o+=i,i>=o){if(a>=l||o>a)return!1}else if(a>=l&&o>a)return!1;if(s+=h,r+=n,n>=r){if(s>=h||r>s)return!1}else if(s>=h&&r>s)return!1;return!0},getLinePoints:function(t){if(!t)return null;var e=new hn;return t.forEach(function(t){e.addAll(t)}),e},getLineRect:function(t){var e=We.getLinePoints(t);return We.getRect(e)},getRect:function(t,e){if(!t)return null;t._as&&(t=t._as);var i=t.length;if(0>=i)return null;var n=t[0];e=e||{x:null,y:null,width:0,height:0};for(var o=0;i>o;o++)if((n=t[o])instanceof hn)We.getRect(n,e);else{null==e.x&&(e.x=n.x,e.y=n.y);var r=Math.min(e.x,n.x),a=Math.min(e.y,n.y),s=Math.max(e.x+e.width,n.x),l=Math.max(e.y+e.height,n.y);e.x=r,e.y=a,e.width=s-r,e.height=l-a}return e},addPadding:function(t,e,i,n){n=n||-1;var o=e.getStyle(i)*n;0!=o&&We.grow(t,o,o),o=e.getStyle(i+".left")*n,0!=o&&(t.x-=o,t.width+=o),o=e.getStyle(i+".right")*n,0!=o&&(t.width+=o),o=e.getStyle(i+".top")*n,0!=o&&(t.y-=o,t.height+=o),o=e.getStyle(i+".bottom")*n,0!=o&&(t.height+=o),t.width<0&&(t.width=-t.width,t.x-=t.width),t.height<0&&(t.height=-t.height,t.y-=t.height)},grow:function(t,e,i){if(null==t)return null;null==i&&(i=e);var n=t.width+e+e;if(!(0>n)){var o=t.height+i+i;if(!(0>o))return t.x-=e,t.y-=i,t.width=n,t.height=o,t}},containsPoint:function(t,e,i){return arguments.length<3&&(i=e.y,e=e.x),!(!t||e<t.x||i<t.y||e>t.x+t.width||i>t.y+t.height)},getHotSpot:function(t,e,i,n,o){if("oval"===o){return{x:t+.5*i+.35*i,y:e+n/2-Math.sqrt(.1275)*n}}if("circle"===o){var r=t+i/2,a=e+n/2,s=Math.min(i,n)/2;t=r-s,e=a-s,i=2*s,n=2*s;var l=i/2,h=n/2,c=l*h/Math.sqrt(l*l+h*h);return{x:t+i/2+c,y:e+n/2-c}}var u={x:t+i,y:e};return i>3&&(u.x-=3),n>3&&(u.y+=3),u},getCircleRect:function(t){var e=Math.min(t.width,t.height)/2;return{x:t.x+t.width/2-e,y:t.y+t.height/2-e,width:2*e,height:2*e}},getEllipsePoint:function(t,e){if(!t||!e)return null;var i=t.x+t.width/2,n=t.y+t.height/2,o=e.x-i,r=e.y-n,a=t.width/2,s=t.height/2,l=Math.sqrt(1/(1/a/a+r*r/o/o/s/s));0>o&&(l=-l);var h;return h=0==o?r>0?s:-s:l*r/o,{x:i+l,y:n+h}},createMatrix:function(t,e,i){var n=Math.sin(t),o=Math.cos(t);return new He(o,n,-n,o,e*(1-o)+i*n,i*(1-o)-e*n)},calculatePointInfoAlongLineBySegments:function(t,e,i,n,o){return We.calculatePointInfoAlongLine(We.getPointObject(t,e),i,n,o)},calculatePointInfoAlongLine:function(t,i,n,o){if(i=i===e||i,n=n||0,o=o||0,!t||t.size()<2)throw"must more than two points";if(!i){var r=We.reversePath(t);return We.calculatePointInfoAlongLine(r,!0,n,o)}t._as&&(t=t._as);var a,s,l,h,c,u=0,d=0,f=t.length;for(h=0;f>h;h++)if(c=t[h],0!=h){if(0>=n){l=We.calculatePointInfoOnStraightLine(We._getPoint(s),We._getControlPoint(c),n,o),a=l;break}if(d=We._getLength(c,s),u+d>n){l=We.getPathInfo(c,s,n-u,o,d),a=l;break}u+=d,s=c}else s=c;if(null==a){var p,g;s=t[f-1],g=We._getPoint(s),s instanceof hn&&(s=s._as),p=s instanceof Array?We._getControlPoint(s):We._getPoint(t[f-2]);var _=Math.atan2(g.y-p.y,g.x-p.x);l=We.transformPoint(g,_,n-u,o),l.angle=_,a=l}return a},reversePath:function(t){var e,i=new hn,n=null;t._as&&(t=t._as);for(var o=t.length-1;o>=0;o--)e=t[o],i.add(We._getReversePath(e,n)),n=e;return i},_getPoint:function(t){return t._as&&(t=t._as),t instanceof Array?t[t.length-1]:t},_getControlPoint:function(t){return t._as&&(t=t._as),t instanceof Array?t[t.length-2]:t},_getReversePath:function(t,e){var i=We._getPoint(t);return e&&e._as&&(e=e._as),null!=e&&e instanceof Array?new hn(2==e.length?[e[0],i]:[e[1],e[0],i]):i},_getLength:function(t,e){var i=We._getPoint(e),n=We._getPoint(t);if(t instanceof hn&&(t=t._as),t instanceof Array)return We.calculateCurveLength(i,t,1);var o=n.y-i.y,r=n.x-i.x;return Math.sqrt(r*r+o*o)},getPathInfo:function(t,e,i,n,o){var r,a=We._getPoint(e),s=We._getPoint(t);if(t instanceof hn&&(t=t._as),t instanceof Array){0>o&&(o=We._getLength(t,e));var l=i/o,h=We.calculatePointInfoOnCurveLine(a,t,l);a=h.point,r=h.angle,i=0}else r=Math.atan2(s.y-a.y,s.x-a.x);return We.transformPoint(a,r,i,n)},transformPoint:function(t,e,i,n){var o={x:i,y:n};return o=We.createMatrix(e,0,0).transform(o),o.x+=t.x,o.y+=t.y,{point:o,angle:e}},calculatePointInfoOnStraightLine:function(t,e,i,n){var o=Math.atan2(e.y-t.y,e.x-t.x);return We.transformPoint(t,o,i,n)},calculatePointInfoOnCurveLine:function(t,e,i){if(0>i||i>1)throw"Illegal arguments";return e._as&&(e=e._as),2==e.length?We._calculatePointInfoOnCurveLine2(t,e[0],e[1],i):We._calculatePointInfoOnCurveLine3(t,e[0],e[1],e[2],i)},_calculatePointInfoOnCurveLine2:function(t,e,i,n){var o=2*(t.x+i.x-2*e.x)*n+2*e.x-2*t.x,r=2*(t.y+i.y-2*e.y)*n+2*e.y-2*t.y,a=Math.atan2(r,o);return{point:{x:(t.x+i.x-2*e.x)*n*n+(2*e.x-2*t.x)*n+t.x,y:(t.y+i.y-2*e.y)*n*n+(2*e.y-2*t.y)*n+t.y},angle:a}},_calculatePointInfoOnCurveLine3:function(t,e,i,n,o){var r,a,s;return r=1-o,a=r*r*r,s=o*o*o,{point:{x:a*t.x+3*o*r*r*e.x+3*o*o*r*i.x+s*n.x,y:a*t.y+3*o*r*r*e.y+3*o*o*r*i.y+s*n.y},angle:Math.atan2(We._bezeSpeedY(t,e,i,n,o),We._bezeSpeedX(t,e,i,n,o))}},calculateCurveLength:function(t,e,i){return e._as&&(e=e._as),2==e.length?We._calculateCurveLength(t,e[0],e[1],i):We._calculateBezierCurveLength(t,e[0],e[1],e[2],i)},_calculateCurveLength:function(t,e,i,n){if(0>=n||n>1)return 0;var o=Math.floor(n*(Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y))+Math.sqrt((i.x-e.x)*(i.x-e.x)+(i.y-e.y)*(i.y-e.y)))/2),r=0;0>=o&&(o=1);for(var a,s,l=n/o,h=0,c=0;o>c;c++)h=l*c,a=2*(t.x+i.x-2*e.x)*h+2*e.x-2*t.x,s=2*(t.y+i.y-2*e.y)*h+2*e.y-2*t.y,a*=l,s*=l,r+=Math.sqrt(a*a+s*s);return r},_calculateBezierCurveLength:function(t,e,i,n,o){if(0>=o||o>1)return 0;var r=Math.floor(1e4*o);if(1==(1&r)&&r++,0==r)return 0;var a,s=Math.floor(r/2),l=0,h=0,c=o/r;for(a=0;s>a;a++)l+=We._bezeSpeed(t,e,i,n,(2*a+1)*c);for(a=1;s>a;a++)h+=We._bezeSpeed(t,e,i,n,2*a*c);return(We._bezeSpeed(t,e,i,n,0)+We._bezeSpeed(t,e,i,n,1)+2*h+4*l)*c/3},_bezeSpeedX:function(t,e,i,n,o){var r=1-o;return-3*t.x*r*r+3*e.x*r*r-6*e.x*r*o+6*i.x*r*o-3*i.x*o*o+3*n.x*o*o},_bezeSpeedY:function(t,e,i,n,o){var r=1-o;return-3*t.y*r*r+3*e.y*r*r-6*e.y*r*o+6*i.y*r*o-3*i.y*o*o+3*n.y*o*o},_bezeSpeed:function(t,e,i,n,o){var r=We._bezeSpeedX(t,e,i,n,o),a=We._bezeSpeedY(t,e,i,n,o);return Math.sqrt(r*r+a*a)},getPointObject:function(t,e){if(e&&0!=e.size()){var i=new hn;e=e._as,t=t._as;var n,o,r=0,a=e.length,s=t.length;for(n=0;a>n&&(o=e[n],r!=s);n++)"cubicto"===o?s-2>r&&i.add([t[r++],t[r++],t[r++]]):"quadto"===o?s-1>r&&i.add([t[r++],t[r++]]):s>r&&i.add(t[r++]);for(;s>r;r++)i.add(t[r]);return i}return t},calculateLineLength:function(t,e){if(!t||t.size()<2)return 0;if(e)return We.calculateLineLength(We.getPointObject(t,e));t=t._as;var i,n,o,r,a,s,l,h=t.length,c=0;for(i=0;h>i;i++)r=t[i],0!=i?(o=r,o instanceof hn&&(o=o._as),o instanceof Array?(a=We.calculateCurveLength(n,o,1),n=o[o.length-1]):(l=r.y-n.y,s=r.x-n.x,a=Math.sqrt(s*s+l*l),n=o),c+=a):n=r;return c},toDegrees:function(t){return 180*t/Math.PI},toRadians:function(t){return t/180*Math.PI},getRadiansBetweenLines:function(t,e){return Math.atan2(e.y-t.y,e.x-t.x)},getAngle:function(t,e){return t.x===e.x?e.y===t.y?0:e.y>t.y?Math.PI/2:-Math.PI/2:Math.atan((e.y-t.y)/(e.x-t.x))}};Me.math=We;var Ge={getPoints:function(t){var e=new hn;return t.forEach(function(t){e.add({x:t.x,y:t.y}),e.add({x:t.x+t.width,y:t.y+t.height}),e.add({x:t.x+t.width,y:t.y}),e.add({x:t.x,y:t.y+t.height})}),e},rectangle:function(t){var e;return t.forEach(function(t){e=We.unionRect(e,t)}),e},oval:function(t){var e=Ge.rectangle(t),i=0,n=e.height/e.width,o=n*n,r=e.x+e.width/2,a=e.y+e.height/2;Ge.getPoints(t).forEach(function(t){var e=t.x-r,n=t.y-a,s=e*e+n*n/o;s>i&&(i=s)}),i=Math.sqrt(i);var s=n*i;return{x:r-i,y:a-s,width:2*i,height:2*s}},circle:function(t){var e=Ge.rectangle(t),i=0,n=e.x+e.width/2,o=e.y+e.height/2;return Ge.getPoints(t).forEach(function(t){var e=t.x-n,r=t.y-o,a=e*e+r*r;a>i&&(i=a)}),i=Math.sqrt(i),{x:n-i,y:o-i,width:2*i,height:2*i}},roundrect:function(t){var e=Ge.rectangle(t),i=Math.min(e.width,e.height)/16;return We.grow(e,i,i),e},star:function(t){var e=Ge.rectangle(t);return We.grow(e,e.width,e.height),e},triangle:function(t){var e=Ge.rectangle(t);return e.x-=e.width/2,e.width*=2,e.y-=e.height,e.height*=2,e},hexagon:function(t){var e=Ge.rectangle(t);return e.x-=e.width/2,e.width*=2,e},pentagon:function(t){var e=Ge.rectangle(t);return e.x-=e.width/6,e.width+=e.width/3,e.y-=e.height/4,e.height+=e.height/4,e},diamond:function(t){var e=Ge.rectangle(t);return e.x-=e.width/2,e.width+=e.width,e.y-=e.height/2,e.height+=e.height,e},trapezoidal:function(t){var e=Ge.rectangle(t);return e.x-=e.width/2,e.width+=e.width,e.y-=e.height/2,e.height+=e.height,e}};Me.group=Ge;var Ze={"topleft.topleft":function(t,e){return{x:t.x-e.width,y:t.y-e.height}},"topleft.topright":function(t,e){return{x:t.x,y:t.y-e.height}},"top.top":function(t,e){return{x:t.x+t.width/2-e.width/2,y:t.y-e.height}},"topright.topleft":function(t,e){return{x:t.x+t.width-e.width,y:t.y-e.height}},"topright.topright":function(t,e){return{x:t.x+t.width,y:t.y-e.height}},topleft:function(t,e){return{x:t.x-e.width/2,y:t.y-e.height/2}},top:function(t,e){return{x:t.x-e.width/2+t.width/2,y:t.y-e.height/2}},topright:function(t,e){return{x:t.x-e.width/2+t.width,y:t.y-e.height/2}},"topleft.bottomleft":function(t,e){return{x:t.x-e.width,y:t.y}},"topleft.bottomright":function(t,e){return{x:t.x,y:t.y}},"top.bottom":function(t,e){return{x:t.x+t.width/2-e.width/2,y:t.y}},"topright.bottomleft":function(t,e){return{x:t.x-e.width+t.width,y:t.y}},"topright.bottomright":function(t,e){return{x:t.x+t.width,y:t.y}},"left.left":function(t,e){return{x:t.x-e.width,y:t.y+t.height/2-e.height/2}},left:function(t,e){return{x:t.x-e.width/2,y:t.y+t.height/2-e.height/2}},"left.right":function(t,e){return{x:t.x,y:t.y+t.height/2-e.height/2}},center:function(t,e){return{x:t.x+t.width/2-e.width/2,y:t.y+t.height/2-e.height/2}},"right.left":function(t,e){return{x:t.x+t.width-e.width,y:t.y+t.height/2-e.height/2}},right:function(t,e){return{x:t.x+t.width-e.width/2,y:t.y+t.height/2-e.height/2}},"right.right":function(t,e){return{x:t.x+t.width,y:t.y+t.height/2-e.height/2}},"bottomleft.topleft":function(t,e){return{x:t.x-e.width,y:t.y+t.height-e.height}},"bottomleft.topright":function(t,e){return{x:t.x,y:t.y+t.height-e.height}},"bottom.top":function(t,e){return{x:t.x+t.width/2-e.width/2,y:t.y+t.height-e.height}},"bottomright.topleft":function(t,e){return{x:t.x+t.width-e.width,y:t.y+t.height-e.height}},"bottomright.topright":function(t,e){return{x:t.x+t.width,y:t.y+t.height-e.height}},bottomleft:function(t,e){return{x:t.x-e.width/2,y:t.y+t.height-e.height/2}},bottom:function(t,e){return{x:t.x+t.width/2-e.width/2,y:t.y+t.height-e.height/2}},bottomright:function(t,e){return{x:t.x+t.width-e.width/2,y:t.y+t.height-e.height/2}},"bottomleft.bottomleft":function(t,e){return{x:t.x-e.width,y:t.y+t.height}},"bottomleft.bottomright":function(t,e){return{x:t.x,y:t.y+t.height}},"bottom.bottom":function(t,e){return{x:t.x+t.width/2-e.width/2,y:t.y+t.height}},"bottomright.bottomleft":function(t,e){return{x:t.x+t.width-e.width,y:t.y+t.height}},"bottomright.bottomright":function(t,e){return{x:t.x+t.width,y:t.y+t.height}},get:function(t,e,i){if(!e)throw"refRect can not be null";i||(i={width:0,height:0});var n=Ze[t];if(n)return n(e,i);throw"Can not resolve '"+t+"' position"}};Me.position=Ze;var Xe={preventDefault:function(t){kn.KEEP_DEFAULT_FUNCTION(t)||(t.preventDefault?t.preventDefault():t.preventManipulation?t.preventManipulation():t.returnValue=!1)},insertAfter:function(t,e){return e?e.parentNode.insertBefore(t,e.nextSibling):t.parentNode.insertBefore(t,t.parentNode.firstChild),t},forEach:function(t,e,i){if(Xe.isVisible(t)){for(var n=t.childNodes.length,o=0;n>o;o++)Xe.forEach(t.childNodes[o],e,i);i?e.call(i,t):e(t)}},setVisible:function(t,e){t.style.display=e?"block":"none"},isVisible:function(t){return"style"in t&&"none"!==t.style.display},release:function(t){for(var e=t.childNodes.length,i=0;e>i;i++)Xe.release(t.childNodes[i]);e>0&&Xe.clear(t),t._pool&&t._pool.release(t)},clear:function(t){for(;t.firstChild;)t.removeChild(t.firstChild)},setZoom:function(t,e){var i=t.style;if(i.setProperty)if(Ue.isFirefox)i.setProperty("-moz-transform","scale("+e+")",null),i.setProperty("-moz-transform-origin","0 0",null);else if(Ue.isOpera)i.setProperty("-o-transform","scale("+e+")",null),i.setProperty("-o-transform-origin","0 0",null);else if(Ue.isChrome||Ue.isSafari){i.setProperty("-webkit-transform","scale("+e+")",null),i.setProperty("-webkit-transform-origin","0 0",null);var n=null;t._webkitInvaildateDiv?n=t._webkitInvaildateDiv:(n=ze.createElement("div"),t._webkitInvaildateDiv=n),n.parentNode&&n.parentNode==t?t.removeChild(n):t.appendChild(n)}else Ue.isIE?(i.setProperty("-ms-transform","scale("+e+")",null),i.setProperty("-ms-transform-origin","0 0",null)):(i.setProperty("transform","scale("+e+")",null),i.setProperty("transform-origin","0 0",null))},setRotate:function(t,e){var i=t.style;if(i.setProperty)if(Ue.isFirefox)i.setProperty("-moz-transform","scale("+e+")",null),i.setProperty("-moz-transform-origin","0 0",null);else if(Ue.isOpera)i.setProperty("-o-transform","scale("+e+")",null),i.setProperty("-o-transform-origin","0 0",null);else if(Ue.isChrome||Ue.isSafari){i.setProperty("-webkit-transform","scale("+e+")",null),i.setProperty("-webkit-transform-origin","0 0",null);var n=null;t._webkitInvaildateDiv?n=t._webkitInvaildateDiv:(n=ze.createElement("div"),t._webkitInvaildateDiv=n),n.parentNode&&n.parentNode==t?t.removeChild(n):t.appendChild(n)}else Ue.isIE?(i.setProperty("-ms-transform","scale("+e+")",null),i.setProperty("-ms-transform-origin","0 0",null)):(i.setProperty("transform","scale("+e+")",null),i.setProperty("transform-origin","0 0",null))},setCSSStyle:function(t,e,i){t.style.setProperty(e,i,null)},removeCSSStyle:function(t,e){t.style.removeProperty(e)},getCSSStyle:function(t,e){return t.style.getPropertyValue(e)},setBorderRaidus:function(t,e){Ue.isFirefox?t.style.MozBorderRadius=e:t.style.borderRadius=e},createSelect:function(t,e){var i,n,o,r=ze.createElement("select");if(Array.isArray(t))for(i=0;i<t.length;i++)n=t[i],o=ze.createElement("option"),o.innerHTML=n,o.setAttribute("value",n),n===e&&o.setAttribute("selected","true"),r.appendChild(o);else for(i=0;i<t.values.length;i++)n=t.values[i],o=ze.createElement("option"),o.innerHTML=t.map[n],o.setAttribute("value",n),n===e&&o.setAttribute("selected","true"),r.appendChild(o);return r},createImg:function(t){var e=ze.createElement("img");return e.style.position="absolute","string"==typeof t&&e.setAttribute("src",t),e},createView:function(t,e){var i=ze.createElement("div");return i.style.position=kn.VIEW_POSITION,i.style.fontSize=kn.VIEW_FONT_SIZE,i.style.fontFamily=kn.VIEW_FONT_FAMILY,i.style.cursor="default",i.style.outline="none",i.style.textAlign="left",i.style.msTouchAction="none",i.style.touchAction="none",i.tabIndex=0,e||(i.onmousedown=Xe.preventDefault),i.style.setProperty&&(i.style.setProperty("-khtml-user-select","none",null),i.style.setProperty("-webkit-user-select","none",null),i.style.setProperty("-moz-user-select","none",null),i.style.setProperty("-webkit-tap-highlight-color","rgba(0, 0, 0, 0)",null)),t&&(i.style.overflow=t),i},createDiv:function(){var t=ze.createElement("div");return t.style.position="absolute",t.style.msTouchAction="none",t.style.touchAction="none",t},createCanvas:function(t,e){var i=ze.createElement("canvas");return i.style.position="absolute",i.style.msTouchAction="none",i.style.touchAction="none",i.width=t,i.height=e,i},setCanvas:function(t,e,i,n,o){2===arguments.length&&(i=e.y,n=e.width,o=e.height,e=e.x),t.style.left=e+"px",t.style.top=i+"px",t.setAttribute("width",n),t.setAttribute("height",o),t._viewRect={x:e,y:i,width:n,height:o};var r=t.getContext("2d");return 0!==r.shadowBlur&&(r.shadowOffsetX=0,r.shadowOffsetY=0,r.shadowBlur=0,r.shadowColor="rgba(0,0,0,0.0)"),r.clearRect(0,0,n,o),r.translate(-e,-i),r},setImg:function(t,e,i){t.setAttribute("src",e),t.style.left=i.x+"px",t.style.top=i.y+"px",t.style.width=i.width+"px",t.style.height=i.height+"px",t._viewRect=Me.clone(i)},setDiv:function(t,e,i,n,o){n=Me.num(n)?n:0,t.style.left=e.x-n+"px",t.style.top=e.y-n+"px",t.style.width=e.width+"px",t.style.height=e.height+"px",t._viewRect=Me.clone(e),t.style.backgroundColor=i||"",t.style.border=n>0?n+"px "+o+" solid":""},changeTypeForMS:function(e){var i=e;if(0===e.indexOf("MSPointer")||0===e.indexOf("pointer")){var n;0===e.indexOf("MSPointer")?(n=e.substring(9,10).toLowerCase(),n+=e.substring(10)):n=e.substring(7,8),t.MSPointerEvent?i="MSPointer"+n.substring(0,1).toUpperCase()+n.substring(1):t.PointerEvent&&(i="pointer"+n)}return i},addEventListener:function(t,e,i,n){t=this.changeTypeForMS(t);var o="_"+t+"_";if(!n[o]){var r=function(t){r.instance[r.method](t)};r.method=e,r.instance=n,n[o]=r,i.addEventListener(t,r,!1)}},removeEventListener:function(t,e,i){t=this.changeTypeForMS(t);var n="_"+t+"_",o=i[n];o&&(e.removeEventListener(t,o,!1),delete i[n])},isValidEvent:function(t,e){if(!e)return!1;if(e.target===t)if(Ue.isFirefox){if(t.clientHeight<t.scrollHeight&&e.layerX<25)return!1;if(t.clientWidth<t.scrollWidth&&e.layerY<25)return!1}else if(e.offsetX>t.clientWidth||e.offsetY>t.clientHeight)return!1;return!0},getLogicalPoint:function(t,e,i,n){i=i||1;var o,r=t.getBoundingClientRect();if(Ue.isTouchable&&e.changedTouches&&e.changedTouches.length>0){var a=e.changedTouches[0],s=Ue.isAndroid?0:wi.scrollLeft(),l=Ue.isAndroid?0:wi.scrollTop();o={x:(a.clientX+t.scrollLeft-r.left-s)/i,y:(a.clientY+t.scrollTop-r.top-l)/i}}else{if(!Xe.isValidEvent(t,e))return null;o={x:(e.clientX-r.left+t.scrollLeft)/i,y:(e.clientY-r.top+t.scrollTop)/i}}return o},handle_mousedown:function(e,i){Xe.target&&Xe.handle_mouseup(i),t.addEventListener("mousemove",Xe.handle_mousemove,!1),t.addEventListener("mouseup",Xe.handle_mouseup,!1),Xe.target=e},handle_mousemove:function(t){Xe.target.handle_mousemove&&Xe.target.handle_mousemove(t),Xe.target.handleMouseMove&&Xe.target.handleMouseMove(t)},handle_mouseup:function(e){Xe.target.handle_mouseup&&Xe.target.handle_mouseup(e),Xe.target.handleMouseUp&&Xe.target.handleMouseUp(e),t.removeEventListener("mousemove",Xe.handle_mousemove,!1),t.removeEventListener("mouseup",Xe.handle_mouseup,!1),delete Xe.target},getClientPoint:function(t){return{x:t.clientX,y:t.clientY}},windowWidth:function(){return"number"==typeof t.innerWidth?t.innerWidth:ze.documentElement&&ze.documentElement.clientWidth?ze.documentElement.clientWidth:ze.body&&ze.body.clientWidth?ze.body.clientWidth:0},windowHeight:function(){return"number"==typeof t.innerHeight?t.innerHeight:ze.documentElement&&ze.documentElement.clientHeight?ze.documentElement.clientHeight:ze.body&&ze.body.clientHeight?ze.body.clientHeight:0}};Me.html=Xe;var Ye={cache:{},g:Xe.createCanvas().getContext("2d"),getTextSize:function(t,e){Ye.g.font=t||kn.FONT;var i=Ye.cache[Ye.g.font];i||(i=2*Ye.g.measureText("e").width+4,Ye.cache[Ye.g.font]=i),e=e||"",e=String(e);for(var n,o=e.split("\n"),r=o.length,a=0,s=r-1;s>=0;s--)(n=Ye.g.measureText(o[s]).width)>a&&(a=n);return{width:a+4,height:i*r}},getSubStringInLength:function(t,e,i){var n=this,o=function(t,e,i,r,a){if(t>=e)return r.substring(0,t+1);var s=Math.floor((t+e)/2),l=r.substring(0,s+1);if(n.getTextSize(i,l).width>a)return o(t,s-1,i,r,a);var h=s+1,c=r.substring(0,h+1);return n.getTextSize(i,c).width>a?l:o(h,e,i,r,a)};return this.getTextSize(t,e).width>i?o(0,e.length-1,t,e,i):e},getCollapseTextInLength:function(t,e,i){var n=this.getTextSize(t,e).width;if(n>i){for(var o=0,r="",a=e,s=n;s>i;){var l=this.getSubStringInLength(t,a,i);r=r+l+"\n",o+=l.length,a=e.substring(o),s=this.getTextSize(t,a).width}return r+a}return e},drawText:function(t,i,n,o,r,a){i=i||"",i=String(i),o||(o=kn.FONT);var s="center";a&&(s=a),t.font=o,t.fillStyle=r,t.textAlign=s,t.textBaseline="middle";var l,h,c=i.split("\n"),u=c.length,d=0;n?n.width===e?(l=n.x,h=n.y):(d=n.height/u,"left"==s?l=n.x:"center"==s&&(l=n.x+n.width/2),h=n.y+d/2):(l=0,h=0),Ue.isOpera&&(h-=2);for(var f=0;u>f;f++)"right"==s&&(t.textAlign="left",l=n.x+n.width-Ye.getTextSize(o,c[f]).width),t.fillText(c[f],l,h),h+=d},drawArc:function(t,e,i,n,o,r,a,s){var l,h,c,u,d,f,p,g,_,m,v;if(Math.abs(o)>2*Math.PI&&(o=2*Math.PI),d=Math.ceil(Math.abs(o)/(Math.PI/4)),l=o/d,h=-l,c=-n,d>0){f=e+Math.cos(n)*r,p=i+Math.sin(-n)*a,s?t.lineTo(f,p):t.moveTo(f,p);for(var y=0;d>y;y++)c+=h,u=c-h/2,g=e+Math.cos(c)*r,_=i+Math.sin(c)*a,m=e+Math.cos(u)*(r/Math.cos(h/2)),v=i+Math.sin(u)*(a/Math.cos(h/2)),t.quadraticCurveTo(m,v,g,_)}},dashedLine:function(t,e,i,n,o,r,a){var s=r-n,l=a-o,h=Math.sqrt(s*s+l*l);if(0!=h){s/=h,l/=h;for(var c=h,u=-i.offset,d=i.drawing,f=i.patternIndex;c>u;)u+=e[f],u>=c&&(i.offset=e[f]-(u-c),i.patternIndex=f,i.drawing=d,u=c),d?t.lineTo(n+u*s,o+u*l):t.moveTo(n+u*s,o+u*l),d=!d,f=(f+1)%e.length}},drawLinePoints:function(t,e,i,n,o){var r,a,s,l,h,c,u=0,d=0,f=e.size();if(c=i&&i.length>0?new gi(t,i[0],i.length>1?i[1]:i[0]):t,n)for(d=0,h=n.size();h>d;d++)if("moveto"===(r=n.get(d))&&f>u)a=e.get(u++),c.moveTo(a.x,a.y);else if("lineto"===r&&f>u)a=e.get(u++),c.lineTo(a.x,a.y);else if("cubicto"===r&&f-2>u)a=e.get(u++),s=e.get(u++),l=e.get(u++),c.bezierCurveTo(a.x,a.y,s.x,s.y,l.x,l.y);else{if(!("quadto"===r&&f-1>u))throw"Can not resolve segment '"+r+"'";a=e.get(u++),s=e.get(u++),c.quadraticCurveTo(a.x,a.y,s.x,s.y)}else this._drawLine(e,c);o&&c.closePath()},_drawLine:function(t,e){var i,n,o,r,a,s=0,l=t.size();for(i=t.get(0),e.moveTo(i.x,i.y),s=1;l>s;s++)a=t.get(s),a.size?(r=a.size(),2===r?(i=a.get(0),n=a.get(1),e.quadraticCurveTo(i.x,i.y,n.x,n.y)):3===r&&(i=a.get(0),n=a.get(1),o=a.get(2),e.bezierCurveTo(i.x,i.y,n.x,n.y,o.x,o.y))):e.lineTo(a.x,a.y)},drawRoundRect:function(t,e,i,n,o,r,a,s,l){6===arguments.length&&(a=r,s=r,l=r);var h=e+n,c=i+o,u=o>n?2*n:2*o;r=u>r?r:u,a=u>a?a:u,s=u>s?s:u,l=u>l?l:u;var d=.292893218813453*l,f=.585786437626905*l;t.moveTo(h,c-l),t.quadraticCurveTo(h,c-f,h-d,c-d),t.quadraticCurveTo(h-f,c,h-l,c),d=.292893218813453*s,f=.585786437626905*s,t.lineTo(e+s,c),t.quadraticCurveTo(e+f,c,e+d,c-d),t.quadraticCurveTo(e,c-f,e,c-s),d=.292893218813453*r,f=.585786437626905*r,t.lineTo(e,i+r),t.quadraticCurveTo(e,i+f,e+d,i+d),t.quadraticCurveTo(e+f,i,e+r,i),d=.292893218813453*a,f=.585786437626905*a,t.lineTo(h-a,i),t.quadraticCurveTo(h-f,i,h-d,i+d),t.quadraticCurveTo(h,i+f,h,i+a),t.lineTo(h,c-l)},drawVector:function(t,e,i,n,o,r,a){var s;4===arguments.length?(o=n.y,r=n.width,a=n.height,n=n.x):5===arguments.length&&"roundrect"===e&&(s={},s.topLeft=o,s.topRight=o,s.bottomLeft=o,s.bottomRight=o,o=n.y,r=n.width,a=n.height,n=n.x);var l=Ye["_"+e];l&&(t.beginPath(),i&&i.length>0&&(t=new gi(t,i[0],i.length>1?i[1]:i[0])),5===arguments.length&&"roundrect"===e?l(t,{x:n,y:o,width:r,height:a},s):l(t,n,o,r,a))},_rectangle:function(t,e,i,n,o){t.rect(e,i,n,o)},_circle:function(t,e,i,n,o){var r=e+n/2,a=i+o/2,s=Math.min(n,o)/2;t instanceof gi?Ye.drawArc(t,r,a,0,2*Math.PI,s,s,!1):t.arc(r,a,s,0,2*Math.PI,!0)},_oval:function(t,e,i,n,o){if(t instanceof gi)Ye.drawArc(t,e+n/2,i+o/2,0,2*Math.PI,n/2,o/2,!1);else{var r=.5522848,a=n/2*r,s=o/2*r,l=e+n,h=i+o,c=e+n/2,u=i+o/2;t.moveTo(e,u),t.bezierCurveTo(e,u-s,c-a,i,c,i),t.bezierCurveTo(c+a,i,l,u-s,l,u),t.bezierCurveTo(l,u+s,c+a,h,c,h),t.bezierCurveTo(c-a,h,e,u+s,e,u)}},_roundrect:function(t,e,i,n,o){if(3===arguments.length){var r=i;i=e.y,n=e.width,o=e.height,e=e.x,r.topLeft?Ye.drawRoundRect(t,e,i,n,o,r.topLeft):Ye.drawRoundRect(t,e,i,n,o,Math.min(Math.min(n,o)/4,10))}else Ye.drawRoundRect(t,e,i,n,o,Math.min(Math.min(n,o)/4,10))},_star:function(t,e,i,n,o){var r=2*n,a=2*o,s=e+n/2,l=i+o/2;t.moveTo(s-r/4,l-a/12),t.lineTo(e+.306*n,i+.579*o),t.lineTo(s-r/6,l+a/4),t.lineTo(e+n/2,i+.733*o),t.lineTo(s+r/6,l+a/4),t.lineTo(e+.693*n,i+.579*o),t.lineTo(s+r/4,l-a/12),t.lineTo(e+.611*n,i+.332*o),t.lineTo(s+0,l-a/4),t.lineTo(e+.388*n,i+.332*o),t.closePath()},_triangle:function(t,e,i,n,o){t.moveTo(e+n/2,i),t.lineTo(e+n,i+o),t.lineTo(e,i+o),t.closePath()},_hexagon:function(t,e,i,n,o){t.moveTo(e,i+o/2),t.lineTo(e+n/4,i+o),t.lineTo(e+3*n/4,+i+o),t.lineTo(e+n,i+o/2),t.lineTo(e+3*n/4,i),t.lineTo(e+n/4,i),t.closePath()},_pentagon:function(t,e,i,n,o){var r=2*n,a=2*o,s=e+n/2,l=i+o/2;t.moveTo(s-r/4,l-a/12),t.lineTo(s-r/6,l+a/4),t.lineTo(s+r/6,l+a/4),t.lineTo(s+r/4,l-a/12),t.lineTo(s+0,l-a/4),t.closePath()},_trapezoidal:function(t,e,i,n,o){t.moveTo(e+n/4,i),t.lineTo(e,i+o),t.lineTo(e+n,i+o),t.lineTo(e+3*n/4,i),t.closePath()},_diamond:function(t,e,i,n,o){t.moveTo(e+n/2,i),t.lineTo(e,i+o/2),t.lineTo(e+n/2,i+o),t.lineTo(e+n,i+o/2),t.closePath()},fill:function(t,e,i,n,o,r,a,s){var l=$e[i];t.fillStyle=l?5===arguments.length?l(t,e,n,o.x,o.y,o.width,o.height):l(t,e,n,o,r,a,s):e},createRadialGradient:function(t,e,i,n,o,r,a,s,l){var h=t.createRadialGradient(n+r*s,o+a*l,Math.min(r,a)/24,n+r/2,o+a/2,Math.max(r,a)/2);return h.addColorStop(0,i),h.addColorStop(1,e),h},drawPath:function(t,e,i,n,o,r,a,s){var l=t._element,h=t.getBodyRect();n&&We.addPadding(h,l,i+".padding",1);var c=Me.clone(h),u=l.getStyle(i+".outline.width");u>0&&We.grow(c,u/2,u/2);var d=t.setShadow(t,e,c);0!=l.getAngle()&&(l instanceof Mn||(h=l.getOriginalRect()),De.Util.rotateCanvas(d,h,l.getAngle()));var f,p=l.getStyle(i+".fill");if(p){f=t._innerColor&&!_i.hasDefault(t._element)?t._innerColor:l.getStyle(i+".fill.color");var g=l.getStyle(i+".gradient");g?Ye.fill(d,f,g,l.getStyle(i+".gradient.color"),h):d.fillStyle=f}var _=l.getStyle(i+".shape"),m=l.getStyle("group.shape.roundrect.radius");return p&&(d.beginPath(),r?Ye.drawLinePoints(d,r,null,a,s):"roundrect"===_&&"group"===i?Ye.drawVector(d,_,null,h,m):Ye.drawVector(d,_,null,h),d.fill()),u>0&&(d.lineWidth=u,d.lineCap=l.getStyle(i+".cap"),d.lineJoin=l.getStyle(i+".join"),d.strokeStyle=l.getStyle(i+".outline.color"),d.beginPath(),r?Ye.drawLinePoints(d,r,o,a,s):"roundrect"===_&&"group"===i?Ye.drawVector(d,_,o,h,m):Ye.drawVector(d,_,o,h),d.stroke()),c},draw3DRect:function(t,e,i,n,o,r,a){if(0!==i){arguments.length<=4&&(a=n.height,r=n.width,o=n.y,n=n.x);var s=i>0;i=Math.abs(i);var l,h;if(t.lineWidth=1,t.lineCap="square",1===i)l=Ye.brighter(e),h=Ye.darker(e),t.strokeStyle=s?l:h,t.beginPath(),t.moveTo(n,o),t.lineTo(n,o+a),t.moveTo(n,o),t.lineTo(n+r,o),t.closePath(),t.stroke(),t.strokeStyle=s?h:l,t.beginPath(),t.moveTo(n,o+a),t.lineTo(n+r,o+a),t.moveTo(n+r,o),t.lineTo(n+r,o+a),t.closePath(),t.stroke();else for(var c=2*i,u=50/c,d=0;c>d;d++)l=Ye.brighter(e,50-d*u),h=Ye.darker(e,50-d*u),n+=.5,o+=.5,r-=1,a-=1,t.strokeStyle=s?l:h,t.beginPath(),t.moveTo(n,o),t.lineTo(n,o+a),t.moveTo(n,o),t.lineTo(n+r,o),t.closePath(),t.stroke(),t.strokeStyle=s?h:l,t.beginPath(),t.moveTo(n,o+a),t.lineTo(n+r,o+a),t.moveTo(n+r,o),t.lineTo(n+r,o+a),t.closePath(),t.stroke()}},brighter:function(t,e){return e||(e=50),Ye.adjustBrightness2(t,e)},darker:function(t,e){return e||(e=50),Ye.adjustBrightness2(t,-e)},adjustBrightness2:function(t,e){var i,n,o;if(0===e)return t;var r=pn(t);return 0>e?(e=(100+e)/100,i=Math.ceil(r.r*e),n=Math.ceil(r.g*e),o=Math.ceil(r.b*e)):(e/=100,i=r.r,n=r.g,o=r.b,i+=(255-i)*e,n+=(255-n)*e,o+=(255-o)*e,i=Math.min(Math.ceil(i),255),n=Math.min(Math.ceil(n),255),o=Math.min(Math.ceil(o),255)),"rgba("+i+","+n+","+o+",1)"},getColorArray:function(t){return fn.clearRect(0,0,1,1),fn.fillStyle=t,fn.fillRect(0,0,1,1),fn.getImageData(0,0,1,1).data},hit:function(t,e,i,n){if(!t)return!1;var o=t._viewRect;if(!o)return!1;if(e-=o.x,i-=o.y,0>e||0>i||e>=o.width||i>=o.height)return!1;try{for(var r=t.getContext("2d").getImageData(e,i,1,1),a=r.data,s=0,l=a.length;l>s;s+=4)if(0!==a[s+3])return!0}catch(t){return!0}return!1},intersects:function(t,e){if(!t)return!1;if(!(e=We.intersection(e,t._viewRect)))return!1;e.x-=t._viewRect.x,e.y-=t._viewRect.y;try{for(var i=t.getContext("2d").getImageData(e.x,e.y,e.width,e.height),n=i.data,o=0,r=n.length;r>o;o+=4)if(0!==n[o+3])return!0}catch(t){}return!1},strokeRect:function(t,e,i,n){e&&(t.beginPath(),t.strokeStyle=i||De.Util.randomColor(),t.lineWidth=n||2,t.strokeRect(e.x,e.y,e.width,e.height),t.stroke())}};Me.g=Ye;var $e={"linear.southwest":function(t,e,i,n,o,r,a){var s=t.createLinearGradient(n,o+a,n+r,o);return s.addColorStop(0,i),s.addColorStop(1,e),s},"linear.southeast":function(t,e,i,n,o,r,a){var s=t.createLinearGradient(n+r,o+a,n,o);return s.addColorStop(0,i),s.addColorStop(1,e),s},"linear.northwest":function(t,e,i,n,o,r,a){var s=t.createLinearGradient(n+r,o+a,n,o);return s.addColorStop(0,e),s.addColorStop(1,i),s},"linear.northeast":function(t,e,i,n,o,r,a){var s=t.createLinearGradient(n+r,o,n,o+a);return s.addColorStop(0,i),s.addColorStop(1,e),s},"linear.north":function(t,e,i,n,o,r,a){var s=t.createLinearGradient(n,o,n,o+a);return s.addColorStop(0,i),s.addColorStop(1,e),s},"linear.south":function(t,e,i,n,o,r,a){var s=t.createLinearGradient(n,o,n,o+a);return s.addColorStop(0,e),s.addColorStop(1,i),s},"linear.west":function(t,e,i,n,o,r,a){var s=t.createLinearGradient(n,o,n+r,o);return s.addColorStop(0,i),s.addColorStop(1,e),s},"linear.east":function(t,e,i,n,o,r,a){var s=t.createLinearGradient(n,o,n+r,o);return s.addColorStop(0,e),s.addColorStop(1,i),s},"radial.center":function(t,e,i,n,o,r,a){return Ye.createRadialGradient(t,e,i,n,o,r,a,.5,.5)},"radial.southwest":function(t,e,i,n,o,r,a){return Ye.createRadialGradient(t,e,i,n,o,r,a,.25,.75)},"radial.southeast":function(t,e,i,n,o,r,a){return Ye.createRadialGradient(t,e,i,n,o,r,a,.75,.75)},"radial.northwest":function(t,e,i,n,o,r,a){return Ye.createRadialGradient(t,e,i,n,o,r,a,.25,.25)},"radial.northeast":function(t,e,i,n,o,r,a){return Ye.createRadialGradient(t,e,i,n,o,r,a,.75,.25)},"radial.north":function(t,e,i,n,o,r,a){return Ye.createRadialGradient(t,e,i,n,o,r,a,.5,.25)},"radial.south":function(t,e,i,n,o,r,a){return Ye.createRadialGradient(t,e,i,n,o,r,a,.5,.75)},"radial.west":function(t,e,i,n,o,r,a){return Ye.createRadialGradient(t,e,i,n,o,r,a,.25,.5)},"radial.east":function(t,e,i,n,o,r,a){return Ye.createRadialGradient(t,e,i,n,o,r,a,.75,.5)},"spread.horizontal":function(t,e,i,n,o,r,a){var s=t.createLinearGradient(n,o,n+r,o);return s.addColorStop(0,e),s.addColorStop(.5,i),s.addColorStop(1,e),s},"spread.vertical":function(t,e,i,n,o,r,a){var s=t.createLinearGradient(n,o,n,o+a);return s.addColorStop(0,e),s.addColorStop(.5,i),s.addColorStop(1,e),s},"spread.diagonal":function(t,e,i,n,o,r,a){var s=t.createLinearGradient(n+r,o,n,o+a);return s.addColorStop(0,e),s.addColorStop(.5,i),s.addColorStop(1,e),s},"spread.antidiagonal":function(t,e,i,n,o,r,a){var s=t.createLinearGradient(n,o,n+r,o+a);return s.addColorStop(0,e),s.addColorStop(.5,i),s.addColorStop(1,e),s},"spread.north":function(t,e,i,n,o,r,a){var s=t.createLinearGradient(n,o-a/4,n,o+a+a/4);return s.addColorStop(0,e),s.addColorStop(1/3,i),s.addColorStop(2/3,e),s.addColorStop(1,i),s},"spread.south":function(t,e,i,n,o,r,a){var s=t.createLinearGradient(n,o-a/4,n,o+a+a/4);return s.addColorStop(0,i),s.addColorStop(1/3,e),s.addColorStop(2/3,i),s.addColorStop(1,e),s},"spread.west":function(t,e,i,n,o,r,a){var s=t.createLinearGradient(n-r/4,o,n+r+r/4,o);return s.addColorStop(0,e),s.addColorStop(1/3,i),s.addColorStop(2/3,e),s.addColorStop(1,i),s},"spread.east":function(t,e,i,n,o,r,a){var s=t.createLinearGradient(n-r/4,o,n+r+r/4,o);return s.addColorStop(0,i),s.addColorStop(1/3,e),s.addColorStop(2/3,i),s.addColorStop(1,e),s}};De.Util={getVersion:function(){return"5.5.4"},registerImage:function(t,e,i,n,o){Me.registerImage(t,e,i,n,o)},registerImageByUrl:function(t,e,i,n){if(e&&t&&t.indexOf(".json")>0){var o=new XMLHttpRequest;o.onreadystatechange=function(){if(4===o.readyState&&200===o.status){var t=JSON.parse(o.responseText);De.Util.registerImage(e,t),i&&i.invalidateElementUIs(),n&&n()}},o.open("GET",t,!0),o.send()}else{var r=new Ve;r.src=t,r.onload=function(){De.Util.registerImage(e,r,r.width,r.height),r.onload=null,i&&i.invalidateElementUIs(),n&&n()}}},getRegisteredImageNames:function(){return Me.getRegisteredImageNames()},unregisterImage:function(t){Me.unregisterImage(t)},getImageAsset:function(t){return Me.getImageAsset(t)},validateLicense:function(t){Me.validateLicense(t)},getLicense:function(){return Ne},isPermissionGIS:function(){return pi()},moveElements:function(t,e,i,n,o){if((0!==e||0!==i)&&t&&!t.isEmpty()){var r,a,s=De.animate.AnimateManager;s.endAnimate(),t=_i.filterMovingElements(t),n&&(r=new hn,a=new hn),t.forEach(function(t){t instanceof On&&(n?(r.add(t),a.add({x:t.getX()+e,y:t.getY()+i})):t.translate(e,i))}),n?s.start(new De.animate.AnimateLocation(r,a,o)):o&&o()}},isTypeOf:function(t,e){if(t===e)return!0;for(var i=t.superClass;i;){if(i===e.prototype)return!0;i=i.constructor.superClass}return!1},setFocus:function(t){if(ze.activeElement!==t){var e,i,n,o=ze.documentElement,r=ze.body;o&&(Ue.isIE||Ue.isOpera||o.scrollLeft||o.scrollTop)?(e=o.scrollLeft,i=o.scrollTop,n=o):r&&(e=r.scrollLeft,i=r.scrollTop,n=r),t.focus(),n&&(n.scrollLeft=e,n.scrollTop=i)}},isOpera:Ue.isOpera,isIE:Ue.isIE,isFirefox:Ue.isFirefox,isChrome:Ue.isChrome,isSafari:Ue.isSafari,isIPhone:Ue.isIPhone,isIPod:Ue.isIPod,isIPad:Ue.isIPad,isAndroid:Ue.isAndroid,isWebOS:Ue.isWebOS,isTouchable:Ue.isTouchable,ext:function(t,e,i){Me.ext(t,e,i)},getValue:function(t,e,i){return Me.getValue(t,e,i)},setValue:function(t,e,i){Me.setValue(t,e,i)},grow:function(t,e,i){We.grow(t,e,i)},containsPoint:function(t,e,i){return We.containsPoint.apply(null,arguments)},intersects:function(t,e){return We.intersects(t,e)},getRect:function(t){return We.getRect(t)},unionRect:function(t,e){return We.unionRect(t,e)},createDiv:function(){return Xe.createDiv()},createCanvas:function(){return Xe.createCanvas()},setCanvas:function(t,e,i,n,o){return Xe.setCanvas.apply(null,arguments)},drawVector:function(t,e,i,n,o,r,a){Ye.drawVector.apply(null,arguments)},fill:function(t,e,i,n,o,r,a,s){Ye.fill.apply(null,arguments)},getClass:function(t){return Me.getClass(t)},getAllClassNames:function(){var t,e=[];for(t in Me.classCache)e.push(t);return e},newInstance:function(t){return Me.newInstance.apply(null,arguments)},isDeserializing:function(){return Me.isDeserializing},addEventListener:function(t,e,i,n){Xe.addEventListener(t,e,i,n)},removeEventListener:function(t,e,i){Xe.removeEventListener(t,e,i)},drawArrow:function(t,e,i,n,o,r,a,s,l,h,c,u,d){cn.drawArrow.apply(null,arguments)},calculatePointAngleAlongLine:function(t,e,i,n,o){return We.calculatePointInfoAlongLineBySegments(t,e,i,n,o)},getSubNetwork:function(t){return _i.getSubNetwork(t)},transformPoint:function(t,e,i,n){return We.transformPoint(t,e,i,n)},getToolTipDiv:function(){return xi.getToolTipDiv()},showToolTip:function(t,e){xi.showToolTip(t,e)},hideToolTip:function(){xi.hideToolTip()},resetToolTip:function(){xi.resetToolTip()},setCSSStyle:function(t,e,i){Xe.setCSSStyle(t,e,i)},removeCSSStyle:function(t,e){Xe.removeCSSStyle(t,e)},getCSSStyle:function(t,e){return Xe.getCSSStyle(t,e)},toDegrees:function(t){return We.toDegrees(t)},toRadians:function(t){return We.toDegrees(t)},getRadiansBetweenLines:function(t,e){return We.getRadiansBetweenLines(t,e)},getElementsBounds:function(t,e){var i=null;return t.forEach(function(t){if(t.getRect){var n,o;e&&(o=e.getElementUI(t))&&(n=o.getViewRect()),n||(n=t.getRect()),i=i?De.Util.unionRect(i,n):n}}),i},getPointIndex:function(t,e,i){if(i||(i=10),t)for(var n=t.size();n--;n>=0)if(We.getDistance(t.get(n),e)<=i)return n;return-1},registerVectorShape:function(t,e){Me.g["_"+t]=e},rotateCanvas:function(t,e,i){t.translate(e.x+e.width/2,e.y+e.height/2),t.rotate(i*Math.PI/180),t.translate(-(e.x+e.width/2),-(e.y+e.height/2))},registerShape:function(t,e){tn(t,e)},registerDraw:function(t,e){Qi(t,e)},getFilterColor:function(t,e){return gn(t,e)},registerGifImage:function(t,e){},parseVectorData:function(t){return Ti(t)},getSharedLinks:function(t,e){var i=t.getLinks(),n=e.getLinks();if(i&&0!=i.size()&&n&&0!=n.size()){return(i.size()>n.size()?i:n).toList(function(i){return i.getFromNode()==t&&i.getToNode()==e||i.getFromNode()==e&&i.getToNode()==t})}return null},isSharedLinks:function(t,e){var i=!1,n=t.getLinks(),o=e.getLinks();if(n&&0!=n.size()&&o&&0!=o.size()){(n.size()>o.size()?n:o).forEach(function(n){return!(n.getFromNode()==t&&n.getToNode()==e||n.getFromNode()==e&&n.getToNode()==t)||(i=!0,!1)})}return i},playAnimate:function(t){return Ce(t)},pauseAnimate:function(t){t.pause()},resumeAnimate:function(t){t.resume()},stopAnimate:function(t,e){Te(t,e)},pauseAllAnimates:function(){Se()},resumeAllAnimates:function(){Ee()},stopAllAnimates:function(t){ke(t)},randomColor:function(){return"#"+("00000"+(16777216*this.random()<<0).toString(16)).substr(-6)},random:function(){return Math.random()},getHSVColor:function(t,i,n){var o,r,a,s,l,h,c,u;switch(t&&i===e&&n===e&&(i=t.s,n=t.v,t=t.h),s=Math.floor(6*t),l=6*t-s,h=n*(1-i),c=n*(1-l*i),u=n*(1-(1-l)*i),s%6){case 0:o=n,r=u,a=h;break;case 1:o=c,r=n,a=h;break;case 2:o=h,r=n,a=u;break;case 3:o=h,r=c,a=n;break;case 4:o=u,r=h,a=n;break;case 5:o=n,r=h,a=c}return"#"+toHex(255*o)+toHex(255*r)+toHex(255*a)},toHex:function(t){var e=parseInt(t).toString(16);return 1==e.length&&(e="0"+e),e},makeHighRes:function(e){var i=e.getContext("2d"),n=t.devicePixelRatio||1,o=i.webkitBackingStorePixelRatio||i.mozBackingStorePixelRatio||i.msBackingStorePixelRatio||i.oBackingStorePixelRatio||i.backingStorePixelRatio||1,r=n/o;if(n!==o){var a=e.width,s=e.height;e.width=Math.round(a*r),e.height=Math.round(s*r),e.style.width=a+"px",e.style.height=s+"px",i.scale(r,r)}},newFunction:function(){var t=arguments,e=t.length;return 1===e?Me.newInstance("Function",t[0]):2===e?Me.newInstance("Function",t[0],t[1]):3===e?Me.newInstance("Function",t[0],t[1],t[2]):4===e?Me.newInstance("Function",t[0],t[1],t[2],t[3]):5===e?Me.newInstance("Function",t[0],t[1],t[2],t[3],t[4]):6===e?Me.newInstance("Function",t[0],t[1],t[2],t[3],t[4],t[5]):7===e?Me.newInstance("Function",t[0],t[1],t[2],t[3],t[4],t[5],t[6]):8===e?Me.newInstance("Function",t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]):null}},Me.ext("twaver.Util",Object,{});var qe;"Microsoft Internet Explorer"==Fe.appName?(n.prototype.am=a,qe=30):"Netscape"!=Fe.appName?(n.prototype.am=r,qe=26):(n.prototype.am=s,qe=28),n.prototype.DB=qe,n.prototype.DM=(1<<qe)-1,n.prototype.DV=1<<qe;n.prototype.FV=Math.pow(2,52),n.prototype.F1=52-qe,n.prototype.F2=2*qe-52;var Ke,Je,Qe="0123456789abcdefghijklmnopqrstuvwxyz",ti=new Array;for(Ke="0".charCodeAt(0),Je=0;9>=Je;++Je)ti[Ke++]=Je;for(Ke="a".charCodeAt(0),Je=10;36>Je;++Je)ti[Ke++]=Je;for(Ke="A".charCodeAt(0),Je=10;36>Je;++Je)ti[Ke++]=Je;L.prototype.convert=R,L.prototype.revert=P,L.prototype.reduce=O,L.prototype.mulTo=D,L.prototype.sqrTo=M,B.prototype.convert=F,B.prototype.revert=z,B.prototype.reduce=V,B.prototype.mulTo=j,B.prototype.sqrTo=U,n.prototype.copyTo=c,n.prototype.fromInt=u,n.prototype.fromString=f,n.prototype.clamp=p,n.prototype.dlShiftTo=b,n.prototype.drShiftTo=x,n.prototype.lShiftTo=A,n.prototype.rShiftTo=C,n.prototype.subTo=T,n.prototype.multiplyTo=k,n.prototype.squareTo=S,n.prototype.divRemTo=E,n.prototype.invDigit=N,n.prototype.isEven=H,n.prototype.exp=W,n.prototype.toString=g,n.prototype.negate=_,n.prototype.abs=m,n.prototype.compareTo=v,n.prototype.bitLength=w,n.prototype.mod=I,n.prototype.modPowInt=G,n.ZERO=d(0),n.ONE=d(1),Nt.prototype.convert=Bt,Nt.prototype.revert=Bt,Nt.prototype.mulTo=Ft,Nt.prototype.sqrTo=zt,Ht.prototype.convert=Wt,Ht.prototype.revert=Gt,Ht.prototype.reduce=Zt,Ht.prototype.mulTo=Yt,Ht.prototype.sqrTo=Xt;var ei=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],ii=(1<<26)/ei[ei.length-1];n.prototype.chunkSize=q,n.prototype.toRadix=J,n.prototype.fromRadix=Q,n.prototype.fromNumber=tt,n.prototype.bitwiseTo=rt,n.prototype.changeBit=xt,n.prototype.addTo=kt,n.prototype.dMultiply=Dt,n.prototype.dAddOffset=Mt,n.prototype.multiplyLowerTo=Ut,n.prototype.multiplyUpperTo=jt,n.prototype.modInt=Kt,n.prototype.millerRabin=te,n.prototype.clone=Z,n.prototype.intValue=X,n.prototype.byteValue=Y,n.prototype.shortValue=$,n.prototype.signum=K,n.prototype.toByteArray=et,n.prototype.equals=it,n.prototype.min=nt,n.prototype.max=ot,n.prototype.and=st,n.prototype.or=ht,n.prototype.xor=ut,n.prototype.andNot=ft,n.prototype.not=pt,n.prototype.shiftLeft=gt,n.prototype.shiftRight=_t,n.prototype.getLowestSetBit=vt,n.prototype.bitCount=wt,n.prototype.testBit=bt,n.prototype.setBit=At,n.prototype.clearBit=Ct,n.prototype.flipBit=Tt,n.prototype.add=St,n.prototype.subtract=Et,n.prototype.multiply=It,n.prototype.divide=Rt,n.prototype.remainder=Pt,n.prototype.divideAndRemainder=Ot,n.prototype.modPow=$t,n.prototype.modInverse=Jt,n.prototype.pow=Vt,n.prototype.gcd=qt,n.prototype.isProbablePrime=Qt,n.prototype.square=Lt,ee.prototype.init=ie,ee.prototype.next=ne;var ni,oi,ri,ai=256;if(null==oi){oi=new Array,ri=0;var si;if("Netscape"==Fe.appName&&Fe.appVersion<"5"&&t.crypto){var li=t.crypto.random(32);for(si=0;si<li.length;++si)oi[ri++]=255&li.charCodeAt(si)}for(;ai>ri;)si=Math.floor(65536*De.Util.random()),oi[ri++]=si>>>8,oi[ri++]=255&si;ri=0,ae()}he.prototype.nextBytes=le,de.prototype.doPublic=pe,de.prototype.setPublic=fe,de.prototype.encrypt=ge,de.prototype.doPrivate=ye,de.prototype.setPrivate=me,de.prototype.setPrivateEx=ve,de.prototype.decrypt=we;var hi=function(){ci.v(Ne)},ci={},ui="6a384c1259bdb5e731ec96b3174683f48a2c56a85e52e7a5bb20b58711ce50c1a294bd5e1d1752e766085e9ae94bae6d217c25dbb5fcdb86a8a9a7e180fa066723d00fcb85fcf7c9d29f8cc8859f53244a49c0bc30dcc45156daf8843ce1d24fe8ebc9a3c186bb26e9d0714041aef160304c1db8cc5728cf4acb39d29755f319";ci.cross=function(t){if(t){for(var e="",i=0;i<t.length;)i+1<t.length?(e+=t[i+1],e+=t[i]):e+=t[i],i+=2;return e}return null},ci.reverse=function(t){if(t){for(var e="",i=t.length;i>0;i--)e+=t[i-1];return e}return null},ci.v=function(t){if(t){var e=ci;if(e.start=null,e.beginDate=null,e.end=null,e.endDate=null,e.gis=null,e["3D"]=null,e["3d"]=null,e.l=null,e.__li__=null,t.indexOf("signature=")>0){var i=t.split("signature="),n=i[0],o=i[1],r=new de;r.setPublic(ui,"10001");for(var a=o,s=a.length,l=0,h="",c="";s>l;)h=a.substr(l,256),c+=r.decrypt(h),l+=256;if(c===n)return e.i(t),!0}}return!1},ci.i=function(t){var i=ci;i.__li__=t;var n,o,r,a,s,l=t.split("\n");for(n=l.length-1;n>=0;n--)o=l[n],s=o.split("="),r=s[0],a=s[1],i[r]=a;i.start!=e&&(i.beginDate=new Date(Date.parse(i.start.replace(/-/g,"/")))),i.end!=e&&(i.endDate=new Date(Date.parse(i.end.replace(/-/g,"/"))));var h=i.gis;h!=e&&(h=parseInt(h)),h&&(i._isPermissionGIS=!0);var c=i["3D"]||i["3d"];c!=e&&(c=parseInt(c)),c&&(i._isPermission3D=!0),i["3D"]&&(i._isPermission3D=!0),i.l!=e&&(i.version=i.l)};var di=function(t){return t.__li__!==e&&!t._isPermission3D},fi=function(t){if(!di(t))return!0;var e=new Date;return null!=t.beginDate&&t.beginDate.getTime()-e.getTime()>=0||null!=t.endDate&&t.endDate.getTime()-e.getTime()<=0},pi=function(){return!fi(ci)&&ci._isPermissionGIS};ci.$z=function(t){var e=new de;e.setPublic(ui,"10001");for(var i=t,n=i.length,o=0,r="",a="";n>o;)r=i.substr(o,256),a+=e.decrypt(r),o+=256;return a},ci.twm=function(t){var i=ci,n=i.$z("4cd18113d0c7046bfe51f7a3fbd41c2b7cf14dd785d6ea7cec9da17710d3acfb8ce0cb9cf10839f4bd51e88819de19cdc0db09278584396156fcb65abe0353ac49d01326b30efa0ea98a07da9f8ceeb7572fc1b37b5965ba6103ccba4913b62e36e49425c6ff21a2f008830c59cff8f29058769f858c8a9f0bab3eaea7fb8a9e"),o=this.type,r=this.markText;if(t[i.$z("648be38cd61c870e95ffc1ea0676af40736c1365015abc326e891a4de67b4de3d4b05da70b9aebedc83ec26ecf71eb74c72f42f6d9a4be2d507d2f67d2860b7b66e3ba1d565e15923f2db335ff922eef17c01b59818b583d5656412d6cc9d9ba70001c2c88e3efd492c6b13a07fda5f325b333138a2036f4696542ec137cc341")]=i.__li__,"3"!==o||fi(ci)||r!==e){t.__liLabel==e&&(t.__liLabel=ze.createElement("div")),i.startDate===e&&(i.startDate=new Date);var a=(new Date).getTime()-i.startDate.getTime();if(!(3e5>a)){var s=fi(i)&&a>3e5,l=r;if(s?l=i.$z("0dd629dbd0ce341ecdd447e35ddc3135a0b46916f7571a687f38ae665cf0ae095fee885e14329caa75112d8787508da17285b0897845d8ccae73e6a2727dd19f1ca335fe139d0e60d240f9ececc78f81c2c5667f51aeed4135b9c4bb436b8acb7cd418eeeb404bc4f3bcdedb481ac0edff7644435ce2b9f2bda78c892bd56d73"):"2"!=o||l!==e&&""!=l?"1"!=o||r||(l=n):l=i.$z("644d54bf9c59afbd8a742a9e7e2731f23f149ccb7f04c3547548c50ac2d77faea108b55f1f6261e99869f1c06b84e8abdefdf45b5170048531421f3d528123972ba2f03d70f37c33f1341dc12f986e0089e42bab517e2a05b455d12d90991bbba9bc45c715a81943062ea5fa5408c8b1b9270d260cc5a67b38ecc4178ce512fc"),l!==e){var h=t,c=h.__liLabel;if(c.innerHTML=l,h._rootCanvas)c.type=o,c.mark=r,c.expired=s,h._xyz=c;else{var u=0,d=0;c.style.position="absolute";var f=h.getView().style;r!=e&&null!=r&&""!=r||"2"==o?(u=10-h.getView().scrollLeft,d=10-h.getView().scrollTop):(u=f.width.replace("px","")/2-50-h.getView().scrollLeft,d=f.height.replace("px","")/2-h.getView().scrollTop),c.style.right=u+"px",c.style.bottom=d+"px",c.style.fontSize="120%",s&&(h.getView().style.opacity=.1,c.style.color="red",c.style.fontSize="150%"),h.getView().appendChild(c)}}}}},Me.validateLicense(Ne);var gi=function(t,e,i){this.g=t,this.onLength=e,this.offLength=i,this.isLine=!0,this.overflow=0,this.dashLength=e+i,this.pen={x:0,y:0}};Me.ext(gi,Object,{_curveaccuracy:6,moveTo:function(t,e){this.pen={x:t,y:e},this.g.moveTo(t,e),this.start||(this.start={x:t,y:e})},lineTo:function(t,e){var i=t-this.pen.x,n=e-this.pen.y,o=Math.atan2(n,i),r=Math.cos(o),a=Math.sin(o),s=this.lineLength(this.pen.x,this.pen.y,t,e);if(this.overflow){if(this.overflow>s)return this.isLine?this._lineTo(t,e):this.moveTo(t,e),void(this.overflow-=s);if(this.isLine?this._lineTo(this.pen.x+r*this.overflow,this.pen.y+a*this.overflow):this.moveTo(this.pen.x+r*this.overflow,this.pen.y+a*this.overflow),s-=this.overflow,this.overflow=0,this.isLine=!this.isLine,!s)return}var l=Math.floor(s/this.dashLength);if(l){for(var h=r*this.onLength,c=a*this.onLength,u=r*this.offLength,d=a*this.offLength,f=0;l>f;f++)this.isLine?(this._lineTo(this.pen.x+h,this.pen.y+c),this.moveTo(this.pen.x+u,this.pen.y+d)):(this.moveTo(this.pen.x+u,this.pen.y+d),this._lineTo(this.pen.x+h,this.pen.y+c));s-=this.dashLength*l}this.isLine?s>this.onLength?(this._lineTo(this.pen.x+r*this.onLength,this.pen.y+a*this.onLength),this.moveTo(t,e),this.overflow=this.offLength-(s-this.onLength),this.isLine=!1):(this._lineTo(t,e),s==this.onLength?(this.overflow=0,this.isLine=!this.isLine):(this.overflow=this.onLength-s,this.moveTo(t,e))):s>this.offLength?(this.moveTo(this.pen.x+r*this.offLength,this.pen.y+a*this.offLength),this._lineTo(t,e),this.overflow=this.onLength-(s-this.offLength),this.isLine=!0):(this.moveTo(t,e),s==this.offLength?(this.overflow=0,this.isLine=!this.isLine):this.overflow=this.offLength-s)},quadraticCurveTo:function(t,e,i,n){var o,r=this.pen.x,a=this.pen.y,s=this.curveLength(r,a,t,e,i,n),l=0,h=0;if(this.overflow){if(this.overflow>s)return this.isLine?this._curveTo(t,e,i,n):this.moveTo(i,n),void(this.overflow-=s);if(l=this.overflow/s,o=this.curveSliceUpTo(r,a,t,e,i,n,l),this.isLine?this._curveTo(o[2],o[3],o[4],o[5]):this.moveTo(o[4],o[5]),this.overflow=0,this.isLine=!this.isLine,!s)return}var c=s-s*l,u=Math.floor(c/this.dashLength),d=this.onLength/s,f=this.offLength/s;if(u)for(var p=0;u>p;p++)this.isLine?(h=l+d,o=this.curveSlice(r,a,t,e,i,n,l,h),this._curveTo(o[2],o[3],o[4],o[5]),l=h,h=l+f,o=this.curveSlice(r,a,t,e,i,n,l,h),this.moveTo(o[4],o[5])):(h=l+f,o=this.curveSlice(r,a,t,e,i,n,l,h),this.moveTo(o[4],o[5]),l=h,h=l+d,o=this.curveSlice(r,a,t,e,i,n,l,h),this._curveTo(o[2],o[3],o[4],o[5])),l=h;c=s-s*l,this.isLine?c>this.onLength?(h=l+d,o=this.curveSlice(r,a,t,e,i,n,l,h),this._curveTo(o[2],o[3],o[4],o[5]),this.moveTo(i,n),this.overflow=this.offLength-(c-this.onLength),this.isLine=!1):(o=this.curveSliceFrom(r,a,t,e,i,n,l),this._curveTo(o[2],o[3],o[4],o[5]),s==this.onLength?(this.overflow=0,this.isLine=!this.isLine):(this.overflow=this.onLength-c,this.moveTo(i,n))):c>this.offLength?(h=l+f,o=this.curveSlice(r,a,t,e,i,n,l,h),this.moveTo(o[4],o[5]),o=this.curveSliceFrom(r,a,t,e,i,n,h),this._curveTo(o[2],o[3],o[4],o[5]),this.overflow=this.onLength-(c-this.offLength),this.isLine=!0):(this.moveTo(i,n),c==this.offLength?(this.overflow=0,this.isLine=!this.isLine):this.overflow=this.offLength-c)},bezierCurveTo:function(t,e,i,n,o,r){this.pen={x:o,y:r};var a=[this.onLength,this.offLength];this.g.setLineDash&&this.g.setLineDash(a),this.g.lineDash=a,this.g.bezierCurveTo(t,e,i,n,o,r)},rect:function(t,e,i,n){this.pen={x:t,y:e},this.moveTo(t,e),this.lineTo(t,e+n),this.lineTo(t+i,e+n),this.lineTo(t+i,e),this.lineTo(t,e)},closePath:function(){this.lineTo(this.start.x,this.start.y)},lineLength:function(t,e,i,n){var o=i-t,r=n-e;return Math.sqrt(o*o+r*r)},curveLength:function(t,e,i,n,o,r,a){for(var s,l,h,c,u,d,f,p=0,g=t,_=e,m=a>0?a:this._curveaccuracy,v=1;m>=v;v++)h=v/m,c=1-h,u=c*c,d=2*h*c,f=h*h,s=u*t+d*i+f*o,l=u*e+d*n+f*r,p+=this.lineLength(g,_,s,l),g=s,_=l;return p},curveSlice:function(t,e,i,n,o,r,a,s){if(0==a)return this.curveSliceUpTo(t,e,i,n,o,r,s);if(1==s)return this.curveSliceFrom(t,e,i,n,o,r,a);var l=this.curveSliceUpTo(t,e,i,n,o,r,s);return l.push(a/s),this.curveSliceFrom.apply(this,l)},curveSliceUpTo:function(t,e,i,n,o,r,a){if(1!=a){var s=i+(o-i)*a,l=n+(r-n)*a;i=t+(i-t)*a,n=e+(n-e)*a,o=i+(s-i)*a,r=n+(l-n)*a}return[t,e,i,n,o,r]},curveSliceFrom:function(t,e,i,n,o,r,a){if(1!=a){var s=t+(i-t)*a,l=e+(n-e)*a;i+=(o-i)*a,n+=(r-n)*a,t=s+(i-s)*a,e=l+(n-l)*a}return[t,e,i,n,o,r]},_lineTo:function(t,e){(t!=this.pen.x||e!=this.pen.y)&&(this.pen={x:t,y:e},this.g.lineTo(t,e))},_curveTo:function(t,e,i,n){(t!=i||e!=n||i!=this.pen.x||n!=this.pen.y)&&(this.pen={x:i,y:n},this.g.quadraticCurveTo(t,e,i,n))}}),Me.DashedLine=gi;var _i={DEFAULTS:{default:1,"default.vector":1,"vector.default":1},VECTORS:{vector:1,"default.vector":1,"vector.default":1},hasDefault:function(t){if(t instanceof On){var e=t.getStyle("body.type");return 1===_i.DEFAULTS[e]}return!0},hasVector:function(t){if(t instanceof On){var e=t.getStyle("body.type");return 1===_i.VECTORS[e]}return!1},hasAgentLinks:function(t){for(var e=t.getChildrenSize(),i=0;e>i;i++){var n=t.getChildAt(i);if(n instanceof On&&_i.hasAgentLinks(n))return!0}return t.hasAgentLinks()},getParents:function(t,e,i){i||(i=!0);for(var n=new hn,o=t._parent;null!=o&&o!==e;)n.add(o,0),o=o._parent;return i&&null!=o&&o===e&&n.add(o,0),n},getSubNetwork:function(t){if(!t)return null;if(t instanceof De.Link){var e=t._fromAgent,i=t._toAgent;if(!e||!i)return null;var n=_i.getSubNetwork(e);return n===_i.getSubNetwork(i)?n:null}var o=t._parent;if(!o)return null;for(;o instanceof De.Link&&!o.ISubNetwork;)o=o._parent;return o.ISubNetwork?o:_i.getSubNetwork(o)},figureSameSubNetworkAgent:function(t){if(!t)return null;for(var e=t._parent;e instanceof Mn;){if(!(e._parent instanceof Mn))return e.isExpanded()?t:e;e.isExpanded()||(t=e),e=e._parent}return t},figureSpanSubNetworkAgent:function(t,e){if(!t||!e)return null;var i=_i.getSubNetwork(t),n=_i.getSubNetwork(e);if(i!=n){for(;null!=n&&i!=n;)n=_i.getSubNetwork(n);if(i===n)return t;var o=new hn;o.add(t,0);for(var r=t._parent;r instanceof On&&!e.isDescendantOf(r);)o.add(r,0),r=r._parent;for(var a=o.size(),s=0;a>s;s++){var l=o.get(s);if(l instanceof Mn&&!l.isExpanded())return l;if(l.ISubNetwork)return l}return t}return t},figureFromAgent:function(t){if(t.isLooped())return t.getFromNode();var e=_i.figureSameSubNetworkAgent(t.getFromNode()),i=_i.figureSameSubNetworkAgent(t.getToNode());return e===i?t.getFromNode():_i.figureSpanSubNetworkAgent(e,i)},figureToAgent:function(t){if(t.isLooped())return t.getToNode();var e=_i.figureSameSubNetworkAgent(t.getFromNode()),i=_i.figureSameSubNetworkAgent(t.getToNode());return e===i?t.getToNode():_i.figureSpanSubNetworkAgent(i,e)},getBundleLinks:function(t,e){if(!t||!e)return null;var i,n,o,r;if(t===e){if(!(r=t.getLoopedLinks()))return null;r=new hn(r)}else{var a=t.getAgentLinks(),s=e.getAgentLinks();if(!a||!s)return null;for(n=a.size(),i=0;n>i;i++)o=a.get(i),s.contains(o)&&(r||(r=new hn),r.add(o))}if(null!=r)for(i=0;i<r.size();i++)o=r.get(i),o.getStyle("link.bundle.enable")||(o._setBundleLinks(null),r.removeAt(i),i--);return r},resetBundleLinks:function(t,e){var i=_i.getBundleLinks(t,e);if(i&&0!==i.size()){var n=null;if(1===i.size())return n=i.get(0),void n._setBundleLinks(null);var o,r,a=new hn;for(o=0;o<i.size();o++)n=i.get(o),r=n.getStyle("link.bundle.id"),a.indexOf(r)<0&&a.add(r);a.sort();var s,l,h=new hn;for(l=0;l<a.size();l++){r=a.get(l);var c=new hn;for(o=0;o<i.size();o++)n=i.get(o),r===n.getStyle("link.bundle.id")&&c.add(n);s=new De.BundleLinks(c,h),h.add(s)}for(l=0;l<h.size();l++)for(s=h.get(l),o=0;o<s.getLinks().size();o++)n=s.getLinks().get(o),n._setBundleLinks(s)}},moveElements:function(t,e,i,n){for(var o=_i.filterMovingElements(t,n),r=o.size(),a=0;r>a;a++)o.get(a).translate(e,i)},filterMovingElements:function(t,e){for(var i=new hn,n=t.size(),o=0;n>o;o++){var r=t.get(o);if(r instanceof On&&(!e||e(r))){for(var a=!0,s=i.toArray(),l=0;l<s.length;l++){var h=s[l];a&&h instanceof De.Follower&&r instanceof De.Follower&&r.isLoopedHostOn(h)?a=!1:h instanceof De.Follower&&h.isHostOn(r)?i.remove(h):a&&r instanceof De.Follower&&h instanceof On&&r.isHostOn(h)?a=!1:_i.isDescendantOfGroup(h,r)?i.remove(h):a&&_i.isDescendantOfGroup(r,h)&&(a=!1)}a&&i.add(r)}}return i},isDescendantOfGroup:function(t,e){if(!(t&&e instanceof Mn))return!1;if(!e.hasChildren())return!1;for(t=t._parent;t instanceof Mn;){if(t===e)return!0;t=t._parent}return!1}};Me.element=_i;var mi={between:function(t,e,i){return i>=t&&e>=i||i>=e&&t>=i},considerEast:function(t,e,i){return!e||(mi.between(e.x,i.x,t.x)?i.x>e.x:Math.abs(e.x-t.x)>Math.abs(i.x-t.x))},considerWest:function(t,e,i){return!e||(mi.between(e.x,i.x,t.x)?i.x<e.x:Math.abs(e.x-t.x)>Math.abs(i.x-t.x))},considerNorth:function(t,e,i){return!e||(mi.between(e.y,i.y,t.y)?i.y<e.y:Math.abs(e.y-t.y)>Math.abs(i.y-t.y))},considerSouth:function(t,e,i){return!e||(mi.between(e.y,i.y,t.y)?i.y>e.y:Math.abs(e.y-t.y)>Math.abs(i.y-t.y))},getHorizontalPoint:function(t,e,i){return mi.between(e.x,i.x,t.x)?{x:t.x,y:e.y}:Math.abs(t.x-e.x)<Math.abs(t.x-i.x)?{x:e.x,y:e.y}:{x:i.x,y:i.y}},getVerticalPoint:function(t,e,i){return mi.between(e.y,i.y,t.y)?{x:e.x,y:t.y}:Math.abs(t.y-e.y)<Math.abs(t.y-i.y)?{x:e.x,y:e.y}:{x:i.x,y:i.y}},getPoint:function(t,e,i,n,o){var r=Math.abs(n.x-i.x)>Math.abs(n.y-i.y);if("south"===o)return r&&mi.considerSouth(e,t,i)?mi.getHorizontalPoint(e,i,n):null;if("north"===o)return r&&mi.considerNorth(e,t,i)?mi.getHorizontalPoint(e,i,n):null;if("west"===o)return!r&&mi.considerWest(e,t,i)?mi.getVerticalPoint(e,i,n):null;if("east"===o)return!r&&mi.considerEast(e,t,i)?mi.getVerticalPoint(e,i,n):null;if("nearby"===o){var a;return a=r?mi.getHorizontalPoint(e,i,n):mi.getVerticalPoint(e,i,n),!t||We.getDistance(t,e)>We.getDistance(a,e)?a:null}return null},getBusPoint:function(t,e,i){var n,o=t.size();if(o>0){for(var r=t.get(0),a=1;o>a;a++){var s=t.get(a),l=mi.getPoint(n,e,r,s,i);l&&(n=l),r=s}n||(n={x:r.x,y:r.y})}return n}};Me.bus=mi;var vi={createFromPoint:function(t,e){var i=t._element;if(!i.getFromAgent())return{x:0,y:0};var n,o=i.getStyle("link.from.position"),r=i.getStyle("link.from.xoffset"),a=i.getStyle("link.from.yoffset"),s=i.getStyle("link.from.percent");if(s&&s instanceof Array&&2===s.length&&s[0]<=1&&s[0]>=0&&s[1]<=1&&s[1]>=0){var l=i.getFromAgent(),h=l.getSize();return{x:l.getRect().x+h.width*s[0],y:l.getRect().y+h.height*s[1]}}if(t._network._edgeDetect){var l=i.getFromAgent(),c=i.getToAgent(),u=l.getImage(),d=Me.images[u],f=l.getCenterLocation(),p=c.getCenterLocation(),g=this._getPointAngleDegree(p.x,p.y,f.x,f.y),_={x:0,y:0};if(d){var m=d._image;if(m&&Ki(m)||m&&De.Util.getImageAsset(u)._cache)return Ki(m)?d._edgeData||(d._edgeData=d._createEdgeData(m,l._width,l._height)):"object"==typeof m&&(d._edgeData||(d._edgeData=d._createEdgeData(De.Util.getImageAsset(u)._cache,l.getWidth(),l.getHeight()))),_.x=d._edgeData[g].x+l.getRect().x,_.y=d._edgeData[g].y+l.getRect().y,_}}if(!Me.isCalculatingBus){if(Me.isCalculatingBus=!0,i.getFromAgent()instanceof De.Bus){var v=i.getFromAgent();if(_i.hasVector(v)){var y=e?e._getElementZoomRect(t,v.getRect()):v.getRect(),w=v.getStyle("vector.shape");if("oval"===w)n=We.getEllipsePoint(y,vi.createToPoint(t));else if("circle"===w)n=We.getEllipsePoint(We.getCircleRect(y),vi.createToPoint(t));else if("rectangle"===w||"roundrect"===w){var b=new hn;b.add({x:v.x,y:v.y}),b.add({x:v.x+v.width,y:v.y}),b.add({x:v.x+v.width,y:v.y+v.height}),b.add({x:v.x,y:v.y+v.height}),b.add({x:v.x,y:v.y}),b=e?e._getShapeNodeZoomPoints(t,b):b,n=mi.getBusPoint(b,vi.createToPoint(t),v.getStyle("bus.style"))}}else{var b=e?e._getShapeNodeZoomPoints(t,v.getPoints()):v.getPoints();n=mi.getBusPoint(b,vi.createToPoint(t),v.getStyle("bus.style"))}}Me.isCalculatingBus=!1}return n?(n.x+=r,n.y+=a):n=t._network.getPosition(o,i.getFromAgent(),null,r,a,!0),n},createToPoint:function(t,e){var i=t._element;if(!i.getToAgent())return{x:0,y:0};var n,o=i.getStyle("link.to.position"),r=i.getStyle("link.to.xoffset"),a=i.getStyle("link.to.yoffset"),s=i.getStyle("link.to.percent");if(s&&s instanceof Array&&2===s.length&&s[0]<=1&&s[0]>=0&&s[1]<=1&&s[1]>=0){var l=i.getToAgent(),h=l.getSize();return{x:l.getRect().x+h.width*s[0],y:l.getRect().y+h.height*s[1]}}if(t._network._edgeDetect){var c=i.getFromAgent(),l=i.getToAgent(),u=l.getImage(),d=Me.images[u],f=c.getLocation(),p=l.getCenterLocation(),g=this._getPointAngleDegree(f.x,f.y,p.x,p.y),_={x:0,y:0};if(d){var m=d._image;if(m&&Ki(m)||m&&De.Util.getImageAsset(u)._cache)return Ki(m)?d._edgeData||(d._edgeData=d._createEdgeData(m,l.getWidth(),l.getHeight())):"object"==typeof m&&(d._edgeData||(d._edgeData=d._createEdgeData(De.Util.getImageAsset(u)._cache,l.getWidth(),l.getHeight()))),_.x=d._edgeData[g].x+l.getRect().x,_.y=d._edgeData[g].y+l.getRect().y,_}}if(!Me.isCalculatingBus){if(Me.isCalculatingBus=!0,i.getToAgent()instanceof De.Bus){var v=i.getToAgent();if(_i.hasVector(v)){var y=e?e._getElementZoomRect(t,v.getRect()):v.getRect(),w=v.getStyle("vector.shape");if("oval"===w)n=We.getEllipsePoint(y,vi.createFromPoint(t));else if("circle"===w)n=We.getEllipsePoint(We.getCircleRect(y),vi.createFromPoint(t));else if("rectangle"===w||"roundrect"===w){var b=new hn;b.add({x:v.x,y:v.y}),b.add({x:v.x+v.width,y:v.y}),b.add({x:v.x+v.width,y:v.y+v.height}),b.add({x:v.x,y:v.y+v.height}),b.add({x:v.x,y:v.y}),b=e?e._getShapeNodeZoomPoints(t,b):b,n=mi.getBusPoint(b,vi.createFromPoint(t),v.getStyle("bus.style"))}}else{var b=e?e._getShapeNodeZoomPoints(t,v.getPoints()):v.getPoints();n=mi.getBusPoint(b,vi.createFromPoint(t),v.getStyle("bus.style"))}}Me.isCalculatingBus=!1}return n?(n.x+=r,n.y+=a):n=t._network.getPosition(o,i.getToAgent(),null,r,a,!0),n},fillLoopedPoints:function(t,e,i){var n,o=vi.getBundleGap(t,!0),r=o,a=t.getStyle("link.looped.type"),s=t.getStyle("link.looped.direction");if("north"===s)return"arc"===a?vi.drawArc(e.x+e.width/2,e.y,0,Math.PI,o,o,!1,i):(n={x:e.x+e.width/2,y:e.y},i.add({x:n.x+r,y:n.y}),i.add({x:n.x+r,y:n.y-o}),i.add({x:n.x-r,y:n.y-o}),i.add({x:n.x-r,y:n.y})),{x:e.x+e.width/2,y:e.y-o};if("northeast"===s)return"arc"===a?vi.drawArc(e.x+e.width,e.y,1.5*Math.PI,1.5*Math.PI,o,o,!1,i):(n={x:e.x+e.width,y:e.y},i.add({x:n.x,y:n.y+r}),i.add({x:n.x+r,y:n.y+r}),i.add({x:n.x+r,y:n.y-o}),i.add({x:n.x-r,y:n.y-o}),i.add({x:n.x-r,y:n.y})),{x:e.x+e.width+.707*o,y:e.y-.707*o};if("east"===s)return"arc"===a?vi.drawArc(e.x+e.width,e.y+e.height/2,1.5*Math.PI,Math.PI,o,o,!1,i):(n={x:e.x+e.width,y:e.y+e.height/2},i.add({x:n.x,y:n.y-r}),i.add({x:n.x+o,y:n.y-r}),i.add({x:n.x+o,y:n.y+r}),i.add({x:n.x,y:n.y+r})),{x:e.x+e.width+o,y:e.y+e.height/2};if("southeast"===s)return"arc"===a?vi.drawArc(e.x+e.width,e.y+e.height,Math.PI,1.5*Math.PI,o,o,!1,i):(n={x:e.x+e.width,y:e.y+e.height},i.add({x:n.x,y:n.y-r}),i.add({x:n.x+r,y:n.y-r}),i.add({x:n.x+r,y:n.y+o}),i.add({x:n.x-r,y:n.y+o}),i.add({x:n.x-r,y:n.y})),{x:e.x+e.width+.707*o,y:e.y+e.height+.707*o};if("south"===s)return"arc"===a?vi.drawArc(e.x+e.width/2,e.y+e.height,Math.PI,Math.PI,o,o,!1,i):(n={x:e.x+e.width/2,y:e.y+e.height},i.add({x:n.x-r,y:n.y}),i.add({x:n.x-r,y:n.y+o}),i.add({x:n.x+r,y:n.y+o}),i.add({x:n.x+r,y:n.y})),{x:e.x+e.width/2,y:e.y+e.height+o};if("southwest"===s)return"arc"===a?vi.drawArc(e.x,e.y+e.height,.5*Math.PI,1.5*Math.PI,o,o,!1,i):(n={x:e.x,y:e.y+e.height},i.add({x:n.x,y:n.y-r}),i.add({x:n.x-r,y:n.y-r}),i.add({x:n.x-r,y:n.y+o}),i.add({x:n.x+r,y:n.y+o}),i.add({x:n.x+r,y:n.y})),{x:e.x-.707*o,y:e.y+e.height+.707*o};if("west"===s)return"arc"===a?vi.drawArc(e.x,e.y+e.height/2,.5*Math.PI,Math.PI,o,o,!1,i):(n={x:e.x,y:e.y+e.height/2},i.add({x:n.x,y:n.y-r}),i.add({x:n.x-o,y:n.y-r}),i.add({x:n.x-o,y:n.y+r}),i.add({x:n.x,y:n.y+r})),{x:e.x-o,y:e.y+e.height/2};if("northwest"===s)return"arc"===a?vi.drawArc(e.x,e.y,0,1.5*Math.PI,o,o,!1,i):(n={x:e.x,y:e.y},i.add({x:n.x,y:n.y+r}),i.add({x:n.x-r,y:n.y+r}),i.add({x:n.x-r,y:n.y-o}),i.add({x:n.x+r,y:n.y-o}),i.add({x:n.x+r,y:n.y})),{x:e.x-.707*o,y:e.y-.707*o};throw"Can not resolve link looped direction '"+s+"'"},drawArc:function(t,e,i,n,o,r,a,s){var l,h,c,u,d,f,p,g,_,m,v;if(Math.abs(n)>2*Math.PI&&(n=2*Math.PI),d=Math.ceil(Math.abs(n)/(Math.PI/4)),l=n/d,h=-l,c=-i,d>0){f=t+Math.cos(i)*o,p=e+Math.sin(-i)*r,s.add({x:f,y:p});for(var y=0;d>y;y++){c+=h,u=c-h/2,g=t+Math.cos(c)*o,_=e+Math.sin(c)*r,m=t+Math.cos(u)*(o/Math.cos(h/2)),v=e+Math.sin(u)*(r/Math.cos(h/2));var w=new hn;w.add({x:m,y:v}),w.add({x:g,y:_}),s.add(w)}}},fillBundlePoints:function(t,i,n,o,r,a){var s;if(t._element.getBundleCount(),t._element.getBundleIndex(),t.getStyle("link.bundle.expanded"),"parallel"!==i&&0===(s=vi.getBundleGap(t,!1)))return r.add(n),r.add(o),We.getCenterPoint(n,o);s===e&&(s=vi.getBundleGap(t,!1));var l=vi.getBundleOffset(t),h=We.getDistance(n,o);if(a){var c=a.getSizeZoom();l*=c,s*=c}("arc"===i||"triangle"===i)&&r.add({x:0,y:0}),"arc"===i&&r.add({x:0,y:s}),r.add({x:l,y:s}),r.add({x:h-l,y:s}),"arc"===i&&r.add({x:h,y:s}),("arc"===i||"triangle"===i)&&r.add({x:h,y:0});for(var u=Math.atan2(o.y-n.y,o.x-n.x),d=We.createMatrix(u,0,0),f=0,p=r.size();p>f;f++){var g=r.get(f);g=d.transform(g),g.x+=n.x,g.y+=n.y,r.set(f,g)}if("arc"===i){var _=We.getCenterPoint(r.get(2),r.get(3)),m=new hn;return m.add(r.get(1)),m.add(r.get(2)),r.set(1,m),m=new hn,m.add(r.get(4)),m.add(r.get(5)),r.set(4,m),r.removeAt(5),r.removeAt(2),_}return vi.calculateCenterPoint(r)},calculateCenterPoint:function(t){var e=t.size();if(null==t||1>e)return{x:0,y:0};if(e%2==0){var i=e/2,n=t.get(i-1),o=t.get(i);return{x:(n.x+o.x)/2,y:(n.y+o.y)/2}}return t.get((e-1)/2)},getBundleOffset:function(t){var e=We.getDistance(t.getFromPoint(),t.getToPoint()),i=t.getStyle("link.bundle.offset");return e>2*i?i:e/2},getBundleGap:function(t,e){var i=t._element;if(!i.getBundleLinks())return e?i.getStyle("link.looped.gap"):0;for(var n=e?"link.looped.gap":"link.bundle.gap",o=null,r=0,a=0,s=i.getBundleLinks().getSiblings(),l=0,h=i.getStyle("link.bundle.independent"),c=i.getStyle("link.bundle.group.gap"),u=0,d=s.size();d>u;u++){var f=s.get(u);if(!h||f===i.getBundleLinks()){for(var p=0,g=f.getLinks().size();g>p;p++){var _=f.getLinks().get(p);if(h===_.getStyle("link.bundle.independent")&&t._network.isVisible(_)){if(null==o)o=_,l=_.getStyle(n);else{var m=_.getStyle(n);a+=l/2+m/2,l=m}_===i&&(r=a+c/2)}}a+=c}}if(e)return a-r+l;var v=r-a/2;return null!=o&&i.getFromAgent()!==o.getFromAgent()&&(v=-v),v},isTargetPriority:function(t,e,i){if(t){if(e.height<i.height)return e.height+i.height<Math.max(e.y+e.height,i.y+i.height)-Math.min(e.y,i.y)+e.height/2}else if(e.width<i.width)return e.width+i.width<Math.max(e.x+e.width,i.x+i.width)-Math.min(e.x,i.x)+e.width/2;return!0},calculateOrthogonalAndFlexionalLinkPoints:function(t,e,i,n){var o=vi.isHorizontal(t,e,i,n),r=new hn;if(vi.isFlexionalTypeLink(t))vi.flexional(o,e,i,r,n.getStyle("link.extend"));else{vi.orthogonal(t,e,i,r,o,n);0===(vi.isSplitByPercent(t,n)?vi.calculateSplitValueByPercent(t,o,e,i,n.getStyle("link.split.percent")):n.getStyle("link.split.value"))&&(o=!o)}var a;0===r.size()?vi.isTargetPriority(o,e,i)?(a={x:i.x+i.width/2,y:i.y+i.height/2},r.add(vi.rectanglePerimeter(e,!0,a)),r.add(vi.rectanglePerimeter(i,!1,r.get(r.size()-1)))):(a={x:e.x+e.width/2,y:e.y+e.height/2},a=vi.rectanglePerimeter(i,!1,a),r.add(vi.rectanglePerimeter(e,!0,a)),r.add(a)):(a=r.get(0),r.add(vi.rectanglePerimeter(e,!0,a),0),r.add(vi.rectanglePerimeter(i,!1,r.get(r.size()-1))));var s=r.size();if(2>s)return r;for(var l=r.get(0),h=1;s-1>h;h++){var c=r.get(h);c.x===l.x&&c.y===l.y&&(r.remove(c),s--,h--),l=c}return r},isHorizontal:function(t,e,i,n){if(t){if("flexional.horizontal"===t||"orthogonal.horizontal"===t||"orthogonal.H.V"===t||"extend.left"===t||"extend.right"===t)return!0;if("flexional.vertical"===t||"orthogonal.vertical"===t||"orthogonal.V.H"===t||"extend.top"===t||"extend.bottom"===t)return!1}return vi.calculateXGap(e,i)>=vi.calculateYGap(e,i)},flexional:function(t,e,i,n,o){t?vi.flexionalHorizontal(e,i,n,o):vi.flexionalVertical(e,i,n,o)},isSplitByPercent:function(t,e){return e.getStyle("link.split.by.percent")},isExtendTypeLink:function(t){return t&&("extend.top"===t||"extend.left"===t||"extend.bottom"===t||"extend.right"===t)},isFlexionalTypeLink:function(t){return t&&("flexional"===t||"flexional.horizontal"===t||"flexional.vertical"===t)},calculateControlPoint:function(t,e,i,n,o){if("orthogonal.H.V"===t||"orthogonal.V.H"===t)return{x:n.x+n.width/2,y:n.y+n.height/2};var r;if(vi.isExtendTypeLink(t)){var a=Math.min(i.y,n.y),s=Math.min(i.x,n.x),l=Math.max(i.y+i.height,n.y+n.height),h=Math.max(i.x+i.width,n.x+n.width);if(r=o.getStyle("link.extend"),"extend.top"===t)return{x:(s+h)/2,y:a-r};if("extend.left"===t)return{x:s-r,y:(a+l)/2};if("extend.bottom"===t)return{x:(s+h)/2,y:l+r};if("extend.right"===t)return{x:h+r,y:(a+l)/2}}if((r=vi.isSplitByPercent(t,o)?vi.calculateSplitValueByPercent(t,e,i,n,o.getStyle("link.split.percent")):o.getStyle("link.split.value"))===Number.NEGATIVE_INFINITY||r===Number.POSITIVE_INFINITY)return{x:n.x+n.width/2,y:n.y+n.height/2};if(0===r)return{x:i.x+i.width/2,y:i.y+i.height/2};if(e){var c=i.x+i.x+i.width<n.x+n.x+n.width;return{x:vi.calculateSplitLocation(c,r,i.x,i.width),y:i.y+i.height/2}}var u=i.y+i.y+i.height<n.y+n.y+n.height;return{x:i.x+i.width/2,y:vi.calculateSplitLocation(u,r,i.y,i.height)}},calculateGap:function(t,e,i,n){return Math.max(e,n)-Math.min(t,i)-(e-t+n-i)},calculateXGap:function(t,e){return Math.max(t.x+t.width,e.x+e.width)-Math.min(t.x,e.x)-t.width-e.width},calculateYGap:function(t,e){return Math.max(t.y+t.height,e.y+e.height)-Math.min(t.y,e.y)-t.height-e.height},calculateSplitValueByPercent:function(t,e,i,n,o){return vi.calculateSplitGapByPercent(o,e,i,n)*o},calculateSplitGapByPercent:function(t,e,i,n,o){return e?vi._calculateSplitGapByPercent(t,i.x,i.x+i.width,n.x,n.x+n.width):vi._calculateSplitGapByPercent(t,i.y,i.y+i.height,n.y,n.y+n.height)},_calculateSplitGapByPercent:function(t,e,i,n,o){var r=vi.calculateGap(e,i,n,o),a=n+o>e+i;if(r>0){if(1===t)return r+(o-n)/2;if(t>=0&&1>t)return r;if(0>t)return a?n-e:i-o}return Math.abs(a&&t>0||!a&&0>t?i-o:e-n)},calculateSplitPercentByControlPoint:function(t,e,i,n){return e?vi.calculateSplitPercent(t.x,i.x,i.x+i.width,n.x,n.x+n.width):vi.calculateSplitPercent(t.y,i.y,i.y+i.height,n.y,n.y+n.height)},calculateSplitPercent:function(t,e,i,n,o){if(t>=e&&i>=t)return 0;var r=vi.calculateGap(e,i,n,o);if(r>0&&t>=n&&o>=t)return 1;var a=n+o>e+i;if(r>0){if(t>Math.min(i,o)&&t<Math.max(e,n))return Math.abs(t-(a?i:e))/r;if(a){if(e>t)return(t-e)/(n-e)}else if(t>i)return(i-t)/(i-o)}return t>i?(a?t-i:i-t)/Math.abs(i-o):(a?t-e:e-t)/Math.abs(e-n)},calculateSplitLocation:function(t,e,i,n){return t===e>0?i+n+Math.abs(e):i-Math.abs(e)},calculateAngle:function(t,e){if(0!==t&&0!==e)return Math.atan2(t,e);if(0===t){if(e>0)return 0;if(0>e)return Math.PI}return t>0?Math.PI/2:-Math.PI/2},drawCorner:function(t,e){var i=t.size();if(!(3>i)){var n=e.getStyle("link.corner");if("none"!==n){for(var o,r,a,s,l=e.getStyle("link.xradius"),h=e.getStyle("link.yradius"),c=t.get(0),u=t.get(1),d=2;i>d;d++){var f=t.get(d),p=u.x-c.x,g=u.y-c.y,_=f.x-u.x,m=f.y-u.y,v=0===g;if(0===p&&0===m||0===g&&0===_)if(v?(o=Math.min(2===d?Math.abs(p):Math.abs(p)/2,l),r=Math.min(d===i-1?Math.abs(m):Math.abs(m)/2,h),a={x:u.x-(p>0?o:-o),y:u.y},s={x:u.x,y:u.y+(m>0?r:-r)}):(o=Math.min(d===i-1?Math.abs(_):Math.abs(_)/2,l),r=Math.min(2===d?Math.abs(g):Math.abs(g)/2,h),a={x:u.x,y:u.y-(g>0?r:-r)},s={x:u.x+(_>0?o:-o),y:u.y}),t.remove(u),d--,i--,(a.x!==c.x||a.y!==c.y)&&(t.add(a,d),d++,i++),"bevel"===n)t.add(s,d),d++,i++;else if("round"===n){var y=new hn;y.add(u),y.add(s),t.add(y,d),d++,i++}c=u,u=f}s&&s.x===u.x&&s.y===u.y&&t.remove(u)}}},orthogonal:function(t,e,i,n,o,r){var a=r.getStyle("link.control.point"),s=null==a;if(a){var l=We.unionRect(e,i);We.containsPoint(l,a)||(o=vi.calculateIsHorizontalByControlPoint(a.x,a.y,l.y,l.x,l.y+l.height,l.x+l.width))}else a=vi.calculateControlPoint(t,o,e,i,r);o?vi.sideToSide(e,i,a,n,s):vi.topToBottom(e,i,a,n,s)},calculateIsHorizontalByControlPoint:function(t,e,i,n,o,r){return!(i>e&&i-e>n-t&&i-e>t-r||e>o&&e-o>n-t&&e-o>t-r)},contains:function(t,e,i){return e>=t.x&&e<=t.x+t.width&&i>=t.y&&i<=t.y+t.height},topToBottom:function(t,e,i,n,o){var r=Math.max(t.y,e.y),a=Math.min(t.y+t.height,e.y+e.height),s=i?i.y:a+(r-a)/2,l=t.x+t.width/2,h=e.x+e.width/2;if(!o&&i&&(i.x>=t.x&&i.x<=t.x+t.width&&(l=i.x),i.x>=e.x&&i.x<=e.x+e.width&&(h=i.x)),vi.contains(e,l,s)||vi.contains(t,l,s)||n.add({x:l,y:s}),vi.contains(e,h,s)||vi.contains(t,h,s)||n.add({x:h,y:s}),0===n.size())if(i)vi.contains(e,i.x,s)||vi.contains(t,i.x,s)||n.add({x:i.x,y:s});else{var c=Math.max(t.x,e.x),u=Math.min(t.x+t.width,e.x+e.width);n.add({x:c+(u-c)/2,y:s})}},sideToSide:function(t,e,i,n,o){var r=Math.max(t.x,e.x),a=Math.min(t.x+t.width,e.x+e.width),s=i?i.x:a+(r-a)/2,l=t.y+t.height/2,h=e.y+e.height/2;if(!o&&i&&(i.y>=t.y&&i.y<=t.y+t.height&&(l=i.y),i.y>=e.y&&i.y<=e.y+e.height&&(h=i.y)),vi.contains(e,s,l)||vi.contains(t,s,l)||n.add({x:s,y:l}),vi.contains(e,s,h)||vi.contains(t,s,h)||n.add({x:s,y:h}),0===n.size())if(i)vi.contains(e,s,i.y)||vi.contains(t,s,i.y)||n.add({x:s,y:i.y});else{var c=Math.max(t.y,e.y),u=Math.min(t.y+t.height,e.y+e.height);n.add({x:s,y:c+(u-c)/2})}},flexionalHorizontal:function(t,e,i,n){var o=e.x+e.width<t.x,r=t.x+t.width<e.x,a=o?t.x:t.x+t.width,s=t.y+t.height/2,l=r?e.x:e.x+e.width,h=e.y+e.height/2,c=n,u=o?-c:c,d={x:a+u,y:s};u=r?-c:c;var f={x:l+u,y:h};if(o===r){var p=o?Math.min(a,l)-n:Math.max(a,l)+n;i.add({x:p,y:s}),i.add({x:p,y:h})}else if(d.x<f.x===o){var g=s+(h-s)/2;i.add(d),i.add({x:d.x,y:g}),i.add({x:f.x,y:g}),i.add(f)}else i.add(d),i.add(f)},flexionalVertical:function(t,e,i,n){var o=e.y+e.height<t.y,r=t.y+t.height<e.y,a=t.x+t.width/2,s=o?t.y:t.y+t.height,l=e.x+e.width/2,h=r?e.y:e.y+e.height,c=n,u=o?-c:c,d={x:a,y:s+u};u=r?-c:c;var f={x:l,y:h+u};if(o===r){var p=o?Math.min(s,h)-n:Math.max(s,h)+n;i.add({x:a,y:p}),i.add({x:l,y:p})}else if(d.y<f.y===o){var g=a+(l-a)/2;i.add(d),i.add({x:g,y:d.y}),i.add({x:g,y:f.y}),i.add(f)}else i.add(d),i.add(f)},rectanglePerimeter:function(t,e,i){var n=t.x+t.width/2,o=t.y+t.height/2,r=i.x-n,a=i.y-o,s=Math.atan2(a,r),l={x:0,y:0},h=Math.PI,c=Math.PI/2,u=c-s,d=Math.atan2(t.height,t.width);return-h+d>s||s>h-d?(l.x=t.x,l.y=o-t.width*Math.tan(s)/2):-d>s?(l.y=t.y,l.x=n-t.height*Math.tan(u)/2):d>s?(l.x=t.x+t.width,l.y=o+t.width*Math.tan(s)/2):(l.y=t.y+t.height,l.x=n+t.height*Math.tan(u)/2),i.x>=t.x&&i.x<=t.x+t.width?l.x=i.x:i.y>=t.y&&i.y<=t.y+t.height&&(l.y=i.y),i.x<t.x?l.x=t.x:i.x>t.x+t.width&&(l.x=t.x+t.width),i.y<t.y?l.y=t.y:i.y>t.y+t.height&&(l.y=t.y+t.height),l},isSplitTypeLink:function(t){return t&&("orthogonal"===t||"orthogonal.horizontal"===t||"orthogonal.vertical"===t)},isOrthogonalOrFlexionalLink:function(t){if(t instanceof De.ShapeLink)return!1;if(t.isLooped())return!1;var e=t.getStyle("link.type");return vi.isOrthogonalOrFlexionalType(e)},isOrthogonalLink:function(t){if(t instanceof De.ShapeLink)return!1;if(t.isLooped())return!1;var e=t.getStyle("link.type");return vi.isOrthogonalType(e)},isOrthogonalOrFlexionalType:function(t){return"orthogonal"===t||"orthogonal.horizontal"===t||"orthogonal.H.V"===t||"orthogonal.vertical"===t||"orthogonal.V.H"===t||"extend.top"===t||"extend.left"===t||"extend.bottom"===t||"extend.right"===t||"flexional"===t||"flexional.horizontal"===t||"flexional.vertical"===t},isOrthogonalType:function(t){return"orthogonal"===t||"orthogonal.horizontal"===t||"orthogonal.H.V"===t||"orthogonal.vertical"===t||"orthogonal.V.H"===t||"extend.top"===t||"extend.left"===t||"extend.bottom"===t||"extend.right"===t},hasControlPoint:function(t){return"orthogonal"===t||"orthogonal.horizontal"===t||"orthogonal.vertical"===t||"extend.bottom"===t||"extend.left"===t||"extend.right"===t||"extend.top"===t},getControlPoint:function(t,e,i){if(!t)throw"link can't be null";var n=t.getStyle("link.type");if(!vi.hasControlPoint(n))return null;var o=t.getStyle("link.control.point");if(o)return o;var r,a;if(null==e?(r=t.getFromAgent().getRect(),a=t.getToAgent().getRect()):(r=vi.getLinkSourceBounds(e,i),a=vi.getLinkTargetBounds(e,i)),null==r||null==a)return null;var s=vi.isHorizontal(n,r,a,t);return vi.calculateControlPoint(t.getStyle("link.type"),s,r,a,t)},getSplitValueByControlPoint:function(t,e,i,n,o){if("extend.top"===e)return Math.min(i.y,n.y)-t.y;if("extend.left"===e)return Math.min(i.x,n.x)-t.x;if("extend.bottom"===e)return t.y-Math.max(i.y+i.height,n.y+n.height);if("extend.right"===e)return t.x-Math.max(i.x+i.width,n.x+n.width);var r;if(o){return r=i.x+i.x+i.width<n.x+n.x+n.width?t.x-i.x+i.width:i.x-t.x,r>0?r:r>-i.width?0:r+i.width}return r=i.y+i.y+i.height<n.y+n.y+n.height?t.y-i.y-i.height:i.y-t.y,r>0?r:r>-i.height?0:r+i.height},isHorizontalByControlPoint:function(t,e,i,n,o){var r=We.unionRect(i,n);return We.containsPoint(r,t)?vi.isHorizontal(e,i,n,o):vi.calculateIsHorizontalByControlPoint(t.x,t.y,r.y,r.x,r.y+r.height,r.x+r.width)},setParamsByControlPoint:function(t,e,i,n,o){var r=vi.isHorizontalByControlPoint(t,n,e,i,o),a=o.getStyle("link.control.point");if((a||"orthogonal"===n||"orthogonal.horizontal"===n||"orthogonal.vertical"===n)&&o.setStyle("link.type",r?"orthogonal.horizontal":"orthogonal.vertical"),a)return void o.setStyle("link.control.point",t);var s=vi.getSplitValueByControlPoint(t,n,e,i,r);return vi.isExtendTypeLink(n)?void o.setStyle("link.extend",s):vi.isSplitByPercent(n,o)?0===s?void o.setStyle("link.split.percent",0):void o.setStyle("link.split.percent",vi.calculateSplitPercentByControlPoint(t,r,e,i)):void o.setStyle("link.split.value",s)},getLinkNodeBounds:function(t,e,i,n,o,r){if(r){var a=r.getLocationZoom();r.getSizeZoom(t)}if(null==t)return null;var s;if(n)r?(s=t.getZoomBodyRect(),s.x+=e,s.y+=i):(s=t.getBodyRect(),s.x+=e,s.y+=i);else{var l=t.getNetwork().getPosition(o,t,null,e,i);s=r?{x:l.x*a,y:l.y*a,width:1,height:1}:{x:l.x,y:l.y,width:1,height:1}}return s},getLinkSourceBounds:function(t,e){var i=t._element,n=t.getNetwork().getElementUI(i.getFromAgent());if(null==n)return null;var o=i.getStyle("link.from.position"),r=i.getStyle("link.from.xoffset"),a=i.getStyle("link.from.yoffset"),s=i.getStyle("link.from.at.edge");return vi.getLinkNodeBounds(n,r,a,s,o,e)},getLinkTargetBounds:function(t,e){var i=t._element,n=t.getNetwork().getElementUI(i.getToAgent());if(null==n)return null;var o=i.getStyle("link.to.position"),r=i.getStyle("link.to.xoffset"),a=i.getStyle("link.to.yoffset"),s=i.getStyle("link.to.at.edge");return vi.getLinkNodeBounds(n,r,a,s,o,e)},orthogonalAndFlexional:function(t,e,i){var n=vi.getLinkSourceBounds(t,i);if(null==n)return null;var o=vi.getLinkTargetBounds(t,i);if(null==o)return null;var r=vi.calculateOrthogonalAndFlexionalLinkPoints(e,n,o,t._element);return vi.offsetLink(t,r),t.setHotSpot(vi.calculateCenterPoint(r)),"flexional"!==e&&vi.drawCorner(r,t._element),r},offsetLink:function(t,e){if(!t._element.isBundleAgent()){var i=vi.getBundleGap(t,!1);if(0!==i)for(var n,o,r=!1,a=!1,s=e.get(0),l=Me.clone(s),h=1,c=e.size();c>h;h++){var u=e.get(h),d=u.x-l.x,f=u.y-l.y;l=Me.clone(u),o=vi.calculateAngle(d,f),0===d?((o-n)%Math.PI==0&&(o-n)%(2*Math.PI)!=0&&(r=!r)&&(f=-f),(o-n)%Math.PI!=0&&(s.x+=0>f?i:-i),u.x+=0>f?i:-i):0===f&&((o-n)%Math.PI==0&&(o-n)%(2*Math.PI)!=0&&(a=!a)&&(d=-d),n&&(o-n)%Math.PI==0||(s.y-=0>d?i:-i),u.y-=0>d?i:-i),n=o,s=u}}},_getPointAngleDegree:function(t,e,i,n){var o=i-t,r=n-e,a=Math.atan2(r,o);return a=a/Math.PI*180,a=parseInt(a)+180,a%=360}};Me.link=vi;var yi={findMoveToBottomDatas:function(t,e,i){for(var n=0;n<i.size();n++){var o=i.get(n);t.contains(o)&&e.add(o)}for(n=0;n<i.size();n++)o=i.get(n),yi.findMoveToBottomDatas(t,e,o.getChildren())},findMoveToTopDatas:function(t,e,i){for(var n=0;n<i.size();n++){var o=i.get(i.size()-1-n);t.contains(o)&&e.add(o)}for(n=0;n<i.size();n++)o=i.get(n),yi.findMoveToTopDatas(t,e,o.getChildren())},findMoveUpDatas:function(t,e,i){for(var n=!1,o=0;o<i.size();o++){var r=i.get(o);t.contains(r)?n&&e.add(r):n=!0}for(o=0;o<i.size();o++)r=i.get(o),yi.findMoveUpDatas(t,e,r.getChildren())},findMoveDownDatas:function(t,e,i){for(var n=!1,o=0;o<i.size();o++){var r=i.get(i.size()-1-o);t.contains(r)?n&&e.add(r):n=!0}for(o=0;o<i.size();o++)r=i.get(o),yi.findMoveDownDatas(t,e,r.getChildren())},doLayout:function(t,e){e=e||{},e.type=e.type||"round",e.animate=e.animate||!0,e.elements=e.elements||new De.List,e.repulsion=e.repulsion||1,e.expandGroup=e.expandGroup||!1,new De.layout.AutoLayouter(t.getElementBox()).getElements=function(){}}};Me.box=yi;var wi={scrollLeft:function(){return wi._filterResults(t.pageXOffset?t.pageXOffset:0,ze.documentElement?ze.documentElement.scrollLeft:0,ze.body?ze.body.scrollLeft:0)},scrollTop:function(){return wi._filterResults(t.pageYOffset?t.pageYOffset:0,ze.documentElement?ze.documentElement.scrollTop:0,ze.body?ze.body.scrollTop:0)},_filterResults:function(t,e,i){var n=t||0;return e&&(!n||n>e)&&(n=e),i&&(!n||n>i)?i:n},isSingleTouch:function(t){return t.touches&&1==t.touches.length},isMultiTouch:function(t){return t.touches&&t.touches.length>1},getDistance:function(t){if(!wi.isMultiTouch(t))return 0;var e=t.touches[0],i=t.touches[1];return Math.sqrt(Math.pow(e.clientX-i.clientX,2)+Math.pow(e.clientY-i.clientY,2))},getCenterLocation:function(t){if(!wi.isMultiTouch(t))return 0;var e=t.touches[0],i=t.touches[1];return{x:(e.clientX+i.clientX)/2,y:(e.clientY+i.clientY)/2}}};Me.touch=wi;var bi={_string:function(t,e,i,n){var o=i._stringPool.get();o.style.whiteSpace="nowrap",o.style.verticalAlign="middle",o.style.padding="0px 2px",Me.setText(o,t,n),o.setAttribute("title",t),e.appendChild(o)},_boolean:function(t,e,i){var n=i._booleanPool.get();e._editInfo?(n._editInfo=e._editInfo,delete e._editInfo,n.disabled=!1):n.disabled=!0,n.keepDefault=!0,n.type="checkbox",n.style.margin="0px 2px",n.style.verticalAlign="middle",n.checked=t,e.appendChild(n),""===e.style.textAlign&&(e.style.textAlign="center")},_color:function(t,e,i){var n=i._colorPool.get();n.style.width="100%",n.style.height="100%",n.style.backgroundColor=t,n.setAttribute("title",t),e.appendChild(n)},_listPoints:function(t,e,i,n){var o=i._stringPool.get();o.style.whiteSpace="nowrap",o.style.verticalAlign="middle",o.style.padding="0px 2px";var r=t._as||t,a="";r.forEach(function(t,e){a+=e==r.length-1?"["+t.x+","+t.y+"]":"["+t.x+","+t.y+"],"}),t=a,Me.setText(o,t,n),o.setAttribute("title",t),e.appendChild(o)},render:function(t,e,i,n,o){if(null!=e){var r=bi["_"+t];r?r(e,i,n,o):"boolean"==typeof e?bi._boolean(e,i,n,o):e instanceof De.List?bi._listPoints(e,i,n,o):bi._string(e,i,n,o)}}};Me.render=bi;var xi={toolTipDiv:null,getToolTipDiv:function(){if(!xi.toolTipDiv){xi.toolTipDiv=ze.createElement("div");var t=kn,e=xi.toolTipDiv.style;e.position="absolute",e.color=t.TOOLTIP_COLOR,e.background=t.TOOLTIP_BACKGROUND,e.fontSize=t.TOOLTIP_FONT_SIZE,e.padding=t.TOOLTIP_PADDING,e.border=t.TOOLTIP_BORDER,e.borderRadius=t.TOOLTIP_BORDER_RADIUS,e.boxShadow=t.TOOLTIP_BOX_SHADOW,e.zIndex=t.TOOLTIP_ZINDEX,e.setProperty&&e.setProperty("-webkit-box-shadow",t.TOOLTIP_BOX_SHADOW,null)}return xi.toolTipDiv},isToolTipVisible:function(){return!!xi.getToolTipDiv().parentNode},hideToolTip:function(){if(xi._clearTimeout(),xi._clearDismiss(),xi.isToolTipVisible()){var t=xi.getToolTipDiv();t.parentNode&&t.parentNode.removeChild(t)}},showToolTip:function(t,e){return t&&e?void(xi.isToolTipVisible()||xi._reshow_timeout?xi._showToolTip(t,e):(xi._clearTimeout(),xi._show_timeout=setTimeout(function(){xi._showToolTip(t,e)},kn.TOOLTIP_INITIAL_DELAY))):void xi.hideToolTip()},_showToolTip:function(t,e){var i,n,o;if(t.target?(i=t.clientX,n=t.clientY):(i=t.x,n=t.y),o=xi.getToolTipDiv(),Xe.clear(o),e instanceof Element){var r=e.cloneNode(!0);o.appendChild(r)}else o.innerHTML=e;o.style.left=i+kn.TOOLTIP_XOFFSET+"px",o.style.top=n+kn.TOOLTIP_YOFFSET+"px",o.parentNode||ze.body.appendChild(o),xi._clearDismiss(),xi._dismiss_timeout=setTimeout(xi.hideToolTip,kn.TOOLTIP_DISMISS_DELAY),xi._clearReshow(),xi._reshow_timeout=setTimeout(xi._clearReshow,kn.TOOLTIP_RESHOW_DELAY)},_clearDismiss:function(){xi._dismiss_timeout&&(clearTimeout(xi._dismiss_timeout),xi._dismiss_timeout=null)},_clearReshow:function(){xi._reshow_timeout&&(clearTimeout(xi._reshow_timeout),xi._reshow_timeout=null)},_clearTimeout:function(){xi._show_timeout&&(clearTimeout(xi._show_timeout),xi._show_timeout=null)},resetToolTip:function(){xi.hideToolTip(),xi.toolTipDiv=null}};Me.popup=xi;var Ai={handleClicked:function(t,e,i){if(Ue.isTouchable||0===e.button)if(i){var n=Ci(i);n&&n.onClick&&n.onClick(i,t),t.onClickElement(i,e),t.fireInteractionEvent({kind:"clickElement",event:e,element:i})}else t.onClickBackground(e),t.fireInteractionEvent({kind:"clickBackground",event:e})},handleDoubleClicked:function(t,e,i){if((Ue.isTouchable||0===e.button)&&!t.isEditingElement()){if(i){var n=Ci(i);n&&n.onDoubleClick&&n.onDoubleClick(i,t),t.onDoubleClickElement(i,e),t.fireInteractionEvent({kind:"doubleClickElement",event:e,element:i})}else t.onDoubleClickBackground(e),t.fireInteractionEvent({kind:"doubleClickBackground",event:e});i?i instanceof De.Link&&t.isDoubleClickToLinkBundle()?i.ISubNetwork&&t.isDoubleClickToSubNetwork()&&!Me.isCtrlDown(e)?(t.isDoubleClickToEmptySubNetwork()||i.getChildrenSize()>0)&&t.setCurrentSubNetwork(i,t.isSubNetworkAnimate(),function(){t.fireInteractionEvent({kind:"enterSubNetwork",event:e,element:i})}):i.reverseBundleExpanded()&&t.fireInteractionEvent({kind:"bundleLink",event:e,element:i}):i.ISubNetwork&&t.isDoubleClickToSubNetwork()?(t.isDoubleClickToEmptySubNetwork()||i.getChildrenSize()>0)&&t.setCurrentSubNetwork(i,t.isSubNetworkAnimate(),function(){t.fireInteractionEvent({kind:"enterSubNetwork",event:e,element:i})}):i instanceof Mn&&t.isDoubleClickToGroupExpand()&&(i.reverseExpanded(),t.fireInteractionEvent({kind:"expandGroup",event:e,element:i})):t.isDoubleClickToUpSubNetwork()&&t.upSubNetwork(t.isSubNetworkAnimate(),function(){t.fireInteractionEvent({kind:"upSubNetwork",event:e})})}},handleKeyDown:function(t,e){Me.isCtrlDown(e)&&65==e.keyCode?(t.isKeyboardSelectEnabled()&&t.selectAll().size()>0&&t.fireInteractionEvent({kind:"selectAll"}),Xe.preventDefault(e)):46==e.keyCode?(t.isKeyboardRemoveEnabled()&&t.removeSelection()&&t.fireInteractionEvent({kind:"removeElement"}),Xe.preventDefault(e)):Me.showVersion(e)},handleLongClicked:function(t,e,i){if(Ue.isTouchable||0===e.button)if(i){var n=Ci(i);n&&n.onLongClick&&n.onLongClick(i,t),t.onLongClickElement(i,e),t.fireInteractionEvent({kind:"longClickElement",event:e,element:i})}else t.onLongClickBackground(e),t.fireInteractionEvent({kind:"longClickBackground",event:e})}},Ci=function(t){if(t&&t._image){if("object"==typeof t._image)return t._image;var e=Me.getImageAsset(t._image);if(e)return e._image}return null};Me.interaction=Ai;var Ti=function(t){return t.trim()[0].match(/[mlhvcsqta]/i)?Ri(t):Si(t)},ki={},Si=function(t){var e=ki[t];return e||(ki[t]=e=[],t.trim().split(" ").forEach(function(t){t=t.split(","),e.push(2===t.length?{x:parseFloat(t[0]),y:parseFloat(t[1])}:t[0])}),e)},Ei={},Ii=/[mlhvcsqtaz][\d.,\-\s]*/gi,Li=/-?(\d)+(\.(\d)+)?/g,Ri=function(t){var e,i=Ei[t];return i||(e=t.trim().match(Ii),Ei[t]=i=[],e&&e.forEach(function(t){var e,n=t[0],o=t.match(Li),r=o&&o.length;if(i.push(t={c:n}),r)switch(o.forEach(function(t,e){o[e]=parseFloat(t)}),n){case"M":case"m":case"L":case"l":for(e=0;r>e;e+=2)0!==e&&i.push(t={c:"M"===n||"L"===n?"L":"l"}),t.x=o[e],t.y=o[e+1];break;case"H":case"h":for(e=0;r>e;e++)0!==e&&i.push(t={c:n}),t.x=o[e];break;case"V":case"v":for(e=0;r>e;e++)0!==e&&i.push(t={c:n}),t.y=o[e];break;case"C":case"c":for(e=0;r>e;e+=6)0!==e&&i.push(t={c:n}),t.x1=o[e],t.y1=o[e+1],t.x2=o[e+2],t.y2=o[e+3],t.x=o[e+4],t.y=o[e+5];break;case"S":case"s":for(e=0;r>e;e+=4)0!==e&&i.push(t={c:n}),t.x2=o[e],t.y2=o[e+1],t.x=o[e+2],t.y=o[e+3];break;case"Q":case"q":for(e=0;r>e;e+=4)0!==e&&i.push(t={c:n}),t.x1=o[e],t.y1=o[e+1],t.x=o[e+2],t.y=o[e+3];break;case"T":case"t":for(e=0;r>e;e+=2)0!==e&&i.push(t={c:n}),t.x=o[e],t.y=o[e+1]}}),i)},Pi=function(t,e){var i,n,o,r,a,s,l,h,c,u,d,f,p=t.transform&&Oi(t.transform);return p&&p.length&&(i=He.identity(),p.forEach(function(t){var e=t[0];"matrix"===e?i.multiply(new He(t[1],t[2],t[3],t[4],t[5],t[6])):"translate"===e?i.translate(t[1]||0,t[2]||0):"scale"===e?i.scale(t[1]||1,t[2]||t[1]||1):"rotate"===e?i.rotate(t[1]||0,t[2]||0,t[3]||0):"skewX"===e?i.skew(t[1]||0,0):"skewY"===e&&i.skew(0,t[1]||0)})),"linear"===t.type?(r=t.x1||0,a=t.y1||0,s=t.x2||0,l=t.y2||0,i&&(n=i.transform(r,a),r=n.x,a=n.y,n=i.transform(s,l),s=n.x,l=n.y),o=e.createLinearGradient(r,a,s,l)):"radial"===t.type&&(h=t.fx||0,c=t.fy||0,u=t.cx||0,d=t.cy||0,f=t.r||0,null==t.fx&&(h=u),null==t.fy&&(c=d),i&&(n=i.transform(h,c),h=n.x,c=n.y,n=i.transform(u,d),u=n.x,d=n.y,f=Math.max(i._m11,i._m22)*f),o=e.createRadialGradient(h,c,0,u,d,f)),o&&t.stop&&t.stop.length&&t.stop.forEach(function(t){o.addColorStop(parseFloat(t.offset),gn(t.color,e._color))}),o},Oi=function(t){return t.replace(/[\s\r\t\n]+/gm," ").trim().replace(/\)(\s?,\s?)/g,") ").split(/\s(?=[a-z])/).map(function(t){return t.replace(")","").trim().split(/\s*\(\s*|\s+,?\s*|,\s*/).map(function(t,e){return 0===e?t:parseFloat(t)})})},Di=function(t,e,i,n,o,r,a){var s,l,h,c,u=1;"object"!=typeof e&&(l=e,s=Me.images[e],e=s&&s.getImage()),Ki(e)?t.drawImage(s?s.getImage(i,n.width,n.height):e,n.x,n.y,n.width,n.height):e&&"object"==typeof e&&(t._data=o,t._view=r,l?(h=n.width/(e.w&&Gi(o,e,e,"w")||o.getWidth()),c=n.height/(e.h&&Gi(o,e,e,"h")||o.getHeight()),r&&(u=r.getSizeZoom?r.getSizeZoom()*r.getGraphicsZoom():r.getZoom()),!s._cache||Math.max(h*u,c*u)>1?Mi(t,e,i,n,o,r,a):t.drawImage(i?s.getImage(i,n.width,n.height):s._cache,n.x,n.y,n.width,n.height)):Mi(t,e,i,n,o,r,a),t._data=null,t._view=null)},Mi=function(t,e,i,n,o,r,a){var s,l,h,c,u,d,f,p,g,_,m,v,y,w,b,x,A,C,T,k=o&&o.getStyle("image.state");if(g=t._vector,x=t._color,_=t._fill,m=t._pattern,v=t._lineWidth,y=t._alpha,w=t._sx,b=t._sy,d=e,!1!==Gi(o,d,d,"visible",r)){for(t._color=i,s=Gi(o,d,d,"v",r),l=s&&s.length,C=d.w&&Gi(o,d,d,"w")||o.getWidth(),T=d.h&&Gi(o,d,d,"h")||o.getHeight(),f=n.width/C,p=n.height/T,!0===a?(t._fill=null,t._pattern=null,t._lineWidth=null,t._alpha=null):(t._sx=f,t._sy=p),t.save(),t.translate(n.x+n.width/2,n.y+n.height/2),(1!==f||1!==p)&&t.scale(f,p),d.origin&&t.translate((d.origin.x-.5)*C,(d.origin.y-.5)*T),t._vector=d,d.clip&&(t.beginPath(),!0===d.clip?t.rect(-(d.origin?d.origin.x:.5)*C,-(d.origin?d.origin.y:.5)*T,C,T):d.clip.length?d.clip.forEach(function(e){t.drawShape(e)}):t.drawShape(d.clip),t.clip()),Vi(o,d,d,t,r),h=0,l=s.length;l>h;h++)u=s[h],t._shapeData=u,r&&(r._shapeDataIndex=h,u.animate&&xe(u,d,o,r)),A=Gi(o,d,u,"state",r),!1===Gi(o,d,u,"visible",r)||A&&!(Array.isArray(A)?A.indexOf(k)>=0:A===k)||(c=Bi[u.shape])&&(t.save(),"vector"===u.shape||"g"===u.shape?c(t,u,o,r):Vi(o,d,u,t,r,function(){c(t,u,o,r)}),t.restore()),r&&(r._shapeDataIndex=null),t._shapeData=null;t.restore(),t._vector=g,t._shapeData=null,t._color=x,t._fill=_,t._pattern=m,t._lineWidth=v,t._alpha=y,t._sx=w,t._sy=b}},Ni=function(t,e,i,n,o){var r,a,s,l,h,c,u,d,f,p=t._vector,g=p.origin,_=p.w&&Gi(n,p,p,"w")||n.getWidth(),m=p.h&&Gi(n,p,p,"h")||n.getHeight();if("string"==typeof e?(f=Me.images[e])&&(s=f.getWidth(),l=f.getHeight()):(s=e.w&&Gi(n,e,e,"w"),l=e.h&&Gi(n,e,e,"h")),s&&l&&i)for(h=i.w/s*t._sx,c=i.h/l*t._sy,r=i.x-_/2*(t._sx-1),a=i.y-m/2*(t._sy-1),g&&(r-=(g.x-.5)*_*(t._sx-1),a-=(g.y-.5)*m*(t._sy-1)),(1!==t._sx||1!==t._sy)&&(t.scale(1/t._sx,1/t._sy),r+=((g?g.x:.5)*_+i.x)*(t._sx-1),a+=((g?g.x:.5)*m+i.y)*(t._sy-1)),i={x:0,y:0,width:s,height:l},u=0;h>u;u++)for(d=0;c>d;d++)i.x=u*s+r,i.y=d*l+a,Di(t,e,null,i,n,o,!0)},Bi={line:function(t,e,i,n){var o,r,a,s,l=Gi(i,t._vector,e,"p1",n),h=Gi(i,t._vector,e,"p2",n);l?(o=Zi(l.length?l[0]:l.x,t),r=Xi(l.length?l[1]:l.y,t)):(o=Gi(i,t._vector,e,"x1",n,!0),r=Gi(i,t._vector,e,"y1",n,!1)),h?(a=Zi(h.length?h[0]:h.x,t),s=Xi(h.length?h[1]:h.y,t)):(a=Gi(i,t._vector,e,"x2",n,!0),s=Gi(i,t._vector,e,"y2",n,!1)),t.moveTo(o,r),t.lineTo(a,s)},rect:function(t,e,i,n){var o,r,a,s,l=Gi(i,t._vector,e,"rect",n),h=Gi(i,t._vector,e,"r",n);l?(Array.isArray(l)?(o=l[0],r=l[1],a=l[2],s=l[3]):(o=l.x,r=l.y,a=l.w,s=l.h),o=Zi(o,t),r=Xi(r,t),a=Zi(a,t),s=Xi(s,t)):(o=Gi(i,t._vector,e,"x",n,!0),r=Gi(i,t._vector,e,"y",n,!1),a=Gi(i,t._vector,e,"w",n,!0),s=Gi(i,t._vector,e,"h",n,!1)),t.drawRoundRect(o,r,a,s,h),(t._gradientFunc||t._pattern)&&(t._rect={x:o,y:r,w:a,h:s})},circle:function(t,e,i,n){var o=Gi(i,t._vector,e,"cx",n,!0),r=Gi(i,t._vector,e,"cy",n,!1),a=t._vector.w&&Gi(i,t._vector,t._vector,"w")||i.getWidth(),s=t._vector.h&&Gi(i,t._vector,t._vector,"h")||i.getHeight(),l=Yi(Gi(i,t._vector,e,"r",n),Math.min(a,s),e,t._vector),h=Gi(i,t._vector,e,"startAngle",n),c=Gi(i,t._vector,e,"endAngle",n),u=Gi(i,t._vector,e,"anticlockwise",n),d=Gi(i,t._vector,e,"close",n);null==h&&(h=0),null==c&&(c=360),null==u&&(u=!1),d&&t.moveTo(o,r),t.arc(o,r,l,h/180*Math.PI,c/180*Math.PI,u),d&&t.closePath(),(t._gradientFunc||t._pattern)&&(t._rect={x:o-l,y:r-l,w:2*l,h:2*l})},ellipse:function(t,e,i,n){var o=Gi(i,t._vector,e,"cx",n,!0),r=Gi(i,t._vector,e,"cy",n,!1),a=Gi(i,t._vector,e,"rx",n,!0),s=Gi(i,t._vector,e,"ry",n,!1),l=Gi(i,t._vector,e,"startAngle",n),h=Gi(i,t._vector,e,"endAngle",n),c=Gi(i,t._vector,e,"anticlockwise",n),u=Gi(i,t._vector,e,"close",n);null==l&&(l=0),null==h&&(h=360),null==c&&(c=!1),u&&t.moveTo(o,r),t.ellipse(o,r,a,s,0,l/180*Math.PI,h/180*Math.PI,c),u&&t.closePath(),(t._gradientFunc||t._pattern)&&(t._rect={x:o-a,y:r-s,w:2*a,h:2*s})},path:function(t,e,i,n){var o=Gi(i,t._vector,e,"data",n);t.drawPath(o)},text:function(t,e,i,n){var o=Gi(i,t._vector,e,"text",n),r=Gi(i,t._vector,e,"x",n,!0),a=Gi(i,t._vector,e,"y",n,!1),s=Gi(i,t._vector,e,"w",n,!0);if(null!=o){o=String(o);var l=o.split("\n"),h=2*t.measureText("e").width,c=be(t,o,s);a-=(c.h/h-1)/2*h,l.forEach(function(e){if(s){var i,n,o,l,c,u=e.split(" "),d=u.length,f="";for(o=0;d>o;o++)if(i=u[o]+(o===d-1?"":" "),n=f+i,l=t.measureText(n).width,s>l)f=n;else if(l==s)t.fillText(f,r,a),f="",a+=h;else{for(c=0;c<i.length;c++)if(n=f+i.substr(0,c+1),t.measureText(n).width>s){t.fillText(n.substring(0,n.length-1),r,a),f=i.substring(c,i.length),a+=h;break}for(;f.length>0&&t.measureText(f).width>s;)for(c=0;c<f.length;c++)if(n=f.substr(0,c+1),t.measureText(n).width>s){t.fillText(f.substr(0,c),r,a),f=f.substring(c,f.length),a+=h;break}}t.fillText(f,r,a)}else t.fillText(e,r,a);a+=h})}},draw:function(t,e,i,n){var o,r,a=e.draw;"string"==typeof a&&((o=a.match(Hi))?(r="with(data) { "+o[1]+" }",a=De.Util.newFunction("g","data","view",r)):a=Ji[a]),"function"==typeof a&&a.call(t._vector,t,i,n)},vector:function(t,e,i,n){var o,r,a,s,l,h,c,u,d,f,p,g,_,m=t._vector,v=Gi(i,m,e,"name",n),y=Gi(i,m,e,"x",n,!0),w=Gi(i,m,e,"y",n,!1),b=Gi(i,m,e,"w",n),x=Gi(i,m,e,"h",n);if("string"==typeof v?(u=Me.images[v],c=u&&u._image):c=v,c)if(Ki(c))null!=b&&null!=x?t.drawImage(c,y,w,Zi(b,t),Xi(x,t)):t.drawImage(c,y,w);else{for(d=Gi(i,c,c,"v",n),f=d&&d.length,p=c.w&&Gi(i,c,c,"w"),g=c.h&&Gi(i,c,c,"h"),null!=b&&null!=x?(b=Zi(b,t),x=Xi(x,t)):(b=p,x=g),t.save(),s=t._lineWidth,l=t._fill,h=t._alpha,Vi(i,c,c,t,n),Vi(i,m,e,t,n),t.translate(y,w),t.scale(b/p,x/g),c.origin&&t.translate((c.origin.x-.5)*p,(c.origin.y-.5)*g),c.clip&&(t.beginPath(),!0===c.clip?t.rect(-(c.origin?c.origin.x:.5)*p,-(c.origin?c.origin.y:.5)*g,p,g):c.clip.length?c.clip.forEach(function(e){t.drawShape(e)}):t.drawShape(c.clip),t.clip()),_=t._shapeData,t._vector=c,o=0;f>o;o++)r=d[o],t._shapeData=r,n&&(n._shapeDataIndex.length?n._shapeDataIndex.push(o):n._shapeDataIndex=[n._shapeDataIndex,o],r.animate&&xe(r,m,i,n)),!1!==Gi(i,c,r,"visible",n)&&(a=Bi[r.shape])&&(t.save(),"vector"===r.shape||"g"===r.shape?a(t,r,i,n):Vi(i,c,r,t,n,function(){a(t,r,i,n)}),t.restore()),n&&n._shapeDataIndex.pop();t._vector=m,t._shapeData=_,t._lineWidth=s,t._fill=l,t._alpha=h,t.restore()}},g:function(t,e,i,n){var o,r,a,s,l,h=Gi(i,t._vector,e,"v",n);h&&h.length&&(t.save(),r=t._lineWidth,a=t._fill,s=t._alpha,l=t._shapeData,Vi(i,t._vector,e,t,n),h.forEach(function(e){!1!==Gi(i,t._vector,e,"visible",n)&&(o=Bi[e.shape])&&(t.save(),t._shapeData=e,"vector"===e.shape||"g"===e.shape?o(t,e,i,n):Vi(i,t._vector,e,t,n,function(){o(t,e,i,n)}),t.restore())}),t._lineWidth=r,t._fill=a,t._alpha=s,t._shapeData=l,t.restore())}};Bi.image=Bi.vector;var Fi=Object.keys(Bi),zi={M:function(t,e){return t.moveTo(e.x,e.y),t._path_start=e,t._rect&&qi(t._rect,e.x,e.y),e},m:function(t,e,i){return i&&(e={x:i.x+e.x,y:i.y+e.y}),t.moveTo(e.x,e.y),t._path_start=e,t._rect&&qi(t._rect,e.x,e.y),e},Z:function(t){return t.closePath(),t._path_start},z:function(t){return t.closePath(),t._path_start},L:function(t,e){return t.lineTo(e.x,e.y),t._rect&&qi(t._rect,e.x,e.y),e},l:function(t,e,i){var n={x:i.x+e.x,y:i.y+e.y};return t.lineTo(n.x,n.y),t._rect&&qi(t._rect,n.x,n.y),n},H:function(t,e,i){var n={x:e.x,y:i.y};return t.lineTo(n.x,n.y),t._rect&&qi(t._rect,n.x,n.y),n},h:function(t,e,i){var n={x:i.x+e.x,y:i.y};return t.lineTo(n.x,n.y),t._rect&&qi(t._rect,n.x,n.y),n},V:function(t,e,i){var n={x:i.x,y:e.y};return t.lineTo(n.x,n.y),t._rect&&qi(t._rect,n.x,n.y),n},v:function(t,e,i){var n={x:i.x,y:i.y+e.y};return t.lineTo(n.x,n.y),t._rect&&qi(t._rect,n.x,n.y),n},Q:function(t,e){return t._preQ_x=e.x1,t._preQ_y=e.y1,t.quadraticCurveTo(e.x1,e.y1,e.x,e.y),t._rect&&(qi(t._rect,e.x1,e.y1),qi(t._rect,e.x,e.y)),e},q:function(t,e,i){var n={x:i.x+e.x,y:i.y+e.y},o=t._preQ_x=i.x+e.x1,r=t._preQ_y=i.y+e.y1;return t.quadraticCurveTo(o,r,n.x,n.y),t._rect&&(qi(t._rect,o,r),qi(t._rect,n.x,n.y)),n},T:function(t,e,i){var n=t._preQ_x=2*i.x-t._preQ_x,o=t._preQ_y=2*i.y-t._preQ_y;return t.quadraticCurveTo(n,o,e.x,e.y),t._rect&&(qi(t._rect,n,o),qi(t._rect,e.x,e.y)),e},t:function(t,e,i){var n={x:i.x+e.x,y:i.y+e.y},o=t._preQ_x=2*i.x-t._preQ_x,r=t._preQ_y=2*i.y-t._preQ_y;return t.quadraticCurveTo(o,r,n.x,n.y),t._rect&&(qi(t._rect,o,r),qi(t._rect,n.x,n.y)),n},C:function(t,e){return t._preC_x=e.x2,t._preC_y=e.y2,t.bezierCurveTo(e.x1,e.y1,e.x2,e.y2,e.x,e.y),t._rect&&(qi(t._rect,e.x1,e.y1),qi(t._rect,e.x2,e.y2),qi(t._rect,e.x,e.y)),e},c:function(t,e,i){var n={x:i.x+e.x,y:i.y+e.y},o=i.x+e.x1,r=i.y+e.y1,a=t._preC_x=i.x+e.x2,s=t._preC_y=i.y+e.y2;return t.bezierCurveTo(o,r,a,s,n.x,n.y),t._rect&&(qi(t._rect,o,r),qi(t._rect,a,s),qi(t._rect,n.x,n.y)),n},S:function(t,e,i){var n=2*i.x-t._preC_x,o=2*i.y-t._preC_y;return t._preC_x=e.x2,t._preC_y=e.y2,t.bezierCurveTo(n,o,e.x2,e.y2,e.x,e.y),t._rect&&(qi(t._rect,n,o),qi(t._rect,e.x2,e.y2),qi(t._rect,e.x,e.y)),e},s:function(t,e,i){var n={x:i.x+e.x,y:i.y+e.y},o=2*i.x-t._preC_x,r=2*i.y-t._preC_y,a=t._preC_x=i.x+e.x2,s=t._preC_y=i.y+e.y2;return t.bezierCurveTo(o,r,a,s,n.x,n.y),t._rect&&(qi(t._rect,o,r),qi(t._rect,a,s),qi(t._rect,n.x,n.y)),n}},Vi=function(t,e,i,n,o,r){var a,s,l,h,c,u,d,f,p,g,_,m,v,y=Gi(t,e,i,"line",o),w=Gi(t,e,i,"fill",o),b=Gi(t,e,i,"fillRule",o)||"nonzero",x=Gi(t,e,i,"gradient",o),A=Gi(t,e,i,"gradientColor",o),C=Gi(t,e,i,"pattern",o),T=Gi(t,e,i,"font",o),k=Gi(t,e,i,"textAlign",o)||"center",S=Gi(t,e,i,"textBaseline",o)||"middle",E=Gi(t,e,i,"translate",o),I=Gi(t,e,i,"rotate",o),L=Gi(t,e,i,"rotateOrigin",o),R=Gi(t,e,i,"scale",o),P=Gi(t,e,i,"transform",o),O=Gi(t,e,i,"alpha",o),D=n._lineWidth,M=n._fill,N=n._pattern,B=n._alpha,F=n._gradientFunc;if(y?(a=y.color,s=y.width,l=y.cap,h=y.join,c=y.miterLimit,u=y.dash,d=y.dashOffset):(a=Gi(t,e,i,"lineColor",o),s=Gi(t,e,i,"lineWidth",o),l=Gi(t,e,i,"lineCap",o),h=Gi(t,e,i,"lineJoin",o),c=Gi(t,e,i,"miterLimit",o),u=Gi(t,e,i,"lineDash",o),d=Gi(t,e,i,"lineDashOffset",o)),null!=a&&(n.strokeStyle=gn(a,n._color)),null!=s&&(n.lineWidth=n._lineWidth=o&&o.getSizeZoom&&!o.zoomManager.sizeChange?s/o.getSizeZoom():s),null!=l&&(n.lineCap=l),null!=h&&(n.lineJoin=h),null!=c&&(n.miterLimit=c),null!=u&&(n.lineDash=u,n.setLineDash(u)),null!=d&&(n.lineDashOffset=d),C?n._pattern=C:(w&&(n.fillStyle=n._fill=gn(w,n._color)),x&&("string"==typeof x?p=$e[x]:(p=$e[x.type],x.color&&(A=x.color),p||(x=Pi(x,n))),n._gradientFunc=p)),null!=T&&(n.font=T),null!=k&&(n.textAlign=k),null!=S&&(n.textBaseline=S),Ui(t,e,i,n,o),null!=P)"string"==typeof P&&(P=Oi(P)),P.length&&P.forEach(function(t){var e=t[0];"matrix"===e?n.transform(t[1],t[2],t[3],t[4],t[5],t[6]):"translate"===e?n.translate(t[1]||0,t[2]||0):"scale"===e?n.scale(t[1]||1,t[2]||t[1]||1):"rotate"===e?t.length>2?(n.translate(t[2],t[3]),n.rotate(t[1]),n.translate(-t[2],-t[3])):n.rotate(t[1]):"skewX"===e?n.transform(1,0,Math.tan(t[1]*Math.PI/180),1,0,0):"skewY"===e&&n.transform(1,Math.tan(t[1]*Math.PI/180),0,1,0,0)});else{if(null!=E&&(Array.isArray(E)?(m=E[0],v=E[1]):"object"==typeof E?(m=E.x,v=E.y):(m=E,v=0),m=Zi(m,n),v=Xi(v,n),(0!==m||0!==v)&&n.translate(m,v)),null!=I&&I%360!=0){var z,V;L&&(Array.isArray(L)?(z=L[0],V=L[1]):"object"==typeof L?(z=L.x,V=L.y):z=V=L,z=Zi(z,n),V=Xi(V,n),(0!==z||0!==V)&&n.translate(z,V)),n.rotate(I*Math.PI/180),L&&(0!==z||0!==V)&&n.translate(-z,-V)}null!=R&&(Array.isArray(R)?(g=R[0],_=R[1]):"object"==typeof R?(g=R.x,_=R.y):g=_=R,(1!==g||1!==_)&&n.scale(g,_))}null!=O&&(n.globalAlpha=n._alpha=null!=B?B*O:O),r&&(n.beginPath(),r(),f=n._rect||i.rect,n._pattern?(n._lineWidth>0&&n.stroke(),n.clip(),Ni(n,n._pattern,f,t,o)):(p&&f&&(x=p(n,gn(w||"#000000",n._color),gn(A||"#FFFFFF",n._color),f.x,f.y,f.w,f.h)),x&&(n.fillStyle=n._fill=x),n._fill&&n.fill(b),n._lineWidth>0&&n.stroke()),n._lineWidth=D,n._fill=M,n._pattern=N,n._alpha=B,n._gradientFunc=F,n._rect=null)},Ui=function(t,e,i,n,o){var r,a,s,l,h=Gi(t,e,i,"shadow",o);h?(r=h.offsetX,a=h.offsetY,s=h.blur,l=h.color):(r=Gi(t,e,i,"shadowOffsetX",o),a=Gi(t,e,i,"shadowOffsetY",o),s=Gi(t,e,i,"shadowBlur",o),l=Gi(t,e,i,"shadowColor",o)),null!=r&&(n.shadowOffsetX=r),null!=a&&(n.shadowOffsetY=a),null!=s&&(n.shadowBlur=s),null!=l&&(n.shadowColor=l)},ji=/<%=([\s\S]+?)%>/,Hi=/<%([\s\S]+?)%>/,Wi=new RegExp([ji.source,Hi.source].join("|")),Gi=function(t,i,n,o,r,a,s){var l,h,c,u,d,f=n[o],p=typeof f;if("string"===p&&(l=f.match(Wi))?(h="with(data) { "+(l[1]?"return "+l[1]:l[2])+" }",c=De.Util.newFunction("data","view",h),f=c.call(i,t,r)):"function"===p&&(f=f.call(i,t,r)),!0===a?(u=i.w&&Gi(t,i,i,"w")||t.getWidth(),(!0===n.rel||n.rel===e&&i.rel)&&1>=f&&f>=-1?f*=u:"string"==typeof f&&(f=parseInt(f)/100*u),f=f||0):!1===a&&(d=i.h&&Gi(t,i,i,"h")||t.getHeight(),(!0===n.rel||n.rel===e&&i.rel)&&1>=f&&f>=-1?f*=d:"string"==typeof f&&(f=parseInt(f)/100*d),f=f||0),!1!==s&&r&&t&&n.animate&&t._animates){var g,_=t._animates,m=r._shapeDataIndex;if(m.length)for(var v=0;v<m.length;v++)g=m[v],_=_[g];else g=m;var y=_[g],w=y[o];if(w)if(Array.isArray(w))for(var v=w.length-1;v>=0;v--){var b=w[v];if((b.stopped||b.time>0)&&b.started)return Oe(b,f)}else if(w.started)return Oe(w,f)}return f},Zi=function(t,i){if(!t)return 0;var n=i._vector.w&&Gi(i._data,i._vector,i._vector,"w")||i._data.getWidth();return(i._shapeData&&!0===i._shapeData.rel||(!i._shapeData||i._shapeData.rel===e)&&i._vector.rel)&&1>=t&&t>=-1?t*n:"string"==typeof t?parseInt(t)/100*n:t},Xi=function(t,i){if(!t)return 0;var n=i._vector.h&&Gi(i._data,i._vector,i._vector,"h")||i._data.getHeight();return(i._shapeData&&!0===i._shapeData.rel||(!i._shapeData||i._shapeData.rel===e)&&i._vector.rel)&&1>=t&&t>=-1?t*n:"string"==typeof t?parseInt(t)/100*n:t},Yi=function(t,i,n,o){return t?(!0===n.rel||n.rel===e&&o.rel)&&1>=t&&t>=-1?t*i:"string"==typeof t?parseInt(t)/100*i:t:0},$i=(t.CanvasRenderingContext2D||Be.Context2d).prototype;$i.drawShape=function(t){var e=this,i=e._vector,n=e._shapeData,o=e._data,r=e._view,a=Bi[t.shape];a&&(e.save(),e._shapeData=t,"vector"===t.shape||"g"===t.shape?a(e,t,o,r):Vi(o,i,t,e,r,function(){a(e,t,o,r)}),e._shapeData=n,e.restore())},$i.drawPath=function(t){var e,i,n,o,r,a,s,l,h,c,u,d,f=this;if("string"==typeof t&&(t=Ti(t)),!(1>=(h=t?t.length:0))){if((f._gradientFunc||f._pattern)&&(f._rect=c={x:0,y:0,w:0,h:0}),e=t&&t[0]&&t[0].c,e||(i=t&&t[0]&&null!=t[0].x,(n="z"===t[h-1]||"Z"===t[h-1])&&h--),e){for(o=0;h>o;o++)a=t[o],(s=zi[a.c])&&(r=s(f,a,r));f._path_start=null,f._preC_x=null,f._preC_y=null,f._preQ_x=null,f._preQ_y=null}else if(i){for(l=t[0],u=Zi(l.x,f),d=Xi(l.y,f),f.moveTo(u,d),c&&qi(c,u,d),o=1;h>o;o++)l=t[o],u=Zi(l.x,f),d=Xi(l.y,f),f.lineTo(u,d),c&&qi(c,u,d);n&&f.closePath()}else{for(u=Zi(t[0],f),d=Xi(t[1],f),f.moveTo(u,d),c&&qi(c,u,d),o=2;h>o;o+=2)u=Zi(t[o],f),d=Xi(t[o+1],f),f.lineTo(u,d),c&&qi(c,u,d);n&&f.closePath()}return t}};var qi=function(t,e,i){var n=Math.min(t.x,e),o=Math.max(t.x+t.w,e),r=Math.min(t.y,i),a=Math.max(t.y+t.h,i);t.x=n,t.y=r,t.w=o-n,t.h=a-r};$i._fillPath=function(t,e){var i=this;i.beginPath(),i.fillStyle=t,i.drawPath(e),i.fill()},$i._fillRect=function(t,e,i,n,o){var r=this;r.beginPath(),r.fillStyle=t,r.rect(e,i,n,o),r.fill()},$i.ellipse||($i.ellipse=function(t,e,i,n){var o=this,r=.5522848,a=i*r,s=n*r,l=t+i,h=e+n,c=t-i,u=e-n;o.moveTo(c,e),o.bezierCurveTo(c,e-s,t-a,u,t,u),o.bezierCurveTo(t+a,u,l,e-s,l,e),o.bezierCurveTo(l,e+s,t+a,h,t,h),o.bezierCurveTo(t-a,h,c,e+s,c,e)}),$i.drawRoundRect=function(t,e,i,n,o){var r=this;if(!o)return void r.rect(t,e,i,n);var a,s,l,h;if(Array.isArray(o))if(1===o.length)a=s=l=h=o[0];else if(2===o.length)a=s=o[0],l=h=o[1];else{if(4!==o.length)return void r.rect(t,e,i,n);a=o[0],s=o[1],l=o[2],h=o[3]}else a=s=l=h=o;var c=t+i,u=e+n,d=n>i?2*i:2*n;a=d>a?a:d,s=d>s?s:d,l=d>l?l:d,h=d>h?h:d;var f=.292893218813453*h,p=.585786437626905*h;r.moveTo(c,u-h),r.quadraticCurveTo(c,u-p,c-f,u-f),r.quadraticCurveTo(c-p,u,c-h,u),f=.292893218813453*l,p=.585786437626905*l,r.lineTo(t+l,u),r.quadraticCurveTo(t+p,u,t+f,u-f),r.quadraticCurveTo(t,u-p,t,u-l),f=.292893218813453*a,p=.585786437626905*a,r.lineTo(t,e+a),r.quadraticCurveTo(t,e+p,t+f,e+f),r.quadraticCurveTo(t+p,e,t+a,e),f=.292893218813453*s,p=.585786437626905*s,r.lineTo(c-s,e),r.quadraticCurveTo(c-p,e,c-f,e+f),r.quadraticCurveTo(c,e+p,c,e+s),r.lineTo(c,u-h)};var Ki=function(t){return Be?t instanceof Be||t instanceof Ve:t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement},Ji={},Qi=function(t,e){"function"==typeof e&&(Ji[t]=e)},tn=function(t,e){"function"==typeof e&&Fi.indexOf(t)<0&&(Bi[t]=e)};!function(){for(var e=["webkit","moz"],i=0;i<e.length&&!t.requestAnimationFrame;++i){var n=e[i];t.requestAnimationFrame=t[n+"RequestAnimationFrame"],t.cancelAnimationFrame=t[n+"CancelAnimationFrame"]||t[n+"CancelRequestAnimationFrame"]}if(/iP(ad|hone|od).*OS 6/.test(t.navigator.userAgent)||!t.requestAnimationFrame||!t.cancelAnimationFrame){var o=0;t.requestAnimationFrame=function(t){var e=Date.now(),i=Math.max(o+16,e);return setTimeout(function(){t(o=i)},i-e)},t.cancelAnimationFrame=clearTimeout}}();var en=De.Animate=function(t){var e=this;e.type=null==t.type?"number":t.type,e.delay=null==t.delay?0:t.delay,e.dur=null==t.dur?1e3:t.dur,e.interval=null==t.interval?0:t.interval,e.finish=null==t.finish?e.delay+e.dur+e.interval:t.finish,null==t.finish?e.finish=e.delay+e.dur+e.interval:(e.finish=t.finish,e.interval=e.finish-e.delay-e.dur),e.repeat=null==t.repeat?1:t.repeat,e.reverse=null==t.reverse||t.reverse,e.easing=null==t.easing?"easeNone":t.easing,e.onUpdate=t.onUpdate,e.onDone=t.onDone,e.onStop=t.onStop,e.onPlay=t.onPlay,e.attr=t.attr,e.source=t.source,e.filter=t.filter,e.from=t.from,e.to=t.to,e.start=null,e.time=0,e.total=0,e.count=0,e.started=!1,e.stopped=!1,e.paused=!1,e.pausedTime=null,e.pausedTotal=0,e._speed=1,e._oldSpeed=null,e._speedTotal=0,e._speedTime=null,e._percent=0,e._percentSet=null,e._percentDiff=0,e.id=on++};Me.ext("twaver.Animate",Object,{play:function(){return Ce(this)},stop:function(t){return Te(this,t)},pause:function(){this.stopped||(this.paused=!0)},resume:function(){this.paused&&(this.paused=!1,rn=!0)},isPaused:function(){return this.paused},percent:function(t){return null==t?this._percentSet||this._percent:(this._percentSet=0>t?0:t>100?100:t,this.paused&&(rn=!0),this.started||(this.play(),this.pause()),this)},speed:function(t){return null==t?this._speed:(t=0>t?1:t,t!==this.speed&&(this.stopped||(this._oldSpeed=this._speed),this._speed=t),this)},clone:function(){return new en(this)},chain:function(t){var e,i=this;return i.next=t,t.pre=i,i.onDone?(e=i.onDone,i.onDone=function(){e.call(i),t.play()}):i.onDone=function(){t.play()},i}});var nn={},on=1,rn=!1;!function t(e){De.animateLoopId=requestAnimationFrame(t),rn&&(rn=!1,Ie(e))}(0);var an={easeNone:function(t,e,i,n){return i*t/n+e},easeIn:function(t,e,i,n){return i*(t/=n)*t+e},easeOut:function(t,e,i,n){return-i*(t/=n)*(t-2)+e},easeBoth:function(t,e,i,n){return(t/=n/2)<1?i/2*t*t+e:-i/2*(--t*(t-2)-1)+e},easeInStrong:function(t,e,i,n){return i*(t/=n)*t*t*t+e},easeOutStrong:function(t,e,i,n){return-i*((t=t/n-1)*t*t*t-1)+e},easeBothStrong:function(t,e,i,n){return(t/=n/2)<1?i/2*t*t*t*t+e:-i/2*((t-=2)*t*t*t-2)+e},elasticIn:function(t,e,i,n,o,r){var a;return 0===t?e:1==(t/=n)?e+i:(r||(r=.3*n),!o||o<Math.abs(i)?(o=i,a=r/4):a=r/(2*Math.PI)*Math.asin(i/o),-o*Math.pow(2,10*(t-=1))*Math.sin(2*(t*n-a)*Math.PI/r)+e)},elasticOut:function(t,e,i,n,o,r){var a;return 0===t?e:1==(t/=n)?e+i:(r||(r=.3*n),!o||o<Math.abs(i)?(o=i,a=r/4):a=r/(2*Math.PI)*Math.asin(i/o),o*Math.pow(2,-10*t)*Math.sin(2*(t*n-a)*Math.PI/r)+i+e)},elasticBoth:function(t,e,i,n,o,r){var a;return 0===t?e:2==(t/=n/2)?e+i:(r||(r=.3*n*1.5),!o||o<Math.abs(i)?(o=i,a=r/4):a=r/(2*Math.PI)*Math.asin(i/o),1>t?-.5*o*Math.pow(2,10*(t-=1))*Math.sin(2*(t*n-a)*Math.PI/r)+e:o*Math.pow(2,-10*(t-=1))*Math.sin(2*(t*n-a)*Math.PI/r)*.5+i+e)},backIn:function(t,i,n,o,r){return r===e&&(r=1.70158),t===o&&(t-=.001),n*(t/=o)*t*((r+1)*t-r)+i},backOut:function(t,e,i,n,o){return void 0===o&&(o=1.70158),i*((t=t/n-1)*t*((o+1)*t+o)+1)+e},backBoth:function(t,e,i,n,o){return void 0===o&&(o=5.70158),(t/=n/2)<1?i/2*t*t*((1+(o*=1.525))*t-o)+e:i/2*((t-=2)*t*((1+(o*=1.525))*t+o)+2)+e},bounceIn:function(t,e,i,n){return i-an.bounceOut(n-t,0,i,n)+e},bounceOut:function(t,e,i,n){return(t/=n)<1/2.75?7.5625*i*t*t+e:2/2.75>t?i*(7.5625*(t-=1.5/2.75)*t+.75)+e:2.5/2.75>t?i*(7.5625*(t-=2.25/2.75)*t+.9375)+e:i*(7.5625*(t-=2.625/2.75)*t+.984375)+e},bounceBoth:function(t,e,i,n){return n/2>t?.5*an.bounceIn(2*t,0,i,n)+e:.5*an.bounceOut(2*t-n,0,i,n)+.5*i+e}},sn={draw:function(t,e){var i=null==e.getCurrentSubNetwork()?e.getElementBox():e.getCurrentSubNetwork(),n=i.getStyle("background.type");"image"==n?this.drawImage(t,i,e):"vector"==n?this.drawVector(t,i,e):"image.vector"==n?(this.drawImage(t,i,e),this.drawVector(t,i,e)):"vector.image"==n&&(this.drawVector(t,i,e),this.drawImage(t,i,e))},drawImage:function(t,e,i){var n=e.getStyle("background.image"),o=Me.getImageAsset(n),r=i.getGraphicsZoom?i.getGraphicsZoom():i.getZoom();if(null!=o){var a=e.getStyle("background.image.scope"),s=i.getScopeRect(a),l=i._dragToPan?0:-s.x/r,h=i._dragToPan?0:-s.y/r;("rootcanvas"==a||"viewport"==a)&&(s.x=l,s.y=h),"rootcanvas"==a&&(s.width=Math.max(o.getWidth(),s.width/r),s.height=Math.max(o.getHeight(),s.height/r)),"none"==e.getStyle("background.image.stretch")&&(s.width=o.getWidth(),s.height=o.getHeight());var c=e.getStyle("background.image.padding");if(c&&We.grow(s,c,c),"tile"==e.getStyle("background.image.stretch")){if(Ki(o.getImage()))for(var u=0;u<s.width;u+=o.getWidth())for(var d=0;d<s.height;d+=o.getHeight())t.drawImage(o.getImage(),u,d)}else("fill"==e.getStyle("background.image.stretch")||"none"==e.getStyle("background.image.stretch"))&&Di(t,o.getImage(),null,s,e,i)}},drawVector:function(t,e,i){var n=e.getStyle("background.vector.scope"),o=i.getScopeRect(n),r=i.getGraphicsZoom?i.getGraphicsZoom():i.getZoom(),a=i._dragToPan?0:-o.x/r,s=i._dragToPan?0:-o.y/r;("rootcanvas"==n||"viewport"==n)&&(o.x=a,o.y=s),"rootcanvas"==n&&(o.width=o.width/r,o.height=o.height/r);var l=e.getStyle("background.outline.width"),h=(e.getStyle("background.outline.color"),e.getStyle("background.vector.fill")),c=e.getStyle("background.vector.fill.color"),u=e.getStyle("background.vector.padding"),d=e.getStyle("background.vector.shape"),f=e.getStyle("background.vector.pattern");u&&We.grow(o,u,u);var p=e.getStyle("background.vector.gradient");h&&(p?Ye.fill(t,c,p,e.getStyle("background.vector.gradient.color"),o):t.fillStyle=c,Ye.drawVector(t,d,f,o),t.fill()),l>0&&(t.lineWidth=l,t.strokeStyle=e.getStyle("background.outline.color"),Ye.drawVector(t,d,f,o),t.stroke())}},ln=De.UndoManager=function(t){var e=this;e._list=[],e._cursor=-1,e._suspended=!1,e._dispatcher=new De.EventDispatcher,e._box=t,e._enabled=!1,e._limit=100};ln._IGNORE_PROPERTIES={alarmState:1,propagateSeverity:1,enablePropagation:1,children:1,fromAgent:1,toAgent:1,bundleLinks:1},Me.ext("twaver.UndoManager",Object,{setEnabled:function(t){var e=this,i=e._box;e._enabled!=t&&(t?(i.addDataBoxChangeListener(e._handleDataBoxChange,e,!0),i.addDataPropertyChangeListener(e._handleDataPropertyChange,e,!0)):(i.removeDataBoxChangeListener(e._handleDataBoxChange,e),i.removeDataPropertyChangeListener(e._handleDataPropertyChange,e))),e._enabled=t},isEnabled:function(){return this._enabled},undo:function(){var t,e,i,n=this,o=n._list;if(n.canUndo()){if(t=o[n._cursor--],n._suspended=!0,t.length)for(i=t.length,e=i-1;e>=0;e--)t[e].undo();else t.undo();n._suspended=!1,n._fire({kind:"undo",action:t})}},redo:function(){var t,e=this,i=e._list;e.canRedo()&&(t=i[++e._cursor],e._suspended=!0,t.length?t.forEach(function(t){t.redo()}):t.redo(),e._suspended=!1,e._fire({kind:"redo",action:t}))},canUndo:function(){return this._cursor>=0},canRedo:function(){return this._cursor<this._list.length-1},_add:function(t){var e=this,i=e._batch,n=e._list;i?i.push(t):(e._cursor!==n.length-1&&n.splice(e._cursor+1,n.length),0!==e._limit&&n.length===e._limit&&n.splice(0,1),n.push(t),e._cursor=n.length-1,e._fire({kind:"add",action:t}))},_handleDataBoxChange:function(t){if(!this._suspended){var e=this,i=e._box,n=t.kind,o=t.data;"add"===n?e._add({undo:function(){var t=this;t.parent=o.getParent(),t.host=o.getHost&&o.getHost(),o.getFromNode&&(t.fromNode=o.getFromNode(),t.toNode=o.getToNode()),i.remove(o)},redo:function(){var t=this;t.parent&&o.setParent(t.parent),o.getHost&&t.host&&o.setHost(t.host),o.getFromNode&&(t.fromNode&&o.setFromNode(t.fromNode),t.toNode&&o.setToNode(t.toNode)),i.add(o)}}):"remove"===n&&e._add({undo:function(){i.add(o)},redo:function(){i.remove(o)}})}},_handleDataPropertyChange:function(t){if(!this._suspended){var e=this,i=t.property,n=i.substr(0,2),o=t.source,r=t.oldValue,a=t.newValue;"C:"===n?(i=i.substr(2),e._add({undo:function(){o.setClient(i,r)},redo:function(){o.setClient(i,a)}})):"S:"===n?(i=i.substr(2),e._add({undo:function(){o.setStyle(i,r)},redo:function(){o.setStyle(i,a)}})):ln._IGNORE_PROPERTIES[i]||e._add({undo:function(){o[Me.setter(i)](r)},redo:function(){o[Me.setter(i)](a)}})}},size:function(){return this._list.length},getCursor:function(){return this._cursor},_fire:function(t){this._dispatcher.fire(t)},on:function(t,e,i){this._dispatcher.add(t,e,i)},off:function(t,e){this._dispatcher.remove(t,e)},isSuspended:function(){return this._suspended},setSuspended:function(t){this._suspended=t},getLimit:function(){return this._limit},setLimit:function(t){var e,i,n=this,o=n._list;return 0>t&&(t=0),t!==n._limit&&(e=o.length-t,t>0&&e>0&&(i=n._cursor+1,n._cursor-=e,n._cursor<-1&&(n._cursor=-1),i>0&&o.splice(0,i),(e-=i)>0&&o.splice(o.length-e,e)),n._limit=t,n._fire({kind:"change"})),n},clear:function(){var t=this;return t._list=[],t._cursor=-1,t._fire({kind:"clear"}),t},batch:function(t,e){var i=this;return i.startBatch(),t.call(e),i.endBatch(),i},startBatch:function(){var t=this;return t._batch||(t._batch=[]),t},endBatch:function(){var t,e=this;return e._batch&&(t=e._batch,e._batch=null,t.length&&e._add(t)),e}}),De.Pool=function(t,e){this.func="string"==typeof t?function(){return ze.createElement(t)}:t,this.tagName=t,null!=e&&(this.redundancy=e)},Me.ext("twaver.Pool",Object,{redundancy:2,currentIndex:-1,get:function(){if(++this.currentIndex===this.size()){var t=this.func();return t._pool=this,t.style.margin="0px",t.style.padding="0px",this.list||(this.list=new hn),this.list.add(t),t}return this.list.get(this.currentIndex)},release:function(t){this.list&&this.list.remove(t)>=0&&(delete t._selectData,delete t._expandData,delete t._checkData,delete t._editInfo,delete t.keepDefault,t.style.margin="0px",t.style.padding="0px",t.style.backgroundColor="",t.removeAttribute("title"),"img"===this.tagName&&t.removeAttribute&&(t.removeAttribute("width"),t.removeAttribute("height"),t.removeAttribute("src")),this.list.add(t),this.currentIndex--)},reset:function(){this.currentIndex=-1},clear:function(){if(this.list)for(;this.redundancy+this.currentIndex<this.list.size()-1;)delete this.list.removeAt(this.list.size()-1)._pool},size:function(){return this.list?this.list.size():0}});var hn=function(){if(this._as=[],1===arguments.length){var t=arguments[0];if(t instanceof hn&&(t=t._as),t instanceof Array)for(var e=t.length,i=0;e>i;i++)this._as.push(t[i]);else!1===t?(this._duplicatable=!1,this._map={}):null!=t&&this._as.push(t)}else if(arguments.length>1)for(e=arguments.length,i=0;e>i;i++)this._as.push(arguments[i])};De.List=hn,Me.ext("twaver.List",Object,{_duplicatable:!0,size:function(){return this._as.length},isEmpty:function(){return 0===this._as.length},add:function(t,i){if(!this._duplicatable){if(this._map[t._id])return;this._map[t._id]=!0}return i===e?this._as.push(t):this._as.splice(i,0,t)},addAll:function(t){if(t instanceof hn&&(t=t._as),t instanceof Array)for(var e=t.length,i=0;e>i;i++)this.add(t[i]);else this.add(t)},get:function(t){return this._as[t]},remove:function(t){if(!this._duplicatable&&!this._map[t&&t._id])return-1;var e=this._as.indexOf(t);return e>=0&&e<this._as.length&&this.removeAt(e),e},removeAt:function(t){var e=this._as.splice(t,1)[0];return!this._duplicatable&&e&&delete this._map[e._id],e},set:function(t,e){var i=this._as[t];if(i===e)return e;if(!this._duplicatable){if(this._map[e._id])throw"duplicate item:"+e;delete this._map[i._id],this._map[e._id]=!0}return this._as[t]=e,i},clear:function(){return this._duplicatable||(this._map={}),this._as.splice(0,this._as.length)},contains:function(t){return this._duplicatable?this.indexOf(t)>=0:!!this._map[t&&t._id]},indexOf:function(t){return this._as.indexOf(t)},forEach:function(t,e){for(var i=this._as.length,n=0;i>n;n++){var o=this._as[n];e?t.call(e,o):t(o)}},forEachReverse:function(t,e){for(var i=this._as.length,n=i-1;n>=0;n--){var o=this._as[n];e?t.call(e,o):t(o)}},toArray:function(t,e){if(t){for(var i=[],n=this._as.length,o=0;n>o;o++){var r=this._as[o];e?t.call(e,r)&&i.push(r):t(r)&&i.push(r)}return i}return this._as.concat()},toList:function(t,e){if(t){for(var i=new hn,n=this._as.length,o=0;n>o;o++){var r=this._as[o];e?t.call(e,r)&&i.add(r):t(r)&&i.add(r)}return i}return new hn(this)},sort:function(t){return t?this._as.sort(t):this._as.sort(),this},toString:function(){return this._as.toString()}});var cn={shapeMap:{},init:function(){cn.register("arrow.standard",cn.createStandardArrow()),cn.register("arrow.delta",cn.createDeltaArrow()),cn.register("arrow.diamond",cn.createDiamondArrow()),cn.register("arrow.short",cn.createShortArrow()),cn.register("arrow.slant",cn.createSlantArrow()),cn.register("arrow.doubledelta",cn.createDoubleDeltaArrow()),cn.register("arrow.tee",cn.createTeeArrow()),cn.register("arrow.box",cn.createBoxArrow()),cn.register("arrow.dot",cn.createDotArrow()),cn.register("arrow.tail",cn.createTailArrow())},createStandardArrow:function(){var t=new hn;return t.add({x:-1,y:-5/9}),t.add({x:-.75,y:0}),t.add({x:-1,y:5/9}),t.add({x:0,y:0}),t.add({x:-1,y:-5/9}),{points:t}},createDeltaArrow:function(){var t=new hn;return t.add({x:-1,y:-5/9}),t.add({x:-1,y:5/9}),t.add({x:0,y:0}),t.add({x:-1,y:-5/9}),{points:t}},createDoubleDeltaArrow:function(){var t=new hn;return t.add({x:-1,y:-5/9}),t.add({x:-1,y:5/9}),t.add({x:-.5,y:0}),t.add({x:-.5,y:-5/9}),t.add({x:0,y:0}),t.add({x:-.5,y:5/9}),t.add({x:-.5,y:0}),t.add({x:-1,y:-5/9}),{points:t}},createTeeArrow:function(){var t=new hn;return t.add({x:-1/9,y:-5/9}),t.add({x:-1/9,y:5/9}),t.add({x:0,y:5/9}),t.add({x:0,y:-5/9}),t.add({x:-1/9,y:-5/9}),{points:t}},createBoxArrow:function(){var t=new hn;return t.add({x:-10/9,y:-5/9}),t.add({x:-10/9,y:5/9}),t.add({x:0,y:5/9}),t.add({x:0,y:-5/9}),t.add({x:-10/9,y:-5/9}),{points:t}},createDotArrow:function(){var t={},e=new De.List;return e.add({x:-.5,y:0}),t.points=e,t.draw=function(t,e){if(t&&e&&e.points&&!(e.points.size()<=0)){var i=e.points._as,n=i[0],o=Math.min(e.width,e.height)/2;t.save(),t.beginPath(),t.arc(n.x,n.y,o,0,2*Math.PI,!1),t.closePath(),t.restore()}},t},createTailArrow:function(){for(var t={},e=new De.List,i=-15;15>i;i++)e.add({x:-i/9,y:0});return t.points=e,t.draw=function(t,e){if(t&&e&&e.points&&!(e.points.size()<=0))for(var i=e.points._as,n=e.shadow,o=e.shadowColor,r=e.shadowXOffset,a=e.shadowYOffset,s=e.shadowBlur,o=e.shadowColor,l=i.length-4,h=Math.min(e.width,e.height)/2,c=0;l>c;c++){var u=c/l,d=i[c],f=.4*h;t.save(),t.restore(),t.beginPath(),t.globalAlpha=u*u,n&&(t.shadowOffsetX=r,t.shadowOffsetY=a,t.shadowBlur=s,t.shadowColor=o),t.arc(d.x,d.y,f,0,2*Math.PI,!1),t.closePath(),t.fill()}},t},createDiamondArrow:function(){var t=new hn;return t.add({x:-7/12,y:5/9}),t.add({x:-14/12,y:0}),t.add({x:-7/12,y:-5/9}),t.add({x:0,y:0}),t.add({x:-7/12,y:5/9}),{points:t}},createShortArrow:function(){var t=new hn;return t.add({x:-8/12,y:6/9}),t.add({x:-5/12,y:0}),t.add({x:-8/12,y:-6/9}),t.add({x:0,y:0}),t.add({x:-8/12,y:6/9}),{points:t}},createSlantArrow:function(){var t=new hn;return t.add({x:-1,y:-5/9}),t.add({x:-6.5/12,y:0}),t.add({x:-.75,y:4/9}),t.add({x:0,y:0}),t.add({x:-1,y:-5/9}),{points:t}},register:function(t,e){cn.shapeMap[t]=e},getShape:function(t){if(t)return cn.shapeMap[t];throw"shape type can't be null"},getArrowRect:function(t,e,i,n,o,r,a,s,l){var h=cn.getShape(n);if(h&&h.points&&!(h.points&&h.points.size()<=0)){if(a>0&&1>a){var c;c=t.getLineLength?t.getLineLength():t._element.getLineLength(),a*=c}else t.getLineLength&&(a+=cn.calculateArrowXOffsetAtEdge(e,t,i,l));var u,d,f,p=We.calculatePointInfoAlongLine(e,i,a,s),g=p.point,_=p.angle,m=h.points._as,v=m.length,y=new hn;for(f=new He(o,0,0,r,g.x,g.y),u=0;v>u;u++)y.add(f.transform(m[u]));for(f=We.createMatrix(_+Math.PI,g.x,g.y),u=0;v>u;u++)d=y.get(u),d instanceof hn&&(d=d._as),d instanceof Array?(d[0]=f.transform(d[0]),d[1]=f.transform(d[1])):y.set(u,f.transform(d));return We.getLineRect(y)}},drawArrow:function(t,e,i,n,o,r,a,s,l,h,c,u,d){l=l||0,h=h||0,c=c||0;var f=d._element.getStyle("arrow.from.shadow"),p=d._element.getStyle("arrow.from.shadow.color"),g=d._element.getStyle("arrow.from.shadow.xoffset"),_=d._element.getStyle("arrow.from.shadow.yoffset"),m=d._element.getStyle("arrow.from.shadow.blur"),v=c>=0&&u;if(a||v){var y=cn.getShape(r);if(y&&y.points&&!(y.points&&y.points.size()<=0)){var w=We.calculatePointInfoAlongLine(n,o,l,h),b=w.point,x=w.angle;a&&(t.fillStyle=s),t.beginPath(),v&&(t.lineWidth=c,t.strokeStyle=u),cn._drawArrow(t,y,x,b,e,i,u,p,f,g,_,m),f&&(t.shadowOffsetX=g,t.shadowOffsetY=_,t.shadowBlur=m,t.shadowColor=p),a&&t.fill(),v&&t.stroke()}}},_drawArrow:function(t,e,i,n,o,r,a,s,l,h,c,u){if(e.draw){for(var d=new De.List,f=0;f<e.points._as.length;f++)d.add(e.points.get(f));d.add({x:-1,y:-.5}),d.add({x:-1,y:.5}),d.add({x:0,y:.5}),d.add({x:0,y:-.5}),d=d._as;var f,p,g,_=d.length,m=new hn;g=new He(o,0,0,r,n.x,n.y);for(var f=0;_>f;f++)m.add(g.transform(d[f]));m=m._as,g=We.createMatrix(i+Math.PI,n.x,n.y);for(var v=new hn,f=0;_>f;f++)v.add(g.transform(m[f]));e.draw&&e.draw(t,{points:v,width:o,height:r,shadowColor:s,shadow:l,shadowXOffset:h,shadowYOffset:c,shadowBlur:u})}else{var f,p,g,d=e.points._as,_=d.length,m=new hn;for(g=new He(o,0,0,r,n.x,n.y),f=0;_>f;f++)m.add(g.transform(d[f]));m=m._as,g=We.createMatrix(i+Math.PI,n.x,n.y);var y=m[0];for(y=g.transform(y),t.moveTo(y.x,y.y),f=1;_>f;f++)p=m[f],p instanceof hn&&(p=p._as),p instanceof Array?(p[0]=g.transform(p[0]),p[1]=g.transform(p[1]),t.quadraticCurveTo(p[0].x,p[0].y,p[1].x,p[1].y)):(p=g.transform(p),t.lineTo(p.x,p.y))}},drawLinkArrow:function(t,e,i,n){if(!(i.size()<2)){var o=!!t._element.isBundleAgent&&t._element.isBundleAgent();t._element.getStyle(o?"arrow.agent.from":"arrow.from")&&cn._drawFromArrow(t,e,i,n),t._element.getStyle(o?"arrow.agent.to":"arrow.to")&&cn._drawToArrow(t,e,i,n)}},_drawFromArrow:function(t,e,i,n){var o=t._element,r=!!o.isBundleAgent&&o.isBundleAgent(),a=o.getStyle(r?"arrow.agent.from.fill":"arrow.from.fill"),s=o.getStyle(r?"arrow.agent.from.outline.width":"arrow.from.outline.width");if(o.getStyle(r?"arrow.agent.from.shadow.color":"arrow.from.shadow.color"),a||s>=0){var l=o.getStyle(r?"arrow.agent.from.width":"arrow.from.width"),h=o.getStyle(r?"arrow.agent.from.height":"arrow.from.height"),c=o.getStyle(r?"arrow.agent.from.xoffset":"arrow.from.xoffset");if(c>0&&1>c){var u;u=t.getLineLength?t.getLineLength():t._element.getLineLength(),c*=u}else t.getLineLength&&(c+=cn.calculateArrowXOffsetAtEdge(i,t,!0,n));var d=o.getStyle(r?"arrow.agent.from.yoffset":"arrow.from.yoffset"),f=o.getStyle(r?"arrow.agent.from.shape":"arrow.from.shape");cn.drawArrow(e,l,h,i,!0,f,a,o.getStyle(r?"arrow.agent.from.color":"arrow.from.color"),c,d,s,o.getStyle(r?"arrow.agent.from.outline.color":"arrow.from.outline.color"),t)}},_drawToArrow:function(t,e,i,n){var o=t._element,r=!!o.isBundleAgent&&o.isBundleAgent(),a=o.getStyle(r?"arrow.agent.to.fill":"arrow.to.fill"),s=o.getStyle(r?"arrow.agent.to.outline.width":"arrow.to.outline.width");if(a||s>=0){var l=o.getStyle(r?"arrow.agent.to.width":"arrow.to.width"),h=o.getStyle(r?"arrow.agent.to.height":"arrow.to.height"),c=o.getStyle(r?"arrow.agent.to.xoffset":"arrow.to.xoffset");if(c>0&&1>c){var u;u=t.getLineLength?t.getLineLength():t._element.getLineLength(),c*=u}else t.getLineLength&&(c+=cn.calculateArrowXOffsetAtEdge(i,t,!1,n));var d=o.getStyle(r?"arrow.agent.to.yoffset":"arrow.to.yoffset"),f=o.getStyle(r?"arrow.agent.to.shape":"arrow.to.shape");cn.drawArrow(e,l,h,i,!1,f,a,o.getStyle(r?"arrow.agent.to.color":"arrow.to.color"),c,d,s,o.getStyle(r?"arrow.agent.to.outline.color":"arrow.to.outline.color"),t)}},calculateArrowXOffsetAtEdge:function(t,e,i,n){if(null==t||t.size()<2)return 0;var o=e._element;if(!o.getStyle(i?"arrow.from.at.edge":"arrow.to.at.edge"))return 0;var r=e._network.getElementUI(i?o.getFromAgent():o.getToAgent());if(!r)return 0;if(n)var a=r.getZoomBodyRect();else var a=r._bodyRect;if(null==a)return 0;for(var s=We._getPoint(t.get(i?0:t.size()-1)),l=0,h=e.getLineLength();cn._containsByInt(a,Math.floor(s.x),Math.floor(s.y),!1)&&h>l;)s=We.calculatePointInfoAlongLine(t,i,l++).point;return l},_containsByInt:function(t,i,n,o){return o=o===e||o,o?i>=Math.floor(t.x)&&i<=Math.floor(t.x+t.width)&&n>=Math.floor(t.y)&&n<=Math.floor(t.y+t.height):i>Math.floor(t.x)&&i<Math.floor(t.x+t.width)&&n>Math.floor(t.y)&&n<Math.floor(t.y+t.height)}};cn.init(),Me.arrow=cn,De.EventDispatcher=function(){},Me.ext("twaver.EventDispatcher",null,{contains:function(t,e){if(this._ls)for(var i,n=0,o=this._ls.size();o>n;n++)if(i=this._ls.get(n),t===i.l&&e===i.s)return!0;return!1},add:function(t,e,i){var n={l:t,s:e,a:i};this._ls||(this._ls=new hn),this._f?(this._addPendings||(this._addPendings=new hn),this._addPendings.add(n)):n.a?this._ls.add(n,0):this._ls.add(n)},remove:function(t,e){this._ls&&(this._f?(this._removePendings||(this._removePendings=new hn),this._removePendings.add({l:t,s:e})):this._remove(t,e))},_remove:function(t,e){for(var i,n=0,o=this._ls.size();o>n;n++)if(i=this._ls.get(n),i.l===t&&i.s===e)return void this._ls.removeAt(n)},fire:function(t){if(this._ls){var e,i,n=this._ls.size();for(this._f=!0,e=0;n>e;e++)i=this._ls.get(e),i.s?i.l.call(i.s,t):i.l(t);if(this._f=!1,this._removePendings){for(n=this._removePendings.size(),e=0;n>e;e++)i=this._removePendings.get(e),this._remove(i.l,i.s);delete this._removePendings}if(this._addPendings){for(n=this._addPendings.size(),e=0;n>e;e++)i=this._addPendings.get(e),i.a?this._ls.add(i,0):this._ls.add(i);delete this._addPendings}}}}),De.ImageAsset=function(t,e,i,n,o){this._name=t,this._width=i,this._height=n,this._svg=o,this._edgeData,"string"==typeof e?this._src=e:"function"==typeof e?this._func=e:Ki(e)?this._image=e:"object"==typeof e&&(this._image=e,this._width=e.w||e.width,this._height=e.h||e.height,!1!==e.cache&&bn(e)&&(yn(t,e),this._cache=Cn(e)))},Me.ext("twaver.ImageAsset",Object,{getName:function(){return this._name},getSrc:function(){return this._src},isSvg:function(){return this._svg},getImage:function(t,e,i){if(!t||!this._image)return this._image;this._map||(this._map={});var n;n=this._svg&&3===arguments.length?t+","+e+","+i:t;var o=this._map[n];return o||(o=_n(this._cache||this._image,pn(t),this._svg?e||this.getWidth():this.getWidth(),this._svg?i||this.getHeight():this.getHeight()),this._map[n]=o,o)},getWidth:function(){return this._width},getHeight:function(){return this._height},getFunction:function(){return this._func},_createEdgeData:function(t,e,i){var n=300/e;e>i&&(n=300/i);var o=Math.floor(e*n),r=Math.floor(i*n);this.tempCanvas||(this.tempCanvas=ze.createElement("canvas"),this.ctx=this.tempCanvas.getContext("2d")),this.tempCanvas.width=o,this.tempCanvas.height=r,this.ctx.clearRect(0,0,o,r),this.ctx.drawImage(t,0,0,o,r);for(var a=this.ctx.getImageData(0,0,o,r),s=!0,l=[],h=0,e=o,i=r;i>h;h++)for(var c=0;e>c;c++){var u=4*(h*e+c),d=this._isTransparentPoint(a.data,u),f=s!=d||!d&&(0==c||c==e-1);if(f){var p=d?1:0;l.push({x:c-p,y:h})}s=d}s=!0;for(var c=0,e=o,i=r;e>c;c++)for(var h=0;i>h;h++){var u=4*(h*e+c),d=this._isTransparentPoint(a.data,u),f=s!=d||!d&&(0==h||h==i-1);if(f){var p=d?1:0;l.push({x:c,y:h-p})}s=d}for(var g=e/2,_=i/2,m=[],v=0;360>v;v++)m.push({x:g,y:_,dist:0});for(var v=0,y=l.length;y>v;v++){var w=l[v],b=this._getPointAngleDegree(w.x,w.y,g,_),x=this._getPointDist(w.x,w.y,g,_);m[b].dist<x&&(m[b]={x:w.x,y:w.y,dist:x})}for(var v=0,y=m.length;y>v;v++){var f=m[v];f.x=f.x/n,f.y=f.y/n,delete f.dist}return m},_isTransparentPoint:function(t,e){return t[e]+t[e+1]+t[e+2]+t[e+3]==0},_getPointAngleDegree:function(t,e,i,n){var o=i-t,r=n-e,a=Math.atan2(r,o);return a=a/Math.PI*180,a=parseInt(a)+180,a%=360},_getPointDist:function(t,e,i,n){var o=i-t,r=n-e;return Math.sqrt(o*o+r*r)}});var un={},dn=Xe.createCanvas();dn.width=1,dn.height=1;var fn=dn.getContext("2d"),pn=function(t){t=t||"black";var e,i=un[t];return i||(fn.clearRect(0,0,1,1),fn.fillStyle=t,fn.fillRect(0,0,1,1),e=fn.getImageData(0,0,1,1).data,i=un[t]={r:e[0],g:e[1],b:e[2],a:e[3]}),i},gn=function(t,e){if(!e)return t;if(e=pn(e),t=pn(t),kn.PIXEL_FILTER_FUNCTION){var i=kn.PIXEL_FILTER_FUNCTION(t,e);return"rgba("+i.r+","+i.g+","+i.b+","+t.a+")"}return null},_n=function(t,e,i,n){var o=Xe.createCanvas(i,n),r=o.getContext("2d");r.drawImage(t,0,0,i,n);try{for(var a=r.getImageData(0,0,i,n),s=a.data,l=0,h=s.length;h>l;l+=4){var c={r:s[l+0],g:s[l+1],b:s[l+2]},u=kn.PIXEL_FILTER_FUNCTION(c,e);s[l+0]=u.r,s[l+1]=u.g,s[l+2]=u.b}r.putImageData(a,0,0)}catch(e){return t}return o},mn={},vn=function(t,e){if(t){"string"===typeof t&&(t.match(Wi)||Me.images[t]||(mn[t]||(mn[t]=[])).push(e))}},yn=function(t,e){e.pattern&&vn(e.pattern,t),e.v&&e.v.forEach(function(e){e.pattern&&vn(e.pattern,t)})},wn=function(t){var e=mn[t];e&&(e.forEach(function(t){var e=Me.images[t];e._cache=Cn(e._image)}),delete mn[t])},bn=function(t){return!(!t.w||!t.h)&&xn(t)},xn=function(t){return!Object.keys(t).some(function(e){if(/^on/.test(e))return!1;var i=t[e],n=An(i);return n||"v"!==e||(n=i.some(function(t){if("draw"===t.shape)return!0;if("vector"===t.shape){var e=Me.images[t.name];if(e&&!e._cache)return!0}return!!Object.keys(t).some(function(e){return"state"===e||"animate"===e||An(t[e])})||!("g"!==t.shape||!t.v||!t.v.length)&&!xn(t)})),n})},An=function(t){var e=typeof t;return"string"===e&&t.match(Wi)||"function"===e},Cn=function(t){var e=Xe.createCanvas(t.w,t.h),i=e.getContext("2d");return Mi(i,t,null,{x:0,y:0,width:t.w,height:t.h}),e},Tn=De.imageUtil={IMAGE_LOAD_COMPLETED:"IMAGE_LOAD_COMPLETED",_dispatcher:new De.EventDispatcher,addEventListener:function(t,e,i){Tn._dispatcher.add(t,e,i)},removeEventListener:function(t,e){Tn._dispatcher.remove(t,e)},images:{},registerImageByUrl:function(t,e,i){if(e=e||Tn.getImageType(t),i=i||Tn.getImageName(t),!Tn.images[i]){Tn.images[i]=t;var n=new Ve;n.src=t,n.onload=function(){Me.registerImage(i,n,n.width,n.height,!0===e),n.onload=null,delete Tn.images[i];var o={type:Tn.IMAGE_LOAD_COMPLETED,url:t,svg:e,name:i};Tn._dispatcher.fire(o)}}},getImageName:function(t){if("string"!=typeof t)return null;var e=t.lastIndexOf("/"),i=t;return e>=0&&(i=t.substring(e+1)),e=i.lastIndexOf("."),e>=0&&(i=i.substring(0,e)),i},getImageType:function(t){if("string"!=typeof t)return null;var e=t.lastIndexOf("/"),i=t;return e>=0&&(i=t.substring(e+1)),e=i.lastIndexOf("."),e>=0&&(i=i.substring(e+1)),i}},kn={COLORS:["#6495ED","#FFFF00","#00FFFF","#FF0000","#7FFF00","#E0A580","#5FC0CB","#FA00F0","#A1BC50","#FFD700","#4169E1","#E5A5F5","#1E90FF","#696969","#FF6347","#00BFEF","#FFD700","#80E090","#5F9EA0","#A000FF","#7FAF00","#228BA2","#FF00FF","#7FFFD4","#800000","#0000CD","#20B2AA","#D2691E","#6495BD","#DC143C","#F0A8AF","#008B8B","#800080","#B8860B","#4B0082","#00FF00","#FFA500","#FF4500","#FFFF00","#9ACD32","#00008B","#FF1493","#ADFF2F","#4682B4","#00C0B1"],CALL_LATER_DELAY:17,SCROLL_BAR_WIDTH:17,SELECT_COLOR:"#C2CFF1",FOCUS_ON_CLICK:!0,VIEW_POSITION:"absolute",VIEW_FONT_SIZE:"12px",VIEW_FONT_FAMILY:"arial, tahoma, helvetica, sans-serif",TOOLTIP_BACKGROUND:"lightyellow",TOOLTIP_FONT_SIZE:"12px",TOOLTIP_COLOR:"black",TOOLTIP_PADDING:"4px 8px",TOOLTIP_BORDER:"1px solid gray",TOOLTIP_BORDER_RADIUS:"6px",TOOLTIP_XOFFSET:12,TOOLTIP_YOFFSET:12,TOOLTIP_BOX_SHADOW:"0px 0px 3px #AAA",TOOLTIP_ZINDEX:1e5,TOOLTIP_INITIAL_DELAY:750,TOOLTIP_RESHOW_DELAY:500,TOOLTIP_DISMISS_DELAY:4e3,ZOOM_MAX:5,ZOOM_MIN:.1,ZOOM_INCREMENT:1.3,ZOOM_ANIMATE:!0,COLUMN_INNER_TEXT:!0,COLUMN_WIDTH:80,COLUMN_HORIZONTAL_ALIGN:"",COLUMN_PROPERTY_TYPE:"accessor",COLUMN_VALUE_TYPE:"string",COLUMN_EDITABLE:!1,COLUMN_SORTABLE:!0,COLUMN_VISIBLE:!0,COLUMN_RESIZABLE:!0,COLUMN_MOVABLE:!0,COLUMN_RENDER_CELL:null,COLUMN_RENDER_HEADER:null,COLUMN_RENDER_EDITOR:null,PROPERTY_INNER_TEXT:!0,PROPERTY_HORIZONTAL_ALIGN:"",PROPERTY_PROPERTY_TYPE:"accessor",PROPERTY_VALUE_TYPE:"string",PROPERTY_EDITABLE:!1,PROPERTY_CATEGORY_NAME:null,PROPERTY_RENDER_NAME:null,PROPERTY_RENDER_VALUE:null,PROPERTY_RENDER_EDITOR:null,TAB_WIDTH:100,TAB_CLOSABLE:!1,TAB_RESIZABLE:!0,TAB_MOVABLE:!0,TAB_DISABLED:!1,TAB_VISIBLE:!0,ACCORDION_EXPAND_ICON:"expand_icon",ACCORDION_COLLAPSE_ICON:"collapse_icon",ACCORDION_TITLE_HEIGHT:20,ACCORDION_TITLE_BACKGROUND:"#EBEBEB",ACCORDION_BORDER_BOTTOM_COLOR:"lightgray",ACCORDION_ICON_POSITION:"left",TITLEPANE_TITLE_HEIGHT:20,TITLEPANE_TITLE_BACKGROUND:"#DDD",TITLEPANE_TITLE_HORIZONTAL_ALIGN:"left",BORDERPANE_HGAP:0,BORDERPANE_VGAP:0,CHARTPANE_TITLE_HEIGHT:20,CHARTPANE_TITLE_HORIZONTAL_ALIGN:"center",CHARTPANE_LEGEND_ORIENTATION:"bottom",CHARTPANE_LEGEND_WIDTH:80,LEGENDPANE_ICON_WIDTH:10,LEGENDPANE_ICON_HEIGHT:10,LEGENDPANE_ICON_RADIUS:0,LEGENDPANE_ROW_HEIGHT:20,LEGENDPANE_ORIENTATION:"horizontal",LEGENDPANE_HIDDEN_COLOR:"#BABBBC",LEGENDPANE_SELECT_BACKGROUND_COLOR:"#00007D",LEGENDPANE_SELECT_FOREGROUND_COLOR:"#FFFFFF",CHART_TOOLTIP_ENABLED:!0,CHART_SELECT_TOLERANCE:0,CHART_XGAP:6,CHART_YGAP:6,CHART_XZOOM_ENABLED:!0,CHART_YZOOM_ENABLED:!0,CHART_XTRANSLATE_ENABLED:!0,CHART_YTRANSLATE_ENABLED:!0,CHART_DOUBLE_CLICK_TO_RESET:!0,CHART_VALUE_VISIBLE:!0,CHART_VALUE_FONT:null,CHART_BACKGROUND_VISIBLE:!1,CHART_BACKGROUND_FILL:!0,CHART_BACKGROUND_FILL_COLOR:"rgba(50,50,50,0.11)",CHART_BACKGROUND_OUTLINE_WIDTH:1,CHART_BACKGROUND_OUTLINE_COLOR:"rgba(50,50,50,0.11)",CHART_BACKGROUND_GRADIENT:"linear.north",CHART_BACKGROUND_GRADIENT_COLOR:"#FFFFFF",PIECHART_TYPE:"oval",PIECHART_START_ANGLE:0,PIECHART_SELECT_OFFSET:5,PIECHART_SHADOW_OFFSET:1,PIECHART_SHADOW_COLOR:"#C2CFF1",PIECHART_LINE_RATE:.5,PIECHART_DONUT_RATE:.5,PIECHART_VALUE_POSITION:.5,BARCHART_TYPE:"default",BARCHART_UPPER_LIMIT:null,BARCHART_LOWER_LIMIT:0,BARCHART_XAXIS_LINE_COLOR:"#808080",BARCHART_XAXIS_LINE_WIDTH:1,BARCHART_XAXIS_TEXT_COLOR:"#000000",BARCHART_XAXIS_TEXT_FONT:null,BARCHART_YAXIS_LINE_COLOR:"#808080",BARCHART_YAXIS_LINE_WIDTH:1,BARCHART_YAXIS_TEXT_COLOR:"#000000",BARCHART_YAXIS_TEXT_FONT:null,BARCHART_XSCALE_TEXT_FONT:null,BARCHART_XSCALE_TEXT_COLOR:"#000000",BARCHART_XSCALE_TEXT_ORIENTATION:"horizontal",BARCHART_YSCALE_TEXT_VISIBLE:!0,BARCHART_YSCALE_TEXT_COLOR:"#000000",BARCHART_YSCALE_TEXT_FONT:null,BARCHART_YSCALE_LINE_COLOR:"#808080",BARCHART_YSCALE_LINE_WIDTH:.3,BARCHART_YSCALE_VALUE_GAP:0,BARCHART_YSCALE_PIXEL_GAP:20,BARCHART_YSCALE_MIN_TEXT_VISIBLE:!1,LINECHART_INTERRUPTABLE:!0,LINECHART_UPPER_LIMIT:null,LINECHART_LOWER_LIMIT:null,LINECHART_XAXIS_LINE_COLOR:"#808080",LINECHART_XAXIS_LINE_WIDTH:1,LINECHART_XAXIS_TEXT_COLOR:"#000000",LINECHART_XAXIS_TEXT_FONT:null,LINECHART_YAXIS_LINE_COLOR:"#808080",LINECHART_YAXIS_LINE_WIDTH:1,LINECHART_YAXIS_TEXT_COLOR:"#000000",LINECHART_YAXIS_TEXT_FONT:null,LINECHART_XSCALE_TEXT_FONT:null,LINECHART_XSCALE_TEXT_COLOR:"#000000",LINECHART_XSCALE_TEXT_ORIENTATION:"horizontal",LINECHART_XSCALE_LINE_COLOR:"#808080",LINECHART_XSCALE_LINE_WIDTH:.3,LINECHART_YSCALE_TEXT_VISIBLE:!0,LINECHART_YSCALE_TEXT_COLOR:"#000000",LINECHART_YSCALE_TEXT_FONT:null,LINECHART_YSCALE_LINE_COLOR:"#808080",LINECHART_YSCALE_LINE_WIDTH:.3,LINECHART_YSCALE_VALUE_GAP:0,LINECHART_YSCALE_PIXEL_GAP:20,LINECHART_YSCALE_MIN_TEXT_VISIBLE:!1,LINECHART_VALUESPANCOUNT:1,BUBBLECHART_UPPER_LIMIT:null,BUBBLECHART_LOWER_LIMIT:null,BUBBLECHART_XAXIS_UPPER_LIMIT:null,BUBBLECHART_XAXIS_LOWER_LIMIT:null,BUBBLECHART_XAXIS_LINE_COLOR:"#808080",BUBBLECHART_XAXIS_LINE_WIDTH:1,BUBBLECHART_XAXIS_TEXT_COLOR:"#000000",BUBBLECHART_XAXIS_TEXT_FONT:null,BUBBLECHART_YAXIS_LINE_COLOR:"#808080",BUBBLECHART_YAXIS_LINE_WIDTH:1,BUBBLECHART_YAXIS_TEXT_COLOR:"#000000",BUBBLECHART_YAXIS_TEXT_FONT:null,BUBBLECHART_XSCALE_TEXT_FONT:null,BUBBLECHART_XSCALE_TEXT_COLOR:"#000000",BUBBLECHART_XSCALE_TEXT_ORIENTATION:"horizontal",BUBBLECHART_XSCALE_LINE_COLOR:"#808080",BUBBLECHART_XSCALE_LINE_WIDTH:.3,BUBBLECHART_YSCALE_TEXT_VISIBLE:!0,BUBBLECHART_YSCALE_TEXT_COLOR:"#000000",BUBBLECHART_YSCALE_TEXT_FONT:null,BUBBLECHART_YSCALE_LINE_COLOR:"#808080",BUBBLECHART_YSCALE_LINE_WIDTH:.3,BUBBLECHART_YSCALE_VALUE_GAP:0,BUBBLECHART_YSCALE_PIXEL_GAP:20,BUBBLECHART_YSCALE_MIN_TEXT_VISIBLE:!1,BUBBLECHART_SELECT_SHADOW_COLOR:"#000000",BUBBLECHART_SELECT_SHADOW_OFFSET:3,RADARCHART_AXIS_TEXT_FONT:null,RADARCHART_AXIS_TEXT_COLOR:"#000000",RADARCHART_AXIS_TEXT_VISIBLE:!0,RADARCHART_SCALE_TEXT_FONT:null,RADARCHART_SCALE_TEXT_COLOR:"#000000",RADARCHART_SCALE_TEXT_VISIBLE:!0,RADARCHART_AXIS_VISIBLE:!0,RADARCHART_AXIS_LINE_COLOR:"#808080",RADARCHART_AXIS_LINE_WIDTH:3,RADARCHART_AXIS_START_ANGLE:0,RADARCHART_RING_VISIBLE:!0,RADARCHART_RING_TYPE:"line",RADARCHART_RING_LINE_COLOR:"#808080",RADARCHART_RING_LINE_WIDTH:1,RADARCHART_SCALE_COUNT:5,RADARCHART_SCALE_MAXVALUE:1,RADARCHART_SCALE_MINVALUE:0,RADARCHART_ANCHOR_VISIBLE:!0,RADARCHART_AREA_FILL:!0,RADARCHART_AREA_FILL_ALPHA:.2,RADARCHART_AREA_SELECT_FILL_ALPHA:.5,DIALCHART_UPPER_LIMIT:100,DIALCHART_LOWER_LIMIT:0,DIALCHART_START_ANGLE:0,DIALCHART_END_ANGLE:360,DIALCHART_INNER_RADIUS:.8,DIALCHART_COLOR_RANGE_FILL_COLOR:"#808080",DIALCHART_OUTLINE_WIDTH:0,DIALCHART_OUTLINE_COLOR:"#808080",DIALCHART_SCALE_INSIDE:!0,DIALCHART_MAJOR_SCALE_COUNT:11,DIALCHART_MAJOR_SCALE_LINE_WIDTH:2,DIALCHART_MAJOR_SCALE_LINE_LENGTH:8,DIALCHART_MAJOR_SCALE_LINE_COLOR:"#000000",DIALCHART_MINOR_SCALE_COUNT:4,DIALCHART_MINOR_SCALE_LINE_WIDTH:1,DIALCHART_MINOR_SCALE_LINE_LENGTH:4,DIALCHART_MINOR_SCALE_LINE_COLOR:"#000000",DIALCHART_SCALE_TEXT_VISIBLE:!0,DIALCHART_SCALE_UPPER_LIMIT_TEXT_VISIBLE:!0,DIALCHART_SCALE_LOWER_LIMIT_TEXT_VISIBLE:!0,DIALCHART_SCALE_TEXT_FONT:null,DIALCHART_SCALE_TEXT_COLOR:"#000000",DIALCHART_PIVOT_RADIUS:10,DIALCHART_PIVOT_FILL:!0,DIALCHART_PIVOT_FILL_COLOR:"#808080",DIALCHART_PIVOT_OUTLINE_WIDTH:0,DIALCHART_PIVOT_OUTLINE_COLOR:"#808080",DIALCHART_VALUE_POSITION:.5,DIALCHART_INNER_DARKER_RADIUS:10,DIALCHART_OUTER_BRIGHTER_RADIUS:10,DIALCHART_SELECT_SHADOW_COLOR:"#000000",DIALCHART_SELECT_SHADOW_OFFSET:3,TABPANE_TAB_GAP:1,TABPANE_TAB_RADIUS:0,TABPANE_TAB_HEIGHT:24,TABPANE_TAB_ORIENTATION:"top",TABPANE_RESIZE_TOLERANCE:3,TABPANE_TAB_BACKGROUND:"#EBEBEB",TABPANE_DISABLED_COLOR:"#BABBBC",TABPANE_SELECT_BACKGROUND:"white",TABPANE_MOVE_BACKGROUND:"rgba(184,211,240,0.7)",TABPANE_INSERT_BACKGROUND:"orange",TABPANE_HORIZONTAL_ALIGN:"center",TABPANE_CLOSE_ICON:"close_icon",TABPANE_SELECT_NEXT_ON_CLOSE:!0,TABPANE_SELECT_NEXT_ON_INVISIBLE:!0,LISTBASE_INNER_TEXT:!0,LIST_ROW_HEIGHT:19,LIST_INDENT:2,LIST_ROW_LINE_WIDTH:0,LIST_ROW_LINE_COLOR:"#DDD",LIST_MAKE_VISIBLE_ON_SELECTED:!0,LIST_KEYBOARD_REMOVE_ENABLED:!0,LIST_KEYBOARD_SELECT_ENABLED:!0,TREE_ROW_HEIGHT:19,TREE_INDENT:16,TREE_ROW_LINE_WIDTH:0,TREE_ROW_LINE_COLOR:"#DDD",TREE_MAKE_VISIBLE_ON_SELECTED:!0,TREE_KEYBOARD_REMOVE_ENABLED:!0,TREE_KEYBOARD_SELECT_ENABLED:!0,TREE_EXPAND_ICON:"expand_icon",TREE_COLLAPSE_ICON:"collapse_icon",TREE_LINE_TYPE:"none",TREE_LINE_THICKNESS:2,TREE_LINE_COLOR:"#000000",TREE_LINE_ALPHA:1,TREE_LINE_DASH:[4,2],TABLE_ROW_HEIGHT:19,TABLE_ROW_LINE_WIDTH:1,TABLE_ROW_LINE_COLOR:"#DDD",TABLE_COLUMN_LINE_WIDTH:1,TABLE_COLUMN_LINE_COLOR:"#DDD",TABLE_MAKE_VISIBLE_ON_SELECTED:!0,TABLE_KEYBOARD_REMOVE_ENABLED:!0,TABLE_KEYBOARD_SELECT_ENABLED:!0,TABLE_EDITABLE:!1,TABLEHEADER_HEIGHT:24,TABLEHEADER_RESIZE_TOLERANCE:3,TABLEHEADER_BACKGROUND:"#EBEBEB",TABLEHEADER_MOVE_BACKGROUND:"rgba(184,211,240,0.7)",TABLEHEADER_INSERT_BACKGROUND:"orange",TABLEHEADER_COLUMN_LINE_COLOR:"#DDD",TABLEHEADER_SORT_DESC_ICON:"sort_desc",TABLEHEADER_SORT_ASC_ICON:"sort_asc",TABLEHEADER_SORT_ICON_POSITION:"98% 50%",TREETABLE_ROW_HEIGHT:19,TREETABLE_INDENT:16,TREETABLE_ROW_LINE_WIDTH:1,TREETABLE_ROW_LINE_COLOR:"#DDD",TREETABLE_COLUMN_LINE_WIDTH:1,TREETABLE_COLUMN_LINE_COLOR:"#DDD",TREETABLE_MAKE_VISIBLE_ON_SELECTED:!0,TREETABLE_KEYBOARD_REMOVE_ENABLED:!0,TREETABLE_KEYBOARD_SELECT_ENABLED:!0,TREETABLE_EXPAND_ICON:"expand_icon",TREETABLE_COLLAPSE_ICON:"collapse_icon",TREETABLE_EDITABLE:!1,PROPERTYSHEET_AUTO_ADJUSTABLE:!0,PROPERTYSHEET_INDENT:16,PROPERTYSHEET_ROW_HEIGHT:19,PROPERTYSHEET_ROW_LINE_WIDTH:1,PROPERTYSHEET_COLUMN_LINE_WIDTH:1,PROPERTYSHEET_BORDER_COLOR:"#EBEBEB",PROPERTYSHEET_EXPAND_ICON:"expand_icon",PROPERTYSHEET_COLLAPSE_ICON:"collapse_icon",PROPERTYSHEET_PROPERTY_NAME_WIDTH:100,PROPERTYSHEET_PROPERTY_NAME_HORIZONTAL_ALIGN:"",PROPERTYSHEET_SUM_WIDTH:200,PROPERTYSHEET_RESIZE_TOLERANCE:3,PROPERTYSHEET_EDITABLE:!1,PROPERTYSHEET_CATEGORIZABLE:!0,PROPERTYSHEET_EXPAND_CATEGORY:!0,POPUPMENU_SUBNENU_ENABLE_ICON:"submenu_enable_icon",POPUPMENU_SUBNENU_DISABLE_ICON:"submenu_disable_icon",POPUPMENU_CHECKBOX_SELECTED_ICON:"checkbox_selected_icon",POPUPMENU_CHECKBOX_UNSELECTED_ICON:"checkbox_unselected_icon",POPUPMENU_RADIOBUTTON_SELECTED_ICON:"radiobutton_selected_icon",POPUPMENU_RADIOBUTTON_UNSELECTED_ICON:"radiobutton_unselected_icon",SPLITPANE_ORIENTATION:"horizontal",SPLITPANE_POSITION:.5,SPLITPANE_DIVIDER_WIDTH:6,SPLITPANE_DIVIDER_BACKGROUND:"#CCCCFF",SPLITPANE_DIVIDER_OPACITY:.5,SPLITPANE_MASK_BACKGROUND:"",SPLITPANE_UP_EXPAND_ICON:"up_expand_icon",SPLITPANE_DOWN_EXPAND_ICON:"down_expand_icon",SPLITPANE_LEFT_EXPAND_ICON:"left_expand_icon",SPLITPANE_RIGHT_EXPAND_ICON:"right_expand_icon",NODE_WIDTH:50,NODE_HEIGHT:50,IMAGE_NODE:"node_image",IMAGE_GROUP:"group_image",IMAGE_SUBNETWORK:"subnetwork_image",ICON_DATABOX:"databox_icon",ICON_DATA:"data_icon",ICON_NODE:"node_icon",ICON_LINK:"link_icon",ICON_GROUP:"group_icon",ICON_SUBNETWORK:"subnetwork_icon",ICON_GRID:"grid_icon",ICON_BUS:"bus_icon",ICON_SHAPENODE:"shapenode_icon",ICON_SHAPELINK:"shapelink_icon",ICON_LINKSUBNETWORK:"linksubnetwork_icon",ICON_SHAPESUBNETWORK:"shapesubnetwork_icon",LAYER_DEFAULT_ID:"default",LAYER_DEFAULT_NAME:"default",ATTACHMENT_POINTER_LENGTH:10,ATTACHMENT_POINTER_WIDTH:8,ATTACHMENT_CORNER_RADIUS:5,ATTACHMENT_CONTENT_WIDTH:30,ATTACHMENT_CONTENT_HEIGHT:20,ATTACHMENT_POSITION:"topright.topright",ATTACHMENT_XOFFSET:0,ATTACHMENT_YOFFSET:0,ATTACHMENT_PADDING:0,ATTACHMENT_PADDING_LEFT:0,ATTACHMENT_PADDING_RIGHT:0,ATTACHMENT_PADDING_TOP:0,ATTACHMENT_PADDING_BOTTOM:0,ATTACHMENT_DIRECTION:"right",ATTACHMENT_FILL:!1,ATTACHMENT_FILL_COLOR:"#000000",ATTACHMENT_GRADIENT:null,ATTACHMENT_GRADIENT_COLOR:"#FFFFFF",ATTACHMENT_OUTLINE_WIDTH:-1,ATTACHMENT_OUTLINE_COLOR:"#000000",ATTACHMENT_CAP:"butt",ATTACHMENT_JOIN:"miter",ATTACHMENT_SHADOWABLE:!0,NETWORK_TOOLTIP_ENABLED:!0,NETWORK_SELECT_MODE:"mix",NETWORK_MAKE_VISIBLE_ON_SELECTED:!0,NETWORK_NO_AGENT_LINK_VISIBLE:!1,NETWORK_REMOVE_ELEMENTUI_ON_INVISIBLE:!1,NETWORK_SUBNETWORK_ANIMATE:!0,NETWORK_SENDTOTOP_ON_SELECTED:!0,NETWORK_KEYBOARD_REMOVE_ENABLED:!0,NETWORK_KEYBOARD_SELECT_ENABLED:!0,NETWORK_RECT_SELECT_ENABLED:!0,NETWORK_DOUBLECLICK_TO_SUBNETWORK:!0,NETWORK_DOUBLECLICK_TO_UPSUBNETWORK:!0,NETWORK_DOUBLECLICK_TO_EMPTYSUBNETWORK:!0,NETWORK_DOUBLECLICK_TO_LINKBUNDLE:!0,NETWORK_DOUBLECLICK_TO_GROUPEXPAND:!0,NETWORK_SELECT_OUTLINE_COLOR:"#2877A8",NETWORK_SELECT_OUTLINE_WIDTH:1,NETWORK_SELECT_FILL_COLOR:"rgba(184,211,240,0.4)",NETWORK_LAZYMOVE_OUTLINE_COLOR:"#2877A8",NETWORK_LAZYMOVE_OUTLINE_WIDTH:1,NETWORK_LAZYMOVE_FILL_COLOR:"rgba(184,211,240,0.4)",NETWORK_LAZYMOVE_FILL:!0,NETWORK_LAZYMOVE_ANIMATE:!0,NETWORK_RESIZE_POINT_SIZE:3,NETWORK_RESIZE_POINT_FILL_COLOR:"#FFFFFF",NETWORK_RESIZE_POINT_OUTLINE_COLOR:"#000000",NETWORK_RESIZE_POINT_OUTLINE_WIDTH:1,NETWORK_RESIZE_LINE_COLOR:"#000000",NETWORK_RESIZE_LINE_WIDTH:1,NETWORK_RESIZE_ANIMATE:!0,NETWORK_EDIT_POINT_SIZE:3,NETWORK_EDIT_POINT_FILL_COLOR:"#FFFF00",NETWORK_EDIT_POINT_OUTLINE_COLOR:"#000000",NETWORK_EDIT_POINT_OUTLINE_WIDTH:1,NETWORK_EDIT_LINE_COLOR:"rgba(184,211,240,0.7)",NETWORK_EDIT_LINE_WIDTH:2,NETWORK_ROTATE_POINT_SIZE:5,NETWORK_ROTATE_POINT_FILL_COLOR:"#FFFF00",NETWORK_ROTATE_POINT_OFFSET:15,NETWORK_ROTATE_POINT_OUTLINE_WIDTH:1,NETWORK_ROTATE_POINT_OUTLINE_COLOR:"rgba(0,0,0,1)",NETWORK_ROTATE_SCALE_FILL_COLOR:"rgb(227,166,103)",NETWORK_ROTATE_SCALE_FONT_COLOR:"#FFFFFF",NETWORK_ROTATE_SCALE_WIDTH:30,NETWORK_ROTATE_SCALE_HEIGHT:20,NETWORK_LIMIT_ELEMENT_INPOSITIVE_LOCATION:!0,NETWORK_LINK_FLOW_STEPPING:3,NETWORK_LINK_FLOW_COLOR:"#FF0000",NETWORK_LINK_FLOW_INTERVAL:600,NETWORK_SELECTION_TOLERANCE:2,NETWORK_TRANSPARENT_SELECTION_ENABLE:!1,SHOW_ALARM_IN_ATTACHMENT_DIV:!0,SHOW_LABEL_IN_ATTACHMENT_DIV:!1,SHOW_LABEL2_IN_ATTACHMENT_DIV:!1,SHOW_ICON_IN_ATTACHMENT_DIV:!1,SHOW_EDIT_IN_ATTACHMENT_DIV:!1,OVERVIEW_FILL_COLOR:"rgba(184,211,240,0.4)",OVERVIEW_OUTLINE_COLOR:"#B8D3F0",OVERVIEW_OUTLINE_WIDTH:1,OVERVIEW_SELECT_COLOR:"#0000FF",OVERVIEW_SELECT_WIDTH:1,OVERVIEW_PADDING:1,OVERVIEW_ANIMATE:!0,OVERVIEW_MAX_PACKING_WIDTH:-1,OVERVIEW_MAX_PACKING_HEIGHT:-1,TOUCH_MOVE_THRESHOLD:5,TOUCH_RECT_SELECT_THRESHOLD:20,TOUCH_ZOOM_THRESHOLD:30,LINK_BUNDLE_AGENT_FUNCTION:null,IS_LINK_ADJUSTED_TO_BOTTOM:!1,GROUP_EXPAND_ALIGN:"center",ELEMENTUI_FUNCTION:function(t,e){var i=e.getElementUIClass();return i?new i(t,e):null},CANVASUI_FUNCTION:function(t,e){var i=e.getCanvasUIClass();return i?new i(t,e):null},VECTORUI_FUNCTION:function(t,e){var i=e.getVectorUIClass();return i?new i(t,e):null},KEEP_DEFAULT_FUNCTION:function(t){return!(!t.target.keepDefault&&!t.target.getAttribute("keepDefault"))||(!(!t.target.parentNode||!t.target.parentNode.keepDefault&&!t.target.parentNode.getAttribute("keepDefault"))||!!t.shiftKey)},SORT_FUNCTION:function(t,i){if(t===i)return 0;if(null==t&&null!=i)return 1;if(null!=t&&null==i)return-1;if(null==t&&null==i)return 0;var n,o=typeof t,r=typeof i;return"string"===o&&"string"===r&&(n=t.localeCompare(i)),"number"===o&&"number"===r&&(n=t-i),n===e&&(n=(""+t).localeCompare(""+i)),n>0?1:0>n?-1:0},CENTER_LOCATION:!1,PIXEL_FILTER_FUNCTION:function(t,e){if(!e)return t;var i=.3*t.r+.59*t.g+.11*t.b;return{r:Math.floor(e.r*i/255),g:Math.floor(e.g*i/255),b:Math.floor(e.b*i/255)}}};!function(){var e=kn;if(t.OverrideTWaverDefaults)for(var i in OverrideTWaverDefaults)e[i]=OverrideTWaverDefaults[i];e.FONT=e.VIEW_FONT_SIZE&&e.VIEW_FONT_FAMILY?e.VIEW_FONT_SIZE+" "+e.VIEW_FONT_FAMILY:ze.createElement("canvas").getContext("2d").font,e.CHART_VALUE_FONT||(e.CHART_VALUE_FONT="10px "+e.VIEW_FONT_FAMILY),e.BARCHART_XSCALE_TEXT_FONT||(e.BARCHART_XSCALE_TEXT_FONT="10px "+e.VIEW_FONT_FAMILY),e.BARCHART_YSCALE_TEXT_FONT||(e.BARCHART_YSCALE_TEXT_FONT="10px "+e.VIEW_FONT_FAMILY),e.BARCHART_XAXIS_TEXT_FONT||(e.BARCHART_XAXIS_TEXT_FONT="12px "+e.VIEW_FONT_FAMILY),e.BARCHART_YAXIS_TEXT_FONT||(e.BARCHART_YAXIS_TEXT_FONT="12px "+e.VIEW_FONT_FAMILY),e.LINECHART_XSCALE_TEXT_FONT||(e.LINECHART_XSCALE_TEXT_FONT="10px "+e.VIEW_FONT_FAMILY),e.LINECHART_YSCALE_TEXT_FONT||(e.LINECHART_YSCALE_TEXT_FONT="10px "+e.VIEW_FONT_FAMILY),e.LINECHART_XAXIS_TEXT_FONT||(e.LINECHART_XAXIS_TEXT_FONT="12px "+e.VIEW_FONT_FAMILY),e.LINECHART_YAXIS_TEXT_FONT||(e.LINECHART_YAXIS_TEXT_FONT="12px "+e.VIEW_FONT_FAMILY),e.BUBBLECHART_XAXIS_TEXT_FONT||(e.BUBBLECHART_XAXIS_TEXT_FONT="12px "+e.VIEW_FONT_FAMILY),e.BUBBLECHART_YAXIS_TEXT_FONT||(e.BUBBLECHART_YAXIS_TEXT_FONT="12px "+e.VIEW_FONT_FAMILY),e.BUBBLECHART_XSCALE_TEXT_FONT||(e.BUBBLECHART_XSCALE_TEXT_FONT="10px "+e.VIEW_FONT_FAMILY),e.BUBBLECHART_YSCALE_TEXT_FONT||(e.BUBBLECHART_YSCALE_TEXT_FONT="10px "+e.VIEW_FONT_FAMILY),e.RADARCHART_AXIS_TEXT_FONT||(e.RADARCHART_AXIS_TEXT_FONT="12px "+e.VIEW_FONT_FAMILY),e.RADARCHART_SCALE_TEXT_FONT||(e.RADARCHART_SCALE_TEXT_FONT="10px "+e.VIEW_FONT_FAMILY),e.DIALCHART_SCALE_TEXT_FONT||(e.DIALCHART_SCALE_TEXT_FONT="10px "+e.VIEW_FONT_FAMILY)}(),De.Defaults=kn,Me.ext("twaver.Defaults",Object,{}),De.Colors={orange:"#EC6C00",orange_light:"#EF8200",orange_dark:"#EA5404",gray_light:"#666666",gray_dark:"#242424",green_light:"#57AB9A",green_dark:"#238475",blue_light:"#61B6D8",blue_dark:"#0089C1"},De.SerializationSettings=function(){var t=De.SerializationSettings;this.isDataBoxSerializable=t.isDataBoxSerializable,this.isLayerBoxSerializable=t.isLayerBoxSerializable,this.isStyleSerializable=t.isStyleSerializable,this.isClientSerializable=t.isClientSerializable,this.isImageSerializable=t.isImageSerializable,this._pm=Me.clone(t._pm),this._sm=Me.clone(t._sm),this._cm=Me.clone(t._cm)},function(){var t=De.SerializationSettings;t.isDataBoxSerializable=!0,t.isLayerBoxSerializable=!0,t.isStyleSerializable=!0,t.isClientSerializable=!0,t.isImageSerializable=!0,t._pm={},t._sm={},t._cm={},t.setPropertyType=function(e,i){t._pm[e]=i},t.getPropertyType=function(e){return t._pm[e]},t.setStyleType=function(e,i){t._sm[e]=i},t.getStyleType=function(e){return t._sm[e]},t.setClientType=function(e,i){t._cm[e]=i},t.getClientType=function(e){return t._cm[e]}}(),Me.ext("twaver.SerializationSettings",Object,{setPropertyType:function(t,e){this._pm[t]=e},getPropertyType:function(t){return this._pm[t]},setStyleType:function(t,e){this._sm[t]=e},getStyleType:function(t){return this._sm[t]},setClientType:function(t,e){this._cm[t]=e},getClientType:function(t){return this._cm[t]}}),De.Styles={_m:{},setStyle:function(t,e){null==e?delete De.Styles._m[t]:De.Styles._m[t]=e},getStyle:function(t){return De.Styles._m[t]},getStyleProperties:function(){return Me.keys(De.Styles._m)}},function(){var t=function(t,e){De.SerializationSettings.setPropertyType(t,e)};t("name","cdata"),t("name2","cdata"),t("icon","string"),t("toolTip","cdata"),t("parent","data"),t("layerId","string"),t("alarmState","alarmstate"),t("image","string"),t("imageUrl","string"),t("location","point"),t("width","number"),t("height","number"),t("expanded","boolean"),t("host","data"),t("fromNode","data"),t("toNode","data"),t("points","list.point"),t("segments","list.string"),t("angle","number"),t("visible","boolean"),t=function(t,e,i){null==i&&(i=null!=e?typeof e:"string"),De.Styles.setStyle(t,e),De.SerializationSettings.setStyleType(t,i)},t("chart.color",null),t("chart.value",0),t("chart.values",null,"list.number"),t("chart.value.color","#000000"),t("chart.value.font",null),t("chart.line.width",2),t("chart.marker.size",6),t("chart.marker.shape","circle"),t("chart.bubble.shape","circle"),t("chart.names",null,"list.string"),t("chart.xaxis.values",null,"list.number"),t("chart.yaxis.values",null,"list.number"),t("dialchart.rear.extension",0),t("dialchart.base.width",5),t("dialchart.top.width",0),t("dialchart.radius",.8),t("inner.color",null),t("outer.shape","rectangle"),t("outer.color",null),t("outer.width",2),t("outer.padding",1),t("outer.padding.left",0),t("outer.padding.right",0),t("outer.padding.top",0),t("outer.padding.bottom",0),t("outer.cap","butt"),t("outer.join","miter"),t("outer.style","border"),t("shadow.color",null),t("shadow.xoffset",3),t("shadow.yoffset",3),t("shadow.blur",6),t("select.style","shadow"),t("select.color","rgba(0, 0, 0, 0.7)"),t("select.shape","rectangle"),t("select.width",2),t("select.padding",2),t("select.padding.left",0),t("select.padding.right",0),t("select.padding.top",0),t("select.padding.bottom",0),t("select.cap","butt"),t("select.join","miter"),t("whole.alpha",1),t("body.type","default"),t("network.label",null,"cdata"),t("image.padding",0),t("image.padding.left",0),t("image.padding.right",0),t("image.padding.top",0),t("image.padding.bottom",0),t("image.state",null),t("vector.shape","rectangle"),t("vector.fill",!0),t("vector.fill.color","#CCCCFF"),t("vector.outline.width",-1),t("vector.outline.pattern",null,"array.number"),t("vector.outline.color","#5B5B5B"),t("vector.gradient","none"),t("vector.gradient.color","#FFFFFF"),t("vector.padding",0),t("vector.padding.left",0),t("vector.padding.right",0),t("vector.padding.top",0),t("vector.padding.bottom",0),t("vector.cap","butt"),t("vector.join","miter"),t("vector.deep",0),t("group.shape","rectangle"),t("group.fill",!0),t("group.fill.color","#CCCCFF"),t("group.outline.width",-1),t("group.outline.color","#5B5B5B"),t("group.gradient","none"),t("group.gradient.color","#FFFFFF"),t("group.padding",5),t("group.padding.left",0),t("group.padding.right",0),t("group.padding.top",0),t("group.padding.bottom",0),t("group.cap","butt"),t("group.join","miter"),t("group.deep",1),t("group.shape.roundrect.radius",-1),t("group.expend.image",null),t("group.expend.image.vector",!1),t("label.alpha",1),t("label.color","#000000"),t("label.font",null),t("label.position","bottom.bottom"),t("label.direction","below"),t("label.corner.radius",0),t("label.pointer.length",0),t("label.pointer.width",8),t("label.xoffset",0),t("label.yoffset",2),t("label.padding",0),t("label.padding.left",0),t("label.padding.right",0),t("label.padding.top",0),t("label.padding.bottom",0),t("label.fill",!1),t("label.fill.color","#C0C0C0"),t("label.gradient","none"),t("label.gradient.color","#FFFFFF"),t("label.outline.width",-1),t("label.outline.color","#000000"),t("label.cap","butt"),t("label.join","miter"),t("label.shadowable",!0),t("label.align","center"),t("label.rotate.angle",0),t("label.maxlength",0),t("link.label.rotatable",!1),t("label2.alpha",1),t("label2.color","#000000"),t("label2.font",null),t("label2.position","top.top"),t("label2.direction","below"),t("label2.corner.radius",0),t("label2.pointer.length",0),t("label2.pointer.width",8),t("label2.xoffset",0),t("label2.yoffset",-2),t("label2.padding",0),t("label2.padding.left",0),t("label2.padding.right",0),t("label2.padding.top",0),t("label2.padding.bottom",0),t("label2.fill",!1),t("label2.fill.color","#C0C0C0"),t("label2.gradient","none"),t("label2.gradient.color","#FFFFFF"),t("label2.outline.width",-1),t("label2.outline.color","#000000"),t("label2.cap","butt"),t("label2.join","miter"),t("label2.shadowable",!0),t("label2.align","center"),t("label2.rotate.angle",0),t("label2.maxlength",0),t("link.label2.rotatable",!1),t("icons.names",null,"array.string"),t("icons.colors",null,"array.string"),t("icons.position",null,"array.string"),t("icons.orientation",null,"array.string"),t("icons.xoffset",[0],"array.number"),t("icons.yoffset",[0],"array.number"),t("icons.xgap",[1],"array.number"),t("icons.ygap",[1],"array.number"),t("alarm.alpha",1),t("alarm.color","#000000"),t("alarm.font",null),t("alarm.position","hotspot"),t("alarm.direction","aboveright"),t("alarm.corner.radius",5),t("alarm.pointer.length",10),t("alarm.pointer.width",8),t("alarm.xoffset",0),t("alarm.yoffset",0),t("alarm.padding",0),t("alarm.padding.left",0),t("alarm.padding.right",0),t("alarm.padding.top",0),t("alarm.padding.bottom",0),t("alarm.gradient","none"),t("alarm.gradient.color","#FFFFFF"),t("alarm.outline.width",-1),t("alarm.outline.color","#000000"),t("alarm.cap","butt"),t("alarm.join","miter"),t("alarm.shadowable",!0),t("link.color","#658DC1"),t("link.width",3),t("link.cap","butt"),t("link.join","miter"),t("link.type","arc"),t("link.pattern",null,"array.number"),t("link.extend",20),t("link.control.point",null,"point"),t("link.bundle.id",0),t("link.bundle.enable",!0),t("link.bundle.expanded",!0),t("link.bundle.independent",!1),t("link.bundle.offset",20),t("link.bundle.gap",12),t("link.bundle.group.gap",0),t("link.looped.gap",6),t("link.looped.direction","northwest"),t("link.looped.type","arc"),t("link.from.position","center"),t("link.from.xoffset",0),t("link.from.yoffset",0),t("link.from.percent",null),t("link.from.at.edge",!0),t("link.to.position","center"),t("link.to.xoffset",0),t("link.to.yoffset",0),t("link.to.percent",null),t("link.to.at.edge",!0),t("link.split.by.percent",!0),t("link.split.percent",.5),t("link.split.value",20),t("link.corner","round"),t("link.xradius",8),t("link.yradius",8),t("link.flow",!1),t("link.flow.converse",!1),t("link.flow.offset",0),t("link.handler.alpha",1),t("link.handler.color","#000000"),t("link.handler.font",null),t("link.handler.position","topleft.topleft"),t("link.handler.direction","below"),t("link.handler.corner.radius",0),t("link.handler.pointer.length",0),t("link.handler.pointer.width",8),t("link.handler.xoffset",0),t("link.handler.yoffset",0),t("link.handler.padding",0),t("link.handler.padding.left",0),t("link.handler.padding.right",0),t("link.handler.padding.top",0),t("link.handler.padding.bottom",0),t("link.handler.fill",!1),t("link.handler.fill.color","#C0C0C0"),t("link.handler.gradient","none"),t("link.handler.gradient.color","#FFFFFF"),t("link.handler.outline.width",-1),t("link.handler.outline.color","#000000"),t("link.handler.cap","butt"),t("link.handler.join","miter"),t("link.handler.shadowable",!0),t("link.agent",!1),t("link.agent.color","#658DC1"),t("link.agent.width",3),t("link.agent.cap","butt"),t("link.agent.join","miter"),t("link.agent.type","arc"),t("link.agent.pattern",null,"array.number"),t("link.agent.extend",20),t("link.agent.control.point",null,"point"),t("link.agent.from.position","center"),t("link.agent.from.xoffset",0),t("link.agent.from.yoffset",0),t("link.agent.from.percent",null),t("link.agent.from.at.edge",!0),t("link.agent.to.position","center"),t("link.agent.to.xoffset",0),t("link.agent.to.yoffset",0),t("link.agent.to.percent",null),t("link.agent.to.at.edge",!0),t("link.agent.split.by.percent",!0),t("link.agent.split.percent",.5),t("link.agent.split.value",20),t("link.agent.corner","round"),t("link.agent.xradius",8),t("link.agent.yradius",8),t("link.agent.flow",!1),t("link.agent.flow.converse",!1),t("link.agent.flow.offset",0),t("follower.row.index",0),t("follower.column.index",0),t("follower.row.span",1),t("follower.column.span",1),t("follower.padding",0),t("follower.padding.left",0),t("follower.padding.right",0),t("follower.padding.top",0),t("follower.padding.bottom",0),t("follower.fill.cell",!0),t("follower.cell.position","center"),t("glow.blur",20),t("grid.row.count",1),t("grid.column.count",1),t("grid.row.percents",null,"array.number"),t("grid.column.percents",null,"array.number"),t("grid.border",1),t("grid.border.left",0),t("grid.border.right",0),t("grid.border.top",0),t("grid.border.bottom",0),t("grid.padding",1),t("grid.padding.left",0),t("grid.padding.right",0),t("grid.padding.top",0),t("grid.padding.bottom",0),t("grid.fill",!0),t("grid.fill.color","#C0C0C0"),t("grid.deep",1),t("grid.cell.deep",-1),t("shapelink.type","lineto"),t("shapenode.closed",!1),t("shapenode.pattern",null,"array.number"),t("bus.style","nearby"),t("arrow.from",!1),t("arrow.from.fill",!0),t("arrow.from.shape","arrow.standard"),t("arrow.from.color","#000000"),t("arrow.from.xoffset",0),t("arrow.from.yoffset",0),t("arrow.from.width",12),t("arrow.from.height",9),t("arrow.from.outline.color","#000000"),t("arrow.from.outline.width",-1),t("arrow.from.at.edge",!0),t("arrow.from.shadow",!1),t("arrow.from.shadow.color","#000000"),t("arrow.from.shadow.xoffset",0),t("arrow.from.shadow.yoffset",0),t("arrow.from.shadow.blur",16),t("arrow.to",!1),t("arrow.to.fill",!0),t("arrow.to.shape","arrow.standard"),t("arrow.to.color","#000000"),t("arrow.to.xoffset",0),t("arrow.to.yoffset",0),t("arrow.to.width",12),t("arrow.to.height",9),t("arrow.to.outline.color","#000000"),t("arrow.to.outline.width",-1),t("arrow.to.at.edge",!0),t("arrow.agent.from",!1),t("arrow.agent.from.fill",!0),t("arrow.agent.from.shape","arrow.standard"),t("arrow.agent.from.color","#000000"),t("arrow.agent.from.xoffset",0),t("arrow.agent.from.yoffset",0),t("arrow.agent.from.width",12),t("arrow.agent.from.height",9),t("arrow.agent.from.outline.color","#000000"),t("arrow.agent.from.outline.width",-1),t("arrow.agent.from.at.edge",!0),t("arrow.agent.from.shadow",!1),t("arrow.agent.from.shadow.color","#000000"),t("arrow.agent.from.shadow.xoffset",0),t("arrow.agent.from.shadow.yoffset",0),t("arrow.agent.from.shadow.blur",16),t("arrow.agent.to",!1),t("arrow.agent.to.fill",!0),t("arrow.agent.to.shape","arrow.standard"),t("arrow.agent.to.color","#000000"),t("arrow.agent.to.xoffset",0),t("arrow.agent.to.yoffset",0),t("arrow.agent.to.width",12),t("arrow.agent.to.height",9),t("arrow.agent.to.outline.color","#000000"),t("arrow.agent.to.outline.width",-1),t("arrow.agent.to.at.edge",!0),t("background.image",null),t("background.image.scope","viewport"),t("background.type","none"),t("background.outline.width",-1),t("background.outline.color",null),t("background.vector.padding",0),t("background.image.padding",0),t("background.image.stretch","fill"),t("background.vector.scope","viewport"),t("background.vector.fill",null),t("background.vector.fill.color",null),t("background.vector.gradient",!1),t("background.vector.gradient.color",null),t("background.vector.shape","rectangle"),t("background.outline.pattern",null,"array.number"),t("attachment.label.style","html"),t("attachment.label2.style","html"),t("attachment.alarm.style","html"),t("attachment.htmllabel.hyperlink",!1),t("attachment.htmllabel2.hyperlink",!1)}(),Me.ext("twaver.Styles",Object,{}),De.PropertyChangeDispatcher=function(){this._dispatcher=new De.EventDispatcher},Me.ext("twaver.PropertyChangeDispatcher",Object,{addPropertyChangeListener:function(t,e,i){this._dispatcher.add(t,e,i)},removePropertyChangeListener:function(t,e){this._dispatcher.remove(t,e)},firePropertyChange:function(t,e,i){if(e==i)return!1;var n={property:t,oldValue:e,newValue:i,source:this};return this._dispatcher.fire(n),this.onPropertyChanged(n),!0},onPropertyChanged:function(t){}}),De.animate.Animate=function(){},Me.ext("twaver.animate.Animate",Object,{current:0,step:8,delay:4,finishFunction:null,shouldBeFinished:!1,getCurrentDelay:function(){return this.delay*this.current+1},action:function(t){}}),De.animate.AnimateProperty=function(t,e,i){this.objects=t,this.newValues=e,this.finishFunction=i,this.oldValues=new hn;for(var n=this.objects.size(),o=0;n>o;o++){var r=this.objects.get(o);this.oldValues.add(this.getPropertyValue(r))}},Me.ext("twaver.animate.AnimateProperty",De.animate.Animate,{action:function(t){for(var e=this.objects.size(),i=0;e>i;i++){var n=this.objects.get(i),o=this.oldValues.get(i),r=this.newValues.get(i);this.currentAction(n,o,r,t)}},getPropertyValue:function(t){},currentAction:function(t,e,i,n){}}),De.animate.AnimateBounds=function(t,e,i){this.node=t,this.newBounds=e,this.oldBounds=t.getRect(),this.finishFunction=i},Me.ext("twaver.animate.AnimateBounds",De.animate.Animate,{shouldBeFinished:!0,action:function(t){var e=this.oldBounds,i=this.newBounds;this.node.setLocation(e.x+(i.x-e.x)*t,e.y+(i.y-e.y)*t),this.node.setSize(e.width+(i.width-e.width)*t,e.height+(i.height-e.height)*t)}}),De.animate.AnimateCenterLocation=function(t,e,i){De.animate.AnimateCenterLocation.superClass.constructor.call(this,t,e,i)},Me.ext("twaver.animate.AnimateCenterLocation",De.animate.AnimateProperty,{getPropertyValue:function(t){return t.getCenterLocation()},currentAction:function(t,e,i,n){var o=e.x+(i.x-e.x)*n,r=e.y+(i.y-e.y)*n;t.setCenterLocation(o,r)}}),De.animate.AnimateLocation=function(t,e,i){De.animate.AnimateLocation.superClass.constructor.call(this,t,e,i)},Me.ext("twaver.animate.AnimateLocation",De.animate.AnimateProperty,{getPropertyValue:function(t){return t.getLocation()},currentAction:function(t,e,i,n){var o=e.x+(i.x-e.x)*n,r=e.y+(i.y-e.y)*n;t.setLocation(o,r)}}),De.animate.AnimateScrollPosition=function(t,e,i){this.view=t,this.oldHorizontalOffset=t.scrollLeft,this.oldVerticalOffset=t.scrollTop,this.newHorizontalOffset=e,this.newVerticalOffset=i},Me.ext("twaver.animate.AnimateScrollPosition",De.animate.Animate,{action:function(t){this.view.scrollLeft=this.oldHorizontalOffset+(this.newHorizontalOffset-this.oldHorizontalOffset)*t,this.view.scrollTop=this.oldVerticalOffset+(this.newVerticalOffset-this.oldVerticalOffset)*t}}),De.animate.AnimateZoom=function(t,e,i){this.view=t,this.oldZoom=t.getZoom(),this.newZoom=e,this.finishFunction=i},Me.ext("twaver.animate.AnimateZoom",De.animate.Animate,{shouldBeFinished:!0,action:function(t){this.view.setZoom(this.oldZoom+(this.newZoom-this.oldZoom)*t,!1)}}),De.animate.AnimateXZoom=function(t,e,i){this.view=t,this.oldXZoom=t.getXZoom(),this.newXZoom=e,this.finishFunction=i},Me.ext("twaver.animate.AnimateXZoom",De.animate.Animate,{shouldBeFinished:!0,action:function(t){this.view.setXZoom(this.oldXZoom+(this.newXZoom-this.oldXZoom)*t,!1)}}),De.animate.AnimateYZoom=function(t,e,i){this.view=t,this.oldYZoom=t.getYZoom(),this.newYZoom=e,this.finishFunction=i},Me.ext("twaver.animate.AnimateYZoom",De.animate.Animate,{shouldBeFinished:!0,action:function(t){this.view.setYZoom(this.oldYZoom+(this.newYZoom-this.oldYZoom)*t,!1)}}),De.animate.AnimateXYZoom=function(t,e,i,n){this.view=t,this.oldXZoom=t.getXZoom(),this.newXZoom=e,this.oldYZoom=t.getYZoom(),this.newYZoom=i,this.finishFunction=n},Me.ext("twaver.animate.AnimateXYZoom",De.animate.Animate,{shouldBeFinished:!0,action:function(t){this.view.setXZoom(this.oldXZoom+(this.newXZoom-this.oldXZoom)*t,!1),this.view.setYZoom(this.oldYZoom+(this.newYZoom-this.oldYZoom)*t,!1)}}),De.animate.AnimateSubNetwork=function(t,e,i){this.network=t,this.subNetwork=e,this.finishFunction=i},Me.ext("twaver.animate.AnimateSubNetwork",De.animate.Animate,{shouldBeFinished:!0,action:function(t){t>.5?(this.network.getView().style.opacity=2*t-1,this.network._setCurrentSubNetwork(this.subNetwork)):this.network.getView().style.opacity=1-2*t}}),De.animate.AnimateManager={timer:null,animate:null,start:function(t,e){var i=De.animate.AnimateManager;t.current<0&&(t.current=0),e?Me.callLater(i.startImpl,null,[t],e):i.startImpl(t)},startImpl:function(t){var e=De.animate.AnimateManager;e.animate&&e.endAnimate(),e.animate=t,e.timer=setTimeout(e.tick,t.getCurrentDelay())},tick:function(){var t=De.animate.AnimateManager,e=t.animate;if(e){if(e.current<0)return void e.current++;e.current<e.step&&(e.current++,e.action(e.current/e.step),t.timer=setTimeout(t.tick,e.getCurrentDelay())),e.current>=e.step&&t.endAnimate()}},endAnimate:function(){var t=De.animate.AnimateManager;if(t.animate){t.animate.shouldBeFinished&&t.animate.current<t.animate.step&&(t.animate.current=t.animate.step,t.animate.action(t.animate.current/t.animate.step));var e=t.animate.finishFunction;t.animate=null,t.timer&&(clearTimeout(t.timer),t.timer=null),e&&e()}else t.timer&&(clearTimeout(t.timer),t.timer=null)}},De.DataBox=function(t){De.DataBox.superClass.constructor.apply(this,arguments),1===arguments.length&&(this._name=t),this._dataList=new hn,this._dataMap={},this._rootList=new hn,this._rootMap={},this._clientMap={},this._dataBoxChangeDispatcher=new De.EventDispatcher,this._dataPropertyChangeDispatcher=new De.EventDispatcher,this._hierarchyChangeDispatcher=new De.EventDispatcher,this._selectionModel=new De.SelectionModel(this)},Me.ext("twaver.DataBox",De.PropertyChangeDispatcher,{IClient:!0,__client:1,__new:1,_limit:-1,_name:"DataBox",_icon:kn.ICON_DATABOX,__accessor:["name","icon","toolTip"],getSelectionModel:function(){return this._selectionModel},size:function(){return this._dataList.size()},isEmpty:function(){return this._dataList.isEmpty()},getLimit:function(){return this._limit},setLimit:function(t){var e=this._limit;this._limit=t,this.firePropertyChange("limit",e,t),this._checkLimit()},_checkLimit:function(){this._limit>=0&&this.size()>this._limit&&this.removeFirst(this.size()-this._limit)},removeFirst:function(t){for(0===arguments.length&&(t=1);t>0&&this._dataList.size()>0;){var e=this._dataList.get(0);this.remove(e),t--}},getSiblings:function(t){if(!this.contains(t))throw t+" dosen't belong to this dataBox";var e=t.getParent();return e?e.getChildren():this._rootList},getRoots:function(){return this._rootList},getSiblingIndex:function(t){return t.getParent()?t.getParent().getChildren().indexOf(t):this._rootList.indexOf(t)},getDatas:function(){return this._dataList},getDataAt:function(t){return this._dataList.get(t)},toDatas:function(t,e){return this._dataList.toList(t,e)},forEach:function(t,e){this._dataList.forEach(t,e)},forEachReverse:function(t,e){this._dataList.forEachReverse(t,e)},forEachByDepthFirst:function(t,e,i){if(e)this._depthFirst(t,e,i);else for(var n=this._rootList.size(),o=0;n>o;o++){var r=this._rootList.get(o);if(!1===this._depthFirst(t,r,i))return}},_depthFirst:function(t,e,i){for(var n=e.getChildrenSize(),o=0;n>o;o++){var r=e.getChildAt(o);if(!1===this._depthFirst(t,r,i))return!1}if(i){if(!1===t.call(i,e))return!1}else if(!1===t(e))return!1},forEachByBreadthFirst:function(t,e,i){var n=new hn;for(e?n.add(e):this._rootList.forEach(n.add,n);n.size()>0;)if(e=n.removeAt(0),e.getChildren().forEach(n.add,n),i){if(!1===t.call(i,e))return}else if(!1===t(e))return},add:function(t,e){if(t){1===arguments.length&&(e=-1);var i=t.getId();if(this._dataMap.hasOwnProperty(i))throw"Data with ID '"+i+"' already exists";this._dataBoxChangeDispatcher.fire({kind:"preAdd",data:t}),this._dataMap[i]=t,this._dataList.add(t),t.getParent()||(this._rootMap[i]=t,e>=0?this._rootList.add(t,e):this._rootList.add(t)),t.addPropertyChangeListener(this.handleDataPropertyChange,this,!0),this._dataBoxChangeDispatcher.fire({kind:"add",data:t}),this._checkLimit()}},addByDescendant:function(t){this.add(t),t.getChildren().size()>0&&t.getChildren().forEach(function(t){this.addByDescendant(t)},this)},remove:function(t){this.removeById(t.getId())},removeSelection:function(){this._selectionModel.toSelection().forEach(function(t){this.remove(t)},this)},removeById:function(t){var e=this.getDataById(t);e&&(this._dataBoxChangeDispatcher.fire({kind:"preRemove",data:e}),e instanceof De.Link&&(e.setFromNode(null),e.setToNode(null)),e instanceof On&&e.getLinks()&&e.getLinks().toList().forEach(function(t){this.remove(t)},this),e instanceof On&&e.getFollowers()&&e.getFollowers().toList().forEach(function(t){t.setHost(null)}),e instanceof De.Follower&&e.getHost()&&e.setHost(null),e.toChildren().forEach(function(t){this.remove(t)},this),e.getParent()&&e.getParent().removeChild(e),this._dataList.remove(e),delete this._dataMap[t],this._rootMap[t]&&(delete this._rootMap[t],this._rootList.remove(e)),this._dataBoxChangeDispatcher.fire({kind:"remove",data:e}),e.removePropertyChangeListener(this.handleDataPropertyChange,this))},clear:function(){if(this._dataList.size()>0){this._dataList.forEach(function(t){t.removePropertyChangeListener(this.handleDataPropertyChange,this)},this);var t=this._dataList.toList();this._dataList.clear(),this._dataMap={},this._rootList.clear(),this._rootMap={},this._dataBoxChangeDispatcher.fire({kind:"clear",datas:t})}},getDataById:function(t){return this._dataMap[t]},containsById:function(t){return this._dataMap.hasOwnProperty(t)},contains:function(t){return!!t&&this._dataMap[t._id]===t},moveTo:function(t,e){if(!this.contains(t))throw t+" dosen't belong to this dataBox";var i=this.getSiblings(t),n=i.indexOf(t);n===e||0>n||e>=0&&e<=i.size()&&(i.remove(t),e>i.size()&&e--,i.add(t,e),this._hierarchyChangeDispatcher.fire({data:t,oldIndex:n,newIndex:e}))},moveUp:function(t){var e=this.getSiblings(t);this.moveTo(t,e.indexOf(t)-1)},moveDown:function(t){var e=this.getSiblings(t);this.moveTo(t,e.indexOf(t)+1)},moveToTop:function(t){this.moveTo(t,0)},moveToBottom:function(t){var e=this.getSiblings(t);this.moveTo(t,e.size())},moveSelectionUp:function(t){t||(t=this._selectionModel);var e=new hn;yi.findMoveUpDatas(t,e,this._rootList),e.forEach(this.moveUp,this)},moveSelectionDown:function(t){t||(t=this._selectionModel);var e=new hn;yi.findMoveDownDatas(t,e,this._rootList),e.forEach(this.moveDown,this)},moveSelectionToTop:function(t){t||(t=this._selectionModel);var e=new hn;yi.findMoveToTopDatas(t,e,this._rootList),e.forEach(this.moveToTop,this)},moveSelectionToBottom:function(t){t||(t=this._selectionModel);var e=new hn;yi.findMoveToBottomDatas(t,e,this._rootList),e.forEach(this.moveToBottom,this)},handleDataPropertyChange:function(t){var e=t.source;if("parent"===t.property){var i=e.getId();e.getParent()?this._rootMap[i]&&(delete this._rootMap[i],this._rootList.remove(e)):this._rootMap[i]||(this._rootMap[i]=e,this._rootList.add(e))}this.onDataPropertyChanged(e,t),this._dataPropertyChangeDispatcher.fire(t)},onDataPropertyChanged:function(t,e){},addDataBoxChangeListener:function(t,e,i){this._dataBoxChangeDispatcher.add(t,e,i)},removeDataBoxChangeListener:function(t,e){this._dataBoxChangeDispatcher.remove(t,e)},addDataPropertyChangeListener:function(t,e,i){this._dataPropertyChangeDispatcher.add(t,e,i)},removeDataPropertyChangeListener:function(t,e){this._dataPropertyChangeDispatcher.remove(t,e)},addHierarchyChangeListener:function(t,e,i){this._hierarchyChangeDispatcher.add(t,e,i)},removeHierarchyChangeListener:function(t,e){this._hierarchyChangeDispatcher.remove(t,e)},getRandomData:function(t){if(t){for(var e=new De.List,i=0;i<this._dataList.size()-1;i++){var n=this._dataList.get(i);n instanceof t&&e.add(n)}if(0==e.size())return null}return t?e.get(parseInt(De.Util.random()*e.size())):this._dataList.get(parseInt(De.Util.random()*this._dataList.size()))}}),De.ElementBox=function(t){De.ElementBox.superClass.constructor.apply(this,arguments),this._styleMap={},this._alarmBox=new De.AlarmBox(this),this._layerBox=new De.LayerBox(this),this._alarmStatePropagator=new De.AlarmStatePropagator(this),this._alarmStatePropagator.setEnable(!0),this._indexChangeDispatcher=new De.EventDispatcher,this._undoManager=new De.UndoManager(this)},De.ElementBox.IS_INTERESTED_ADJUSTELEMENTINDEX_PROPERTY={fromAgent:1,toAgent:1,expanded:1,parent:1,host:1},Me.ext("twaver.ElementBox",De.DataBox,{IStyle:!0,__style:1,_name:"ElementBox",add:function(t,e){if(t){if(!t.IElement)throw"Only IElement can be added into ElementBox";De.ElementBox.superClass.add.apply(this,arguments),this.adjustElementIndex(t)}},onDataPropertyChanged:function(t,e){De.ElementBox.IS_INTERESTED_ADJUSTELEMENTINDEX_PROPERTY[e.property]&&this.adjustElementIndex(t),De.ElementBox.superClass.onDataPropertyChanged.apply(this,arguments)},addIndexChangeListener:function(t,e,i){this._indexChangeDispatcher.add(t,e,i)},removeIndexChangeListener:function(t,e){this._indexChangeDispatcher.remove(t,e)},sendToTop:function(t){if(this.contains(t)){if(t!==this.getDatas().get(this.size()-1)){var e=this.getDatas().indexOf(t);this.getDatas().removeAt(e),this.getDatas().add(t),this._indexChangeDispatcher.fire({element:t,oldIndex:e,newIndex:this.size()-1})}t instanceof De.Link&&(t.getFromAgent()&&!t.getFromAgent().isAdjustedToBottom()&&this.sendToTop(t.getFromAgent()),t.getToAgent()&&!t.getToAgent().isAdjustedToBottom()&&this.sendToTop(t.getToAgent())),t instanceof On&&t.getFollowers()&&t.getFollowers().forEach(function(e){e.isRelatedTo(t)||t instanceof De.Follower&&e.isLoopedHostOn(t)||this.sendToTop(e)},this),t.ISubNetwork||t instanceof Mn&&!t.isExpanded()||t.getChildren().forEach(function(t){t instanceof De.Link||this.sendToTop(t)},this)}},sendToBottom:function(t,e){if(t!==e&&this.contains(t)&&(!e||this.contains(e))){var i=this.getDatas().remove(t),n=0;e&&(n=this.getDatas().indexOf(e)),this.getDatas().add(t,n),i!=n&&(this._indexChangeDispatcher.fire({element:t,oldIndex:i,newIndex:n}),!t.getParent()||t.getParent().ISubNetwork||t.getParent()instanceof De.Link||this.sendToBottom(t.getParent(),t))}},fireIndexChange:function(t,e,i){this._indexChangeDispatcher.fire({element:t,oldIndex:e,newIndex:i})},adjustElementIndex:function(t){this.contains(t)&&(t.isAdjustedToBottom()?(this.sendToBottom(t),t.getChildren().forEach(this.adjustElementIndex,this)):this.sendToTop(t))},forEachByLayer:function(t,e,i){var n=this.size(),o=this.getDatas();if(e)for(var r=0;n>r;r++){var a=o.get(r);if(this._layerBox.getLayerByElement(a)===e)if(i){if(!1===t.call(i,a))return}else if(!1===t(a))return}else this._layerBox.forEachByDepthFirst(function(e){for(var r=0;n>r;r++){var a=o.get(r);if(this._layerBox.getLayerByElement(a)===e)if(i){if(!1===t.call(i,a))return}else if(!1===t(a))return}},null,this)},forEachByLayerReverse:function(t,e,i){var n=new hn;this.forEachByLayer(function(t){n.add(t,0)},e),n.forEach(t,i)},getLayerBox:function(){return this._layerBox},getAlarmBox:function(){return this._alarmBox},getAlarmStatePropagator:function(){return this._alarmStatePropagator},startBatch:function(t,e){De._isInitializing=!0,De._bundleLinks={},De._links={},t.call(e);var i,n;for(var o in De._links)i=De._links[o],i._checkAgentNodeImpl();for(var o in De._bundleLinks)n=De._bundleLinks[o],_i.resetBundleLinks(n[0],n[1]);De._bundleLinks=null,De._links=null,De._isInitializing=!1},getUndoManager:function(){return this._undoManager}}),De.SelectionModel=function(t){De.SelectionModel.superClass.constructor.apply(this,arguments),this._selectionMode="multipleSelection",this._selectionList=new hn,this._selectionChangeDispatcher=new De.EventDispatcher,this._selectionMap={},this._setDataBox(t)},Me.ext("twaver.SelectionModel",De.PropertyChangeDispatcher,{getSelectionMode:function(){return this._selectionMode},setSelectionMode:function(t){if(this._selectionMode!==t&&("noneSelection"===t||"singleSelection"===t||"multipleSelection"===t)){this.clearSelection();var e=this._selectionMode;this._selectionMode=t,this.firePropertyChange("selectionMode",e,this._selectionMode)}},getDataBox:function(){return this._dataBox},_setDataBox:function(t){if(!t)throw"dataBox can not be null";if(this._dataBox!==t){this._dataBox&&(this.clearSelection(),this._dataBox.removeDataBoxChangeListener(this.handleDataBoxChange,this));var e=this._dataBox;this._dataBox=t,this._dataBox.addDataBoxChangeListener(this.handleDataBoxChange,this,!0),this.firePropertyChange("dataBox",e,this._dataBox)}},dispose:function(){this.clearSelection(),this._dataBox.removeDataBoxChangeListener(this.handleDataBoxChange,this)},handleDataBoxChange:function(t){if("remove"===t.kind){var e=t.data;this.contains(e)&&(this._selectionList.remove(e),delete this._selectionMap[e.getId()],this.fireSelectionChange("remove",new hn(e)))}else"clear"===t.kind&&this.clearSelection()},getFilterFunction:function(){return this._filterFunction},setFilterFunction:function(t){if(this._filterFunction!==t){this.clearSelection();var e=this._filterFunction;this._filterFunction=t,this.firePropertyChange("filterFunction",e,this._filterFunction)}},fireSelectionChange:function(t,e,i){i&&(this._selectionList.forEach(function(t){i.contains(t)?i.remove(t):i.add(t)}),e=i.toList()),this._selectionChangeDispatcher.fire({kind:t,datas:new hn(e)})},addSelectionChangeListener:function(t,e,i){this._selectionChangeDispatcher.add(t,e,i)},removeSelectionChangeListener:function(t,e){this._selectionChangeDispatcher.remove(t,e)},_filterList:function(t,e){for(var i=new hn(t),n=0;n<i.size();n++){var o=i.get(n);(this._filterFunction&&!this._filterFunction(o)||e&&this.contains(o)||!e&&!this.contains(o)||!this._dataBox.contains(o))&&(i.removeAt(n),n--)}return i},appendSelection:function(t){if("noneSelection"!==this._selectionMode){var e=this._filterList(t,!0);if(!e.isEmpty()){var i=null;"singleSelection"===this._selectionMode&&(i=new hn(this._selectionList),this._selectionList.clear(),this._selectionMap={},e=new hn(e.get(e.size()-1)));for(var n=0;n<e.size();n++){var o=e.get(n);this._selectionList.add(o),this._selectionMap[o.getId()]=o}this.fireSelectionChange("append",e,i)}}},removeSelection:function(t){var e=this._filterList(t);if(0!==e.size()){for(var i=0;i<e.size();i++){var n=e.get(i);this._selectionList.remove(n),delete this._selectionMap[n.getId()]}this.fireSelectionChange("remove",e)}},toSelection:function(t,e){return this._selectionList.toList(t,e)},getSelection:function(){return this._selectionList},setSelection:function(t){if("noneSelection"!==this._selectionMode&&(0!==this._selectionList.size()||null!=t)){var e=new hn(this._selectionList);this._selectionList.clear(),this._selectionMap={};var i=this._filterList(t,!0);"singleSelection"===this._selectionMode&&i.size()>1&&(i=new hn(i.get(i.size()-1)));for(var n=0;n<i.size();n++){var o=i.get(n);this._selectionList.add(o),this._selectionMap[o.getId()]=o}this.fireSelectionChange("set",null,e)}},clearSelection:function(){if(this._selectionList.size()>0){var t=this._selectionList.toList();this._selectionList.clear(),this._selectionMap={},this.fireSelectionChange("clear",t)}},selectAll:function(){if("noneSelection"!==this._selectionMode){var t=this._dataBox.toDatas(),e=0,i=null;if(this._filterFunction)for(e=0;e<t.size();e++)i=t.get(e),this._filterFunction(i)||(t.removeAt(e),e--);var n=new hn(this._selectionList);for(this._selectionList.clear(),this._selectionMap={},"singleSelection"===this._selectionMode&&t.size()>1&&(t=new hn(t.get(t.size()-1))),e=0;e<t.size();e++)i=t.get(e),this._selectionList.add(i),this._selectionMap[i.getId()]=i;this.fireSelectionChange("all",null,n)}},size:function(){return this._selectionList.size()},contains:function(t){return!!t&&null!=this._selectionMap[t.getId()]},getLastData:function(){return this._selectionList.size()>0?this._selectionList.get(this._selectionList.size()-1):null},getFirstData:function(){return this._selectionList.size()>0?this._selectionList.get(0):null},isSelectable:function(t){return!!t&&("noneSelection"!==this._selectionMode&&!(this._filterFunction&&!this._filterFunction(t)))}}),De.QuickFinder=function(t,e,i,n,o){if(this._map={},!t)throw"dataBox can not be null";if(!e)throw"propertyName can not be null";this._dataBox=t,this._propertyName=e,this._propertyType=i||"accessor","accessor"===this._propertyType&&(this._getter=Me.getter(e)),this._valueFunction=n||this.getValue,this._filterFunction=o||this.isInterested,this._dataBox.forEach(this._addData,this),this._dataBox.addDataBoxChangeListener(this.handleDataBoxChange,this,!0),this._dataBox.addDataPropertyChangeListener(this.handleDataPropertyChange,this,!0)},Me.ext("twaver.QuickFinder",Object,{_NULL_:"twaver-null-key",getValueFunction:function(){return this._valueFunction},getFilterFunction:function(){return this._filterFunction},handleDataBoxChange:function(t){"add"===t.kind?this._addData(t.data):"remove"===t.kind?this._removeData(t.data):"clear"===t.kind&&(this._map={})},handleDataPropertyChange:function(t){if(this._filterFunction.call(this,t.source)){if("accessor"===this._propertyType&&this._propertyName===t.property);else if("style"===this._propertyType&&t.source.IStyle&&"S:"+this._propertyName===t.property);else if("client"!==this._propertyType||"C:"+this._propertyName!==t.property)return;var e=this._getMap(t.oldValue);e&&e.remove(t.source),this._addData(t.source)}},_getMap:function(t){return t=null==t?this._NULL_:t,this._map[t]},find:function(t){var e=this._getMap(t);return e?e.toList():new hn},findFirst:function(t){var e=this._getMap(t);return!e||e.isEmpty()?null:e.get(0)},_addData:function(t){if(this._filterFunction.call(this,t)){var e=this._valueFunction.call(this,t),i=this._getMap(e);i||(i=new hn,e=null==e?this._NULL_:e,this._map[e]=i),i.add(t)}},_removeData:function(t){if(this._filterFunction.call(this,t)){var e=this._valueFunction.call(this,t),i=this._getMap(e);i&&(i.remove(t),i.isEmpty()&&(e=null==e?this._NULL_:e,delete this._map[e]))}},dispose:function(){this._dataBox.removeDataBoxChangeListener(this.handleDataBoxChange,this),this._dataBox.removeDataPropertyChangeListener(this.handleDataPropertyChange,this),delete this._dataBox},getDataBox:function(){return this._dataBox},getPropertyType:function(){return this._propertyType},getPropertyName:function(){return this._propertyName},isInterested:function(t){return!("style"===this._propertyType&&!t.IStyle||"accessor"===this._propertyType&&this._valueFunction===this.getValue&&!t[this._getter])},getValue:function(t){return"accessor"===this._propertyType?t[this._getter]():"style"===this._propertyType&&t.getStyle?t.getStyle(this._propertyName):"client"===this._propertyType&&t.getClient?t.getClient(this._propertyName):null}}),De.PropertyPropagator=function(t,e,i){if(!t)throw"dataBox can not be null";if(!e)throw"propertyName can not be null";this._dataBox=t,this._propertyName=e,this._propertyType=i||"accessor","accessor"===this._propertyType&&(this._getter=Me.getter(e),this._setter=Me.setter(e)),this._enable=!1,this._isPropagating=!1},Me.ext("twaver.PropertyPropagator",Object,{getDataBox:function(){return this._dataBox},getPropertyType:function(){return this._propertyType},getPropertyName:function(){return this._propertyName},isEnable:function(){return this._enable},setEnable:function(t){this._enable!==t&&(this._enable=t,this._enable?(this._dataBox.addDataBoxChangeListener(this.handleDataBoxChange,this),this._dataBox.addDataPropertyChangeListener(this.handleDataPropertyChange,this),this._dataBox.forEach(function(t){this.propagate(t)},this)):(this._dataBox.removeDataBoxChangeListener(this.handleDataBoxChange,this),this._dataBox.removeDataPropertyChangeListener(this.handleDataPropertyChange,this)))},handleDataBoxChange:function(t){t.data&&this.propagate(t.data)},handleDataPropertyChange:function(t){if(this.isInterestedProperty(t))this.propagate(t.source);else if("parent"===t.property){var e=t.oldValue;e&&this.propagate(e),this.propagate(t.source)}},isInterestedProperty:function(t){return"accessor"===this._propertyType&&this._propertyName===t.property||(!("style"!==this._propertyType||!t.IElement||"S:"+this._propertyName!==t.property)||"client"===this._propertyType&&"C:"+this._propertyName===t.property)},propagate:function(t){t&&!this._isPropagating&&(this._isPropagating=!0,this.propagateToTop(t),this._isPropagating=!1)},propagateToTop:function(t){for(this.propagateToParent(null,t);t&&t.getParent();)this.propagateToParent(t,t.getParent()),t=t.getParent()},propagateToParent:function(t,e){}}),De.AlarmStatePropagator=function(t){De.AlarmStatePropagator.superClass.constructor.call(this,t,"alarmState")},Me.ext("twaver.AlarmStatePropagator",De.PropertyPropagator,{handleDataPropertyChange:function(t){"enablePropagation"===t.property?this.propagate(t.source):De.AlarmStatePropagator.superClass.handleDataPropertyChange.call(this,t)},propagateToParent:function(t,e){var i=null;e.getChildren().forEach(function(t){var e=t.getAlarmState().getHighestOverallAlarmSeverity();De.AlarmSeverity.compare(e,i)>0&&(i=e)}),e.getAlarmState().setPropagateSeverity(i)}}),De.AlarmSeverity=function(t,e,i,n,o){this.value=t,this.name=e,this.nickName=i,this.color=n,this.displayName=o},Me.ext("twaver.AlarmSeverity",Object,{toString:function(){return this.displayName?this.displayName:this.name}}),function(){var t=De.AlarmSeverity;t.severities=new hn,t._vm={},t._nm={},t._cp=function(t,e){if(t&&e){var i=t.value-e.value;return i>0?1:0>i?-1:0}return t&&!e?1:!t&&e?-1:0},t.forEach=function(e,i){t.severities.forEach(e,i)},t.getSortFunction=function(){return t._cp},t.setSortFunction=function(e){t._cp=e,t.severities.sort(e)},t.add=function(e,i,n,o,r){var a=new t(e,i,n,o,r);return t._vm[e]=a,t._nm[i]=a,t.severities.add(a),t.severities.sort(t._cp),a},t.remove=function(e){var i=t._nm[e];return i&&(delete t._nm[e],delete t._vm[i.value],t.severities.remove(i)),i},t.CRITICAL=t.add(500,"Critical","C","#FF0000"),t.MAJOR=t.add(400,"Major","M","#FFA000"),t.MINOR=t.add(300,"Minor","m","#FFFF00"),t.WARNING=t.add(200,"Warning","W","#00FFFF"),t.INDETERMINATE=t.add(100,"Indeterminate","N","#C800FF"),t.CLEARED=t.add(0,"Cleared","R","#00FF00"),t.isClearedAlarmSeverity=function(t){return!!t&&0===t.value},t.getByName=function(e){return t._nm[e]},t.getByValue=function(e){return t._vm[e]},t.clear=function(){t.severities.clear(),t._vm={},t._nm={}},t.compare=function(e,i){return t._cp(e,i)}}(),De.AlarmState=function(t){this._e=t,this._nm={},this._am={},this._ps=null,this._haa=null,this._hna=null,this._hoa=null,this._hta=null,this._hls=!1,this._aac=0,this._nac=0},Me.ext("twaver.AlarmState",Object,{_ep:!0,_f:function(){this._c1(),this._c2(),this._c3(),this._c4(),this._c5(),this._c6(),this._c7(),this._e.firePropertyChange("alarmState",null,this)},getHighestAcknowledgedAlarmSeverity:function(){return this._haa},getHighestNewAlarmSeverity:function(){return this._hna},getHighestOverallAlarmSeverity:function(){return this._hoa},getHighestNativeAlarmSeverity:function(){return this._hta},hasLessSevereNewAlarms:function(){return this._hls},_c1:function(){var t=null;for(var e in this._am)e=De.AlarmSeverity.getByName(e),De.AlarmSeverity.isClearedAlarmSeverity(e)||0!==this.getAcknowledgedAlarmCount(e)&&(t=t&&De.AlarmSeverity.compare(t,e)>0?t:e);this._haa=t},_c2:function(){var t=null;for(var e in this._nm)e=De.AlarmSeverity.getByName(e),De.AlarmSeverity.isClearedAlarmSeverity(e)||0!==this.getNewAlarmCount(e)&&(t=t&&De.AlarmSeverity.compare(t,e)>0?t:e);this._hna=t},_c3:function(){if(!this._hna)return void(this._hls=!1);for(var t in this._nm)if(t=De.AlarmSeverity.getByName(t),!De.AlarmSeverity.isClearedAlarmSeverity(t)&&0!==this.getNewAlarmCount(t)&&De.AlarmSeverity.compare(this._hna,t)>0)return void(this._hls=!0);this._hls=!1},_c4:function(){var t=this._haa,e=this._hna,i=this._ps;this._hoa=t,De.AlarmSeverity.compare(e,this._hoa)>0&&(this._hoa=e),De.AlarmSeverity.compare(i,this._hoa)>0&&(this._hoa=i)},_c5:function(){var t=this._haa,e=this._hna;this._hta=t,De.AlarmSeverity.compare(e,this._hta)>0&&(this._hta=e)},increaseAcknowledgedAlarm:function(t,e){if(null==e&&(e=1),0!==e){var i=this._am[t.name];null==i&&(i=0),i+=e,this._am[t.name]=i,this._f()}},increaseNewAlarm:function(t,e){if(null==e&&(e=1),0!==e){var i=this._nm[t.name];null==i&&(i=0),i+=e,this._nm[t.name]=i,this._f()}},decreaseAcknowledgedAlarm:function(t,e){if(null==e&&(e=1),0!==e){var i=this._am[t.name];if(null==i&&(i=0),0>(i-=e))throw"Alarm count can not be negative";this._am[t.name]=i,this._f()}},decreaseNewAlarm:function(t,e){if(null==e&&(e=1),0!==e){var i=this._nm[t.name];if(null==i&&(i=0),0>(i-=e))throw"Alarm count can not be negative";this._nm[t.name]=i,this._f()}},acknowledgeAlarm:function(t){this.decreaseNewAlarm(t,1),this.increaseAcknowledgedAlarm(t,1)},acknowledgeAllAlarms:function(t){if(t){var e=this.getNewAlarmCount(t);this.decreaseNewAlarm(t,e),this.increaseAcknowledgedAlarm(t,e)}else for(var i in this._nm)this.acknowledgeAllAlarms(De.AlarmSeverity.getByName(i))},_c6:function(){this._aac=0;for(var t in this._am)t=De.AlarmSeverity.getByName(t),this._aac+=this.getAcknowledgedAlarmCount(t)},getAcknowledgedAlarmCount:function(t){if(t){var e=this._am[t.name];return null==e?0:e}return this._aac},getAlarmCount:function(t){return this.getAcknowledgedAlarmCount(t)+this.getNewAlarmCount(t)},_c7:function(){this._nac=0;for(var t in this._nm)t=De.AlarmSeverity.getByName(t),this._nac+=this.getNewAlarmCount(t)},getNewAlarmCount:function(t){if(t){var e=this._nm[t.name];return null==e?0:e}return this._nac},setNewAlarmCount:function(t,e){this._nm[t.name]=e,this._f()},removeAllNewAlarms:function(t){t?delete this._nm[t]:this._nm={},this._f()},setAcknowledgedAlarmCount:function(t,e){this._am[t.name]=e,this._f()},removeAllAcknowledgedAlarms:function(t){t?delete this._am[t.name]:this._am={},this._f()},isEmpty:function(){return null==this._hoa},clear:function(){this._am={},this._nm={},this._f()},getPropagateSeverity:function(){return this._ps},setPropagateSeverity:function(t){if(this._ep||(t=null),this._ps!==t){var e=this._ps;this._ps=t,this._f(),this._e.firePropertyChange("propagateSeverity",e,t)}},isEnablePropagation:function(){return this._ep},setEnablePropagation:function(t){var e=this._ep;this._ep=t,this._e.firePropertyChange("enablePropagation",e,t)&&(t||this.setPropagateSeverity(null))}}),De.AlarmBox=function(t){if(!t)throw"elementBox can not be null.";De.AlarmBox.superClass.constructor.call(this),this._elementBox=t,this._alarmElementMapping=new De.AlarmElementMapping(this,t),this._elementBox.addDataBoxChangeListener(this.handleElementBoxChange,this,!0),this.addDataBoxChangeListener(this.handleAlarmBoxChange,this,!0),this.addDataPropertyChangeListener(this.handleAlarmPropertyChange,this,!0)},Me.ext("twaver.AlarmBox",De.DataBox,{__accessor:["removeAlarmWhenElementIsRemoved"],_name:"AlarmBox",_removeAlarmWhenAlarmIsCleared:!1,_removeAlarmWhenElementIsRemoved:!0,getElementBox:function(){return this._elementBox},isRemoveAlarmWhenAlarmIsCleared:function(){return this._removeAlarmWhenAlarmIsCleared},setRemoveAlarmWhenAlarmIsCleared:function(t){var e=this._removeAlarmWhenAlarmIsCleared;this._removeAlarmWhenAlarmIsCleared=t,this.firePropertyChange("removeAlarmWhenAlarmIsCleared",e,t),t&&this.toDatas(function(t){return t.isCleared()}).forEach(this.remove,this)},getAlarmElementMapping:function(){return this._alarmElementMapping},setAlarmElementMapping:function(t){if(!t)throw"alarmElementMapping can not be null";if(this._alarmElementMapping!==t){var e=this._alarmElementMapping;this.getDatas().forEach(this._decreaseAlarmState,this),this._alarmElementMapping=t,this.getDatas().forEach(this._increaseAlarmState,this),this.firePropertyChange("alarmElementMapping",e,t)}},handleElementBoxChange:function(t){"add"===t.kind?this.handleElementAdded(t.data):"remove"===t.kind?(this.handleElementRemoved(t.data),this._removeAlarmWhenElementIsRemoved&&this.removeAlarmsByElement(t.data)):"clear"===t.kind&&(t.datas.forEach(this.handleElementRemoved,this),this._removeAlarmWhenElementIsRemoved&&this.clear())},handleAlarmBoxChange:function(t){"add"===t.kind?this._increaseAlarmState(t.data):"remove"===t.kind?this._decreaseAlarmState(t.data):"clear"===t.kind&&t.datas.forEach(this._decreaseAlarmState,this)},handleAlarmPropertyChange:function(t){var e=t.source;e.isCleared()||("alarmSeverity"===t.property?this.handleAlarmSeverityChange(e,t):"acked"===t.property&&this.handleAckedChange(e,t)),"cleared"===t.property&&(e.isCleared()?(this._decreaseAlarmState(e,!0),this._removeAlarmWhenAlarmIsCleared&&this.remove(e)):this._increaseAlarmState(e,!0))},handleAckedChange:function(t,e){if(t.getAlarmSeverity()){var i=this.getCorrespondingElements(t);if(i)for(var n=0;n<i.size();n++){var o=i.get(n);e.oldValue?o.getAlarmState().decreaseAcknowledgedAlarm(t.getAlarmSeverity()):o.getAlarmState().decreaseNewAlarm(t.getAlarmSeverity()),e.newValue?o.getAlarmState().increaseAcknowledgedAlarm(t.getAlarmSeverity()):o.getAlarmState().increaseNewAlarm(t.getAlarmSeverity())}}},handleAlarmSeverityChange:function(t,e){var i=e.oldValue,n=e.newValue,o=this.getCorrespondingElements(t);if(o)for(var r=0;r<o.size();r++){var a=o.get(r);i&&(t.isAcked()?a.getAlarmState().decreaseAcknowledgedAlarm(i):a.getAlarmState().decreaseNewAlarm(i)),n&&(t.isAcked()?a.getAlarmState().increaseAcknowledgedAlarm(n):a.getAlarmState().increaseNewAlarm(n))}},getCorrespondingAlarms:function(t){return this._alarmElementMapping.getCorrespondingAlarms(t)},getCorrespondingElements:function(t){return this._alarmElementMapping.getCorrespondingElements(t)},handleElementAdded:function(t){var e=this.getCorrespondingAlarms(t);if(e)for(var i=0;i<e.size();i++){var n=e.get(i);if(!n.isCleared()){var o=n.getAlarmSeverity();o&&(n.isAcked()?t.getAlarmState().increaseAcknowledgedAlarm(o):t.getAlarmState().increaseNewAlarm(o))}}},_increaseAlarmState:function(t,e){if(!t.isCleared()||e){var i=t.getAlarmSeverity();if(i){var n=this.getCorrespondingElements(t);if(n)for(var o=0;o<n.size();o++){var r=n.get(o);t.isAcked()?r.getAlarmState().increaseAcknowledgedAlarm(i):r.getAlarmState().increaseNewAlarm(i)}}}},_decreaseAlarmState:function(t,e){if(!t.isCleared()||e){var i=t.getAlarmSeverity();if(i){var n=this.getCorrespondingElements(t);if(n)for(var o=0;o<n.size();o++){var r=n.get(o);t.isAcked()?r.getAlarmState().decreaseAcknowledgedAlarm(i):r.getAlarmState().decreaseNewAlarm(i)}}}},handleElementRemoved:function(t){var e=this.getCorrespondingAlarms(t);e&&e.forEach(function(e){!e.isCleared()&&e.getAlarmSeverity()&&(e.isAcked()?t.getAlarmState().decreaseAcknowledgedAlarm(e.getAlarmSeverity()):t.getAlarmState().decreaseNewAlarm(e.getAlarmSeverity()))})},removeAlarmsByElement:function(t){var e=this.getCorrespondingAlarms(t);e&&e.forEach(this.remove,this)},add:function(t,e){if(!t.IAlarm)throw"Only IAlarm can be added into AlarmBox";this._removeAlarmWhenAlarmIsCleared&&t.isCleared()||De.AlarmBox.superClass.add.apply(this,arguments)}}),De.AlarmElementMapping=function(t,e){if(!e)throw"ElementBox can not be null";if(!t)throw"AlarmBox can not be null";this._elementBox=e,this._alarmBox=t,this._alarmsFinder=new De.QuickFinder(t,"elementId")},Me.ext("twaver.AlarmElementMapping",Object,{getCorrespondingAlarms:function(t){return this._alarmsFinder.find(t.getId())},getCorrespondingElements:function(t){var e=this._elementBox.getDataById(t.getElementId());return new hn(e)},dispose:function(){this._alarmsFinder.dispose(),delete this._elementBox,delete this._alarmBox,delete this._alarmsFinder}}),De.AlarmStateStatistics=function(t){De.AlarmStateStatistics.superClass.constructor.apply(this,arguments),this.sumNew=0,this.sumAcked=0,this.sumTotal=0,this.severtiyMap={},this.elementMap={},this.setElementBox(t)},Me.ext("twaver.AlarmStateStatistics",De.PropertyChangeDispatcher,{getElementBox:function(){return this._elementBox},setElementBox:function(t){if(!t)throw"ElementBox can not be null";if(this._elementBox!==t){var e=this._elementBox;e&&(e.removeDataPropertyChangeListener(this.handleElementPropertyChange,this),e.removeDataBoxChangeListener(this.handleElementBoxChange,this),this.severtiyMap={},this.elementMap={}),this._elementBox=t,this.reset(),t.addDataPropertyChangeListener(this.handleElementPropertyChange,this),t.addDataBoxChangeListener(this.handleElementBoxChange,this),this.firePropertyChange("elementBox",e,t)}},dispose:function(){this._elementBox.removeDataPropertyChangeListener(this.handleElementPropertyChange,this),this._elementBox.removeDataBoxChangeListener(this.handleElementBoxChange,this),delete this._elementBox},handleElementPropertyChange:function(t){"alarmState"===t.property&&(this.increase(t.source),this.fireAlarmStateChange())},handleElementBoxChange:function(t){"add"===t.kind?(this.increase(t.data),this.fireAlarmStateChange()):"remove"===t.kind?(this.decrease(t.data),this.fireAlarmStateChange()):"clear"===t.kind&&(this.severtiyMap={},this.elementMap={},this.fireAlarmStateChange())},fireAlarmStateChange:function(){this.sumAcked=0,this.sumNew=0,this.sumTotal=0,De.AlarmSeverity.forEach(function(t){var e=this.getSumInfo(t);this.sumAcked+=e.ackedCount,this.sumNew+=e.newCount,this.sumTotal+=e.totalCount},this),this.firePropertyChange("alarmState",!1,!0)},getNewAlarmCount:function(t){return t?this.getSumInfo(t).newCount:this.sumNew},getAcknowledgedAlarmCount:function(t){return t?this.getSumInfo(t).ackedCount:this.sumAcked},getTotalAlarmCount:function(t){return t?this.getSumInfo(t).totalCount:this.sumTotal},getSumInfo:function(t){var e=this.severtiyMap[t.name];return e||(e={},e.newCount=0,e.ackedCount=0,e.totalCount=0,this.severtiyMap[t.name]=e),e},decrease:function(t){var e=this.elementMap[t.getId()];e&&(delete this.elementMap[t.getId()],De.AlarmSeverity.forEach(function(t){var i=e[t.name],n=this.getSumInfo(t);n.newCount=n.newCount-i.newCount,n.ackedCount=n.ackedCount-i.ackedCount,n.totalCount=n.totalCount-i.totalCount},this))},increase:function(t){if(this.decrease(t),!this._filterFunction||this._filterFunction(t)){var e={};this.elementMap[t.getId()]=e,De.AlarmSeverity.forEach(function(i){var n={};n.newCount=t.getAlarmState().getNewAlarmCount(i),n.ackedCount=t.getAlarmState().getAcknowledgedAlarmCount(i),n.totalCount=t.getAlarmState().getAlarmCount(i),e[i.name]=n;var o=this.getSumInfo(i);o.newCount=o.newCount+n.newCount,o.ackedCount=o.ackedCount+n.ackedCount,o.totalCount=o.totalCount+n.totalCount},this)}},reset:function(){this.severtiyMap={},this.elementMap={},this._elementBox.forEach(this.increase,this),this.fireAlarmStateChange()},setFilterFunction:function(t){var e=this._filterFunction;this._filterFunction=t,this.reset(),this.firePropertyChange("filterFunction",e,t)},getFilterFunction:function(){return _filterFunction}}),De.LayerBox=function(t){De.LayerBox.superClass.constructor.call(this),this._elementBox=t,this._defaultLayer=new De.Layer(kn.LAYER_DEFAULT_ID,kn.LAYER_DEFAULT_NAME),this.add(this._defaultLayer)},Me.ext("twaver.LayerBox",De.DataBox,{_name:"LayerBox",getElementBox:function(){return this._elementBox},getDefaultLayer:function(){return this._defaultLayer},add:function(t,e){if(!t.ILayer)throw"Only ILayer can be added into LayerBox";De.LayerBox.superClass.add.apply(this,arguments)},removeById:function(t){if(t===this._defaultLayer.getId())throw"Cannot remove default layer";De.LayerBox.superClass.removeById.call(this,t)},getLayerByElement:function(t){if(!t)return null;if(t._layerId===kn.LAYER_DEFAULT_ID)return this._defaultLayer;var e=this.getDataById(t.getLayerId());return e||this._defaultLayer},clear:function(){this.toDatas().forEach(function(t){t!=this._defaultLayer&&this.removeById(t.getId())},this)}}),De.BundleLinks=function(t,e){this._links=t,this._siblings=e;var i,n,o=De.Styles.getStyle("link.bundle.expanded");for(i=0;i<t.size();i++){n=t.get(i);var r=n.getStyle("link.bundle.expanded",!1);if(null!=r){o=r;break}}if(null==o&&(o=!0),kn.LINK_BUNDLE_AGENT_FUNCTION){var a=kn.LINK_BUNDLE_AGENT_FUNCTION(t);null==a?a=t.get(0):a!=t.get(0)&&(t.remove(a),t.add(a,0))}for(i=0;i<t.size();i++)t.get(i).setStyle("link.bundle.expanded",o)},Me.ext("twaver.BundleLinks",Object,{getLinks:function(){return this._links},getSiblings:function(){return this._siblings},forEachSiblingLink:function(t,e){this._siblings.forEach(function(i){i.getLinks().forEach(t,e)})}});var Sn={bitsToNum:function(t){return t.reduce(function(t,e){return 2*t+e},0)},byteToBitArr:function(t){for(var e=[],i=7;i>=0;i--)e.push(!!(t&1<<i));return e},lzwDecode:function(t,e){for(var i,n,o=0,r=[],a=1<<t,s=a+1,l=t+1,h=[];;)if(n=i,(i=function(t){for(var i=0,n=0;t>n;n++)e.charCodeAt(o>>3)&1<<(7&o)&&(i|=1<<n),o++;return i}(l))!==a){if(i===s)break;if(i<h.length)n!==a&&h.push(h[n].concat(h[i][0]));else{if(i!==h.length)throw new Error("Invalid LZW code.");h.push(h[n].concat(h[n][0]))}r.push.apply(r,h[i]),h.length===1<<l&&12>l&&l++}else!function(){h=[],l=t+1;for(var e=0;a>e;e++)h[e]=[e];h[a]=[],h[s]=null}();return r}},En=function(t){this.data=t,this.len=this.data.length,this.pos=0};Me.ext(En,Object,{readByte:function(){if(this.pos>=this.data.length)throw new Error("Attempted to read past end of stream.");return 255&this.data.charCodeAt(this.pos++)},readBytes:function(t){for(var e=[],i=0;t>i;i++)e.push(this.readByte());return e},read:function(t){for(var e="",i=0;t>i;i++)e+=String.fromCharCode(this.readByte());return e},readUnsigned:function(){var t=this.readBytes(2);return(t[1]<<8)+t[0]}});var In=function(t){var e,i=t,n=null,o=null,r=null,a=0,s=null,l=null,h=null;this.frames=[],this.size={};var c=this,u=ze.createElement("canvas");this.loaded=!1;var d=function(){n=null,o=null,s=r,r=null,l=null};this.doParse=function(){Ln(i,y)};var f=function(t){e=t,c.size.width=e.width,c.size.height=e.height},p=function(t){g(),d(),n=t.transparencyGiven?t.transparencyIndex:null,o=t.delayTime,r=t.disposalMethod},g=function(){l&&c.frames.push({data:l.getImageData(0,0,e.width,e.height),delay:o})},_=function(t){l||(l=u.getContext("2d"));var i=c.frames.length,o=t.lctFlag?t.lct:e.gct;i>0&&(3===s?l.putImageData(c.frames[a].data,0,0):a=i-1,2===s&&(h||l.clearRect(h.leftPos,h.topPos,h.width,h.height)));var r=l.getImageData(t.leftPos,t.topPos,t.width,t.height);t.pixels.forEach(function(t,e){t!==n&&(r.data[4*e+0]=o[t][0],r.data[4*e+1]=o[t][1],r.data[4*e+2]=o[t][2],r.data[4*e+3]=255)}),l.putImageData(r,t.leftPos,t.topPos),h=t},m=function(){},v=function(t){return function(e){t(e)}},y={hdr:v(f),gce:v(p),com:v(m),app:{NETSCAPE:v(m)},img:v(_),eof:function(t){g(),c.loaded=!0}}},Ln=function(t,e){e||(e={});var i=function(e){for(var i=[],n=0;e>n;n++)i.push(t.readBytes(3));return i},n=function(){var e,i;i="";do{e=t.readByte(),i+=t.read(e)}while(0!==e);return i},o=function(){var n={};if(n.sig=t.read(3),n.ver=t.read(3),"GIF"!==n.sig)throw new Error("Not a GIF file.");n.width=t.readUnsigned(),n.height=t.readUnsigned();var o=Sn.byteToBitArr(t.readByte());n.gctFlag=o.shift(),n.colorRes=Sn.bitsToNum(o.splice(0,3)),n.sorted=o.shift(),n.gctSize=Sn.bitsToNum(o.splice(0,3)),n.bgColor=t.readByte(),n.pixelAspectRatio=t.readByte(),n.gctFlag&&(n.gct=i(1<<n.gctSize+1)),e.hdr&&e.hdr(n)},r=function(i){switch(i.label=t.readByte(),i.label){case 249:i.extType="gce",function(i){var n=(t.readByte(),Sn.byteToBitArr(t.readByte()));i.reserved=n.splice(0,3),i.disposalMethod=Sn.bitsToNum(n.splice(0,3)),i.userInput=n.shift(),i.transparencyGiven=n.shift(),i.delayTime=t.readUnsigned(),i.transparencyIndex=t.readByte(),i.terminator=t.readByte(),e.gce&&e.gce(i)}(i);break;case 254:i.extType="com",function(t){t.comment=n(),e.com&&e.com(t)}(i);break;case 1:i.extType="pte",function(i){t.readByte(),i.ptHeader=t.readBytes(12),i.ptData=n(),e.pte&&e.pte(i)}(i);break;case 255:i.extType="app",function(i){switch(t.readByte(),i.identifier=t.read(8),i.authCode=t.read(3),i.identifier){case"NETSCAPE":!function(i){t.readByte(),i.unknown=t.readByte(),i.iterations=t.readUnsigned(),i.terminator=t.readByte(),e.app&&e.app.NETSCAPE&&e.app.NETSCAPE(i)}(i);break;default:!function(t){t.appData=n(),e.app&&e.app[t.identifier]&&e.app[t.identifier](t)}(i)}}(i);break;default:i.extType="unknown",function(t){t.data=n(),e.unknown&&e.unknown(t)}(i)}},a=function(o){o.leftPos=t.readUnsigned(),o.topPos=t.readUnsigned(),o.width=t.readUnsigned(),o.height=t.readUnsigned();var r=Sn.byteToBitArr(t.readByte());o.lctFlag=r.shift(),o.interlaced=r.shift(),o.sorted=r.shift(),o.reserved=r.splice(0,2),o.lctSize=Sn.bitsToNum(r.splice(0,3)),o.lctFlag&&(o.lct=i(1<<o.lctSize+1)),o.lzwMinCodeSize=t.readByte();var a=n();o.pixels=Sn.lzwDecode(o.lzwMinCodeSize,a),o.interlaced&&(o.pixels=function(t,e){for(var i=new Array(t.length),n=t.length/e,o=[0,4,2,1],r=[8,8,4,2],a=0,s=0;4>s;s++)for(var l=o[s];n>l;l+=r[s])(function(n,o){var r=t.slice(o*e,(o+1)*e);i.splice.apply(i,[n*e,e].concat(r))})(l,a),a++;return i}(o.pixels,o.width)),e.img&&e.img(o)},s=function(){var i={};switch(i.sentinel=t.readByte(),String.fromCharCode(i.sentinel)){case"!":i.type="ext",r(i);break;case",":i.type="img",a(i);break;case";":i.type="eof",e.eof&&e.eof(i);break;default:throw new Error("Unknown block: 0x"+i.sentinel.toString(16))}"eof"!==i.type&&setTimeout(s,0)};!function(){o(),setTimeout(s,0)}()},Rn=function(t,e,i){var n=ze.createElement("canvas");return Pn(n,e.width,e.height),n.getContext("2d").clearRect(0,0,e.width,e.height),n.getContext("2d").putImageData(t[i].data,0,0),n},Pn=function(t,e,i){t.width=e,t.height=i,t.style.width=e+"px",t.style.height=i+"px"};De.Data=function(t){if(De.Data.superClass.constructor.apply(this,arguments),this._childList=new hn,this._childMap={},this._clientMap={},t===e||null===t)this._id=Me.id();else if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)this._id=t;else{for(var i in t)if("clients"===i)for(var n in t.clients)this._clientMap[n]=t.clients[n];else if("styles"===i)for(var o in t.styles)this._styleMap[o]=t.styles[o];else null!=t[i]&&("id"===i?this._id=t[i]:this[Me.setter(i)]&&this[Me.setter(i)](t[i]));null==this._id&&(this._id=Me.id())}},Me.ext("twaver.Data",De.PropertyChangeDispatcher,{IData:!0,IClient:!0,__client:1,__new:1,_parent:null,__accessor:["name","name2","icon","toolTip"],_icon:kn.ICON_DATA,_dragBoundsFunc:null,getId:function(){return this._id},getChildren:function(){return this._childList},getChildrenSize:function(){return this._childList.size()},toChildren:function(t,e){return this._childList.toList(t,e)},addChild:function(t,i){return i===e&&(i=this._childList.size()),!(!t||t===this)&&(!this._childMap[t.getId()]&&(!this.isDescendantOf(t)&&(t.getParent()&&t.getParent().removeChild(t),(0>i||i>this._childList.size())&&(i=this._childList.size()),this._childList.add(t,i),this._childMap[t._id]=t,t.setParent(this),this.firePropertyChange("children",null,t),this.onChildAdded(t,i),!0)))},onChildAdded:function(t,e){},removeChild:function(t){if(!t)return!1;if(!this._childMap[t._id])return!1;var e=this._childList.remove(t);return delete this._childMap[t._id],this.firePropertyChange("children",t,null),t.setParent(null),this.onChildRemoved(t,e),!0},onChildRemoved:function(t,e){},getChildAt:function(t){return this._childList.get(t)},clearChildren:function(){if(0===this._childList.size())return!1;for(var t=this._childList.toArray(),e=t.length,i=0;e>i;i++)this.removeChild(t[i]);return this.onChildrenCleared(t),!0},onChildrenCleared:function(t){},getParent:function(){return this._parent},setParent:function(t){if(!(this._isUpdatingParent||this._parent===t||this===t||t&&t.isDescendantOf(this))){var e=this._parent;this._parent=t,this._isUpdatingParent=!0,e&&e.removeChild(this),t&&t.addChild(this),delete this._isUpdatingParent,this.firePropertyChange("parent",e,t),this.onParentChanged(e,t)}},onParentChanged:function(t,e){},hasChildren:function(){return this._childList.size()>0},isRelatedTo:function(t){return!!t&&(this.isDescendantOf(t)||t.isDescendantOf(this))},isParentOf:function(t){return!!t&&null!=this._childMap[t._id]},isDescendantOf:function(t){if(!t)return!1;if(!t.hasChildren())return!1;for(var e=this._parent;e;){if(t===e)return!0;e=e.getParent()}return!1},getDragBoundsFunc:function(){return this._dragBoundsFunc},setDragBoundsFunc:function(t){this._dragBoundsFunc=t},toString:function(){return this.getName()?this.getName():this._id}}),De.Alarm=function(t,e,i,n,o){De.Alarm.superClass.constructor.call(this,t),this._elementId=e,this._alarmSeverity=i,this._acked=n||!1,this._cleared=o||!1},Me.ext("twaver.Alarm",De.Data,{IAlarm:!0,getElementId:function(){return this._elementId},__accessor:["acked","cleared","alarmSeverity"]}),De.Layer=function(t){De.Layer.superClass.constructor.call(this,t)},Me.ext("twaver.Layer",De.Data,{ILayer:!0,__accessor:["visible","movable","editable","rotatable"],_visible:!0,_movable:!0,_editable:!0,_rotatable:!0,_name:"Default"}),De.Element=function(t){this._styleMap=this._styleMap||{},this._alarmState=new De.AlarmState(this),De.Element.superClass.constructor.call(this,t)},Me.ext("twaver.Element",De.Data,{IElement:!0,IStyle:!0,__accessor:["layerId"],__bool:["visible","movable"],__style:1,_layerId:kn.LAYER_DEFAULT_ID,_visible:!0,_movable:!0,getAlarmState:function(){return this._alarmState},isAdjustedToBottom:function(){return!1},getElementUIClass:function(){return null},getCanvasUIClass:function(){return null},getVectorUIClass:function(){return null},s:function(t,i){return i===e?this.getStyle(t):(this.setStyle(t,i),this)}}),De.Dummy=function(t){De.Dummy.superClass.constructor.call(this,t)},Me.ext("twaver.Dummy",De.Element,{IDummy:!0});var On=function(t){this._location={x:0,y:0},On.superClass.constructor.call(this,t)};De.Node=On,On.IS_INTERESTED_NODE_PROPERTY={location:1,width:1,height:1,expanded:1},Me.ext("twaver.Node",De.Element,{_icon:kn.ICON_NODE,_image:kn.IMAGE_NODE,_imageUrl:null,_angle:0,getLoopedLinks:function(){return this._loopedLinks},getLinks:function(){return this._links},getAgentLinks:function(){return this._agentLinks},getFollowers:function(){return this._followers},_addFollower:function(t){this._followers||(this._followers=new hn),this._followers.add(t)},_removeFollower:function(t){this._followers.remove(t),this._followers.isEmpty()&&delete this._followers},getFromLinks:function(){return this._fromLinks},getToLinks:function(){return this._toLinks},_addFromLink:function(t){this._links||(this._links=new hn(!1)),this._fromLinks||(this._fromLinks=new hn(!1)),this._links.add(t),this._toLinks&&this._toLinks.contains(t)&&(this._loopedLinks||(this._loopedLinks=new hn(!1)),this._loopedLinks.add(t)),this._fromLinks.add(t)},_addToLink:function(t){this._links||(this._links=new hn(!1)),this._toLinks||(this._toLinks=new hn(!1)),this._links.add(t),this._fromLinks&&this._fromLinks.contains(t)&&(this._loopedLinks||(this._loopedLinks=new hn(!1)),this._loopedLinks.add(t)),this._toLinks.add(t)},_removeFromLink:function(t){this._links&&this._links.remove(t),this._fromLinks&&this._fromLinks.remove(t),this._loopedLinks&&this._loopedLinks.remove(t)},_removeToLink:function(t){this._links&&this._links.remove(t),this._toLinks&&this._toLinks.remove(t),this._loopedLinks&&this._loopedLinks.remove(t)},hasAgentLinks:function(){return null!=this._agentLinks&&!this._agentLinks.isEmpty()},getFromAgentLinks:function(){return this._fromAgentLinks},getToAgentLinks:function(){return this._toAgentLinks},_addFromAgentLink:function(t){this._fromAgentLinks||(this._fromAgentLinks=new hn(!1)),this._agentLinks||(this._agentLinks=new hn(!1)),this._fromAgentLinks.add(t),this._agentLinks.add(t)},_addToAgentLink:function(t){this._toAgentLinks||(this._toAgentLinks=new hn(!1)),this._agentLinks||(this._agentLinks=new hn(!1)),this._toAgentLinks.add(t),this._agentLinks.add(t)},_removeFromAgentLink:function(t){this._fromAgentLinks&&this._fromAgentLinks.remove(t),this._agentLinks&&this._agentLinks.remove(t)},_removeToAgentLink:function(t){this._toAgentLinks&&this._toAgentLinks.remove(t),this._agentLinks&&this._agentLinks.remove(t)},getImage:function(){return this._image},setImage:function(t){var e=this._image,i=this.getWidth(),n=this.getHeight();this._image=t,this.firePropertyChange("image",e,t),this.firePropertyChange("width",i,this.getWidth()),this.firePropertyChange("height",n,this.getHeight())},getImageUrl:function(){return this._imageUrl},setImageUrl:function(t){if(this._imageUrl!=t){var e=this._imageUrl;this._imageUrl=t,Tn.images[t]||De.imageUtil.registerImageByUrl(t,"svg"===De.imageUtil.getImageType(t),t),this.setImage(t),this.firePropertyChange("imageUrl",e,t)}},getX:function(){return this._location.x},getY:function(){return this._location.y},setX:function(t){this.setLocation(t,this._location.y)},setY:function(t){this.setLocation(this._location.x,t)},getLocation:function(){return this._location},setLocation:function(t,e){var i;if(i=2===arguments.length?{x:arguments[0],y:arguments[1]}:arguments[0],Me.num(i.x)&&Me.num(i.y)&&(i.x!==this._location.x||i.y!==this._location.y)){this._dragBoundsFunc&&(i=this._dragBoundsFunc(i));var n=this._location;this._location=i,this.firePropertyChange("location",n,i)}},getCenterLocation:function(){return kn.CENTER_LOCATION?this._location:{x:this.getX()+this.getWidth()/2,y:this.getY()+this.getHeight()/2}},setCenterLocation:function(t,e){var i;i=2===arguments.length?{x:arguments[0],y:arguments[1]}:Me.clone(arguments[0]),Me.num(i.x)&&Me.num(i.y)&&(kn.CENTER_LOCATION||(i.x-=this.getWidth()/2,i.y-=this.getHeight()/2),this.setLocation(i))},translate:function(t,e){this.setLocation(this.getX()+t,this.getY()+e)},getWidth:function(){if(Me.num(this._width)&&this._width>=0)return this._width;if("object"!=typeof this._image){var t=Me.getImageAsset(this._image);if(t){var e=t.getWidth();return Me.num(e)&&e>=0?e:(t=t._image,Gi(this,t,t,"w"))}}else if(this._image)return this._image.w;return kn.NODE_WIDTH},setWidth:function(t){var e=this._width;this._width=t,this.firePropertyChange("width",e,t)},getHeight:function(){if(Me.num(this._height)&&this._height>=0)return this._height;if("object"!=typeof this._image){var t=Me.getImageAsset(this._image);if(t){var e=t.getHeight();return Me.num(e)&&e>=0?e:(t=t._image,Gi(this,t,t,"h"))}}else if(this._image)return this._image.h;return kn.NODE_HEIGHT},setHeight:function(t){var e=this._height;this._height=t,this.firePropertyChange("height",e,t)},setSize:function(){2===arguments.length?(this.setWidth(arguments[0]),this.setHeight(arguments[1])):(this.setWidth(arguments[0].width),this.setHeight(arguments[0].height))},getSize:function(){return{width:this.getWidth(),height:this.getHeight()}},getRect:function(){var t=this.getOriginalRect();if(0===this._angle)return t;for(var e=We.createMatrix(this._angle*Math.PI/180,t.x+t.width/2,t.y+t.height/2),i=[{x:t.x,y:t.y},{x:t.x+t.width,y:t.y},{x:t.x+t.width,y:t.y+t.height},{x:t.x,y:t.y+t.height}],n=0,o=i.length;o>n;n++)i[n]=e.transform(i[n]);return We.getRect(i)},getOriginalRect:function(){var t=this,e=t.getWidth(),i=t.getHeight();return kn.CENTER_LOCATION?{x:t._location.x-e/2,y:t._location.y-i/2,width:e,height:i}:{x:t.getX(),y:t.getY(),width:e,height:i}},getAngle:function(){return this._angle},setAngle:function(t){var e=this._angle;this._angle=t%360,this.firePropertyChange("angle",e,this._angle)},onParentChanged:function(t,e){On.superClass.onParentChanged.call(this,t,e),this._checkLinkAgent()},_checkLinkAgent:function(){if(De._isInitializing){if(this._links)for(var t=this._links.size(),e=0;t>e;e++)this._links.get(e)._checkAgentNode()}else De.ElementBox.prototype.startBatch(function(){if(this._links)for(var t=this._links.size(),e=0;t>e;e++)this._links.get(e)._checkAgentNode()},this)},onPropertyChanged:function(t){if(On.superClass.onPropertyChanged.call(this,t),this._followers)for(var e=this._followers.toList(),i=e.size(),n=0;i>n;n++)e.get(n).handleHostPropertyChange(t);this.getParent()instanceof Mn&&On.IS_INTERESTED_NODE_PROPERTY[t.property]&&this.getParent().updateLocationFromChildren()},getElementUIClass:function(){return De.network.NodeUI},getCanvasUIClass:function(){return De.canvas.NodeUI},getVectorUIClass:function(){return De.vector.NodeUI}});var Dn=function(t){Dn.superClass.constructor.call(this,t)};De.HTMLNode=Dn,Me.ext("twaver.HTMLNode",De.Node,{getElementUIClass:function(){return De.network.HTMLNodeUI},getCanvasUIClass:function(){return De.canvas.HTMLNodeUI},getVectorUIClass:function(){return De.vector.HTMLNodeUI}}),De.Link=function(t,e,i){De.Link.superClass.constructor.call(this,t instanceof On?null:t),t instanceof On&&(i=e,e=t),e&&this.setFromNode(e),i&&this.setToNode(i)},De.Link.IS_INTERESTED_BUNDLE_STYLE={"link.bundle.enable":1,"link.bundle.id":1,"link.bundle.independent":1},Me.ext("twaver.Link",De.Element,{_fromNode:null,_toNode:null,_fromAgent:null,_toAgent:null,_icon:kn.ICON_LINK,getFromNode:function(){return this._fromNode},getToNode:function(){return this._toNode},getFromAgent:function(){return this._fromAgent},getToAgent:function(){return this._toAgent},setFromNode:function(t){if(this._fromNode!==t){var e=this._fromNode;this._fromNode=t,e&&e._removeFromLink(this),this._fromNode&&this._fromNode._addFromLink(this),this._checkAgentNode(),this.firePropertyChange("fromNode",e,t)}},setToNode:function(t){if(this._toNode!==t){var e=this._toNode;this._toNode=t,e&&e._removeToLink(this),this._toNode&&this._toNode._addToLink(this),this._checkAgentNode(),this.firePropertyChange("toNode",e,t)}},isLooped:function(){return this._fromNode===this._toNode&&null!=this._fromNode&&null!=this._toNode},_checkAgentNode:function(){De._isInitializing?De._links[this._id]||(De._links[this._id]=this):this._checkAgentNodeImpl()},_checkAgentNodeImpl:function(){var t,e,i=_i.figureFromAgent(this),n=this;this._fromAgent!=i&&(t=this._fromAgent,this._fromAgent&&this._fromAgent._removeFromAgentLink(this),this._fromAgent=i,this._fromAgent&&this._fromAgent._addFromAgentLink(this),this.firePropertyChange("fromAgent",t,this._fromAgent),De._isInitializing?(t&&this._toAgent&&(e=t._id+":"+this._toAgent._id,De._bundleLinks[e]||(De._bundleLinks[e]=[t,this._toAgent])),this._fromAgent&&this._toAgent&&(e=this._fromAgent._id+":"+this._toAgent._id,De._bundleLinks[e]||(De._bundleLinks[e]=[this._fromAgent,this._toAgent]))):(_i.resetBundleLinks(t,n._toAgent),_i.resetBundleLinks(n._fromAgent,n._toAgent)));var o=_i.figureToAgent(this);this._toAgent!=o&&(t=this._toAgent,this._toAgent&&this._toAgent._removeToAgentLink(this),this._toAgent=o,this._toAgent&&this._toAgent._addToAgentLink(this),this.firePropertyChange("toAgent",t,this._toAgent),De._isInitializing?(t&&this._fromAgent&&(e=t._id+":"+this._fromAgent._id,De._bundleLinks[e]||(De._bundleLinks[e]=[t,this._fromAgent])),this._toAgent&&this._fromAgent&&(e=this._toAgent._id+":"+this._fromAgent._id,De._bundleLinks[e]||(De._bundleLinks[e]=[this._toAgent,this._fromAgent]))):(_i.resetBundleLinks(t,n._fromAgent),_i.resetBundleLinks(n._toAgent,n._fromAgent)))},_setBundleLinks:function(t){this._bundleLinks=t,this.firePropertyChange("bundleLinks",!0,!1)},getBundleLinks:function(){return this._bundleLinks},getBundleCount:function(){return this._bundleLinks?this._bundleLinks.getLinks().size():1},getBundleIndex:function(){return this._bundleLinks?this._bundleLinks.getLinks().indexOf(this):0},reverseBundleExpanded:function(){if(this._bundleLinks&&this._bundleLinks.getLinks().size()>0){var t,e,i=this._bundleLinks.getLinks(),n=!this.getStyle("link.bundle.expanded");for(t=0;t<i.size();t++)e=i.get(t),e.setStyle("link.bundle.expanded",n);var o=this._bundleLinks.getSiblings();for(t=0;t<o.size();t++){var r=o.get(t);if(r!=this._bundleLinks){i=r.getLinks();for(var a=0;a<i.size();a++)e=i.get(a),e.firePropertyChange("bundleLinks",null,r)}}return!0}return!1},isBundleAgent:function(){return null!=this._bundleLinks&&this._bundleLinks.getLinks().size()>1&&this===this._bundleLinks.getLinks().get(0)&&!this.getStyle("link.bundle.expanded")},onStyleChanged:function(t,e,i){De.Link.superClass.onStyleChanged.call(this,t,e,i),De.Link.IS_INTERESTED_BUNDLE_STYLE[t]&&_i.resetBundleLinks(this._toAgent,this._fromAgent)},getElementUIClass:function(){return De.network.LinkUI},getCanvasUIClass:function(){return De.canvas.LinkUI},getVectorUIClass:function(){return De.vector.LinkUI},isAdjustedToBottom:function(){return kn.IS_LINK_ADJUSTED_TO_BOTTOM}}),De.HTMLLink=function(t,e,i){De.HTMLLink.superClass.constructor.call(this,t,e,i)},De.Util.ext("twaver.HTMLLink",De.Link,{getElementUIClass:function(){return De.network.HTMLLinkUI},getCanvasUIClass:function(){return De.canvas.HTMLLinkUI},getVectorUIClass:function(){return De.vector.HTMLLinkUI}}),De.Follower=function(t){this._isUpdatingFollower=!1,this._isUpdatingLocation=!1,De.Follower.superClass.constructor.call(this,t)},De.Follower.IS_INTERESTED_HOST_GRID_PROPERTY={location:1,width:1,height:1,"S:grid.row.count":1,"S:grid.column.count":1,"S:grid.row.percents":1,"S:grid.column.percents":1,"S:grid.border":1,"S:grid.border.left":1,"S:grid.border.right":1,"S:grid.border.top":1,"S:grid.border.bottom":1,"S:grid.padding":1,"S:grid.padding.left":1,"S:grid.padding.right":1,"S:grid.padding.top":1,"S:grid.padding.bottom":1},De.Follower.IS_INTERESTED_FOLLOWER_STYLE={"follower.row.index":1,"follower.column.index":1,"follower.row.span":1,"follower.column.span":1,"follower.padding":1,"follower.padding.left":1,"follower.padding.right":1,"follower.padding.top":1,"follower.padding.bottom":1},Me.ext("twaver.Follower",On,{_host:null,getHost:function(){return this._host},setHost:function(t){if(this!==t&&this._host!==t){var e=this._host;e&&e._removeFollower(this),this._host=t,this._host&&this._host._addFollower(this),this.firePropertyChange("host",e,t),this.onHostChanged(e,t)}},onStyleChanged:function(t,e,i){De.Follower.superClass.onStyleChanged.call(this,t,e,i),De.Follower.IS_INTERESTED_FOLLOWER_STYLE[t]&&this.updateFollower(null)},setLocation:function(){this._isUpdatingLocation||(this._isUpdatingLocation=!0,De.Follower.superClass.setLocation.apply(this,arguments),this._isUpdatingLocation=!1)},onHostChanged:function(t,e){this.updateFollower(null)},handleHostPropertyChange:function(t){this.updateFollower(t)},updateFollower:function(t){this._isUpdatingFollower||Me.isDeserializing||(this._isUpdatingFollower=!0,this.updateFollowerImpl(t),this._isUpdatingFollower=!1)},updateFollowerImpl:function(t){var e=this.getHost();if(e instanceof De.Grid){if(!t||De.Follower.IS_INTERESTED_HOST_GRID_PROPERTY[t.property]){var i=this.getStyle("follower.row.index"),n=this.getStyle("follower.column.index"),o=e.getCellRect(i,n);if(!o)return;var r=this.getStyle("follower.row.span"),a=this.getStyle("follower.column.span");if(1!=r||1!=a){var s=e.getCellRect(i+r-1,n+a-1);s&&(o=We.unionRect(o,s))}if(We.addPadding(o,this,"follower.padding"),this.getStyle("follower.fill.cell"))this.setLocation(o.x,o.y),this.setWidth(o.width),this.setHeight(o.height);else{var l=this.getStyle("follower.cell.position");o=Ze.get(l,o,this.getRect()),this.setLocation(o.x,o.y)}}}else if(null!=t&&"location"===t.property){var h=t.oldValue,c=t.newValue,u=this.getLocation();this.setLocation(u.x+(c.x-h.x),u.y+(c.y-h.y))}},isHostOn:function(t){if(!t)return!1;for(var e={},i=this._host;i&&i!=this&&!e[i.getId()];){if(i===t)return!0;e[i.getId()]=i,i=i instanceof De.Follower?i.getHost():null}return!1},isLoopedHostOn:function(t){return this.isHostOn(t)&&t.isHostOn(this)}});var Mn=function(t){this._isUpdatingLocationFromChildren=!1,this._isAdjusting=!1,this._expanded=!1,Mn.superClass.constructor.call(this,t)};De.Group=Mn,Me.ext("twaver.Group",De.Follower,{_image:kn.IMAGE_GROUP,_icon:kn.ICON_GROUP,isAdjustedToBottom:function(){return this.isExpanded()&&_i.hasAgentLinks(this)},onChildAdded:function(t,e){Mn.superClass.onChildAdded.apply(this,arguments),this.updateLocationFromChildren()},onChildRemoved:function(t,e){Mn.superClass.onChildRemoved.apply(this,arguments),this.updateLocationFromChildren()},updateLocationFromChildren:function(){if(!this._isAdjusting&&!Me.isDeserializing){for(var t,e,i=0,n=this.getChildrenSize();n>i;i++)(e=this.getChildAt(i))instanceof On&&(t=We.unionRect(t,this.getChildRect(e)));t&&(this._isUpdatingLocationFromChildren=!0,"lefttop"===kn.GROUP_EXPAND_ALIGN?this.setLocation(t.x-this.getWidth()/2,t.y-this.getHeight()/2):this.setLocation(t.x+t.width/2-this.getWidth()/2,t.y+t.height/2-this.getHeight()/2),this._isUpdatingLocationFromChildren=!1)}},getChildRect:function(t){var e;return t instanceof On&&(t instanceof Mn?(t.isExpanded()&&t.getChildren().forEach(function(i){e=We.unionRect(e,t.getChildRect(i))}),e||(e=t.getRect())):e=t.getRect()),e},setLocation:function(){if(!this._isAdjusting){var t;if(t=2===arguments.length?{x:arguments[0],y:arguments[1]}:arguments[0],!Me.isDeserializing&&!this._isUpdatingLocationFromChildren){this._isAdjusting=!0;var e=t.x-this.getX(),i=t.y-this.getY();_i.moveElements(this.getChildren(),e,i),this._isAdjusting=!1}Mn.superClass.setLocation.call(this,t)}},reverseExpanded:function(){this.setExpanded(!this.isExpanded())},isExpanded:function(){return this._expanded},setExpanded:function(t){if(this._expanded!==t){var e=this._expanded;this._expanded=t,this.firePropertyChange("expanded",e,this._expanded),this._checkLinkAgent()}},_checkLinkAgent:function(){Mn.superClass._checkLinkAgent.call(this);for(var t=this.getChildrenSize(),e=0;t>e;e++){var i=this.getChildAt(e);i instanceof On&&i._checkLinkAgent()}},getElementUIClass:function(){return De.network.GroupUI},getCanvasUIClass:function(){return De.canvas.GroupUI},getVectorUIClass:function(){return De.vector.GroupUI}}),De.SubNetwork=function(t){De.SubNetwork.superClass.constructor.call(this,t)},Me.ext("twaver.SubNetwork",De.Follower,{ISubNetwork:!0,_image:kn.IMAGE_SUBNETWORK,_icon:kn.ICON_SUBNETWORK,_checkLinkAgent:function(){De.SubNetwork.superClass._checkLinkAgent.call(this);for(var t=this.getChildrenSize(),e=0;t>e;e++){var i=this.getChildAt(e);i instanceof On&&i._checkLinkAgent()}}}),De.Grid=function(t){De.Grid.superClass.constructor.call(this,t)},Me.ext("twaver.Grid",De.Follower,{_icon:kn.ICON_GRID,_image:null,getCellObject:function(t,e){1===arguments.length&&(e=t.y,t=t.x);for(var i=this.getStyle("grid.row.count"),n=this.getStyle("grid.column.count"),o=0;i>o;o++)for(var r=0;n>r;r++){var a=this.getCellRect(o,r);if(We.containsPoint(a,t,e))return{rowIndex:o,columnIndex:r,rect:a}}return null},getCellRect:function(t,e){var i=this.getStyle("grid.row.count"),n=this.getStyle("grid.column.count");if(0>=i||0>=n)return null;if(0>t||t>=i)return null;if(0>e||e>=n)return null;var o=this.getRect();We.addPadding(o,this,"grid.border");var r=0,a=this.getStyle("grid.row.percents"),s=this.getStyle("grid.column.percents");if(a&&a.length===i){var l=0;for(r=0;t>r;r++)l+=o.height*a[r];o.y+=l,o.height=o.height*a[t]}else o.height=o.height/i,o.y+=o.height*t;if(s&&s.length===n){var h=0;for(r=0;e>r;r++)h+=o.width*s[r];o.x+=h,o.width=o.width*s[e]}else o.width=o.width/n,o.x+=o.width*e;return We.addPadding(o,this,"grid.padding"),o},getElementUIClass:function(){return De.network.GridUI},getCanvasUIClass:function(){return De.canvas.GridUI},getVectorUIClass:function(){return De.vector.GridUI}}),De.ShapeNode=function(t){this._isUpdatingShapeNode=!1,this._points=new hn,De.ShapeNode.superClass.constructor.call(this,t)},Me.ext("twaver.ShapeNode",De.Follower,{_icon:kn.ICON_SHAPENODE,__accessor:["segments"],getElementUIClass:function(){return De.network.ShapeNodeUI},getCanvasUIClass:function(){return De.canvas.ShapeNodeUI},getVectorUIClass:function(){return De.vector.ShapeNodeUI},getPoints:function(){return this._points},setPoints:function(t){t||(t=new hn);var e=new hn(this._points);this._points=t,this.firePointsChange(e,this._points)},getSegments:function(){return this._segments},setSegments:function(t){t||(t=new hn);var e=new hn(this._segments);this._segments=t,this._reCalculateLineLength(),this.firePropertyChange("segments",e,this._segments)},addPoint:function(t,e){var i=new hn(this._points);this._points.add(t,e),this.firePointsChange(i,this._points)},setPoint:function(t,e){var i=new hn(this._points);this._points.set(t,e),this.firePointsChange(i,this._points)},removePoint:function(t){var e=new hn(this._points);this._points.remove(t),this.firePointsChange(e,this._points)},removeAt:function(t){var e=new hn(this._points);this._points.removeAt(t),this.firePointsChange(e,this._points)},setWidth:function(t){if(1>t&&(t=1),!this._isUpdatingShapeNode&&!Me.isDeserializing){this._isUpdatingShapeNode=!0;for(var e=new hn(this._points),i=0;i<this._points.size();i++){var n=this._points.get(i);n.x=(n.x-this.getX())*t/this.getWidth()+this.getX()}this.firePointsChange(e,this._points),this._isUpdatingShapeNode=!1}De.ShapeNode.superClass.setWidth.apply(this,arguments)},setHeight:function(t){if(1>t&&(t=1),!this._isUpdatingShapeNode&&!Me.isDeserializing){this._isUpdatingShapeNode=!0;for(var e=new hn(this._points),i=0;i<this._points.size();i++){var n=this._points.get(i);n.y=(n.y-this.getY())*t/this.getHeight()+this.getY()}this.firePointsChange(e,this._points),this._isUpdatingShapeNode=!1}De.ShapeNode.superClass.setHeight.apply(this,arguments)},setLocation:function(){if(!this._isUpdatingShapeNode&&!Me.isDeserializing){var t;if(t=2===arguments.length?{x:arguments[0],y:arguments[1]}:arguments[0],!Me.num(t.x)||!Me.num(t.y))return;var e=t.x-this.getX(),i=t.y-this.getY();if(0===e&&0===i)return;this._isUpdatingShapeNode=!0;for(var n=new hn(this._points),o=0;o<this._points.size();o++){var r=this._points.get(o);r.x+=e,r.y+=i}this.firePointsChange(n,this._points),this._isUpdatingShapeNode=!1}De.ShapeNode.superClass.setLocation.apply(this,arguments)},firePointsChange:function(t,e){if(!this._isUpdatingShapeNode&&!Me.isDeserializing){var i=We.getRect(e);i?(this._isUpdatingShapeNode=!0,kn.CENTER_LOCATION?this.setLocation(i.x+i.width/2,i.y+i.height/2):this.setLocation(i.x,i.y),this.setWidth(i.width),this.setHeight(i.height),this._isUpdatingShapeNode=!1):(this._isUpdatingShapeNode=!0,this.setWidth(0),this.setHeight(0),this._isUpdatingShapeNode=!1)}this._reCalculateLineLength(),this.firePropertyChange("points",t,e)},_reCalculateLineLength:function(){this._lineLength=null!=this._points&&this._points.size()>0?We.calculateLineLength(this._points,this._segments):0},getLineLength:function(){return this._lineLength}}),De.Bus=function(t){this._styleMap={},this._styleMap["vector.fill"]=!1,this._styleMap["shapenode.closed"]=!1,De.Bus.superClass.constructor.call(this,t)},Me.ext("twaver.Bus",De.ShapeNode,{_icon:kn.ICON_BUS,firePointsChange:function(t,e){var i=e.size();if(!Me.isDeserializing&&i>=2)for(var n=e.get(0),o=1;i>o;o++){var r=e.get(o);Math.abs(r.x-n.x)>Math.abs(r.y-n.y)?r.y=n.y:r.x=n.x,n=r}De.Bus.superClass.firePointsChange.apply(this,arguments)}}),De.ShapeLink=function(t,e,i){this._points=new hn,this._styleMap={},this._styleMap["link.bundle.enable"]=!1,De.ShapeLink.superClass.constructor.call(this,t,e,i)},Me.ext("twaver.ShapeLink",De.Link,{_icon:kn.ICON_SHAPELINK,getElementUIClass:function(){return De.network.ShapeLinkUI},getCanvasUIClass:function(){return De.canvas.ShapeLinkUI},getVectorUIClass:function(){return De.vector.ShapeLinkUI},getPoints:function(){return this._points},setPoints:function(t){t||(t=new hn);var e=new hn(this._points);this._points=t,this.firePointsChange(e,this._points)},addPoint:function(t,e){var i=new hn(this._points);this._points.add(t,e),this.firePointsChange(i,this._points)},setPoint:function(t,e){var i=new hn(this._points);this._points.set(t,e),this.firePointsChange(i,this._points)},removePoint:function(t){var e=new hn(this._points);this._points.remove(t),this.firePointsChange(e,this._points)},removeAt:function(t){var e=new hn(this._points);this._points.removeAt(t),this.firePointsChange(e,this._points)},firePointsChange:function(t,e){this.firePropertyChange("points",t,e)}}),De.ShapeSubNetwork=function(t){De.ShapeSubNetwork.superClass.constructor.call(this,t)},Me.ext("twaver.ShapeSubNetwork",De.ShapeNode,{ISubNetwork:!0,_icon:kn.ICON_SHAPESUBNETWORK,_checkLinkAgent:function(){De.ShapeSubNetwork.superClass._checkLinkAgent.call(this);for(var t=this.getChildrenSize(),e=0;t>e;e++){var i=this.getChildAt(e);i instanceof On&&i._checkLinkAgent()}}}),De.LinkSubNetwork=function(){De.LinkSubNetwork.superClass.constructor.apply(this,arguments)},Me.ext("twaver.LinkSubNetwork",De.Link,{ISubNetwork:!0,_icon:kn.ICON_LINKSUBNETWORK}),De.ShapeLinkSubNetwork=function(){De.ShapeLinkSubNetwork.superClass.constructor.apply(this,arguments)},Me.ext("twaver.ShapeLinkSubNetwork",De.ShapeLink,{ISubNetwork:!0,_icon:kn.ICON_LINKSUBNETWORK}),De.RotatableNode=function(t){De.RotatableNode.superClass.constructor.call(this,t)},Me.ext("twaver.RotatableNode",De.Follower,{getWidth:function(){return 0==this._angle?this._getOrignalWidth():this._getRotateRect().width},setWidth:function(t){},getHeight:function(){return 0==this._angle?this._getOrignalHeight():this._getRotateRect().height},setHeight:function(t){},getElementUIClass:function(){return De.network.RotatableNodeUI},getCanvasUIClass:function(){return De.canvas.RotatableNodeUI},getVectorUIClass:function(){return De.vector.RotatableNodeUI},_getRotateRect:function(){for(var t=this._getOrignalWidth(),e=this._getOrignalHeight(),i=We.createMatrix(this._angle*Math.PI/180,t/2,e/2),n=[{x:0,y:0},{x:t,y:0},{x:t,y:e},{x:0,y:e}],o=0,r=n.length;r>o;o++)n[o]=i.transform(n[o]);return We.getRect(n)},_getOrignalWidth:function(){return De.RotatableNode.superClass.getWidth.call(this)},_getOrignalHeight:function(){return De.RotatableNode.superClass.getHeight.call(this)}}),De.controls.ControlBase=function(){De.controls.ControlBase.superClass.constructor.apply(this,arguments),this._pools=new hn},Me.ext("twaver.controls.ControlBase",De.PropertyChangeDispatcher,{_autoAdjustBounds:!1,addPool:function(t){this._pools.contains(t)||this._pools.add(t)},removePool:function(t){this._pools.remove(t)},adjustBounds:function(t){var e=this._view.style;e.position="absolute",e.left=t.x+"px",e.top=t.y+"px",e.width=t.width+"px",e.height=t.height+"px",!0===this._autoAdjustBounds&&(e.left="0px",e.top="0px",e.right="0px",e.bottom="0px"),this.invalidate&&this.invalidate()},setAutoAdjustBounds:function(e){!0===e?Xe.addEventListener("resize","_handleResize",t,this):Xe.removeEventListener("resize",t,this),this._autoAdjustBounds=e},isAutoAdjustBounds:function(){return this._autoAdjustBounds},_handleResize:function(t){this.adjustBounds({x:0,y:0,width:ze.documentElement.clientWidth,height:ze.documentElement.clientHeight})},getView:function(){return this._view},invalidate:function(t){this._invalidate||(this._invalidate=!0,Me.callLater(this.validate,this,null,t))},validate:function(){this._invalidate&&(this._invalidate=!1,0===this._view.offsetWidth&&0===this._view.offsetHeight&&null!==this._reinvalidateCount?(this._reinvalidateCount===e&&(this._reinvalidateCount=100),this._reinvalidateCount>0?this._reinvalidateCount--:this._reinvalidateCount=null,this.invalidate()):this.validateImpl())},validateImpl:function(){}}),De.controls.ViewBase=function(){De.controls.ViewBase.superClass.constructor.apply(this,arguments),this._interactionDispatcher=new De.EventDispatcher,this._viewDispatcher=new De.EventDispatcher},Me.ext("twaver.controls.ViewBase",De.controls.ControlBase,{__bool:["focusOnClick"],_focusOnClick:kn.FOCUS_ON_CLICK,getSelectionModel:function(){return this._selectionModel?this._selectionModel:this._box.getSelectionModel()},isShareSelectionModel:function(){return null==this._selectionModel},setShareSelectionModel:function(t){var e=null==this._selectionModel;e!==t&&(t?(this._box.getSelectionModel().addSelectionChangeListener(this.handleSelectionChange,this),this._selectionModel.removeSelectionChangeListener(this.handleSelectionChange,this),this._selectionModel.dispose(),this._selectionModel=null):(this._box.getSelectionModel().removeSelectionChangeListener(this.handleSelectionChange,this),this._selectionModel=new De.SelectionModel(this._box),this._selectionModel.addSelectionChangeListener(this.handleSelectionChange,this)),this.onShareSelectionModelChanged(),this.firePropertyChange("shareSelectionModel",e,t))},removeSelection:function(){if(0===this.getSelectionModel().size())return null;var t=this.getSelectionModel().toSelection();return this._box._undoManager._enabled&&this._box._undoManager.startBatch(),t.forEach(function(t){this._box.remove(t)},this),this._box._undoManager._enabled&&this._box._undoManager.endBatch(),t},selectAll:function(){var t=new hn;return this._box.forEach(function(e){this.isVisible(e)&&t.add(e)},this),this.getSelectionModel().setSelection(t),t},isSelected:function(t){return this.getSelectionModel().contains(t)},isSelectable:function(t){return this.getSelectionModel().isSelectable(t)},getLabel:function(t){return t.getName()},getToolTip:function(t){return t.getToolTip()},getIcon:function(t){return t.getIcon()},getSelectColor:function(t){return kn.SELECT_COLOR},addViewListener:function(t,e,i){this._viewDispatcher.add(t,e,i)},removeViewListener:function(t,e){this._viewDispatcher.remove(t,e)},fireViewEvent:function(t){this._viewDispatcher.fire(t)},addInteractionListener:function(t,e,i){this._interactionDispatcher.add(t,e,i)},removeInteractionListener:function(t,e){this._interactionDispatcher.remove(t,e)},fireInteractionEvent:function(t){this._interactionDispatcher.fire(t)},invalidate:function(t){this._invalidate||(this._invalidate=!0,this.fireViewEvent({kind:"invalidate"}),Me.callLater(this.validate,this,null,t))},validate:function(){this._invalidate&&(this._invalidate=!1,0!==this._view.offsetWidth||0!==this._view.offsetHeight||null===this._reinvalidateCount?(this._isValidating=!0,this.fireViewEvent({kind:"validateStart"}),this.validateImpl(),this.fireViewEvent({kind:"validateEnd"}),delete this._isValidating):(this._reinvalidateCount===e&&(this._reinvalidateCount=100),this._reinvalidateCount>0?this._reinvalidateCount--:this._reinvalidateCount=null,this.invalidate()))}}),De.controls.View=function(){De.controls.View.superClass.constructor.apply(this,arguments)},Me.ext("twaver.controls.View",De.controls.ViewBase,{_zoom:1,_maxZoom:kn.ZOOM_MAX,_minZoom:kn.ZOOM_MIN,getRootDiv:function(){return this._rootDiv},isValidEvent:function(t){return Xe.isValidEvent(this._view,t)},getAlarmFillColor:function(t){if(t.IElement){var e=t.getAlarmState().getHighestNewAlarmSeverity();if(e)return e.color}return null},getInnerColor:function(t){if(t.IElement){var e=t.getAlarmState().getHighestNativeAlarmSeverity();return e?e.color:t.getStyle("inner.color")}return null},getOuterColor:function(t){if(t.IElement){var e=t.getAlarmState().getPropagateSeverity();return e?e.color:t.getStyle("outer.color")}return null},zoomOverview:function(t){var e=Math.min(this._view.clientWidth/this._viewRect.width,this._view.clientHeight/this._viewRect.height);this.setZoom(e,t)},getLogicalPoint:function(t){return Xe.getLogicalPoint(this._view,t,this.getZoom(),this._rootDiv)},centerByLogicalPoint:function(t,e,i){i&&De.animate.AnimateManager.endAnimate();var n=this._view.scrollWidth-this._view.clientWidth,o=this._view.scrollHeight-this._view.clientHeight,r=(t-this._view.clientWidth/this._zoom/2)*this._zoom,a=(e-this._view.clientHeight/this._zoom/2)*this._zoom;0>r&&(r=0),0>a&&(a=0),r>n&&(r=n),a>o&&(a=o),i?De.animate.AnimateManager.start(new De.animate.AnimateScrollPosition(this._view,r,a)):(this._view.scrollLeft=r,this._view.scrollTop=a)},panByOffset:function(t,e){t*=this.getZoom(),e*=this.getZoom();var i=this._view.scrollLeft+t,n=this._view.scrollTop+e,o=this._view.scrollWidth-this._view.clientWidth,r=this._view.scrollHeight-this._view.clientHeight;0>i&&(i=0),i>o&&(i=o),0>n&&(n=0),n>r&&(n=r);var a={x:(i-this._view.scrollLeft)/this.getZoom(),y:(n-this._view.scrollTop)/this.getZoom()};return this._view.scrollLeft=i,this._view.scrollTop=n,a},getMaxZoom:function(){return this._maxZoom},setMaxZoom:function(t){if(!(0>t)){var e=this._maxZoom;this._maxZoom=t,this.firePropertyChange("maxZoom",e,t),this.getZoom()>t&&this.setZoom(t)}},getMinZoom:function(){return this._minZoom},setMinZoom:function(t){if(!(0>t)){var e=this._minZoom;this._minZoom=t,this.firePropertyChange("minZoom",e,t),this.getZoom()<t&&this.setZoom(t,!1)}},getZoom:function(){return this._zoom},onZoomChanged:function(t,e){},zoomIn:function(t){this.setZoom(this._zoom*kn.ZOOM_INCREMENT,t)},zoomOut:function(t){this.setZoom(this._zoom/kn.ZOOM_INCREMENT,t)},zoomReset:function(t){this.setZoom(1,t)},checkZoom:function(t){return t<this._minZoom&&(t=this._minZoom),t>this._maxZoom&&(t=this._maxZoom),t},setZoom:function(t,e){if(Me.num(t)&&!(0>=t)&&(t=this.checkZoom(t))!==this._zoom)if(null==e&&(e=kn.ZOOM_ANIMATE),e)De.animate.AnimateManager.start(new De.animate.AnimateZoom(this,t));else{var i=(this._view.scrollLeft+this._view.clientWidth/2)/this._zoom,n=(this._view.scrollTop+this._view.clientHeight/2)/this._zoom,o=this._zoom;this._zoom=t,Xe.setZoom(this._rootDiv,t),this.firePropertyChange("zoom",o,t),this.onZoomChanged(o,t),this.centerByLogicalPoint(i,n,!1)}},setTouchZoom:function(t){this.setZoom(t,!1)}}),function(){var t=function(t,e,i,n){var o=new Ve;o.src=n,De.Util.registerImage(t,o,e,i)};t("subnetwork_image",64,46,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAAuCAYAAACYlx/0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAB1JJREFUeNrkWmtQk1cafr4vUQhEiNeBpkWwXitCqK1WaiU4tCMjlmCnrU4rmE4v2v1Rmf7q7M6is/uj7e4OurMz7fSyiXXVddsasBa0xQawoqiFFPBWJATkVpQSLPdLTt/zkTCgSHVNuISXeZLvnC8JeZ7zvu8578kBRs/UhB0EE6GZwIaBmbCToIEXWSjBcAfCI4GLoZ3QzIX+0RwgpYnUsPT0dGY2m5nDwYagqKiYGQwGlpiYeKsQJvoc1UQjriKYCYwjJiaG5eScYN09fXeF8qsVLDk5hbneT2gWJkpYyARBJQpCMYFNV6nYRx9/wtq7uv8vnD57jkVGRjL+WYRmgsYDg+U+U0ydoiJvNpPjagICA2E6moVlERH39Zkt9hboEuJxobSUN+2iKMR2dPdYxkSAQD+FhoJSxxiLAY9LNsgtBeS6+qYFBuC/piNYGr7MLV/yZksLXkx6FpfKynjTRiJEtbR32EdFgNmB01REeAdjSHFm9N8146Ev8fgTq9zqqr/evImN8XGoq6nhzd1Nv7amelwA9awZOsrQBjizsHLaNCxf8YSEhUseue0L/nT5IgICArAp5RWP5Jeis2fwxpbN0jX3gtobv1g8IkCYOkjFiDiNvI63gx5QQ7/tD1i9Ng5KZcCYJtl3095BdqaJf3NjVX2j3u0CLA4LUTkcDjNzxvfLr24jbIdDmpLH3q7X1yMlKb5/xpGJSTwxOm9ZLldW2+9LgIhF8/vJ05zr76/EO399H0siHh1vawykvf0mSi1Fw9220/1cQRDyCBklV67a7kmA5eFLTNzt/ZVK/Ond3VCHPjwu1xqWwlM4lvnFQLvKehVtra23kyMRKFfsOVdyMfd3BYheHrmV3J4nPPz57/9CcEgoxqsRMdBADbRFQaQ+4HJZCWqrrDhtzkG1zTr49UZC6qnzxfZhBVj75EqVo89RybN9/MZNWLvhuYldg5AaDTVVOPnNURTmmwfCQxTF2O8KCi23CbBO+xQVLSxt+szZSP3LP9DrcHhFGSrQX431CrI/34+6a1VOcUR9tjnfOESAxHVxvD5XPbtZjwWRj8HbzNHTjexDeylELM41hBhlyvpGagibdBv40tYUOGMmknf8ET19ffBGk4si8r76H0rPF0rhIJPJww4czrDLfXx9+bqeprsodHR1w1utF31YGZeAlqYbaGyo4yvbdIJe2KZPLuZbUNoNz2O6ei683dqbfsbxz/e5QiFMrlD4SSs+1aw5cHhJ8hvJlLOCMG/hYtRfq+YZ8C25r59CujHVz9+rQ8Bl3TTIcxeHo7npOp8BtHI/Ig7XBhzDpDDV7GA4eWvkhn37pc650esmRQg4Yx8u3nJrZaV00dbZjclkLt5yV0e1tRwPjtPix6PrA14+0rO2zlaBkHkLJgXpcloROqtAO/eAPC5AydkCPBkXPykE4FydlivnNTOpkVZCNXZXZwf8/JXevRBqa8UZ83EqoQU+8+2V0UODzxS5TibKgnx8fLAoQiOVk96KzH2foOJCKWSiYOvpc2yXkuAUuXwP3TaczMrA07oXoPBSL+Be/n1WJqbK5TT6LLWzpxcyaXXU22tRKnx1zNEbdL2uBo89tVZyEW9CXVUFDO/vAnHkW+pGe1vHe0O2xIJUARpBFHlhhKSt27AmYaPXjHz+14dhMnzY32Ast765JdZ1T+a6aO3sapih9K+Sy2S68pIizJwTBHXo/Akd7/XVVhz453sozMmmmBe5Jxhrm5qTht0Uddl8dbCB3ruVX6+O1yFhy2sTbsQvnj+D77MzYb1UMtDHHCz1al3D7mE3RW+1R8JC0klBfpwFwSFhWP/yqwijCmpckCsqRENVJYLnhsGXCprO9jbUU7ujvRUN1ZVEumzI6xljRsKuS7ZrtuH3De9gkQvn6URBHPhdMJQEWPVMAhZHrRgz8vYbjfgg7W2J9EhGGd5GDxlEfM+P5VbbyBunI9jjSxepyBO4N2wd3B+6aCkio7USRss6O9rw2d92oqF/IG1E7lZiedTH9/1zz124ctc/mt7V+YBoTXgoifAWQUcIdfVvSNmOiFVrRkWAr/Z+iJLTeZIjUNkedaq41OaOz73nEyKxK5drnGJIXrF+y+tYtnK1B0e+HSe+3I/SMyelNidvLvxhbE6IDLb4mGiDS4SlK1YjVrcZvgo/t5JvrK3GsYOfSs/95Jn+WH6B0Z3/477OCCU+rd1JIqTx68AZs6DVbcKCcI0bRr0DRfnfouD4kYH8RyMfeyQnz+JuD7vvQ1LPr39GSyIYXLlhzgMP4dE1cZIQ9+oRLb/cQNm5Avxw8gS6yPWd01gukdd/kfWtzRMh5pZTYi/p1vPZYoczNwwcapxPIoQ8vFASZY76IRJEMeR9P9fWSESvVfyE8rJiNNbVDJ6/eabf9R/TUSM8aG49Jqd/IUkliiIXImXwbHEvRqQtNOJ7/n3osEeJe0SAwbY9ebOGxOBnjGKcYtxJEAsnTfiRkPHBZwdtGEX7TYABAPgBTYK366ChAAAAAElFTkSuQmCC"),t("bus_icon",16,16,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAINJREFUeNqkU0EOgCAMo2Y/1P8Y/6NvnBADwTnGzHYiGetKW8DMKVJLChbVAwCNCrrzp5/Zg/4MaH0JMBOEh08o6OtxtgvXvkFuV/vFBeGEm0WZo8GgF+QlIkI2OrZq5WLAFjuy4DvVWXHl2VodyElMjkxAJNFm4EjmFGAqLKLf+RZgAKkFNRwzv7gHAAAAAElFTkSuQmCC"),t("data_icon",16,16,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAMZJREFUeNqkU8ENwjAM9KEwWwaAKVA3iMQDtRtUTAEDdLZWMkkhIUljU4n7RInP9p3dgoiYBAzDgHAyfykA1rtzbr2bmpDDk5uBvu+ROO98pvs4FqRL10nCogokBS3UBaXCZg9JQ7JQY5qmZoK1trCQCuQJnoS9CsQZHKsNcOyWvS1ehdGqz8xyZ0BXEHG+PTdvj+uJkFsASsusdN5sQSKHGWgWfDxY1GcQfEIYIn4p+HuN+SqXRtL8+ZAOinwm5V+P8ZcAAwC0T1T5kpEqewAAAABJRU5ErkJggg=="),t("databox_icon",16,16,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJpJREFUeNpi/P//PwMjI+N/BiIBUD0jMp8FpDm4cQ2DvYEiw8EL9/FqBqkBqUc3BGT7/0kbz/6HsXHhS/eewtWBXA7CYAMOX75PlCEgA9ANYYQaADbJVleRAShJ0Csw7+T5G2MaQCpgQReAuQAWqPhokAuYGCgEowZQwwBQuiYn/mGAEZaeYTkSlA6IBeCUCDMA2RBSsjZAgAEAOyp6/CYHWkwAAAAASUVORK5CYII="),t("grid_icon",16,16,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAFdJREFUeNpi/P//PwMlgImBQsACIhgZGUl2BtDljCguAHkFhIMb1xBkU9ULjCATQV4A2UAsWFsfAvcCzEn/YQBoEEE2VD1Y76gXhpcXyM0LjJRmZ4AAAwCoyOJjz29PsAAAAABJRU5ErkJggg=="),t("group_icon",16,16,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAOFJREFUeNqUUwsOwjAILa67i2fwEMbEnUej55mJO4Rn8DBtglAh6YfOSdJkBfregwEgottiHiAlQuZjh68TQRJzI5L07nSbC//zOrUAmkxAJXBP2VgxRjpDK818z06gZIwrfSACF0iVVZrLiab7ownOl7PTV0QESsRgWqoHt80oD0fpy/BVhuZfsOpkC8LYxAkBw4YedOdDhuRny1UyZEPE334NvbZ6kBYeJGFPKFgp4HsUAqtI9u1AYipJgfQ+GjtQlPvPMkGlBHrLdFjeBeHruE+hYAxSo6C3jb4zyh8BBgBVL19PZ27iaAAAAABJRU5ErkJggg=="),t("group_image",32,29,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAdCAYAAADLnm6HAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAABHNJREFUeNqsV1ts21QY/uy4zc1ZnZY2bdbSLMlKxUWkaBJMgJY9gARIax/2NokVofLARWjiBYRY2QMdCGlI440H1ok3btsQ0wAxNdvKpnYdyyYK7UZHVK1L2rRZLo3j2InDOaZD60psp+WXrDjO93/nO7/PfwkDAwu0Nh8jH30wZwc6/f43X9jVJ5gBn/zueJozgaNkUXLtMwLyLt4XDG4Vtj+/B8lMQRf7QLsb079PCpzJnaVnEsmIEeiZgD/Mu5yYT4uYiWd1sW1NTlCsWQGmzC00gOd5lFQVkqLoYiuViobVBNzf3BRaCfUaUyuV2AomXI1sNrmkRUeUZBRlBXJJRVFRdQUoZVXDclvbvUeImn6j3VmAqpjg5ra0xcL2nDwdwW1JQeP2HJLLki7frVQOo+OXwNnttv5fp65vKPSvvLhHmBgf77fV10XqWBaLZPGEgYC0KIFiOYfdBoY8OH72D8QS6ZoX3x1+CFarFZSnxS1gk9OBeUJ+00BAimAolnM6nQDDEDVAHVOpWQBD/Ow2GyhPoyDHWKjYkr+GVrv+GWBmE6BYIsChRYCz0Kt2AWR92GxWUJ7TFy7GWltb9l368ZteM77lcukE53A4tC91VAC7jggwVIANd3h+OHM+Qlj2ktvQv9U0EIAkSZibm7vbNUpcIxxPQsfQV2BhwDHrE2C320F5qPnaPCMkdVel9EdDQ8iLeex/5+27H4dYljnGnRo5B1EUMT1fwI2lUs0CHs9JOD9xGeNjY9i7u9dXkKTovZgvv/j8H+y2njX+3FxiHmKhgHiGhCir1CwgKxawsLgEynP06xO0aO2sxV+rhAopm9migrRUuwCJVDMS8nXXEE2ALMtIF2UskVJaqxWIgIqqrl8ATUGFkNDaLKu174RGjzYWykO9A17P+6pa2WEqhVnmDOfmnUgmk+gN2vBsZ33NAng1DxspIpTH1+H1Pdrz2OCHn34GpaQfFYe1Dm+9+nKY62jzpIcG3xU20gukXAZtzU0Rkoo+mo6/TMZxI6E/Dzz9sFdLXc7jad6pSIW+jQho2OSKjl2djOyiAwmdB8jrLMj6Ka3emQd+Gh2jeUvTp7/aTGBgwyv+cJNm5HLx2plQSmX9AkYuiuXqOUuorKoj1RZ/7fU34PcHMLj/PSwv5/4LMsgy7EtKuTz887kLyMoq7CERi/miroD5TB4Xr/wGrsPT8omqqlV3PjAwgIYGAd9/+xVmrledG46QjhiZjs0iSYtSehk3M6KugAUigGK5rqA/rAc89MEBOJy81qq7u4LVJyYL27eYSkV50hkXxCLmDCKQIhiK5do3e3VL59TUNdrZ0N3dddTgLMQ89zX5XKQtP+m14kGB1QVv4VVMrIwCRn9M6PkAGctN1fjnwk9ddjc2hcxgb6eWov/rWE7tVGS0ZyWjfEYRoxlkVoBAIhE2gYst5vKDpVJ51QR96PBhxONxfHzw4Oo+wFl2mBFAJ1W6+IgR0OGwD2/zda4Z32/99ScpTiU80fPIvT/1/y3AAMOmtJl1Hv9IAAAAAElFTkSuQmCC"),t("link_icon",16,16,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAHVJREFUeNqkkwEOgCAIRaEr6nlqdR49I4XTzcqUn39jE5xP1C+LCPkjCl0Kq2NC5fYgRXlMSCw0K6Xozhqaol3ckj+QVwGFNIsI5HPCCunSLZDhGUcQ0033IOb3riE1CLJty/bTVubUBqDyc+Pm01oY8NQpwAAbUwhLBQIWcAAAAABJRU5ErkJggg=="),t("linksubnetwork_icon",16,16,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAU5JREFUeNqUUi1Tw0AQ3cukEY0AwdlDM8XRD41ARAAi/RHoCmQ7/QNofkTQFQh8W9kOOtgiQIBImTnuXbs3udAvduZms5t9b/fdrUiHGW2z0cOdLsdJ71GU46yfUrgL/PWx8HLxsUTOI3EE98mp9ZdXie0K8HgydYXtVtN6znHsTQAwdy2DOcY/TMFytkqogqskLIf6qQhYL7q/PI8cOIoiiuO69bvIRf3o5M/YANVqIZ03GjSbz2m5/KGiKDxgp90irbUINzEz2BSQEMKSwJiEwfgONmlFR4AAhg2yV0talWNfAbfJN4s7KHcCCcBPgy7WhobdM7q9uXbd3TPyhvEOwL4/30kpRVJKwrYySZ7nWABlzpsthM49R5lzYUhAruERr/P7CdZNPJJVakUiuOgAw9jSXOyUX8f4ZkCHGzQvAGIw4v9M4E0CMEh/BRgAwM37IYxGnbkAAAAASUVORK5CYII="),t("node_icon",16,16,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAGBJREFUeNpiZGBg+M9AJvj//z8jC5RBsmZGRkYwzQITCGlaS7TmNXXBcDYTA4Vg1IDBYAAjJB2Rl5DgKRGWqshyATm2o3uBgcwMBbacBZdmZJfh8CJIASMLodxGCAAEGACTAB0gDBYjygAAAABJRU5ErkJggg=="),t("node_image",30,32,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAgCAYAAAAFQMh/AAAACXBIWXMAAAsTAAALEwEAmpwYAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAO0SURBVHjavJZJaF1lGIaffzzn3pvbxAyYJulgNKJIF7WkuhEHFCy40LpRBLdFcFi4ciOCC9dmU910WbduBEEoRhFEarJw2UaLJXFImya5ubln+AcX5+YG3ZjCaT44cDb/+5zv/Ybzi7npo7Mhhi+886c5hFBaLUshX9dKq8tW2bPjExOHweXW+vpZ7/1lrZWanz52jK+//f5QwC8+8xSrN2/Oa2OM10pJgKwoWd/cRQpRKyzEyMRIk9QatFIYY7xOEou1BoD1zS6ff/kTqbW1grtZyVsvz3N8cgRrDUli0dZabB+kpGSkYdHWUGfOSkT6prLH04m1GFOBBaAkKBkQsU5wACpBYyyJtfSt1hVYVGDZf68rpNjXs1b3rU72rZaAlhFJRMj6wJUm+1bv1diYqrmEFCgJQtaf8Z6gMaaqcbPRpJGmgxprCYhYK1iL/YwbaUqz0UTneUFeusG8uRARNYPLEAn95spLR54X6K+uLDI1NQ3A7e0ey3+UtBJDnfO004vc6WRMjg3zzeIPrK2toje3O6StLWII7GYFt7qOPNS7uTo9x25WEENgY2uLze0Oem9xhOBwwZM5j3WyVnDmPC54QnAoWWlrgBgj3nuc9+yWHq3rBe+Wlbb3nhjjPhiowM7TdQ7t6rW66xzOVeBBpw/AzlM4z3bpkTVnvF1W2t79B1xZXVI4x3bpUfcE7PC+/LfVUgic80giY6lhJDG1gmUESawY/QWhG0aLxBh2dnoMqcBrpyawNWdcuMCQCuzs9EiMoWG00GPDR2QrMVxdWqIsch5L1cCOukJowerKn/x9M6GVGMaGj0hx+uEHrypjzzwwN0cI4Z7et6SU/HbtGr4sftbNVvN9a5NP1m78elpK6a0x9wRalCUhBNUeai0Xhf5ASykXh4fbbxo9+nin2y2v3/i9B3jq29YRUA+dPN5ot1qmdOXS7dvldfHIiRky5wBJt9djfePONHA/4Or6KwJ/TYzet9pqNIBAqjVianSEtY1NgCeBd4FTQBuoq+AS6AC/AAvAj1OjIzAzPoqS8pyAFQHx/x4gzs7OxosXP4ufLizEkydORA5wrv+sKCnPzYyPooFHh5vppQiTB/n8PMt47523Of/qebIsY7fT4eOPPiRJkoMcnxVwCXhOH2kPXWi3WpMH7s48J5Ql1tpq3p3j6Pj44MJ4gJgUUlwQzz5xpgMMHbhFYyRNU55+/gWC93x35Qp5niHu7q60I9545aUeoO5qPkJAqupICOFuoQD+nwEAIKWd899qAZAAAAAASUVORK5CYII="),t("shapelink_icon",16,16,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAIJJREFUeNqkUwsOgCAIxeYN5Ty1Og+ekUarzRwQ5tsYDpTPExIzgwY86uWgtSTwIAF6KTvxg/sMliwwCy27mEVr2Xu7+TjaWm4JqxvKpW/iWowQprX2i8RXhS0xXv+WL0xiKIAVxKssa/0hEMuPiB4epNFxnh7lZG1jdCPdABGcAgwAc06H0rgwLSIAAAAASUVORK5CYII="),t("shapenode_icon",16,16,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAI9JREFUeNq0UtsNgDAILI0jdZN2Ho3O027SnRA+MNb0QTWS8EPuLncAIKL5UvY5CEdC7h7pjrEtEABgqwucRCBFk7aAfo9uZJtwmXhQCLDyLJlrkSxaMuGgu8QZ8hVhYD8LVgZx9fMO1H9QKXbm+EJvBYwsuSYyFaEmUvyBUkQWCYUDfg5NV8/49xW6dQowAIJydCoPajIHAAAAAElFTkSuQmCC"),t("shapesubnetwork_icon",16,16,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAATBJREFUeNpiDG5cw4ALbO/L+I/M9yyawYjMX1MXzMCCT/PXD69RxLgFREFiKIbADSjzlAfTjq6eYFtBmk+dPgNXaGZqAqZhYjA+igtAmmG2ImuG8UFyIFfAvIPTC+ia0Q2BeYehLpiRCeZfkO37d2/HqRmX4Yxc/CJwZ9+6fYeBEPjw4QOYNjczZfj//z8j3AuMjIjAvXnrNoomdTVVFDkonxEjEIEmgg1C1oAuhw5YQKEZGhHzH9kVbcuPoiiqirSGy5UUF8FtBwFwIK5esYQRaIMfyE/Y/A0yEGbopk2b/FACEeQ0mO1Ati+UvQndFciuAVkG5W5GMQDqV1+QAci2oxuAFC5+4MCBGQIzAEKBBbFimBxILc7MhOQiPzTxTcixwYhsOxLwRWJvxicHEGAAkPKxzyGuYWgAAAAASUVORK5CYII="),t("subnetwork_icon",16,16,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAOJJREFUeNqkUjsOwjAMzavSBQYY4FDM7SGYOUARHICZQ5SBiUPBAAMLIJk8aFASkoDgSVFlu/68Z6NatCqF3Woqrj2ZreHabVMpnUs+H/eerz8c0+cV0amuTK6XG69bDEWsa5hM0KafU/DZeJRCmBwWsXRUUwEU0Y5tRFLfgHRMARYDeoPRSyy383Zee0nsgO5rcROBzo19FUlOoYG0Bp/0IAW7y4LHQT5GB/UL4F6ie3mX0yFLoTQUTByQxE8lQ51wMRHx1Chd4FtkReQUj3VFktj97ZSDNYkK9h6L/03hLsAAjRx4oMVjqkMAAAAASUVORK5CYII="),t=function(t,e,i,n){De.Util.registerImage(t,n,e,i)},t("expand_icon",16,18,"data:image/gif;base64,R0lGODlhEAASAIcAADFKY0L/QpSlvZylvZytxqW11qm92r3GxrnK5MbGxsbW69jh8efv9+vz/////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAMAAAEALAAAAAAQABIAAAhfAAMIHEiwoMGDCBMqXMjQ4AICEAcMECDgwEECDjJmbMAAwEWNDjgi8GgQ40YGCwyQLDjAAYCXL1UeFBAS5QIFBVYSFMBxwU0EOWcyUIDAQIGjOgcegMnUYsOnUKMiDAgAOw=="),t("collapse_icon",16,18,"data:image/gif;base64,R0lGODlhEAASAIcAADFKY0L/QpSlvZylvZytxqW11qm92r3GxrXI48bGxsbS59Te8efv9+vz/////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAMAAAEALAAAAAAQABIAAAhhAAMIHEiwoMGDCBMqXMjQ4AICEAcMECDgwEECDjJmbMAAwEWNADgq8GgQY0YADBYYIFlwgAMAMGGuPCjAAUcACxQUYElQAMcFABQg2EmTgVADBZLyHHggplOLDaNKnYowIAA7"),t("close_icon",11,11,"data:image/gif;base64,R0lGODlhCwALAIcAAHd3d319fUD/QIODg4iIiI6Ojq6urri4uNnZ2eHh4eTk5Ofn5/Dw8PT09Pj4+Pn5+fz8/P39/f///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAMAAAIALAAAAAALAAsAAAhdAAUIOECw4AGBAyUoXCjh4AEJDBA4mIiAQcMDERAUKOBgI4IIBCE0IECSZAMIBB8wYDCg5coHBBkkCECTZgIGMQ0AAKBgpwGcBxgsMLCgKFGcA1cqXXlQoMGCAgMCADs="),t("sort_desc",9,5,"data:image/gif;base64,R0lGODlhCQAFAJECAImJiezs7P///wAAACH5BAEAAAIALAAAAAAJAAUAAAIMDI4QYrnC0INxUnYLADs="),t("sort_asc",9,5,"data:image/gif;base64,R0lGODlhCQAFAJECAImJiezs7P///wAAACH5BAEAAAIALAAAAAAJAAUAAAIMlAWnwIrcDJwi2HsLADs="),t("submenu_enable_icon",8,8,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAYAAADED76LAAAACXBIWXMAAAsTAAALEwEAmpwYAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAA7SURBVHjafI9BDgAgDMKqH3c/ryd1iTqOpARARQUYJG0/AWboB2yoAgTG8jtvtXvMSUdVEdXIeN2cAwDPLmAjfDYS7AAAAABJRU5ErkJggg=="),t("submenu_disable_icon",8,8,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAYAAADED76LAAAACXBIWXMAAAsTAAALEwEAmpwYAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAABKSURBVHjafM9BDoAgDETRD1cTz0W9luDZxhUBCjpJkzZ9m0ESkrhLzW0fJ9JjpT4Zl+juBXmwoB0ACH/gOtNhX2B6AjDUtF3NdwAU6zx4LEQe5AAAAABJRU5ErkJggg=="),t("checkbox_selected_icon",16,16,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAKT2lDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVNnVFPpFj333vRCS4iAlEtvUhUIIFJCi4AUkSYqIQkQSoghodkVUcERRUUEG8igiAOOjoCMFVEsDIoK2AfkIaKOg6OIisr74Xuja9a89+bN/rXXPues852zzwfACAyWSDNRNYAMqUIeEeCDx8TG4eQuQIEKJHAAEAizZCFz/SMBAPh+PDwrIsAHvgABeNMLCADATZvAMByH/w/qQplcAYCEAcB0kThLCIAUAEB6jkKmAEBGAYCdmCZTAKAEAGDLY2LjAFAtAGAnf+bTAICd+Jl7AQBblCEVAaCRACATZYhEAGg7AKzPVopFAFgwABRmS8Q5ANgtADBJV2ZIALC3AMDOEAuyAAgMADBRiIUpAAR7AGDIIyN4AISZABRG8lc88SuuEOcqAAB4mbI8uSQ5RYFbCC1xB1dXLh4ozkkXKxQ2YQJhmkAuwnmZGTKBNA/g88wAAKCRFRHgg/P9eM4Ors7ONo62Dl8t6r8G/yJiYuP+5c+rcEAAAOF0ftH+LC+zGoA7BoBt/qIl7gRoXgugdfeLZrIPQLUAoOnaV/Nw+H48PEWhkLnZ2eXk5NhKxEJbYcpXff5nwl/AV/1s+X48/Pf14L7iJIEyXYFHBPjgwsz0TKUcz5IJhGLc5o9H/LcL//wd0yLESWK5WCoU41EScY5EmozzMqUiiUKSKcUl0v9k4t8s+wM+3zUAsGo+AXuRLahdYwP2SycQWHTA4vcAAPK7b8HUKAgDgGiD4c93/+8//UegJQCAZkmScQAAXkQkLlTKsz/HCAAARKCBKrBBG/TBGCzABhzBBdzBC/xgNoRCJMTCQhBCCmSAHHJgKayCQiiGzbAdKmAv1EAdNMBRaIaTcA4uwlW4Dj1wD/phCJ7BKLyBCQRByAgTYSHaiAFiilgjjggXmYX4IcFIBBKLJCDJiBRRIkuRNUgxUopUIFVIHfI9cgI5h1xGupE7yAAygvyGvEcxlIGyUT3UDLVDuag3GoRGogvQZHQxmo8WoJvQcrQaPYw2oefQq2gP2o8+Q8cwwOgYBzPEbDAuxsNCsTgsCZNjy7EirAyrxhqwVqwDu4n1Y8+xdwQSgUXACTYEd0IgYR5BSFhMWE7YSKggHCQ0EdoJNwkDhFHCJyKTqEu0JroR+cQYYjIxh1hILCPWEo8TLxB7iEPENyQSiUMyJ7mQAkmxpFTSEtJG0m5SI+ksqZs0SBojk8naZGuyBzmULCAryIXkneTD5DPkG+Qh8lsKnWJAcaT4U+IoUspqShnlEOU05QZlmDJBVaOaUt2ooVQRNY9aQq2htlKvUYeoEzR1mjnNgxZJS6WtopXTGmgXaPdpr+h0uhHdlR5Ol9BX0svpR+iX6AP0dwwNhhWDx4hnKBmbGAcYZxl3GK+YTKYZ04sZx1QwNzHrmOeZD5lvVVgqtip8FZHKCpVKlSaVGyovVKmqpqreqgtV81XLVI+pXlN9rkZVM1PjqQnUlqtVqp1Q61MbU2epO6iHqmeob1Q/pH5Z/YkGWcNMw09DpFGgsV/jvMYgC2MZs3gsIWsNq4Z1gTXEJrHN2Xx2KruY/R27iz2qqaE5QzNKM1ezUvOUZj8H45hx+Jx0TgnnKKeX836K3hTvKeIpG6Y0TLkxZVxrqpaXllirSKtRq0frvTau7aedpr1Fu1n7gQ5Bx0onXCdHZ4/OBZ3nU9lT3acKpxZNPTr1ri6qa6UbobtEd79up+6Ynr5egJ5Mb6feeb3n+hx9L/1U/W36p/VHDFgGswwkBtsMzhg8xTVxbzwdL8fb8VFDXcNAQ6VhlWGX4YSRudE8o9VGjUYPjGnGXOMk423GbcajJgYmISZLTepN7ppSTbmmKaY7TDtMx83MzaLN1pk1mz0x1zLnm+eb15vft2BaeFostqi2uGVJsuRaplnutrxuhVo5WaVYVVpds0atna0l1rutu6cRp7lOk06rntZnw7Dxtsm2qbcZsOXYBtuutm22fWFnYhdnt8Wuw+6TvZN9un2N/T0HDYfZDqsdWh1+c7RyFDpWOt6azpzuP33F9JbpL2dYzxDP2DPjthPLKcRpnVOb00dnF2e5c4PziIuJS4LLLpc+Lpsbxt3IveRKdPVxXeF60vWdm7Obwu2o26/uNu5p7ofcn8w0nymeWTNz0MPIQ+BR5dE/C5+VMGvfrH5PQ0+BZ7XnIy9jL5FXrdewt6V3qvdh7xc+9j5yn+M+4zw33jLeWV/MN8C3yLfLT8Nvnl+F30N/I/9k/3r/0QCngCUBZwOJgUGBWwL7+Hp8Ib+OPzrbZfay2e1BjKC5QRVBj4KtguXBrSFoyOyQrSH355jOkc5pDoVQfujW0Adh5mGLw34MJ4WHhVeGP45wiFga0TGXNXfR3ENz30T6RJZE3ptnMU85ry1KNSo+qi5qPNo3ujS6P8YuZlnM1VidWElsSxw5LiquNm5svt/87fOH4p3iC+N7F5gvyF1weaHOwvSFpxapLhIsOpZATIhOOJTwQRAqqBaMJfITdyWOCnnCHcJnIi/RNtGI2ENcKh5O8kgqTXqS7JG8NXkkxTOlLOW5hCepkLxMDUzdmzqeFpp2IG0yPTq9MYOSkZBxQqohTZO2Z+pn5mZ2y6xlhbL+xW6Lty8elQfJa7OQrAVZLQq2QqboVFoo1yoHsmdlV2a/zYnKOZarnivN7cyzytuQN5zvn//tEsIS4ZK2pYZLVy0dWOa9rGo5sjxxedsK4xUFK4ZWBqw8uIq2Km3VT6vtV5eufr0mek1rgV7ByoLBtQFr6wtVCuWFfevc1+1dT1gvWd+1YfqGnRs+FYmKrhTbF5cVf9go3HjlG4dvyr+Z3JS0qavEuWTPZtJm6ebeLZ5bDpaql+aXDm4N2dq0Dd9WtO319kXbL5fNKNu7g7ZDuaO/PLi8ZafJzs07P1SkVPRU+lQ27tLdtWHX+G7R7ht7vPY07NXbW7z3/T7JvttVAVVN1WbVZftJ+7P3P66Jqun4lvttXa1ObXHtxwPSA/0HIw6217nU1R3SPVRSj9Yr60cOxx++/p3vdy0NNg1VjZzG4iNwRHnk6fcJ3/ceDTradox7rOEH0x92HWcdL2pCmvKaRptTmvtbYlu6T8w+0dbq3nr8R9sfD5w0PFl5SvNUyWna6YLTk2fyz4ydlZ19fi753GDborZ752PO32oPb++6EHTh0kX/i+c7vDvOXPK4dPKy2+UTV7hXmq86X23qdOo8/pPTT8e7nLuarrlca7nuer21e2b36RueN87d9L158Rb/1tWeOT3dvfN6b/fF9/XfFt1+cif9zsu72Xcn7q28T7xf9EDtQdlD3YfVP1v+3Njv3H9qwHeg89HcR/cGhYPP/pH1jw9DBY+Zj8uGDYbrnjg+OTniP3L96fynQ89kzyaeF/6i/suuFxYvfvjV69fO0ZjRoZfyl5O/bXyl/erA6xmv28bCxh6+yXgzMV70VvvtwXfcdx3vo98PT+R8IH8o/2j5sfVT0Kf7kxmTk/8EA5jz/GMzLdsAAAAgY0hSTQAAeiUAAICDAAD5/wAAgOkAAHUwAADqYAAAOpgAABdvkl/FRgAAAflJREFUeNqkk09oE1EQxn+7btyIYBRCbayFtlhEtLeAin+KouDNo548eJHCQkFQC1K0Bw8VqT1EVIqo0IMUvejNg6AIIglSsdSCiA0WolaIOWi3+2fGw242CRFBHPjg8d7MfPO+mTEcxzkNDAF5/s1KwE0cxylWKhX1fV89r44gget6bVhd9bRcLqvjOEULyGezWTwvAMAwjIRCRAnD8I/0nZ05gLwZOTYeVBXQOIGgqgk+flrk3MUxVBWRyMeMw5oCG2eREFVBVZibf8+x4ydZLH9GVRISq5W5uXwhDKPSvnz9xolTZ/A29GNZFiJ1kjhBnVFVEw0a7MrQ8HlqbMZwXeYXlpL7ti/Usbz8Hd8PEBGmHzxk9kMVfI+BrWt4PHM/0abtC67r8vTZC4qlWY4c2s/Azh2MTxQwpIPduzZx99Z1bNtu1yBiFp6/fMXr4ht+/NzI+MQNBg/sxdccPbmAqcI1UqkUEresTQMR5ejhQbb19XJ25BJzC8Lbd3dIp22mCtPY9tokuDmB2VyBqtDb082VyxdYv26JXysrTF4dY0uuI3lvoKWCaOoMA1SF7q4u7t2eZObREw7u25MMTbPF8VGCqHNRB4IgQFXY3t/H6MhwLFirGYZBfeItoFSr1fKZTAbVaPbT6fRf19A0TarVKkDJ+N91/j0A8Y5o3Yt7KRAAAAAASUVORK5CYII="),t("checkbox_unselected_icon",16,16,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAiUlEQVR42qXM3QYFIRiF4d3dJpIhI5FKJCOSSHe7f9gn4ztZo3Wwzt6HvTbHfhdCeD8Nvw27Ad57OI4xUsA5BwMpJQpYa2Eg50wBYwwMlFIocJ4nDFzXRQGtNQzUWilwHAcMtNYooJSCgd47BaSUMDDGoIAQAgbmnBTgnMPAWosCcP3fDdjZNvABvRhVEQglsV8AAAAASUVORK5CYII="),t("radiobutton_selected_icon",16,16,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAXFJREFUeNrUUz9rwkAUv0syBVxMm01L2lIdilOg4BcQ7eKcIV/AqZAxo1/B2a/QoSSTH6AQCoFMJUSig5C0EiPEv8G+Z604eJNTHxz37vf73Y977+7obrcjlwRHLoyLDYTThWmav6AgKDA9wrg6UF8wvO12O8RFt9s9bwACwvP8U6lUajWbzbYsy/eIR1Hk27b9GgSBlef5O7OEzWZzC5ufNU17gc01gEQcmCOGHGqYJaxWq1qj0WhzHFfwfZ84jrPHVVUliqIUkPM87wOg4KzBcrm8liTpbr1ek8FgQNI03eOz2Yzouk6QQw3zBFmWUewDxnQ6JUmSHHsDRz9qmD0A8ns8HgcortfrRxxzxJBDDfMEi8XC7ff7b4Zh3FSr1UKlUtnjlFI0mCOHGqZBHMd+GIbWZDIROp1OCxqH74HA9Q17vZ7luq4liqJ/uoee/oVyufxX/wPctwqpfKAieB9OsVj8xMVoNDpv8D8/048AAwDskrF8QGeJUgAAAABJRU5ErkJggg=="),t("radiobutton_unselected_icon",16,16,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAATVJREFUeNrUU71qhEAQ9q8S0mhip3C5kCpcFcgjiJfmal/BKr2lr2DtK1wR9BkCaYRUQTzUQtDE5sB/MTOJAQs3jVUGhp2Z75vPnV2XHseRWmMMtdJWC3DzxDTNnyLHbWC5A7+coA/wt77vT5hYlrUsAASKZdkHWZb3mqYdJEm6wXqWZYHneccwDN1hGF6II3Rddw3Nj7quP0HzDko8OsZYQww5RIGmaXaqqh4YhrnA3cwda4ghh3gGdV1fiaK4bdt28cAQQw5RoCxLGr/2lyGHOAKAn0mShDAnteSIIYcoUFWV7zjOM5DPuJPfxik+I4Yc4gh5ngdRFLlpmnKGYew3YFiH6zvZtu36vu/yPB/Me+j5W1AU5XstiuIW7vseQmmCMvg/XgVBeMckjuNlgf/5mL4EGAAhHbltcqEYDQAAAABJRU5ErkJggg=="),t("right_expand_icon",6,11,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAALCAYAAABcUvyWAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyhpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMDY3IDc5LjE1Nzc0NywgMjAxNS8wMy8zMC0yMzo0MDo0MiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTUgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6N0ZBRTFFQjJGQjA1MTFFNUE5M0NCMDAwMTJBRUZCNjkiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6N0ZBRTFFQjNGQjA1MTFFNUE5M0NCMDAwMTJBRUZCNjkiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpCMzYzQTE5MUZBRkYxMUU1QTkzQ0IwMDAxMkFFRkI2OSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpCMzYzQTE5MkZBRkYxMUU1QTkzQ0IwMDAxMkFFRkI2OSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PqPQWR4AAABJSURBVHjaYvT08vrPwMAgCsQM27ZufcMABUxQ+jWI8PL2FkGXwJBElkCRRJeAS2KTAEvikhDFJiGKzSi4f5iwCSLrwPA5QIABAAmgFhOOHdKvAAAAAElFTkSuQmCC"),t("left_expand_icon",6,11,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAALCAYAAABcUvyWAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyhpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMDY3IDc5LjE1Nzc0NywgMjAxNS8wMy8zMC0yMzo0MDo0MiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTUgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6N0ZBRTFFQjZGQjA1MTFFNUE5M0NCMDAwMTJBRUZCNjkiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6N0ZBRTFFQjdGQjA1MTFFNUE5M0NCMDAwMTJBRUZCNjkiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo3RkFFMUVCNEZCMDUxMUU1QTkzQ0IwMDAxMkFFRkI2OSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo3RkFFMUVCNUZCMDUxMUU1QTkzQ0IwMDAxMkFFRkI2OSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PmpWGHAAAABISURBVHjaYvz//z8DDHh5e4tAma+ZsAmCCCZsgiDAfOr0aQxBuA50QZgEhiBMQhSXBAM2SaZtW7e+wSYJ1oFNEu5BdEmAAAMAvV8Xc/cw3YgAAAAASUVORK5CYII="),t("up_expand_icon",11,6,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAGCAYAAAAVMmT4AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyhpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMDY3IDc5LjE1Nzc0NywgMjAxNS8wMy8zMC0yMzo0MDo0MiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTUgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6QjM2M0ExOEZGQUZGMTFFNUE5M0NCMDAwMTJBRUZCNjkiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6QjM2M0ExOTBGQUZGMTFFNUE5M0NCMDAwMTJBRUZCNjkiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpCMzYzQTE4REZBRkYxMUU1QTkzQ0IwMDAxMkFFRkI2OSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpCMzYzQTE4RUZBRkYxMUU1QTkzQ0IwMDAxMkFFRkI2OSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PnCNygcAAABGSURBVHjaYvz//z8DDHh5e4tAma+BWBTE2LZ16xuYPBMOhXAaSRyiGItCBmwaGD29vHApRAaiyM7ApxAuz0SEQrgGgAADALOxFSETkKKwAAAAAElFTkSuQmCC"),t("down_expand_icon",11,6,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAGCAYAAAAVMmT4AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA0xpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMDY3IDc5LjE1Nzc0NywgMjAxNS8wMy8zMC0yMzo0MDo0MiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6QjM2M0ExOENGQUZGMTFFNUE5M0NCMDAwMTJBRUZCNjkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6QjM2M0ExOEJGQUZGMTFFNUE5M0NCMDAwMTJBRUZCNjkiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTUgKE1hY2ludG9zaCkiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0iYWRvYmU6ZG9jaWQ6cGhvdG9zaG9wOjQ5ZTRmZmE2LTQzNmYtMTE3OS04NThhLTk1ZGZjOWRiNmNiOCIgc3RSZWY6ZG9jdW1lbnRJRD0iYWRvYmU6ZG9jaWQ6cGhvdG9zaG9wOjQ5ZTRmZmE2LTQzNmYtMTE3OS04NThhLTk1ZGZjOWRiNmNiOCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PtPgXX8AAAA7SURBVHjaYvH08vrPQCRgAmJRItWKMsEYhBSCTd62desbAhrA4iB1TDAGDg2iyPIwZ2DTIIomzgAQYAAmahUFv1Iq6AAAAABJRU5ErkJggg==")}(),je.__tree=function(t,e){t._rootVisible=!0,t._initTree=function(t){this._rootData=null,this._expandMap={},this._levelMap={}},t.validateModel=function(){this._rowDatas.clear(),this._levelMap={},this._dataRowMap={},this._currentLevel=0,this._rootData?this._rootVisible?this.isVisible(this._rootData)&&this._buildData(this._rootData):this._buildChildren(this._rootData):this._buildChildren(),delete this._currentLevel},t._buildData=function(t){this._dataRowMap[t.getId()]=this._rowDatas.size(),this._rowDatas.add(t),this._levelMap[t.getId()]=this._currentLevel,this.isExpanded(t)&&(this._currentLevel++,this._buildChildren(t),this._currentLevel--)},t._buildChildren=function(t){var e=t?t.getChildren():this._box.getRoots(),i=this.getCurrentSortFunction();i&&this.isChildrenSortable(t)?e.toList(this.isVisible,this).sort(i).forEach(function(t){this._buildData(t)},this):e.forEach(function(t){this.isVisible(t)&&this._buildData(t)},this)},t.getLevel=function(t){return this._levelMap[t.getId()]},t.getToggleImage=function(t){return t.getChildrenSize()>0?this.isExpanded(t)?this._expandIcon:this._collapseIcon:null},t.isCheckable=function(t){return this.isCheckMode()},t.isCheckMode=function(){return 1===je.__tree._checkMap[this._checkMode]},t.isChildrenSortable=function(t){return!0},t.handleDataBoxChange=function(t){"remove"===t.kind?delete this._expandMap[t.data.getId()]:"clear"===t.kind&&(this._expandMap={}),this.invalidateModel()},t.isExpanded=function(t){return 1===this._expandMap[t.getId()]},t.expand=function(t){if(!this.isExpanded(t)){for(var e=t.getParent();null!=e&&e!==this._rootData;)this._expandMap[e.getId()]=1,e=e.getParent();this._expandMap[t.getId()]=1,this.invalidateModel()}},t.collapse=function(t){this.isExpanded(t)&&(delete this._expandMap[t.getId()],this.invalidateModel())},t.expandAll=function(){this._box.forEach(function(t){this._expandMap[t.getId()]=1},this),this.invalidateModel()},t.collapseAll=function(){this._expandMap={},this.invalidateModel()},t._handleClick=function(t){if(this.isFocusOnClick()&&De.Util.setFocus(this._view),!this._isValidating){var e;if(t.target._expandData&&!t.target.ableExpand)e=t.target._expandData,this.isExpanded(e)?(this.collapse(e),this.fireInteractionEvent({kind:"collapse",data:e})):(this.expand(e),this.fireInteractionEvent({kind:"expand",data:e}));else if(t.target._selectData||t.target.parentNode._selectData){if(this._handlePressSelection(t.target._selectData||t.target.parentNode._selectData,t),this.isCheckMode()){var i=this.getRowIndexAt(t);i>=0&&this.__handleClick(t)}}else this._treeColumn?(e=this.getDataAt(t))&&(this.isCheckMode()?t.target._checkData||this.__handleClick(t):this._handlePressSelection(e,t)):this.isCheckMode()&&!t.target._checkData&&this.__handleClick(t);if(this._currentEditor&&!this._isCommitting&&(this._isCommitting=!0,this.commitEditValue(this._currentEditor._editInfo,this._currentEditor)),this.updateCurrentEditor){var n=this;setTimeout(function(){n.updateCurrentEditor(t)},0)}}},t.__handleClick=function(t){var e=this.getDataAt(t);if(e){var i=this.getRowIndexByData(e);if(this._focusedRow!==i){var n=this._rowDatas.get(this._focusedRow);this._focusedRow=i,n&&this.invalidateData(n),this.invalidateData(e)}}},t._handleDoubleClick=function(t){if(this.isFocusOnClick()&&De.Util.setFocus(this._view),!this._isValidating){var e;t.target.ableExpand&&t.target._expandData&&(e=t.target._expandData,this.isExpanded(e)?(this.collapse(e),this.fireInteractionEvent({kind:"collapse",data:e})):(this.expand(e),this.fireInteractionEvent({kind:"expand",data:e})))}},t.handleChange=function(t){if(!(this._isCommitting||this._isCanceling||this._isValidating)){var e=t.target._checkData;if(e){var i,n=this.isSelected(e),o=this.getSelectionModel();if("default"===this._checkMode)n?o.removeSelection(e):o.appendSelection(e);else if("children"===this._checkMode)i=new hn(e),i.addAll(e.getChildren());else if("descendant"===this._checkMode)i=new hn,Me.fillDescendant(e,i);else if("descendantAncestor"===this._checkMode&&(i=new hn,Me.fillDescendant(e,i),!n))for(var r=e.getParent();r;)i.add(r),r=r.getParent();n?o.removeSelection(i):o.appendSelection(i)}t.target._editInfo&&this.commitEditValue&&(this._isCommitting=!0,this.commitEditValue(t.target._editInfo,t.target))}},t.onLabelRendered=function(t,e,i,n,o,r){},t.onToggleImageRendered=function(t){},t._renderTree=function(t,e,i,n){var o=this._levelMap[e.getId()],r=this.getToggleImage(e),a=this.getLineType(),s=this._indent,l=this.__spanPool.get();l.style.width=r?this._indent*o+"px":this._indent*(o+1)+"px",l.style.display="inline-block",l.style.position="relative",l.style.verticalAlign="top",l.style.margin="0px 1px 0px 1px",l.style.width=(o+1)*s+"px",t.appendChild(l);var h=e,c=h.getParent(),u=0;if("dotted"===a||"solid"===a){if(null==c){var d=this.getIcon(e);this._addLine(l,e,d,!0)}for(;null!==c;){var f=c.getChildren(),p=h===f.get(f.size()-1),d=this.getIcon(h);h.setClient("isLast",p),0==u&&this._addLine(l,e,d,p),u++,h=c,c=c.getParent()}}if(r){var g=this.__imagePool.get();g.setAttribute("src",Me.getImageSrc(r)),g.style.verticalAlign="middle",g._expandData=e,g.style.position="absolute",g.style.right="0px";var _=this;g.onload=function(){g.style.top=_.getRowHeight()/2-g.height/2+"px"},l.appendChild(g),this.onToggleImageRendered(g)}var m=this.isCheckable(e),v="disabled"===this.getUncheckableStyle();if(m||v){this._addCheckBox(t,e,n).disabled=!m}var d=this.getIcon(e);if(d){var y=this.isCheckMode()||this._treeColumn?null:e;this._addIcon(t,e,d,y)}var w=this.getLabel(e);w&&(l=this.__textPool.get(),l.style.whiteSpace="nowrap",l.style.verticalAlign="middle",l.style.padding="1px 2px 1px 2px",Me.setText(l,w,this._treeColumn?this._treeColumn.isInnerText():this._innerText),r&&(l._expandData=e,l.ableExpand=!0),this.isCheckMode()||this._treeColumn?this._focusedRow===i&&(l.style.backgroundColor=this.getSelectColor(e)):(l._selectData=e,l.style.backgroundColor=n?this.getSelectColor(e):""),this.onLabelRendered(l,e,w,i,o,n),t.appendChild(l),t.title=this.getToolTip(e))}},je.__tree._checkMap={default:1,children:1,descendant:1,descendantAncestor:1},De.Column=function(t){De.Column.superClass.constructor.call(this,t)},Me.ext("twaver.Column",De.Data,{IColumn:!0,__property:1,__accessor:["width","horizontalAlign","valueType","propertyType","propertyName","editable","visible","sortable","resizable","movable","sortDirection","sortFunction","enumInfo"],__bool:["innerText"],_innerText:kn.COLUMN_INNER_TEXT,_width:kn.COLUMN_WIDTH,_horizontalAlign:kn.COLUMN_HORIZONTAL_ALIGN,_propertyName:null,_propertyType:kn.COLUMN_PROPERTY_TYPE,_valueType:kn.COLUMN_VALUE_TYPE,_editable:kn.COLUMN_EDITABLE,_sortable:kn.COLUMN_SORTABLE,_visible:kn.COLUMN_VISIBLE,_resizable:kn.COLUMN_RESIZABLE,_movable:kn.COLUMN_MOVABLE,_sortDirection:"asc",_sortFunction:kn.SORT_FUNCTION,_enumInfo:null,renderCell:kn.COLUMN_RENDER_CELL,renderHeader:kn.COLUMN_RENDER_HEADER,renderEditor:kn.COLUMN_RENDER_EDITOR,setParent:function(t){throw"parent not supported"},getEnumInfo:function(){return"object"==typeof this._enumInfo?this._enumInfo:"function"==typeof this._enumInfo?1===arguments.length?this._enumInfo(arguments[0]):this._enumInfo():void 0}}),De.ColumnBox=function(t){De.ColumnBox.superClass.constructor.apply(this,arguments)},Me.ext("twaver.ColumnBox",De.DataBox,{_name:"ColumnBox",add:function(t,e){if(!t.IColumn)throw"Only IColumn can be added into ColumnBox";De.ColumnBox.superClass.add.apply(this,arguments)}}),De.Property=function(t){De.Property.superClass.constructor.call(this,t)},Me.ext("twaver.Property",De.Data,{IProperty:!0,__property:1,__accessor:["horizontalAlign","valueType","editable","propertyType","propertyName","categoryName","enumInfo"],__bool:["innerText"],_innerText:kn.PROPERTY_INNER_TEXT,_horizontalAlign:kn.PROPERTY_HORIZONTAL_ALIGN,_propertyName:null,_propertyType:kn.PROPERTY_PROPERTY_TYPE,_valueType:kn.PROPERTY_VALUE_TYPE,_editable:kn.PROPERTY_EDITABLE,_categoryName:kn.PROPERTY_CATEGORY_NAME,_enumInfo:null,renderName:kn.PROPERTY_RENDER_NAME,renderValue:kn.PROPERTY_RENDER_VALUE,isVisible:null,renderEditor:kn.PROPERTY_RENDER_EDITOR,setParent:function(t){throw"parent not supported"},setPropertyName:function(t){var e=this._propertyName;this._propertyName=t,this.firePropertyChange("propertyName",e,t)},setPropertyType:function(t){var e=this._propertyType;this._propertyType=t,this.firePropertyChange("propertyType",e,t)},getEnumInfo:function(){return"object"==typeof this._enumInfo?this._enumInfo:"function"==typeof this._enumInfo?1===arguments.length?this._enumInfo(arguments[0]):this._enumInfo():void 0}}),De.PropertyBox=function(t){De.PropertyBox.superClass.constructor.apply(this,arguments)},Me.ext("twaver.PropertyBox",De.DataBox,{_name:"PropertyBox",add:function(t,e){if(!t.IProperty)throw"Only IProperty can be added into PropertyBox";De.PropertyBox.superClass.add.apply(this,arguments)}}),De.Tab=function(t){De.Tab.superClass.constructor.call(this,t)},Me.ext("twaver.Tab",De.Data,{ITab:!0,__accessor:["view","width","closable","resizable","movable","disabled","visible"],_icon:null,_width:kn.TAB_WIDTH,_closable:kn.TAB_CLOSABLE,_resizable:kn.TAB_RESIZABLE,_movable:kn.TAB_MOVABLE,_disabled:kn.TAB_DISABLED,_visible:kn.TAB_VISIBLE,setParent:function(t){throw"parent not supported"}}),De.TabBox=function(t){De.TabBox.superClass.constructor.apply(this,arguments),this.getSelectionModel().setSelectionMode("singleSelection")},Me.ext("twaver.TabBox",De.DataBox,{_name:"TabBox",add:function(t,e){if(!t.ITab)throw"Only ITab can be added into TabBox";De.TabBox.superClass.add.apply(this,arguments)}}),De.controls.ListBase=function(t){De.controls.ListBase.superClass.constructor.apply(this,arguments),this._invalidate=!1,this._invalidateModel=!1,this._invalidateDisplay=!1,this._invalidateDatas=null,this._rowDatas=new hn,this._startRowIndex=0,this._endRowIndex=0,this._renderMap={},this._dataRowMap={},this.__divPool=new De.Pool("div",20),this.__imagePool=new De.Pool("img",20),this.__canvasPool=new De.Pool("canvas",20),this.__spanPool=new De.Pool("span",20),this.__textPool=new De.Pool("span",20),this.__checkBoxPool=new De.Pool("input",20),this.__linePool=new De.Pool("canvas",20),this._pools.add(this.__divPool),this._pools.add(this.__linePool),this._pools.add(this.__imagePool),this._pools.add(this.__canvasPool),this._pools.add(this.__spanPool),this._pools.add(this.__textPool),this._pools.add(this.__checkBoxPool),this._view=Xe.createView("auto",!0),this._rootDiv=Xe.createDiv(),this._dataDiv=Xe.createDiv(),this._dataDiv.style.width="1px",this._view.appendChild(this._rootDiv),this._rootDiv.appendChild(this._dataDiv),this.setDataBox(t||new De.DataBox);var e=this;e.handleChange&&e._view.addEventListener("change",function(t){e.handleChange(t)},!1),Ue.isTouchable?Ue.isMSTouchable?new De.controls.ListBaseMSTouchInteraction(this):(new De.controls.ListBaseTouchInteraction(this),new De.controls.ListBaseInteraction(this)):new De.controls.ListBaseInteraction(this)},Me.ext("twaver.controls.ListBase",De.controls.View,{__bool:["innerText"],_innerText:kn.LISTBASE_INNER_TEXT,getDataDiv:function(){return this._dataDiv},getStartRowIndex:function(){return this._startRowIndex},getEndRowIndex:function(){return this._endRowIndex},getRowDatas:function(){return this._rowDatas},getRowIndexByData:function(t){return this._dataRowMap[t.getId()]},getRowIndexById:function(t){return this._dataRowMap[t]},getRowSize:function(){return this._rowDatas.size()},getDataBox:function(){return this._box},setDataBox:function(t){if(!t)throw"DataBox can not be null";if(this._box!==t){var e=this._box;e&&(e.removeDataBoxChangeListener(this.handleDataBoxChange,this),e.removeDataPropertyChangeListener(this.handlePropertyChange,this),e.removeHierarchyChangeListener(this.handleHierarchyChange,this),this._selectionModel||e.getSelectionModel().removeSelectionChangeListener(this.handleSelectionChange,this)),this._box=t,this._box.addDataBoxChangeListener(this.handleDataBoxChange,this),this._box.addDataPropertyChangeListener(this.handlePropertyChange,this),this._box.addHierarchyChangeListener(this.handleHierarchyChange,this),this._selectionModel?this._selectionModel._setDataBox(t):this._box.getSelectionModel().addSelectionChangeListener(this.handleSelectionChange,this),this.invalidateModel(),this.firePropertyChange("dataBox",e,this._box)}},onPropertyChanged:function(t){"zoom"===t.property?this.invalidate():this.invalidateModel()},invalidateModel:function(){this._invalidateModel||(this._invalidateModel=!0,this._invalidateDisplay=!0,this._invalidateDatas=null,this.invalidate())},invalidateDisplay:function(){this._invalidateDisplay||(this._invalidateDisplay=!0,this._invalidateDatas=null,this.invalidate())},invalidateData:function(t){this._invalidateDisplay||(this._invalidateDatas||(this._invalidateDatas={}),this._invalidateDatas[t.getId()]=t,this.invalidate())},validateImpl:function(){var t=this._view.scrollLeft,e=this._view.scrollTop;this._invalidateModel&&(this._invalidateModel=!1,this.validateModel()),this._invalidateDisplay&&(this._invalidateDisplay=!1,this._renderMap={},Xe.release(this._dataDiv),this._dataDiv.style.height=this.getRowSize()*this._rowHeight+"px");var i;if(this._invalidateDatas){for(i in this._invalidateDatas){var n=this._renderMap[i];n&&(Xe.release(n),this._dataDiv.removeChild(n),delete this._renderMap[i])}this._invalidateDatas=null}var o=this._view.scrollTop/this._zoom,r=this._view.clientHeight/this._zoom;this._startRowIndex=Math.floor(o/this._rowHeight)-2,this._endRowIndex=Math.ceil((o+r)/this._rowHeight)+2,this._startRowIndex<0&&(this._startRowIndex=0),this._endRowIndex>this._rowDatas.size()&&(this._endRowIndex=this._rowDatas.size());for(var a=this._rowHeight-this._rowLineWidth-2+"px",s=this._rowLineWidth+"px",l=this._startRowIndex;l<this._endRowIndex;l++){var h=this._rowDatas.get(l);i=h.getId();var c=this._renderMap[i];if(!c){c=this.__divPool.get();var u=c.style;u.position="absolute",u.whiteSpace="nowrap",u.lineHeight=a,u.top=l*this._rowHeight+"px",u.borderStyle="solid",u.borderWidth="0px",u.borderBottomWidth=s,u.borderBottomColor=this._rowLineColor,u.opacity=h.getStyle?h.getStyle("whole.alpha"):1,this._dataDiv.appendChild(c),this._renderMap[i]=c;var d=this.isSelected(h);this.renderData(c,h,l,d),this.onDataRendered(c,h,l,d)}}this._dataDiv.style.width=this.calculateSumWidth()+"px","0px"===this._dataDiv.style.height&&(this._dataDiv.style.height="1px"),Me.keys(this._renderMap).forEach(function(t){var e=this.getRowIndexById(t);if(e<this._startRowIndex||e>=this._endRowIndex){var i=this._renderMap[t];Xe.release(i),this._dataDiv.removeChild(i),delete this._renderMap[t]}},this),this._pools.forEach(function(t){t.clear()}),this._view.scrollLeft!==t&&(this._view.scrollLeft=t),this._view.scrollTop!==e&&(this._view.scrollTop=e),this.adjustRowSize(),this.onValidated()},adjustRowSize:function(){var t,e,i=this._rowHeight-this._rowLineWidth+"px",n=Math.floor((this._view.scrollLeft+this._view.clientWidth)/this._zoom)+"px";for(t in this._renderMap)e=this._renderMap[t],e.style.height=i,e.style.width=n},onValidated:function(){},onDataRendered:function(t,e,i,n){},calculateSumWidth:function(){return 0},_addCheckBox:function(t,e,i){var n=this.__checkBoxPool.get();return n.keepDefault=!0,n.type="checkbox",n.style.margin="0px 2px",n.style.verticalAlign="middle",n._checkData=e,n.checked=i,n.disabled=!1,t.appendChild(n),n},_addIcon:function(t,e,i,n){var o,r=Me.getImageAsset(i),a=this.getInnerColor(e),s=this.getOuterColor(e),l=this.getAlarmFillColor(e);if(r&&r.getImage()){var h=r.getWidth(),c=r.getHeight();o=this.__canvasPool.get(),o.style.verticalAlign="middle",o.setAttribute("width",h),o.setAttribute("height",c);var u=o.getContext("2d");u.clearRect(0,0,h,c);Di(u,i,a,{x:0,y:0,width:h,height:c},e,this),s&&(u.lineWidth=2,u.strokeStyle=s,u.beginPath(),u.rect(0,0,h,c),u.closePath(),u.stroke()),l&&(u.fillStyle=Ye.createRadialGradient(u,l,"white",1,c-9,8,8,.75,.25),u.beginPath(),u.arc(5,c-5,4,0,2*Math.PI,!0),u.closePath(),u.fill())}else o=this.__imagePool.get(),o.style.verticalAlign="middle",o.setAttribute("src",Me.getImageSrc(i));o.style.margin="0px 1px 0px 1px",o._selectData=n,t.appendChild(o)},_addLine:function(t,e,i,n){var o,r,a=this.__linePool.get(),s=Me.getImageAsset(i),l=this.getToggleImage(e),h=this._levelMap[e.getId()],c=this._indent,u=c,d=c,f=0;this.isCheckable(e),this.getUncheckableStyle(),f=2,s&&(u=s.getWidth(),d=s.getHeight()),o=(h+f-1)*c+u,r=this.getRowHeight(),t.style.width=(h+f-1)*c+"px",t.style.height=r+"px";var p=this.getLineType(),g=this.getLineColor(),_=this.getLineAlpha(),m=this.getLineThickness(),v=this.getLineDash();Me.getImageSrc(l),a.style.verticalAlign="top",a.style.margin="0px 0px 0px 0px",a.style.zIndex=-1,a.setAttribute("width",o),a.setAttribute("height",r);var y=a.getContext("2d");y.lineWidth=m,y.strokeStyle=g,y.globalAlpha=_,"dotted"===p&&y.setLineDash(v);var w=2*(h+f);if(n){var b=e,x=b.getParent();y.clearRect(0,0,o,r),null===x&&0!==e.getChildrenSize()&&this.isExpanded(e)&&(y.moveTo((h+f+1)*o/w,r/2+d/2),y.lineTo((h+f+1)*o/w,r),y.stroke());for(var A=2*h-1;A>=1;A-=2){if(b.getClient("isLast")){if(b=x,x=b.getParent(),(A+1)/2!=h)continue}else b=x,x=b.getParent();A==2*h-1?(y.moveTo((A+f)*o/w,0),y.lineTo((A+f)*o/w,r/2),y.stroke(),y.moveTo((A+f)*o/w,r/2),y.lineTo((A+f+1)*o/w,r/2),y.stroke(),0!==e.getChildrenSize()&&this.isExpanded(e)&&(y.moveTo((A+f+2)*o/w,r/2+d/2),y.lineTo((A+f+2)*o/w,r),y.stroke())):(y.moveTo((A+f)*o/w,0),y.lineTo((A+f)*o/w,r),y.stroke())}}else{var b=e,x=b.getParent();y.clearRect(0,0,o,r);for(var A=2*h-1;A>=1;A-=2){if(b.getClient("isLast")){if(b=x,x=b.getParent(),(A+1)/2!=h)continue}else b=x,x=b.getParent();y.moveTo((A+f)*o/w,0),y.lineTo((A+f)*o/w,r),y.stroke(),A==2*h-1&&(y.moveTo((A+f)*o/w,r/2),y.lineTo((A+f+1)*o/w,r/2),y.stroke(),0!==e.getChildrenSize()&&this.isExpanded(e)&&(y.moveTo((A+f+2)*o/w,r/2+d/2),y.lineTo((A+f+2)*o/w,r),y.stroke()))}}return t.appendChild(a),a},isVisible:function(t){return!!this._box.contains(t)&&(!this._visibleFunction||this._visibleFunction(t))},handleDataBoxChange:function(t){this.invalidateModel()},handlePropertyChange:function(t){"parent"===t.property?this.invalidateModel():this.invalidateData(t.source)},handleHierarchyChange:function(t){this.invalidateModel()},handleSelectionChange:function(t){t.datas.forEach(function(t){this.invalidateData(t)},this),this.onSelectionChanged(t)},getRowIndexAt:function(t){var e=this.getLogicalPoint(t);if(!e)return-1;var i=parseInt(e.y/this._rowHeight);return i>=0&&i<this._rowDatas.size()?i:-1},getDataAt:function(t){var e=this.getRowIndexAt(t);return e>=0?this._rowDatas.get(e):null},getCurrentSortFunction:function(){return this._sortFunction},validateModel:function(){this._rowDatas.clear(),this._dataRowMap={},this._buildChildren(this._box.getRoots()),this._rowDatas=this._rowDatas.toList(this.isVisible,this);var t=this.getCurrentSortFunction();t&&this._rowDatas.sort(t);for(var e=this._rowDatas.size(),i=0;e>i;i++)this._dataRowMap[this._rowDatas.get(i).getId()]=i},_buildChildren:function(t){t.forEach(function(t){this._rowDatas.add(t),this._buildChildren(t.getChildren())},this)},_handlePressSelection:function(t,e){var i=this.getSelectionModel();if(Me.isCtrlDown(e))i.contains(t)?i.removeSelection(t):i.appendSelection(t);else if(e.shiftKey&&i.getLastData()){var n=i.getLastData(),o=this.getRowIndexByData(n),r=this.getRowIndexByData(t),a=new hn;for(a.add(this.getRowDatas().get(o));o!==r;)o+=r>o?1:-1,a.add(this.getRowDatas().get(o));i.setSelection(a)}else 1===i.size()&&i.contains(t)||i.setSelection(t);this.fireInteractionEvent({kind:2===e.detail?"doubleClick":"click",data:t})},_handleClick:function(t){this.isFocusOnClick()&&De.Util.setFocus(this._view);var e=this.getDataAt(t);if(e){if(this.isCheckMode()&&!t.target._checkData){var i=this.getRowIndexByData(e);if(this._focusedRow!==i){var n=this._rowDatas.get(this._focusedRow);this._focusedRow=i,n&&this.invalidateData(n),this.invalidateData(e)}}this.isCheckMode()||this._handlePressSelection(e,t)}if(this._currentEditor&&this.commitEditValue(this._currentEditor._editInfo,this._currentEditor),this.updateCurrentEditor){var o=this;setTimeout(function(){o.updateCurrentEditor(t)},0)}},handleChange:function(t){if(!this._isCanceling&&!this._isValidating){var e=t.target._checkData;if(e){var i=this.isSelected(e),n=this.getSelectionModel();i?n.removeSelection(e):n.appendSelection(e)}t.target._editInfo&&this.commitEditValue&&this.commitEditValue(t.target._editInfo,t.target)}},scrollToData:function(t){if(t){var e=this.getRowIndexById(t.getId());if(!(0>e)){var i=e*this._rowHeight*this._zoom,n=i+this._rowHeight*this._zoom,o=this._view.scrollTop;this._view.scrollTop>i&&(o=i),this._view.scrollTop+this._view.clientHeight<n&&(o=n-this._view.clientHeight),this._view.scrollTop!=o&&(this._view.scrollTop=o,this.invalidate())}}},makeVisible:function(t){this.isVisible(t)&&(this.expand&&this.expand(t),Me.callLater(this.scrollToData,this,[t],2*kn.CALL_LATER_DELAY))},onSelectionChanged:function(t){this._makeVisibleOnSelected&&("append"===t.kind||"set"===t.kind||"all"===t.kind)&&(this.expand&&this.getSelectionModel().getSelection().forEach(function(t){t.getParent()&&this.expand(t.getParent())},this),Me.callLater(this.scrollToData,this,[this.getSelectionModel().getLastData()],2*kn.CALL_LATER_DELAY))},onShareSelectionModelChanged:function(){this.invalidateModel()}}),De.controls.TableBase=function(t){this._columnBox=new De.ColumnBox,this._columnBox.addDataBoxChangeListener(this.handleColumnBoxChange,this),this._columnBox.addDataPropertyChangeListener(this.handleColumnPropertyChange,this),this._columnBox.addHierarchyChangeListener(this.handleColumnHierarchyChange,this),De.controls.TableBase.superClass.constructor.apply(this,arguments),this._cellPool=new De.Pool("div",20),this._stringPool=new De.Pool("span",20),this._booleanPool=new De.Pool("input",20),this._colorPool=new De.Pool("div",20),this._pools.add(this._cellPool),this._pools.add(this._stringPool),this._pools.add(this._booleanPool),this._pools.add(this._colorPool)},Me.ext("twaver.controls.TableBase",De.controls.ListBase,{getColumnBox:function(){return this._columnBox},handleColumnBoxChange:function(t){this.invalidateDisplay()},handleColumnPropertyChange:function(t){t.source!==this._sortColumn||"sortDirection"!==t.property&&"sortFunction"!==t.property&&"sortable"!==t.property?this.invalidateDisplay():this.invalidateModel()},handleColumnHierarchyChange:function(t){this.invalidateDisplay()},renderData:function(t,e,i,n){for(var o,r=this._columnBox.getRoots(),a=r.size(),s=0,l=this._rowHeight-this._rowLineWidth+"px",h=0;a>h;h++){var c=r.get(h),u=c.getWidth();0>u&&(u=0);var d=Math.min(this._columnLineWidth,u);if(c.isVisible()){var f=this._cellPool.get();o=f.style,o.position="absolute",o.whiteSpace="nowrap",o.verticalAlign="middle",o.textAlign=c.getHorizontalAlign(),o.overflow="hidden",o.textOverflow="ellipsis",o.left=s+"px",o.width=u-d+"px",o.height=l,o.borderStyle="solid",o.borderWidth="0px",o.borderRightWidth=d+"px",o.borderRightColor=this._columnLineColor,0===h?(o.borderLeftWidth=d+"px",o.borderLeftColor=this._columnLineColor):o.borderLeftWidth="0px",t.appendChild(f);var p={data:e,value:this.getValue(e,c),div:f,view:this,column:c,rowIndex:i,selected:n};this.renderCell(p),this.onCellRendered(p),s+=u}}o=t.style,o.width=s+"px",o.height=l,o.backgroundColor=this.isCheckMode()&&this._focusedRow===i||!this.isCheckMode()&&n?this.getSelectColor(e):""},adjustRowSize:function(){},onCellRendered:function(t){},calculateSumWidth:function(){for(var t=this._columnBox.getRoots(),e=t.size(),i=0,n=0;e>n;n++){var o=t.get(n),r=o.getWidth();0>r&&(r=0),i+=r}return i},getCurrentSortFunction:function(){var t=this._sortColumn;if(t){var e=t.getSortFunction();if(e){var i=this,n="asc"===t.getSortDirection()?1:-1;return function(o,r){var a=i.getValue(o,t),s=i.getValue(r,t);return e.call(i,a,s,o,r)*n}}}return this._sortFunction},renderCell:function(t){var e=t.column;if(e.renderCell)return void e.renderCell(t);var i=t.value,n=e.getEnumInfo(t.rowIndex);n&&!Array.isArray(n)&&(i=n.map[i]),t.view.isCellEditable(t.data,e)&&(t.enumInfo=n,t.div._editInfo=t),bi.render(e.getValueType(),i,t.div,t.view,e.isInnerText())},getValue:function(t,e){return e.getValue(t,this)},setValue:function(t,e,i){e.setValue(t,i,this)},getColumnAt:function(t){var e=this.getLogicalPoint(t);if(!e)return null;for(var i=this._columnBox.getRoots(),n=0,o=i.size(),r=0;o>n;n++){var a=i.get(n),s=a.getWidth();if(0>s&&(s=0),e.x>r&&e.x<r+s)return a;r+=s}return null},isCellEditable:function(t,e){return this.isEditable()&&e.isEditable()},commitEditValue:function(t,e){if(!this._isCanceling){var i;i="checkbox"===e.type?e.checked:e.value;var n=t.column,o=n.getValueType();if("int"===o&&"string"==typeof i)i=parseInt(i);else if("number"===o&&"string"==typeof i)i=parseFloat(i);else if("list.points"===o){for(var r=i.replace(/\]/g,"").replace(/\[/g,"").split(","),a=new De.List,s=0;s<r.length;s+=2)s+1>=r.length||a.add({x:parseInt(r[s]),y:parseInt(r[s+1])});i=a}if(this.setValue(t.data,n,i),this._currentEditor){var l=this._currentEditor.parentNode,h=this._currentEditor;delete this._currentEditor,l&&l.removeChild(h),De.Util.setFocus(this._view)}delete this._isCommitting}},cancelEditing:function(){if(this._currentEditor){this._isCanceling=!0;var t=this._currentEditor.parentNode,e=this._currentEditor;delete this._currentEditor,t&&t.removeChild(e),De.Util.setFocus(this._view),delete this._isCanceling}},renderEditor:function(t){},onEditorRendered:function(t){},getEditorValue:function(t){var e=t.column.getValueType(),i=t.value,n="";if("list.points"===e){var o=i._as?i._as:i;o.forEach(function(t,e){n+=e==o.length-1?"["+t.x+","+t.y+"]":"["+t.x+","+t.y+"],"})}else n=i;return n},updateCurrentEditor:function(t){var e=t.target;if(e!==this._currentEditor&&e.parentNode!==this._currentEditor){for(var i;e&&e!==this._view&&!(i=e._editInfo);)e=e.parentNode;if(i&&e===i.div){var n=this.renderEditor&&this.renderEditor(i);n?(this._currentEditor=n.view,null!=i.value&&(this._currentEditor.value=this.getEditorValue(i))):i.enumInfo?this._currentEditor=Xe.createSelect(i.enumInfo,i.value):(this._currentEditor=ze.createElement("input"),null!=i.value&&(this._currentEditor.value=this.getEditorValue(i)));var o=this;if(i.column&&i.column.renderEditor){var n="function"==typeof i.column.renderEditor?i.column.renderEditor(o,i):i.column.renderEditor;n&&(o._currentEditor=n)}if(this._currentEditor){if(n&&n.onKeyDown){var r=n.onKeyDown;r&&Array.isArray(r)&&o._currentEditor.addEventListener("keydown",function(t){for(var e=0;e<r.length;e++)if(r[e].combKey){var i=null;switch(r[e].combKey){case"ctrlKey":i=t.ctrlKey;break;case"shiftKey":i=t.shiftKey;break;case"altKey":i=t.altKey}t.keyCode===r[e].keyCode&&i&&r[e].handlerEvent&&r[e].handlerEvent(t)}else t.keyCode===r[e].keyCode&&r[e].handlerEvent&&r[e].handlerEvent(t)})}else this._currentEditor.addEventListener("keydown",function(t){var e=t.target._editInfo.view;13===t.keyCode&&t.shiftKey||(13===t.keyCode?e.commitEditValue(t.target._editInfo,t.target):27===t.keyCode&&e.cancelEditing())},!1);if(this._currentEditor.addEventListener("blur",function(t){var e=t.target._editInfo.view;e._isCanceling||e.commitEditValue(t.target._editInfo,t.target)},!1),this._currentEditor.keepDefault=!0,this._currentEditor._editInfo=i,!this._currentEditor.parentNode){var a=this._currentEditor.style;a.position="absolute",a.margin="0px",a.border="0px",a.padding="0px",a.left=i.div.style.left,a.top=i.div.parentNode.style.top,a.width=i.div.style.width,a.height=i.div.style.height,this._rootDiv.appendChild(this._currentEditor)}De.Util.setFocus(this._currentEditor)}}}},onColumnSorted:function(t){},getCurrentEditor:function(){return this._currentEditor}}),De.controls.List=function(t){De.controls.List.superClass.constructor.apply(this,arguments)},Me.ext("twaver.controls.List",De.controls.ListBase,{__accessor:["rowHeight","indent","rowLineWidth","rowLineColor","sortFunction","visibleFunction"],__bool:["makeVisibleOnSelected","keyboardRemoveEnabled","keyboardSelectEnabled"],_checkMode:!1,_rowHeight:kn.LIST_ROW_HEIGHT,_indent:kn.LIST_INDENT,_rowLineWidth:kn.LIST_ROW_LINE_WIDTH,_rowLineColor:kn.LIST_ROW_LINE_COLOR,_makeVisibleOnSelected:kn.LIST_MAKE_VISIBLE_ON_SELECTED,_keyboardRemoveEnabled:kn.LIST_KEYBOARD_REMOVE_ENABLED,_keyboardSelectEnabled:kn.LIST_KEYBOARD_SELECT_ENABLED,isCheckMode:function(){return this._checkMode},setCheckMode:function(t){delete this._focusedRow;var e=this._checkMode;this._checkMode=t,this.firePropertyChange("checkMode",e,t)},isCheckable:function(t){return!0===this._checkMode},renderData:function(t,e,i,n){var o;this._indent>0&&(o=this.__spanPool.get(),o.style.width=this._indent+"px",o.style.display="inline-block",t.appendChild(o)),this.isCheckable(e)&&this._addCheckBox(t,e,n);var r=this.getIcon(e);r&&this._addIcon(t,e,r);var a=this.getLabel(e);if(a){o=this.__textPool.get();var s=o.style;s.whiteSpace="nowrap",s.verticalAlign="middle",s.padding="1px 2px 1px 2px",s.display="inline-block",Me.setText(o,a,this._innerText),this.onLabelRendered(o,e,a,i,n),t.appendChild(o)}t.style.backgroundColor=this.isCheckMode()?this._focusedRow===i?this.getSelectColor(e):"":n?this.getSelectColor(e):""},onLabelRendered:function(t,e,i,n,o){}}),De.controls.ListBaseInteraction=function(t){this.listBase=t,this.view=t._view,this.clickTimer=0,this.doubleClickInterval=300;var e=this;this.view.addEventListener("scroll",function(t){e.handleScroll(t)},!1),this.view.addEventListener("mousedown",function(t){e.handleMouseDown(t)},!1),this.view.addEventListener("keydown",function(t){e.handleKeyDown(t)},!1)},Me.ext("twaver.controls.ListBaseInteraction",Object,{handleMouseDown:function(t){var e=this.listBase,i=this;t.target!==e._currentEditor&&t.target.parentNode!==e._currentEditor&&(i.clickTimer?(clearTimeout(i.clickTimer),i.clickTimer=0,e._handleDoubleClick(t)):i.clickTimer=setTimeout(function(){e._handleClick(t),clearTimeout(i.clickTimer),i.clickTimer=0},300))},handleKeyDown:function(t){var e=this.listBase;if(!e._currentEditor)if(Me.isCtrlDown(t)&&65==t.keyCode)e.isKeyboardSelectEnabled()&&e.selectAll().size()>0&&e.fireInteractionEvent({kind:"selectAll"}),Xe.preventDefault(t);else if(46==t.keyCode)e.isKeyboardRemoveEnabled()&&e.removeSelection()&&e.fireInteractionEvent({kind:"removeElement"}),Xe.preventDefault(t);else if(e.isCheckMode()||38!==t.keyCode&&40!==t.keyCode&&37!==t.keyCode&&39!==t.keyCode)Me.showVersion(t);else{var i=e.getSelectionModel().getLastData();if(i)if(38===t.keyCode||40===t.keyCode){var n=e.getRowDatas(),o=e.getRowIndexByData(i);o>=0&&(38===t.keyCode?0!==o&&(i=n.get(o-1),e.getSelectionModel().setSelection(i)):o!==n.size()-1&&(i=n.get(o+1),e.getSelectionModel().setSelection(i)))}else!e.expand||37!==t.keyCode&&39!==t.keyCode||i.hasChildren()&&(37===t.keyCode?e.collapse(i):e.expand(i));else e.getRowDatas().size()>0&&(i=e.getRowDatas().get(0),e.getSelectionModel().setSelection(i))}},handleScroll:function(t){this.listBase.invalidate()}}),De.controls.ListBaseTouchInteraction=function(t){this.listBase=t,this.view=t._view,Xe.addEventListener("touchstart","handleTouchstart",this.view,this)},Me.ext("twaver.controls.ListBaseTouchInteraction",Object,{handleTouchstart:function(t){Xe.preventDefault(t),this.startPoint=this.lastPoint=this.listBase.getLogicalPoint(t),Xe.addEventListener("touchmove","handleTouchmove",this.view,this),Xe.addEventListener("touchend","handleTouchend",this.view,this),wi.isMultiTouch(t)&&(this.distance=wi.getDistance(t),this.zoom=this.listBase._zoom)},handleTouchmove:function(t){Xe.preventDefault(t);var e=this.listBase.getLogicalPoint(t);if(!(We.getDistance(this.startPoint,e)<20))if(this.moved||(this.moved=!0),wi.isSingleTouch(t)){if(this.lastPoint){var i=this.lastPoint.x-e.x,n=this.lastPoint.y-e.y,o=this.listBase.panByOffset(i,n);this.listBase.invalidate(),this.lastPoint.x-=i-o.x,this.lastPoint.y-=n-o.y}}else if(this.distance){var r=wi.getDistance(t)/this.distance;this.listBase.setZoom(this.zoom*r,!1)}},handleTouchend:function(t){Xe.preventDefault(t),this.moved||t.target===this.listBase._currentEditor||t.target.parentNode===this.listBase._currentEditor||this.listBase._handleClick(t),delete this.startPoint,delete this.lastPoint,delete this.moved,delete this.distance,delete this.zoom,Xe.removeEventListener("touchmove",this.view,this),Xe.removeEventListener("touchend",this.view,this)}}),De.controls.ListBaseMSTouchInteraction=function(t){De.controls.ListBaseMSTouchInteraction.superClass.constructor.apply(this,arguments),this._pointerMap={},this._pointerIdArray=[],Xe.addEventListener("MSPointerDown","handleTouchstart",this.view,this),Xe.addEventListener("MSPointerMove","handleTouchmove",this.view,this),Xe.addEventListener("MSPointerUp","handleTouchend",this.view,this),Xe.addEventListener("MSPointerCancel","handleTouchend",this.view,this),this.superHandleMouseDown=De.controls.ListBaseMSTouchInteraction.superClass.handleMouseDown},Me.ext("twaver.controls.ListBaseMSTouchInteraction",De.controls.ListBaseInteraction,{handleMouseDown:function(t){},handleTouchstart:function(t){t.isPrimary&&this._pointerIdArray.length>0&&(this._pointerMap={},this._pointerIdArray=[]),this._pointerMap[t.pointerId]||null==this.listBase.getLogicalPoint(t)||(this._pointerIdArray.push(t.pointerId),this._pointerMap[t.pointerId]=t),1==this._pointerIdArray.length&&t.pointerType==t.MSPOINTER_TYPE_MOUSE&&this.superHandleMouseDown(t),1==this._pointerIdArray.length?(this._startTouchPoint=this.listBase.getLogicalPoint(t),this._startTouchTime=new Date):2==this._pointerIdArray.length&&(this._distance=this._getDistance(),this._zoom=this.listBase.getZoom())},handleTouchmove:function(t){if(null!=this._startTouchPoint&&0!=this._pointerIdArray.length&&this._pointerMap[t.pointerId]&&!(We.getDistance({x:this._pointerMap[t.pointerId].pageX,y:this._pointerMap[t.pointerId].pageY},{x:t.pageX,y:t.pageY})<=10))if(this._pointerMap[t.pointerId]=t,2==this._pointerIdArray.length){var e=this._getDistance()/this._distance;this.listBase.setZoom(this._zoom*e,!1)}else if(1==this._pointerIdArray.length&&t.pointerType!=t.MSPOINTER_TYPE_MOUSE&&this._startTouchPoint){var i=this.listBase.getLogicalPoint(t);if(null==i)return;var n=this._startTouchPoint.x-i.x,o=this._startTouchPoint.y-i.y,r=this.listBase.panByOffset(n,o);this.listBase.invalidate(),this._startTouchPoint.x-=n-r.x,this._startTouchPoint.y-=o-r.y}},handleTouchend:function(t){if(this._startTouchPoint&&1==this._pointerIdArray.length&&t.pointerType!=t.MSPOINTER_TYPE_MOUSE){var e=this.listBase.getLogicalPoint(t);if(e){(new Date).getTime()-this._startTouchTime.getTime()<=500&&We.getDistance(this._startTouchPoint,e)<=20&&this.superHandleMouseDown(t)}}this._pointerMap={},this._pointerIdArray=[]},_getDistance:function(){return We.getDistance({x:this._pointerMap[this._pointerIdArray[0]].pageX,y:this._pointerMap[this._pointerIdArray[0]].pageY},{x:this._pointerMap[this._pointerIdArray[1]].pageX,y:this._pointerMap[this._pointerIdArray[1]].pageY})}}),De.controls.Tree=function(t){this._interactionDispatcher=new De.EventDispatcher,this._initTree(t),De.controls.Tree.superClass.constructor.apply(this,arguments)},Me.ext("twaver.controls.Tree",De.controls.ListBase,{__tree:1,__accessor:["rootData","sortFunction","visibleFunction","indent","rowHeight","rowLineWidth","rowLineColor","expandIcon","collapseIcon","uncheckableStyle","lineType","lineColor","lineThickness","lineAlpha","lineDash"],__bool:["rootVisible","makeVisibleOnSelected","keyboardRemoveEnabled","keyboardSelectEnabled"],_checkMode:!1,_indent:kn.TREE_INDENT,_rowHeight:kn.TREE_ROW_HEIGHT,_rowLineWidth:kn.TREE_ROW_LINE_WIDTH,_rowLineColor:kn.TREE_ROW_LINE_COLOR,_makeVisibleOnSelected:kn.TREE_MAKE_VISIBLE_ON_SELECTED,_keyboardRemoveEnabled:kn.TREE_KEYBOARD_REMOVE_ENABLED,_keyboardSelectEnabled:kn.TREE_KEYBOARD_SELECT_ENABLED,_expandIcon:kn.TREE_EXPAND_ICON,_collapseIcon:kn.TREE_COLLAPSE_ICON,_uncheckableStyle:"none",_lineType:kn.TREE_LINE_TYPE,_lineColor:kn.TREE_LINE_COLOR,_lineThickness:kn.TREE_LINE_THICKNESS,_lineAlpha:kn.TREE_LINE_ALPHA,_lineDash:kn.TREE_LINE_DASH,getCheckMode:function(){return this._checkMode},setCheckMode:function(t){delete this._focusedRow;var e=this._checkMode;this._checkMode=t,this.firePropertyChange("checkMode",e,t)},renderData:function(t,e,i,n){this._renderTree(t,e,i,n)},getToolTip:function(t){return t.getToolTip()||t.getName()}}),De.controls.Table=function(t){this._checkColumn=new De.Column,this._checkColumn.setName("check"),this._checkColumn.setEditable(!0),this._checkColumn.setWidth(40),this._checkColumn.setHorizontalAlign("center"),this._checkColumn.renderCell=this.renderCheckCell;var e=this;this._checkColumn.getValue=function(t,i){return e.isSelected(t)},De.controls.Table.superClass.constructor.apply(this,arguments)},Me.ext("twaver.controls.Table",De.controls.TableBase,{__accessor:["rowHeight","rowLineWidth","rowLineColor","columnLineWidth","columnLineColor","sortFunction","visibleFunction","sortColumn"],__bool:["editable","makeVisibleOnSelected","keyboardRemoveEnabled","keyboardSelectEnabled"],_editable:kn.TABLE_EDITABLE,_rowHeight:kn.TABLE_ROW_HEIGHT,_rowLineWidth:kn.TABLE_ROW_LINE_WIDTH,_rowLineColor:kn.TABLE_ROW_LINE_COLOR,_columnLineWidth:kn.TABLE_COLUMN_LINE_WIDTH,_columnLineColor:kn.TABLE_COLUMN_LINE_COLOR,_makeVisibleOnSelected:kn.TABLE_MAKE_VISIBLE_ON_SELECTED,_keyboardRemoveEnabled:kn.TABLE_KEYBOARD_REMOVE_ENABLED,_keyboardSelectEnabled:kn.TABLE_KEYBOARD_SELECT_ENABLED,getCheckColumn:function(){return this._checkColumn},isCheckMode:function(){return this._columnBox.contains(this._checkColumn)},setCheckMode:function(t){t!==this.isCheckMode()&&(delete this._focusedRow,t?this._columnBox.add(this._checkColumn,0):this._columnBox.remove(this._checkColumn),this.firePropertyChange("checkMode",!t,t))},renderCheckCell:function(t){var e=t.view._booleanPool.get();e.disabled=!1,e.type="checkbox",e.style.margin="0px 2px",e.style.verticalAlign="middle",e.checked=t.selected;var i=t.div;i.appendChild(e),""===i.style.textAlign&&(i.style.textAlign="center"),e._checkData=t.data}}),De.controls.TableHeader=function(t){De.controls.TableHeader.superClass.constructor.apply(this,arguments),this._invalidateScroll=!1,this._invalidateDisplay=!1,this._divPool=new De.Pool("div"),this._imagePool=new De.Pool("img"),this._textPool=new De.Pool("span"),this._resizePool=new De.Pool("div"),this._pools.add(this._divPool),this._pools.add(this._imagePool),this._pools.add(this._textPool),this._pools.add(this._resizePool),this._table=t,this._tableView=t.getView(),this._columnBox=t.getColumnBox(),this._columnBox.addDataBoxChangeListener(this.handleColumnBoxChange,this),this._columnBox.addDataPropertyChangeListener(this.handleColumnPropertyChange,this),this._columnBox.addHierarchyChangeListener(this.handleColumnHierarchyChange,this);var e=this;t.getView().addEventListener("scroll",function(t){e.invalidateScroll()},!1),t.addPropertyChangeListener(function(t){e.invalidateDisplay()},this),this._view=Xe.createView("hidden"),this._view.tabIndex=-1,this._view.style.background=kn.TABLEHEADER_BACKGROUND,this._rootDiv=Xe.createDiv(),this._view.appendChild(this._rootDiv),this.invalidateDisplay(),Ue.isTouchable&&new De.controls.TableHeaderTouchInteraction(this),new De.controls.TableHeaderInteraction(this)},Me.ext("twaver.controls.TableHeader",De.controls.ControlBase,{__accessor:["height","moveBackground","insertBackground","columnLineColor","resizeTolerance","sortDescIcon","sortAscIcon","sortIconPosition"],_height:kn.TABLEHEADER_HEIGHT,_moveBackground:kn.TABLEHEADER_MOVE_BACKGROUND,_insertBackground:kn.TABLEHEADER_INSERT_BACKGROUND,_columnLineColor:kn.TABLEHEADER_COLUMN_LINE_COLOR,_resizeTolerance:kn.TABLEHEADER_RESIZE_TOLERANCE,_sortDescIcon:kn.TABLEHEADER_SORT_DESC_ICON,_sortAscIcon:kn.TABLEHEADER_SORT_ASC_ICON,_sortIconPosition:kn.TABLEHEADER_SORT_ICON_POSITION,getRootDiv:function(){return this._rootDiv},handleColumnBoxChange:function(t){this.invalidateDisplay()},handleColumnPropertyChange:function(t){this.invalidateDisplay()},handleColumnHierarchyChange:function(t){this.invalidateDisplay()},onPropertyChanged:function(t){this.invalidateDisplay()},invalidateScroll:function(){this._invalidateScroll||(this._invalidateScroll=!0,this.invalidate())},invalidateDisplay:function(){this._invalidateDisplay||(this._invalidateDisplay=!0,this._invalidateScroll=!0,this.invalidate())},validate:function(){this._invalidate&&(this._invalidate=!1,this._invalidateDisplay&&(this._invalidateDisplay=!1,this.validateDisplay()),this._invalidateScroll&&(this._invalidateScroll=!1,this._rootDiv.style.left=-this._tableView.scrollLeft+"px"))},validateDisplay:function(){Xe.release(this._rootDiv);for(var t=this._table.getZoom(),e=this.getHeight()+"px",i=this.getHeight()-2+"px",n=this._table.getColumnBox().getRoots(),o=n.size(),r=0,a=this._table._columnLineWidth*t,s=0;o>s;s++){var l=n.get(s);if(l.isVisible()){var h=l.getWidth()*t;0>h&&(h=0);var c=Math.min(a,h),u=this._divPool.get();u._column=l;var d=u.style;d.position="absolute",d.whiteSpace="nowrap",d.lineHeight=i,d.overflow="hidden",d.textOverflow="ellipsis",d.backgroundPosition=this._sortIconPosition?this._sortIconPosition:"",d.backgroundRepeat="no-repeat",d.backgroundImage="",d.textAlign=l.getHorizontalAlign(),d.borderStyle="solid",d.borderWidth="0px",d.borderRightWidth=c+"px",d.borderRightColor=this._columnLineColor,0===s?(d.borderLeftWidth=c+"px",d.borderLeftColor=this._columnLineColor):d.borderLeftWidth="0px",d.left=r+"px",d.width=h-c+"px",d.height=e,u._x=r,u._width=h-c,this._rootDiv.insertBefore(u,this._rootDiv.firstChild),this.renderColumn(u,l),this.onColumnRendered(u,l),r+=h,l.isResizable()&&(u=this._resizePool.get(),u._resizeColumn=l,d=u.style,d.position="absolute",d.backgroundColor="white",d.opacity=0,d.left=r-c-this._resizeTolerance+"px",d.width=c+2*this._resizeTolerance+"px",d.height=e,this._rootDiv.appendChild(u))}}this._pools.forEach(function(t){t.clear()}),this._rootDiv.style.width=r+"px",this._rootDiv.style.height=e},renderColumn:function(t,e){if(e.renderHeader)e.renderHeader(t);else{var i=this._textPool.get();if(i.style.whiteSpace="nowrap",i.style.verticalAlign="middle",i.style.padding="1px 2px 1px 2px",i.innerHTML=e.getName()?e.getName():e.getPropertyName(),i.setAttribute("title",i.innerHTML),t.appendChild(i),Ue.isOpera){var n=t.cloneNode(!1);n.style.left="0px",n.style.top="0px",n.style.opacity=0,t.appendChild(n)}}if(this._table.getSortColumn()===e&&e.isSortable()){var o="asc"===e.getSortDirection()?this._sortAscIcon:this._sortDescIcon,r=Me.getImageSrc(o);if(this._sortIconPosition&&""!==this._sortIconPosition)t.style.backgroundImage="url("+r+")";else{var a=this._imagePool.get();a.setAttribute("src",r),a.style.verticalAlign="middle",t.appendChild(a)}}},onColumnRendered:function(t,e){}}),De.controls.TableHeaderInteraction=function(t){this.header=t,this.table=t._table,this.view=t._view;var e=this;this.view.addEventListener("mousedown",function(t){e.handleMouseDown(t)},!1),this.view.addEventListener("mousemove",function(t){e.handleMouseMove(t)},!1)},Me.ext("twaver.controls.TableHeaderInteraction",Object,{handleMouseDown:function(t){if(0===t.button){if(this.movableDiv)return void this.handleMouseUp(t);this.resizeColumn=t.target._resizeColumn,this.resizeColumn||(this.movableDiv=this.getMovableDivAt(t)),this.changeCursor(t),this._startClient=Xe.getClientPoint(t),this.lastX=this.getX(t),this._startLogicalX=this.lastX,Xe.handle_mousedown(this,t)}},changeCursor:function(t){var e="";if(t.target._resizeColumn)e="ew-resize";else{var i=this.getColumnAt(t);i&&(i.isMovable()||i.isSortable())&&(e="pointer")}this.view.style.cursor=e},handleMouseMove:function(t){if(null==this.lastX)return void this.changeCursor(t);if(Xe.target===this){var e=this._startLogicalX+t.clientX-this._startClient.x;if(this.resizeColumn){if(null!=this.stopX){if(e<this.stopX)return;delete this.stopX}var i=this.resizeColumn.getWidth()+(e-this.lastX)/this.table.getZoom();10>i&&(i=10,this.stopX=e),this.resizeColumn.setWidth(i),this.lastX=e}else if(this.movableDiv){var n=e-this.lastX;if(!this.cloneDiv){if(Math.abs(n)<3)return;this.cloneDiv=this.movableDiv.cloneNode(!0),this.cloneDiv._x=this.movableDiv._x,this.cloneDiv.style.background=this.header.getMoveBackground(),this.insertDiv=Xe.createDiv(),this.insertDiv.style.width="1px",this.insertDiv.style.height=this.cloneDiv.style.height,this.insertDiv.style.background=this.header.getInsertBackground(),this.movableDiv.parentNode.appendChild(this.cloneDiv),this.movableDiv.parentNode.appendChild(this.insertDiv)}var o=this.cloneDiv._x+n;this.cloneDiv.style.left=o+"px",this.cloneDiv._x=o,this.lastX=e,this.columnInfo=this.getColumnInfoAt(t),this.columnInfo&&(this.insertDiv.style.left=this.columnInfo.position)}}},handleMouseUp:function(t){if(0===t.button){var e;if(this.resizeColumn);else if(this.movableDiv&&this.columnInfo){e=this.movableDiv._column;var i=this.columnInfo.index;this.table.getColumnBox().moveTo(e,i)}else if((e=this.getColumnAt(t))&&e.isSortable()){var n=e.getSortDirection();this.table.getSortColumn()===e?("desc"===n&&this.table.setSortColumn(null),e.setSortDirection("asc"===n?"desc":"asc")):this.table.setSortColumn(e),this.table.onColumnSorted(this.table.getSortColumn())}this.clear()}},clear:function(){this.view.style.cursor="",this.cloneDiv&&this.movableDiv&&this.movableDiv.parentNode.removeChild(this.cloneDiv),this.insertDiv&&this.movableDiv&&this.movableDiv.parentNode.removeChild(this.insertDiv),delete this.movableDiv,delete this.columnInfo,delete this.insertDiv,delete this.cloneDiv,delete this.resizeColumn,delete this.stopX,delete this.lastX,delete this._startClient,delete this._startLogicalX},getColumnAt:function(t){t=t.target;for(var e;t&&t!==this.view&&!(e=t._column);)t=t.parentNode;return e},getMovableDivAt:function(t){t=t.target;for(var e;t&&t!==this.view&&!(e=t._column);)t=t.parentNode;return e&&e.isMovable()?t:null},getX:function(t){var e=Xe.getLogicalPoint(this.view,t);return e?e.x:null},getColumnInfoAt:function(t){for(var e=this._startLogicalX+t.clientX-this._startClient.x+this.table.getView().scrollLeft,i=this.table.getColumnBox().getRoots(),n=i.size(),o=this.table.getZoom(),r=0,a=!1,s=0;n>s;s++){var l=i.get(s);if(l===this.movableDiv._column&&(a=!0),l.isVisible()){var h=l.getWidth()*o;if(0>=h)continue;if(e>=r&&r+h>=e){var c=r+h/2>e;!a||l===this.movableDiv._column&&c||s--;var u=c?Math.max(0,s):Math.min(s+1,n),d=c?r:r+h;return d=Math.max(0,d-1),{index:u,column:l,position:d+"px"}}r+=h}}return this.columnInfo}}),De.controls.TableHeaderTouchInteraction=function(t){this.header=t,this.table=t._table,this.view=t._view,Xe.addEventListener("touchstart","handleTouchstart",this.view,this)},Me.ext("twaver.controls.TableHeaderTouchInteraction",Object,{handleTouchstart:function(t){return Xe.preventDefault(t),this.movableDiv?void this.handleTouchend(t):(this.resizeColumn=t.target._resizeColumn,this.resizeColumn||(this.movableDiv=this.getMovableDivAt(t)),this.lastX=this.getX(t),Xe.addEventListener("touchmove","handleTouchmove",this.view,this),void Xe.addEventListener("touchend","handleTouchend",this.view,this))},handleTouchmove:function(t){if(Xe.preventDefault(t),null!=this.lastX){var e;if(this.resizeColumn){if(e=this.getX(t),null!=this.stopX){if(e<this.stopX)return;delete this.stopX}var i=this.resizeColumn.getWidth()+(e-this.lastX)/this.table.getZoom();0>i&&(i=0,this.stopX=e),this.resizeColumn.setWidth(i),this.lastX=e}else if(this.movableDiv){e=this.getX(t);var n=e-this.lastX;if(!this.cloneDiv){if(Math.abs(n)<3)return;this.cloneDiv=this.movableDiv.cloneNode(!0),this.cloneDiv._x=this.movableDiv._x,this.cloneDiv.style.background=this.header.getMoveBackground(),this.insertDiv=Xe.createDiv(),this.insertDiv.style.width="1px",this.insertDiv.style.height=this.cloneDiv.style.height,this.insertDiv.style.background=this.header.getInsertBackground(),this.movableDiv.parentNode.appendChild(this.cloneDiv),this.movableDiv.parentNode.appendChild(this.insertDiv)}var o=this.cloneDiv._x+n;this.cloneDiv.style.left=o+"px",this.cloneDiv._x=o,this.lastX=e,this.columnInfo=this.getColumnInfoAt(t),this.columnInfo&&(this.insertDiv.style.left=this.columnInfo.position)}}},handleTouchend:function(t){Xe.preventDefault(t);var e;if(this.resizeColumn);else if(this.movableDiv&&this.columnInfo){e=this.movableDiv._column;var i=this.columnInfo.index;this.table.getColumnBox().moveTo(e,i)}else if((e=this.getColumnAt(t))&&e.isSortable()){var n=e.getSortDirection();this.table.getSortColumn()===e?("desc"===n&&this.table.setSortColumn(null),e.setSortDirection("asc"===n?"desc":"asc")):this.table.setSortColumn(e)}this.clear(),Xe.removeEventListener("touchmove",this.view,this),Xe.removeEventListener("touchend",this.view,this)},clear:function(){this.cloneDiv&&this.movableDiv&&this.movableDiv.parentNode.removeChild(this.cloneDiv),this.insertDiv&&this.movableDiv&&this.movableDiv.parentNode.removeChild(this.insertDiv),delete this.movableDiv,delete this.columnInfo,delete this.insertDiv,delete this.cloneDiv,delete this.resizeColumn,delete this.stopX,delete this.lastX},getColumnAt:function(t){t=t.target;for(var e;t&&t!==this.view&&!(e=t._column);)t=t.parentNode;return e},getMovableDivAt:function(t){t=t.target;for(var e;t&&t!==this.view&&!(e=t._column);)t=t.parentNode;return e&&e.isMovable()?t:null},getX:function(t){var e=Xe.getLogicalPoint(this.view,t);return e?e.x:null},getColumnInfoAt:function(t){for(var e=this.getX(t)+this.table.getView().scrollLeft,i=this.table.getColumnBox().getRoots(),n=i.size(),o=this.table.getZoom(),r=0,a=!1,s=0;n>s;s++){var l=i.get(s);if(l===this.movableDiv._column&&(a=!0),l.isVisible()){var h=l.getWidth()*o;if(0>=h)continue;if(e>=r&&r+h>=e){var c=r+h/2>e;!a||l===this.movableDiv._column&&c||s--;var u=c?Math.max(0,s):Math.min(s+1,n),d=c?r:r+h;return d=Math.max(0,d-1),{index:u,column:l,position:d+"px"}}r+=h}}return this.columnInfo}}),De.controls.TablePane=function(t,e){De.controls.TablePane.superClass.constructor.apply(this,arguments),this.invalidate(),this._table=t,this._tableHeader=e||new De.controls.TableHeader(t),this._view=Xe.createView("hidden",!0),this._view.tabIndex=-1,this._view.appendChild(this._tableHeader.getView()),this._view.appendChild(this._table.getView());var i=this;this._tableHeader.addPropertyChangeListener(function(t){"height"===t.property&&i.invalidate()})},Me.ext("twaver.controls.TablePane",De.controls.ControlBase,{onPropertyChanged:function(t){this.invalidate()},getTable:function(){return this._table},getTableHeader:function(){return this._tableHeader},validateImpl:function(){var t=this._view.offsetWidth,e=this._view.offsetHeight,i=this._tableHeader.getHeight();this._tableHeader.adjustBounds({x:0,y:0,width:t,height:i}),this._table.adjustBounds({x:0,y:i,width:t,height:Math.max(0,e-i)})}}),De.controls.TreeTable=function(t){this._treeColumn=new De.Column,this._treeColumn.setName("tree"),this._treeColumn.setWidth(120),this._treeColumn.renderCell=this.renderTreeCell,this._treeColumn.getValue=this.getTreeValue,this._treeColumn.setValue=this.setTreeValue,this._initTree(t),De.controls.TreeTable.superClass.constructor.apply(this,arguments),this._columnBox.add(this._treeColumn)},Me.ext("twaver.controls.TreeTable",De.controls.TableBase,{__tree:1,__accessor:["sortFunction","visibleFunction","checkMode","rootData","sortColumn","indent","rowHeight","rowLineWidth","rowLineColor","columnLineWidth","columnLineColor","expandIcon","collapseIcon","uncheckableStyle","lineType","lineColor","lineThickness","lineAlpha","lineDash"],__bool:["editable","rootVisible","makeVisibleOnSelected","keyboardRemoveEnabled","keyboardSelectEnabled"],_editable:kn.TREETABLE_EDITABLE,_indent:kn.TREETABLE_INDENT,_rowHeight:kn.TREETABLE_ROW_HEIGHT,_rowLineWidth:kn.TREETABLE_ROW_LINE_WIDTH,_rowLineColor:kn.TREETABLE_ROW_LINE_COLOR,_columnLineWidth:kn.TREETABLE_COLUMN_LINE_WIDTH,_columnLineColor:kn.TREETABLE_COLUMN_LINE_COLOR,_makeVisibleOnSelected:kn.TREETABLE_MAKE_VISIBLE_ON_SELECTED,_keyboardRemoveEnabled:kn.TREETABLE_KEYBOARD_REMOVE_ENABLED,_keyboardSelectEnabled:kn.TREETABLE_KEYBOARD_SELECT_ENABLED,_expandIcon:kn.TREETABLE_EXPAND_ICON,_collapseIcon:kn.TREETABLE_COLLAPSE_ICON,_lineType:kn.TREE_LINE_TYPE,_lineColor:kn.TREE_LINE_COLOR,_lineThickness:kn.TREE_LINE_THICKNESS,_lineAlpha:kn.TREE_LINE_ALPHA,_lineDash:kn.TREE_LINE_DASH,getTreeColumn:function(){return this._treeColumn},renderTreeCell:function(t){t.view._renderTree(t.div,t.data,t.rowIndex,t.selected)},getTreeValue:function(t,e){return e.getLabel(t)},setTreeValue:function(t,e,i){t.setName(e)}}),De.controls.PropertySheet=function(t){De.controls.PropertySheet.superClass.constructor.apply(this,arguments),this._currentRowIndex=-1,this._currentEditor=null,this._currentData=null,this._invalidate=!1,this._resizeDiv=Xe.createDiv(),this._resizeDiv.style.backgroundColor="white",this._resizeDiv.style.opacity=0,this._resizeDiv.style.top="0px",this._categoryList=new hn,this._categoryMap={},this._rowList=new hn,this._propertyBox=new De.PropertyBox,this._propertyBox.addDataBoxChangeListener(this.invalidatePropertyBox,this),this._propertyBox.addDataPropertyChangeListener(this.invalidatePropertyBox,this),this._propertyBox.addHierarchyChangeListener(this.invalidatePropertyBox,this),this.__divPool=new De.Pool("div",2),this.__cellPool=new De.Pool("div",2),this.__imagePool=new De.Pool("img",2),this.__textPool=new De.Pool("span",2),this._stringPool=new De.Pool("span",2),this._booleanPool=new De.Pool("input",2),this._colorPool=new De.Pool("div",2),this._pools.add(this.__divPool),this._pools.add(this.__cellPool),this._pools.add(this.__imagePool),this._pools.add(this.__textPool),this._pools.add(this._stringPool),this._pools.add(this._booleanPool),this._pools.add(this._colorPool),this._view=Xe.createView("auto"),this._rootDiv=Xe.createDiv(),this._dataDiv=Xe.createDiv(),this._view.appendChild(this._rootDiv),this._rootDiv.appendChild(this._dataDiv),this.setDataBox(t||new De.DataBox);var e=this;this._view.addEventListener("change",function(t){e.handleChange(t)},!1),Ue.isTouchable?Ue.isMSTouchable?new De.controls.PropertySheetMSTouchInteraction(this):(new De.controls.PropertySheetTouchInteraction(this),new De.controls.PropertySheetInteraction(this)):new De.controls.PropertySheetInteraction(this)},Me.ext("twaver.controls.PropertySheet",De.controls.View,{__accessor:["indent","rowHeight","sumWidth","propertyNameWidth","propertyNameHorizontalAlign","autoAdjustable","rowLineWidth","columnLineWidth","borderColor","categorizable","resizeTolerance","editable","selectColor","expandIcon","collapseIcon","sortFunction","visibleFunction"],_autoAdjustable:kn.PROPERTYSHEET_AUTO_ADJUSTABLE,_selectColor:kn.SELECT_COLOR,_categorizable:kn.PROPERTYSHEET_CATEGORIZABLE,_editable:kn.PROPERTYSHEET_EDITABLE,_propertyNameWidth:kn.PROPERTYSHEET_PROPERTY_NAME_WIDTH,_propertyNameHorizontalAlign:kn.PROPERTYSHEET_PROPERTY_NAME_HORIZONTAL_ALIGN,_sumWidth:kn.PROPERTYSHEET_SUM_WIDTH,_indent:kn.PROPERTYSHEET_INDENT,_rowHeight:kn.PROPERTYSHEET_ROW_HEIGHT,_rowLineWidth:kn.PROPERTYSHEET_ROW_LINE_WIDTH,_columnLineWidth:kn.PROPERTYSHEET_COLUMN_LINE_WIDTH,_borderColor:kn.PROPERTYSHEET_BORDER_COLOR,_expandIcon:kn.PROPERTYSHEET_EXPAND_ICON,_collapseIcon:kn.PROPERTYSHEET_COLLAPSE_ICON,_resizeTolerance:kn.PROPERTYSHEET_RESIZE_TOLERANCE,getPropertyBox:function(){return this._propertyBox},getCurrentData:function(){return this._currentData},getDataDiv:function(){return this._dataDiv},getDataBox:function(){return this._box},setDataBox:function(t){if(!t)throw"DataBox can not be null";if(this._box!==t){var e=this._box;e&&(e.removeDataPropertyChangeListener(this.handlePropertyChange,this),this._selectionModel||e.getSelectionModel().removeSelectionChangeListener(this.handleSelectionChange,this)),this._box=t,this._box.addDataPropertyChangeListener(this.handlePropertyChange,this),this._selectionModel?this._selectionModel._setDataBox(t):this._box.getSelectionModel().addSelectionChangeListener(this.handleSelectionChange,this),this.invalidate(),this.firePropertyChange("dataBox",e,this._box)}},invalidatePropertyBox:function(){this._isValidating||this.invalidate()},onPropertyChanged:function(t){"zoom"!==t.property&&this.invalidate()},isVisible:function(t){return!(t.isVisible&&!t.isVisible(this._currentData,this))&&(!this._visibleFunction||this._visibleFunction(t))},handlePropertyChange:function(t){this._currentData===t.source&&this.invalidate()},handleSelectionChange:function(t){this._currentData!==this.getSelectionModel().getLastData()&&(this._currentRowIndex=-1,this.invalidate())},isExpanded:function(t){if(!t)return!0;var e=this._categoryMap[t];return e?e.isExpanded:kn.PROPERTYSHEET_EXPAND_CATEGORY},expand:function(t){if(t){var e=this._categoryMap[t];e&&!e.isExpanded&&(e.isExpanded=!0,this.invalidate())}},expandAll:function(){for(var t in this._categoryMap){var e=this._categoryMap[t];e&&(e.isExpanded=!0)}this.invalidate()},collapse:function(t){if(t){var e=this._categoryMap[t];e&&e.isExpanded&&(e.isExpanded=!1,this.invalidate())}},collapseAll:function(){for(var t in this._categoryMap){var e=this._categoryMap[t];e&&(e.isExpanded=!1)}this.invalidate()},getCategoryName:function(t){if(!this.isCategorizable())return"null";var e=t.getCategoryName();return e||"null"},validateModel:function(){this._rowList.clear(),this._categoryList.clear();var t,e,i,n,o,r={},a=new hn,s=this._currentData?this._propertyBox.getRoots():new hn;for(n=s.size(),t=0;n>t;t++)o=s.get(t),this.isVisible(o)&&(a.add(o),i=this.getCategoryName(o),r[i]||(this._categoryList.add(i),r[i]={isExpanded:this.isExpanded(i),properties:new hn}));for(this._sortFunction&&a.sort(this._sortFunction),this._categoryMap=r,n=a.size(),t=0;t<this._categoryList.size();t++){"null"!==(i=this._categoryList.get(t))&&this._rowList.add(i);var l=r[i];if(l.isExpanded)for(e=0;n>e;e++)o=a.get(e),this.getCategoryName(o)===i&&(l.properties.add(o),this._rowList.add({view:this,data:this._currentData,property:o,value:this._currentData?this.getValue(this._currentData,o):null}))}},adjustWidth:function(){var t=this._view.offsetWidth,e=this._view.offsetHeight;t<=this._indent||0>=e||(t-=this._indent,this._rowList.size()*this._rowHeight>e&&0>=(t-=kn.SCROLL_BAR_WIDTH)||(this._propertyNameWidth=0===this._sumWidth||this._propertyNameWidth>this._sumWidth?t/2:t*(this._propertyNameWidth/this._sumWidth),this._sumWidth=t,this._view.style.overflowX="hidden",this._view.style.overflowY="auto"))},validateDisplay:function(){var t=this._rowList.size(),e=this._borderColor,i=this._indent,n=this._rowHeight,o=this._propertyNameWidth,r=Math.max(0,this._sumWidth-o),a=this._rowLineWidth,s=this._columnLineWidth,l=n-a+"px",h=n-a-2+"px",c=i+"px",u=o-s+"px",d=r-s+"px",f=o+r+"px",p=a+"px",g=s+"px",_=o+"px",m=this._dataDiv,v=m.style;v.height=t*n+"px",v.width=i+o+r+"px";var y=this.__divPool.get();v=y.style,v.position="absolute",v.left="0px",v.top="0px",v.width=c,v.height=m.style.height,v.borderWidth="0px",v.backgroundColor=e,m.appendChild(y);for(var w=0;t>w;w++){var b=this._rowList.get(w),x=w*n+"px",A=this.__divPool.get();if(b.rowDiv=A,v=A.style,v.position="absolute",v.whiteSpace="nowrap",v.overflow="hidden",v.textOverflow="ellipsis",v.left=c,v.top=x,v.width=f,v.height=l,v.lineHeight=h,v.borderStyle="solid",v.borderWidth="0px",v.borderBottomWidth=p,v.borderBottomColor=e,m.appendChild(A),"string"==typeof b){v.backgroundColor=e,y=this.__divPool.get(),v=y.style,v.position="absolute",v.left="0px",v.top=x,v.width=c,v.height=l,v.lineHeight=h,v.borderWidth="0px",m.appendChild(y);var C=this.__imagePool.get(),T=this.isExpanded(b)?this._expandIcon:this._collapseIcon;C.setAttribute("src",Me.getImageSrc(T)),v=C.style,v.verticalAlign="middle",C._expandData=b,y.appendChild(C),this.renderCategory(A,b),this.onCategoryRendered(A,b)}else{var k=b.property,S=this.__cellPool.get();b.nameRender=S,v=S.style,this._currentRowIndex===w&&(v.backgroundColor=this.getSelectColor()),v.position="absolute",v.verticalAlign="middle",v.textAlign=this._propertyNameHorizontalAlign,v.overflow="hidden",v.textOverflow="ellipsis",v.whiteSpace="nowrap",v.left="0px",v.top="0px",v.width=u,v.height=l,v.borderStyle="solid",v.borderWidth="0px",v.borderRightWidth=g,v.borderRightColor=e,A.appendChild(S),this.renderName(b),this.onNameRendered(b),S=this.__cellPool.get(),b.valueRender=S,v=S.style,v.position="absolute",v.verticalAlign="middle",v.textAlign=k.getHorizontalAlign(),v.whiteSpace="nowrap",v.overflow="hidden",v.textOverflow="ellipsis",v.left=_,v.top="0px",v.width=d,v.height=l,v.borderStyle="solid",v.borderWidth="0px",v.borderRightWidth=g,v.borderRightColor=e,A.appendChild(S),this.renderValue(b),this.onValueRendered(b)}}v=this._resizeDiv.style,v.left=i+o-s-this._resizeTolerance+"px",v.width=s+2*this._resizeTolerance+"px",v.height=m.style.height,m.appendChild(this._resizeDiv)},renderCategory:function(t,e){var i=this.__textPool.get(),n=i.style;n.fontWeight="bold",n.whiteSpace="nowrap",n.overflow="hidden",n.textOverflow="ellipsis",n.verticalAlign="middle",n.padding="1px 2px 1px 2px",i.innerHTML=e,i.setAttribute("title",e),t.appendChild(i)},onCategoryRendered:function(t,e){},renderName:function(t){if(t.property.renderName)return void t.property.renderName(t);var e=this.__textPool.get(),i=e.style;i.fontWeight="",i.whiteSpace="nowrap",i.verticalAlign="middle",i.padding="1px 2px 1px 2px";var n=t.property.getName();n||(n=t.property.getPropertyName()),e.innerHTML=n,e.setAttribute("title",n),t.nameRender.appendChild(e)},onNameRendered:function(t){},renderValue:function(t){var e=t.property;if(e.renderValue)return void e.renderValue(t);var i=t.value,n=e.getEnumInfo(this._currentData);n&&!Array.isArray(n)&&(i=n.map[i]),t.view.isCellEditable(t.data,e)&&(t.enumInfo=n,t.valueRender._editInfo=t),t.valueRender.innerHTML="",bi.render(e.getValueType(),i,t.valueRender,t.view,e.isInnerText())},onValueRendered:function(t){},renderEditor:function(t){},onEditorRendered:function(t){},updateCurrentData:function(){this._currentData=this.getSelectionModel().getLastData()},validateImpl:function(){var t=this._view.scrollLeft,e=this._view.scrollTop;Xe.release(this._dataDiv),this.updateCurrentData(),this.validateModel(),this.isAutoAdjustable()&&this.adjustWidth(),this.validateDisplay(),this._pools.forEach(function(t){t.clear()}),this._view.scrollLeft!==t&&(this._view.scrollLeft=t),this._view.scrollTop!==e&&(this._view.scrollTop=e)},getValue:function(t,e){return t?e.getValue(t,this):null},setValue:function(t,e,i){t&&e.setValue(t,i,this)},isCellEditable:function(t,e){return!!t&&(this.isEditable()&&e.isEditable())},getRowIndexAt:function(t){var e=this.getLogicalPoint(t);if(!e)return-1;var i=parseInt(e.y/this._rowHeight);return i>=0&&i<this._rowList.size()?i:-1},handleChange:function(t){this._isCommitting||this._isCanceling||this._isValidating||t.target._editInfo&&this.commitEditValue&&this.commitEditValue(t.target._editInfo,t.target)},commitEditValue:function(t,e){var i;i="checkbox"===e.type?e.checked:e.value;var n=t.property,o=n.getValueType();if("int"===o&&"string"==typeof i)i=parseInt(i);else if("number"===o&&"string"==typeof i)i=parseFloat(i);else if("array.string"===o)i=i.split(",");else if("array.number"===o){i=i.split(",");for(var r=0,a=i.length;a>r;r++)i[r]=parseFloat(i[r])}else if("list.points"===o){for(var s=i.replace(/\]/g,"").replace(/\[/g,"").split(","),l=new De.List,r=0;r<s.length;r+=2)r+1>=s.length||l.add({x:parseInt(s[r]),y:parseInt(s[r+1])});i=l}if(e._rowInfo&&(e._rowInfo.value=i,this.renderValue(e._rowInfo)),this.setValue(t.data,n,i),De.Util.setFocus(this._view),this._currentEditor){var h=this._currentEditor.parentNode;h&&h.removeChild(this._currentEditor),delete this._currentEditor}delete this._isCommitting},cancelEditing:function(){if(this._currentEditor){var t=this._currentEditor.parentNode;t&&t.removeChild(this._currentEditor),delete this._currentEditor,delete this._isCanceling}},getEditorValue:function(t){var e=t.valueRender._editInfo,i=e.property.getValueType(),n=t.valueRender._editInfo.value,o="";if("list.points"===i){var r=n._as?n._as:n;r.forEach(function(t,e){o+=e==r.length-1?"["+t.x+","+t.y+"]":"["+t.x+","+t.y+"],"})}else o=n;return o},updateCurrentRowIndex:function(t){var e=this._rowList.size();(0>t||t>=e)&&(t=-1);var i,n=this._currentRowIndex;if(t!==n&&(n>=0&&e>n&&(i=this._rowList.get(n),i.nameRender&&(i.nameRender.style.backgroundColor="")),this._currentRowIndex=t),t>=0&&(i=this._rowList.get(t),i.nameRender&&(i.nameRender.style.backgroundColor=this.getSelectColor(),!this._currentEditor&&i.valueRender&&i.valueRender._editInfo))){var o=i.valueRender._editInfo,r=this.renderEditor&&this.renderEditor(i);r?(this._currentEditor=r.view,null!=o.value&&(this._currentEditor.value=this.getEditorValue(i))):o.enumInfo?this._currentEditor=Xe.createSelect(o.enumInfo,o.value):(this._currentEditor=ze.createElement("input"),null!=o.value&&(this._currentEditor.value=this.getEditorValue(i)));var a=this;if(i.property&&i.property.renderEditor){var r="function"==typeof i.property.renderEditor?i.property.renderEditor(a,i):i.property.renderEditor;r&&(a._currentEditor=r)}if(this._currentEditor){if(r&&r.onKeyDown){var s=r.onKeyDown;s&&Array.isArray(s)&&a._currentEditor.addEventListener("keydown",function(t){for(var e=0;e<s.length;e++)if(s[e].combKey){var i=null;switch(s[e].combKey){case"ctrlKey":i=t.ctrlKey;break;case"shiftKey":i=t.shiftKey;break;case"altKey":i=t.altKey}t.keyCode===s[e].keyCode&&i&&s[e].handlerEvent&&s[e].handlerEvent(t)}else t.keyCode===s[e].keyCode&&s[e].handlerEvent&&s[e].handlerEvent(t)})}else this._currentEditor.addEventListener("keydown",function(t){var e=t.target._editInfo.view;if(13!==t.keyCode||!t.shiftKey)if(13===t.keyCode){if(e._isCommitting)return;e._isCommitting=!0,e.commitEditValue(t.target._editInfo,t.target)}else 27===t.keyCode&&(e._isCanceling=!0,e.cancelEditing())},!1);if(this._currentEditor.addEventListener("blur",function(t){var e=t.target._editInfo.view;e._isCommitting||e._isCanceling||(e._isCommitting=!0,e.commitEditValue(t.target._editInfo,t.target))},!1),this._currentEditor.keepDefault=!0,this._currentEditor._rowInfo=i,this._currentEditor._editInfo=o,!this._currentEditor.parentNode){var l=this._currentEditor.style;l.position="absolute",l.margin="0px",l.border="0px",l.padding="0px",l.left=this._indent+this._propertyNameWidth+"px",l.top=i.rowDiv.style.top,l.width=i.valueRender.style.width,l.height=i.valueRender.style.height,this._rootDiv.appendChild(this._currentEditor)}De.Util.setFocus(this._currentEditor),this.onEditorRendered&&this.onEditorRendered(i)}}}}),De.controls.PropertySheetInteraction=function(t){this.sheet=t,this.view=t._view,this.resizeDiv=t._resizeDiv;var e=this;this.view.addEventListener("mousedown",function(t){0===t.button&&e.handleMouseDown(t)},!1),this.view.addEventListener("mousemove",function(t){e.handleMouseMove(t)},!1)},Me.ext("twaver.controls.PropertySheetInteraction",Object,{minGap:10,handleMouseDown:function(t){if(t.target!==this.sheet._currentEditor&&t.target.parentNode!==this.sheet._currentEditor&&(this.sheet.isFocusOnClick()&&De.Util.setFocus(this.view),!this.sheet._isValidating))if(t.target._expandData){var e=t.target._expandData;this.sheet.isExpanded(e)?this.sheet.collapse(e):this.sheet.expand(e)}else if(t.target===this.resizeDiv)this.lastX=this.getX(t),Xe.handle_mousedown(this,t);else{this.sheet._currentEditor&&!this.sheet._isCommitting&&(this.sheet._isCommitting=!0,this.sheet.commitEditValue(this.sheet._currentEditor._editInfo,this.sheet._currentEditor));var i=this.sheet.getRowIndexAt(t);this.sheet.updateCurrentRowIndex(i)}},handleMouseMove:function(t){if(null==this.lastX&&!Xe.target)return void this.changeCursor(t);if(Xe.target===this&&null!=this.lastX){var e=this.getX(t);if(null!=this.stopLeft){if(e<this.stopLeft)return;delete this.stopLeft}if(null!=this.stopRight){if(e>this.stopRight)return;delete this.stopRight}var i=this.sheet.getPropertyNameWidth()+(e-this.lastX);i<this.minGap?(i=this.minGap,this.stopLeft=e):i>this.sheet.getSumWidth()-this.minGap&&(i=this.sheet.getSumWidth()-this.minGap,this.stopRight=e),this.sheet.setPropertyNameWidth(i),this.lastX=e}},handleMouseUp:function(t){0===t.button&&(this.view.style.cursor="default",delete this.stopLeft,delete this.stopRight,delete this.lastX)},changeCursor:function(t){this.view.style.cursor=t.target===this.resizeDiv?"ew-resize":"default"},getX:function(t){return t.clientX/this.sheet.getZoom()}}),De.controls.PropertySheetTouchInteraction=function(t){this.sheet=t,this.view=t._view,this.resizeDiv=t._resizeDiv,Xe.addEventListener("touchstart","handleTouchstart",this.view,this)},Me.ext("twaver.controls.PropertySheetTouchInteraction",Object,{minGap:10,handleTouchstart:function(t){Xe.preventDefault(t),t.target!==this.sheet._currentEditor&&t.target.parentNode!==this.sheet._currentEditor&&(this.sheet.isFocusOnClick()&&De.Util.setFocus(this.view),this.sheet._isValidating||(t.target===this.resizeDiv&&(this.lastX=this.getX(t)),this.lastPoint=this.sheet.getLogicalPoint(t),wi.isMultiTouch(t)&&(this.distance=wi.getDistance(t),this.zoom=this.sheet.getZoom()),Xe.addEventListener("touchmove","handleTouchmove",this.view,this),Xe.addEventListener("touchend","handleTouchend",this.view,this)))},handleTouchmove:function(t){if(Xe.preventDefault(t),this.moved||(this.moved=!0),null!=this.lastX){var e=this.getX(t);if(null!=this.stopLeft){if(e<this.stopLeft)return;delete this.stopLeft}if(null!=this.stopRight){if(e>this.stopRight)return;delete this.stopRight}var i=this.sheet.getPropertyNameWidth()+(e-this.lastX);i<this.minGap?(i=this.minGap,this.stopLeft=e):i>this.sheet.getSumWidth()-this.minGap&&(i=this.sheet.getSumWidth()-this.minGap,this.stopRight=e),this.sheet.setPropertyNameWidth(i),this.lastX=e}else if(wi.isSingleTouch(t)){if(this.lastPoint){var n=this.sheet.getLogicalPoint(t),o=this.lastPoint.x-n.x,r=this.lastPoint.y-n.y,a=this.sheet.panByOffset(o,r);this.lastPoint.x-=o-a.x,this.lastPoint.y-=r-a.y}}else if(this.distance){var s=wi.getDistance(t)/this.distance;this.sheet.setZoom(this.zoom*s,!1)}},handleTouchend:function(t){if(Xe.preventDefault(t),!this.moved)if(t.target._expandData){var e=t.target._expandData;this.sheet.isExpanded(e)?this.sheet.collapse(e):this.sheet.expand(e)}else if(t.target===this.resizeDiv);else{var i=this.sheet.getRowIndexAt(t);this.sheet.updateCurrentRowIndex(i)}delete this.stopLeft,delete this.stopRight,delete this.lastX,delete this.lastPoint,delete this.distance,delete this.zoom,delete this.moved,Xe.removeEventListener("touchmove",this.view,this),Xe.removeEventListener("touchend",this.view,this)},getX:function(t){return t.changedTouches[0].clientX}}),De.controls.PropertySheetMSTouchInteraction=function(t){this.sheet=t,this.view=t._view,this.resizeDiv=t._resizeDiv,this._pointerMap={},this._pointerIdArray=[],Xe.addEventListener("MSPointerDown","handleTouchstart",this.view,this),Xe.addEventListener("MSPointerMove","handleTouchmove",this.view,this),Xe.addEventListener("MSPointerUp","handleTouchend",this.view,this),Xe.addEventListener("MSPointerCancel","handleTouchend",this.view,this),this.superHandleMouseDown=De.controls.PropertySheetMSTouchInteraction.superClass.handleMouseDown},Me.ext("twaver.controls.PropertySheetMSTouchInteraction",De.controls.PropertySheetInteraction,{handleMouseDown:function(t){},handleTouchstart:function(t){t.isPrimary&&this._pointerIdArray.length>0&&(this._pointerMap={},this._pointerIdArray=[]),this._pointerMap[t.pointerId]||null==this.sheet.getLogicalPoint(t)||(this._pointerIdArray.push(t.pointerId),this._pointerMap[t.pointerId]=t),1==this._pointerIdArray.length&&t.pointerType==t.MSPOINTER_TYPE_MOUSE&&this.superHandleMouseDown(t),1==this._pointerIdArray.length?(this._startTouchPoint=this.sheet.getLogicalPoint(t),this._startTouchTime=new Date):2==this._pointerIdArray.length&&(this._distance=this._getDistance(),this._zoom=this.sheet.getZoom())},handleTouchmove:function(t){if(0!=this._pointerIdArray.length&&this._pointerMap[t.pointerId]&&!(We.getDistance({x:this._pointerMap[t.pointerId].pageX,y:this._pointerMap[t.pointerId].pageY},{x:t.pageX,y:t.pageY})<=10))if(this._pointerMap[t.pointerId]=t,2==this._pointerIdArray.length){var e=this._getDistance()/this._distance;this.sheet.setZoom(this._zoom*e,!1)}else if(1==this._pointerIdArray.length&&t.pointerType!=t.MSPOINTER_TYPE_MOUSE&&this._startTouchPoint){var i=this.sheet.getLogicalPoint(t);if(null==i)return;var n=this._startTouchPoint.x-i.x,o=this._startTouchPoint.y-i.y,r=this.sheet.panByOffset(n,o);this._startTouchPoint.x-=n-r.x,this._startTouchPoint.y-=o-r.y}},handleTouchend:function(t){if(1==this._pointerIdArray.length&&t.pointerType!=t.MSPOINTER_TYPE_MOUSE){var e=this.sheet.getLogicalPoint(t);(new Date).getTime()-this._startTouchTime.getTime()<=500&&We.getDistance(this._startTouchPoint,e)<=20&&this.superHandleMouseDown(t)}this._pointerMap={},this._pointerIdArray=[]},_getDistance:function(){return We.getDistance({x:this._pointerMap[this._pointerIdArray[0]].pageX,y:this._pointerMap[this._pointerIdArray[0]].pageY},{x:this._pointerMap[this._pointerIdArray[1]].pageX,y:this._pointerMap[this._pointerIdArray[1]].pageY})}}),De.controls.SplitPane=function(t,e,i,n){De.controls.SplitPane.superClass.constructor.apply(this,arguments),this._view=Xe.createView("hidden",!0),this._view.tabIndex=-1,this._dividerDiv=Xe.createDiv(),this._dividerDiv.tabIndex=-1,this._view.appendChild(this._dividerDiv),t&&this.setFirstView(t),e&&this.setNextView(e),i&&this.setOrientation(i),null!=n&&this.setPosition(n),this.setDividerDraggable(!0),this.setExpandable(!1),this.invalidate(),Ue.isTouchable&&new De.controls.SplitPaneTouchInteraction(this),new De.controls.SplitPaneInteraction(this)},Me.ext("twaver.controls.SplitPane",De.controls.ControlBase,{__accessor:["orientation","dividerWidth","dividerBackground","dividerOpacity","maskBackground","upExpandIcon","downExpandIcon","leftExpandIcon","rightExpandIcon"],__bool:["dividerDraggable","expandable"],_position:kn.SPLITPANE_POSITION,_orientation:kn.SPLITPANE_ORIENTATION,_dividerWidth:kn.SPLITPANE_DIVIDER_WIDTH,_dividerBackground:kn.SPLITPANE_DIVIDER_BACKGROUND,_dividerOpacity:kn.SPLITPANE_DIVIDER_OPACITY,_maskBackground:kn.SPLITPANE_MASK_BACKGROUND,_upExpandIcon:kn.SPLITPANE_UP_EXPAND_ICON,_downExpandIcon:kn.SPLITPANE_DOWN_EXPAND_ICON,_leftExpandIcon:kn.SPLITPANE_LEFT_EXPAND_ICON,_rightExpandIcon:kn.SPLITPANE_RIGHT_EXPAND_ICON,onPropertyChanged:function(t){this.invalidate()},getDividerDiv:function(){return this._dividerDiv},getPosition:function(){return this._position},setPosition:function(t){if(0>t&&(t=0),t>1&&(t=1),t!==this._position){var e=this._position;this._position=t,this.firePropertyChange("position",e,t),null==this.lastDividerLocation&&(this.lastDividerLocation=t)}},setFirstView:function(t){if(this._firstView!==t){var e=this._firstView;e&&this._view.removeChild(e.getView?e.getView():e),this._firstView=t,t&&(t.getView?this._view.insertBefore(t.getView(),this._dividerDiv):this._view.insertBefore(t,this._dividerDiv)),this.firePropertyChange("firstView",e,t)}},getFirstView:function(){return this._firstView},setNextView:function(t){if(this._nextView!==t){var e=this._nextView;e&&this._view.removeChild(e.getView?e.getView():e),this._nextView=t,t&&(t.getView?this._view.insertBefore(t.getView(),this._dividerDiv):this._view.insertBefore(t,this._dividerDiv)),this.firePropertyChange("nextView",e,t)}},getNextView:function(){return this._nextView},validateImpl:function(){var t,e=this._position,i=this._view.offsetWidth,n=this._view.offsetHeight,o=this._dividerWidth;if(o>=8||0===o?this._coverDiv&&(this._dividerDiv.removeChild(this._coverDiv),delete this._coverDiv):this._coverDiv||(this._coverDiv=Xe.createDiv(),this._coverDiv.tabIndex=-1,this._dividerDiv.appendChild(this._coverDiv)),"horizontal"===this._orientation){o>i&&(o=i);var r=(i-o)*e,a=i-o-r+1;Me.setViewBounds(this._firstView,{x:0,y:0,width:r,height:n}),Me.setViewBounds(this._nextView,{x:r+o,y:0,width:a,height:n}),Me.setViewBounds(this._dividerDiv,{x:r,y:0,width:o,height:n}),this._dividerDiv.position=r,this._coverDiv&&Me.setViewBounds(this._coverDiv,{x:o/2-4,y:0,width:8,height:n}),this._expandable&&(this._expandCvs1||(t=Me.html.createDiv(),t.tabIndex=-1,Me.setViewBounds(t,{x:0,y:0,width:o,height:11}),this._expandCvs1=Me.html.createImg(Me.getImageSrc(this._leftExpandIcon)),this._expandCvs1.style.left=o/2-3+"px",t.appendChild(this._expandCvs1),this._dividerDiv.appendChild(t)),this._expandCvs2||(t=Me.html.createDiv(),t.tabIndex=-1,Me.setViewBounds(t,{x:0,y:15,width:o,height:11}),this._expandCvs2=Me.html.createImg(Me.getImageSrc(this._rightExpandIcon)),this._expandCvs2.style.left=o/2-3+"px",t.appendChild(this._expandCvs2),this._dividerDiv.appendChild(t)))}else{o>n&&(o=n);var s=(n-o)*e,l=n-o-s;Me.setViewBounds(this._firstView,{x:0,y:0,width:i,height:s}),Me.setViewBounds(this._nextView,{x:0,y:s+o,width:i,height:l}),Me.setViewBounds(this._dividerDiv,{x:0,y:s,width:i,height:o}),this._dividerDiv.position=s,this._coverDiv&&Me.setViewBounds(this._coverDiv,{x:0,y:o/2-4,width:i,height:8}),this._expandable&&(this._expandCvs1||(t=Me.html.createDiv(),t.tabIndex=-1,Me.setViewBounds(t,{x:0,y:0,width:11,height:o}),this._expandCvs1=Me.html.createImg(Me.getImageSrc(this._upExpandIcon)),this._expandCvs1.style.top=o/2-3+"px",t.appendChild(this._expandCvs1),this._dividerDiv.appendChild(t)),this._expandCvs2||(t=Me.html.createDiv(),t.tabIndex=-1,Me.setViewBounds(t,{x:15,y:0,width:11,height:o}),this._expandCvs2=Me.html.createImg(Me.getImageSrc(this._downExpandIcon)),this._expandCvs2.style.top=o/2-3+"px",t.appendChild(this._expandCvs2),this._dividerDiv.appendChild(t)))}this._dividerDiv.style.background=this._dividerBackground}}),De.controls.SplitPaneInteraction=function(t){this.splitPane=t,this.view=t._view,this.dividerDiv=t._dividerDiv;var e=this;this.view.addEventListener("mousedown",function(t){0===t.button&&e.handleMouseDown(t)},!1),this.view.addEventListener("mousemove",function(t){e.handleMouseMove(t)},!1)},Me.ext("twaver.controls.SplitPaneInteraction",Object,{handleMouseDown:function(t){if(this.splitPane.isExpandable()){var e,i,n=this.splitPane._dividerWidth;if(t.target===this.splitPane._expandCvs1)return void("horizontal"===this.splitPane._orientation?(e=this.view.clientWidth,n>e&&(n=e),this.splitPane.lastDividerLocation===this.splitPane.getPosition()?this.splitPane.setPosition(0):this.splitPane.lastDividerLocation<this.splitPane.getPosition()&&(this.splitPane.setPosition(this.splitPane.lastDividerLocation),this.splitPane.lastDividerLocation=this.splitPane.getPosition())):(i=this.view.clientHeight,n>i&&(n=i),this.splitPane.lastDividerLocation===this.splitPane.getPosition()?this.splitPane.setPosition(0):this.splitPane.lastDividerLocation<this.splitPane.getPosition()&&(this.splitPane.setPosition(this.splitPane.lastDividerLocation),this.splitPane.lastDividerLocation=this.splitPane.getPosition())));if(t.target===this.splitPane._expandCvs2)return void("horizontal"===this.splitPane._orientation?(e=this.view.clientWidth,n>e&&(n=e),this.splitPane.lastDividerLocation===this.splitPane.getPosition()?this.splitPane.setPosition(1):this.splitPane.lastDividerLocation>this.splitPane.getPosition()&&(this.splitPane.setPosition(this.splitPane.lastDividerLocation),this.splitPane.lastDividerLocation=this.splitPane.getPosition())):(i=this.view.clientHeight,n>i&&(n=i),this.splitPane.lastDividerLocation===this.splitPane.getPosition()?this.splitPane.setPosition(1):this.splitPane.lastDividerLocation>this.splitPane.getPosition()&&(this.splitPane.setPosition(this.splitPane.lastDividerLocation),this.splitPane.lastDividerLocation=this.splitPane.getPosition())))}if(this.splitPane.isDividerDraggable())if(this.resizeDiv)this.clear(t);else if(t.target===this.dividerDiv||t.target===this.splitPane._coverDiv){this.resizeDiv=Xe.createDiv();var o=this.resizeDiv.style;o.left=this.dividerDiv.style.left,o.top=this.dividerDiv.style.top,o.width=this.dividerDiv.style.width,o.height=this.dividerDiv.style.height,o.opacity=this.splitPane.getDividerOpacity(),o.background=this.splitPane.getDividerBackground(),this.resizeDiv.lastPosition="horizontal"===this.splitPane._orientation?t.clientX:t.clientY,this.resizeDiv.maskDiv=Xe.createDiv(),o=this.resizeDiv.maskDiv.style,o.left="0px",o.top="0px",o.width=this.view.clientWidth+"px",o.height=this.view.clientHeight+"px",o.background=this.splitPane.getMaskBackground(),this.view.appendChild(this.resizeDiv.maskDiv),this.view.appendChild(this.resizeDiv),Xe.handle_mousedown(this,t),t.preventDefault()}},handleMouseMove:function(t){if((!this.splitPane.isExpandable()||t.target!==this.splitPane._expandCvs1&&t.target!==this.splitPane._expandCvs2)&&this.splitPane.isDividerDraggable())if(this.resizeDiv||Xe.target)this.resizeDiv&&Xe.target===this&&("horizontal"===this.splitPane._orientation?this.resizeDiv.style.left=this.dividerDiv.position+t.clientX-this.resizeDiv.lastPosition+"px":this.resizeDiv.style.top=this.dividerDiv.position+t.clientY-this.resizeDiv.lastPosition+"px");else{var e="horizontal"===this.splitPane._orientation?"ew-resize":"ns-resize";this.view.style.cursor=t.target===this.dividerDiv||t.target===this.splitPane._coverDiv?e:"default"}},handleMouseUp:function(t){(!this.splitPane.isExpandable()||t.target!==this.splitPane._expandCvs1&&t.target!==this.splitPane._expandCvs2)&&this.splitPane.isDividerDraggable()&&0===t.button&&this.clear(t)},clear:function(t){if(this.resizeDiv){var e,i=this.splitPane._dividerWidth;if("horizontal"===this.splitPane._orientation){var n=this.view.clientWidth;i>n&&(i=n),e=this.dividerDiv.position+t.clientX-this.resizeDiv.lastPosition,this.splitPane.setPosition(e/(n-i))}else{var o=this.view.clientHeight;i>o&&(i=o),e=this.dividerDiv.position+t.clientY-this.resizeDiv.lastPosition,this.splitPane.setPosition(e/(o-i))}this.splitPane.lastDividerLocation=this.splitPane.getPosition(),this.view.removeChild(this.resizeDiv.maskDiv),this.view.removeChild(this.resizeDiv),delete this.resizeDiv}}}),De.controls.SplitPaneTouchInteraction=function(t){this.splitPane=t,this.view=t._view,this.dividerDiv=t._dividerDiv,Xe.addEventListener("touchstart","handleTouchstart",this.view,this)},Me.ext("twaver.controls.SplitPaneTouchInteraction",Object,{handleTouchstart:function(t){if(Xe.preventDefault(t),this.splitPane.isExpandable()){var e,i,n=this.splitPane._dividerWidth;if(t.target===this.splitPane._expandCvs1)return void("horizontal"===this.splitPane._orientation?(e=this.view.clientWidth,n>e&&(n=e),this.splitPane.lastDividerLocation===this.splitPane.getPosition()?this.splitPane.setPosition(0):this.splitPane.lastDividerLocation<this.splitPane.getPosition()&&(this.splitPane.setPosition(this.splitPane.lastDividerLocation),this.splitPane.lastDividerLocation=this.splitPane.getPosition())):(i=this.view.clientHeight,n>i&&(n=i),this.splitPane.lastDividerLocation===this.splitPane.getPosition()?this.splitPane.setPosition(0):this.splitPane.lastDividerLocation<this.splitPane.getPosition()&&(this.splitPane.setPosition(this.splitPane.lastDividerLocation),this.splitPane.lastDividerLocation=this.splitPane.getPosition())));if(t.target===this.splitPane._expandCvs2)return void("horizontal"===this.splitPane._orientation?(e=this.view.clientWidth,n>e&&(n=e),this.splitPane.lastDividerLocation===this.splitPane.getPosition()?this.splitPane.setPosition(1):this.splitPane.lastDividerLocation>this.splitPane.getPosition()&&(this.splitPane.setPosition(this.splitPane.lastDividerLocation),this.splitPane.lastDividerLocation=this.splitPane.getPosition())):(i=this.view.clientHeight,n>i&&(n=i),this.splitPane.lastDividerLocation===this.splitPane.getPosition()?this.splitPane.setPosition(1):this.splitPane.lastDividerLocation>this.splitPane.getPosition()&&(this.splitPane.setPosition(this.splitPane.lastDividerLocation),this.splitPane.lastDividerLocation=this.splitPane.getPosition())))}if(this.resizeDiv)this.clear(t);else if(t.target===this.dividerDiv||t.target===this.splitPane._coverDiv){this.resizeDiv=Xe.createDiv();var o=this.resizeDiv.style;o.left=this.dividerDiv.style.left,o.top=this.dividerDiv.style.top,o.width=this.dividerDiv.style.width,o.height=this.dividerDiv.style.height,o.opacity=this.splitPane.getDividerOpacity(),o.background=this.splitPane.getDividerBackground();var r=t.changedTouches[0];this.resizeDiv.lastPosition="horizontal"===this.splitPane._orientation?r.clientX:r.clientY,this.resizeDiv.maskDiv=Xe.createDiv();var o=this.resizeDiv.maskDiv.style;o.left="0px",o.top="0px",o.width=this.view.clientWidth+"px",o.height=this.view.clientHeight+"px",o.background=this.splitPane.getMaskBackground(),this.view.appendChild(this.resizeDiv.maskDiv),this.view.appendChild(this.resizeDiv)}Xe.addEventListener("touchmove","handleTouchmove",this.view,this),Xe.addEventListener("touchend","handleTouchend",this.view,this)},handleTouchmove:function(t){if(Xe.preventDefault(t),(!this.splitPane.isExpandable()||t.target!==this.splitPane._expandCvs1&&t.target!==this.splitPane._expandCvs2)&&this.resizeDiv){var e=t.changedTouches[0];"horizontal"===this.splitPane._orientation?this.resizeDiv.style.left=this.dividerDiv.position+e.clientX-this.resizeDiv.lastPosition+"px":this.resizeDiv.style.top=this.dividerDiv.position+e.clientY-this.resizeDiv.lastPosition+"px"}},handleTouchend:function(t){(!this.splitPane.isExpandable()||t.target!==this.splitPane._expandCvs1&&t.target!==this.splitPane._expandCvs2)&&(Xe.removeEventListener("touchmove",this.view,this),Xe.removeEventListener("touchend",this.view,this),this.clear(t))},clear:function(t){var e=t.changedTouches[0];if(this.resizeDiv){var i=this.splitPane._dividerWidth;if("horizontal"===this.splitPane._orientation){var n=this.view.clientWidth;i>n&&(i=n);var o=this.dividerDiv.position+e.clientX-this.resizeDiv.lastPosition;this.splitPane.setPosition(o/(n-i))}else{var r=this.view.clientHeight;i>r&&(i=r);var o=this.dividerDiv.position+e.clientY-this.resizeDiv.lastPosition;this.splitPane.setPosition(o/(r-i))}this.splitPane.lastDividerLocation=this.splitPane.getPosition(),this.view.removeChild(this.resizeDiv.maskDiv),this.view.removeChild(this.resizeDiv),delete this.resizeDiv}}}),De.controls.TabPane=function(){De.controls.TabPane.superClass.constructor.apply(this,arguments),this._tabBox=new De.TabBox,this._tabBox.addDataBoxChangeListener(this.handleTabChange,this),this._tabBox.addDataPropertyChangeListener(this.handleTabChange,this),this._tabBox.addHierarchyChangeListener(this.handleTabChange,this),this._tabBox.getSelectionModel().addSelectionChangeListener(this.handleTabChange,this),this._view=Xe.createView("hidden",!0),this._tabDiv=Xe.createDiv(),this._tabDiv.onmousedown=Xe.preventDefault,this._tabDiv.onkeydown=Xe.preventDefault,this._contentDiv=Xe.createDiv(),this._view.appendChild(this._tabDiv),this._view.appendChild(this._contentDiv),this._divPool=new De.Pool("div"),this._iconPool=new De.Pool("img"),this._closePool=new De.Pool("img"),this._textPool=new De.Pool("span"),this._resizePool=new De.Pool("div"),this._pools.add(this._divPool),this._pools.add(this._iconPool),this._pools.add(this._closePool),this._pools.add(this._textPool),this._pools.add(this._resizePool),this.invalidateTab(),Ue.isTouchable&&new De.controls.TabPaneTouchInteraction(this),new De.controls.TabPaneInteraction(this)},Me.ext("twaver.controls.TabPane",De.controls.ControlBase,{__accessor:["tabGap","tabRadius","tabHeight","horizontalAlign","tabOrientation","resizeTolerance","tabBackground","selectBackground","moveBackground","insertBackground","closeIcon","disabledColor"],__bool:["selectNextOnClose","selectNextOnInVisible"],_tabGap:kn.TABPANE_TAB_GAP,_tabRadius:kn.TABPANE_TAB_RADIUS,_tabHeight:kn.TABPANE_TAB_HEIGHT,_resizeTolerance:kn.TABPANE_RESIZE_TOLERANCE,_tabOrientation:kn.TABPANE_TAB_ORIENTATION,_tabBackground:kn.TABPANE_TAB_BACKGROUND,_disabledColor:kn.TABPANE_DISABLED_COLOR,_selectBackground:kn.TABPANE_SELECT_BACKGROUND,_moveBackground:kn.TABPANE_MOVE_BACKGROUND,_insertBackground:kn.TABPANE_INSERT_BACKGROUND,_horizontalAlign:kn.TABPANE_HORIZONTAL_ALIGN,_closeIcon:kn.TABPANE_CLOSE_ICON,_selectNextOnClose:kn.TABPANE_SELECT_NEXT_ON_CLOSE,_selectNextOnInVisible:kn.TABPANE_SELECT_NEXT_ON_INVISIBLE,onPropertyChanged:function(t){this.invalidateTab()},getTabBox:function(){return this._tabBox},getTabDiv:function(){return this._tabDiv},getContentDiv:function(){return this._contentDiv},handleTabChange:function(t){if(this._selectNextOnInVisible&&"visible"===t.property&&!t.newValue&&this._tabBox.getSelectionModel().contains(t.source)){for(var e,i,n=t.source,o=this._tabBox.getRoots().indexOf(n),r=this._tabBox.getRoots(),a=r.size(),s=o;a-1>s;)if(e=r.get(++s),e.isVisible()&&!e.isDisabled()){i=e;break}if(!i)for(s=o;s>0;)if(e=r.get(--s),e.isVisible()&&!e.isDisabled()){i=e;break}this._tabBox.getSelectionModel().setSelection(i)}this.invalidateTab()},invalidateTab:function(t){this._invalidateTab||(this._invalidateTab=!0,this.invalidate(t))},validateImpl:function(){this._invalidateTab&&(this._invalidateTab=!1,this.validateTab());var t,e=this._view.offsetWidth,i=this._view.offsetHeight;"top"===this._tabOrientation?(this._tabDiv.style.top="0px",t={x:0,y:this._tabHeight,width:e,height:Math.max(0,i-this._tabHeight)}):(this._tabDiv.style.top=i-this._tabHeight+"px",t={x:0,y:0,width:e,height:Math.max(0,i-this._tabHeight)}),this._currentView&&Me.setViewBounds(this._currentView,t)},getCurrentTab:function(){return this._currentTab},getCurrentView:function(){return this._currentView},onViewRemoved:function(t){},onViewAdded:function(t){},validateTab:function(){this._currentTab=this._tabBox.getSelectionModel().getLastData();var t=this._currentTab?this._currentTab.getView():null;if(t!==this._currentView){var e,i;this._currentView&&(e=this._currentView.getView?this._currentView.getView():this._currentView,e.style.visibility="hidden",this.onViewRemoved(this._currentView)),t&&(i=t.getView?t.getView():t,i.style.visibility="inherit",i.parentNode||this._contentDiv.appendChild(i),this.onViewAdded(t)),this._currentView=t}Xe.release(this._tabDiv);for(var n=this._tabBox.getRoots(),o=this._tabHeight+"px",r=this._tabHeight-2+"px",a=this._tabRadius+"px",s=n.size(),l=0,h=0;s>h;h++){var c=n.get(h);if(c.isVisible()){var u=this._currentTab===c,d=c.getWidth();0>d&&(d=0);var f=Math.min(this._tabGap,d),p=this._divPool.get();p._tab=c;var g=p.style;g.position="absolute",g.whiteSpace="nowrap",g.lineHeight=r,g.overflow="hidden",g.textOverflow="ellipsis",g.background=u?this._selectBackground:this._tabBackground,g.textAlign=this._horizontalAlign,"top"===this._tabOrientation?(g.borderTopLeftRadius=a,g.borderTopRightRadius=a,g.borderBottomLeftRadius="0px",g.borderBottomRightRadius="0px"):(g.borderTopLeftRadius="0px",g.borderTopRightRadius="0px",g.borderBottomLeftRadius=a,g.borderBottomRightRadius=a),g.left=l+"px",g.width=d-f+"px",g.height=o,p._x=l,p._width=d-f,this.renderTab(p,c),this.onTabRendered(p,c),this._tabDiv.insertBefore(p,this._tabDiv.firstChild),l+=d,c.isResizable()&&(p=this._resizePool.get(),p._resizeTab=c,g=p.style,g.position="absolute",g.backgroundColor="white",g.opacity=0,g.left=l-f-this._resizeTolerance+"px",g.width=f+2*this._resizeTolerance+"px",g.height=o,this._tabDiv.appendChild(p))}}this._tabDiv.style.left="0px",this._tabDiv.style.width=l+"px",this._tabDiv.style.height=this._tabHeight+"px",this._pools.forEach(function(t){t.clear()})},renderTab:function(t,e){if(e.renderTab)e.renderTab(t);else{var i=e.getIcon();if(i){var n=this._iconPool.get();n.setAttribute("src",Me.getImageSrc(i)),n.style.paddingLeft="4px",n.style.verticalAlign="middle",t.appendChild(n)}var o=e.getName();if(o){var r=this._textPool.get();r.style.whiteSpace="nowrap",r.style.verticalAlign="middle",r.style.padding="2px 4px",r.innerHTML=o,t.appendChild(r)}if(Ue.isOpera){var a=t.cloneNode(!1);a.style.left="0px",a.style.top="0px",a.style.opacity=0,t.appendChild(a)}}if(e.isClosable()){var s=this._tabRadius/4+2,n=this._closePool.get();n._closeTab=e,n.setAttribute("src",Me.getImageSrc(this._closeIcon)),n.style.position="absolute",n.style.top=s+"px",n.style.right=s+"px",t.appendChild(n)}t.style.color=e.isDisabled()?this.getDisabledColor():""},onTabRendered:function(t,e){}}),De.controls.TabPaneInteraction=function(t){this.tabPane=t,this.view=t.getTabDiv();var e=this;this.view.addEventListener("mousedown",function(t){e.handleMouseDown(t)},!1),this.view.addEventListener("mousemove",function(t){e.handleMouseMove(t)},!1)},Me.ext("twaver.controls.TabPaneInteraction",Object,{handleMouseDown:function(t){if(0===t.button){if(this.movableDiv)return void this.handleMouseUp(t);this.resizeTab=t.target._resizeTab,this.resizeTab||(this.movableDiv=this.getMovableDivAt(t)),this.changeCursor(t),this.lastX=this.getX(t),this._startClient=Xe.getClientPoint(t),this._startLogicalX=this.lastX,Xe.handle_mousedown(this,t)}},changeCursor:function(t){var e="";if(t.target._resizeTab)e="ew-resize";else{var i=this.getTabAt(t);!i||i.isDisabled()&&!i.isMovable()||(e="pointer")}this.view.style.cursor=e},handleMouseMove:function(t){if(null==this.lastX)return void this.changeCursor(t);if(Xe.target===this){var e=this._startLogicalX+t.clientX-this._startClient.x;if(this.resizeTab){if(null!=this.stopX){if(e<this.stopX)return;delete this.stopX}var i=this.resizeTab.getWidth()+(e-this.lastX);10>i&&(i=10,this.stopX=e),this.resizeTab.setWidth(i),this.lastX=e}else if(this.movableDiv){var n=e-this.lastX;if(!this.cloneDiv){if(Math.abs(n)<3)return;this.cloneDiv=this.movableDiv.cloneNode(!0),this.cloneDiv._x=this.movableDiv._x,this.cloneDiv.style.background=this.tabPane.getMoveBackground(),this.insertDiv=Xe.createDiv(),this.insertDiv.style.width="1px",this.insertDiv.style.height=this.cloneDiv.style.height,this.insertDiv.style.background=this.tabPane.getInsertBackground(),this.movableDiv.parentNode.appendChild(this.cloneDiv),this.movableDiv.parentNode.appendChild(this.insertDiv)}var o=this.cloneDiv._x+n;this.cloneDiv.style.left=o+"px",this.cloneDiv._x=o,this.lastX=e,this.tabInfo=this.getTabInfoAt(t),this.tabInfo&&(this.insertDiv.style.left=this.tabInfo.position)}}},handleMouseUp:function(t){if(0===t.button){if(this.resizeTab);else if(this.movableDiv&&this.tabInfo){var e=this.movableDiv._tab,i=this.tabInfo.index;this.tabPane.getTabBox().moveTo(e,i)}else{var n=this.tabPane.getTabBox(),e=t.target._closeTab;if(e)if(this.tabPane.isSelectNextOnClose()&&this.tabPane.getCurrentTab()===e){var o=n.getRoots(),i=o.indexOf(e);n.remove(e),o.size()>0&&(i>=o.size()&&(i=o.size()-1),n.getSelectionModel().setSelection(o.get(i)))}else n.remove(e);else{var e=this.getTabAt(t);e&&!e.isDisabled()&&n.getSelectionModel().setSelection(e)}}this.clear()}},clear:function(){this.view.style.cursor="",this.cloneDiv&&this.movableDiv&&this.movableDiv.parentNode.removeChild(this.cloneDiv),this.insertDiv&&this.movableDiv&&this.movableDiv.parentNode.removeChild(this.insertDiv),delete this.movableDiv,delete this.tabInfo,delete this.insertDiv,delete this.cloneDiv,delete this.resizeTab,delete this.stopX,delete this.lastX,delete this._startLogicalX,delete this._startClient},getTabAt:function(t){t=t.target;for(var e;t&&t!==this.view&&!(e=t._tab);)t=t.parentNode;return e},getMovableDivAt:function(t){t=t.target;for(var e;t&&t!==this.view&&!(e=t._tab);)t=t.parentNode;return e&&e.isMovable()?t:null},getX:function(t){var e=Xe.getLogicalPoint(this.view,t);return e?e.x:null},getTabInfoAt:function(t){for(var e=this._startLogicalX+t.clientX-this._startClient.x,i=this.tabPane.getTabBox().getRoots(),n=i.size(),o=0,r=!1,a=0;n>a;a++){var s=i.get(a);if(s===this.movableDiv._tab&&(r=!0),s.isVisible()){var l=s.getWidth();if(0>=l)continue;if(e>=o&&o+l>=e){var h=o+l/2>e;!r||s===this.movableDiv._tab&&h||a--;var c=h?Math.max(0,a):Math.min(a+1,n),u=h?o:o+l;return u=Math.max(0,u-1),{index:c,tab:s,position:u+"px"}}o+=l}}return this.tabInfo}}),De.controls.TabPaneTouchInteraction=function(t){this.tabPane=t,this.view=t.getTabDiv(),Xe.addEventListener("touchstart","handleTouchstart",this.view,this)},Me.ext("twaver.controls.TabPaneTouchInteraction",Object,{handleTouchstart:function(t){return Xe.preventDefault(t),this.movableDiv?void this.handleTouchend(t):(this.resizeTab=t.target._resizeTab,this.resizeTab||(this.movableDiv=this.getMovableDivAt(t)),this.lastX=this.getX(t),Xe.addEventListener("touchmove","handleTouchmove",this.view,this),void Xe.addEventListener("touchend","handleTouchend",this.view,this))},handleTouchmove:function(t){if(null!=this.lastX)if(this.resizeTab){var e=this.getX(t);if(null!=this.stopX){if(e<this.stopX)return;delete this.stopX}var i=this.resizeTab.getWidth()+(e-this.lastX);0>i&&(i=0,this.stopX=e),this.resizeTab.setWidth(i),this.lastX=e}else if(this.movableDiv){var e=this.getX(t),n=e-this.lastX;if(!this.cloneDiv){if(Math.abs(n)<3)return;this.cloneDiv=this.movableDiv.cloneNode(!0),this.cloneDiv._x=this.movableDiv._x,this.cloneDiv.style.background=this.tabPane.getMoveBackground(),this.insertDiv=Xe.createDiv(),this.insertDiv.style.width="1px",this.insertDiv.style.height=this.cloneDiv.style.height,this.insertDiv.style.background=this.tabPane.getInsertBackground(),this.movableDiv.parentNode.appendChild(this.cloneDiv),this.movableDiv.parentNode.appendChild(this.insertDiv)}var o=this.cloneDiv._x+n;this.cloneDiv.style.left=o+"px",this.cloneDiv._x=o,this.lastX=e,this.tabInfo=this.getTabInfoAt(t),this.tabInfo&&(this.insertDiv.style.left=this.tabInfo.position)}},handleTouchend:function(t){if(this.resizeTab);else if(this.movableDiv&&this.tabInfo){var e=this.movableDiv._tab,i=this.tabInfo.index;this.tabPane.getTabBox().moveTo(e,i)}else{var n=this.tabPane.getTabBox(),e=t.target._closeTab;if(e)if(this.tabPane.isSelectNextOnClose()&&this.tabPane.getCurrentTab()===e){var o=n.getRoots(),i=o.indexOf(e);n.remove(e),o.size()>0&&(i>=o.size()&&(i=o.size()-1),n.getSelectionModel().setSelection(o.get(i)))}else n.remove(e);else{var e=this.getTabAt(t);e&&!e.isDisabled()&&n.getSelectionModel().setSelection(e)}}this.clear(),Xe.removeEventListener("touchmove",this.view,this),Xe.removeEventListener("touchend",this.view,this)},clear:function(){this.cloneDiv&&this.movableDiv&&this.movableDiv.parentNode.removeChild(this.cloneDiv),this.insertDiv&&this.movableDiv&&this.movableDiv.parentNode.removeChild(this.insertDiv),delete this.movableDiv,delete this.tabInfo,delete this.insertDiv,delete this.cloneDiv,delete this.resizeTab,delete this.stopX,delete this.lastX},getTabAt:function(t){t=t.target;for(var e;t&&t!==this.view&&!(e=t._tab);)t=t.parentNode;return e},getMovableDivAt:function(t){t=t.target;for(var e;t&&t!==this.view&&!(e=t._tab);)t=t.parentNode;return e&&e.isMovable()?t:null},getX:function(t){var e=Xe.getLogicalPoint(this.view,t);return e?e.x:null},getTabInfoAt:function(t){for(var e=this.getX(t),i=this.tabPane.getTabBox().getRoots(),n=i.size(),o=0,r=!1,a=0;n>a;a++){var s=i.get(a);if(s===this.movableDiv._tab&&(r=!0),s.isVisible()){var l=s.getWidth();if(0>=l)continue;if(e>=o&&o+l>=e){var h=o+l/2>e;!r||s===this.movableDiv._tab&&h||a--;var c=h?Math.max(0,a):Math.min(a+1,n),u=h?o:o+l;return u=Math.max(0,u-1),{index:c,tab:s,position:u+"px"}}o+=l}}return this.tabInfo}}),De.controls.TitlePane=function(t,e,i){De.controls.TitlePane.superClass.constructor.apply(this,arguments),this.invalidate(),this._titleDiv=Xe.createDiv(),this._titleDiv.tabIndex=-1,this._titleDiv.style.verticalAlign="middle",this._titleDiv.style.fontWeight="bold",this._titleDiv.style.textOverflow="ellipsis",this._titleDiv.style.overflow="hidden",this._titleDiv.style.whiteSpace="nowrap",this._titleDiv.onmousedown=Xe.preventDefault,this._span=ze.createElement("span"),this._span.style.verticalAlign="middle",this._span.style.paddingLeft="4px",this._span.style.paddingRight="4px",this._img=ze.createElement("img"),this._img.style.verticalAlign="middle",this._img.style.paddingLeft="4px",this._view=Xe.createView("hidden",!0),this._view.tabIndex=-1,this._view.appendChild(this._titleDiv),e&&this.setTitle(e),t&&this.setContent(t),i&&this.setIcon(i)},Me.ext("twaver.controls.TitlePane",De.controls.ControlBase,{__accessor:["icon","title","titleHeight","titleHorizontalAlign","titleBackground"],_titleHeight:kn.TITLEPANE_TITLE_HEIGHT,_titleBackground:kn.TITLEPANE_TITLE_BACKGROUND,_titleHorizontalAlign:kn.TITLEPANE_TITLE_HORIZONTAL_ALIGN,onPropertyChanged:function(t){this.invalidate()},getTitleDiv:function(){return this._titleDiv},getContent:function(){return this._content},setContent:function(t){if(this._content!==t){var e=this._content;e&&this._view.removeChild(e.getView?e.getView():e),this._content=t,t&&this._view.appendChild(t.getView?t.getView():t),this.firePropertyChange("content",e,t)}},validateImpl:function(){var t=this._view.offsetWidth,e=this._view.offsetHeight,i=this._titleDiv.style;i.textAlign=this._titleHorizontalAlign,i.lineHeight=this._titleHeight-2+"px",i.background=this._titleBackground,Xe.clear(this._titleDiv),this._icon&&(this._img.setAttribute("src",Me.getImageSrc(this._icon)),this._titleDiv.appendChild(this._img)),this._title&&(this._span.innerHTML=this._title,this._span.setAttribute("title",this._title),this._titleDiv.appendChild(this._span));var i=this._titleDiv.style;i.left="0px",i.top="0px",i.width=t+"px",i.height=this._titleHeight+"px",Me.setViewBounds(this._content,{x:0,y:this._titleHeight,width:t,height:Math.max(e-this._titleHeight,0)})}}),De.controls.Accordion=function(){De.controls.Accordion.superClass.constructor.apply(this,arguments),this._titleMap={},this._titleList=new hn,this._currentTitle=null,this._currentView=null,this._view=Xe.createView("hidden",!0),this.invalidate();var t=this;this._view.addEventListener("mousedown",function(e){t.handleMouseDown(e)},!1)},Me.ext("twaver.controls.Accordion",De.controls.ControlBase,{__accessor:["expandIcon","collapseIcon","titleHeight","titleBackground","borderBottomColor","iconPosition"],_expandIcon:kn.ACCORDION_EXPAND_ICON,_collapseIcon:kn.ACCORDION_COLLAPSE_ICON,_titleHeight:kn.ACCORDION_TITLE_HEIGHT,_titleBackground:kn.ACCORDION_TITLE_BACKGROUND,_borderBottomColor:kn.ACCORDION_BORDER_BOTTOM_COLOR,_iconPosition:kn.ACCORDION_ICON_POSITION,onPropertyChanged:function(t){this.invalidate()},handleMouseDown:function(t){if(0===t.button){var e=t.target._title;e||(e=t.target.parentNode._title),e&&(this._currentTitle===e?this.collapse():this.expand(e))}},getTitles:function(){return this._titleList},getCurrentTitle:function(){return this._currentTitle},add:function(t,e){if(this._titleMap[t])throw"Title ' + title + ' already exists";var i=Xe.createDiv();i._title=t,i.onmousedown=Xe.preventDefault,i.style.cursor="pointer",i.style.textAlign="left",i.style.textOverflow="ellipsis",i.style.whiteSpace="nowrap",i.style.overflow="hidden",i.style.borderBottomWidth="1px",i.style.borderBottomStyle="solid";var n=ze.createElement("img");n.style.verticalAlign="middle",n.style.paddingLeft="4px";var o=ze.createElement("span");if(o.style.verticalAlign="middle",o.style.paddingLeft="4px",o.innerHTML=t,o.setAttribute("title",t),this._view.appendChild(i),i.appendChild(n),i.appendChild(o),"right"==this._iconPosition){var r=n.style,a=(this._titleHeight-8)/2;r.marginTop=a+"px",r.right="15px",r.position="absolute"}this._titleMap[t]={content:e,titleDiv:i,span:o,img:n},this._titleList.add(t),this.invalidate()},remove:function(t){var e=this._titleMap[t];e&&this._view.removeChild(e.titleDiv),delete this._titleMap[t],this._titleList.remove(t),this.invalidate()},clear:function(){var t=this;Object.keys(t._titleMap).forEach(function(e){t._view.removeChild(t._titleMap[e].titleDiv)}),t._titleMap={},t._titleList.clear(),t.invalidate()},expand:function(t){this._titleMap[t]&&this._currentTitle!==t&&(this._currentTitle=t,this.onExpanded(t),this.invalidate())},onExpanded:function(t){},collapse:function(){this._currentTitle&&(this.onCollapsed(this._currentTitle),this._currentTitle=null,this.invalidate())},onCollapsed:function(t){},validateImpl:function(){var t=this._currentView;this._currentView=null;for(var e=this._view.offsetWidth,i=this._view.offsetHeight,n=this._titleList.size(),o=0,r=0;n>r;r++){var a=this._titleList.get(r),s=this._titleMap[a],l=s.titleDiv.style;l.lineHeight=this._titleHeight-3+"px",l.background=this._titleBackground,l.borderBottomColor=this._borderBottomColor,l.left="0px",l.top=o+"px",l.width=e+"px",l.height=this._titleHeight-1+"px";var h=this._currentTitle===a,c=h?this._expandIcon:this._collapseIcon;if(s.img.setAttribute("src",Me.getImageSrc(c)),h){var u=Math.max(0,i-n*this._titleHeight);s.content&&(this._currentView=s.content.getView?s.content.getView():s.content,Me.setViewBounds(s.content,{x:0,y:o+this._titleHeight,width:e,height:u}),s.content.style.overflowY="auto"),o+=this._titleHeight+u}else o+=this._titleHeight}this._currentView&&this._currentView!==t&&this._view.appendChild(this._currentView),t&&t!==this._currentView&&this._view.removeChild(t)}}),De.controls.BorderPane=function(t,e,i,n,o){De.controls.BorderPane.superClass.constructor.apply(this,arguments),this.invalidate(),this._view=Xe.createView("hidden",!0),this._view.tabIndex=-1,t&&this.setCenter(t),e&&this.setTop(e),i&&this.setRight(i),n&&this.setBottom(n),o&&this.setLeft(o)},Me.ext("twaver.controls.BorderPane",De.controls.ControlBase,{__accessor:["hGap","vGap","topHeight","bottomHeight","leftWidth","rightWidth"],_hGap:kn.BORDERPANE_HGAP,_vGap:kn.BORDERPANE_VGAP,_topHeight:0,_bottomHeight:0,_leftWidth:0,_rightWidth:0,onPropertyChanged:function(t){this.invalidate()},getCenter:function(){return this._center},setCenter:function(t){this._setContent("center",t)},getTop:function(){return this._top},setTop:function(t){this._setContent("top",t)},getRight:function(){return this._right},setRight:function(t){this._setContent("right",t)},getBottom:function(){return this._bottom},setBottom:function(t){this._setContent("bottom",t)},getLeft:function(){return this._left},setLeft:function(t){this._setContent("left",t)},_setContent:function(t,e){var i=this["_"+t];if(i!==e){if(i){var n=i.getView?i.getView():i;this._view.contains(n)&&this._view.removeChild(n)}this["_"+t]=e,e&&this._view.appendChild(e.getView?e.getView():e),this.firePropertyChange(t,i,e)}},validateImpl:function(){var t=this._view.offsetWidth,e=this._view.offsetHeight,i=0,n=0,o=t,r=e,a=0,s=0,l=0,h=0;this._top&&(a=this._topHeight||(this._top.getView?this._top.getView().offsetHeight:this._top.offsetHeight),n=a+this._vGap),this._bottom&&(s=this._bottomHeight||(this._bottom.getView?this._bottom.getView().offsetHeight:this._bottom.offsetHeight),r=e-s-this._vGap),this._left&&(l=this._leftWidth||(this._left.getView?this._left.getView().offsetWidth:this._left.offsetWidth),i=l+this._hGap),this._right&&(h=this._rightWidth||(this._right.getView?this._right.getView().offsetWidth:this._right.offsetWidth),o=t-h-this._hGap);var c=Math.max(0,o-i),u=Math.max(0,r-n);this._top&&Me.setViewBounds(this._top,{x:0,y:0,width:t,height:a}),this._bottom&&Me.setViewBounds(this._bottom,{x:0,y:r,width:t,height:s}),this._left&&Me.setViewBounds(this._left,{x:0,y:n,width:l,height:u}),this._right&&Me.setViewBounds(this._right,{x:o,y:n,width:h,height:u}),this._center&&Me.setViewBounds(this._center,{x:i,y:n,width:c,height:u})}}),De.controls.PopupMenu=function(t){this._view=Xe.createDiv(),this._view.style.zIndex=100001,this._items=[],this._itemsMap={},this.setContextView(t);var e=this._view,i=this;e.addEventListener("mouseover",function(t){i._mouseOver=!0},!1),e.addEventListener("mouseout",function(t){i._mouseOver=!1},!1),e.oncontextmenu=function(t){t.preventDefault()},Xe.addEventListener("mousedown","_handleClick",e,this)},Me.ext("twaver.controls.PopupMenu",Object,{_width:200,_xOffset:0,_yOffset:0,_menuItemHeight:25,_background:"#F9F9F9",_border:"2px outset white",_disabledColor:"#BABBBC",_focusColor:"white",_focusBackground:"#C2CFF1",_color:"black",_subMenuEnableIcon:kn.POPUPMENU_SUBNENU_ENABLE_ICON,_subMenuDisableIcon:kn.POPUPMENU_SUBNENU_DISABLE_ICON,_checkboxSelectedIcon:kn.POPUPMENU_CHECKBOX_SELECTED_ICON,_checkboxUnselectedIcon:kn.POPUPMENU_CHECKBOX_UNSELECTED_ICON,_radiobuttonSelectedIcon:kn.POPUPMENU_RADIOBUTTON_SELECTED_ICON,_radiobuttonUnselectedIcon:kn.POPUPMENU_RADIOBUTTON_UNSELECTED_ICON,getView:function(){return this._view},getContextView:function(){return this._contextView},setContextView:function(t){if(this._removeContextmenuListener(),this._contextView=t,t){var e=t.getView?t.getView():t;Ue.isTouchable?(e.addEventListener("touchstart",this._getTouchStartListener(),!1),e.addEventListener("touchmove",this._getTouchMoveListener(),!1),e.addEventListener("touchend",this._getTouchEndListener(),!1)):Xe.addEventListener("contextmenu","_handleContextmenu",e,this)}},getMenuItems:function(){return this._items},setMenuItems:function(t){if(this._items=[],this._itemsMap={},t)for(var e=0,i=t.length;i>e;e++)this.addMenuItem(t[e])},addMenuItem:function(t){!0!==t.separator&&(this._itemsMap[t.id||t.label]=t),this._items.push(t)},getMenuItem:function(t){return this._itemsMap[t]},addSeparator:function(){this.addMenuItem({separator:!0})},getMenuItemById:function(t){return this._itemsMap[t]},isVisible:function(t){return!1!==t.visible},isEnabled:function(t){return!1!==t.enabled},show:function(t){this.hide();var e,i,n=this._view,o=this._view.style;if(Ue.isTouchable?(e=t.changedTouches[0].clientX,i=t.changedTouches[0].clientY):(e=t.clientX,i=t.clientY),Xe.clear(n),this.renderMenu(n,this._items),0!==this._height){Xe.addEventListener(Ue.isTouchable?"touchstart":"mousedown","_handleBodyClicked",ze.body,this);var r=Xe.windowWidth()-this._width-10,a=Xe.windowHeight()-this._height-10;e=e>r?r:e,i=i>a?a:i,e=0>e?0:e,i=0>i?0:i,o.left=e+wi.scrollLeft()+this._xOffset+"px",o.top=i+wi.scrollTop()+this._yOffset+"px",ze.body.appendChild(n)}},_showMenuItem:function(t,e){this._hideMenuItem(e);var i=ze.createElement("div");e.menuItem.childrenDiv=i;var n=i.style;n.color="#000000",n.position="absolute";var o=this._width,r=e.offsetTop,a=e.menuItem.items;if(this._itemsShow=!0,e.appendChild(i),Xe.clear(i),this.renderMenu(i,a),0!==this._height){var s=Xe.windowWidth()-this._width-10,l=Xe.windowHeight()-10,h=this._getPosition(this._view);o=h.left+this._width>s?-this._width:o,r=h.top+r+a.length*this._menuItemHeight>l?r-(a.length-1)*this._menuItemHeight:r,n.left=o+"px",n.top=r+"px",e.appendChild(i)}},hide:function(){ze.body.contains(this._view)&&ze.body.removeChild(this._view),delete this._mouseOver,delete this._itemsShow,Xe.removeEventListener(Ue.isTouchable?"touchstart":"mousedown",ze.body,this)},_hideMenuItem:function(t){var e=t.menuItem.childrenDiv;e&&t.contains(e)&&t.removeChild(e),this._itemsShow=!1},dispose:function(){this._removeContextmenuListener(),this.hide()},onMenuShowing:function(t){return!0},onAction:function(t){},renderMenu:function(t,e){var i=t.style;i.background=this._background,i.border=this._border,i.width=this._width+"px",this._height=0,delete this._separator;for(var n,o=0,r=e.length;r>o;o++)if(n=e[o],this.isVisible(n))if(!0===n.separator)this._separator=!0;else{var a=ze.createElement("div");this.isEnabled(n)&&this._addMouseoverListener(a,n),a.menuItem=n,t.appendChild(a),this.renderMenuItem(a,n),this.onMenuItemRendered(a,n),this._separator=!1,this._height+=this._menuItemHeight}},renderMenuItem:function(t,e){var i=t.style;i.height=this._menuItemHeight+"px",this._separator&&(i.borderTop="1px solid gray"),this.isEnabled(e)||(i.color=this._disabledColor);var n=ze.createElement("span");i=n.style,i.position="absolute",i.width="25px",i.height=this._menuItemHeight+"px",i.lineHeight=this._menuItemHeight+"px",i.textAlign="center",t.appendChild(n);var o;if("check"===e.type?o=e.selected?this._checkboxSelectedIcon:this._checkboxUnselectedIcon:"radio"===e.type?o=e.selected?this._radiobuttonSelectedIcon:this._radiobuttonUnselectedIcon:e.icon&&(o=e.icon),o){var r=new Ve;r.src=Me.getImageSrc(o),r.style.verticalAlign="middle",n.appendChild(r)}var a=ze.createElement("label");if(Me.setText(a,e.label,!0),i=a.style,i.position="absolute",i.height=this._menuItemHeight+"px",i.lineHeight=this._menuItemHeight+"px",i.left="25px",t.appendChild(a),e.items&&t.parentNode===this._view){var s=ze.createElement("img");i=s.style,this.isEnabled(e)?s.setAttribute("src",Me.getImageSrc(this._subMenuEnableIcon)):s.setAttribute("src",Me.getImageSrc(this._subMenuDisableIcon));var l=(this._menuItemHeight-8)/2;i.marginTop=l+"px",i.right="5px",i.position="absolute",t.appendChild(s)}},onMenuItemRendered:function(t,e){},_addMouseoverListener:function(t,e){var i=this;t.addEventListener(Ue.isTouchable?"touchstart":"mouseover",function(n){t.style.background=i._focusBackground,t.style.color=i._focusColor,this===n.relatedTarget||this.contains(n.relatedTarget)||e.items&&!i._itemsShow&&t.parentNode==i._view&&i._showMenuItem(n,t)},!1),t.addEventListener(Ue.isTouchable?"touchend":"mouseout",function(n){if(t.style.background=i._background,t.style.color=i._color,this!==n.relatedTarget&&!this.contains(n.relatedTarget)&&e.items&&t.parentNode===i._view){var o=n.clientX,r=n.clientY,a=e.childrenDiv,s=i._getPosition(a);(o<s.left+2||o>s.left+a.offsetWidth-2||r<s.top+2||r>s.top+a.offsetHeight-2)&&i._hideMenuItem(t)}},!1)},_getPosition:function(t){for(var e=0,i=0;t;)i+=t.offsetLeft,e+=t.offsetTop,t=t.offsetParent;return{left:i,top:e}},_removeContextmenuListener:function(){var t=this._contextView;t&&(t=t.getView?t.getView():t,Ue.isTouchable?(t.removeEventListener("touchstart",this._getTouchStartListener(),!1),t.removeEventListener("touchmove",this._getTouchMoveListener(),!1),t.removeEventListener("touchend",this._getTouchEndListener(),!1)):Xe.removeEventListener("contextmenu",t,this))},_handleContextmenu:function(t){!0===this.onMenuShowing(t)&&this.show(t),t.preventDefault()},_handleBodyClicked:function(t){if(Ue.isTouchable){for(var e=t.target;e&&e!==this._view;)e=e.parentElement;e!==this._view&&this.hide()}else this._mouseOver||this.hide()},_handleClick:function(t){if(0===t.button){for(var e=t.target;!e.menuItem&&e.parentElement;)e=e.parentElement;var i=e?e.menuItem:null;i&&this.isEnabled(i)&&("check"===i.type&&(i.selected=!i.selected),"radio"===i.type&&(i.groupName?(i.selected=!0,this._items.forEach(function(t){i!==t&&t.groupName===i.groupName&&(t.selected=!1),t.items&&t.items.forEach(function(t){i!==t&&t.groupName===i.groupName&&(t.selected=!1)})})):i.selected=!i.selected),i.action&&i.action(i),this.onAction(i),i.items&&i.items.length>0||this.hide())}},_getTouchStartListener:function(){if(!this._touchStartListener){var t=this;this._touchStartListener=function(e){t._touchMoved=!1,t._lastTouch=new Date}}return this._touchStartListener},_getTouchMoveListener:function(){if(!this._touchMoveListener){var t=this;this._touchMoveListener=function(e){t._touchMoved=!0}}return this._touchMoveListener},_getTouchEndListener:function(){if(!this._touchEndListener){var t=this;this._touchEndListener=function(e){!t._touchMoved&&(new Date).getTime()-t._lastTouch.getTime()>1e3&&t._handleContextmenu(e)}}return this._touchEndListener},getWidth:function(){return this._width},setWidth:function(t){this._width=t},getMenuItemHeight:function(){return this._menuItemHeight},setMenuItemHeight:function(t){this._menuItemHeight=t},getBackground:function(){return this._background},setBackground:function(t){this._background=t},getBorder:function(){return this._border},setBorder:function(t){this._border=t},getDisabledColor:function(){return this._disabledColor},setDisabledColor:function(t){this._disabledColor=t},getFocusColor:function(){return this._focusColor},setFocusColor:function(t){this._focusColor=t},getFocusBackground:function(){return this._focusBackground},setFocusBackground:function(t){this._focusBackground=t},getColor:function(){return this._color},setColor:function(t){this._color=t},getSubMenuEnableIcon:function(){return this._subMenuEnableIcon},setSubMenuEnableIcon:function(t){this._subMenuEnableIcon=t},getSubMenuDisableIcon:function(){return this._subMenuDisableIcon},setSubMenuDisableIcon:function(t){this._subMenuDisableIcon=t},getCheckboxSelectedIcon:function(){return this._checkboxSelectedIcon},setCheckboxSelectedIcon:function(t){this._checkboxSelectedIcon=t},getCheckboxUnselectedIcon:function(){return this._checkboxUnselectedIcon},setCheckboxUnselectedIcon:function(t){this._checkboxUnselectedIcon=t},getRadiobuttonSelectedIcon:function(){return this._radiobuttonSelectedIcon},setRadiobuttonSelectedIcon:function(t){this._radiobuttonSelectedIcon=t},getRadiobuttonUnselectedIcon:function(){return this._radiobuttonUnselectedIcon},setRadiobuttonUnselectedIcon:function(t){this._radiobuttonUnselectedIcon=t},getXOffset:function(){return this._xOffset},setXOffset:function(t){this._xOffset=t},getYOffset:function(){return this._yOffset},setYOffset:function(t){this._yOffset=t}}),De.charts.IS_INVALIDATE_PROPERTY={xZoom:1,xTranslate:1,yZoom:1,yTranslate:1},De.charts.ChartBase=function(t){De.charts.ChartBase.superClass.constructor.apply(this,arguments),this._uniqueColors={},this._nonDataColors={},this._publishedDatas=new hn,this._view=Xe.createView("hidden"),this._canvas=Xe.createCanvas(),this._view.appendChild(this._canvas),this.setDataBox(t||new De.ElementBox),this.invalidate(),Ue.isTouchable?Ue.isMSTouchable?new De.charts.ChartMSTouchInteraction(this):(new De.charts.ChartTouchInteraction(this),new De.charts.ChartInteraction(this)):new De.charts.ChartInteraction(this),this.setToolTipEnabled(kn.CHART_TOOLTIP_ENABLED)},Me.ext("twaver.charts.ChartBase",De.controls.ViewBase,{__accessor:["xGap","yGap","xTranslate","yTranslate","valueVisible","sortFunction","visibleFunction","xTranslateEnabled","yTranslateEnabled","xZoomEnabled","yZoomEnabled","selectTolerance","backgroundVisible","backgroundFill","backgroundFillColor","backgroundOutlineWidth","backgroundOutlineColor","backgroundGradient","backgroundGradientColor","outerZoom"],__bool:["doubleClickToReset","focusOnClick"],_backgroundVisible:kn.CHART_BACKGROUND_VISIBLE,_backgroundFill:kn.CHART_BACKGROUND_FILL,_backgroundFillColor:kn.CHART_BACKGROUND_FILL_COLOR,_backgroundOutlineWidth:kn.CHART_BACKGROUND_OUTLINE_WIDTH,_backgroundOutlineColor:kn.CHART_BACKGROUND_OUTLINE_COLOR,_backgroundGradient:kn.CHART_BACKGROUND_GRADIENT,_backgroundGradientColor:kn.CHART_BACKGROUND_GRADIENT_COLOR,_selectTolerance:kn.CHART_SELECT_TOLERANCE,_doubleClickToReset:kn.CHART_DOUBLE_CLICK_TO_RESET,_focusOnClick:kn.FOCUS_ON_CLICK,_sortFunction:null,_visibleFunction:null,_canvasWidth:0,_canvasHeight:0,_outerZoomL:1,_xGap:kn.CHART_XGAP,_yGap:kn.CHART_YGAP,_xTranslate:0,_yTranslate:0,_xTranslateEnabled:kn.CHART_XTRANSLATE_ENABLED,_yTranslateEnabled:kn.CHART_YTRANSLATE_ENABLED,_xZoom:1,_yZoom:1,_maxZoom:kn.ZOOM_MAX,_minZoom:kn.ZOOM_MIN,_xZoomEnabled:kn.CHART_XZOOM_ENABLED,_yZoomEnabled:kn.CHART_YZOOM_ENABLED,_valueVisible:kn.CHART_VALUE_VISIBLE,_valueFont:kn.CHART_VALUE_FONT,isToolTipEnabled:function(){return!!this._toolTipListener},setToolTipEnabled:function(t){if(t){if(!this._toolTipListener){var e=this;this._toolTipListener=function(t){xi.showToolTip(t,e.getToolTip(t))},this._canvas.addEventListener("mousemove",this._toolTipListener,!0),this.firePropertyChange("toolTipEnabled",!1,!0)}}else this._toolTipListener&&(xi.hideToolTip(),this._canvas.removeEventListener("mousemove",this._toolTipListener,!0),delete this._toolTipListener,this.firePropertyChange("toolTipEnabled",!0,!1))},getToolTip:function(t){if(this._toolTipInfos){var e=this.getLogicalPoint(t);e.x-=this._xTranslate,e.y-=this._yTranslate;for(var i=this._toolTipInfos.size(),n=i-1;n>=0;n--){var o=this._toolTipInfos.get(n);if(o.rect&&We.containsPoint(o.rect,e))return this.getToolTipByData(o.data,o)}}else{var r=this.tryGetDataAt(t);if(r)return this.getToolTipByData(r,{value:this.getValue(r)})}return null},getToolTipByData:function(t,i){return i.value!==e?this.formatValueText(i.value,t):null},addToolTipInfo:function(t,e,i,n,o,r,a){this._toolTipInfos&&this._toolTipInfos.add({data:r,rect:{x:t,y:e,width:i,height:n},value:o,index:a})},getLogicalPoint:function(t){return Xe.getLogicalPoint(this._canvas,t,this._outerZoom)},getTextSize:function(t,e){var i=Ye.getTextSize(t,e);return i.width&&(i.width+=4),i},getUniqueColor:function(t,i){if(null==t)return null;var n;if(!i&&(n=this._nonDataColors[t]))return n;var o=Ye.getColorArray(t);if(!i)return n=255!=o[3]?t:"rgba("+o[0]+","+o[1]+","+o[2]+",0.99)",this._nonDataColors[t]=n,n;var r="rgb("+o[0]+","+o[1]+","+o[2]+")";if(this._uniqueColors[r]===e||this._uniqueColors[r]===i);else{var a=1,s=-1,l=1;for(Ue.isOpera&&(o=[o[0],o[1],o[2]]);(o[0]+=a,o[0]>=255?(o[0]=255,a=-1):o[0]<=0&&(o[0]=0,a=1),r="rgb("+o[0]+","+o[1]+","+o[2]+")",this._uniqueColors[r]!==e&&this._uniqueColors[r]!==i)&&(o[1]+=s,o[1]>=255?(o[1]=255,s=-1):o[1]<=0&&(o[1]=0,s=1),r="rgb("+o[0]+","+o[1]+","+o[2]+")",this._uniqueColors[r]!==e&&this._uniqueColors[r]!==i)&&(o[2]+=l,o[2]>=255?(o[2]=255,l=-1):o[2]<=0&&(o[2]=0,l=1),r="rgb("+o[0]+","+o[1]+","+o[2]+")",this._uniqueColors[r]!==e&&this._uniqueColors[r]!==i););}return this._uniqueColors[r]=i,r},tryGetDataAt:function(t,e){if((null==e||0>e)&&(e=this._selectTolerance),t.target&&(t=Xe.getLogicalPoint(this._canvas,arguments[0],this._outerZoom)),!t)return null;var i=t.x-e,n=t.y-e,o=2*e+1,r=2*e+1;try{for(var a=this._canvas.getContext("2d").getImageData(i,n,o,r).data,s=0,l=a.length;l>s;s+=4)if(255===a[s+3]){var h="rgb("+a[s]+","+a[s+1]+","+a[s+2]+")",c=this._uniqueColors[h];if(c)return c}}catch(t){}return null},_getPoint:function(){var t,e;if(2===arguments.length)t=arguments[0],e=arguments[1];else if(arguments[0].target){var i=Xe.getLogicalPoint(this._canvas,arguments[0],this._outerZoom);if(!i)return null;t=i.x,e=i.y}else t=arguments[0].x,e=arguments[0].y;return{x:t,y:e}},getDataAt:function(){var t=this._getPoint.apply(this,arguments),e=t.x,i=t.y;if(0>e||0>i||e>this._canvasWidth||i>this._canvasHeight)return null;try{var n=this._canvas.getContext("2d").getImageData(e,i,1,1).data;if(255===n[3]){var o="rgb("+n[0]+","+n[1]+","+n[2]+")",r=this._uniqueColors[o];if(r)return r}}catch(t){}return null},getBackgroundRect:function(){return this._backgroundRect},drawBackground:function(t,e){this._backgroundRect=Me.clone(e),null!=e&&e.width>0&&e.height>0&&this._backgroundVisible&&(this._backgroundFill&&Ye.fill(t,this.getUniqueColor(this._backgroundFillColor),this._backgroundGradient,this.getUniqueColor(this._backgroundGradientColor),e),this._backgroundOutlineWidth>0&&(t.lineWidth=this._backgroundOutlineWidth,t.strokeStyle=this._backgroundOutlineColor),t.beginPath(),t.rect(e.x,e.y,e.width,e.height),t.closePath(),this._backgroundFill&&t.fill(),this._backgroundOutlineWidth>0&&t.stroke())},getName:function(t){return t.getName()},getColor:function(t){return t.getStyle?t.getStyle("chart.color"):t.getClient("chart.color")},getValue:function(t){return t.getStyle?t.getStyle("chart.value"):0},getValueColor:function(t){return t.getStyle?t.getStyle("chart.value.color"):De.Styles.getStyle("chart.value.color")},setValueFont:function(t){if(t!==this._valueFont){var e=t;this._valueFont=t,this.firePropertyChange("valueFont",e,t)}},getValueFont:function(t){if(t){var e=t.getStyle?t.getStyle("chart.value.font"):De.Styles.getStyle("chart.value.font");if(e)return e}return this._valueFont},formatValueText:function(t,e){return t},getCanvasWidth:function(){return this._canvasWidth},getCanvasHeight:function(){return this.canvasHeight},getCanvas:function(){return this._canvas},isVisible:function(t){return!(this._internalVisibleFunction&&!this._internalVisibleFunction(t))&&(!this._visibleFunction||this._visibleFunction(t))},onPropertyChanged:function(t){De.charts.IS_INVALIDATE_PROPERTY[t.property]?this.invalidate():this.invalidateModel()},getDataBox:function(){return this._box},setDataBox:function(t){if(!t)throw"DataBox can not be null";if(this._box!==t){var e=this._box;e&&(e.removeDataBoxChangeListener(this.handleDataBoxChange,this),e.removeDataPropertyChangeListener(this.handlePropertyChange,this),e.removeHierarchyChangeListener(this.handleHierarchyChange,this),this._selectionModel||e.getSelectionModel().removeSelectionChangeListener(this.handleSelectionChange,this)),this._box=t,this._box.addDataBoxChangeListener(this.handleDataBoxChange,this),this._box.addDataPropertyChangeListener(this.handlePropertyChange,this),this._box.addHierarchyChangeListener(this.handleHierarchyChange,this),this._selectionModel?this._selectionModel._setDataBox(t):this._box.getSelectionModel().addSelectionChangeListener(this.handleSelectionChange,this),this.invalidateModel(),this.firePropertyChange("dataBox",e,this._box)}},handleDataBoxChange:function(t){this.invalidateModel()},handlePropertyChange:function(t){this.invalidateModel()},handleHierarchyChange:function(t){this.invalidateModel()},handleSelectionChange:function(t){this.invalidateModel()},getUnfilteredDatas:function(){return this._unfilteredDatas?this._unfilteredDatas:this._publishedDatas},getPublishedDatas:function(){return this._publishedDatas},createPublishedDatas:function(){return this._unfilteredDatas=new hn,this._buildChildren(this._box.getRoots(),this._unfilteredDatas),this._sortFunction&&this._unfilteredDatas.sort(this._sortFunction),this._unfilteredDatas.toList(this.isVisible,this)},_buildChildren:function(t,e){t.forEach(function(t){e.add(t),this._buildChildren(t.getChildren(),e)},this)},invalidateModel:function(){this._invalidateModel||(this._invalidateModel=!0,this.invalidate())},validateImpl:function(){this._invalidateModel&&(this._invalidateModel=!1,this._uniqueColors={},this._nonDataColors={},this._publishedDatas=this.createPublishedDatas(),this._publishedDatas.forEach(function(t){t.IStyle?t.getStyle("chart.color")||t.setStyle("chart.color",Me.nextColor()):t.getClient("chart.color")||t.setClient("chart.color",Me.nextColor())}),this.validateModel());var t=this._canvas.getContext("2d");this._canvasWidth=this._view.clientWidth,this._canvasHeight=this._view.clientHeight,this._canvas.setAttribute("width",this._canvasWidth),this._canvas.setAttribute("height",this._canvasHeight),t.clearRect(0,0,this._canvasWidth,this._canvasHeight),De.Util.makeHighRes(this._canvas),this._canvasWidth>0&&this._canvasHeight>0&&(t.translate(this._xTranslate,this._yTranslate),this._valueTexts=this._valueVisible?new hn:null,this.validateDisplay(t,this._canvasWidth*this._xZoom,this._canvasHeight*this._yZoom),delete this._valueTexts,t.translate(-this._xTranslate,-this._yTranslate))},adjustBounds:function(t){De.charts.ChartBase.superClass.adjustBounds.apply(this,arguments)},validateModel:function(){},validateDisplay:function(t,e,i){},drawLine:function(t,e,i,n,o,r,a){i>0&&(t.lineWidth=i,t.strokeStyle=this.getUniqueColor(e),t.beginPath(),t.moveTo(n,o),t.lineTo(r,a),t.stroke())},drawValueTexts:function(t){this._valueTexts&&this._valueTexts.forEach(function(e){Ye.drawText(t,e.text,e,e.font,e.color)})},drawVerticalText:function(t,e,i,n,o){o=this.getUniqueColor(o),t.translate(i.x,i.y),t.rotate(-Math.PI/2),Ye.drawText(t,e,null,n,o),t.rotate(Math.PI/2),t.translate(-i.x,-i.y)},_getValueTextInfo:function(t,e){if(this._valueTexts){var i=this.formatValueText(e,t);if(i&&""!==i){var n=this.getValueColor(t),o={text:i,font:this.getValueFont(t),color:this.getUniqueColor(n,t)};return this._valueTexts.add(o),o}}return null},getMaxZoom:function(){return this._maxZoom},setMaxZoom:function(t){if(!(0>t)){var e=this._maxZoom;this._maxZoom=t,this.firePropertyChange("maxZoom",e,t),this.getXZoom()>t&&this.setXZoom(t,!1),this.getYZoom()>t&&this.setYZoom(t,!1)}},getMinZoom:function(){return this._minZoom},setMinZoom:function(t){if(!(0>t)){var e=this._minZoom;this._minZoom=t,this.firePropertyChange("minZoom",e,t),this.getXZoom()<t&&this.setXZoom(t),this.getYZoom()<t&&this.setYZoom(t)}},zoomIn:function(t){null==t&&(t=kn.ZOOM_ANIMATE),t?De.animate.AnimateManager.start(new De.animate.AnimateXYZoom(this,this._xZoom*kn.ZOOM_INCREMENT,this._yZoom*kn.ZOOM_INCREMENT)):(this.xZoomIn(!1),this.yZoomIn(!1))},zoomOut:function(t){null==t&&(t=kn.ZOOM_ANIMATE),t?De.animate.AnimateManager.start(new De.animate.AnimateXYZoom(this,this._xZoom/kn.ZOOM_INCREMENT,this._yZoom/kn.ZOOM_INCREMENT)):(this.xZoomOut(!1),this.yZoomOut(!1))},zoomReset:function(t){null==t&&(t=kn.ZOOM_ANIMATE),t?De.animate.AnimateManager.start(new De.animate.AnimateXYZoom(this,1,1)):(this.xZoomReset(!1),this.yZoomReset(!1))},getXZoom:function(){return this._xZoom},onXZoomChanged:function(t,e){},xZoomIn:function(t){this.setXZoom(this._xZoom*kn.ZOOM_INCREMENT,t)},xZoomOut:function(t){this.setXZoom(this._xZoom/kn.ZOOM_INCREMENT,t)},xZoomReset:function(t){this.setXZoom(1,t)},setXZoom:function(t,e){if(Me.num(t)&&!(0>=t)&&(t<this._minZoom&&(t=this._minZoom),t>this._maxZoom&&(t=this._maxZoom),t!==this.xZoom))if(null==e&&(e=kn.ZOOM_ANIMATE),e)De.animate.AnimateManager.start(new De.animate.AnimateXZoom(this,t));else{var i=this._xZoom,n=this._xTranslate-(this._canvasWidth/2-this._xTranslate)/i*(t-i);this._xZoom=t,this.firePropertyChange("xZoom",i,t),this.onXZoomChanged(i,t),this.setXTranslate(n)}},getYZoom:function(){return this._yZoom},onYZoomChanged:function(t,e){},yZoomIn:function(t){this.setYZoom(this._yZoom*kn.ZOOM_INCREMENT,t)},yZoomOut:function(t){this.setYZoom(this._yZoom/kn.ZOOM_INCREMENT,t)},yZoomReset:function(t){this.setYZoom(1,t)},setYZoom:function(t,e){if(Me.num(t)&&!(0>=t)&&(t<this._minZoom&&(t=this._minZoom),t>this._maxZoom&&(t=this._maxZoom),t!==this.YZoom))if(null==e&&(e=kn.ZOOM_ANIMATE),e)De.animate.AnimateManager.start(new De.animate.AnimateYZoom(this,t));else{var i=this._yZoom,n=this._yTranslate-(this._canvasHeight/2-this._yTranslate)/i*(t-i);this._yZoom=t,this.firePropertyChange("yZoom",i,t),this.onYZoomChanged(i,t),this.setYTranslate(n)}}}),De.charts.ScaleChart=function(t){De.charts.ScaleChart.superClass.constructor.apply(this,arguments)},Me.ext("twaver.charts.ScaleChart",De.charts.ChartBase,{__accessor:["upperLimit","lowerLimit","xAxisText","xAxisLineColor","xAxisLineWidth","xAxisTextColor","xAxisTextFont","yAxisText","yAxisLineColor","yAxisLineWidth","yAxisTextColor","yAxisTextFont","xScaleTexts","xScaleTextFont","xScaleTextColor","xScaleTextOrientation","yScaleTextVisible","yScaleTextColor","yScaleTextFont","yScaleLineColor","yScaleLineWidth","yScaleValueGap","yScalePixelGap","yScaleMinTextVisible","valueSpanCount"],_reset:function(){this._map={},this._max=0,this._min=0,this._columnCount=this._xScaleTexts?this._xScaleTexts.size():0,null!=this._upperLimit&&(this._max=this._upperLimit),null!=this._lowerLimit&&(this._min=this._lowerLimit)},getMin:function(){return this._min},getMax:function(){return this._max},getRange:function(){return this._range},getColumnCount:function(){return this._columnCount},getColumnWidth:function(){return this._columnWidth},getValues:function(t){return t.getStyle?t.getStyle("chart.values"):null},formatYScaleText:function(t){return t.toFixed(2)},_initRange:function(){null==this._lowerLimit&&(this._min>=this._max&&(this._min=this._max-.1*Math.abs(this._max)),this._min=this._min-.1*(this._max-this._min)),this._range=this._max-this._min},_initValuesProportion:function(){this._publishedDatas.forEach(function(t){var e=this._map[t.getId()];e.values.forEach(function(t){e.proportions.add(null==t?null:0==this._range?0:t/this._range)},this)},this)},_commonValidateModel:function(){this._publishedDatas.forEach(function(t){var e=new hn(this.getValues(t));e.size()>this._columnCount&&(this._columnCount=e.size());var i={data:t,values:e,proportions:new hn,color:this.getUniqueColor(this.getColor(t),t)};this._initInfo&&this._initInfo(t,i),this._map[t.getId()]=i,(null==this._upperLimit||null==this._lowerLimit)&&e.forEach(function(t){null!=t&&(null==this._upperLimit&&t>this._max&&(this._max=t),null==this._lowerLimit&&t<this._min&&(this._min=t))},this)},this),this._initRange(),this._initValuesProportion()},validateDisplay:function(t,e,i){var n=0;this._xAxisText&&(n=this.getTextSize(this._xAxisTextFont,this._xAxisText).height);var o=0;this._xScaleTexts&&this._xScaleTexts.forEach(function(t){var e=this.getTextSize(this._xScaleTextFont,t),i="vertical"===this._xScaleTextOrientation?e.width:e.height;i>o&&(o=i)},this);var r=i-this._yGap-n-o,a=r-this._yGap,s=null==this._upperLimit?.9*a:a,l=0;this._yAxisText&&(l=this.getTextSize(this._yAxisTextFont,this._yAxisText).height);var h,c;this._yScaleValueGap>0?(h=Math.max(this._yScaleValueGap/this._range*s,1),c=this._yScaleValueGap):(h=Math.max(this._yScalePixelGap,1),c=this._range*(h/s));var u,d,f=0,p=new hn;if(this._yScaleTextVisible){u=this._yScaleMinTextVisible?0:h;for(var g=this._min+(this._yScaleMinTextVisible?0:c);a+1>=u;){if(d=this.formatYScaleText(g)){var _=this.getTextSize(this._yScaleTextFont,d);_.width>f&&(f=_.width),p.add({text:d,size:_,cursor:u})}u+=h,g+=c}}var m={x:this._xGap+l+f,y:this._yGap,width:e-this._xGap-l-f-this._xGap,height:i-this._yGap-o-n-this._yGap};if(this.drawBackground(t,m),this._columnWidth=this._columnCount>0?m.width/(3*this._columnCount+1)*2:m.width/2,0===this._columnWidth&&(this._columnWidth=1),this._yScaleLineWidth>0)for(u=0;a+1>=u;)this.drawLine(t,this._yScaleLineColor,this._yScaleLineWidth,m.x,r-u,m.x+m.width,r-u),u+=h;this._xAxisText&&Ye.drawText(t,this._xAxisText,{x:m.x+m.width/2,y:r+o+n/2},this._xAxisTextFont,this.getUniqueColor(this._xAxisTextColor)),this._yAxisText&&this.drawVerticalText(t,this._yAxisText,{x:this._xGap+l/2,y:a/2+this._yGap},this._yAxisTextFont,this.getUniqueColor(this._yAxisTextColor)),this.drawLine(t,this._yAxisLineColor,this._yAxisLineWidth,m.x,m.y+m.height,m.x,m.y);var v=this.getUniqueColor(this._yScaleTextColor);p.forEach(function(e){var i={x:this._xGap+l+f-e.size.width/2,y:r-e.cursor};Ye.drawText(t,e.text,i,this._yScaleTextFont,v)},this);var y=m.y+m.height+o/2;v=this.getUniqueColor(this._xScaleTextColor);for(var w=this._xScaleLineWidth>0?this.getUniqueColor(this._xScaleLineColor):null,b=0;b<this._columnCount;b++){var x=m.x+this._columnWidth*(1+1.5*b);if(this._xScaleTexts&&b<this._xScaleTexts.size()&&(d=this._xScaleTexts.get(b))){var A={x:x,y:y};"vertical"===this._xScaleTextOrientation?this.drawVerticalText(t,d,A,this._yScaleTextFont,v):this._valueSpanCount?b%this._valueSpanCount==0&&Ye.drawText(t,d,A,this._xScaleTextFont,v):Ye.drawText(t,d,A,this._xScaleTextFont,v)}"default"!==this._type&&w&&(this._valueSpanCount?b%this._valueSpanCount==0&&this.drawLine(t,w,this._xScaleLineWidth,x,m.y+m.height,x,m.y):this.drawLine(t,w,this._xScaleLineWidth,x,m.y+m.height,x,m.y))}var C=r+this._min/c*h;this._publishedDatas.size()>0&&this._columnCount>0&&this.drawContent(t,m,s,C),this.drawLine(t,this._xAxisLineColor,this._xAxisLineWidth,m.x,m.y+m.height,m.x+m.width,m.y+m.height)}}),De.charts.PieChart=function(t){this._sum=0,this._map={},De.charts.PieChart.superClass.constructor.apply(this,arguments)},Me.ext("twaver.charts.PieChart",De.charts.ChartBase,{__accessor:["type","selectOffset","startAngle","shadowColor","shadowOffset","lineRate","donutRate","valuePosition"],_type:kn.PIECHART_TYPE,_lineRate:kn.PIECHART_LINE_RATE,_donutRate:kn.PIECHART_DONUT_RATE,_startAngle:kn.PIECHART_START_ANGLE,_shadowColor:kn.PIECHART_SHADOW_COLOR,_shadowOffset:kn.PIECHART_SHADOW_OFFSET,_selectOffset:kn.PIECHART_SELECT_OFFSET,_valuePosition:kn.PIECHART_VALUE_POSITION,getSum:function(){return this._sum},validateModel:function(){this._sum=0,this._map={},this._publishedDatas.forEach(function(t){var e=this.getValue(t);this._map[t.getId()]={data:t,value:e,color:this.getUniqueColor(this.getColor(t),t)},this._sum+=e},this);var t=this._startAngle;this._publishedDatas.forEach(function(e){var i=this._map[e.getId()];i.proportion=0===this._sum?0:i.value/this._sum,"line"!==this._type&&(i.startAngle=t,i.arc=i.proportion*Math.PI*2,t+=i.arc)},this)},validateDisplay:function(t,e,i){var n={x:this._xGap,y:this._yGap,width:e-2*this._xGap,height:i-2*this._yGap};if(this.drawBackground(t,n),We.grow(n,-4,-4),!(n.width<=0||n.height<=0)){var o=this._shadowOffset;if(o>0&&(t.shadowOffsetX=o,t.shadowOffsetY=o,t.shadowBlur=1.5*o,t.shadowColor=this._shadowColor),"oval"===this._type||"circle"===this._type){var r=n.x+n.width/2,a=n.y+n.height/2,s=n.width/2,l=n.height/2;"circle"===this._type&&(s=l=Math.min(s,l)),this._publishedDatas.forEach(function(e){var i=this._map[e.getId()];if(0!==i.arc){var n=0,o=0;if(this.isSelected(e)){var h=i.startAngle+i.arc/2;n=Math.cos(h)*this._selectOffset,o=Math.sin(h)*this._selectOffset*l/s}t.fillStyle=i.color,t.beginPath(),t.moveTo(r+n,a-o),Ye.drawArc(t,r+n,a-o,i.startAngle,i.arc,s,l,!0),t.closePath(),t.fill();var c=this._getValueTextInfo(e,i.value);if(c){var h=i.startAngle+i.arc/2;c.x=r+n+Math.cos(h)*s*this._valuePosition,c.y=a-o-Math.sin(h)*l*this._valuePosition}}},this)}else if("donut"===this._type||"ovalDonut"===this._type){var r=n.x+n.width/2,a=n.y+n.height/2,s=n.width/2,l=n.height/2;"donut"===this._type&&(s=l=Math.min(s,l)),this._publishedDatas.forEach(function(e){var i=this._map[e.getId()];if(0!==i.arc){var n=0,o=0;if(this.isSelected(e)){var h=i.startAngle+i.arc/2;n=Math.cos(h)*this._selectOffset,o=Math.sin(h)*this._selectOffset*l/s}var c=r+Math.cos(i.startAngle)*s*this._donutRate,u=a-Math.sin(i.startAngle)*l*this._donutRate,d=r+Math.cos(i.startAngle+i.arc)*s*this._donutRate,f=a-Math.sin(i.startAngle+i.arc)*l*this._donutRate;t.fillStyle=i.color,t.beginPath(),t.moveTo(c+n,u-o),Ye.drawArc(t,r+n,a-o,i.startAngle,i.arc,s,l,!0),t.lineTo(d+n,f-o),Ye.drawArc(t,r+n,a-o,i.startAngle+i.arc,-i.arc,s*this._donutRate,l*this._donutRate,!0),t.closePath(),t.fill();var p=this._getValueTextInfo(e,i.value);if(p){var h=i.startAngle+i.arc/2,g=this._donutRate+(1-this._donutRate)*this._valuePosition;p.x=r+n+Math.cos(h)*s*g,p.y=a-o-Math.sin(h)*l*g}}},this)}else if("line"===this._type){var h=n.height*this._lineRate;n.y=n.y+n.height/2-h/2,n.height=h;var c=n.x;this._publishedDatas.forEach(function(e){var i=this._map[e.getId()],o=n.width*i.proportion;if(0!==o){t.beginPath(),t.fillStyle=i.color;var r=this.isSelected(e)?-this._selectOffset:0;t.rect(c,n.y+r,o,n.height),t.closePath(),t.fill();var a=this._getValueTextInfo(e,i.value);a&&(a.x=c+o/2,a.y=n.y+n.height+r-n.height*this._valuePosition),c+=o}},this)}this._shadowOffset>0&&(t.shadowOffsetX=0,t.shadowOffsetY=0,t.shadowBlur=0),this.drawValueTexts(t)}}}),De.charts.BarChart=function(t){De.charts.BarChart.superClass.constructor.apply(this,arguments)},Me.ext("twaver.charts.BarChart",De.charts.ScaleChart,{__accessor:["type"],_upperLimit:kn.BARCHART_UPPER_LIMIT,_lowerLimit:kn.BARCHART_LOWER_LIMIT,_type:kn.BARCHART_TYPE,_xAxisText:null,_xAxisTextColor:kn.BARCHART_XAXIS_TEXT_COLOR,_xAxisTextFont:kn.BARCHART_XAXIS_TEXT_FONT,_xAxisLineColor:kn.BARCHART_XAXIS_LINE_COLOR,_xAxisLineWidth:kn.BARCHART_XAXIS_LINE_WIDTH,_yAxisText:null,_yAxisTextColor:kn.BARCHART_YAXIS_TEXT_COLOR,_yAxisTextFont:kn.BARCHART_YAXIS_TEXT_FONT,_yAxisLineColor:kn.BARCHART_YAXIS_LINE_COLOR,_yAxisLineWidth:kn.BARCHART_YAXIS_LINE_WIDTH,_xScaleTexts:null,_xScaleTextFont:kn.BARCHART_XSCALE_TEXT_FONT,_xScaleTextColor:kn.BARCHART_XSCALE_TEXT_COLOR,_xScaleTextOrientation:kn.BARCHART_XSCALE_TEXT_ORIENTATION,_yScaleTextVisible:kn.BARCHART_YSCALE_TEXT_VISIBLE,_yScaleTextColor:kn.BARCHART_YSCALE_TEXT_COLOR,_yScaleTextFont:kn.BARCHART_YSCALE_TEXT_FONT,_yScaleLineColor:kn.BARCHART_YSCALE_LINE_COLOR,_yScaleLineWidth:kn.BARCHART_YSCALE_LINE_WIDTH,_yScaleValueGap:kn.BARCHART_YSCALE_VALUE_GAP,_yScalePixelGap:kn.BARCHART_YSCALE_PIXEL_GAP,_yScaleMinTextVisible:kn.BARCHART_YSCALE_MIN_TEXT_VISIBLE,validateModel:function(){var t=this._type+"ValidateModel";this[t]&&(this._reset(),this[t]())},defaultValidateModel:function(){this._columnCount=this._publishedDatas.size(),this._publishedDatas.forEach(function(t){var e=this.getValue(t);null==this._upperLimit&&e>this._max&&(this._max=e),null==this._lowerLimit&&e<this._min&&(this._min=e),this._map[t.getId()]={data:t,value:e,color:this.getUniqueColor(this.getColor(t),t)}},this),this._initRange(),this._publishedDatas.forEach(function(t){var e=this._map[t.getId()];e.proportion=0==this._range?0:e.value/this._range},this)},layerValidateModel:function(){this._commonValidateModel()},groupValidateModel:function(){this._commonValidateModel()},stackValidateModel:function(){if(this._publishedDatas.forEach(function(t){var e=new hn(this.getValues(t));e.size()>this._columnCount&&(this._columnCount=e.size());var i={data:t,values:e,proportions:new hn,color:this.getUniqueColor(this.getColor(t),t)};this._map[t.getId()]=i},this),null==this._upperLimit||null==this._lowerLimit)for(var t=0;t<this._columnCount;t++){var e=0,i=0;this._publishedDatas.forEach(function(n){var o=this._map[n.getId()];if(o.values.size()>t){var r=o.values.get(t);null!=r&&(r>=0?e+=r:i+=r)}},this),null==this._upperLimit&&e>this._max&&(this._max=e),null==this._lowerLimit&&i<this._min&&(this._min=i)}this._initRange(),this._initValuesProportion()},percentValidateModel:function(){this._publishedDatas.forEach(function(t){var e=new hn(this.getValues(t));e.size()>this._columnCount&&(this._columnCount=e.size());var i={data:t,values:e,proportions:new hn,color:this.getUniqueColor(this.getColor(t),t)};this._map[t.getId()]=i},this);for(var t=new hn,e=0;e<this._columnCount;e++){var i=0;this._publishedDatas.forEach(function(t){var n=this._map[t.getId()];if(n.values.size()>e){var o=n.values.get(e);null!=o&&(i+=o)}},this),t.add(i)}for(var e=0;e<this._columnCount;e++)this._publishedDatas.forEach(function(i){var n=this._map[i.getId()],o=t.get(e);if(0!==o&&n.values.size()>e){var r=n.values.get(e);if(null!=r)return void n.proportions.add(r/o)}n.proportions.add(null)},this);this._min=0,this._max=1,this._range=1},drawRect:function(t,e,i,n,o,r,a){t.fillStyle=e,i&&this._selectInfos.add({x:n,y:o,w:r,h:a,color:this.getUniqueColor(Ye.darker(e))}),t.beginPath(),t.rect(n,o,r,a),t.closePath(),t.fill()},drawContent:function(t,e,i,n){this._selectInfos=new hn,this._toolTipInfos=this.isToolTipEnabled()?new hn:null,"default"===this._type?this.drawDefaultContent(t,e,i,n):"group"===this._type?this.drawGroupContent(t,e,i,n):"percent"===this._type?this.drawPercentContent(t,e,i,n):"stack"===this._type?this.drawStackContent(t,e,i,n):"layer"===this._type&&this.drawLayerContent(t,e,i,n),this.drawValueTexts(t),this._selectInfos.forEach(function(e){t.lineWidth=2,t.strokeStyle=e.color,t.beginPath(),t.rect(e.x,e.y,e.w,e.h),t.closePath(),t.stroke()},this),delete this._selectInfos},drawDefaultContent:function(t,e,i,n){for(var o=this._publishedDatas.size(),r=this._columnWidth,a=0;o>a;a++){var s=this._publishedDatas.get(a),l=this._map[s.getId()],h=e.x+r*(.5+1.5*a),c=Math.abs(i*l.proportion),u=l.proportion>0?n-c:n;this.drawRect(t,l.color,this.isSelected(s),h,u,r,c),this.addToolTipInfo(h,u,r,c,l.value,s);var d=this._getValueTextInfo(s,l.value);if(d){var f=this.getTextSize(d.font,d.text);d.x=h+r/2,d.y=u-f.height/2+1}}},drawPercentContent:function(t,e,i,n){this.drawStackContent(t,e,i,n)},drawStackContent:function(t,e,i,n){for(var o=this._columnCount,r=this._columnWidth,a=0;o>a;a++){var s=n,l=e.x+r*(.5+1.5*a);this._publishedDatas.forEach(function(e){var n=this._map[e.getId()];if(a<n.proportions.size()){var o=n.proportions.get(a);if(null!=o){var h=i*o;s-=h,this.drawRect(t,n.color,this.isSelected(e),l,s,r,h),this.addToolTipInfo(l,s,r,h,n.values.get(a),e);var c=this._getValueTextInfo(e,n.values.get(a));c&&(c.x=l+r/2,c.y=s+h/2)}}},this)}},drawLayerContent:function(t,e,i,n){for(var o=this._publishedDatas.size(),r=this._columnCount,a=this._columnWidth,s=3*a/8/o,l=0;r>l;l++){var h=e.x+a*(.5+1.5*l),c=0;this._publishedDatas.forEach(function(e){var r=this._map[e.getId()];if(l<r.proportions.size()){var u=r.proportions.get(l);if(null!=u){var d=i*u,f=n-d,p=h+a/2-a/8-s*(o-c),g=2*(a/8+s*(o-c));this.drawRect(t,r.color,this.isSelected(e),p,f,g,d),this.addToolTipInfo(p,f,g,d,r.values.get(l),e);var _=this._getValueTextInfo(e,r.values.get(l));if(_){var m=this.getTextSize(_.font,_.text);_.x=p+g/2,_.y=f-m.height/2+1}}}c++},this)}},drawGroupContent:function(t,e,i,n){for(var o=this._publishedDatas.size(),r=this._columnCount,a=this._columnWidth,s=a/o,l=0;r>l;l++){var h=e.x+a*(.5+1.5*l),c=0;this._publishedDatas.forEach(function(e){var o=this._map[e.getId()];if(l<o.proportions.size()){var r=o.proportions.get(l);if(null!=r){var a=i*r,u=n-a;this.drawRect(t,o.color,this.isSelected(e),h+s*c,u,s,a),this.addToolTipInfo(h+s*c,u,s,a,o.values.get(l),e);var d=this._getValueTextInfo(e,o.values.get(l));if(d){var f=this.getTextSize(d.font,d.text);d.x=h+s*c+s/2,d.y=u-f.height/2+1}}}c++},this)}}}),De.charts.LineChart=function(t){De.charts.LineChart.superClass.constructor.apply(this,arguments),this._selectTolerance=2},Me.ext("twaver.charts.LineChart",De.charts.ScaleChart,{__accessor:["xScaleLineColor","xScaleLineWidth","interruptable"],_interruptable:kn.LINECHART_INTERRUPTABLE,_upperLimit:kn.LINECHART_UPPER_LIMIT,_lowerLimit:kn.LINECHART_LOWER_LIMIT,_xAxisText:null,_xAxisTextColor:kn.LINECHART_XAXIS_TEXT_COLOR,_xAxisTextFont:kn.LINECHART_XAXIS_TEXT_FONT,_xAxisLineColor:kn.LINECHART_XAXIS_LINE_COLOR,_xAxisLineWidth:kn.LINECHART_XAXIS_LINE_WIDTH,_yAxisText:null,_yAxisTextColor:kn.LINECHART_YAXIS_TEXT_COLOR,_yAxisTextFont:kn.LINECHART_YAXIS_TEXT_FONT,_yAxisLineColor:kn.LINECHART_YAXIS_LINE_COLOR,_yAxisLineWidth:kn.LINECHART_YAXIS_LINE_WIDTH,_xScaleTexts:null,_xScaleTextFont:kn.LINECHART_XSCALE_TEXT_FONT,_xScaleTextColor:kn.LINECHART_XSCALE_TEXT_COLOR,_xScaleTextOrientation:kn.LINECHART_XSCALE_TEXT_ORIENTATION,_xScaleLineColor:kn.LINECHART_XSCALE_LINE_COLOR,_xScaleLineWidth:kn.LINECHART_XSCALE_LINE_WIDTH,_valueSpanCount:kn.LINECHART_VALUESPANCOUNT,_yScaleTextVisible:kn.LINECHART_YSCALE_TEXT_VISIBLE,_yScaleTextColor:kn.LINECHART_YSCALE_TEXT_COLOR,_yScaleTextFont:kn.LINECHART_YSCALE_TEXT_FONT,_yScaleLineColor:kn.LINECHART_YSCALE_LINE_COLOR,_yScaleLineWidth:kn.LINECHART_YSCALE_LINE_WIDTH,_yScaleValueGap:kn.LINECHART_YSCALE_VALUE_GAP,_yScalePixelGap:kn.LINECHART_YSCALE_PIXEL_GAP,_yScaleMinTextVisible:kn.LINECHART_YSCALE_MIN_TEXT_VISIBLE,getLineWidth:function(t){return t.getStyle?t.getStyle("chart.line.width"):De.Styles.getStyle("chart.line.width")},getMarkerShape:function(t){return t.getStyle?t.getStyle("chart.marker.shape"):De.Styles.getStyle("chart.marker.shape")},getMarkerSize:function(t){return t.getStyle?t.getStyle("chart.marker.size"):De.Styles.getStyle("chart.marker.size")},_initInfo:function(t,e){e.markerShape=this.getMarkerShape(t),e.markerSize=this.getMarkerSize(t),e.lineWidth=this.getLineWidth(t),this.isSelected(t)&&(e.lineWidth+=2)},validateModel:function(){this._reset(),this._commonValidateModel()},getPointIndexAt:function(){var t=this._getPoint.apply(this,arguments),e=this.tryGetDataAt(t);if(!e)return-1;for(var i,n=this._map[e.getId()],o=n.points,r=n.markerSize,a=0,s=o.size();s>a;a++)if((i=o.get(a))&&We.getDistance(t,i)<=r)return a;return-1},drawContent:function(t,e,i,n){this._toolTipInfos=this.isToolTipEnabled()?new hn:null,this._publishedDatas.forEach(function(o){var r=this._map[o.getId()],a=r.markerSize>0?new hn:null;t.strokeStyle=r.color,t.lineWidth=r.lineWidth,t.beginPath();var s=r.proportions,l=null,h=s.size(),c=new hn;r.points=c;for(var u=0;h>u;u++){var d=s.get(u);if(null!=d){var f={x:e.x+this._columnWidth*(1+1.5*u),y:n-i*d};c.add(f),null==l?t.moveTo(f.x,f.y):t.lineTo(f.x,f.y);var p=r.values.get(u),g=this._getValueTextInfo(o,p);if(g){var _=this.getTextSize(g.font,g.text);g.x=f.x,g.y=f.y-_.height/2+2}a&&a.add({point:f,value:p,data:o,index:u}),l=f}else this._interruptable&&(l=null,c.add(null))}if(t.stroke(),a){var m=r.markerSize/2;a.forEach(function(e){t.fillStyle=r.color;var i=e.point.x-m,n=e.point.y-m,o=r.markerSize,a=r.markerSize;Ye.drawVector(t,r.markerShape,null,i,n,o,a),t.fill(),this.addToolTipInfo(i,n,o,a,e.value,e.data,e.index)},this)}},this),this.drawValueTexts(t)}}),De.charts.BubbleChart=function(t){De.charts.BubbleChart.superClass.constructor.apply(this,arguments)},Me.ext("twaver.charts.BubbleChart",De.charts.ScaleChart,{__accessor:["xAxisUpperLimit","xAxisLowerLimit","xScaleLineColor","xScaleLineWidth","selectShadowColor","selectShadowOffset"],_upperLimit:kn.BUBBLECHART_UPPER_LIMIT,_lowerLimit:kn.BUBBLECHART_LOWER_LIMIT,_xAxisUpperLimit:kn.BUBBLECHART_XAXIS_UPPER_LIMIT,_xAxisLowerLimit:kn.BUBBLECHART_XAXIS_LOWER_LIMIT,_xAxisText:null,_xAxisTextColor:kn.BUBBLECHART_XAXIS_TEXT_COLOR,_xAxisTextFont:kn.BUBBLECHART_XAXIS_TEXT_FONT,_xAxisLineColor:kn.BUBBLECHART_XAXIS_LINE_COLOR,_xAxisLineWidth:kn.BUBBLECHART_XAXIS_LINE_WIDTH,_yAxisText:null,_yAxisTextColor:kn.BUBBLECHART_YAXIS_TEXT_COLOR,_yAxisTextFont:kn.BUBBLECHART_YAXIS_TEXT_FONT,_yAxisLineColor:kn.BUBBLECHART_YAXIS_LINE_COLOR,_yAxisLineWidth:kn.BUBBLECHART_YAXIS_LINE_WIDTH,_xScaleTexts:null,_xScaleTextFont:kn.BUBBLECHART_XSCALE_TEXT_FONT,_xScaleTextColor:kn.BUBBLECHART_XSCALE_TEXT_COLOR,_xScaleTextOrientation:kn.BUBBLECHART_XSCALE_TEXT_ORIENTATION,_xScaleLineColor:kn.BUBBLECHART_XSCALE_LINE_COLOR,_xScaleLineWidth:kn.BUBBLECHART_XSCALE_LINE_WIDTH,_yScaleTextVisible:kn.BUBBLECHART_YSCALE_TEXT_VISIBLE,_yScaleTextColor:kn.BUBBLECHART_YSCALE_TEXT_COLOR,_yScaleTextFont:kn.BUBBLECHART_YSCALE_TEXT_FONT,_yScaleLineColor:kn.BUBBLECHART_YSCALE_LINE_COLOR,_yScaleLineWidth:kn.BUBBLECHART_YSCALE_LINE_WIDTH,_yScaleValueGap:kn.BUBBLECHART_YSCALE_VALUE_GAP,_yScalePixelGap:kn.BUBBLECHART_YSCALE_PIXEL_GAP,_yScaleMinTextVisible:kn.BUBBLECHART_YSCALE_MIN_TEXT_VISIBLE,_selectShadowColor:kn.BUBBLECHART_SELECT_SHADOW_COLOR,_selectShadowOffset:kn.BUBBLECHART_SELECT_SHADOW_OFFSET,_resetX:function(){this._xMax=0,this._xMin=0,null!=this._xAxisUpperLimit&&(this._xMax=this._xAxisUpperLimit),null!=this._xAxisLowerLimit&&(this._xMin=this._xAxisLowerLimit)},getXMin:function(){return this._xMin},getXMax:function(){return this._xMax},getXRange:function(){return this._xRange},getShape:function(t){return t.getStyle?t.getStyle("chart.bubble.shape"):De.Styles.getStyle("chart.bubble.shape")},getSize:function(t,e){return e},getNames:function(t){return t.getStyle?t.getStyle("chart.names"):De.Styles.getStyle("chart.names")},getXAxisValues:function(t){return t.getStyle?t.getStyle("chart.xaxis.values"):De.Styles.getStyle("chart.xaxis.values")},getYAxisValues:function(t){return t.getStyle?t.getStyle("chart.yaxis.values"):De.Styles.getStyle("chart.yaxis.values")},_initXRange:function(){null==this._xAxisLowerLimit&&(this._xMin>=this._xMax&&(this._xMin=this._xMax-.1*Math.abs(this._xMax)),this._xMin=this._xMin-.1*(this._xMax-this._xMin)),this._xRange=this._xMax-this._xMin},_initXYValuesProportion:function(){this._publishedDatas.forEach(function(t){var e=this._map[t.getId()];e.xAxisValues.forEach(function(t){e.xAxisProportions.add(null==t?null:0==this._xRange?0:t/this._xRange)},this),e.yAxisValues.forEach(function(t){e.yAxisProportions.add(null==t?null:0==this._range?0:t/this._range)},this)},this)},validateModel:function(){this._reset(),this._resetX(),this._columnCount=null==this._xScaleTexts?0:this._xScaleTexts.size(),this._publishedDatas.forEach(function(t){var e=new hn(this.getYAxisValues(t)),i=new hn(this.getXAxisValues(t)),n=new hn(this.getValues(t));n.size()>this._columnCount&&(this._columnCount=n.size());var o={data:t,values:n,yAxisValues:e,xAxisValues:i,yAxisProportions:new hn,xAxisProportions:new hn,color:this.getUniqueColor(this.getColor(t),t),anchorShape:this.getShape(t)};this._map[t.getId()]=o,(null==this._upperLimit||null==this._lowerLimit)&&e.forEach(function(t){null!=t&&(null==this._upperLimit&&t>this._max&&(this._max=t),null==this._lowerLimit&&t<this._min&&(this._min=t))},this),(null==this._upperLimit||null==this._lowerLimit)&&i.forEach(function(t){null!=t&&(null==this._xAxisUpperLimit&&t>this._xMax&&(this._xMax=t),null==this._xAxisLowerLimit&&t<this._xMin&&(this._xMin=t))},this)},this),this._initRange(),this._initXRange(),this._initXYValuesProportion()},drawContent:function(t,e,i,n){this._toolTipInfos=this.isToolTipEnabled()?new hn:null,this._publishedDatas.forEach(function(o){var r=this._map[o.getId()],a=r.yAxisProportions,s=r.xAxisProportions,l=r.values,h=r.yAxisProportions.size(),c=this._selectShadowOffset;this.isSelected(o)&&c>0?(t.shadowOffsetX=c,t.shadowOffsetY=c,t.shadowBlur=2*c,t.shadowColor=this._selectShadowColor):(t.shadowOffsetX=0,t.shadowOffsetY=0,t.shadowBlur=0,t.shadowColor=r.color),t.fillStyle=r.color;for(var u=0;h>u;u++){var d=a.get(u),f=s.get(u);if(null!=d){var p={x:e.x+e.width*f,y:n-i*d},g=l.get(u),_=this.getSize(o,g),c=_/2,m=p.x-c,v=p.y-c,y=_,w=_;Ye.drawVector(t,r.anchorShape,null,m,v,y,w),t.fill(),this.addToolTipInfo(m,v,y,w,g,o,u);var b=this._getValueTextInfo(o,g);if(b){var _=this.getTextSize(b.font,b.text);b.x=p.x,b.y=p.y}}}},this),this.drawValueTexts(t)}}),De.charts.DialChart=function(t){De.charts.DialChart.superClass.constructor.apply(this,arguments)},Me.ext("twaver.charts.DialChart",De.charts.ChartBase,{__accessor:["upperLimit","lowerLimit","startAngle","endAngle","innerRadius","colorRangeFillColor","outlineWidth","outlineColor","majorScaleCount","majorScaleLineWidth","majorScaleLineLength","majorScaleLineColor","minorScaleCount","minorScaleLineWidth","minorScaleLineLength","minorScaleLineColor","scaleTextVisible","scaleUpperLimitTextVisible","scaleLowerLimitTextVisible","scaleTextFont","scaleTextColor","pivotRadius","pivotFillColor","pivotOutlineWidth","pivotOutlineColor","pivotGradient","pivotGradientColor","valuePosition","colorRangeList","innerDarkerRadius","outerBrighterRadius","selectShadowColor","selectShadowOffset"],__bool:["scaleInside","pivotFill"],_upperLimit:kn.DIALCHART_UPPER_LIMIT,_lowerLimit:kn.DIALCHART_LOWER_LIMIT,_startAngle:kn.DIALCHART_START_ANGLE,_endAngle:kn.DIALCHART_END_ANGLE,_innerRadius:kn.DIALCHART_INNER_RADIUS,_colorRangeFillColor:kn.DIALCHART_COLOR_RANGE_FILL_COLOR,_outlineWidth:kn.DIALCHART_OUTLINE_WIDTH,_outlineColor:kn.DIALCHART_OUTLINE_COLOR,_scaleInside:kn.DIALCHART_SCALE_INSIDE,_majorScaleCount:kn.DIALCHART_MAJOR_SCALE_COUNT,_majorScaleLineWidth:kn.DIALCHART_MAJOR_SCALE_LINE_WIDTH,_majorScaleLineLength:kn.DIALCHART_MAJOR_SCALE_LINE_LENGTH,_majorScaleLineColor:kn.DIALCHART_MAJOR_SCALE_LINE_COLOR,_minorScaleCount:kn.DIALCHART_MINOR_SCALE_COUNT,_minorScaleLineWidth:kn.DIALCHART_MINOR_SCALE_LINE_WIDTH,_minorScaleLineLength:kn.DIALCHART_MINOR_SCALE_LINE_LENGTH,_minorScaleLineColor:kn.DIALCHART_MINOR_SCALE_LINE_COLOR,_scaleTextVisible:kn.DIALCHART_SCALE_TEXT_VISIBLE,_scaleUpperLimitTextVisible:kn.DIALCHART_SCALE_UPPER_LIMIT_TEXT_VISIBLE,_scaleLowerLimitTextVisible:kn.DIALCHART_SCALE_LOWER_LIMIT_TEXT_VISIBLE,_scaleTextFont:kn.DIALCHART_SCALE_TEXT_FONT,_scaleTextColor:kn.DIALCHART_SCALE_TEXT_COLOR,_pivotRadius:kn.DIALCHART_PIVOT_RADIUS,_pivotFill:kn.DIALCHART_PIVOT_FILL,_pivotFillColor:kn.DIALCHART_PIVOT_FILL_COLOR,_pivotOutlineWidth:kn.DIALCHART_PIVOT_OUTLINE_WIDTH,_pivotOutlineColor:kn.DIALCHART_PIVOT_OUTLINE_COLOR,_pivotGradient:kn.DIALCHART_PIVOT_GRADIENT,_pivotGradientColor:kn.DIALCHART_PIVOT_GRADIENT_COLOR,_valuePosition:kn.DIALCHART_VALUE_POSITION,_innerDarkerRadius:kn.DIALCHART_INNER_DARKER_RADIUS,_outerBrighterRadius:kn.DIALCHART_OUTER_BRIGHTER_RADIUS,_selectShadowColor:kn.DIALCHART_SELECT_SHADOW_COLOR,_selectShadowOffset:kn.DIALCHART_SELECT_SHADOW_OFFSET,formatScaleText:function(t){return t.toFixed(2)},validateModel:function(){this._map={},this._valueRange=this._upperLimit-this._lowerLimit;var t=this._startAngle;0!=t&&0==(t=(t%360+360)%360)&&(t=360),this._positiveStartAngle=t;var e=this._endAngle;0!=e&&0==(e=(e%360+360)%360)&&(e=360),this._positiveEndAngle=e,this._whole=360==Math.abs(t-e),this._startAngleByRadian=t*Math.PI/180,this._endAngleByRadian=e*Math.PI/180,this._clockwise=this._startAngleByRadian>this._endAngleByRadian,this._angleRange=Math.abs(this._startAngleByRadian-this._endAngleByRadian),this._publishedDatas.forEach(function(t){var e=this.getValue(t);this._map[t.getId()]={data:t,value:e,color:this.getUniqueColor(this.getColor(t),t),angle:this._startAngleByRadian+(this._clockwise?-1:1)*e/this._valueRange*this._angleRange}},this)},validateDisplay:function(t,e,i){var n={x:this._xGap,y:this._yGap,width:e-2*this._xGap,height:i-2*this._yGap};if(this.drawBackground(t,n),this._startAngleByRadian!=this._endAngleByRadian){var o,r,a=this._lowerLimit,s=this._majorScaleCount>1?this._valueRange/(this._majorScaleCount-1):0,l=0,h=0,c=null,u=null;if(this._scaleTextVisible)for(c=new hn,o=0;o<this._majorScaleCount;o++)0==o&&!this._scaleLowerLimitTextVisible||o==this._majorScaleCount-1&&!this._scaleUpperLimitTextVisible?(r=null,c.add({text:"",size:{width:0,height:0}})):(u=this.formatScaleText(a),r=this.getTextSize(this._scaleTextFont,u),c.add({text:u,size:r})),this._scaleInside||null==r||(r.width>l&&(l=r.width),r.height>h&&(h=r.height)),a+=s;if(this._angleRange<=Math.PI&&(l=Math.max(l,this._pivotRadius),h=Math.max(h,this._pivotRadius)),We.grow(n,-l,-h),this._calcluateCenterAndRadius(n),t.lineWidth=0,null==this._colorRangeList||0==this._colorRangeList.size())this._drawArcGroup(t,this._startAngleByRadian,this._endAngleByRadian,this.getUniqueColor(this._colorRangeFillColor)),this._drawArcOutLine(t,this._startAngleByRadian,this._endAngleByRadian,!0,!0);else{var d=this._angleRange/this._colorRangeList.size(),f=this._startAngleByRadian;for(o=0;o<this._colorRangeList.size();o++){var p=this.getUniqueColor(this._colorRangeList.get(o)),g=f+(this._clockwise?-1:1)*d;this._drawArcGroup(t,f,g,p),this._drawArcOutLine(t,f,f+(this._clockwise?-1:1)*d,0==o,o==this._colorRangeList.size()-1),f+=(this._clockwise?-1:1)*d}}var _,m,v,y,w,b,x,A,C=this._startAngleByRadian,T=this._majorScaleCount>1?this._angleRange/(this._majorScaleCount-1):0;for(b=this._scaleInside?this._innerRadiusByPixel:this._outerRadius,x=b+this._majorScaleLineLength*(this._scaleInside?1:-1),A=b+this._minorScaleLineLength*(this._scaleInside?1:-1),o=0;o<this._majorScaleCount;o++){if(m=this._center.x+Math.cos(C)*b,v=this._center.y+Math.sin(-C)*b,y=this._center.x+Math.cos(C)*x,w=this._center.y+Math.sin(-C)*x,t.lineWidth=this._majorScaleLineWidth,t.strokeStyle=this.getUniqueColor(this._majorScaleLineColor),t.beginPath(),t.moveTo(m,v),t.lineTo(y,w),t.closePath(),t.stroke(),this._scaleTextVisible)if(0==o&&!this._scaleLowerLimitTextVisible||o==this._majorScaleCount-1&&!this._scaleUpperLimitTextVisible);else{var k=c.get(o);if(k){var S=this.getScaleTextPosition(C/Math.PI*180,m,v,k.size.width,k.size.height);k.x=S.x,k.y=S.y}}if(this._whole||!this._whole&&o<this._majorScaleCount-1){var E=C,I=this._minorScaleCount>0?T/(this._minorScaleCount+1):0;for(_=0;_<this._minorScaleCount;_++)E+=(this._clockwise?-1:1)*I,m=this._center.x+Math.cos(E)*b,v=this._center.y+Math.sin(-E)*b,y=this._center.x+Math.cos(E)*A,w=this._center.y+Math.sin(-E)*A,t.lineWidth=this._minorScaleLineWidth,t.strokeStyle=this.getUniqueColor(this._minorScaleLineColor),t.beginPath(),t.moveTo(m,v),t.lineTo(y,w),t.closePath(),t.stroke()}C+=(this._clockwise?-1:1)*T}this._pivotFill&&Ye.fill(t,this.getUniqueColor(this._pivotFillColor),this._pivotGradient,this._pivotGradientColor,this._center.x-this._pivotRadius,this._center.y-this._pivotRadius,2*this._pivotRadius,2*this._pivotRadius),t.lineWidth=this._pivotOutlineWidth,t.strokeStyle=this.getUniqueColor(this._pivotOutlineColor),t.beginPath(),t.arc(this._center.x,this._center.y,this._pivotRadius,0,2*Math.PI,!0),t.closePath(),this._pivotFill&&t.fill(),c&&c.forEach(function(e){e&&Ye.drawText(t,e.text,e,this._scaleTextFont,this._scaleTextColor)},this),this._publishedDatas.forEach(function(e){var i=this._map[e.getId()],n=this._getDataStyle("dialchart.rear.extension",e),o=this._getDataStyle("dialchart.base.width",e),r=this._getDataStyle("dialchart.top.width",e),a=this._getDataStyle("dialchart.radius",e);a>=-1&&1>=a&&(a*=this._innerRadiusByPixel),t.fillStyle=i.color,t.lineWidth=0;var s=We.createMatrix(-i.angle,this._center.x,this._center.y),l=s.transform(this._center.x+a,this._center.y+r/2),h=s.transform(this._center.x+a,this._center.y-r/2),c=s.transform(this._center.x-n,this._center.y-o/2),u=s.transform(this._center.x-n,this._center.y+o/2),d=this._selectShadowOffset;this.isSelected(e)&&d>0?(t.shadowOffsetX=d,t.shadowOffsetY=d,t.shadowBlur=2*d,t.shadowColor=this._selectShadowColor):(t.shadowOffsetX=0,t.shadowOffsetY=0,t.shadowBlur=0,t.shadowColor=i.color),t.beginPath(),t.moveTo(l.x,l.y),t.lineTo(h.x,h.y),t.lineTo(c.x,c.y),t.lineTo(u.x,u.y),t.lineTo(l.x,l.y),t.closePath(),t.fill();var f=this._getValueTextInfo(e,i.value);if(f){var p=s.transform(this._center.x+a*this._valuePosition,this._center.y);f.x=p.x,f.y=p.y}},this),this.drawValueTexts(t)}},_getDataStyle:function(t,e){return e.getStyle?e.getStyle(t):e.getClient(t)},_calcluateCenterAndRadius:function(t){var e=this._clockwise?this._positiveEndAngle:this._positiveStartAngle,i=this._clockwise?this._positiveStartAngle:this._positiveEndAngle;Math.abs(this._positiveEndAngle-this._positiveStartAngle),e>=0&&90>e?i>=0&&90>=i?(this._outerRadius=Math.min(t.width,t.height),this._center={x:t.x+(t.width-this._outerRadius)/2,y:t.y+(t.height+this._outerRadius)/2}):i>90&&180>=i?(this._outerRadius=Math.min(t.width/2,t.height),this._center={x:t.x+t.width/2,y:t.y+(t.height+this._outerRadius)/2}):(this._center={x:t.x+t.width/2,y:t.y+t.height/2},this._outerRadius=Math.min(t.width,t.height)/2):e>=90&&180>e?i>=90&&180>=i?(this._outerRadius=Math.min(t.width,t.height),this._center={x:t.x+(t.width+this._outerRadius)/2,y:t.y+(t.height+this._outerRadius)/2}):i>180&&270>=i?(this._outerRadius=Math.min(t.width,t.height/2),this._center={x:t.x+(t.width+this._outerRadius)/2,y:t.y+t.height/2}):(this._center={x:t.x+t.width/2,y:t.y+t.height/2},this._outerRadius=Math.min(t.width,t.height)/2):e>=180&&270>e?i>=180&&270>=i?(this._outerRadius=Math.min(t.width,t.height),this._center={x:t.x+(t.width+this._outerRadius)/2,y:t.y+(t.height-this._outerRadius)/2}):(this._outerRadius=Math.min(t.width/2,t.height),this._center={x:t.x+t.width/2,y:t.y+(t.height-this._outerRadius)/2}):(this._outerRadius=Math.min(t.width,t.height),this._center={x:t.x+(t.width-this._outerRadius)/2,y:t.y+(t.height-this._outerRadius)/2}),this._innerRadiusByPixel=this._innerRadius>1?this._innerRadius:this._outerRadius*this._innerRadius,this._innerDarkerRadiusByPixel=this._innerDarkerRadius>1?this._innerDarkerRadius:this._outerRadius*this._innerDarkerRadius,this._outerBrighterRadiusByPixel=this._outerBrighterRadius>1?this._outerBrighterRadius:this._outerRadius*this._outerBrighterRadius},_drawArcOutLine:function(t,e,i,n,o){if(!(this._outlineWidth<=0)){var r=Math.abs(e-i),a=this._center.x+Math.cos(e)*this._innerRadiusByPixel,s=this._center.y+Math.sin(-e)*this._innerRadiusByPixel,l=this._center.x+Math.cos(e)*this._outerRadius,h=this._center.y+Math.sin(-e)*this._outerRadius,c=this._center.x+Math.cos(i)*this._innerRadiusByPixel,u=this._center.y+Math.sin(-i)*this._innerRadiusByPixel,d=this._center.x+Math.cos(i)*this._outerRadius,f=this._center.y+Math.sin(-i)*this._outerRadius;this._clockwise?(t.lineWidth=this._outlineWidth,t.strokeStyle=this.getUniqueColor(this._outlineColor),t.beginPath(),t.moveTo(this._center.x,this._center.y),Ye.drawArc(t,this._center.x,this._center.y,i,r,this._outerRadius,this._outerRadius,!1),t.stroke(),!this._whole&&n?(t.lineWidth=this._outlineWidth,t.strokeStyle=this.getUniqueColor(this._outlineColor)):t.lineWidth=0,t.lineTo(a,s),t.stroke(),t.beginPath(),t.lineWidth=this._outlineWidth,t.strokeStyle=this.getUniqueColor(this._outlineColor),t.moveTo(this._center.x,this._center.y),Ye.drawArc(t,this._center.x,this._center.y,e,-r,this._innerRadiusByPixel,this._innerRadiusByPixel,!1),t.stroke(),!this._whole&&o?(t.lineWidth=this._outlineWidth,t.strokeStyle=this.getUniqueColor(this._outlineColor)):t.lineWidth=0,t.lineTo(d,f),t.stroke()):(t.lineWidth=this._outlineWidth,t.strokeStyle=this.getUniqueColor(this._outlineColor),t.beginPath(),t.moveTo(this._center.x,this._center.y),Ye.drawArc(t,this._center.x,this._center.y,e,r,this._outerRadius,this._outerRadius,!1),t.stroke(),!this._whole&&o?(t.lineWidth=this._outlineWidth,t.strokeStyle=this.getUniqueColor(this._outlineColor)):t.lineWidth=0,t.lineTo(c,u),t.stroke(),t.lineWidth=this._outlineWidth,t.strokeStyle=this.getUniqueColor(this._outlineColor),t.beginPath(),t.moveTo(this._center.x,this._center.y),Ye.drawArc(t,this._center.x,this._center.y,i,-r,this._innerRadiusByPixel,this._innerRadiusByPixel,!1),t.stroke(),!this._whole&&n?(t.lineWidth=this._outlineWidth,t.strokeStyle=this.getUniqueColor(this._outlineColor)):t.lineWidth=0,t.lineTo(l,h),t.stroke())}},_drawArcGroup:function(t,e,i,n){0!=this._outerBrighterRadiusByPixel&&this._drawArc(t,e,i,this._outerRadius-this._outerBrighterRadiusByPixel,this._outerRadius,Ye.brighter(n)),this._drawArc(t,e,i,this._innerRadiusByPixel+this._innerDarkerRadiusByPixel,this._outerRadius-this._outerBrighterRadiusByPixel,n),0!=this._innerDarkerRadiusByPixel&&this._drawArc(t,e,i,this._innerRadiusByPixel,this._innerRadiusByPixel+this._innerDarkerRadiusByPixel,Ye.darker(n,20))},_drawArc:function(t,e,i,n,o,r){var a=Math.abs(e-i);t.lineWidth=0,t.fillStyle=r;var s=this._center.x+Math.cos(e)*n,l=this._center.y+Math.sin(-e)*n,h=(this._center.x,Math.cos(e),this._center.y,Math.sin(-e),this._center.x+Math.cos(i)*n),c=this._center.y+Math.sin(-i)*n;this._center.x,Math.cos(i),this._center.y,Math.sin(-i),t.beginPath(),this._clockwise?(t.moveTo(h,c),Ye.drawArc(t,this._center.x,this._center.y,i,a,o,o,!0),t.lineTo(s,l),Ye.drawArc(t,this._center.x,this._center.y,e,-a,n,n,!0),t.closePath()):(t.moveTo(s,l),Ye.drawArc(t,this._center.x,this._center.y,e,a,o,o,!0),t.lineTo(h,c),Ye.drawArc(t,this._center.x,this._center.y,i,-a,n,n,!0),t.closePath()),t.fill()},getScaleTextPosition:function(t,e,i,n,o){t=(t%360+360)%360;var r={x:e,y:i};return 0==t&&(r=this._scaleInside?{x:e-n/2,y:i}:{x:e+n/2,y:i}),180==t&&(r=this._scaleInside?{x:e+n/2,y:i}:{x:e-n/2,y:i}),90==t&&(r=this._scaleInside?{x:e,y:i+o/2}:{x:e,y:i-o/2}),270==t&&(r=this._scaleInside?{x:e,y:i-o/2}:{x:e,y:i+o/2}),t>270&&360>t&&(r=this._scaleInside?{x:e-n/2,y:i-o/2}:{x:e+n/2,y:i+o/2}),t>180&&270>t&&(r=this._scaleInside?{x:e+n/2,y:i-o/2}:{x:e-n/2,y:i+o/2}),t>90&&180>t&&(r=this._scaleInside?{x:e+n/2,y:i+o/2}:{x:e-n/2,y:i-o/2}),t>0&&90>t&&(r=this._scaleInside?{x:e-n/2,y:i+o/2}:{x:e+n/2,y:i-o/2}),r}}),De.charts.RadarChart=function(t){De.charts.RadarChart.superClass.constructor.apply(this,arguments),this._selectTolerance=2},Me.ext("twaver.charts.RadarChart",De.charts.ChartBase,{__accessor:["axisTextVisible","axisTextFont","axisTextColor","scaleTextVisible","scaleTextFont","scaleTextColor","axisVisible","axisLineColor","axisLineWidth","axisStartAngle","ringVisible","ringType","ringLineColor","ringLineWidth","scaleCount","scaleMaxValue","scaleMinValue","anchorVisible","areaFillAlpha","areaSelectFillAlpha","axisList"],__bool:["areaFill"],_axisTextVisible:kn.RADARCHART_AXIS_TEXT_VISIBLE,_axisTextFont:kn.RADARCHART_AXIS_TEXT_FONT,_axisTextColor:kn.RADARCHART_AXIS_TEXT_COLOR,_scaleTextVisible:kn.RADARCHART_SCALE_TEXT_VISIBLE,_scaleTextFont:kn.RADARCHART_SCALE_TEXT_FONT,_scaleTextColor:kn.RADARCHART_SCALE_TEXT_COLOR,_axisVisible:kn.RADARCHART_AXIS_VISIBLE,_axisLineColor:kn.RADARCHART_AXIS_LINE_COLOR,_axisLineWidth:kn.RADARCHART_AXIS_LINE_WIDTH,_axisStartAngle:kn.RADARCHART_AXIS_START_ANGLE,_ringVisible:kn.RADARCHART_RING_VISIBLE,_ringType:kn.RADARCHART_RING_TYPE,_ringLineColor:kn.RADARCHART_RING_LINE_COLOR,_ringLineWidth:kn.RADARCHART_RING_LINE_WIDTH,_scaleCount:kn.RADARCHART_SCALE_COUNT,_scaleMaxValue:kn.RADARCHART_SCALE_MAXVALUE,_scaleMinValue:kn.RADARCHART_SCALE_MINVALUE,_anchorVisible:kn.RADARCHART_ANCHOR_VISIBLE,_areaFill:kn.RADARCHART_AREA_FILL,_areaFillAlpha:kn.RADARCHART_AREA_FILL_ALPHA,_areaSelectFillAlpha:kn.RADARCHART_AREA_SELECT_FILL_ALPHA,getAxisCount:function(){return this._axisCount},formatScaleText:function(t,e){return t.toFixed(2)},getAnchorSize:function(t){return t.getStyle?t.getStyle("chart.marker.size"):De.Styles.getStyle("chart.marker.size")},getAnchorShape:function(t){return t.getStyle?t.getStyle("chart.marker.shape"):De.Styles.getStyle("chart.marker.shape")},getLineWidth:function(t){return t.getStyle?t.getStyle("chart.line.width"):De.Styles.getStyle("chart.line.width")},getValues:function(t){return t.getStyle?t.getStyle("chart.values"):null},tryGetDataAt:function(t,e){if((null==e||0>e)&&(e=this._selectTolerance),t.target&&(t=Xe.getLogicalPoint(this._canvas,arguments[0],1)),!t)return null;if(!this._areaFill){var i=t.x-e,n=t.y-e,o=2*e+1,r=2*e+1;try{for(var a=this._canvas.getContext("2d").getImageData(i,n,o,r).data,s=0,l=a.length;l>s;s+=4)if(255===a[s+3]){var h="rgb("+a[s]+","+a[s+1]+","+a[s+2]+")",c=this._uniqueColors[h];if(c)return c}}catch(t){}return null}if(!this._center)return null;t={x:t.x-this._xTranslate,y:t.y-this._yTranslate};for(var s=this._publishedDatas.size()-1;s>=0;s--){var c=this._publishedDatas.get(s),u=this._map[c.getId()];if(We.isPointInPolygon(u.points,t))return c}return null},getDataAt:function(){var t,e;if(2===arguments.length)t=arguments[0],e=arguments[1];else if(arguments[0].target){var i=Xe.getLogicalPoint(this._canvas,arguments[0],1);if(!i)return;t=i.x,e=i.y}else t=arguments[0].x,e=arguments[0].y;if(0>t||0>e||t>this._canvasWidth||e>this._canvasHeight)return null;if(!this._areaFill){try{var n=this._canvas.getContext("2d").getImageData(t,e,1,1).data;if(255===n[3]){var o="rgb("+n[0]+","+n[1]+","+n[2]+")",r=this._uniqueColors[o];if(r)return r}}catch(t){}return null}for(var a=this._publishedDatas.size()-1;a>=0;a--){var r=this._publishedDatas.get(a),s=this._map[r.getId()];if(We.isPointInPolygon(s.points,{x:t-this._xTranslate,y:e-this._yTranslate}))return r}return null},validateModel:function(){if(this._map={},this._axisTexts=new hn,this._axisMaxValues=new hn,this._axisMinValues=new hn,this._axisRangeValues=new hn,this._axisCount=null==this._axisList?0:this._axisList.size(),0!=this._axisCount){this._averageAngleByRadian=2*Math.PI/this._axisCount,this._averageAngle=360/this._axisCount,this._axisList.forEach(function(t){if("string"==typeof t)this._axisTexts.add(t),this._axisMaxValues.add(this._scaleMaxValue),this._axisMinValues.add(this._scaleMinValue),this._axisRangeValues.add(this._scaleMaxValue-this._scaleMinValue);else{this._axisTexts.add(t.text);var e=isNaN(t.max)?this._scaleMaxValue:t.max,i=isNaN(t.min)?this._scaleMinValue:t.min;this._axisMaxValues.add(e),this._axisMinValues.add(i),this._axisRangeValues.add(e-i)}},this),this._publishedDatas.forEach(function(t){var e=new hn(this.getValues(t)),i={data:t,values:e,proportions:new hn,color:this.getUniqueColor(this.getColor(t),t),anchorShape:this.getAnchorShape(t),anchorSize:this.getAnchorSize(t),lineWidth:this.getLineWidth(t),points:new hn};this.isSelected(t)&&(i.lineWidth+=2),this._map[t.getId()]=i},this);for(var t=0;t<this._axisCount;t++)this._publishedDatas.forEach(function(e){var i=this._map[e.getId()],n=0;if(i.values.size()>t){var o=i.values.get(t),r=this._axisMinValues.get(t),a=this._axisRangeValues.get(t);a>0&&(n=(o-r)/a)}i.proportions.add(n)},this)}},validateDisplay:function(t,e,i){var n={x:this._xGap,y:this._yGap,width:e-2*this._xGap,height:i-2*this._yGap};if(this.drawBackground(t,n),!(n.width<=0||n.height<=0||this._axisCount<3)){var o=0,r=0,a=0,s=null,l=null,h=null,c=null;if(this._axisTextVisible)for(c=new hn,a=0;a<this._axisCount;a++)h=this._axisTexts.get(a),s=this.getTextSize(this._axisTextFont,h),c.add({text:h,size:s}),s.width>o&&(o=s.width),s.height>r&&(r=s.height);var u=n.width/2-o>n.height/2-r?n.height/2-2*r:n.width/2-o,d={x:n.x+n.width/2,y:n.y+n.height/2};this._center={x:d.x+this._xTranslate,y:d.y+this._yTranslate};var f=null;this._scaleTextVisible&&(f=new hn);var p=this._axisStartAngle/180*Math.PI;for(a=0;a<this._axisCount;a++){var g=180*p/Math.PI,_=d.x+Math.cos(p)*u,m=d.y+Math.sin(-p)*u,v=null;f&&(v=new hn,f.add(v)),this._ringVisible&&this._ringLineWidth>0&&(t.lineWidth=this._ringLineWidth,t.strokeStyle=this._ringLineColor);for(var y=1;y<=this._scaleCount;y++){var w=y/this._scaleCount,b=u*w,x=d.x+Math.cos(p)*b,A=d.y+Math.sin(-p)*b;if(this._ringVisible&&this._ringLineWidth>0){var C=d.x+Math.cos(p+this._averageAngleByRadian)*b,T=d.y+Math.sin(-p-this._averageAngleByRadian)*b;"line"==this._ringType?this.drawLine(t,this._ringLineColor,this._ringLineWidth,x,A,C,T):"arc"==this._ringType&&(t.beginPath(),t.moveTo(d.x,d.y),Ye.drawArc(t,d.x,d.y,p,this._averageAngleByRadian,b,b,!0),t.closePath(),t.stroke())}v&&(h=this.formatScaleText(this._axisMinValues.get(a)+this._axisRangeValues.get(a)*w,a),s=this.getTextSize(this._scaleTextFont,h),l=this.getScaleTextPosition(g,x,A,s.width,s.height),v.add({text:h,x:l.x,y:l.y}))}if(this._axisVisible&&this.drawLine(t,this._axisLineColor,this._axisLineWidth,d.x,d.y,_,m),c){var k=c.get(a);l=this.getAxisTextPosition(g,_,m,k.size.width,k.size.height),k.x=l.x,k.y=l.y}p+=this._averageAngleByRadian}this._publishedDatas.forEach(function(e){var i=this._map[e.getId()];i.points.clear();var n=i.anchorSize>0?new hn:null,o=i.proportions;if(t.lineWidth=0,t.globalAlpha=this.isSelected(e)?this._areaSelectFillAlpha:this._areaFillAlpha,this._areaFill&&(t.fillStyle=i.color),this._drawItem(t,o,d,u,n,i),this._areaFill&&t.fill(),t.lineWidth=i.lineWidth,t.strokeStyle=i.color,t.globalAlpha=1,this._drawItem(t,o,d,u),t.lineWidth=0,null!=n&&n.size()>0){var r=i.anchorSize/2;n.forEach(function(e){t.fillStyle=i.color,Ye.drawVector(t,i.anchorShape,null,e.x-r,e.y-r,i.anchorSize,i.anchorSize),t.fill()})}},this),f&&f.forEach(function(e){e.forEach(function(e){Ye.drawText(t,e.text,e,this._scaleTextFont,this._scaleTextColor)},this)},this),c&&c.forEach(function(e){Ye.drawText(t,e.text,e,this._axisTextFont,this._axisTextColor)},this)}},_drawItem:function(t,e,i,n,o,r){var a=this._axisStartAngle/180*Math.PI,s=null;t.beginPath();for(var l=0;l<this._axisCount;l++){var h=e.get(l),c={x:i.x+Math.cos(a)*n*h,y:i.y+Math.sin(-a)*n*h};null==s?t.moveTo(c.x,c.y):t.lineTo(c.x,c.y),null!=o&&this._anchorVisible&&o.add(c),r&&r.points.add(c),0==l&&(s=c),a+=this._averageAngleByRadian}null!=s&&t.lineTo(s.x,s.y),t.closePath(),t.stroke()},getAxisTextPosition:function(t,e,i,n,o){t=(t%360+360)%360;var r={x:e,y:i};return 0==t&&(r={x:e+n/2,y:i}),180==t&&(r={x:e-n/2,y:i}),90==t&&(r={x:e,y:i-o/2}),270==t&&(r={x:e,y:i+o/2}),t>270&&360>t&&(r={x:e+n/2,y:i+o/2}),t>180&&270>t&&(r={x:e-n/2,y:i+o/2}),t>90&&180>t&&(r={x:e-n/2,y:i-o/2}),t>0&&90>t&&(r={x:e+n/2,y:i-o/2}),r},getScaleTextPosition:function(t,e,i,n,o){t=(t%360+360)%360;var r={x:e,y:i};return 0==t&&(r={x:e,y:i+o/2}),180==t&&(r={x:e-n/2,y:i+o/2}),90==t&&(r={x:e+n/2,y:i}),270==t&&(r={x:e+n/2,y:i}),t>270&&360>t&&(r={x:e+n/2,y:i-o/2}),t>180&&270>t&&(r={x:e-n/2,y:i-o/2}),t>90&&180>t&&(r={x:e-n/2,y:i+o/2}),t>0&&90>t&&(r={x:e+n/2,y:i+o/2}),r}}),De.charts.LegendPane=function(t){De.charts.LegendPane.superClass.constructor.apply(this,arguments),this._divPool=new De.Pool("div"),this._iconPool=new De.Pool("div"),this._textPool=new De.Pool("span"),this._pools.add(this._divPool),this._pools.add(this._iconPool),this._pools.add(this._textPool),this._chart=t,this._chart.addViewListener(this.handleViewChange,this),this._view=Xe.createView("hidden"),this._view.style.verticalAlign="middle",this._legendDiv=Xe.createDiv(),this._legendDiv.style.whiteSpace="nowrap",this._legendDiv.style.verticalAlign="middle",this._legendDiv.style.position="",this._view.appendChild(this._legendDiv),this._hiddenMap={};var e=this;this._chart._internalVisibleFunction=function(t){return!e.isHidden(t)},Ue.isTouchable&&new De.charts.LegendPaneTouchInteraction(this),new De.charts.LegendPaneInteraction(this)},Me.ext("twaver.charts.LegendPane",De.controls.ControlBase,{__accessor:["iconWidth","iconHeight","iconRadius","rowHeight","orientation","hiddenColor","selectBackgroundColor","selectForegroundColor"],_iconWidth:kn.LEGENDPANE_ICON_WIDTH,_iconHeight:kn.LEGENDPANE_ICON_HEIGHT,_iconRadius:kn.LEGENDPANE_ICON_RADIUS,_rowHeight:kn.LEGENDPANE_ROW_HEIGHT,_orientation:kn.LEGENDPANE_ORIENTATION,_hiddenColor:kn.LEGENDPANE_HIDDEN_COLOR,_selectBackgroundColor:kn.LEGENDPANE_SELECT_BACKGROUND_COLOR,_selectForegroundColor:kn.LEGENDPANE_SELECT_FOREGROUND_COLOR,onPropertyChanged:function(t){this.invalidate()},getChart:function(){return this._chart},isHidden:function(t){return null!=this._hiddenMap[t.getId()]},handleViewChange:function(t){"validateEnd"===t.kind&&(this._invalidate=!0,this.validate())},validate:function(){if(this._invalidate){this._invalidate=!1,Xe.release(this._legendDiv),Me.keys(this._hiddenMap).forEach(function(t){this._chart.getDataBox().containsById(t)||delete this._hiddenMap[t]},this);for(var t=new hn(this._chart.getUnfilteredDatas()),e=0;e<t.size();e++){var i=t.get(e);this._chart.isVisible(i)||this.isHidden(i)||(t.removeAt(e),e--)}var n=t.size(),o=this._view.style,r="horizontal"===this._orientation;for(r?(o.textAlign="center",o.height=this._rowHeight+"px"):(o.textAlign="",o.height=this._rowHeight*n+"px"),o.lineHeight=this._rowHeight-2+"px",e=0;n>e;e++){var i=t.get(e),a=this._divPool.get();a._data=i,a.style.cursor="pointer",a.style.height=this._rowHeight+"px",a.style.display=r?"inline-block":"block",this._legendDiv.appendChild(a),this.renderLegend(a,i),this.onLegendRendered(a,i)}this._pools.forEach(function(t){t.clear()})}},renderLegend:function(t,e){var i=!this.isHidden(e),n=this._chart.isSelected(e),o=this._iconPool.get(),r=o.style;r.display="inline-block",r.verticalAlign="middle",r.marginLeft="4px",r.width=this.getIconWidth()+"px",r.height=this.getIconHeight()+"px",r.backgroundColor=i?this._chart.getColor(e):this.getHiddenColor(),t.appendChild(o);var a=this._textPool.get();r=a.style,r.paddingLeft="2px",r.paddingRight="4px",r.display="inline-block",r.verticalAlign="middle",r.color=i?n?this._selectForegroundColor:"":this.getHiddenColor(),a.innerHTML=this._chart.getName(e),t.appendChild(a),t.style.backgroundColor=i&&n?this._selectBackgroundColor:""},onLegendRendered:function(t,e){}}),De.charts.ChartPane=function(t,e,i,n){De.charts.ChartPane.superClass.constructor.apply(this,arguments),this.invalidate(),this._chart=t,this._legendPane=new De.charts.LegendPane(t),this._titleDiv=Xe.createDiv(),this._titleDiv.style.verticalAlign="middle",this._titleDiv.style.whiteSpace="nowrap",this._view=Xe.createView("hidden"),this._view.appendChild(this._titleDiv),this._view.appendChild(this._legendPane.getView()),this._view.appendChild(this._chart.getView());var o=this;this._legendPane.addPropertyChangeListener(function(t){("rowHeight"===t.property||"orientation"===t.porperty)&&o.invalidate()}),arguments.length>1&&this.setTitle(e),arguments.length>2&&this.setLegendOrientation(i),arguments.length>3&&this.setLegendWidth(n)},Me.ext("twaver.charts.ChartPane",De.controls.ControlBase,{__accessor:["title","titleHorizontalAlign","titleHeight","legendWidth"],_title:null,_titleHeight:kn.CHARTPANE_TITLE_HEIGHT,_titleHorizontalAlign:kn.CHARTPANE_TITLE_HORIZONTAL_ALIGN,_legendOrientation:kn.CHARTPANE_LEGEND_ORIENTATION,_legendWidth:kn.CHARTPANE_LEGEND_WIDTH,getLegendOrientation:function(){return this._legendOrientation},setLegendOrientation:function(t){if(this._legendOrientation!==t){var e=this._legendOrientation;this._legendOrientation=t,this.firePropertyChange("orientation",e,t),this._adjustLegendOrientation()}},_adjustLegendOrientation:function(){this._legendPane.setOrientation("left"===this._legendOrientation||"right"===this._legendOrientation?"vertical":"horizontal")},onPropertyChanged:function(t){this.invalidate()},getTitleDiv:function(){return this._titleDiv},getChart:function(){return this._chart},getLegendPane:function(){return this._legendPane},validateImpl:function(){this._adjustLegendOrientation();var t,e=this._view.offsetWidth,i=this._view.offsetHeight,n=this._legendPane.getRowHeight();this._title&&""!==this._title?(t=this._titleHeight,this._titleDiv.innerHTML=this._title):(t=0,this._titleDiv.innerHTML=""),this._titleDiv.innerHTML=this._title?this._title:"",this._titleDiv.style.textAlign=this._titleHorizontalAlign,this._titleDiv.style.lineHeight=this._titleHeight-2+"px";var o=this._titleDiv.style;o.left="0px",o.top="0px",o.width=e+"px",o.height=t+"px";var r,a;"bottom"===this._legendOrientation?(r={x:0,y:t,width:e,height:Math.max(i-t-n,0)},a={x:0,y:Math.max(i-n,0),width:e,height:n}):"right"===this._legendOrientation?(r={x:0,y:t,width:Math.max(e-this._legendWidth,0),height:Math.max(i-t,0)},a={x:Math.max(e-this._legendWidth,0),y:t,width:this._legendWidth,height:Math.max(i-t,0)}):"top"===this._legendOrientation?(r={x:0,y:t+n,width:e,height:Math.max(i-t-n,0)},a={x:0,y:t,width:e,height:n}):"left"===this._legendOrientation&&(r={x:this._legendWidth,y:t,width:Math.max(e-this._legendWidth,0),height:Math.max(i-t,0)},a={x:0,y:t,width:this._legendWidth,height:Math.max(i-t,0)}),r&&this._chart.adjustBounds(r),a&&this._legendPane.adjustBounds(a)}}),De.charts.ChartInteraction=function(t){this.chart=t,this.canvas=t._canvas;var e=this;this.canvas.addEventListener("mousedown",function(t){0===t.button&&e.handleMouseDown(t),t.preventDefault()},!1);var i=Ue.isFirefox?"DOMMouseScroll":"mousewheel";this.canvas.addEventListener(i,function(t){e.handleMouseWheel(t)},!1)},Me.ext("twaver.charts.ChartInteraction",Object,{handleMouseDown:function(t){this.chart.isFocusOnClick()&&De.Util.setFocus(this.canvas),this.lastPoint=this.chart.getLogicalPoint(t);var e=this.chart.tryGetDataAt(t);2===t.detail&&null==e?this.chart.isDoubleClickToReset()&&(this.chart.zoomReset(!1),this.chart.setXTranslate(0),this.chart.setYTranslate(0)):(this._startLogical=this.lastPoint,this._startClient=Xe.getClientPoint(t),Xe.handle_mousedown(this,t))},handleMouseMove:function(t){if(this.lastPoint){var e={x:this._startLogical.x+t.clientX-this._startClient.x,y:this._startLogical.y+t.clientY-this._startClient.y};!this.startPan&&We.getDistance(this.lastPoint,e)>3&&(this.startPan=!0,this.lastPoint=e),this.startPan&&(this.chart.isXTranslateEnabled()&&this.chart.setXTranslate(this.chart.getXTranslate()+e.x-this.lastPoint.x),this.chart.isYTranslateEnabled()&&this.chart.setYTranslate(this.chart.getYTranslate()+e.y-this.lastPoint.y),this.lastPoint=e)}},handleMouseUp:function(t){if(!this.startPan&&1===t.detail){var e=this.chart.tryGetDataAt(t),i=this.chart.getSelectionModel();e?Me.isCtrlDown(t)?i.contains(e)?i.removeSelection(e):i.appendSelection(e):i.contains(e)||i.setSelection(e):Me.isCtrlDown(t)||i.clearSelection()}delete this.lastPoint,delete this.startPan,delete this._startClient,delete this._startLogical},handleMouseWheel:function(t){Xe.preventDefault(t);var e=Ue.isFirefox?-t.detail:t.wheelDelta;e>0?(this.chart.isXZoomEnabled()&&this.chart.setXZoom(1.1*this.chart.getXZoom(),!1),this.chart.isYZoomEnabled()&&this.chart.setYZoom(1.1*this.chart.getYZoom(),!1)):0>e&&(this.chart.isXZoomEnabled()&&this.chart.setXZoom(this.chart.getXZoom()/1.1,!1),this.chart.isYZoomEnabled()&&this.chart.setYZoom(this.chart.getYZoom()/1.1,!1))}}),De.charts.ChartTouchInteraction=function(t){this.chart=t,this.canvas=t._canvas,Xe.addEventListener("touchstart","handleTouchstart",this.canvas,this)},Me.ext("twaver.charts.ChartTouchInteraction",Object,{handleTouchstart:function(t){Xe.preventDefault(t),this.chart.isFocusOnClick()&&De.Util.setFocus(this.canvas),this.endPoint=this.chart.getLogicalPoint(t),wi.isMultiTouch(t)&&(this.distance=wi.getDistance(t),this.xZoom=this.chart.getXZoom(),this.yZoom=this.chart.getYZoom()),Xe.addEventListener("touchmove","handleTouchmove",this.canvas,this),Xe.addEventListener("touchend","handleTouchend",this.canvas,this)},handleTouchmove:function(t){if(Xe.preventDefault(t),this.endPoint){var e=this.chart.getLogicalPoint(t);if(!this.moved&&We.getDistance(this.endPoint,e)>10&&(this.moved=!0,this.lastPoint=e),this.moved)if(wi.isSingleTouch(t))this.endPoint&&(this.chart.isXTranslateEnabled()&&this.chart.setXTranslate(this.chart.getXTranslate()+e.x-this.endPoint.x),this.chart.isYTranslateEnabled()&&this.chart.setYTranslate(this.chart.getYTranslate()+e.y-this.endPoint.y),this.endPoint=e);else if(this.distance){var i=wi.getDistance(t)/this.distance,n=this.xZoom*i,o=this.yZoom*i;this.chart.isXZoomEnabled()&&this.chart.setXZoom(n,!1),this.chart.isYZoomEnabled()&&this.chart.setYZoom(o,!1)}}},handleTouchend:function(t){if(Xe.preventDefault(t),!this.moved){this.endPoint=this.chart.getLogicalPoint(t);var e=this.lastPoint&&this.lastTouchStartTime&&(new Date).getTime()-this.lastTouchStartTime.getTime()<=300&&Math.abs(this.endPoint.x-this.lastPoint.x)<=10&&Math.abs(this.endPoint.y-this.lastPoint.y)<=10;e?(this.lastPoint=null,this.lastTouchStartTime=null):(this.lastPoint=this.endPoint,this.lastTouchStartTime=new Date);var i=this.chart.tryGetDataAt(t);if(e&&null==i)this.chart.isDoubleClickToReset()&&(this.chart.zoomReset(!1),this.chart.setXTranslate(0),this.chart.setYTranslate(0));else{var n=this.chart.getSelectionModel();i?n.contains(i)||n.setSelection(i):n.clearSelection()}}delete this.endPoint,delete this.distance,delete this.xZoom,delete this.yZoom,delete this.moved,Xe.removeEventListener("touchmove",this.canvas,this),Xe.removeEventListener("touchend",this.canvas,this)}}),De.charts.ChartMSTouchInteraction=function(t){this.chart=t,this.canvas=t._canvas,this._pointerMap={},this._pointerIdArray=[],Xe.addEventListener("MSPointerDown","handleTouchstart",this.canvas,this),Xe.addEventListener("MSPointerMove","handleTouchmove",this.canvas,this),Xe.addEventListener("MSPointerUp","handleTouchend",this.canvas,this),Xe.addEventListener("MSPointerCancel","handleTouchend",this.canvas,this);var e=Ue.isFirefox?"DOMMouseScroll":"mousewheel";this.canvas.addEventListener(e,function(t){self.handleMouseWheel(t)},!1)},Me.ext("twaver.charts.ChartMSTouchInteraction",Object,{handleTouchstart:function(t){this.chart.isFocusOnClick()&&De.Util.setFocus(this.canvas);var e=this.chart.getLogicalPoint(t);t.isPrimary&&this._pointerIdArray.length>0&&(this._pointerMap={},this._pointerIdArray=[]),!this._pointerMap[t.pointerId]&&e&&(this._pointerIdArray.push(t.pointerId),this._pointerMap[t.pointerId]=t);var i=this.chart.tryGetDataAt(t);if(1==this._pointerIdArray.length&&e){this._startTouchPoint&&this._startTouchTime&&(new Date).getTime()-this._startTouchTime.getTime()<=500&&We.getDistance(this._startTouchPoint,e)<=10&&null==i?this.chart.isDoubleClickToReset()&&(this.chart.zoomReset(!1),this.chart.setXTranslate(0),this.chart.setYTranslate(0),this._startTouchPoint=null,this._startTouchTime=null,this._startClientPoint=null):(this._startTouchPoint=e,this._startTouchTime=new Date,this._startClientPoint={x:t.clientX,y:t.clientY},Xe.handle_mousedown(this,t))}else 2==this._pointerIdArray.length&&(this.xZoom=this.chart.getXZoom(),this.yZoom=this.chart.getYZoom(),this._distance=this._getDistance())},handleTouchmove:function(t){if(0!=this._pointerIdArray.length&&this._pointerMap[t.pointerId]&&!(We.getDistance({x:this._pointerMap[t.pointerId].pageX,y:this._pointerMap[t.pointerId].pageY},{x:t.pageX,y:t.pageY})<=3)&&(this._pointerMap[t.pointerId]=t,2==this._pointerIdArray.length)){var e=this._getDistance()/this._distance,i=this.xZoom*e,n=this.yZoom*e;this.chart.isXZoomEnabled()&&this.chart.setXZoom(i,!1),this.chart.isYZoomEnabled()&&this.chart.setYZoom(n,!1)}},handleTouchend:function(t){var e=this.chart.getLogicalPoint(t);if(1==this._pointerIdArray.length&&e&&!this.moved){var i=this.chart.tryGetDataAt(t),n=this._startTouchPoint&&this._startTouchTime&&(new Date).getTime()-this._startTouchTime.getTime()<=500&&We.getDistance(this._startTouchPoint,e)<=10,o=this.chart.getSelectionModel();i&&n?Me.isCtrlDown(t)?o.contains(i)?o.removeSelection(i):o.appendSelection(i):o.contains(i)||o.setSelection(i):Me.isCtrlDown(t)||o.clearSelection()}this.moved=!1,this._pointerMap={},this._pointerIdArray=[]},handleMouseWheel:function(t){Xe.preventDefault(t);var e=Ue.isFirefox?-t.detail:t.wheelDelta;e>0?(this.chart.isXZoomEnabled()&&this.chart.setXZoom(1.1*this.chart.getXZoom(),!1),this.chart.isYZoomEnabled()&&this.chart.setYZoom(1.1*this.chart.getYZoom(),!1)):0>e&&(this.chart.isXZoomEnabled()&&this.chart.setXZoom(this.chart.getXZoom()/1.1,!1),this.chart.isYZoomEnabled()&&this.chart.setYZoom(this.chart.getYZoom()/1.1,!1))},handle_mousemove:function(t){if(1==this._pointerIdArray.length&&this._startTouchPoint&&this._startClientPoint){var e={x:this._startTouchPoint.x+(t.clientX-this._startClientPoint.x)/this.chart.getXZoom(),y:this._startTouchPoint.y+(t.clientY-this._startClientPoint.y)/this.chart.getYZoom()};We.getDistance(this._startTouchPoint,e)>3&&(this.moved=!0,this.chart.isXTranslateEnabled()&&this.chart.setXTranslate(this.chart.getXTranslate()+e.x-this._startTouchPoint.x),this.chart.isYTranslateEnabled()&&this.chart.setYTranslate(this.chart.getYTranslate()+e.y-this._startTouchPoint.y),this._startClientPoint.x=t.clientX,this._startClientPoint.y=t.clientY)}},handle_mouseup:function(t){this.handleTouchend(t)},_getDistance:function(){return We.getDistance({x:this._pointerMap[this._pointerIdArray[0]].pageX,y:this._pointerMap[this._pointerIdArray[0]].pageY},{x:this._pointerMap[this._pointerIdArray[1]].pageX,y:this._pointerMap[this._pointerIdArray[1]].pageY})}}),De.charts.LegendPaneInteraction=function(t){this.legendPane=t;var e=this;this.legendPane._legendDiv.addEventListener("mousedown",function(t){e.handleMouseDown(t)},!1)},Me.ext("twaver.charts.LegendPaneInteraction",Object,{handleMouseDown:function(t){if(0===t.button){var e=t.target._data;e||(e=t.target.parentNode._data),e&&(this.legendPane._hiddenMap[e.getId()]?delete this.legendPane._hiddenMap[e.getId()]:this.legendPane._hiddenMap[e.getId()]=e,this.legendPane._chart.invalidateModel())}}}),De.charts.LegendPaneTouchInteraction=function(t){this.legendPane=t,Xe.addEventListener("touchstart","handleTouchstart",this.legendPane._legendDiv,this)},Me.ext("twaver.charts.LegendPaneTouchInteraction",Object,{handleTouchstart:function(t){Xe.preventDefault(t);var e=t.target._data;e||(e=t.target.parentNode._data),e&&(this.legendPane._hiddenMap[e.getId()]?delete this.legendPane._hiddenMap[e.getId()]:this.legendPane._hiddenMap[e.getId()]=e,this.legendPane._chart.invalidateModel())}}),De.network.Network=function(t){De.network.Network.superClass.constructor.apply(this,arguments),this._elementUIMap={},this._layerMap={},this._layerList=new hn,this._view=Xe.createView("auto"),this._rootDiv=Xe.createDiv(),this._topDiv=Xe.createDiv(),this._attachmentDiv=Xe.createDiv(),this._layersDiv=Xe.createDiv(),this._bottomDiv=Xe.createDiv(),this._rootDiv.appendChild(this._bottomDiv),this._rootDiv.appendChild(this._layersDiv),this._rootDiv.appendChild(this._attachmentDiv),this._rootDiv.appendChild(this._topDiv),this._view.appendChild(this._rootDiv),this.setElementBox(t||new De.ElementBox),Ue.isTouchable?Ue.isMSTouchable?this.setMSTouchInteractions():this.setTouchInteractions():this.setDefaultInteractions(!1);var e=this;this._flowLink=function(){if(!(e.isMovingElement()||e.isSelectingElement()||e.isEditingElement()||e._box._layoutMovingElements)){e._flowLinkQuickFinder||(e._flowLinkQuickFinder=new De.QuickFinder(e._box,"link.flow","style"));e._flowLinkQuickFinder.find(!0).forEach(function(t){t._styleMap["link.flow.offset"]=e.getLinkFlowOffset(t),e.getElementUI(t).drawBody()})}},this.setToolTipEnabled(kn.NETWORK_TOOLTIP_ENABLED),this._view.addEventListener("scroll",function(t){ci.twm(e)}),this.addPropertyChangeListener(function(t){"zoom"===t.property&&ci.twm(e)}),De.imageUtil.addEventListener(this.invalidateElementUIs,this)},Me.ext("twaver.network.Network",De.controls.View,{__accessor:["selectMode","makeVisibleOnSelected","movableFunction","editPointSize","editPointFillColor","editPointOutlineWidth","editPointOutlineColor","editLineColor","editLineWidth","resizePointSize","resizePointFillColor","resizePointOutlineWidth","resizePointOutlineColor","resizeLineColor","resizeLineWidth","rotatePointSize","rotatePointFillColor","rotatePointOffset","rotatePointOutlineWidth","rotatePointOutlineColor","rotateScaleFillColor","rotateScaleFontColor","rotateScaleWidth","rotateScaleHeight","selectOutlineColor","selectOutlineWidth","selectFillColor","lazyMoveOutlineColor","lazyMoveOutlineWidth","lazyMoveFillColor","rectSelectFilter","selectionTolerance"],__bool:["doubleClickToUpSubNetwork","doubleClickToSubNetwork","doubleClickToEmptySubNetwork","doubleClickToLinkBundle","doubleClickToGroupExpand","subNetworkAnimate","lazyMoveAnimate","resizeAnimate","noAgentLinkVisible","keyboardRemoveEnabled","keyboardSelectEnabled","sendToTopOnSelected","lazyMoveFill","editingElement","rotatingElement","movingElement","selectingElement","rectSelectEnabled","limitElementInPositiveLocation","showRotateScale","transparentSelectionEnable"],_viewRect:{x:0,y:0,width:0,height:0},_currentSubNetwork:null,_selectMode:kn.NETWORK_SELECT_MODE,_noAgentLinkVisible:kn.NETWORK_NO_AGENT_LINK_VISIBLE,_makeVisibleOnSelected:kn.NETWORK_MAKE_VISIBLE_ON_SELECTED,_keyboardRemoveEnabled:kn.NETWORK_KEYBOARD_REMOVE_ENABLED,_keyboardSelectEnabled:kn.NETWORK_KEYBOARD_SELECT_ENABLED,_rectSelectEnabled:kn.NETWORK_RECT_SELECT_ENABLED,_rectSelectFilter:null,_subNetworkAnimate:kn.NETWORK_SUBNETWORK_ANIMATE,_transparentSelectable:kn.NETWORK_TRANSPARENT_SELECTABLE,_removeElementUIOnInvisible:kn.NETWORK_REMOVE_ELEMENTUI_ON_INVISIBLE,_elementUIFunction:kn.ELEMENTUI_FUNCTION,_doubleClickToUpSubNetwork:kn.NETWORK_DOUBLECLICK_TO_UPSUBNETWORK,_doubleClickToSubNetwork:kn.NETWORK_DOUBLECLICK_TO_SUBNETWORK,_doubleClickToEmptySubNetwork:kn.NETWORK_DOUBLECLICK_TO_EMPTYSUBNETWORK,_doubleClickToLinkBundle:kn.NETWORK_DOUBLECLICK_TO_LINKBUNDLE,_doubleClickToGroupExpand:kn.NETWORK_DOUBLECLICK_TO_GROUPEXPAND,_sendToTopOnSelected:kn.NETWORK_SENDTOTOP_ON_SELECTED,_selectOutlineColor:kn.NETWORK_SELECT_OUTLINE_COLOR,_selectOutlineWidth:kn.NETWORK_SELECT_OUTLINE_WIDTH,_selectFillColor:kn.NETWORK_SELECT_FILL_COLOR,_lazyMoveOutlineColor:kn.NETWORK_LAZYMOVE_OUTLINE_COLOR,_lazyMoveOutlineWidth:kn.NETWORK_LAZYMOVE_OUTLINE_WIDTH,_lazyMoveFillColor:kn.NETWORK_LAZYMOVE_FILL_COLOR,_lazyMoveFill:kn.NETWORK_LAZYMOVE_FILL,_lazyMoveAnimate:kn.NETWORK_LAZYMOVE_ANIMATE,_editPointSize:kn.NETWORK_EDIT_POINT_SIZE,_editPointFillColor:kn.NETWORK_EDIT_POINT_FILL_COLOR,_editPointOutlineColor:kn.NETWORK_EDIT_POINT_OUTLINE_COLOR,_editPointOutlineWidth:kn.NETWORK_EDIT_POINT_OUTLINE_WIDTH,_editLineColor:kn.NETWORK_EDIT_LINE_COLOR,_editLineWidth:kn.NETWORK_EDIT_LINE_WIDTH,_resizePointSize:kn.NETWORK_RESIZE_POINT_SIZE,_resizePointFillColor:kn.NETWORK_RESIZE_POINT_FILL_COLOR,_resizePointOutlineColor:kn.NETWORK_RESIZE_POINT_OUTLINE_COLOR,_resizePointOutlineWidth:kn.NETWORK_RESIZE_POINT_OUTLINE_WIDTH,_resizeLineColor:kn.NETWORK_RESIZE_LINE_COLOR,_resizeLineWidth:kn.NETWORK_RESIZE_LINE_WIDTH,_resizeAnimate:kn.NETWORK_RESIZE_ANIMATE,_rotatePointSize:kn.NETWORK_ROTATE_POINT_SIZE,_rotatePointFillColor:kn.NETWORK_ROTATE_POINT_FILL_COLOR,_rotatePointOffset:kn.NETWORK_ROTATE_POINT_OFFSET,_rotatePointOutlineWidth:kn.NETWORK_ROTATE_POINT_OUTLINE_WIDTH,_rotatePointOutlineColor:kn.NETWORK_ROTATE_POINT_OUTLINE_COLOR,_rotateScaleWidth:kn.NETWORK_ROTATE_SCALE_WIDTH,_rotateScaleHeight:kn.NETWORK_ROTATE_SCALE_HEIGHT,_rotateScaleFillColor:kn.NETWORK_ROTATE_SCALE_FILL_COLOR,_rotateScaleFontColor:kn.NETWORK_ROTATE_SCALE_FONT_COLOR,_limitElementInPositiveLocation:kn.NETWORK_LIMIT_ELEMENT_INPOSITIVE_LOCATION,_linkFlowInterval:kn.NETWORK_LINK_FLOW_INTERVAL,_selectionTolerance:kn.NETWORK_SELECTION_TOLERANCE,_invalidate:!1,_invalidateElementVisibility:!1,_invalidateElementIndex:!1,_isEditingElement:!1,_isRotatingElement:!1,_isMovingElement:!1,_isSelectingElement:!1,_hasEditInteraction:!1,_showRotateScale:!0,_transparentSelectionEnable:De.Defaults.NETWORK_TRANSPARENT_SELECTION_ENABLE,getLabel:function(t){return t.getStyle("network.label")||t.getName()},isToolTipEnabled:function(){return!!this._toolTipEnabled},setToolTipEnabled:function(t){if(this._toolTipEnabled=t,t){if(!this._toolTipListener){var e=this;this._toolTipListener=function(t){var i=e.getElementAt(t);if(e._preElement!==i)if(e._preElement=i,i){var n=e.getToolTip(i);xi.showToolTip({x:t.pageX,y:t.pageY},n);var o=xi.getToolTipDiv();if(o.children.length>0){var r=e._view.getBoundingClientRect(),a=o.getBoundingClientRect();a.width+a.left>r.width+r.left&&(o.style.left=r.width+r.left-a.width+(ze.documentElement.scrollLeft||ze.body.scrollLeft)+"px"),a.height+a.top>r.height+r.top&&(o.style.top=r.height+r.top-a.height+(ze.documentElement.scrollTop||ze.body.scrollTop)+"px")}}else xi.hideToolTip()},this._view.addEventListener("mousemove",this._toolTipListener,!0),this.firePropertyChange("toolTipEnabled",!1,!0)}}else this._toolTipListener&&(xi.hideToolTip(),this._view.removeEventListener("mousemove",this._toolTipListener,!0),delete this._toolTipListener,this.firePropertyChange("toolTipEnabled",!0,!1))},isLinkFlowEnabled:function(){return!!this._linkFlowEnabled},setLinkFlowEnabled:function(t){t?(this._linkFlowEnabled||(this._linkFlowEnabled=!0,this.firePropertyChange("linkFlowEnabled",!1,!0)),clearInterval(this._linkFlowTimerId),this._linkFlowTimerId=setInterval(this._flowLink,this._linkFlowInterval)):(this._linkFlowEnabled&&(this._linkFlowEnabled=!1,this.firePropertyChange("linkFlowEnabled",!0,!1)),clearInterval(this._linkFlowTimerId),delete this._linkFlowTimerId)},getLinkFlowInterval:function(){return this._linkFlowInterval},setLinkFlowInterval:function(t){var e=this._linkFlowInterval;this._linkFlowInterval=t,this.firePropertyChange("linkFlowInterval",e,t),clearInterval(this._linkFlowTimerId),this.isLinkFlowEnabled()&&(this._linkFlowTimerId=setInterval(this._flowLink,this._linkFlowInterval))},getTopDiv:function(){return this._topDiv},getAttachmentDiv:function(){return this._attachmentDiv},getLayersDiv:function(){return this._layersDiv},getBottomDiv:function(){return this._bottomDiv},validateImpl:function(){if(ci.twm(this),this.__lics__){var t=0,e=null,i=null,n=null,o=this._invalidateElementVisibility;if(this._invalidateElementVisibility&&(this._invalidateElementVisibility=!1,this._removeElementUIOnInvisible&&(this._invalidateElementIndex=!0),this.forEachElementUI(function(o){o.validate();var r=o.getElement();if(o.setVisible(this.isVisible(r)),this._removeElementUIOnInvisible){if(e=this.getLayerDivByElement(r),o.isVisible()){if(o.getView().parentNode!==e)for(e.appendChild(o.getView()),i=o.getAttachments(),t=0;t<i.size();t++)n=i.get(t),n.isShowInAttachmentDiv()&&this._attachmentDiv.appendChild(n.getView())}else if(o.getView().parentNode===e)for(e.removeChild(o.getView()),i=o.getAttachments(),t=0;t<i.size();t++)n=i.get(t),n.isShowInAttachmentDiv()&&this._attachmentDiv.removeChild(n.getView())}else if(!o.getView().parentNode)for(e=this.getLayerDivByElement(r),e.appendChild(o.getView()),i=o.getAttachments(),t=0;t<i.size();t++)n=i.get(t),n.isShowInAttachmentDiv()&&this._attachmentDiv.appendChild(n.getView())},null,this)),this._invalidateElementIndex){this._invalidateElementIndex=!1;var r,a=this;this._box.getLayerBox().forEachByDepthFirst(function(t){var e,i=a._layerMap[t.getId()];a._box.forEachByLayer(function(t){var n=a._elementUIMap[t.getId()];if(n&&n.getView().parentNode===i){e=Xe.insertAfter(n.getView(),e);for(var o=n.getAttachments(),s=0;s<o.size();s++){var l=o.get(s);l.getView().parentNode===a._attachmentDiv&&(r=Xe.insertAfter(l.getView(),r))}}},t)})}if(o&&!this._invalidateElementVisibility){var s;for(var l in this._elementUIMap){var h=this._elementUIMap[l];h.isVisible()&&(s=We.unionRect(s,h.getViewRect()))}if(s=s?{x:0,y:0,width:s.x+s.width,height:s.y+s.height}:{x:0,y:0,width:0,height:0},s.x!==this._viewRect.x||s.y!==this._viewRect.y||s.width!==this._viewRect.width||s.height!==this._viewRect.height){var c=this._viewRect;this._viewRect=s,this._rootDiv.style.left="0px",this._rootDiv.style.top="0px",this._rootDiv.style.width=s.width+"px",this._rootDiv.style.height=s.height+"px",this.firePropertyChange("viewRect",c,s)}}}},setInteractions:function(t){var e=this._interactions;e&&e.forEach(function(t){t.tearDown()}),this._interactions=t,t&&t.forEach(function(t){t.setUp()}),this.invalidateSelectedElementUIs(!0),this.firePropertyChange("interactions",e,t)},getInteractions:function(){return this._interactions},upSubNetwork:function(t,e){this._currentSubNetwork&&this.setCurrentSubNetwork(_i.getSubNetwork(this._currentSubNetwork),t,e)},sendToTop:function(t){if(this.isVisible(t)){for(var e=t;this.isVisible(e.getParent())&&(e=e.getParent()););e!==t&&this._box.adjustElementIndex(e),this._box.adjustElementIndex(t)}},invalidateElementIndex:function(){this._invalidateElementIndex||(this._invalidateElementIndex=!0,this.invalidate())},invalidateElementVisibility:function(){this._invalidateElementVisibility||(this._invalidateElementVisibility=!0,this.invalidate())},updateLayers:function(){Xe.clear(this._layersDiv),Xe.clear(this._attachmentDiv),this._layerMap={},this._layerList.clear();var t=this;this._box.getLayerBox().forEachByDepthFirst(function(e){var i=Xe.createDiv();Xe.setVisible(i,e.isVisible()),t._layerMap[e.getId()]=i,t._layersDiv.appendChild(i),t._layerList.add(e)}),this._box.forEach(this.createElementUI,this)},getCurrentSubNetwork:function(){return this._currentSubNetwork},setCurrentSubNetwork:function(t,e,i){var n=De.animate.AnimateManager;if(n.endAnimate(),e){if(this._currentSubNetwork===t)return;if(t&&!this._box.contains(t))throw t+" is not contained in this network's elementBox";n.start(new De.animate.AnimateSubNetwork(this,t,i))}else this._setCurrentSubNetwork(t),i&&i()},_setCurrentSubNetwork:function(t){if(this._currentSubNetwork!==t){if(t&&!this._box.contains(t))throw t+" is not contained in this network's elementBox";var e=this._currentSubNetwork;this._currentSubNetwork=t,this.firePropertyChange("currentSubNetwork",e,t),this.invalidateElementVisibility()}},isVisible:function(t){if(!this._box.contains(t))return!1;if(!t.isVisible())return!1;if(this._visibleFunction&&!this._visibleFunction(t))return!1;if(!this._box.getLayerBox().getLayerByElement(t).isVisible())return!1;if(_i.getSubNetwork(t)!==this._currentSubNetwork)return!1;if(t instanceof De.Link){if(!this.isNoAgentLinkVisible()){if(!t.getFromAgent()||!t.getToAgent())return!1;if(!this.isVisible(t.getFromAgent())||!this.isVisible(t.getToAgent()))return!1}if(t.getBundleIndex()>0&&t.getBundleCount()>1&&!t.getStyle("link.bundle.expanded"))return!1}else for(var e=t.getParent();e&&!e.ISubNetwork;){if(e instanceof Mn&&(!e.isExpanded()||!this.isVisible(e)))return!1;e=e.getParent()}return!t.IDummy},isMovable:function(t){return!!this._box.contains(t)&&(!(t instanceof De.Link)&&(!(this._movableFunction&&!this._movableFunction(t))&&this._box.getLayerBox().getLayerByElement(t).isMovable()))},isEditable:function(t){return!!this._box.contains(t)&&(!(this._editableFunction&&!this._editableFunction(t))&&this._box.getLayerBox().getLayerByElement(t).isEditable())},isRotatable:function(t){return!(this._rotatableFunction&&!this._rotatableFunction(t))},getVisibleFunction:function(){return this._visibleFunction},setVisibleFunction:function(t){var e=this._visibleFunction;this._visibleFunction=t,this.firePropertyChange("visibleFunction",e,t),this.invalidateElementVisibility()},getEditableFunction:function(){return this._editableFunction},setEditableFunction:function(t){var e=this._editableFunction;this._editableFunction=t,this.firePropertyChange("editableFunction",e,t),this.invalidateSelectedElementUIs(!0)},getRotatableFunction:function(){return this._rotatableFunction},setRotatableFunction:function(t){var e=this._rotatableFunction;this._rotatableFunction=t,this.firePropertyChange("rotatableFunction",e,t),this.invalidateSelectedElementUIs(!0)},isLinkable:function(t){return null==this._linkableFunction||this._linkableFunction(t)},getLinkableFunction:function(){return this._linkableFunction},setLinkableFunction:function(t){var e=this._linkableFunction;this._linkableFunction=t,this.firePropertyChange("linkableFunction",e,t),this.invalidateSelectedElementUIs(!0)},onShareSelectionModelChanged:function(){this.invalidateElementUIs()},getElementBox:function(){return this._box},setElementBox:function(t){if(!t)throw"ElementBox can not be null";if(this._box!==t){var e=this._box;e&&(e.removeDataBoxChangeListener(this.handleElementBoxChange,this),e.removeDataPropertyChangeListener(this.handleElementPropertyChange,this),e.removePropertyChangeListener(this.handleElementBoxPropertyChange,this),e.removeIndexChangeListener(this.handleIndexChange,this),e.getLayerBox().removeDataBoxChangeListener(this.handleLayerBoxChange,this),e.getLayerBox().removeDataPropertyChangeListener(this.handleLayerPropertyChange,this),e.getLayerBox().removeHierarchyChangeListener(this.handleLayerHierarchyChange,this),this._selectionModel||e.getSelectionModel().removeSelectionChangeListener(this.handleSelectionChange,this)),this._box=t,this._box.addDataBoxChangeListener(this.handleElementBoxChange,this),this._box.addDataPropertyChangeListener(this.handleElementPropertyChange,this),this._box.addPropertyChangeListener(this.handleElementBoxPropertyChange,this),this._box.addIndexChangeListener(this.handleIndexChange,this),this._box.getLayerBox().addDataBoxChangeListener(this.handleLayerBoxChange,this),this._box.getLayerBox().addDataPropertyChangeListener(this.handleLayerPropertyChange,this),this._box.getLayerBox().addHierarchyChangeListener(this.handleLayerHierarchyChange,this),this._flowLinkQuickFinder&&(this._flowLinkQuickFinder.dispose(),this._flowLinkQuickFinder=new De.QuickFinder(this._box,"link.flow","style")),this._selectionModel?this._selectionModel._setDataBox(t):this._box.getSelectionModel().addSelectionChangeListener(this.handleSelectionChange,this),this._elementUIMap={},this.updateLayers(),this.invalidateElementVisibility(),this.firePropertyChange("elementBox",e,this._box)}},invalidateElementUI:function(t,e){var i=this.getElementUI(t);i&&i.invalidate(e)},invalidateElementUIs:function(t){for(var e in this._elementUIMap){this._elementUIMap[e].invalidate(t)}},invalidateSelectedElementUIs:function(t){this.getSelectionModel().getSelection().forEach(function(e){this.invalidateElementUI(e,t)},this)},getElementUI:function(t){return t?this._elementUIMap[t.getId()]:null},getLayerDivByElement:function(t){var e=this._box.getLayerBox().getLayerByElement(t);return e?this._layerMap[e.getId()]:null},createElementUI:function(t){var e=this._elementUIMap[t.getId()];if(e||(e=this._elementUIFunction(this,t))&&(this._elementUIMap[t.getId()]=e),e){var i=this.getLayerDivByElement(t);e.getView().parentNode!==i&&(i.appendChild(e.getView()),e.getAttachments().forEach(function(t){t.isShowInAttachmentDiv()&&t.getView().parentNode!==this._attachmentDiv&&this._attachmentDiv.appendChild(t.getView())},this)),this.invalidateElementIndex()}},invalidateBundleLink:function(t){if(t instanceof De.Link&&t._bundleLinks){var e=this._elementUIMap;t._bundleLinks.forEachSiblingLink(function(i){if(i!==t){var n=e[i._id];n&&n.invalidate(!1)}},this)}},handleLayerBoxChange:function(t){this.updateLayers(),this.invalidateElementVisibility()},handleLayerPropertyChange:function(t){var e=t.source;if("visible"===t.property){var i=this._layerMap[e.getId()];Xe.setVisible(i,e.isVisible())}else"editable"===t.property&&this.invalidateSelectedElementUIs(!0);this.invalidateElementVisibility()},handleLayerHierarchyChange:function(t){var e;this._layerList.clear(),this._box.getLayerBox().forEachByDepthFirst(function(t){var i=this._layerMap[t.getId()];e=Xe.insertAfter(i,e),this._layerList.add(t)},null,this),this.invalidateElementVisibility()},handleSelectionChange:function(t){t.datas.forEach(function(e){var i=this.getElementUI(e);i&&i.handleSelectionChange(t)},this),this.invalidateElementVisibility();var e=this.getSelectionModel().getLastData();e&&("append"===t.kind||"set"===t.kind)&&(this.isMakeVisibleOnSelected()&&this.makeVisible(e),this.isSendToTopOnSelected()&&this.sendToTop(e))},makeVisible:function(t){var e=this.getElementUI(t);if(e){var i=_i.getSubNetwork(t);if(i!==this._currentSubNetwork){var n=this;return void this.setCurrentSubNetwork(i,this.isSubNetworkAnimate(),function(){Me.callLater(n.makeVisible,n,[t])})}for(var o=t;(o=o.getParent())&&o!==i;)o instanceof Mn&&o.setExpanded(!0);var r=e.getUnionBodyBounds();if(r){var a={x:this._view.scrollLeft/this._zoom,y:this._view.scrollTop/this._zoom,width:this._view.clientWidth/this._zoom,height:this._view.clientHeight/this._zoom};We.intersects(a,r)||this.isVisible(t)&&Me.callLater(this.centerByLogicalPoint,this,[r.x+r.width/2,r.y+r.height/2])}}},handleElementBoxChange:function(t){var e=t.data;if("add"===t.kind)this.createElementUI(e),this.invalidateBundleLink(e);else if("remove"===t.kind){var i=this.getElementUI(e);if(i){var n=this._box.getLayerBox().getLayerByElement(e),o=this._layerMap[n.getId()];i.getView().parentNode===o&&o.removeChild(i.getView()),i.dispose(),delete this._elementUIMap[e.getId()]}e===this._currentSubNetwork&&null!=this._currentSubNetwork&&this._setCurrentSubNetwork(null)}else"clear"===t.kind&&(this.forEachElementUI(function(t){t.dispose()}),this._elementUIMap={},this.updateLayers(),null!=this._currentSubNetwork&&this._setCurrentSubNetwork(null));this.invalidateElementVisibility()},handleElementPropertyChange:function(t){var e=t.source,i=this.getElementUI(e);if(i&&(i.handlePropertyChange(t),"layerId"===t.property)){var n=this._box.getLayerBox().getLayerByElement(e),o=this._layerMap[n.getId()];i.getView().parentNode!==o&&(o.appendChild(i.getView()),this.invalidateElementIndex())}this.invalidateBundleLink(e),this.invalidateElementVisibility()},handleElementBoxPropertyChange:function(t){this.invalidateElementVisibility()},handleIndexChange:function(t){this.invalidateElementIndex()},getElementUIFunction:function(){return this._elementUIFunction},setElementUIFunction:function(t){if(!t)throw"ElementUIFunction can not be null";if(this._elementUIFunction!==t){var e=this._elementUIFunction;this._elementUIFunction=t,this.firePropertyChange("elementUIFunction",e,t),this._box.isEmpty()||this.updateLayers()}},getIconsNames:function(t){return t.getStyle("icons.names")},getIconsColors:function(t){return t.getStyle("icons.colors")},getLinkHandlerLabel:function(t){return t.isBundleAgent()?"+("+t.getBundleCount()+")":null},getSelectColor:function(t){return t.getStyle("select.color")},getShadowColor:function(t){var e=t.getStyle("shadow.color");return!e&&this.isSelected(t)&&"shadow"===t.getStyle("select.style")?t.getStyle("select.color"):e},getAlarmLabel:function(t){var e=t.getAlarmState().getHighestNewAlarmSeverity();if(e){var i=t.getAlarmState().getNewAlarmCount(e)+e.nickName;return t.getAlarmState().hasLessSevereNewAlarms()&&(i+="+"),i}return null},isRemoveElementUIOnInvisible:function(){return this._removeElementUIOnInvisible},setRemoveElementUIOnInvisible:function(t){var e=this._removeElementUIOnInvisible;this._removeElementUIOnInvisible=t,this.firePropertyChange("removeElementUIOnInvisible",e,t),this.invalidateElementVisibility()},setDefaultInteractions:function(t,e){var i=[new De.network.interaction.SelectInteraction(this),new De.network.interaction.MoveInteraction(this,t),new De.network.interaction.DefaultInteraction(this)];e&&i.push(new De.network.interaction.MoveLinkInteraction(this,t)),this.setInteractions(i)},setPanInteractions:function(){this.setInteractions([new De.network.interaction.PanInteraction(this),new De.network.interaction.DefaultInteraction(this)])},setEditInteractions:function(t,e){var i=[new De.network.interaction.SelectInteraction(this),new De.network.interaction.EditInteraction(this,t),new De.network.interaction.MoveInteraction(this,t),new De.network.interaction.DefaultInteraction(this)];e&&i.push(new De.network.interaction.MoveLinkInteraction(this,t)),this.setInteractions(i)},setCreateElementInteractions:function(t){this.setInteractions([new De.network.interaction.CreateElementInteraction(this,t),new De.network.interaction.DefaultInteraction(this)])},setCreateLinkInteractions:function(t){this.setInteractions([new De.network.interaction.CreateLinkInteraction(this,t),new De.network.interaction.DefaultInteraction(this)])},setCreateShapeLinkInteractions:function(t){this.setInteractions([new De.network.interaction.CreateShapeLinkInteraction(this,t),new De.network.interaction.DefaultInteraction(this)])},setCreateShapeNodeInteractions:function(t){this.setInteractions([new De.network.interaction.CreateShapeNodeInteraction(this,t),new De.network.interaction.DefaultInteraction(this)])},setTouchInteractions:function(){var t=[new De.network.interaction.SelectInteraction(this),new De.network.interaction.MoveInteraction(this,!1),new De.network.interaction.DefaultInteraction(this),new De.network.interaction.TouchInteraction(this)];this.setInteractions(t)},setMSTouchInteractions:function(){this.setInteractions([new De.network.interaction.MSTouchInteraction(this)])},setMagnifyInteractions:function(){this.setInteractions([new De.network.interaction.SelectInteraction(this),new De.network.interaction.MoveInteraction(this),new De.network.interaction.DefaultInteraction(this),new De.network.interaction.MagnifyInteraction(this)])},hasEditInteraction:function(){return this._hasEditInteraction},setHasEditInteraction:function(t){var e=this._hasEditInteraction;this._hasEditInteraction=t,this.firePropertyChange("hasEditInteraction",e,t)},moveSelectedElements:function(t,e,i,n){if(0!==t||0!==e){var o=this.getMovableSelectedElementsRect();null!=o&&(this._limitElementInPositiveLocation&&(o.x+t<0&&(t=-o.x),o.y+e<0&&(e=-o.y)),De.Util.moveElements(this.getMovableSelectedElements(),t,e,i,n,this))}},getMovableSelectedElements:function(){return this.getSelectionModel().toSelection(function(t){return this.isMovable(t)},this)},hasMovableSelectedElements:function(){for(var t=this.getSelectionModel().getSelection(),e=0;e<t.size();e++){var i=t.get(e);if(this.isMovable(i))return!0}return!1},getMovableSelectedElementsRect:function(){var t=this.getMovableSelectedElements();if(0===t.size())return null;for(var e=null,i=0,n=t.size();n>i;i++){var o=t.get(i);if(o instanceof On){var r=this.getElementUI(o);r&&(e=We.unionRect(e,r.getViewRect()))}}return e},getLayerByElement:function(t){return this._box.getLayerBox().getLayerByElement(t)},getPosition:function(t,e,i,n,o){var r,a=e instanceof De.network.ElementUI?e:this.getElementUI(e);if(a)if("from"===t||"to"===t){if(a.getFromPosition&&(r="from"===t?a.getFromPosition(n,o):a.getToPosition(n,o)))return{x:r.x-i.width/2,y:r.y-i.height/2}}else r="hotspot"===t?a.getHotSpot():Ze.get(t,a.getBodyRect(),i);if(!r&&e.getRect&&(r=Ze.get(t,e.getRect(),i)),r)return{x:r.x+n,y:r.y+o};throw"position '"+t+"' object '"+e+"'"},getViewRect:function(){return this._viewRect?Me.clone(this._viewRect):{x:0,y:0,width:0,height:0}},forEachElementUI:function(t,e,i){e?this._box.forEachReverse(function(n){if(this.getLayerByElement(n)===e){var o=this.getElementUI(n);o&&(i?t.call(i,o):t(o))}},this):this._layerList.forEachReverse(function(e){this.forEachElementUI(t,e,i)},this)},findFirstElement:function(t,e){for(var i=this._layerList.size()-1,n=this._box.size()-1,o=i;o>=0;o--)for(var r=this._layerList.get(o),a=n;a>=0;a--){var s=this._box.getDataAt(a);if(this.getLayerByElement(s)===r)if(e){if(!0===t.call(e,s))return s}else if(!0===t(s))return s}return null},getElementAt:function(t,e){if(1===arguments.length&&(e=!0),!this.isValidEvent(t))return null;(t=this._getPoint(t))||console.log("null");var i=t.x,n=t.y,o=this._selectionTolerance;if(o&&o>0){var r={x:i,y:n,width:0,height:0};We.grow(r,o,o)}return this.findFirstElement(function(t){if(e&&!this.isSelectable(t))return!1;var o=this.getElementUI(t);return!!o&&(r?!!o.intersectsTest(r):!!o.hitTest(i,n))},this)},_getPoint:function(t){return t?t.target?this.getLogicalPoint(t):t:null},getElementsAtRect:function(t,i,n,o){var r=new hn;return o=o===e||o,this.forEachElementUI(function(e){e.isVisible()&&(!n||n(e._element))&&(o&&this.isSelectable(e._element)||!o)&&(i?e.intersectsTest(t)&&r.add(e._element):We.contains(t,e.getViewRect())&&r.add(e._element))},null,this),r},hitTest:function(t){var e=this.getElementAt(t);if(!e)return null;var i=this.getElementUI(e);return i?(t=this._getPoint(t),i.hitTest(t.x,t.y)):null},addElementByInteraction:function(t){t.getParent()||t.setParent(this._currentSubNetwork),this._box.add(t),this.getSelectionModel().setSelection(t),this.fireInteractionEvent({kind:"createElement",element:t})},getLinkFlowStepping:function(t){var e=parseInt(t.getStyle("link.flow.stepping"));return e||(e=kn.NETWORK_LINK_FLOW_STEPPING),e},getLinkFlowOffset:function(t){var e=t.getStyle("link.flow.offset");return isNaN(e)&&(e=0),e+this.getLinkFlowStepping(t)},toCanvas:function(t,e,i){i||(i=Xe.createCanvas()),i.setAttribute("width",t),i.setAttribute("height",e),i._viewRect?(i._viewRect.width=t,i._viewRect.height=e):i._viewRect={x:0,y:0,width:t,height:e};var n=i.getContext("2d");if(n.clearRect(0,0,t,e),0===this._view.clientWidth||0===this._view.clientHeight)return i;var o=t/this._view.scrollWidth*this._zoom,r=e/this._view.scrollHeight*this._zoom;return n.scale(o,r),Xe.forEach(this._view,function(t){if(("CANVAS"===t.tagName||"IMG"===t.tagName)&&!t._isIgnored){var e=t._viewRect;if(e)try{n.drawImage(t,e.x,e.y,e.width,e.height)}catch(t){}}}),i},toCanvasByRegion:function(t,e,i){i||(i=Xe.createCanvas());var n=t.width*e,o=t.height*e;i.setAttribute("width",n),i.setAttribute("height",o);var r=i.getContext("2d");return r.clearRect(0,0,n,o),0===this._view.clientWidth||0===this._view.clientHeight?i:(r.save(),r.scale(e,e),Xe.forEach(this._view,function(e){if(("CANVAS"===e.tagName||"IMG"===e.tagName)&&!e._isIgnored){var i=e._viewRect;if(i&&We.intersects(i,t))try{r.drawImage(e,i.x-t.x,i.y-t.y,i.width,i.height)}catch(e){}}}),r.restore(),i)},getGroupChildrenRects:function(t){var e=new hn;return t.getChildren().forEach(function(t){if(t instanceof On){var i=this.getElementUI(t);if(i){var n=i.getViewRect();n&&e.add(n)}}},this),e},getLinkPathFunction:function(){return this._linkPathFunction},setLinkPathFunction:function(t){var e=this._linkPathFunction;this._linkPathFunction=t,this.firePropertyChange("linkPathFunction",e,t),this.invalidateElementUIs()},onClickElement:function(t,e){},onClickBackground:function(t){},onDoubleClickElement:function(t,e){},onDoubleClickBackground:function(t){},onLongClickElement:function(t,e){},onLongClickBackground:function(t){},onMouseMove:function(t,e){},onMouseEnter:function(t,e){},onMouseLeave:function(t,e){},setMovingElement:function(t){if(t!=this._movingElement){var e=this._movingElement;this._movingElement=t,this.firePropertyChange("movingElement",e,t),this._box._undoManager._enabled&&(t?this._box._undoManager.startBatch():this._box._undoManager.endBatch())}},setEditingElement:function(t){if(t!=this._editingElement){var e=this._editingElement;this._editingElement=t,this.firePropertyChange("editingElement",e,t),this._box._undoManager._enabled&&(t?this._box._undoManager.startBatch():this._box._undoManager.endBatch())}},dispose:function(){De.imageUtil.removeEventListener(this.invalidateElementUIs,this)}}),De.network.Overview=function(t){De.network.Overview.superClass.constructor.apply(this,arguments),this._view=Xe.createView(),this._rootDiv=Xe.createDiv(),this._imageCanvas=Xe.createCanvas(),this._imageDiv=Xe.createDiv(),this._maskCanvas=Xe.createCanvas(),this._selectDiv=Xe.createDiv(),this._isNetworkDirty=!1,this._isMaskDirty=!1,Xe.setVisible(this._selectDiv,!1),this._view.appendChild(this._rootDiv),this._rootDiv.appendChild(this._imageDiv),this._rootDiv.appendChild(this._maskCanvas),this._rootDiv.appendChild(this._selectDiv),this._imageDiv.appendChild(this._imageCanvas),this.setNetwork(t),Ue.isTouchable?Ue.isMSTouchable?new De.network.OverviewMSTouchInteraction(this):(new De.network.OverviewTouchInteraction(this),new De.network.OverviewInteraction(this)):new De.network.OverviewInteraction(this)},Me.ext("twaver.network.Overview",De.controls.ControlBase,{__accessor:["fillColor","outlineColor","outlineWidth","selectColor","selectWidth","padding","maxPackingWidth","maxPackingHeight"],__bool:["animate"],_fillColor:kn.OVERVIEW_FILL_COLOR,_outlineColor:kn.OVERVIEW_OUTLINE_COLOR,_outlineWidth:kn.OVERVIEW_OUTLINE_WIDTH,_selectColor:kn.OVERVIEW_SELECT_COLOR,_selectWidth:kn.OVERVIEW_SELECT_WIDTH,_padding:kn.OVERVIEW_PADDING,_animate:kn.OVERVIEW_ANIMATE,_maxPackingWidth:kn.OVERVIEW_MAX_PACKING_WIDTH,_maxPackingHeight:kn.OVERVIEW_MAX_PACKING_HEIGHT,getNetwork:function(){return this._network},onPropertyChanged:function(t){this._invalidateMask()},setNetwork:function(t){t!==this._network&&(this._network&&(this._network.removePropertyChangeListener(this._handleNetworkPropertyChange,this),this._network.removeViewListener(this._handleNetworkViewChange,this),Xe.removeEventListener("scroll","_handleScrollChange",this._network.getView(),this)),this._network=t,this._network&&(this._network.addPropertyChangeListener(this._handleNetworkPropertyChange,this),this._network.addViewListener(this._handleNetworkViewChange,this),Xe.addEventListener("scroll","_handleScrollChange",this._network.getView(),this)),this.invalidate())},_handleNetworkPropertyChange:function(t){("zoom"===t.property||"currentSubNetwork"===t.property||"elementBox"===t.property||"dataBox"===t.property)&&this.invalidate()},_handleNetworkViewChange:function(t){"validateEnd"===t.kind&&this.invalidate()},_handleScrollChange:function(){this._invalidateMask()},invalidate:function(t){this._isNetworkDirty&&this._isMaskDirty||(this._isNetworkDirty||(this._isNetworkDirty=!0),this._isMaskDirty||(this._isMaskDirty=!0),Me.callLater(this.validate,this,null,t))},_invalidateMask:function(){this._isMaskDirty||(this._isMaskDirty=!0,Me.callLater(this.validate,this,[],100))},validate:function(){if((this._isMaskDirty||this._isNetworkDirty)&&this._network&&(this._maxPackingWidth>0&&this._maxPackingHeight>0||this._view.clientWidth>0&&this._view.clientHeight>0)&&0!==this._network._view.clientWidth&&0!==this._network._view.clientHeight){var t,e=this._maxPackingWidth>0&&this._maxPackingHeight>0;t=e?{x:0,y:0,width:this._maxPackingWidth,height:this._maxPackingHeight}:{x:0,y:0,width:this._view.clientWidth,height:this._view.clientHeight},We.grow(t,-this._padding,-this._padding);var i=Math.min(t.width/this._network._view.scrollWidth,t.height/this._network._view.scrollHeight);e&&(Xe.setDiv(this._view,{x:0,y:0,width:this._imageDiv._viewRect.width,height:this._imageDiv._viewRect.height},null,0,null),t.width=this._imageDiv._viewRect.width,t.height=this._imageDiv._viewRect.height);var n=this._network._view.scrollWidth*i,o=this._network._view.scrollHeight*i,r=t.x+(t.width-n)/2,a=t.y+(t.height-o)/2;if(this._isNetworkDirty){var s={x:r,y:a,width:n,height:o};this._network.toCanvas(s.width,s.height,this._imageCanvas),Xe.setDiv(this._imageDiv,s,null,0,null),this._network.getElementBox&&(this._imageDiv.style.backgroundColor=(this._network.getCurrentSubNetwork()||this._network.getElementBox()).getStyle("background.color")||""),this._isNetworkDirty=!1}if(this._isMaskDirty){var l={x:this._network._view.scrollLeft*i,y:this._network._view.scrollTop*i,width:n*this._network._view.clientWidth/this._network._view.scrollWidth,height:o*this._network._view.clientHeight/this._network._view.scrollHeight},h=Xe.setCanvas(this._maskCanvas,r,a,n,o);h.lineWidth=0,h.fillStyle=this._fillColor,h.beginPath(),Ye.drawVector(h,"rectangle",null,r,a,n,o),h.fill(),h.clearRect(r+l.x,a+l.y,l.width,l.height);var c=this._outlineWidth<0?0:this._outlineWidth;h.lineWidth=c,h.strokeStyle=this._outlineColor,h.beginPath(),Ye.drawVector(h,"rectangle",null,r+l.x+c,a+l.y+c,l.width-2*c,l.height-2*c),c>=0&&h.stroke(),this._isMaskDirty=!1}}else this._isNetworkDirty=!1,this._isMaskDirty=!1},getLogicalPoint:function(t){return Xe.getLogicalPoint(this._view,t,1,this._rootDiv)},centerNetwork:function(t,e){var i=this._imageDiv._viewRect;We.containsPoint(i,t)&&(this._network.centerByLogicalPoint((t.x-i.x)/i.width*this._network._view.scrollWidth/this._network.getZoom(),(t.y-i.y)/i.height*this._network._view.scrollHeight/this._network.getZoom(),e),this._invalidateMask())}}),De.network.OverviewTouchInteraction=function(t){this.overview=t,this.network=t.getNetwork(),this.view=t._view,Xe.addEventListener("touchstart","handleTouchstart",this.view,this)},Me.ext("twaver.network.OverviewTouchInteraction",Object,{handleTouchstart:function(t){Xe.preventDefault(t),this.clear(),this.endPoint=this.overview.getLogicalPoint(t),wi.isMultiTouch(t)&&(this.distance=wi.getDistance(t),this.zoom=this.network.getZoom()),Xe.addEventListener("touchmove","handleTouchmove",this.view,this),Xe.addEventListener("touchend","handleTouchend",this.view,this)},handleTouchmove:function(t){if(Xe.preventDefault(t),this.moved||(this.moved=!0),this.endPoint=this.overview.getLogicalPoint(t),wi.isSingleTouch(t))this.overview.centerNetwork(this.endPoint,!1);else if(this.distance){var e=wi.getDistance(t)/this.distance;this.network.setZoom(this.zoom*e,!1)}},handleTouchend:function(t){if(!this.moved){this.endPoint=this.overview.getLogicalPoint(t);var e=this.lastPoint&&this.lastTouchStartTime&&(new Date).getTime()-this.lastTouchStartTime.getTime()<=300&&Math.abs(this.endPoint.x-this.lastPoint.x)<=10&&Math.abs(this.endPoint.y-this.lastPoint.y)<=10;e?(this.lastPoint=null,this.lastTouchStartTime=null):(this.lastPoint=this.endPoint,this.lastTouchStartTime=new Date),e?Me.callLater(this.network.zoomReset,this.network,[this.overview._animate]):this.overview.centerNetwork(this.endPoint,this.overview._animate)}this.clear()},clear:function(){this.endPoint&&(this.endPoint=null,Xe.removeEventListener("touchmove",this.view,this),Xe.removeEventListener("touchend",this.view,this)),this.moved=!1}}),De.network.OverviewInteraction=function(t){this.overview=t,this.network=t.getNetwork(),this.view=t._view,Xe.addEventListener("mousedown","handleMousedown",this.view,this)},Me.ext("twaver.network.OverviewInteraction",Object,{handleMousedown:function(t){0===t.button&&(this.clear(),this.endPoint=this.overview.getLogicalPoint(t),Me.isCtrlDown(t)&&(this.startPoint=this.endPoint,Xe.setVisible(this.overview._selectDiv,!0)),Xe.addEventListener("mousemove","handleMousemove",this.view,this),Xe.addEventListener("mouseup","handleMouseup",this.view,this))},handleMouseup:function(t){if(this.endPoint=this.overview.getLogicalPoint(t),"detail"in t&&2===t.detail)Me.callLater(this.network.zoomReset,this.network,[this.overview._animate]);else if(Xe.isVisible(this.overview._selectDiv)&&this.startPoint){var e=this.overview._imageDiv._viewRect,i=this.overview._selectDiv._viewRect.x,n=this.overview._selectDiv._viewRect.y,o=e.width/this.overview._selectDiv._viewRect.width,r=e.height/this.overview._selectDiv._viewRect.height,a=Math.min(o,r),s=this.network._view.scrollWidth/this.network.getZoom()*((i-e.x+this.overview._selectDiv._viewRect.width/2)/e.width),l=this.network._view.scrollHeight/this.network.getZoom()*((n-e.y+this.overview._selectDiv._viewRect.height/2)/e.height);this.network.setZoom(a*Math.min(this.network._view.clientWidth/this.network._view.scrollWidth,this.network._view.clientHeight/this.network._view.scrollHeight)*this.network.getZoom(),!1),Me.callLater(this.network.centerByLogicalPoint,this.network,[s,l,this.overview._animate]),Xe.setVisible(this.overview._selectDiv,!1),Xe.setDiv(this.overview._selectDiv,{x:0,y:0,width:0,height:0},null,0,null),this.startPoint=null}else this.overview.centerNetwork(this.endPoint,this.overview._animate);this.clear()},handleMousemove:function(t){var e=this.overview.getLogicalPoint(t);if(this.endPoint=e,Xe.isVisible(this.overview._selectDiv)&&this.startPoint){var i=e.x>this.startPoint.x?this.startPoint.x:e.x,n=e.x>this.startPoint.x?this.startPoint.y:e.y;e.x>this.startPoint.x&&e.y<this.startPoint.y&&(n=e.y),e.x<this.startPoint.x&&e.y>this.startPoint.y&&(n=this.startPoint.y);var o=this.overview._imageDiv._viewRect;i<o.x&&(i=o.x),i>o.x+o.width&&(i=o.x+o.width),n<o.y&&(n=o.y),n>o.y+o.height&&(n=o.y+o.height);var r=Math.abs(e.x-this.startPoint.x),a=Math.abs(e.y-this.startPoint.y);i+r>o.x+o.width&&(r=o.x+o.width-i),n+a>o.y+o.height&&(a=o.y+o.height-n),Xe.setDiv(this.overview._selectDiv,{x:i,y:n,width:r,height:a},null,this.overview._selectWidth,this.overview._selectColor)}else this.overview.centerNetwork(e,!1)},clear:function(){this.endPoint&&(this.endPoint=null,Xe.removeEventListener("mousemove",this.view,this),Xe.removeEventListener("mouseup",this.view,this))}}),De.network.OverviewMSTouchInteraction=function(t){this.overview=t,this.network=t.getNetwork(),this.view=t._view,this._pointerMap={},this._pointerIdArray=[],Xe.addEventListener("MSPointerDown","handleTouchstart",this.view,this),Xe.addEventListener("MSPointerMove","handleTouchmove",this.view,this),Xe.addEventListener("MSPointerUp","handleTouchend",this.view,this),Xe.addEventListener("MSPointerCancel","handleTouchend",this.view,this)},Me.ext("twaver.network.OverviewMSTouchInteraction",Object,{handleTouchstart:function(t){Xe.preventDefault(t),t.isPrimary&&this._pointerIdArray.length>0&&(this._pointerMap={},this._pointerIdArray=[]),!this._pointerMap[t.pointerId]&&this.overview.getLogicalPoint(t)&&(this._pointerIdArray.push(t.pointerId),this._pointerMap[t.pointerId]=t),1==this._pointerIdArray.length?(this._startTouchPoint=this.overview.getLogicalPoint(t),this._startTouchTime=new Date):2==this._pointerIdArray.length&&(this._distance=this._getDistance(),this._zoom=this.network.getZoom())},handleTouchmove:function(t){if(0!=this._pointerIdArray.length&&this._pointerMap[t.pointerId]&&!(We.getDistance({x:this._pointerMap[t.pointerId].pageX,y:this._pointerMap[t.pointerId].pageY},{x:t.pageX,y:t.pageY})<=10))if(this._pointerMap[t.pointerId]=t,2==this._pointerIdArray.length){var e=this._getDistance()/this._distance;this.network.setZoom(this._zoom*e,!1)}else if(1==this._pointerIdArray.length&&this._startTouchPoint){var i=this.overview.getLogicalPoint(t);if(null==i)return;this._startTouchPoint=i,this.overview.centerNetwork(this._startTouchPoint,!1)}},handleTouchend:function(t){var e=this.overview.getLogicalPoint(t);if(1==this._pointerIdArray.length&&e){var i=this._endTouchPoint&&this._endTouchTime&&(new Date).getTime()-this._endTouchTime.getTime()<=500&&We.getDistance(this._endTouchPoint,e)<=10;i?(this._endTouchPoint=null,this._endTouchTime=null):(this._endTouchPoint=e,this._endTouchTime=new Date),i?Me.callLater(this.network.zoomReset,this.network,[this.overview._animate]):this.overview.centerNetwork(this._endTouchPoint,this.overview._animate)}this._pointerMap={},this._pointerIdArray=[]},_getDistance:function(){return We.getDistance({x:this._pointerMap[this._pointerIdArray[0]].pageX,y:this._pointerMap[this._pointerIdArray[0]].pageY},{x:this._pointerMap[this._pointerIdArray[1]].pageX,y:this._pointerMap[this._pointerIdArray[1]].pageY})}}),De.network.ElementUI=function(t,e){this._view=Xe.createDiv(),this._bodyView=Xe.createDiv(),this._view.appendChild(this._bodyView),this._network=t,this._element=e,this._attachments=new hn,this._bodyBounds=new hn,this.invalidate(!0)},Me.ext("twaver.network.ElementUI",Object,{_invalidateFlag:!1,_invalidateAttachmentsFlag:!1,getElement:function(){return this._element},getNetwork:function(){return this._network},getAttachments:function(){return this._attachments},getStyle:function(t){return this._element.getStyle(t)},getFont:function(t){var e=this._element.getStyle(t);return e||kn.FONT},getDyeColor:function(t){return this._innerColor?this._innerColor:this.getStyle(t)},getInnerColor:function(){return this._innerColor},getOuterColor:function(){return this._outerColor},getShadowColor:function(){return this._shadowColor},getLabelAttachment:function(){return this._labelAttachment},getAlarmAttachment:function(){return this._alarmAttachment},getIconsAttachment:function(){return this._iconsAttachment},getEditAttachment:function(){return this._editAttachment},getHotSpot:function(){return this._hotSpot?Me.clone(this._hotSpot):{x:0,y:0}},setHotSpot:function(t){this._hotSpot=t},getUnionBodyBounds:function(){return Me.clone(this._unionBodyBounds)},getBodyRect:function(){return this._bodyRect||(this._bodyRect=this.createBodyRect()),Me.clone(this._bodyRect)},invalidate:function(t){t===e&&(t=!0),t&&(this._invalidateAttachmentsFlag=!0),this._invalidateFlag||(this._bodyRect=null,this._invalidateFlag=!0,this._network.invalidateElementVisibility())},updateMeasure:function(){},validate:function(){if(this._invalidateFlag){this._invalidateAttachmentsFlag&&(this._invalidateAttachmentsFlag=!1,this.checkAttachments()),this._invalidateFlag=!1,this._bodyBounds.clear(),Xe.clear(this._bodyView),this._innerColor=this._network.getInnerColor(this._element),this._outerColor=this._network.getOuterColor(this._element),this._shadowColor=this._network.getShadowColor(this._element),this._shadowXOffset=this._element.getStyle("shadow.xoffset"),this._shadowYOffset=this._element.getStyle("shadow.yoffset"),this._shadowBlur=this._element.getStyle("shadow.blur"),this.updateMeasure();var t=this._element.getStyle("whole.alpha");this._view.style.opacity=t,this._attachments.forEach(function(e){e.updateMeasure();var i=e.getAlpha();e._view.style.opacity=e.isShowInAttachmentDiv()?i*t:i});var e;this._bodyBounds.forEach(function(t){e=We.unionRect(e,t)}),this._unionBodyBounds=Me.clone(e),this._attachments.forEach(function(t){e=We.unionRect(e,t.getViewRect())}),this._viewRect=e}},cleanUp:function(t){for(var e=t.length,i=0;e>i;i++){var n=t[i],o=this[n];o&&!o.parentNode&&(this[n]=null)}},setVisible:function(t){this.isVisible()!==t&&(Xe.setVisible(this._view,t),this._attachments.forEach(function(e){e.isShowInAttachmentDiv()&&Xe.setVisible(e._view,t)}),this.invalidate(!0))},isVisible:function(){return Xe.isVisible(this._view)},checkAttachments:function(){this.checkLabelAttachment(),this.checkAlarmAttachment(),this.checkIconsAttachment(),this.checkEditAttachment()},checkLabelAttachment:function(){var t=this._network.getLabel(this._element);null!=t&&""!==t?this._labelAttachment||(this._labelAttachment=new De.network.LabelAttachment(this,kn.SHOW_LABEL_IN_ATTACHMENT_DIV),this.addAttachment(this._labelAttachment)):this._labelAttachment&&(this.removeAttachment(this._labelAttachment),this._labelAttachment=null)},checkAlarmAttachment:function(){var t=this._network.getAlarmLabel(this._element);null!=t&&""!==t?this._alarmAttachment||(this._alarmAttachment=new De.network.AlarmAttachment(this,kn.SHOW_ALARM_IN_ATTACHMENT_DIV),this.addAttachment(this._alarmAttachment)):this._alarmAttachment&&(this.removeAttachment(this._alarmAttachment),this._alarmAttachment=null)},checkIconsAttachment:function(){var t=this._network.getIconsNames(this._element);t&&t.length>0?this._iconsAttachment||(this._iconsAttachment=new De.network.IconsAttachment(this),this.addAttachment(this._iconsAttachment)):this._iconsAttachment&&(this.removeAttachment(this._iconsAttachment),this._iconsAttachment=null)},checkEditAttachment:function(){this.isEditable()&&this._network.hasEditInteraction()&&this._network.isSelected(this._element)&&this._network.isEditable(this._element)?this._editAttachment||(this._editAttachment=new De.network.EditAttachment(this),this.addAttachment(this._editAttachment)):this._editAttachment&&(this.removeAttachment(this._editAttachment),this._editAttachment=null)},isEditable:function(){return!0},handlePropertyChange:function(t){this.invalidate(!0)},handleSelectionChange:function(t){this.invalidate(!0)},dispose:function(){this._attachments.forEach(function(t){t.getView().parentNode&&t.getView().parentNode.removeChild(t.getView()),t.dispose()}),this._attachments.clear()},addAttachment:function(t){this._attachments.add(t),t.isShowInAttachmentDiv()?this._network.getAttachmentDiv().appendChild(t.getView()):this._view.appendChild(t.getView()),this.invalidate(!1)},removeAttachment:function(t){this._attachments.remove(t),t.getView().parentNode&&t.getView().parentNode.removeChild(t.getView()),t.dispose(),this.invalidate(!1)},addBodyBounds:function(t){t&&this._bodyBounds.add(t)},addComponent:function(t){this._bodyView.appendChild(t)},getBodyView:function(){return this._bodyView},getView:function(){return this._view},getViewRect:function(){return Me.clone(this._viewRect)},setShadow:function(t,e,i){var n=t.isShadowable()&&this._shadowColor&&!this._editAttachment;n&&(this._shadowXOffset>0?i.width+=this._shadowXOffset:(i.x+=this._shadowXOffset,i.width+=-this._shadowXOffset),this._shadowYOffset>0?i.height+=this._shadowYOffset:(i.y+=this._shadowYOffset,i.height+=-this._shadowYOffset),We.grow(i,this._shadowBlur,this._shadowBlur));var o=Xe.setCanvas(e,i);return n&&(o.shadowOffsetX=this._shadowXOffset,o.shadowOffsetY=this._shadowYOffset,o.shadowBlur=this._shadowBlur,o.shadowColor=this._shadowColor),o},isShadowable:function(){return!(!this._shadowColor||!this._network.isSelected(this._element)||"shadow"!==this._element.getStyle("select.style"))},hit:function(t,e){return!1},hitCanvas:function(t,e,i){for(var n=i.length,o=0;n>o;o++){var r=i[o],a=this[r];if(Ye.hit(a,t,e,this._network.getSelectionTolerance()))return!0}return!1},hitComponent:function(t,e,i){for(var n=i.length,o=0;n>o;o++){var r=i[o],a=this[r];if(a&&We.containsPoint(a._viewRect,t,e))return!0}return!1},hitTest:function(t,e){if(!this.isVisible()||!We.containsPoint(this._viewRect,t,e))return null;var i,n,o=this._attachments.size();for(i=o-1;i>=0;i--)if(n=this._attachments.get(i),n.isShowInAttachmentDiv()&&n.hit(t,e))return n;for(i=o-1;i>=0;i--)if(n=this._attachments.get(i),!n.isShowInAttachmentDiv()&&n.hit(t,e))return n;return We.containsPoint(this._unionBodyBounds,t,e)&&this.hit(t,e)?this:null},intersects:function(t){return!1},intersectsComponent:function(t,e){for(var i=e.length,n=0;i>n;n++){var o=e[n],r=this[o];if(r&&We.intersects(r._viewRect,t))return!0}return!1},intersectsCanvas:function(t,e){for(var i=e.length,n=0;i>n;n++){var o=e[n],r=this[o];if(Ye.intersects(r,t))return!0}return!1},intersectsTest:function(t){if(!this.isVisible()||!We.intersects(this._viewRect,t))return null;var e,i,n=this._attachments.size();for(e=n-1;e>=0;e--)if(i=this._attachments.get(e),i.isShowInAttachmentDiv()&&i.intersects(t))return i;for(e=n-1;e>=0;e--)if(i=this._attachments.get(e),!i.isShowInAttachmentDiv()&&i.intersects(t))return i;return We.intersects(this._unionBodyBounds,t)&&this.intersects(t)?this:null}}),De.network.Attachment=function(t,e){this._view=Xe.createDiv(),this._ui=t,this._element=this._ui.getElement(),this._network=t.getNetwork(),this._isShowInAttachmentDiv=!0===e,this._isShowInAttachmentDiv&&Xe.setVisible(this._view,t.isVisible())},Me.ext("twaver.network.Attachment",Object,{getElement:function(){return this._element},getElementUI:function(){return this._ui},getNetwork:function(){return this._network},getStyle:function(t){return this._ui.getStyle(t)},getFont:function(t){return this._ui.getFont(t)},isShowInAttachmentDiv:function(){return this._isShowInAttachmentDiv},getView:function(){return this._view},getViewRect:function(){return Me.clone(this._viewRect)},getAlpha:function(){return 1},updateMeasure:function(){},dispose:function(){},hit:function(t,e){return We.containsPoint(this._viewRect,t,e)},intersects:function(t){return We.intersects(this._viewRect,t)}}),De.network.BasicAttachment=function(t,e){De.network.BasicAttachment.superClass.constructor.call(this,t,e),this._roundRect={x:0,y:0,width:0,height:0},this._contentRect={x:0,y:0,width:0,height:0},this._attachmentCanvas=Xe.createCanvas(),this._view.insertBefore(this._attachmentCanvas,this._view.firstChild)},Me.ext("twaver.network.BasicAttachment",De.network.Attachment,{calculateMeasure:function(){var t=this.getContentWidth(),e=this.getContentHeight(),i=this.getCornerRadius(),n=this.getPointerLength(),o=this.getPointerWidth(),r=this.getPosition(),a=this.getXOffset(),s=this.getYOffset(),l=this._roundRect;l.width=t+2*i,l.height=e;var h;if(n>0){var c=this.getDirection();h=this._network.getPosition(r,this._ui,null,a,s);var u;if("aboveleft"===c)l.y=h.y-n-l.height,l.x=h.x-(l.width-i),u=Math.max(h.x-o,l.x+i/2),this._pointers=[h,{x:h.x,y:h.y-n},{x:u,y:h.y-n}];else if("aboveright"===c)l.y=h.y-n-l.height,l.x=h.x-i,u=Math.min(h.x+o,l.x+l.width-i/2),this._pointers=[h,{x:h.x,y:h.y-n},{x:u,y:h.y-n}];else if("belowleft"===c)l.y=h.y+n,l.x=h.x-(l.width-i),u=Math.max(h.x-o,l.x+i/2),this._pointers=[h,{x:h.x,y:h.y+n},{x:u,y:h.y+n}];else if("belowright"===c)l.y=h.y+n,l.x=h.x-i,u=Math.min(h.x+o,l.x+l.width-i/2),this._pointers=[h,{x:h.x,y:h.y+n},{x:u,y:h.y+n}];else if("leftabove"===c)l.y=h.y+i-l.height,l.x=h.x-n-l.width,u=Math.max(h.y-o,l.y+i/2),this._pointers=[h,{x:h.x-n,y:h.y},{x:h.x-n,y:u}];else if("leftbelow"===c)l.y=h.y-i,l.x=h.x-n-l.width,u=Math.min(h.y+o,l.y+l.height-i/2),this._pointers=[h,{x:h.x-n,y:h.y},{x:h.x-n,y:u}];else if("rightabove"===c)l.y=h.y+i-l.height,l.x=h.x+n,u=Math.max(h.y-o,l.y+i/2),this._pointers=[h,{x:h.x+n,y:h.y},{x:h.x+n,y:u}];else if("rightbelow"===c)l.y=h.y-i,l.x=h.x+n,u=Math.min(h.y+o,l.y+l.height-i/2),this._pointers=[h,{x:h.x+n,y:h.y},{x:h.x+n,y:u}];else if("above"===c)l.y=h.y-n-l.height,l.x=h.x-l.width/2,u=Math.min(t/2,o/2),this._pointers=[h,{x:h.x-u,y:h.y-n},{x:h.x+u,y:h.y-n}];else if("below"===c)l.y=h.y+n,l.x=h.x-l.width/2,u=Math.min(t/2,o/2),this._pointers=[h,{x:h.x-u,y:h.y+n},{x:h.x+u,y:h.y+n}];else if("left"===c)l.y=h.y-l.height/2,l.x=h.x-n-l.width,u=Math.min(e/2,o/2),this._pointers=[h,{x:h.x-n,y:h.y+u},{x:h.x-n,y:h.y-u}];else{if("right"!==c)throw"Can not resolve '"+c+"' attachment direction";l.y=h.y-l.height/2,l.x=h.x+n,u=Math.min(e/2,o/2),this._pointers=[h,{x:h.x+n,y:h.y+u},{x:h.x+n,y:h.y-u}]}}else h=this._network.getPosition(r,this._ui,{width:l.width,height:l.height},a,s),l.x=h.x,l.y=h.y,this._pointers=null;this._contentRect.x=l.x+(l.width-t)/2,this._contentRect.y=l.y+(l.height-e)/2,this._contentRect.width=t,this._contentRect.height=e;var d=this.getPadding();0!=d&&We.grow(l,d,d),d=this.getPaddingLeft(),0!=d&&(l.x-=d,l.width+=d),d=this.getPaddingRight(),0!=d&&(l.width+=d),d=this.getPaddingTop(),0!=d&&(l.y-=d,l.height+=d),d=this.getPaddingBottom(),0!=d&&(l.height+=d),l.width<0&&(l.width=l.width,l.x-=l.width),l.height<0&&(l.height=-l.height,l.y-=l.height)},updateMeasure:function(){De.network.BasicAttachment.superClass.updateMeasure.call(this),this.calculateMeasure();var t=this.isFill(),e=this.getOutlineWidth();this._viewRect=We.getRect(this._pointers),this._viewRect=We.unionRect(this._viewRect,this._roundRect),e>0&&We.grow(this._viewRect,e/2,e/2);var i=this._ui.setShadow(this,this._attachmentCanvas,this._viewRect);if((e>0||t)&&(i.beginPath(),Ye.drawRoundRect(i,this._roundRect.x,this._roundRect.y,this._roundRect.width,this._roundRect.height,this.getCornerRadius()),this._pointers&&(i.moveTo(this._pointers[0].x,this._pointers[0].y),i.lineTo(this._pointers[1].x,this._pointers[1].y),i.lineTo(this._pointers[2].x,this._pointers[2].y)),i.closePath(),e>0&&(i.lineWidth=e,i.strokeStyle=this.getOutlineColor(),i.lineCap=this.getCap(),i.lineJoin=this.getJoin(),i.stroke()),t)){var n=this.getFillColor(),o=this.getGradient();o?Ye.fill(i,n,o,this.getGradientColor(),this._viewRect):i.fillStyle=n,i.fill()}return i},getRoundRect:function(){return Me.clone(this._roundRect)},getContentRect:function(){return Me.clone(this._contentRect)},getContent:function(){return this._content},setContent:function(t){this._content!==t&&(this._content&&this._view.removeChild(this._content),this._content=t,t&&this._view.appendChild(t))},getContentWidth:function(){return kn.ATTACHMENT_CONTENT_WIDTH},getContentHeight:function(){return kn.ATTACHMENT_CONTENT_HEIGHT},getCornerRadius:function(){return kn.ATTACHMENT_CORNER_RADIUS},getPointerLength:function(){return kn.ATTACHMENT_POINTER_LENGTH},getPointerWidth:function(){return kn.ATTACHMENT_POINTER_WIDTH},getPosition:function(){return kn.ATTACHMENT_POSITION},getXOffset:function(){return kn.ATTACHMENT_XOFFSET},getYOffset:function(){return kn.ATTACHMENT_YOFFSET},getPadding:function(){return kn.ATTACHMENT_PADDING},getPaddingLeft:function(){return kn.ATTACHMENT_PADDING_LEFT},getPaddingRight:function(){return kn.ATTACHMENT_PADDING_RIGHT},getPaddingTop:function(){return kn.ATTACHMENT_PADDING_TOP},getPaddingBottom:function(){return kn.ATTACHMENT_PADDING_BOTTOM},getDirection:function(){return kn.ATTACHMENT_DIRECTION},isFill:function(){return kn.ATTACHMENT_FILL},getFillColor:function(){return kn.ATTACHMENT_FILL_COLOR},getGradient:function(){return kn.ATTACHMENT_GRADIENT},getGradientColor:function(){return kn.ATTACHMENT_GRADIENT_COLOR},getOutlineWidth:function(){return kn.ATTACHMENT_OUTLINE_WIDTH},getOutlineColor:function(){return kn.ATTACHMENT_OUTLINE_COLOR},getCap:function(){return kn.ATTACHMENT_CAP},getJoin:function(){return kn.ATTACHMENT_JOIN},isShadowable:function(){return kn.ATTACHMENT_SHADOWABLE},hit:function(t,e){return!!We.containsPoint(this._viewRect,t,e)&&(!!We.containsPoint(this._contentRect,t,e)||Ye.hit(this._attachmentCanvas,t,e))},intersects:function(t){return!!We.intersects(this._viewRect,t)&&(!!We.intersects(this._contentRect,t)||Ye.intersects(this._attachmentCanvas,t))}}),De.network.LabelAttachment=function(t,e){De.network.LabelAttachment.superClass.constructor.call(this,t,e)},Me.ext("twaver.network.LabelAttachment",De.network.BasicAttachment,{updateMeasure:function(){var t,e=this.getFont("label.font"),i=this.getLabel(),n=Me.g.getTextSize(e,i),o=this.getMaxLength();0!==o&&n.width>o?(t=Me.g.getCollapseTextInLength(e,i,o),this._textSize=Me.g.getTextSize(e,t)):(t=i,this._textSize=n);var r=De.network.LabelAttachment.superClass.updateMeasure.call(this),a=this._element.getStyle("label.align");Ye.drawText(r,t,this._contentRect,e,this.getStyle("label.color"),a)},getLabel:function(){return this._network.getLabel(this._element)},getContentWidth:function(){return this._textSize?this._textSize.width:0},getContentHeight:function(){return this._textSize?this._textSize.height:0},getCornerRadius:function(){return this.getStyle("label.corner.radius")},getPointerLength:function(){return this.getStyle("label.pointer.length")},getPointerWidth:function(){return this.getStyle("label.pointer.width")},getPosition:function(){return this.getStyle("label.position")},getXOffset:function(){return this.getStyle("label.xoffset")},getYOffset:function(){return this.getStyle("label.yoffset")},getPadding:function(){return this.getStyle("label.padding")},getPaddingLeft:function(){return this.getStyle("label.padding.left")},getPaddingRight:function(){return this.getStyle("label.padding.right")},getPaddingTop:function(){return this.getStyle("label.padding.top")},getPaddingBottom:function(){return this.getStyle("label.padding.bottom")},getDirection:function(){return this.getStyle("label.direction")},isFill:function(){return this.getStyle("label.fill")},getFillColor:function(){return this.getStyle("label.fill.color")},getGradient:function(){return this.getStyle("label.gradient")},getGradientColor:function(){return this.getStyle("label.gradient.color")},getOutlineWidth:function(){return this.getStyle("label.outline.width")},getOutlineColor:function(){return this.getStyle("label.outline.color")},getCap:function(){return this.getStyle("label.cap")},getJoin:function(){return this.getStyle("label.join")},getAlpha:function(){return this.getStyle("label.alpha")},getMaxLength:function(){return this.getStyle("label.maxlength")},isShadowable:function(){return this.getStyle("label.shadowable")}}),De.network.AlarmAttachment=function(t,e){De.network.AlarmAttachment.superClass.constructor.call(this,t,e)},Me.ext("twaver.network.AlarmAttachment",De.network.BasicAttachment,{updateMeasure:function(){var t=this.getFont("alarm.font"),e=this._network.getAlarmLabel(this._element);this._textSize=Ye.getTextSize(t,e),this._fillColor=this._network.getAlarmFillColor(this._element);var i=De.network.AlarmAttachment.superClass.updateMeasure.call(this);Ye.drawText(i,e,this._contentRect,t,this.getStyle("alarm.color"))},getContentWidth:function(){return this._textSize?this._textSize.width:0},getContentHeight:function(){return this._textSize?this._textSize.height:0},getCornerRadius:function(){return this.getStyle("alarm.corner.radius")},getPointerLength:function(){return this.getStyle("alarm.pointer.length")},getPointerWidth:function(){return this.getStyle("alarm.pointer.width")},getPosition:function(){return this.getStyle("alarm.position")},getXOffset:function(){return this.getStyle("alarm.xoffset")},getYOffset:function(){return this.getStyle("alarm.yoffset")},getPadding:function(){return this.getStyle("alarm.padding")},getPaddingLeft:function(){return this.getStyle("alarm.padding.left")},getPaddingRight:function(){return this.getStyle("alarm.padding.right")},getPaddingTop:function(){return this.getStyle("alarm.padding.top")},getPaddingBottom:function(){return this.getStyle("alarm.padding.bottom")},getDirection:function(){return this.getStyle("alarm.direction")},isFill:function(){return null!=this._fillColor},getFillColor:function(){return this._fillColor},getGradient:function(){return this.getStyle("alarm.gradient")},getGradientColor:function(){return this.getStyle("alarm.gradient.color")},getOutlineWidth:function(){return this.getStyle("alarm.outline.width")},getOutlineColor:function(){return this.getStyle("alarm.outline.color")},getCap:function(){return this.getStyle("alarm.cap")},getJoin:function(){return this.getStyle("alarm.join")},getAlpha:function(){return this.getStyle("alarm.alpha")},isShadowable:function(){return this.getStyle("alarm.shadowable")}}),De.network.LinkHandlerAttachment=function(t,e){De.network.LinkHandlerAttachment.superClass.constructor.call(this,t,e)},Me.ext("twaver.network.LinkHandlerAttachment",De.network.BasicAttachment,{updateMeasure:function(){var t=this.getFont("link.handler.font"),e=this._network.getLinkHandlerLabel(this._element);this._textSize=Ye.getTextSize(t,e);var i=De.network.LabelAttachment.superClass.updateMeasure.call(this);Ye.drawText(i,e,this._contentRect,t,this.getStyle("link.handler.color"))},getContentWidth:function(){return this._textSize?this._textSize.width:0},getContentHeight:function(){return this._textSize?this._textSize.height:0},getCornerRadius:function(){return this.getStyle("link.handler.corner.radius")},getPointerLength:function(){return this.getStyle("link.handler.pointer.length")},getPointerWidth:function(){return this.getStyle("link.handler.pointer.width")},getPosition:function(){return this.getStyle("link.handler.position")},getXOffset:function(){return this.getStyle("link.handler.xoffset")},getYOffset:function(){return this.getStyle("link.handler.yoffset")},getPadding:function(){return this.getStyle("link.handler.padding")},getPaddingLeft:function(){return this.getStyle("link.handler.padding.left")},getPaddingRight:function(){return this.getStyle("link.handler.padding.right")},getPaddingTop:function(){return this.getStyle("link.handler.padding.top")},getPaddingBottom:function(){return this.getStyle("link.handler.padding.bottom")},getDirection:function(){return this.getStyle("link.handler.direction")},isFill:function(){return this.getStyle("link.handler.fill")},getFillColor:function(){return this.getStyle("link.handler.fill.color")},getGradient:function(){return this.getStyle("link.handler.gradient")},getGradientColor:function(){return this.getStyle("link.handler.gradient.color")},getOutlineWidth:function(){return this.getStyle("link.handler.outline.width")},getOutlineColor:function(){return this.getStyle("link.handler.outline.color")},getCap:function(){return this.getStyle("link.handler.cap")},getJoin:function(){return this.getStyle("link.handler.join")},getAlpha:function(){return this.getStyle("link.handler.alpha")},isShadowable:function(){return this.getStyle("link.handler.shadowable")}}),De.network.EditAttachment=function(t,e){De.network.EditAttachment.superClass.constructor.call(this,t,e),this._attachmentDiv=Xe.createDiv(),this._view.appendChild(this._attachmentDiv)},Me.ext("twaver.network.EditAttachment",De.network.Attachment,{updateMeasure:function(){De.network.EditAttachment.superClass.updateMeasure.call(this),this._viewRect=null,this._element instanceof On&&this._addResizingPoint(this._element),!(this._network.isRotatable(this._element)&&this._element instanceof On)||this._element instanceof De.ShapeNode||this._element instanceof De.Grid||this._element instanceof De.Group||this._addRotatePoint(this._element),this._element instanceof De.ShapeNode&&(this._addResizingPoint(this._element),this._addShapeNodePoint(this._element)),this._ui instanceof De.network.ShapeLinkUI&&this._addShapeLinkPoints(this._ui),this._ui instanceof De.network.LinkUI&&this._addLinkControlPoint(this._ui)},_addRotatePoint:function(t){var e=this._network.getRotatePointSize();if(!(0>=e)){var i=t.getOriginalRect();if(!this._rotateDiv){var n=Xe.createDiv();this._attachmentDiv.appendChild(n),this._rotateDiv=n}var o,r=this._network.getRotatePointOutlineWidth(),a=this._network.getRotatePointOutlineColor(),s=this._network.getRotatePointFillColor(),e=this._network.getRotatePointSize(),l=2*e,h={x:i.x+i.width/2-e,y:i.y-this._network.getRotatePointOffset()-l,width:l,height:l};o=0==t.angle?h:this._getRotateRect(h,t.getAngle(),{x:i.x+i.width/2,y:i.y+i.height/2});var c=We.unionRect(t.getRect(),o);this._viewRect=We.unionRect(c,this._viewRect),Xe.setDiv(this._rotateDiv,h,s,r,a),this._rotateDiv._viewRect=o,Xe.setBorderRaidus(this._rotateDiv,l+"px"),this._rotateAttachments(this._rotateDiv,l/2,r)}},_addResizingPoint:function(t){var e=this._network.getResizePointSize();if(!(0>=e)){var i=t.getOriginalRect(),n=new hn([{x:i.x,y:i.y},{x:i.x+i.width/2,y:i.y},{x:i.x+i.width,y:i.y},{x:i.x,y:i.y+i.height/2},{x:i.x+i.width,y:i.y+i.height/2},{x:i.x,y:i.y+i.height},{x:i.x+i.width/2,y:i.y+i.height},{x:i.x+i.width,y:i.y+i.height}]);if(!this._resizeDivs){this._resizeDivs=new Array;for(var o=0;8>o;o++){var r=Xe.createDiv();this._attachmentDiv.appendChild(r),this._resizeDivs[o]=r}}if(this._resizeDivs){this._resizeRects=new Array;for(var o=0;8>o;o++){var a,s=n.get(o),l={x:s.x-e,y:s.y-e,width:2*e,height:2*e};a=0==t.getAngle()?l:this._getRotateRect(l,t.getAngle(),{x:i.x+i.width/2,y:i.y+i.height/2}),this._resizeRects[o]=a}}var h=this._network.getResizePointOutlineWidth(),c=this._network.getResizePointOutlineColor(),u=this._network.getResizePointFillColor();this._addPoints(t.getRect(),n,h,c,u,!0)}},_addPoints:function(t,e,i,n,o,r){var a=r?this._network.getResizePointSize():this._network.getEditPointSize();if(!(0>=a)){var s=a+i;We.grow(t,s,s),this._viewRect=We.unionRect(t,this._viewRect);var l,h,c,u,d=2*a,f=new hn;for(l=0,h=e.size();h>l;l++)c=e.get(l),u={x:c.x-a,y:c.y-a,width:d,height:d},f.add(u);var p;if(r)p=this._resizeDivs;else{if(this._controlDivs||(this._controlDivs=new Array),this._controlDivs.length<h)for(l=this._controlDivs.length;h>l;l++){var g=Xe.createDiv();this._attachmentDiv.appendChild(g),this._controlDivs[l]=g}else if(this._controlDivs.length>h){for(l=h;l<this._controlDivs.length;l++)this._attachmentDiv.removeChild(this._controlDivs[l]);this._controlDivs.splice(h)}p=this._controlDivs}for(l=0,h=f.size();h>l;l++)u=f.get(l),Xe.setDiv(p[l],u,o,i,n),Xe.setBorderRaidus(p[l],(r?"0":d)+"px"),this._rotateAttachments(p[l],d/2,i,e.get(l))}},_rotateAttachments:function(t,e,i,n){if(this._element instanceof On){var o=this._element.getAngle();if(0==o)return;var r=this._element.getOriginalRect(),a=t.style.left.split("px")[0],s=t.style.top.split("px")[0];r.x,r.width,r.y,r.height,n||(n={x:parseFloat(a)+e+i,y:parseFloat(s)+e+i});var l=We.createMatrix(o*Math.PI/180,r.x+r.width/2,r.y+r.height/2),h=l.transform(n);t.style.webkitTransform="rotate("+o+"deg)",t.style.mozTransform="rotate("+o+"deg)",t.style.OTransform="rotate("+o+"deg)",t.style.msTransform="rotate("+o+"deg)",t.style.transform="rotate("+o+"deg)",t.style.left=h.x-e-i+"px",t.style.top=h.y-e-i+"px"}},_addShapeLinkPoints:function(t){this._addEditPoints(t._element.getPoints())},_addShapeNodePoint:function(t){this._addEditPoints(t.getPoints())},_addLinkControlPoint:function(t){if(vi.isOrthogonalLink(t._element)){var e=t.getControlPoint();if(e){var i=new hn;i.add(e),this._addEditPoints(i)}}},_addEditPoints:function(t){var e=We.getRect(t);if(e){var i=this._network.getEditPointOutlineWidth(),n=this._network.getEditPointOutlineColor(),o=this._network.getEditPointFillColor();this._addPoints(e,t,i,n,o,!1)}},hit:function(t,e){if(!We.containsPoint(this._viewRect,t,e))return!1;var i;if(this._resizeDivs)for(i=this._resizeDivs.length-1;i>=0;i--)if(We.containsPoint(this._resizeRects[i],t,e))return!0;if(this._rotateDiv&&We.containsPoint(this._rotateDiv._viewRect,t,e))return!0;if(this._controlDivs)for(i=this._controlDivs.length-1;i>=0;i--)if(We.containsPoint(this._controlDivs[i]._viewRect,t,e))return!0;return!1},intersects:function(t){if(!We.intersects(this._viewRect,t))return!1;var e;if(this._resizeDivs)for(e=this._resizeDivs.length-1;e>=0;e--)if(We.intersects(this._resizeRects[e],t))return!0;if(this._rotateDiv&&We.containsPoint(this._rotateDiv._viewRect,t))return!0;if(this._controlDivs)for(e=this._controlDivs.length-1;e>=0;e--)if(We.intersects(this._controlDivs[e]._viewRect,t))return!0;return We.intersects(this._viewRect,t),!1},_getRotateRect:function(t,e,i){var n=We.createMatrix(e*Math.PI/180,i.x,i.y),o={x:t.x+t.width/2,y:t.y+t.height/2},r=n.transform(o),a=new De.List([{x:r.x-t.width/2,y:r.y-t.height/2},{x:r.x+t.width/2,y:r.y-t.height/2},{x:r.x+t.width/2,y:r.y+t.height/2},{x:r.x-t.width/2,y:r.y+t.height/2}]);return We.getRect(a)}}),De.network.IconsAttachment=function(t,e){De.network.IconsAttachment.superClass.constructor.call(this,t,e),this._iconsCanvas=null},Me.ext("twaver.network.IconsAttachment",De.network.Attachment,{isShadowable:function(){return kn.ATTACHMENT_SHADOWABLE},updateMeasure:function(){De.network.IconsAttachment.superClass.updateMeasure.call(this);var t=this._network.getIconsNames(this._element);if(t&&0!=t.length){var e=this._network.getIconsColors(this._element),i=this._element.getStyle("icons.orientation"),n=this._element.getStyle("icons.position"),o=this._element.getStyle("icons.xoffset");o=o instanceof Array?o[0]:o;var r=this._element.getStyle("icons.yoffset");r=r instanceof Array?r[0]:r;var a=this._element.getStyle("icons.xgap");a=a instanceof Array?a[0]:a;var s=this._element.getStyle("icons.ygap");s=s instanceof Array?s[0]:s;var l=this._getIconsSize(t,i,a,s);if(l){var h=this._network.getPosition(n,this._ui,l,o,r);this._viewRect={x:h.x,y:h.y,width:l.width,height:l.height},"top"===i?h.y+=l.height:"left"===i&&(h.x+=l.width),this._iconsCanvas||(this._iconsCanvas=Xe.createCanvas(),this._view.appendChild(this._iconsCanvas));var c=this._ui.setShadow(this,this._iconsCanvas,Me.clone(this._viewRect)),u=h.x,d=h.y,f=0;for(var p in t){var g=null,_=null;e&&e.length>f&&(_=e[f++]);var m=Me.getImageAsset(t[p]);if(null!=m){if("right"===i)g={x:u,y:d,width:m.getWidth(),height:m.getHeight()},u+=g.width+a;else if("left"===i)g={x:u-m.getWidth(),y:d,width:m.getWidth(),height:m.getHeight()},u-=g.width+a;else if("top"===i)g={x:u,y:d-m.getHeight(),width:m.getWidth(),height:m.getHeight()},d-=g.height+s;else{if("bottom"!==i)throw"Can not resolve '"+i+"' orientation";g={x:u,y:d,width:m.getWidth(),height:m.getHeight()},d+=g.height+s}Di(c,m.getImage(_,g.width,g.height),_,g,this._element,this._network)}}}}},_getIconsSize:function(t,e,i,n){var o=0,r=0,a=null,s=null,l=null;for(var h in t)if(s=Me.getImageAsset(t[h])){if("right"===e)a={x:o,y:r,width:s.getWidth(),height:s.getHeight()},o+=a.width+i;else if("left"===e)a={x:o-s.getWidth(),y:r,width:s.getWidth(),height:s.getHeight()},o-=a.width+i;else if("top"===e)a={x:o,y:r-s.getHeight(),width:s.getWidth(),height:s.getHeight()},r-=a.height+n;else{if("bottom"!==e)throw"Can not resolve '"+e+"' orientation";a={x:o,y:r,width:s.getWidth(),height:s.getHeight()},r+=a.height+n}l=null==l?Me.clone(a):We.unionRect(l,a)}return l?{width:Math.abs(l.width),height:Math.abs(l.height)}:null}}),De.network.HTMLBasicAttachment=function(t,e){function i(t,e,i,n,o,r,a){return i||(i=this._origin.x),n||(n=this._origin.y),o||(o=this._location.x),r||(r=this._location.y),t=t-i-o,e=e-n-r,De.Util.transformPoint({x:i+o,y:n+r},a?this._radian:-this._radian,t,e).point}De.network.HTMLBasicAttachment.superClass.constructor.call(this,t,e),this._roundRect={x:0,y:0,width:0,height:0},this._contentRect={x:0,y:0,width:0,height:0},this._triangleDiv=De.Util.createDiv(),this._roundDiv=De.Util.createDiv(),this._contentDiv=De.Util.createDiv(),De.Util.setCSSStyle(this._triangleDiv,"border-style","solid"),De.Util.setCSSStyle(this._contentDiv,"white-space","nowrap");var n=this;this.hit=function(t,e){if(this._radian&&this._origin){var o=i.call(n,t,e);t=o.x,e=o.y}return De.Util.containsPoint(this._roundRect,t,e)||De.Util.containsPoint(this._pointerRect,t,e)},this.intersects=function(t){var e={x:t.x,y:t.y},o={x:t.x+t.width,y:t.y},r={x:t.x,y:t.y+t.height},a={x:t.x+t.width,y:t.y+t.height};if(this._radian&&this._origin){if(t.width*t.height>50)return!1;e=i.call(n,e.x,e.y),o=i.call(n,o.x,o.y),r=i.call(n,r.x,r.y),a=i.call(n,a.x,a.y)}return t=De.Util.getRect([e,o,r,a]),De.Util.intersects(this._roundRect,t)||De.Util.intersects(this._pointerRect,t)},this.getContentWidth=function(){return this._contentDiv.scrollWidth||parseInt(De.Util.getCSSStyle(this._contentDiv.firstChild,"width"))},this.getContentHeight=function(){return this._contentDiv.scrollHeight||parseInt(De.Util.getCSSStyle(this._contentDiv.firstChild,"height"))},this._view.appendChild(this._roundDiv),this._roundDiv.appendChild(this._contentDiv)},De.Util.ext("twaver.network.HTMLBasicAttachment",De.network.BasicAttachment,{calculateMeasure:function(){var t=this.getContentWidth(),e=this.getContentHeight(),i=Math.min(this.getCornerRadius(),e/2),n=this.getPointerLength(),o=this.getPointerWidth(),r=this.getPosition(),a=this.getXOffset(),s=this.getYOffset();this._contentRect.width=t,this._contentRect.height=e,this._contentRect.x=i;var l=this._roundRect;l.width=t+2*i,l.height=e;var h;if(n>0){var c=this.getDirection();if(h=this._network.getPosition(r,this._ui,null,a,s),"aboveleft"===c){l.y=h.y-n-l.height,l.x=h.x-(l.width-i),this._pointers=[h,{x:h.x,y:h.y-n},{x:h.x-Math.min(o,t),y:h.y-n}];var u=n/2,d=Math.min(o,t)/2,f=this.getFillColor();this._triangleBorderWidthStyle=u+"px "+d+"px "+u+"px "+d+"px",this._triangleBorderColorStyle=f+" "+f+" transparent transparent",this._triangleDivLocation=this._pointers[2]}else if("aboveright"===c){l.y=h.y-n-l.height,l.x=h.x-i,this._pointers=[h,{x:h.x,y:h.y-n},{x:h.x+Math.min(o,t),y:h.y-n}];var u=n/2,d=Math.min(o,t)/2,f=this.getFillColor();this._triangleBorderWidthStyle=u+"px "+d+"px "+u+"px "+d+"px",this._triangleBorderColorStyle=f+" transparent transparent "+f,this._triangleDivLocation=this._pointers[1]}else if("belowleft"===c){l.y=h.y+n,l.x=h.x-(l.width-i),this._pointers=[h,{x:h.x,y:h.y+n},{x:h.x-Math.min(o,t),y:h.y+n}];var u=n/2,d=Math.min(o,t)/2,f=this.getFillColor();this._triangleBorderWidthStyle=u+"px "+d+"px "+u+"px "+d+"px",this._triangleBorderColorStyle=" transparent "+f+" "+f+" transparent",this._triangleDivLocation={x:this._pointers[2].x,y:h.y}}else if("belowright"===c){l.y=h.y+n,l.x=h.x-i,this._pointers=[h,{x:h.x,y:h.y+n},{x:h.x+Math.min(o,t),y:h.y+n}];var u=n/2,d=Math.min(o,t)/2,f=this.getFillColor();this._triangleBorderWidthStyle=u+"px "+d+"px "+u+"px "+d+"px",this._triangleBorderColorStyle="transparent transparent "+f+" "+f,this._triangleDivLocation=this._pointers[0]}else if("above"===c){l.y=h.y-n-l.height,l.x=h.x-l.width/2,this._pointers=[h,{x:h.x-Math.min(o,t)/2,y:h.y-n},{x:h.x+Math.min(o,t)/2,y:h.y-n}];var u=n,d=Math.min(o,t)/2,f=this.getFillColor();this._triangleBorderWidthStyle=u+"px "+d+"px 0px "+d+"px",this._triangleBorderColorStyle=f+" transparent transparent transparent",this._triangleDivLocation=this._pointers[1]}else if("below"===c){l.y=h.y+n,l.x=h.x-l.width/2,this._pointers=[h,{x:h.x-Math.min(o,t)/2,y:h.y+n},{x:h.x+Math.min(o,t)/2,y:h.y+n}];var u=n,d=Math.min(o,t)/2,f=this.getFillColor();this._triangleBorderWidthStyle="0px "+d+"px "+u+"px "+d+"px",this._triangleBorderColorStyle="transparent transparent "+f+" transparent ",this._triangleDivLocation={x:this._pointers[1].x,y:h.y}}else if("left"===c){l.y=h.y-l.height/2,l.x=h.x-l.width-n,this._pointers=[h,{x:h.x-n,y:h.y-Math.min(o,e)/2},{x:h.x-n,y:h.y+Math.min(o,e)/2}];var u=Math.min(o,e)/2,d=n,f=this.getFillColor();this._triangleBorderWidthStyle=u+"px 0px "+u+"px "+d+"px",this._triangleBorderColorStyle="transparent transparent  transparent "+f,this._triangleDivLocation=this._pointers[1]}else{if("right"!==c)throw"Can not resolve '"+c+"' attachment direction";l.y=h.y-l.height/2,l.x=h.x+n,this._pointers=[h,{x:h.x+n,y:h.y-Math.min(o,e)/2},{x:h.x+n,y:h.y+Math.min(o,e)/2}];var u=Math.min(o,e)/2,d=n,f=this.getFillColor();this._triangleBorderWidthStyle=u+"px "+d+"px "+u+"px 0px",this._triangleBorderColorStyle="transparent "+f+" transparent  transparent ",this._triangleDivLocation={x:h.x,y:this._pointers[1].y}}}else h=this._network.getPosition(r,this._ui,{width:l.width,height:l.height},a,s),l.x=h.x,l.y=h.y,this._pointers=null;this._location=h},updateMeasure:function(){if(this.calculateMeasure(),this._ui.isShadowable()&&this.isShadowable()?De.Util.setCSSStyle(this._roundDiv,"text-shadow",this._ui._shadowXOffset+"px "+this._ui._shadowYOffset+"px "+this._ui._shadowBlur+"px "+this._ui._shadowColor):De.Util.removeCSSStyle(this._roundDiv,"text-shadow"),this._pointerRect=De.Util.getRect(this._pointers),this._viewRect=De.Util.unionRect(this._pointerRect,this._roundRect),De.Util.setCSSStyle(this._contentDiv,"left",this._contentRect.x+"px"),De.Util.setCSSStyle(this._contentDiv,"top",this._contentRect.y+"px"),De.Util.setCSSStyle(this._roundDiv,"left",this._roundRect.x+"px"),De.Util.setCSSStyle(this._roundDiv,"top",this._roundRect.y+"px"),De.Util.setCSSStyle(this._roundDiv,"width",this._roundRect.width+"px"),De.Util.setCSSStyle(this._roundDiv,"height",this._roundRect.height+"px"),De.Util.setCSSStyle(this._roundDiv,"background",this.isFill()?this.getFillColor():null),De.Util.setCSSStyle(this._roundDiv,"-webkit-border-radius",this.getCornerRadius()+"px"),De.Util.setCSSStyle(this._roundDiv,"-moz-border-radius",this.getCornerRadius()+"px"),De.Util.setCSSStyle(this._roundDiv,"border-radius",this.getCornerRadius()+"px"),this._pointers?(De.Util.setCSSStyle(this._triangleDiv,"left",this._triangleDivLocation.x+"px"),De.Util.setCSSStyle(this._triangleDiv,"top",this._triangleDivLocation.y+"px"),De.Util.setCSSStyle(this._triangleDiv,"border-width",this._triangleBorderWidthStyle),De.Util.setCSSStyle(this._triangleDiv,"border-color",this._triangleBorderColorStyle),this._view.appendChild(this._triangleDiv)):this._triangleDiv.parentNode==this._view&&this._view.removeChild(this._triangleDiv),this._element.getStyle("label.rotatable")&&this.label){var t=this._ui.getFromPoint(),e=this._ui.getToPoint(),i=this._ui.getLinkPoints();i.size()%2==0&&(t=i.get(i.size()/2-1),e=i.get(i.size()/2)),this._radian=t.x>e.x?De.Util.getRadiansBetweenLines(e,t):De.Util.getRadiansBetweenLines(t,e),this._origin={x:this._contentRect.width/2,y:0};var n="rotate("+De.Util.toDegrees(this._radian)+"deg)",o=this._origin.x+"px "+this._origin.y+"px";De.Util.isChrome||De.Util.isSafari?(De.Util.setCSSStyle(this._roundDiv,"-webkit-transform",n),De.Util.setCSSStyle(this._roundDiv,"-webkit-transform-origin",o)):De.Util.isIE?(De.Util.setCSSStyle(this._roundDiv,"-ms-transform",n),De.Util.setCSSStyle(this._roundDiv,"-ms-transform-origin",o)):(De.Util.setCSSStyle(this._roundDiv,"transform",n),De.Util.setCSSStyle(this._roundDiv,"transform-origin",o))}else De.Util.removeCSSStyle(this._roundDiv,"-webkit-transform"),De.Util.removeCSSStyle(this._roundDiv,"-webkit-transform-origin"),De.Util.removeCSSStyle(this._roundDiv,"-ms-transform"),De.Util.removeCSSStyle(this._roundDiv,"-ms-transform-origin"),De.Util.removeCSSStyle(this._roundDiv,"transform"),De.Util.removeCSSStyle(this._roundDiv,"transform-origin"),delete this._origin,delete this._radian}}),De.network.HTMLLabelAttachment=function(t,e){De.network.HTMLBasicAttachment.call(this,t,e),this.label=!0},De.Util.ext("twaver.network.HTMLLabelAttachment",De.network.LabelAttachment,{updateMeasure:function(){var t=this.getFont("label.font"),e=this.getLabel();this._contentDiv.innerHTML=e,De.Util.setCSSStyle(this._contentDiv,"font",t),De.network.HTMLBasicAttachment.prototype.updateMeasure.call(this),De.Util.removeCSSStyle(this._contentDiv,"font")},calculateMeasure:De.network.HTMLBasicAttachment.prototype.calculateMeasure}),De.network.HTMLAlarmAttachment=function(t,e){De.network.HTMLBasicAttachment.call(this,t,e),this.alarm=!0},De.Util.ext("twaver.network.HTMLAlarmAttachment",De.network.AlarmAttachment,{updateMeasure:function(){var t=this.getFont("alarm.font");this._contentDiv.innerHTML=this._network.getAlarmLabel(this._element),De.Util.setCSSStyle(this._contentDiv,"font",t),this._fillColor=this._network.getAlarmFillColor(this._element),De.network.HTMLBasicAttachment.prototype.updateMeasure.call(this),De.Util.removeCSSStyle(this._contentDiv,"font")},calculateMeasure:De.network.HTMLBasicAttachment.prototype.calculateMeasure}),De.network.NodeUI=function(t,e){De.network.NodeUI.superClass.constructor.call(this,t,e)},Me.ext("twaver.network.NodeUI",De.network.ElementUI,{createBodyRect:function(){return this._element.getRect()},invalidate:function(t){De.network.NodeUI.superClass.invalidate.call(this,t);var e=this._element.getAgentLinks();e&&e.forEach(function(t){this._network.invalidateElementUI(t,!1)},this)},updateMeasure:function(){De.network.NodeUI.superClass.updateMeasure.call(this);var t=this.getStyle("vector.shape"),e=this.getBodyRect();this._hotSpot=We.getHotSpot(e.x,e.y,e.width,e.height,t),this.drawBody(),this._outerColor&&this.drawOuterBorder(),!this._editAttachment&&"border"===this.getStyle("select.style")&&this._network.isSelected(this._element)&&this.drawSelectBorder(),this.cleanUp(["_selectCanvas","_nodeCanvas","_nodeImage","_nodeComponent","_vectorCanvas","_outerCanvas"]);var i=this._element.getParent();i instanceof Mn&&this._network.invalidateElementUI(i,!1)},drawBody:function(){var t=this.getStyle("body.type");"default"===t?this.drawDefaultBody():"vector"===t?this.drawVectorBody():"default.vector"===t?(this.drawVectorBody(),this.drawDefaultBody()):"vector.default"===t?(this.drawDefaultBody(),this.drawVectorBody()):this.addBodyBounds({x:this._element.getX(),y:this._element.getY(),width:0,height:0})},drawOuterBorder:function(){var t=this._element,e=t.getStyle("outer.width");if(e>0){var i=this.getBodyRect();We.addPadding(i,t,"outer.padding",1),this._outerCanvas||(this._outerCanvas=Xe.createCanvas());var n=Me.clone(i);We.grow(n,e/2,e/2);var o=Xe.setCanvas(this._outerCanvas,n);o.lineWidth=e,o.lineCap=t.getStyle("outer.cap"),o.lineJoin=t.getStyle("outer.join"),o.strokeStyle=this._outerColor,Ye.drawVector(o,t.getStyle("outer.shape"),null,i),o.stroke(),this.addComponent(this._outerCanvas),this.addBodyBounds(n)}},drawSelectBorder:function(){var t=this._element,e=t.getStyle("select.width");if(e>0){var i=this.getBodyRect();i=Me.clone(i);var n=t.getStyle("select.physicalZoom")?1:this._network.getGraphicsZoom();We.addPadding(i,t,"select.padding",1/n),this._selectCanvas||(this._selectCanvas=Xe.createCanvas()),We.grow(i,e/2/n,e/2/n);var o=Xe.setCanvas(this._selectCanvas,bounds);o.lineWidth=e/n,o.lineCap=t.getStyle("select.cap"),o.lineJoin=t.getStyle("select.join"),o.strokeStyle=t.getStyle("select.color"),Ye.drawVector(o,t.getStyle("select.shape"),null,i),o.stroke(),this.addComponent(this._selectCanvas),this.addBodyBounds(bounds)}},drawDefaultBody:function(){var t=this._element,e=Me.getImageAsset(t.getImage()),i=this.getBodyRect();if(!e)return this.addBodyBounds(i),void(this._currentImageAsset=null);if(We.addPadding(i,this._element,"image.padding",1),e.getImage()){this._nodeCanvas||(this._nodeCanvas=Xe.createCanvas());var n=Me.clone(i),o=this.setShadow(this,this._nodeCanvas,n);0!=t.getAngle()&&(i=t.getOriginalRect(),De.Util.rotateCanvas(o,i,t.getAngle())),Di(o,t.getImage(),this.getInnerColor(),i,t,this._network),i=n,this.addComponent(this._nodeCanvas)}else if(e.getSrc())this._nodeImage||(this._nodeImage=Xe.createImg()),Xe.setImg(this._nodeImage,e.getSrc(),i),this.addComponent(this._nodeImage);else{if(!e.getFunction())throw"ImageAsset '"+t.getImage()+" ' is empty";this._nodeComponent=this._currentImageAsset!==e?e.getFunction()(this,i):e.getFunction()(this,i,this._nodeComponent),this.addComponent(this._nodeComponent),this._nodeComponent._viewRect=Me.clone(i)}this.addBodyBounds(i),this._currentImageAsset=e},hit:function(t,e){if(this._network._transparentSelectionEnable){var i=this.getBodyRect();if(Me.math.containsPoint(i,t,e))return!0}return!!this.hitCanvas(t,e,["_nodeCanvas","_outerCanvas","_vectorCanvas"])||this.hitComponent(t,e,["_nodeImage","_nodeComponent"])},intersects:function(t){if(this._network._transparentSelectionEnable){var e=this.getBodyRect();if(Me.math.intersects(e,t))return!0}return!!this.intersectsCanvas(t,["_nodeCanvas","_outerCanvas","_vectorCanvas"])||this.intersectsComponent(t,["_nodeImage","_nodeComponent"])},drawVectorBody:function(){this._vectorCanvas||(this._vectorCanvas=Xe.createCanvas());var t=Ye.drawPath(this,this._vectorCanvas,"vector",!0,this._element.getStyle("vector.outline.pattern")),e=this.getStyle("vector.deep"),i=this._vectorCanvas.getContext("2d"),n=this.getBodyRect(),o=this.getStyle("vector.fill.color");if(0!==e&&o){var r=this._element.getAngle();0!=r&&(n=this._element.getOriginalRect(),De.Util.rotateCanvas(i,n,-r),De.Util.rotateCanvas(i,n,r)),"rectangle"===this.getStyle("vector.shape")&&Ye.draw3DRect(i,o,e,n)}this.addBodyBounds(t),this.addComponent(this._vectorCanvas)}}),De.network.LinkUI=function(t,e){De.network.LinkUI.superClass.constructor.call(this,t,e),this._linkCanvas=Xe.createCanvas()},Me.ext("twaver.network.LinkUI",De.network.ElementUI,{isEditable:function(){return!(!vi.isOrthogonalLink(this._element)||!this.getControlPoint())},createBodyRect:function(){var t=this.getHotSpot();return t?{x:t.x-1,y:t.y-1,width:2,height:2}:null},hit:function(t,e){return this.hitCanvas(t,e,["_linkCanvas"])},intersects:function(t){return this.intersectsCanvas(t,["_linkCanvas"])},checkAttachments:function(){De.network.LinkUI.superClass.checkAttachments.call(this),this.checkLinkHandlerAttachment()},checkLinkHandlerAttachment:function(){var t=this._network.getLinkHandlerLabel(this._element);null!=t&&""!==t?this._linkHandlerAttachment||(this._linkHandlerAttachment=new De.network.LinkHandlerAttachment(this),this.addAttachment(this._linkHandlerAttachment)):this._linkHandlerAttachment&&(this.removeAttachment(this._linkHandlerAttachment),this._linkHandlerAttachment=null)},getLinkHandlerAttachment:function(){return this._linkHandlerAttachment},getLinkPoints:function(){return this._linkPoints||(this._linkPoints=this.createLinkPoints(),this._lineLength=We.calculateLineLength(this._linkPoints)),this._linkPoints},invalidate:function(t){this._linkPoints=null,this._fromPoint=null,this._toPoint=null,De.network.LinkUI.superClass.invalidate.call(this,t)},getFromPosition:function(t,e){var i=this.getFromPoint();return i?{x:i.x+t,y:i.y+e}:null},getToPosition:function(t,e){var i=this.getToPoint();return i?{x:i.x+t,y:i.y+e}:null},getFromPoint:function(){return this._fromPoint||(this._fromPoint=vi.createFromPoint(this)),this._fromPoint},getToPoint:function(){return this._toPoint||(this._toPoint=vi.createToPoint(this)),this._toPoint},updateMeasure:function(){De.network.LinkUI.superClass.updateMeasure.call(this),this.drawBody()},createLinkPoints:function(){var t=this.getFromPoint(),e=this.getToPoint(),i=this.getStyle("link.type"),n=new hn;if(vi.isOrthogonalOrFlexionalLink(this._element))n=vi.orthogonalAndFlexional(this,i);else if(this._element.isLooped()){var o=this._network.getElementUI(this._element.getFromAgent());null!=o&&(this._hotSpot=vi.fillLoopedPoints(this,o.getBodyRect(),n))}else{if("arc"!==i&&"triangle"!==i&&"parallel"!==i)throw"Can not resolve link type '"+i+"'";this._hotSpot=vi.fillBundlePoints(this,i,t,e,n)}if(this._network._linkPathFunction){var r=this._network._linkPathFunction(this,n);r&&(n=r)}return n},drawLinePoints:function(t,e,i,n,o){if(t.lineWidth=i,t.strokeStyle=n,!0===this._element.getStyle("link.flow")&&o&&o.length>1){var r=new gi(t,o[0],o[1]),a=this._element.getStyle("link.flow.offset");this._element.getStyle("link.flow.converse")?a<o[0]?r.overflow=o[0]-a:a>=o[0]&&a<=o[0]+o[1]?(r.overflow=o[1]-(a-o[0]),r.overflow&&(r.isLine=!1)):(a-=o[0]+o[1],r.overflow=o[0]-a):a<=o[1]?(r.overflow=a,a&&(r.isLine=!1)):a>o[1]&&a<=o[0]+o[1]?r.overflow=a-o[1]:(a-=o[0]+o[1],a&&(r.isLine=!1),r.overflow=a),this._element._styleMap["link.flow.offset"]=a,t.beginPath(),Ye._drawLine(e,t),t.stroke(),t.shadowColor="transparent",t.beginPath();var s=this._element.getStyle("link.flow.color");s=s||kn.NETWORK_LINK_FLOW_COLOR,t.strokeStyle=s,Ye._drawLine(e,r),t.stroke(),t.shadowColor=this._shadowColor}else t.beginPath(),Ye.drawLinePoints(t,e,o),t.stroke()},drawBody:function(){var t=this.getLinkPoints();if(t&&!(t.size()<2)){var e=this._element,i=We.getLineRect(t),n=e.getStyle("link.width"),o=n;if(this._outerColor){var r=e.getStyle("outer.width");o+=2*r}var a=!this._editAttachment&&"border"===e.getStyle("select.style")&&this._network.isSelected(this._element);if(a){o+=2*e.getStyle("select.width")}We.grow(i,o/2,o/2),e.getStyle("arrow.from")&&(i=We.unionRect(i,cn.getArrowRect(t,!0,e.getStyle("arrow.from.shape"),e.getStyle("arrow.from.width"),e.getStyle("arrow.from.height"),e.getStyle("arrow.from.xoffset"),e.getStyle("arrow.from.yoffset")))),e.getStyle("arrow.to")&&(i=We.unionRect(i,cn.getArrowRect(t,!1,e.getStyle("arrow.to.shape"),e.getStyle("arrow.to.width"),e.getStyle("arrow.to.height"),e.getStyle("arrow.to.xoffset"),e.getStyle("arrow.to.yoffset"))));var s=this.setShadow(this,this._linkCanvas,i);s.lineCap=e.getStyle("link.cap"),s.lineJoin=e.getStyle("link.join");var l=e.getStyle("link.pattern");a&&this.drawLinePoints(s,t,o,e.getStyle("select.color"),l),this._outerColor&&this.drawLinePoints(s,t,n+2*r,this._outerColor,l),this.drawLinePoints(s,t,n,this._innerColor||e.getStyle("link.color"),l),this.addBodyBounds(i),this.addComponent(this._linkCanvas),cn.drawLinkArrow(this,s,t)}},getControlPoint:function(){return vi.getControlPoint(this._element,this)},setControlPoint:function(t){if(t){var e=this.getStyle("link.type");if(vi.hasControlPoint(e)){var i=vi.getLinkSourceBounds(this),n=vi.getLinkTargetBounds(this);vi.setParamsByControlPoint(t,i,n,e,this._element)}}},getLineLength:function(){return this._lineLength}}),De.network.HTMLLinkUI=function(t,e){De.network.HTMLLinkUI.superClass.constructor.call(this,t,e)},Me.ext("twaver.network.HTMLLinkUI",De.network.LinkUI,{checkAttachments:function(){De.network.LinkUI.prototype.checkAttachments.call(this)},checkLabelAttachment:function(){var t=this._element.getStyle("attachment.label.style");if(t&&"none"===t)return void De.network.HTMLLinkUI.superClass.checkLabelAttachment.call(this);var e=this._network.getLabel(this._element);null!=e&&""!==e?this._labelAttachment||(this._labelAttachment=new De.network.HTMLLabelAttachment(this),this.addAttachment(this._labelAttachment)):this._labelAttachment&&(this.removeAttachment(this._labelAttachment),this._labelAttachment=null)},checkAlarmAttachment:function(){var t=this._element.getStyle("attachment.alarm.style");if(t&&"none"===t)return void De.network.HTMLLinkUI.superClass.checkAlarmAttachment.call(this);var e=this._network.getAlarmLabel(this._element);null!=e&&""!==e?this._alarmAttachment||(this._alarmAttachment=new De.network.HTMLAlarmAttachment(this,!1),this.addAttachment(this._alarmAttachment)):this._alarmAttachment&&(this.removeAttachment(this._alarmAttachment),this._alarmAttachment=null)}}),De.network.GroupUI=function(t,e){De.network.GroupUI.superClass.constructor.call(this,t,e)},Me.ext("twaver.network.GroupUI",De.network.NodeUI,{isEditable:function(){return!this._element.isExpanded()},drawBody:function(){this.getBodyRect(),this._shapeRect?this.drawExpandedGroup():De.network.GroupUI.superClass.drawBody.call(this)},drawExpandedGroup:function(){this._nodeCanvas||(this._nodeCanvas=Xe.createCanvas());var t=Ye.drawPath(this,this._nodeCanvas,"group",!1,this._element.getStyle("vector.outline.pattern")),e=this.getStyle("group.deep"),i=this.getStyle("group.fill.color");0!==e&&i&&"rectangle"===this.getStyle("group.shape")&&Ye.draw3DRect(this._nodeCanvas.getContext("2d"),i,e,this._bodyRect),this.addBodyBounds(t),this.addComponent(this._nodeCanvas)},getChildrenRects:function(){return this._network.getGroupChildrenRects(this._element)},createBodyRect:function(){this._shapeRect=null;var t=this._element;if(t.isExpanded()){var e=this.getChildrenRects();if(!e.isEmpty()){var i=t.getStyle("group.shape"),n=Ge[i];if(!n)throw"Can not resolve group shape '"+i+"'";this._shapeRect=n(e)}}return this._shapeRect?(We.addPadding(this._shapeRect,t,"group.padding",1),this._shapeRect):De.network.GroupUI.superClass.createBodyRect.call(this)}}),De.network.GridUI=function(t,e){De.network.GridUI.superClass.constructor.call(this,t,e)},Me.ext("twaver.network.GridUI",De.network.NodeUI,{drawDefaultBody:function(){this._element.getImage()?De.network.GridUI.superClass.drawDefaultBody.call(this):this.drawGridBody()},drawGridBody:function(){var t=this.getStyle("grid.fill"),e=this.getStyle("grid.deep"),i=this.getStyle("grid.cell.deep");if(t||0!==e||0!==i){var n=this.getBodyRect(),o=this.getDyeColor("grid.fill.color");this._nodeCanvas||(this._nodeCanvas=Xe.createCanvas());var r=Me.clone(n),a=this.setShadow(this,this._nodeCanvas,r);if(a.rect(n.x,n.y,n.width,n.height),this.addComponent(this._nodeCanvas),t&&(a.fillStyle=o,a.fill()),0!=e&&Ye.draw3DRect(a,o,e,n.x,n.y,n.width,n.height),0!=i)for(var s=this.getStyle("grid.row.count"),l=this.getStyle("grid.column.count"),h=0;s>h;h++)for(var c=0;l>c;c++){var u=this._element.getCellRect(h,c);null!=u&&Ye.draw3DRect(a,o,i,u.x,u.y,u.width,u.height)}this.addBodyBounds(r)}}}),De.network.ShapeNodeUI=function(t,e){De.network.ShapeNodeUI.superClass.constructor.call(this,t,e)},Me.ext("twaver.network.ShapeNodeUI",De.network.NodeUI,{drawDefaultBody:function(){if(this._element._points.size()<2)return void this.addBodyBounds({x:this._element.getX(),y:this._element.getY(),width:0,height:0});this._nodeCanvas||(this._nodeCanvas=Xe.createCanvas());var t=Ye.drawPath(this,this._nodeCanvas,"vector",!0,this._element.getStyle("vector.outline.pattern"),this._element._points,this._element._segments,this._element.getStyle("shapenode.closed"));this.addBodyBounds(t),this.addComponent(this._nodeCanvas),cn.drawLinkArrow(this,this._nodeCanvas.getContext("2d"),We.getPointObject(this._element._points,this._element._segments))},drawSelectBorder:function(){var t=this._element,e=t.getStyle("select.width");if(e>0){var i=this.getBodyRect();i=Me.clone(i);var n=t.getStyle("select.physicalZoom")?1:this._network.getGraphicsZoom();We.addPadding(i,t,"select.padding",1/n);var o=t.getStyle("vector.outline.width");o>0&&We.grow(i,o/2,o/2),this._selectCanvas||(this._selectCanvas=Xe.createCanvas()),We.grow(i,e/2/n,e/2/n);var r=Xe.setCanvas(this._selectCanvas,i);r.lineWidth=e/n,r.lineCap=t.getStyle("select.cap"),r.lineJoin=t.getStyle("select.join"),r.strokeStyle=t.getStyle("select.color"),Ye.drawVector(r,t.getStyle("select.shape"),null,i),r.stroke(),this.addComponent(this._selectCanvas),this.addBodyBounds(bounds)}}}),De.network.ShapeLinkUI=function(t,e){De.network.ShapeLinkUI.superClass.constructor.call(this,t,e)},Me.ext("twaver.network.ShapeLinkUI",De.network.LinkUI,{isEditable:function(){return!0},createLinkPoints:function(){var t=this.getFromPoint(),e=this.getToPoint(),i=new hn,n=this.getStyle("shapelink.type");i.add(t),null!=this._element._points&&i.addAll(this._element._points),i.add(e);var o=i.size(),r=Math.floor(o/2);if(o%2==0){var a=i.get(r),s=i.get(r-1);this._hotSpot={x:(a.x+s.x)/2,y:(a.y+s.y)/2}}else this._hotSpot=Me.clone(i.get(r));var l,h,c;if("lineto"===n);else if("quadto"===n){for(l=new hn(i.get(0)),h=1,o=i.size();o>h;h++)l.add(o-1>h?new hn([i.get(h++),i.get(h)]):i.get(h));i=l}else if("cubicto"===n){for(l=new hn(i.get(0)),h=1,o=i.size();o>h;h++)l.add(o-2>h?new hn([i.get(h++),i.get(h++),i.get(h)]):o-1>h?new hn([i.get(h++),i.get(h)]):i.get(h));i=l}else{if("orthogonalto"!==n)throw"Can not resolve shapelink type '"+n+"'";for(c=i.get(0),l=new hn(c),h=1,o=i.size();o>h;h++)if(o-1>h){var u=Me.clone(i.get(h)),d=u.x,f=u.y,p=d-c.x,g=f-c.y;Math.abs(p)>Math.abs(g)?(u.x=d,u.y=c.y):(u.x=c.x,u.y=f),c=u,l.add(c)}else l.add(i.get(h));i=l}return i}}),De.network.RotatableNodeUI=function(t,e){De.network.RotatableNodeUI.superClass.constructor.call(this,t,e)},Me.ext("twaver.network.RotatableNodeUI",De.network.NodeUI,{isEditable:function(){return!1},drawDefaultBody:function(){var t=this._element,e=Me.getImageAsset(t.getImage()),i=this.getBodyRect();if(!e)return this.addBodyBounds(i),void(this._currentImageAsset=null);if(We.addPadding(i,this._element,"image.padding",1),e.getImage()){this._nodeCanvas||(this._nodeCanvas=Xe.createCanvas());var n=Me.clone(i),o=this.setShadow(this,this._nodeCanvas,n),r=this._element._getOrignalWidth(),a=this._element._getOrignalHeight(),s=this._element._getRotateRect();o.save(),o.translate(i.x-s.x+r/2,i.y-s.y+a/2),o.rotate(this._element._angle*Math.PI/180);var i={x:-r/2,y:-a/2,width:r,height:a};Di(o,e.getImage(this._innerColor,i.width,i.height),this._innerColor,i,t,this._network),o.restore(),this.addComponent(this._nodeCanvas)}else if(e.getSrc());else if(!e.getFunction())throw"ImageAsset '"+t.getImage()+" ' is empty";this.addBodyBounds(i),this._currentImageAsset=e}}),De.network.HTMLNodeUI=function(t,e){De.network.HTMLNodeUI.superClass.constructor.call(this,t,e)},De.Util.ext("twaver.network.HTMLNodeUI",De.network.NodeUI,{checkAttachments:function(){De.network.NodeUI.prototype.checkAttachments.call(this)},checkLabelAttachment:function(){var t=this._element.getStyle("attachment.label.style");if(t&&"none"===t)return void De.network.HTMLNodeUI.superClass.checkLabelAttachment.call(this);var e=this._network.getLabel(this._element);null!=e&&""!==e?this._labelAttachment||(this._labelAttachment=new De.network.HTMLLabelAttachment(this,kn.SHOW_LABEL_IN_ATTACHMENT_DIV),this.addAttachment(this._labelAttachment)):this._labelAttachment&&(this.removeAttachment(this._labelAttachment),this._labelAttachment=null)},checkAlarmAttachment:function(){var t=this._element.getStyle("attachment.alarm.style");if(t&&"none"===t)return void De.network.HTMLNodeUI.superClass.checkAlarmAttachment.call(this);var e=this._network.getAlarmLabel(this._element);null!=e&&""!==e?this._alarmAttachment||(this._alarmAttachment=new De.network.HTMLAlarmAttachment(this,!1),this.addAttachment(this._alarmAttachment)):this._alarmAttachment&&(this.removeAttachment(this._alarmAttachment),this._alarmAttachment=null)}}),De.network.interaction.BaseInteraction=function(t){this.network=t},Me.ext("twaver.network.interaction.BaseInteraction",Object,{setUp:function(){},tearDown:function(){},addListener:function(){for(var t=0;t<arguments.length;t++){var e=arguments[t];Xe.addEventListener(e,"handle_"+e,this.network.getView(),this)}},removeListener:function(){for(var t=0;t<arguments.length;t++)Xe.removeEventListener(arguments[t],this.network.getView(),this)},_handle_mousedown:function(t){0===t.button&&(this._startLogical=this.network.getLogicalPoint(t),this._startClient=Xe.getClientPoint(t),this._startLogical&&Xe.handle_mousedown(this,t))},_handle_mousemove:function(t){this._endLogical={x:this._startLogical.x+(t.clientX-this._startClient.x)/this.network.getZoom(),y:this._startLogical.y+(t.clientY-this._startClient.y)/this.network.getZoom()}},_handle_mouseup:function(t){delete this._startClient,delete this._startLogical,delete this._endLogical}}),De.network.interaction.SelectInteraction=function(t){De.network.interaction.SelectInteraction.superClass.constructor.call(this,t)},Me.ext("twaver.network.interaction.SelectInteraction",De.network.interaction.BaseInteraction,{setUp:function(){this.addListener("mousedown")},tearDown:function(){this.removeListener("mousedown"),this.end()},handle_mousedown:function(t){if(this._button=t.button,this.network.isValidEvent(t)&&!this.network.isMovingElement()&&!this.network.isEditingElement()&&!t.shiftKey){var e=this.network.getElementAt(t),i=this.network.getSelectionModel();e?Me.isCtrlDown(t)?i.contains(e)?i.removeSelection(e):i.appendSelection(e):i.contains(e)||i.setSelection(e):(Me.isCtrlDown(t)||i.clearSelection(),this.end(t),this.network.getLogicalPoint(t)&&this.network.isRectSelectEnabled()&&this._handle_mousedown(t))}},handle_mouseup:function(t){this.end(t)},handle_mousemove:function(t){if(0!==this._button||this.network.isMovingElement()||this.network.isEditingElement())return void this.end(t);this._handle_mousemove(t),this.mark?this.network.fireInteractionEvent({kind:"selectBetween",event:t}):(this.mark=Xe.createDiv(),this.network.getTopDiv().appendChild(this.mark),this.network.setSelectingElement(!0),this.network.fireInteractionEvent({kind:"selectStart",event:t}));var e=We.getRect([this._startLogical,this._endLogical]);Xe.setDiv(this.mark,e,this.getIntersectMode()?this.network.getSelectFillColor():null,this.network.getSelectOutlineWidth(),this.network.getSelectOutlineColor())},end:function(t){if(this._startLogical){if(this.mark){if(this._endLogical&&this._startLogical.x!==this._endLogical.x&&this._startLogical.y!==this._endLogical.y){var e=this.network.getElementsAtRect(this.mark._viewRect,this.getIntersectMode(),this.network.getRectSelectFilter());if(e&&e.size()>0){var i=this.network.getSelectionModel(),n=i.toSelection();e.forEach(function(t){i.contains(t)?n.remove(t):n.add(t)},this),i.setSelection(n)}this.network.fireInteractionEvent({kind:"selectEnd",event:t})}var o=this;setTimeout(function(){o.mark&&(o.network.getTopDiv().removeChild(o.mark),o.mark=null)},0),this.network.setSelectingElement(!1)}this._handle_mouseup(t)}},getIntersectMode:function(){return"intersect"===this.network.getSelectMode()||"contain"!==this.network.getSelectMode()&&(this._startLogical.x>this._endLogical.x&&this._startLogical.y>this._endLogical.y)}}),De.network.interaction.MoveInteraction=function(t,e){this.lazyMode=e,this.xoffset=0,this.yoffset=0,De.network.interaction.MoveInteraction.superClass.constructor.call(this,t),this.currentKeyEvent=null},Me.ext("twaver.network.interaction.MoveInteraction",De.network.interaction.BaseInteraction,{setUp:function(){this.addListener("mousedown","keydown","mouseleave")},tearDown:function(){this.removeListener("mousedown","keydown","mouseleave"),this.end()},handle_keydown:function(t){this.currentKeyEvent=t,this.addListener("keyup")},handle_keyup:function(t){this.currentKeyEvent=null,this.removeListener("keyup")},handle_mouseleave:function(t){this.end(t)},isParenting:function(){return this._startLogical&&null!=this.currentKeyEvent&&80===this.currentKeyEvent.keyCode},parentProcess:function(t,e){var i=null;null!=this.parent&&(i=this.network.getElementUI(this.parent).getViewRect(),this.parent=null);var n=this;if(t=this.network.getLogicalPoint(t),!e&&this.isParenting()){var o={};o.x=t.x-1,o.y=t.y-1,o.width=2,o.height=2;var r=this.network.getElementsAtRect(o,!0);if(r&&r.size()>0)for(var a=r.size(),s=0;a>s;s++){var l=r.get(s);if(!n.network.getElementBox().getSelectionModel().contains(l)){n.parent=l;break}}}null!=this.parent&&(i=this.network.getElementUI(this.parent).getViewRect()),null==i||e?this.parentMark&&(this.network.getTopDiv().removeChild(this.parentMark),this.parentMark=null):(this.parentMark||(this.parentMark=Me.html.createDiv(),this.network.getTopDiv().appendChild(this.parentMark)),Me.html.setDiv(this.parentMark,i,this.network.isLazyMoveFill()?this.network.getLazyMoveFillColor():null,this.network.getLazyMoveOutlineWidth(),this.network.getLazyMoveOutlineColor()))},handle_mousedown:function(t){if(0===t.button&&!this.network.isSelectingElement()&&!this.network.isEditingElement()){var e=this.network.getElementAt(t);this.network.isMovable(e)&&(this.end(t),this._handle_mousedown(t))}},handle_mouseup:function(t){this.end(t)},handle_mousemove:function(t){if(this.network.isSelectingElement()||this.network.isEditingElement()||!this.network.hasMovableSelectedElements()||!this._startLogical)return void this.end(t);if(this._handle_mousemove(t),this.xoffset=this._endLogical.x-this._startLogical.x,this.yoffset=this._endLogical.y-this._startLogical.y,this.lazyMode){if(this.mark)this.network.fireInteractionEvent({kind:"lazyMoveBetween",event:t});else{this.mark=Xe.createDiv();var e;this.network.getMovableSelectedElements().forEach(function(t){var i=this.getElementUI(t);i&&(e=We.unionRect(e,i.getViewRect()))},this.network),this.network.getTopDiv().appendChild(this.mark),this.network.setMovingElement(!0),Xe.setDiv(this.mark,e,this.network.isLazyMoveFill()?this.network.getLazyMoveFillColor():null,this.network.getLazyMoveOutlineWidth(),this.network.getLazyMoveOutlineColor()),this.network.fireInteractionEvent({kind:"lazyMoveStart",event:t})}this.mark.style.left=this.xoffset+this.mark._viewRect.x+"px",this.mark.style.top=this.yoffset+this.mark._viewRect.y+"px"}else this._startLogical=this._endLogical,this._startClient=Xe.getClientPoint(t),this.network.isMovingElement()?this.network.fireInteractionEvent({kind:"liveMoveBetween",event:t}):(this.network.setMovingElement(!0),this.network.fireInteractionEvent({kind:"liveMoveStart",event:t})),this.network.moveSelectedElements(this.xoffset,this.yoffset);this.parentProcess(t,!1)},end:function(t){if(this._startLogical){if(this.lazyMode){if(this.mark){var e=this,i=function(){e.network.fireInteractionEvent({kind:"lazyMoveEnd",event:t}),e.mark&&(e.network.getTopDiv().removeChild(e.mark),e.mark=null,e.network.setMovingElement(!1))};this.network.moveSelectedElements(this.xoffset,this.yoffset,this.network.isLazyMoveAnimate(),i)}}else this.network.isMovingElement()&&(this.network.setMovingElement(!1),this.network.fireInteractionEvent({kind:"liveMoveEnd",event:t}));if(this.isParenting()){null==this.parent&&(this.parent=this.network.getCurrentSubNetwork());var e=this;this.network.getMovableSelectedElements().forEach(function(t){t.setParent(e.parent)},this.network)}this.parentProcess(t,!0),this._handle_mouseup(t)}}}),De.network.interaction.DefaultInteraction=function(t){De.network.interaction.DefaultInteraction.superClass.constructor.call(this,t)},Me.ext("twaver.network.interaction.DefaultInteraction",De.network.interaction.BaseInteraction,{setUp:function(){this.addListener("mousedown","mousemove","keydown")},tearDown:function(){this.removeListener("mousedown","mousemove","keydown")},handle_mousedown:function(t){if(this.network.isValidEvent(t)){this.network.isFocusOnClick()&&De.Util.setFocus(this.network.getView());var e=this.network.getElementAt(t);2===t.detail?this.handleDoubleClicked(t,e):this.handleClicked(t,e)}},handleClicked:function(t,e){Ai.handleClicked(this.network,t,e)},handleDoubleClicked:function(t,e){Ai.handleDoubleClicked(this.network,t,e)},handle_keydown:function(t){Ai.handleKeyDown(this.network,t)},handle_mousemove:function(t){var e=this.network.getElementAt(t),i=this._preElement,n=Ci(i),o=Ci(e);i!==e&&(i&&(n&&n.onMouseLeave&&n.onMouseLeave(i,this.network),this.network.onMouseLeave(i,t)),e&&(o&&o.onMouseEnter&&o.onMouseEnter(e,this.network),this.network.onMouseEnter(e,t))),e&&o&&o.onMouseMove&&o.onMouseMove(e,this.network),this.network.onMouseMove(e,t),this._preElement=e}}),De.network.interaction.PanInteraction=function(t){De.network.interaction.PanInteraction.superClass.constructor.call(this,t)},Me.ext("twaver.network.interaction.PanInteraction",De.network.interaction.BaseInteraction,{setUp:function(){this.addListener("mousedown"),this._oldCursor=this.network.getView().style.cursor},tearDown:function(){this.removeListener("mousedown")},handle_mousedown:function(t){this._startLogical=this.network.getLogicalPoint(t),this._startLogical&&(this._handle_mousedown(t),this.network.getView().style.cursor="pointer")},handle_mouseup:function(t){this._clear()},handle_mousemove:function(t){if(this._startLogical){this._handle_mousemove(t);var e=this._startLogical.x-this._endLogical.x,i=this._startLogical.y-this._endLogical.y;this.network.panByOffset(e,i),this._startLogical=this._endLogical,this._startClient=Xe.getClientPoint(t)}},_clear:function(t){this._startLogical&&(this._handle_mouseup(t),this.network.getView().style.cursor=this._oldCursor)}}),De.network.interaction.EditInteraction=function(t,e){this.lazyMode=e,this.pointIndex=-1,De.network.interaction.EditInteraction.superClass.constructor.call(this,t)},Me.ext("twaver.network.interaction.EditInteraction",De.network.interaction.BaseInteraction,{setUp:function(){this.addListener("mousedown","mousemove"),this.oldCursor=this.network.getView().style.cursor,this.network.setHasEditInteraction(!0)},tearDown:function(){this.removeListener("mousedown","mousemove"),this.network.getView().style.cursor=this.oldCursor,this.network.setHasEditInteraction(!1),this.clear()},clear:function(){this.network.setEditingElement(!1),this.network.setRotatingElement(!1),this.isStart=!1,this.isStartRotate=!1,this.node=null,this.shapeNode=null,this.shapeLink=null,this.linkUI=null,this.resizingRect=null,this.resizeDirection=null,this.pointIndex=-1,this._removeCursor(),this.oldCursor=null,this.mouseMoved=!1,this.horizontal=!1,this.vertical=!1,this.mark&&(this.network.getTopDiv().removeChild(this.mark),this.mark=null),this.rotateScale&&this.network.getTopDiv().contains(this.rotateScale)&&(this.network.getTopDiv().removeChild(this.rotateScale),this.rotateScale=null)},_removeCursor:function(){this.cursorID&&(this.network.getView().style.cursor=this.oldCursor||"default",this.cursorID=null),this.resizeDirection=null,this.isCrossCursor=!1},_setCrossCursor:function(){this.isCrossCursor||(this._removeCursor(),this._setCursor("crosshair"),this.isCrossCursor=!0)},_setCursor:function(t){this.cursorID=t,this.network.getView().style.cursor!==this.cursorID&&(this.network.getView().style.cursor=this.cursorID)},handle_mousedown:function(t){if(0===t.button)if(!Me.isAltDown(t)||this.network.isEditingElement())!this.network.isEditingElement()||this.isStart||this.isStartRotate||(this.node&&this.resizeDirection?(this.isStart=!0,this._handle_mousedown(t),this.network.fireInteractionEvent({kind:this.lazyMode?"lazyResizeStart":"liveResizeStart",event:t,element:this.node,resizeDirection:this.resizeDirection})):this.shapeNode&&this.pointIndex>=0?Me.isAltDown(t)?(this.shapeNode.removeAt(this.pointIndex),this.network.fireInteractionEvent({kind:"removePoint",event:t,element:this.shapeNode})):(this.isStart=!0,this._handle_mousedown(t),this.network.fireInteractionEvent({kind:"liveMovePointStart",event:t,element:this.shapeNode,pointIndex:this.pointIndex})):this.shapeLink&&this.pointIndex>=0?Me.isAltDown(t)?(this.shapeLink.removeAt(this.pointIndex),this.network.fireInteractionEvent({kind:"removePoint",event:t,element:this.shapeLink})):(this.isStart=!0,this._handle_mousedown(t),this.network.fireInteractionEvent({kind:"liveMovePointStart",event:t,element:this.shapeLink,pointIndex:this.pointIndex})):this.linkUI?(this.isStart=!0,this._handle_mousedown(t),this.network.fireInteractionEvent({kind:"liveMovePointStart",event:t,element:this.linkUI._element})):this.node&&(this.isStartRotate=!0,this._handle_mousedown(t)));else{var e=this.network.getElementAt(t),i=this.network.getLogicalPoint(t);if(e instanceof De.ShapeNode){var n=this.getPointIndex(e.getPoints(),i,!0);n>0&&(this._handle_mousedown(t),this.pointIndex=n,this.shapeNode=e,e.addPoint(i,n),this._setCrossCursor(),this.network.setEditingElement(!0),this.isStart=!0,this.network.fireInteractionEvent({kind:"addPoint",event:t,element:e,pointIndex:n}),this.network.fireInteractionEvent({kind:"liveMovePointStart",event:t,element:e,pointIndex:n}))}if(e instanceof De.ShapeLink){var o=new De.List(e.getPoints()),r=this.network.getElementUI(e);o.add(r.getFromPoint(),0),o.add(r.getToPoint());var n=this.getPointIndex(o,i)-1;n>0&&(this._handle_mousedown(t),this.pointIndex=n,this.shapeLink=e,e.addPoint(i,n),this._setCrossCursor(),this.network.setEditingElement(!0),this.isStart=!0,this.network.fireInteractionEvent({kind:"addPoint",event:t,element:e,pointIndex:n}),this.network.fireInteractionEvent({kind:"liveMovePointStart",event:t,element:e,pointIndex:n}))}}},handle_mouseup:function(t){if(this.isStart){var e=Me.clone(this._endLogical);if(this.resizingRect)if(this.lazyMode)if(this.network.isResizeAnimate()){var i=this,n=new De.animate.AnimateBounds(this.node,this.resizingRect,function(){i.network.fireInteractionEvent({kind:"lazyResizeEnd",event:t,element:i.node,resizeDirection:i.resizeDirection}),i.clear()});De.animate.AnimateManager.start(n)}else this.node.setLocation(this.resizingRect.x,this.resizingRect.y),this.node.setSize(this.resizingRect.width,this.resizingRect.height),this.network.fireInteractionEvent({kind:"lazyResizeEnd",event:t,element:this.node,resizeDirection:this.resizeDirection});else this.node.setLocation(this.resizingRect.x,this.resizingRect.y),this.node.setSize(this.resizingRect.width,this.resizingRect.height),this.network.fireInteractionEvent({kind:"liveResizeEnd",event:t,element:this.node,resizeDirection:this.resizeDirection});else if(this.shapeNode&&this.pointIndex>=0&&e){var o=this.shapeNode.getPoints().get(this.pointIndex);this.horizontal&&(e.y=o.y),this.vertical&&(e.x=o.x),this.shapeNode.setPoint(this.pointIndex,e),this.network.fireInteractionEvent({kind:"liveMovePointEnd",event:t,element:this.shapeNode,pointIndex:this.pointIndex})}else if(this.shapeLink&&this.pointIndex>=0&&e){var o=this.shapeLink.getPoints().get(this.pointIndex);this.horizontal&&(e.y=o.y),this.vertical&&(e.x=o.x),this.shapeLink.setPoint(this.pointIndex,e),this.network.fireInteractionEvent({kind:"liveMovePointEnd",event:t,element:this.shapeLink,pointIndex:this.pointIndex})}else this.linkUI&&e&&(this.linkUI.setControlPoint(e),this.network.fireInteractionEvent({kind:"liveMovePointEnd",event:t,element:this.linkUI._element}))}this._handle_mouseup(t),this.lazyMode||this.clear()},handle_mousemove:function(t){if(this.isStartRotate&&this.node)return this._handleRotateElement(t,this.node),void(this.network.isShowRotateScale()&&this.showRotateScale());if(this.isStart){if(this.shapeNode&&this.pointIndex>=0)return void this._handleMovingShapeNodePoint(t);if(this.shapeLink&&this.pointIndex>=0)return void this._handleMovingShapeLinkPoint(t);if(this.node&&this.resizeDirection)return void this._handleResizing(t);if(this.linkUI)return void this._handleMovingLinkControlPoint(t)}else if(this.network.isValidEvent(t)){if(this.network.isSelectingElement()||this.network.isMovingElement()||0===this.network.getSelectionModel().size())return void this.clear();var e=this.network.getElementAt(t),i=this.network.getElementUI(e);if(!i||!i.getEditAttachment())return void this.clear();var n=this.network.getLogicalPoint(t);if(e instanceof On){if(this.node=e,this._isEditingShapeNode(n)||this._isResizingNode(n))return void this.network.setEditingElement(!0);if(this._isRotatingElement(n))return this.network.setRotatingElement(!0),void this.network.setEditingElement(!0)}else if(e instanceof De.ShapeLink){if(this.shapeLink=e,this._isEditingShapeLink(n))return void this.network.setEditingElement(!0)}else if(i instanceof De.network.LinkUI){var o=this.network.getEditPointSize();if(vi.isOrthogonalLink(i._element)){this.linkUI=i;var r=this.linkUI.getControlPoint();return void(r&&this._contains(n,r,o)&&(this._setCrossCursor(),this.network.setEditingElement(!0)))}}this.clear()}},_isRotatingElement:function(t){if(0>=this.network.getRotatePointSize())return!1;var e=this.node.getOriginalRect(),i=this.node.getAngle();return this._isRotating(t,"crosshair",e,i)},_isRotating:function(t,e,i,n){var o=this.network.getRotatePointSize(),r={x:i.x+i.width/2,y:i.y-this.network.getRotatePointOffset()-o},a=this._rotatePoint(r,n,i),s={x:a.x-o,y:a.y-o,width:2*o,height:2*o};return!!We.containsPoint(s,t)&&(this._removeCursor(),this._setCursor(e),!0)},_handleRotateElement:function(t,e){this._handle_mousemove(t);var i=this._calculateAngle(this.network.getLogicalPoint(t),e);e.setAngle(i)},_calculateAngle:function(t,e){var i=e.getCenterLocation();return Math.round(180*Math.atan2(i.x-t.x,t.y-i.y)/Math.PI+180)},_handleMovingShapeNodePoint:function(t){if(this._handle_mousemove(t),!this.mouseMoved&&Me.isCtrlDown(t)){var e=this._endLogical.x-this._startLogical.x,i=this._endLogical.y-this._startLogical.y;this.horizontal=Math.abs(e)>=Math.abs(i),this.vertical=!this.horizontal,this.mouseMoved=!0}var n=this.shapeNode.getPoints().get(this.pointIndex),o=Me.clone(this._endLogical);this.horizontal&&(o.y=n.y),this.vertical&&(o.x=n.x),this.shapeNode.setPoint(this.pointIndex,o),this.network.fireInteractionEvent({kind:"liveMovePointBetween",e:t,element:this.shapeNode,pointIndex:this.pointIndex})},_handleMovingShapeLinkPoint:function(t){if(this._handle_mousemove(t),!this.mouseMoved&&Me.isCtrlDown(t)){var e=this._endLogical.x-this._startLogical.x,i=this._endLogical.y-this._startLogical.y;this.horizontal=Math.abs(e)>=Math.abs(i),this.vertical=!this.horizontal,this.mouseMoved=!0}var n=this.shapeLink.getPoints().get(this.pointIndex),o=Me.clone(this._endLogical);this.horizontal&&(o.y=n.y),this.vertical&&(o.x=n.x),this.shapeLink.setPoint(this.pointIndex,o),this.network.fireInteractionEvent({kind:"liveMovePointBetween",e:t,element:this.shapeLink,pointIndex:this.pointIndex})},_handleMovingLinkControlPoint:function(t){this._handle_mousemove(t),this.linkUI.setControlPoint(Me.clone(this._endLogical)),this.network.fireInteractionEvent({kind:"liveMovePointBetween",e:t,element:this.linkUI._element})},_handleResizing:function(t){this._handle_mousemove(t);var e=this.node.getAngle(),i=this.node.getLocation(),n=this.node.getWidth()/2,o=this.node.getHeight()/2,r={x:i.x+n,y:i.y+o},a={x:-n,y:-o},s={x:-n,y:o},l={x:n,y:o},h={x:n,y:-o},c={x:0,y:-o},u={x:n,y:0},d={x:0,y:o},f={x:-n,y:0};if("northwest"===this.resizeDirection&&(this._transformPoint(l,r,e),a.x=this._endLogical.x,a.y=this._endLogical.y,r.x=(a.x+l.x)/2,r.y=(a.y+l.y)/2,this._reversPoint(a,r,e),this._reversPoint(l,r,e),this.resizingRect={x:a.x,y:a.y,width:l.x-a.x,height:l.y-a.y}),"north"===this.resizeDirection){var p={x:this._endLogical.x,y:this._endLogical.y};this._reversPoint(p,r,e),c.y=p.y-r.y,this._transformPoint(c,r,e),this._transformPoint(d,r,e),r.x=(c.x+d.x)/2,r.y=(c.y+d.y)/2,this._reversPoint(c,r,e),this._reversPoint(d,r,e),this.resizingRect={x:r.x-this.node.getWidth()/2,y:r.y-(d.y-c.y)/2,width:this.node.getWidth(),height:d.y-c.y}}if("northeast"===this.resizeDirection&&(this._transformPoint(s,r,e),h.x=this._endLogical.x,h.y=this._endLogical.y,r.x=(s.x+h.x)/2,r.y=(s.y+h.y)/2,this._reversPoint(s,r,e),this._reversPoint(h,r,e),this.resizingRect={x:s.x,y:h.y,width:h.x-s.x,height:s.y-h.y}),"west"===this.resizeDirection){var p={x:this._endLogical.x,y:this._endLogical.y};this._reversPoint(p,r,e),f.x=p.x-r.x,this._transformPoint(u,r,e),this._transformPoint(f,r,e),r.x=(u.x+f.x)/2,r.y=(u.y+f.y)/2,this._reversPoint(u,r,e),this._reversPoint(f,r,e),this.resizingRect={x:r.x-(u.x-f.x)/2,y:r.y-this.node.getHeight()/2,width:u.x-f.x,height:this.node.getHeight()}}if("east"===this.resizeDirection){var p={x:this._endLogical.x,y:this._endLogical.y};this._reversPoint(p,r,e),u.x=p.x-r.x,this._transformPoint(u,r,e),this._transformPoint(f,r,e),r.x=(u.x+f.x)/2,r.y=(u.y+f.y)/2,this._reversPoint(u,r,e),this._reversPoint(f,r,e),this.resizingRect={x:r.x-(u.x-f.x)/2,y:r.y-this.node.getHeight()/2,width:u.x-f.x,height:this.node.getHeight()}}if("southwest"===this.resizeDirection&&(this._transformPoint(h,r,e),s.x=this._endLogical.x,s.y=this._endLogical.y,r.x=(s.x+h.x)/2,r.y=(s.y+h.y)/2,this._reversPoint(s,r,e),this._reversPoint(h,r,e),this.resizingRect={x:s.x,y:h.y,width:h.x-s.x,height:s.y-h.y}),"south"===this.resizeDirection){var p={x:this._endLogical.x,y:this._endLogical.y};this._reversPoint(p,r,e),d.y=p.y-r.y,this._transformPoint(c,r,e),this._transformPoint(d,r,e),r.x=(c.x+d.x)/2,r.y=(c.y+d.y)/2,this._reversPoint(c,r,e),this._reversPoint(d,r,e),this.resizingRect={x:r.x-this.node.getWidth()/2,y:r.y-(d.y-c.y)/2,width:this.node.getWidth(),height:d.y-c.y}}"southeast"===this.resizeDirection&&(this._transformPoint(a,r,e),l.x=this._endLogical.x,l.y=this._endLogical.y,r.x=(a.x+l.x)/2,r.y=(a.y+l.y)/2,this._reversPoint(a,r,e),this._reversPoint(l,r,e),this.resizingRect={x:a.x,y:a.y,width:l.x-a.x,height:l.y-a.y}),this.lazyMode?(this.mark||(this.mark=Xe.createDiv(),this.mark.style.webkitTransform="rotate("+e+"deg)",this.mark.style.mozTransform="rotate("+e+"deg)",this.mark.style.OTransform="rotate("+e+"deg)",this.mark.style.msTransform="rotate("+e+"deg)",this.mark.style.transform="rotate("+e+"deg)",this.network.getTopDiv().appendChild(this.mark)),Xe.setDiv(this.mark,this.resizingRect,null,this.network.getResizeLineWidth(),this.network.getResizeLineColor()),this.network.fireInteractionEvent({kind:"lazyResizeBetween",event:t,element:this.node,resizeDirection:this.resizeDirection})):(this.node.setSize(this.resizingRect.width,this.resizingRect.height),this.node.setLocation(this.resizingRect.x,this.resizingRect.y),this.network.fireInteractionEvent({kind:"liveResizeBetween",event:t,element:this.node,resizeDirection:this.resizeDirection}))},_isEditingShapeNode:function(t){var e=this.network.getEditPointSize();if(this.node instanceof De.ShapeNode){this.shapeNode=this.node;for(var i=this.shapeNode.getPoints(),n=0,o=i.size();o>n;n++){var r=i.get(n);if(this._contains(t,r,e))return this._setCrossCursor(),this.pointIndex=n,!0}}return this.pointIndex=-1,!1},_isEditingShapeLink:function(t){for(var e=this.shapeLink.getPoints(),i=this.network.getEditPointSize(),n=0,o=e.size();o>n;n++){var r=e.get(n);if(this._contains(t,r,i))return this._setCrossCursor(),this.pointIndex=n,!0}return this.pointIndex=-1,!1},_isResizingNode:function(t){if(0>=this.network.getResizePointSize())return!1;var e=this.node.getOriginalRect(),i=this.node.getAngle(),n={x:e.x,y:e.y},o=this._rotatePoint(n,i,e);return!!this._isResizing(t,o.x,o.y,"northwest","nwse-resize")||(n={x:e.x+e.width/2,y:e.y},o=this._rotatePoint(n,i,e),!!this._isResizing(t,o.x,o.y,"north","ns-resize")||(n={x:e.x+e.width,y:e.y},o=this._rotatePoint(n,i,e),!!this._isResizing(t,o.x,o.y,"northeast","nesw-resize")||(n={x:e.x,y:e.y+e.height/2},o=this._rotatePoint(n,i,e),!!this._isResizing(t,o.x,o.y,"west","ew-resize")||(n={x:e.x+e.width,y:e.y+e.height/2},o=this._rotatePoint(n,i,e),!!this._isResizing(t,o.x,o.y,"east","ew-resize")||(n={x:e.x,y:e.y+e.height},o=this._rotatePoint(n,i,e),!!this._isResizing(t,o.x,o.y,"southwest","nesw-resize")||(n={x:e.x+e.width/2,y:e.y+e.height},o=this._rotatePoint(n,i,e),!!this._isResizing(t,o.x,o.y,"south","ns-resize")||(n={x:e.x+e.width,y:e.y+e.height},o=this._rotatePoint(n,i,e),!!this._isResizing(t,o.x,o.y,"southeast","nwse-resize"))))))))},_rotatePoint:function(t,e,i){return We.createMatrix(e*Math.PI/180,i.x+i.width/2,i.y+i.height/2).transform(t)},_isResizing:function(t,e,i,n,o){var r=this.network.getResizePointSize();return!!this._contains(t,{x:e,y:i},r)&&(this.resizeDirection!==n&&(this._removeCursor(),o=this._changeCursorWithAngle(n,this.node.getAngle()),this._setCursor(o),this.resizeDirection=n),!0)},_getRect:function(t,e,i,n){return{x:i>t?t:i,y:n>e?e:n,width:Math.abs(t-i),height:Math.abs(e-n)}},_contains:function(t,e,i){var n={x:e.x-i,y:e.y-i,width:2*i,height:2*i};return We.containsPoint(n,t)},getPointIndex:function(t,e,i){if(t.size()<2)return 0;for(var n,o=t.get(0),r=1;r<t.size();r++){if(n=t.get(r),this.isPointOnLine(e,o,n,6))return r;o=n}return o=t.get(0),i&&this.isPointOnLine(e,o,n,6)?t.size():0},showRotateScale:function(){this.rotateScale||(this.rotateScale=Me.html.createCanvas());var t,e,i,n,o,r=(new De.List,this.network.getRotateScaleWidth()),a=this.network.getRotateScaleHeight(),s=this.network.getRotatePointSize(),l=this.node.getAngle(),h=this.node.getOriginalRect(),c={x:h.x+h.width/2,y:h.y-this.network.getRotatePointOffset()-s},u=this._rotatePoint(c,l,h),d=l+"°";this.node.getAngle()>=0&&this.node.getAngle()<=180?(e={x:u.x+s,y:u.y},i={x:e.x+r,y:e.y},n={x:i.x,y:i.y-a},o={x:e.x,y:n.y}):this.node.getAngle()>180&&this.node.getAngle()<=360&&(e={x:u.x-s,y:u.y},i={x:e.x-r,y:e.y},n={x:i.x,y:i.y-a},o={x:e.x,y:n.y});var f=new De.List([e,i,n,o]),t=Me.math.getRect(f),p=Me.html.setCanvas(this.rotateScale,t);p.fillStyle=this.network.getRotateScaleFillColor(),p.fillRect(t.x,t.y,t.width,t.height),p.fillStyle=this.network.getRotateScaleFontColor(),p.textBaseline="middle",p.textAlign="center",p.font="13px Arial",p.fillText(d,t.x+t.width/2,t.y+t.height/2),this.network.getTopDiv().appendChild(this.rotateScale)},isPointOnLine:function(t,e,i,n){return 0>n&&(n=0),n>=this.getDistanceFromPointToLine(t,e,i)&&t.x>=Math.min(e.x,i.x)-n&&t.x<=Math.max(e.x,i.x)+n&&t.y>=Math.min(e.y,i.y)-n&&t.y<=Math.max(e.y,i.y)+n},getDistanceFromPointToLine:function(t,e,i){if(e.x===i.x)return Math.abs(t.x-e.x);var n=(i.y-e.y)/(i.x-e.x),o=(i.x*e.y-e.x*i.y)/(i.x-e.x);return Math.abs(n*t.x-t.y+o)/Math.sqrt(n*n+1)},_transformPoint:function(t,e,i){var n=Math.cos(i*Math.PI/180),o=Math.sin(i*Math.PI/180),r=t.x,a=t.y,s=r*n-a*o,l=r*o+a*n;t.x=s+e.x,t.y=l+e.y},_reversPoint:function(t,e,i){i*=-1;var n=Math.cos(i*Math.PI/180),o=Math.sin(i*Math.PI/180),r=t.x-e.x,a=t.y-e.y,s=r*n-a*o,l=r*o+a*n;t.x=s+e.x,t.y=l+e.y},_changeCursorWithAngle:function(t,e){var i,n=["auto","nwse-resize","ns-resize","nesw-resize","ew-resize","nwse-resize","ns-resize","nesw-resize","ew-resize"];switch(t){case"northwest":i=1;break;case"north":i=2;break;case"northeast":i=3;break;case"east":i=4;break;case"southeast":i=5;break;case"south":i=6;break;case"southwest":i=7;break;case"west":i=8;break;default:i=0}return(e>=360||-360>=e)&&(e%=360),e>22.5&&67.5>=e&&(i+=1),-22.5>e&&e>=-67.5&&(i-=1),e>67.5&&112.5>=e&&(i+=2),-67.5>e&&e>=-112.5&&(i-=2),e>112.5&&157.5>=e&&(i+=3),-112.5>e&&e>=-157.5&&(i-=3),e>157.5&&202.5>=e&&(i+=4),-157.5>e&&e>=-202.5&&(i-=4),e>202.5&&247.5>=e&&(i+=5),-202.5>e&&e>=-247.5&&(i-=5),e>247.5&&292.5>=e&&(i+=6),-247.5>e&&e>=-292.5&&(i-=6),e>292.5&&337.5>=e&&(i+=7),-292.5>e&&e>=-337.5&&(i-=7),i>8&&(i-=8),0>=i&&(i+=8),n[i]}}),De.network.interaction.CreateElementInteraction=function(t,e){e||(e=On),this.elementFunction=De.Util.isTypeOf(e,On)?function(t){var i=new e;return i instanceof On&&i.setCenterLocation(t),i}:e,De.network.interaction.CreateElementInteraction.superClass.constructor.call(this,t)},Me.ext("twaver.network.interaction.CreateElementInteraction",De.network.interaction.BaseInteraction,{setUp:function(){this.addListener("mousedown")},tearDown:function(){this.removeListener("mousedown")},handle_mousedown:function(t){var e=this.network.getLogicalPoint(t);if(e){var i=this.elementFunction(e);i&&this.network.addElementByInteraction(i)}}}),De.network.interaction.CreateLinkInteraction=function(t,e){e||(e=De.Link),this.linkFunction=De.Util.isTypeOf(e,De.Link)?function(t,i){var n=new e;return n instanceof De.Link&&(n.setFromNode(t),n.setToNode(i)),n}:e,De.network.interaction.CreateLinkInteraction.superClass.constructor.call(this,t)},Me.ext("twaver.network.interaction.CreateLinkInteraction",De.network.interaction.BaseInteraction,{setUp:function(){this.addListener("mousedown","mousemove")},tearDown:function(){this.removeListener("mousedown","mousemove"),this.clear()},clear:function(){var t=this;setTimeout(function(){t._fromRectangle&&(t.network.getTopDiv().removeChild(t._fromRectangle),t._fromRectangle=null),t._currentRectangle&&(t.network.getTopDiv().removeChild(t._currentRectangle),t._currentRectangle=null),t._line&&(t.network.getTopDiv().removeChild(t._line),t._line=null)}),this.currentPoint=null,this.currentNode=null,this.fromNode=null,this.toNode=null},createLink:function(){return this.linkFunction(this.fromNode,this.toNode)},handle_mousedown:function(t){if(this.network.isValidEvent(t))if(this.fromNode){if(this.toNode=this.currentNode,this.toNode){var e=this.createLink();e&&this.network.addElementByInteraction(e)}this.clear()}else this.fromNode=this.currentNode,this.currentNode=null,this.currentPoint=null,this.updateMark()},handle_mousemove:function(t){var e=this.network.getLogicalPoint(t);if(e){if(this.network.isMovingElement()||this.network.isEditingElement())return void this.clear();var i=null;this.fromNode?(this.currentNode=this.getToNode(t),this.currentPoint=e,this.updateMark()):(i=this.getFromNode(t),this.currentNode!==i&&(this.currentNode=i,this.updateMark()))}},getFromNode:function(t){return this.getNode(t)},getToNode:function(t){return this.getNode(t)},getNode:function(t){var e=this.network.getElementAt(t);return e instanceof On&&this.network.isLinkable(e)?e:null},updateMark:function(){var t;this.fromNode&&!this._fromRectangle&&this._currentRectangle&&(this._fromRectangle=this._currentRectangle,this._currentRectangle=null),!this.fromNode&&this._fromRectangle&&(this.network.getTopDiv().removeChild(this._fromRectangle),this._fromRectangle=null),this.currentNode&&!this._currentRectangle&&(t=this.network.getElementUI(this.currentNode),this._currentRectangle=Xe.createDiv(),this.network.getTopDiv().appendChild(this._currentRectangle),Xe.setDiv(this._currentRectangle,t._viewRect,null,this.network.getEditLineWidth(),this.network.getEditLineColor())),!this.currentNode&&this._currentRectangle&&(this.network.getTopDiv().removeChild(this._currentRectangle),this._currentRectangle=null),this.updateLine()},updateLine:function(){if(this.currentPoint){var t=this.fromNode.getCenterLocation(),e=t.x,i=t.y,n=this.currentPoint.x,o=this.currentPoint.y;this._line||(this._line=Xe.createCanvas(),this.network.getTopDiv().appendChild(this._line));var r=Xe.setCanvas(this._line,Math.min(e,n),Math.min(i,o),Math.abs(e-n),Math.abs(i-o));r.lineWidth=this.network.getEditLineWidth(),r.strokeStyle=this.network.getEditLineColor(),r.beginPath(),r.moveTo(e,i),r.lineTo(n,o),r.stroke()}else this._line&&(this.network.getTopDiv().removeChild(this._line),this._line=null)}}),De.network.interaction.CreateShapeNodeInteraction=function(t,e){e||(e=De.ShapeNode),this.shapeNodeFunction=De.Util.isTypeOf(e,De.ShapeNode)?function(t){var i=new e;return i instanceof De.ShapeNode&&t&&i.setPoints(t),i}:e,De.network.interaction.CreateShapeNodeInteraction.superClass.constructor.call(this,t),this.timeStamp=-1},Me.ext("twaver.network.interaction.CreateShapeNodeInteraction",De.network.interaction.BaseInteraction,{setUp:function(){this.addListener("mousedown","mousemove")},tearDown:function(){this.removeListener("mousedown","mousemove"),this.clear()},clear:function(){this.network.setEditingElement(!1),this.points=null,this.currentPoint=null,this.lastPoint=null,this.horizontal=!1,this.vertical=!1,this.mark&&(this.network.getTopDiv().removeChild(this.mark),this.mark=null)},handle_mousedown:function(t){if(0===t.button){var e=this.network.getLogicalPoint(t);if(e){if(2===t.detail||t.timeStamp-this.timeStamp<300){if(this.points){var i=this.shapeNodeFunction(this.points);this.network.addElementByInteraction(i),this.clear();var n=this;setTimeout(function(){n.network.setEditingElement(!1)},0)}}else{if(this.network.isEditingElement()||this.network.setEditingElement(!0),this.points||(this.points=new hn),this.points.size()>0){var o=this.points.get(this.points.size()-1);if(o.x===e.x&&o.y===e.y)return}this._handle_mousedown(t),this.points.size()>0&&Me.isCtrlDown(t)&&(this.horizontal&&(e.y=o.y),this.vertical&&(e.x=o.x),this.horizontal=!1,this.vertical=!1),this.lastPoint=e,this.points.add(e),this.updateMark()}this.timeStamp=t.timeStamp}}},handle_mousemove:function(t){if(this.points){if(this.currentPoint=this.network.getLogicalPoint(t),Me.isCtrlDown(t)){var e=this.currentPoint.x-this.lastPoint.x,i=this.currentPoint.y-this.lastPoint.y;this.horizontal=Math.abs(e)>=Math.abs(i),this.vertical=!this.horizontal}else this.horizontal=!1,this.vertical=!1;this.horizontal&&(this.currentPoint.y=this.lastPoint.y),this.vertical&&(this.currentPoint.x=this.lastPoint.x),this.updateMark()}},updateMark:function(t){if(this.points&&this.points.size()>0&&this.currentPoint){this.mark||(this.mark=Xe.createCanvas(),this.network.getTopDiv().appendChild(this.mark));var e=new hn(this.points);e.add(this.currentPoint);var i=We.getRect(e),n=this.network.getEditLineWidth();Me.math.grow(i,n,n);var o=Xe.setCanvas(this.mark,i);o.lineWidth=n,o.strokeStyle=this.network.getEditLineColor(),o.beginPath(),Ye.drawLinePoints(o,e),o.stroke()}}}),De.network.interaction.CreateShapeLinkInteraction=function(t,e){De.network.interaction.CreateShapeLinkInteraction.superClass.constructor.call(this,t),e||(e=De.ShapeLink),this.linkFunction=De.Util.isTypeOf(e,De.ShapeLink)?function(t,i,n){var o=new e;return o instanceof De.ShapeLink&&(o.setFromNode(t),o.setToNode(i),n&&o.setPoints(n)),o}:e},Me.ext("twaver.network.interaction.CreateShapeLinkInteraction",De.network.interaction.CreateLinkInteraction,{clear:function(){this.network.setEditingElement(!1),this.points=null,this.polyline&&(this.network.getTopDiv().removeChild(this.polyline),this.polyline=null),De.network.interaction.CreateShapeLinkInteraction.superClass.clear.call(this)},createLink:function(){return this.linkFunction(this.fromNode,this.toNode,this.points)},handle_mousedown:function(t){if(0===t.button){var e=this.network.getLogicalPoint(t);if(e)if(this.fromNode)if(this.toNode=this.currentNode,this.toNode){var i=this.createLink();i&&this.network.addElementByInteraction(i),this.clear()}else{if(this.points||(this.points=new hn),this.points.size()>0){var n=this.points.get(this.points.size()-1);if(n.x===e.x&&n.y===e.y)return}this.points.add(e),this.updateMark()}else this.fromNode=this.currentNode,this.fromNode&&(this.polyline||(this.polyline=Xe.createCanvas(),this.network.getTopDiv().appendChild(this.polyline))),this.points=null,this.currentNode=null,this.currentPoint=null,this.updateMark()}},updateLine:function(){if(this.currentPoint&&this.polyline){var t=new hn(this.points);t.add(this.fromNode.getCenterLocation(),0),t.add(this.currentPoint);var e=We.getRect(t),i=Xe.setCanvas(this.polyline,e);i.lineWidth=this.network.getEditLineWidth(),i.strokeStyle=this.network.getEditLineColor(),i.beginPath(),Ye.drawLinePoints(i,t),i.stroke()}}}),De.network.interaction.CreateOrthogonalLinkInteraction=function(t,e,i,n,o,r){De.network.interaction.CreateOrthogonalLinkInteraction.superClass.constructor.call(this,t,e),this.linkType=i||"orthogonal",this.isByControlPoint=n,this.splitPercent=o,this.isSplitByPercent=r,this.link=new De.Link,this.link.setStyle("link.type",this.linkType),this.link.setStyle("link.split.by.percent",this.isSplitByPercent),vi.isFlexionalTypeLink(this.linkType)||vi.isExtendTypeLink(this.linkType)?(this.splitPercent<0&&(this.splitPercent=De.Styles.getStyle("link.extend")),this.link.setStyle("link.extend",this.splitPercent)):vi.isSplitTypeLink(this.linkType)&&(this.splitPercent<0&&(this.splitPercent=De.Styles.getStyle(this.isSplitByPercent?"link.split.percent":"link.split.value")),this.isSplitByPercent?this.link.setStyle("link.split.percent",this.splitPercent):this.link.setStyle("link.split.value",this.splitPercent))},Me.ext("twaver.network.interaction.CreateOrthogonalLinkInteraction",De.network.interaction.CreateLinkInteraction,{clear:function(){this.path&&(this.network.getTopDiv().removeChild(this.path),this.path=null),De.network.interaction.CreateOrthogonalLinkInteraction.superClass.clear.call(this)},createLink:function(){var t=De.network.interaction.CreateOrthogonalLinkInteraction.superClass.createLink.call(this);if(t.setStyle("link.type",this.linkType),t.setStyle("link.split.by.percent",this.isSplitByPercent),this.isByControlPoint){var e=vi.getControlPoint(t);if(e)return t.SetStyle("link.control.point",e),t}else vi.isFlexionalTypeLink(this.linkType)||vi.isExtendTypeLink(this.linkType)?(this.splitPercent<0&&(this.splitPercent=De.Styles.getStyle("link.extend")),t.setStyle("link.extend",this.splitPercent)):vi.isSplitTypeLink(this.linkType)&&(this.splitPercent<0&&(this.splitPercent=De.Styles.getStyle(this.isSplitByPercent?"link.split.percent":"link.split.value")),this.isSplitByPercent?t.setStyle("link.split.percent",this.splitPercent):t.setStyle("link.split.value",this.splitPercent));return t},updateLine:function(){if(this.currentPoint){if(!this.fromNode||this.currentNode===this.fromNode)return;var t,e=this.network.getElementUI(this.fromNode);if(!e)return;if(null==(t=e.getBodyRect()))return;var i;if(this.currentNode&&this.currentNode!==this.fromNode){var n=this.network.getElementUI(this.currentNode);if(!n)return;i=n.getBodyRect()}else i={x:this.currentPoint.x,y:this.currentPoint.y,width:1,height:1};if(!i)return;var o=vi.calculateOrthogonalAndFlexionalLinkPoints(this.linkType,t,i,this.link);if(vi.drawCorner(o,this.link),o.size()<2)return;this.line||(this.line=Xe.createCanvas(),this.network.getTopDiv().appendChild(this.line));var r=Xe.setCanvas(this.line,We.getLineRect(o));r.lineWidth=this.network.getEditLineWidth(),r.strokeStyle=this.network.getEditLineColor(),r.beginPath(),Ye.drawLinePoints(r,o),r.stroke()}else this.line&&(this.network.getTopDiv().removeChild(this.line),this.line=null)}}),De.network.interaction.MagnifyInteraction=function(t,e,i,n,o){De.network.interaction.MagnifyInteraction.superClass.constructor.call(this,t),this.zoom=e||2,this.xRadius=i||100,this.yRadius=n||100,this.shape=o||"circle",this.borderColor="black",this.borderWidth=1,this.backgroundColor="white",this.markCanvas=Xe.createCanvas(),this.markCanvas._isIgnored=!0},Me.ext("twaver.network.interaction.MagnifyInteraction",De.network.interaction.BaseInteraction,{setUp:function(){this.addListener("mousemove")},tearDown:function(){this.removeListener("mousemove"),this._clear()},handle_mousemove:function(t){var e=this.network.getLogicalPoint(t);e&&(this.lastPoint||this.network.getView().appendChild(this.markCanvas),this.lastPoint=e,this.updateMark())},updateMark:function(){var t,e=this.network._zoom,i=this.zoom*e,n=this.lastPoint.x*e-this.xRadius,o=this.lastPoint.y*e-this.yRadius,r=2*this.xRadius,a=2*this.yRadius,s={x:this.lastPoint.x-this.xRadius/i,y:this.lastPoint.y-this.yRadius/i,width:r/i,height:a/i},l=this.borderWidth,h=Xe.createCanvas();h.width=r,h.height=a,this.network.toCanvasByRegion(s,i,h),Xe.setCanvas(this.markCanvas,n,o,r,a),t=this.markCanvas.getContext("2d"),t.save(),t.beginPath(),Ye.drawVector(t,this.shape,null,n,o,r,a),t.clip(),t.fillStyle=this.backgroundColor,t.beginPath(),t.rect(n,o,r,a),t.fill(),t.drawImage(h,n,o),t.restore(),t.beginPath(),t.lineWidth=l,Ye.drawVector(t,this.shape,null,n+l/2,o+l/2,r-l,a-l),t.strokeStyle=this.borderColor,t.stroke()},_clear:function(t){this.lastPoint&&(this.network.getView().removeChild(this.markCanvas),this.lastPoint=null)},getZoom:function(){return this.zoom},setZoom:function(t){this.zoom=t,this.updateMark()},getShape:function(){return this.shape},setShape:function(t){this.shape=t,this.updateMark()},getXRadius:function(){return this.xRadius},setXRadius:function(t){this.xRadius=t,this.updateMark()},getYRadius:function(){return this.yRadius},setYRadius:function(t){this.yRadius=t,this.updateMark()},getBorderColor:function(){return this.borderColor},setBorderColor:function(t){this.borderColor=t,this.updateMark()},getBorderWidth:function(){return this.borderWidth},setBorderWidth:function(t){this.borderWidth=t,this.updateMark()},getBackgroundColor:function(){return this.backgroundColor},setBackgroundColor:function(t){this.backgroundColor=t,this.updateMark()}}),De.network.interaction.TouchInteraction=function(t){De.network.interaction.TouchInteraction.superClass.constructor.call(this,t)},Me.ext("twaver.network.interaction.TouchInteraction",De.network.interaction.BaseInteraction,{setUp:function(){var t=this.network.getView();Xe.addEventListener("touchstart","handleTouchstart",t,this),Xe.addEventListener("touchmove","handleTouchmove",t,this),Xe.addEventListener("touchend","handleTouchend",t,this),Xe.addEventListener("touchcancel","handleTouchend",t,this)},tearDown:function(){var t=this.network.getView();Xe.removeEventListener("touchstart",t,this),Xe.removeEventListener("touchmove",t,this),Xe.removeEventListener("touchend",t,this),Xe.removeEventListener("touchcancel",t,this)},handleTouchstart:function(t){if(Xe.preventDefault(t),t.touches&&1==t.touches.length){var e=this.network.getLogicalPoint(t),i=this.network.getElementAt(e);this._startTouchTime=new Date,this._startTouchPoint=e;var n=this;i?(this._haveElementUnderTouch=!0,this._startTouchElement=i):(this._haveElementUnderTouch=!1,this._startTouchElement=null),this.timer=setTimeout(function(){Ai.handleLongClicked(n.network,t,i)},1e3)}else t.touches&&2==t.touches.length&&(this._distance=wi.getDistance(t),this._zoom=this.network.getZoom(),this._startTouchPoint={x:t.touches[0].clientX,y:t.touches[0].clientY});this._touchCount=t.touches.length},handleTouchmove:function(t){if(Xe.preventDefault(t),2==this._touchCount&&t.touches&&2==t.touches.length)if(this.timer&&clearTimeout(this.timer),Math.abs(this._distance-wi.getDistance(t))>=kn.TOUCH_ZOOM_THRESHOLD||this._zoomFlag){this._zoomFlag=!0;var e=wi.getDistance(t)/this._distance;this.network.setTouchZoom(this._zoom*e,!1)}else{var i=t.touches[0],n=this._startTouchPoint.x-i.clientX,o=this._startTouchPoint.y-i.clientY,r=this.network.panByOffset(n,o);this._startTouchPoint.x-=n-r.x,this._startTouchPoint.y-=o-r.y}else if(1==this._touchCount&&t.touches&&1==t.touches.length)if(this._haveElementUnderTouch||!this.network.isRectSelectEnabled()){var a=this.network.getLogicalPoint(t),s=this.network.getElementAt(a);if(this.network.isMovingElement()||null!=this._startTouchElement&&this._startTouchElement==s&&this.network.getMovableSelectedElements().contains(s)){var n=a.x-this._startTouchPoint.x,o=a.y-this._startTouchPoint.y;(Math.abs(n)>=kn.TOUCH_MOVE_THRESHOLD||Math.abs(o)>=kn.TOUCH_MOVE_THRESHOLD)&&(this._startTouchPoint=a,this.network.moveSelectedElements(n,o),this.network.isMovingElement()?this.network.fireInteractionEvent({kind:"liveMoveBetween",event:t}):(this.network.setMovingElement(!0),this.network.fireInteractionEvent({kind:"liveMoveStart",event:t}),this.timer&&clearTimeout(this.timer)))}else{var n=a.x-this._startTouchPoint.x,o=a.y-this._startTouchPoint.y;(Math.abs(n)>=kn.TOUCH_MOVE_THRESHOLD||Math.abs(o)>=kn.TOUCH_MOVE_THRESHOLD)&&this.timer&&clearTimeout(this.timer)}}else{this._moveTouchPoint=this.network.getLogicalPoint(t);var n=this._moveTouchPoint.x-this._startTouchPoint.x,o=this._moveTouchPoint.y-this._startTouchPoint.y;if(Math.abs(n)>=kn.TOUCH_RECT_SELECT_THRESHOLD&&Math.abs(o)>=kn.TOUCH_RECT_SELECT_THRESHOLD){this.mark?this.network.fireInteractionEvent({kind:"selectBetween",event:t}):(this.mark=Xe.createDiv(),this.network.getTopDiv().appendChild(this.mark),this.network.setSelectingElement(!0),this.network.fireInteractionEvent({kind:"selectStart",event:t}),this.timer&&clearTimeout(this.timer));var l=We.getRect([this._startTouchPoint,this._moveTouchPoint]);Xe.setDiv(this.mark,l,this.getIntersectMode()?this.network.getSelectFillColor():null,this.network.getSelectOutlineWidth(),this.network.getSelectOutlineColor())}}},handleTouchend:function(t){if(Xe.preventDefault(t),this.network.isMovingElement())this.network.setMovingElement(!1),this.network.fireInteractionEvent({kind:"liveMoveEnd",event:t});else if(this.network.isSelectingElement()){var e=this.network.getElementsAtRect(this.mark._viewRect,this.getIntersectMode(),this.network.getRectSelectFilter());if(e&&e.size()>0){var i=this.network.getSelectionModel(),n=i.toSelection();e.forEach(function(t){i.contains(t)?n.remove(t):n.add(t)},this),i.setSelection(n)}this.network.fireInteractionEvent({kind:"selectEnd",event:t}),this.network.getTopDiv().removeChild(this.mark),this.mark=null,this.network.setSelectingElement(!1),this.timer&&clearTimeout(this.timer)}else if(this._startTouchPoint){this._zoomFlag=!1;var o=new Date,r=this.network.getLogicalPoint(t),a=this.network.getElementAt(this._startTouchPoint);this._startTouchPoint&&r&&o.getTime()-this._startTouchTime.getTime()<=500&&We.getDistance(this._startTouchPoint,r)<=20&&(a?this.network.getSelectionModel().contains(a)||this.network.getSelectionModel().setSelection(a):this.network.getSelectionModel().clearSelection(),Ai.handleClicked(this.network,t,a),this.timer&&clearTimeout(this.timer),this._endTouchTime&&o.getTime()-this._endTouchTime.getTime()<=500&&We.getDistance(this._endTouchPoint,r)<=20?(delete this._endTouchTime,delete this._endTouchPoint,Ai.handleDoubleClicked(this.network,t,a),this.timer&&clearTimeout(this.timer)):(this._endTouchTime=o,this._endTouchPoint=r))}},getIntersectMode:function(){return"intersect"===this.network.getSelectMode()||"contain"!==this.network.getSelectMode()&&(this._startTouchPoint.x>this._moveTouchPoint.x&&this._startTouchPoint.y>this._moveTouchPoint.y)}}),De.network.interaction.MSTouchInteraction=function(t){De.network.interaction.MSTouchInteraction.superClass.constructor.call(this,t),this._pointerMap={},this._pointerIdArray=[]},Me.ext("twaver.network.interaction.MSTouchInteraction",De.network.interaction.BaseInteraction,{setUp:function(){var t=this.network.getView();Xe.addEventListener("MSPointerDown","handleTouchstart",t,this),Xe.addEventListener("MSPointerMove","handleTouchmove",t,this),Xe.addEventListener("MSPointerUp","handleTouchend",t,this),Xe.addEventListener("MSPointerCancel","handleTouchend",t,this)},tearDown:function(){var t=this.network.getView();Xe.removeEventListener("MSPointerDown",t,this),Xe.removeEventListener("MSPointerMove",t,this),Xe.removeEventListener("MSPointerUp",t,this),Xe.removeEventListener("MSPointerCancel",t,this)},handleTouchstart:function(t){if(this.network.isFocusOnClick()&&De.Util.setFocus(this.network._view),!this.network.isSelectingElement()||t.pointerType!=t.MSPOINTER_TYPE_MOUSE){var e=this.network.getLogicalPoint(t),i=new Date;if(t.isPrimary&&this._pointerIdArray.length>0&&this.handle_mouseup(t),this._pointerMap[t.pointerId]||(this._pointerIdArray.push(t.pointerId),this._pointerMap[t.pointerId]=t),1==this._pointerIdArray.length){var n=this.network.getElementAt(e);this._startTouchElement=n,this._startClientPoint={x:t.clientX,y:t.clientY},Ai.handleClicked(this.network,t,n),this._startTouchTime&&this._startTouchPoint&&i.getTime()-this._startTouchTime.getTime()<=500&&We.getDistance(this._startTouchPoint,e)<=20?(Ai.handleDoubleClicked(this.network,t,n),this._doubleClick=!0):(Xe.handle_mousedown(this,t),this._startTouchPoint=e,this._startTouchTime=i);var o=this.network.getSelectionModel();n?Me.isCtrlDown(t)?o.contains(n)?o.removeSelection(n):o.appendSelection(n):o.contains(n)||o.setSelection(n):Me.isCtrlDown(t)||o.clearSelection()}else 2==this._pointerIdArray.length&&(this._distance=this._getDistance(),this._zoom=this.network.getZoom())}},handleTouchmove:function(t){if(null!=this._startTouchPoint&&0!=this._pointerIdArray.length&&this._pointerMap[t.pointerId]&&!(We.getDistance({x:this._pointerMap[t.pointerId].pageX,y:this._pointerMap[t.pointerId].pageY},{x:t.pageX,y:t.pageY})<=10)&&(this._pointerMap[t.pointerId]=t,2==this._pointerIdArray.length)){var e=this._getDistance()/this._distance;this.network.setZoom(this._zoom*e,!1)}},handleTouchend:function(t){if(this.network.isMovingElement()&&(this.network.setMovingElement(!1),this.network.fireInteractionEvent({kind:"liveMoveEnd",event:t})),this.network.isSelectingElement()){var e=this.network.getElementsAtRect(this.mark._viewRect,this.getIntersectMode(),this.network.getRectSelectFilter());if(e&&e.size()>0){var i=this.network.getSelectionModel(),n=i.toSelection();e.forEach(function(t){i.contains(t)?n.remove(t):n.add(t)},this),i.setSelection(n)}this.network.fireInteractionEvent({kind:"selectEnd",event:t}),this.network.getTopDiv().removeChild(this.mark),this.mark=null,this.network.setSelectingElement(!1)}this._doubleClick&&(delete this._doubleClick,delete this._startTouchPoint,delete this._startTouchTime);for(var o=-1,r=0;r<this._pointerIdArray.length;r++)if(this._pointerIdArray[r]==t.pointerId){o=r;break}o>=0&&this._pointerIdArray.splice(o,1),delete this._pointerMap[t.pointerId]},_getDistance:function(){return We.getDistance({x:this._pointerMap[this._pointerIdArray[0]].pageX,y:this._pointerMap[this._pointerIdArray[0]].pageY},{x:this._pointerMap[this._pointerIdArray[1]].pageX,y:this._pointerMap[this._pointerIdArray[1]].pageY})},getIntersectMode:function(){return"intersect"===this.network.getSelectMode()||"contain"!==this.network.getSelectMode()&&(this._startTouchPoint.x>this._moveTouchPoint.x&&this._startTouchPoint.y>this._moveTouchPoint.y)},handle_mousemove:function(t){if(this._startTouchPoint&&1==this._pointerIdArray.length){if(this._moveTouchPoint={x:this._startTouchPoint.x+(t.clientX-this._startClientPoint.x)/this.network.getZoom(),y:this._startTouchPoint.y+(t.clientY-this._startClientPoint.y)/this.network.getZoom()},We.getDistance(this._startTouchPoint,this._moveTouchPoint)<3)return;if(null==this._startTouchElement&&this.network.isRectSelectEnabled()){this.mark?this.network.fireInteractionEvent({kind:"selectBetween",event:t}):(this.mark=Xe.createDiv(),this.network.getTopDiv().appendChild(this.mark),this.network.setSelectingElement(!0),this.network.fireInteractionEvent({kind:"selectStart",event:t}));var e=We.getRect([this._startTouchPoint,this._moveTouchPoint]);Xe.setDiv(this.mark,e,this.getIntersectMode()?this.network.getSelectFillColor():null,this.network.getSelectOutlineWidth(),this.network.getSelectOutlineColor())}else{var i=this.network.getElementAt(this._moveTouchPoint),n=this._moveTouchPoint.x-this._startTouchPoint.x,o=this._moveTouchPoint.y-this._startTouchPoint.y;null!=this._startTouchElement||this.network.isRectSelectEnabled()?(this.network.isMovingElement()||null!=this._startTouchElement&&i==this._startTouchElement&&this.network.getMovableSelectedElements().contains(i))&&(this.network.moveSelectedElements(n,o),this.network.isMovingElement()?this.network.fireInteractionEvent({kind:"liveMoveBetween",event:t}):(this.network.setMovingElement(!0),this.network.fireInteractionEvent({kind:"liveMoveStart",event:t}))):this.network.panByOffset(-n,-o),this._startClientPoint.x=t.clientX,this._startClientPoint.y=t.clientY}}},handle_mouseup:function(t){this.handleTouchend(t),this._pointerIdArray=[],this._pointerMap={}}});var Nn={_hitCanvas:null,getHitCanvas:function(t,e){return null==this._hitCanvas&&(this._hitCanvas=Xe.createCanvas()),0==arguments.length&&(t=2,e=2),this._hitCanvas.setAttribute("width",""+t-1),this._hitCanvas.setAttribute("height",""+e-1),this._hitCanvas.setAttribute("width",""+t),this._hitCanvas.setAttribute("height",""+e),this.getCtx(this._hitCanvas).clearRect(0,0,t,e),this._hitCanvas},disposeHitCanvas:function(){this._hitCanvas=null},getCtx:function(t){return t.getContext("2d")},render:function(t,i,n){i!=e&&(t.fillStyle=i,t.fill()),n!=e&&(t.strokeStyle=n,t.stroke())},text:function(t,e,i,n,o,r){t.textAlign="center",t.textBaseline="middle",null!=o&&(t.fillStyle=o,t.fillText(e,i,n)),r&&(t.strokeStyle=r,t.strokeText(e,i,n))},circle:function(t,e,i,n,o,r){t.arc(e,i,n,0,2*Math.PI,!0),t.closePath(),this.render(t,o,r)},rect:function(t,e,i,n,o,r,a){t.rect(e,i,n,o),t.closePath(),this.render(t,r,a)},OUT_LEFT:1,OUT_TOP:2,OUT_RIGHT:4,OUT_BOTTOM:8,outcode:function(t,e,i,n,o,r){var a=0;return 0>=o?a|=this.OUT_LEFT|this.OUT_RIGHT:i>t?a|=this.OUT_LEFT:t>i+o&&(a|=this.OUT_RIGHT),0>=r?a|=this.OUT_TOP|this.OUT_BOTTOM:n>e?a|=this.OUT_TOP:e>n+r&&(a|=this.OUT_BOTTOM),a},intersectsLine:function(t,e,i,n,o,r,a,s){var l,h;if(0==(h=this.outcode(i,n,o,r,a,s)))return!0;for(;0!=(l=this.outcode(t,e,o,r,a,s));){if(0!=(l&h))return!1;if(0!=(l&(this.OUT_LEFT|this.OUT_RIGHT))){var c=o;0!=(l&this.OUT_RIGHT)&&(c+=a),e+=(c-t)*(n-e)/(i-t),t=c}else{var u=r;0!=(l&this.OUT_BOTTOM)&&(u+=s),t+=(u-e)*(i-t)/(n-e),e=u}}return!0}};De.canvas={},De.canvas.interaction={},De.canvas.Network=function(t){De.canvas.Network.superClass.constructor.apply(this,arguments),this._rootCanvas=Xe.createCanvas(),this._topCanvas=Xe.createCanvas(),this.realWidth=0,this.realHeight=0,this._unionBounds={x:0,y:0,width:0,height:0},this._zoom=1,this._elementUIMap={},this._visibleMap={},this.viewRect={x:0,y:0,width:0,height:0},this.hScrollBarVisible=!1,this.vScrollBarVisible=!1,this.markerList=new De.List,this._topAttachmentList=new De.List,this.setElementBox(t||new De.ElementBox),this._view=Xe.createView("hidden"),this._view.appendChild(this._rootCanvas),this._view.appendChild(this._topCanvas),Ue.isTouchable?Ue.isMSTouchable?this.setMSTouchInteractions():this.setTouchInteractions():this.setDefaultInteractions(!1),this.setToolTipEnabled(De.Defaults.NETWORK_TOOLTIP_ENABLED);var e=this;this._flowLink=function(){if(!(e.isMovingElement()||e.isSelectingElement()||e.isEditingElement()||e._box._layoutMovingElements)){e._flowLinkQuickFinder||(e._flowLinkQuickFinder=new De.QuickFinder(e._box,"link.flow","style"));e._flowLinkQuickFinder.find(!0).forEach(function(t){t._styleMap["link.flow.offset"]=e.getLinkFlowOffset(t),e.getElementUI(t).invalidate(!1)})}},De.imageUtil.addEventListener(this.invalidateElementUIs,this)},Me.ext("twaver.canvas.Network",De.controls.View,{__accessor:["selectMode","makeVisibleOnSelected","movableFunction","editPointSize","editPointFillColor","scrollBarWidth","editPointOutlineWidth","editPointOutlineColor","editLineColor","editLineWidth","resizePointSize","resizePointFillColor","resizePointOutlineWidth","resizePointOutlineColor","resizeLineColor","resizeLineWidth","rotatePointSize","rotatePointFillColor","rotatePointOffset","rotatePointOutlineWidth","rotatePointOutlineColor","rotateScaleFillColor","rotateScaleFontColor","rotateScaleWidth","rotateScaleHeight","selectOutlineColor","selectOutlineWidth","selectFillColor","lazyMoveOutlineColor","lazyMoveOutlineWidth","lazyMoveFillColor","rectSelectFilter","paddingRight","paddingBottom","selectionTolerance"],__bool:["doubleClickToUpSubNetwork","doubleClickToSubNetwork","doubleClickToEmptySubNetwork","doubleClickToLinkBundle","doubleClickToGroupExpand","scrollBarVisible","limitViewInCanvas","autoValidateCanvasSize","subNetworkAnimate","lazyMoveAnimate","resizeAnimate","noAgentLinkVisible","keyboardRemoveEnabled","keyboardSelectEnabled","sendToTopOnSelected","lazyMoveFill","editingElement","rotatingElement","movingElement","selectingElement","rectSelectEnabled","limitElementInPositiveLocation","showRotateScale","transparentSelectionEnable","debug","showShadowInEdit"],_currentSubNetwork:null,_subNetworkAnimate:De.Defaults.NETWORK_SUBNETWORK_ANIMATE,_scrollBarWidth:10,_scrollBarVisible:!0,_limitViewInCanvas:!0,_autoValidateCanvasSize:!0,_makeVisibleOnSelected:De.Defaults.NETWORK_MAKE_VISIBLE_ON_SELECTED,_keyboardRemoveEnabled:De.Defaults.NETWORK_KEYBOARD_REMOVE_ENABLED,_keyboardSelectEnabled:De.Defaults.NETWORK_KEYBOARD_SELECT_ENABLED,_rectSelectEnabled:kn.NETWORK_RECT_SELECT_ENABLED,_rectSelectFilter:null,_elementUIFunction:De.Defaults.CANVASUI_FUNCTION,_doubleClickToUpSubNetwork:De.Defaults.NETWORK_DOUBLECLICK_TO_UPSUBNETWORK,_doubleClickToSubNetwork:De.Defaults.NETWORK_DOUBLECLICK_TO_SUBNETWORK,_doubleClickToEmptySubNetwork:De.Defaults.NETWORK_DOUBLECLICK_TO_EMPTYSUBNETWORK,_doubleClickToLinkBundle:De.Defaults.NETWORK_DOUBLECLICK_TO_LINKBUNDLE,_doubleClickToGroupExpand:De.Defaults.NETWORK_DOUBLECLICK_TO_GROUPEXPAND,_selectOutlineColor:De.Defaults.NETWORK_SELECT_OUTLINE_COLOR,_selectOutlineWidth:De.Defaults.NETWORK_SELECT_OUTLINE_WIDTH,_selectFillColor:De.Defaults.NETWORK_SELECT_FILL_COLOR,_sendToTopOnSelected:De.Defaults.NETWORK_SENDTOTOP_ON_SELECTED,_lazyMoveOutlineColor:De.Defaults.NETWORK_LAZYMOVE_OUTLINE_COLOR,_lazyMoveOutlineWidth:De.Defaults.NETWORK_LAZYMOVE_OUTLINE_WIDTH,_lazyMoveFillColor:De.Defaults.NETWORK_LAZYMOVE_FILL_COLOR,_lazyMoveFill:De.Defaults.NETWORK_LAZYMOVE_FILL,_lazyMoveAnimate:De.Defaults.NETWORK_LAZYMOVE_ANIMATE,_resizePointSize:De.Defaults.NETWORK_RESIZE_POINT_SIZE,_resizePointFillColor:De.Defaults.NETWORK_RESIZE_POINT_FILL_COLOR,_resizePointOutlineColor:De.Defaults.NETWORK_RESIZE_POINT_OUTLINE_COLOR,_resizePointOutlineWidth:De.Defaults.NETWORK_RESIZE_POINT_OUTLINE_WIDTH,_resizeLineColor:De.Defaults.NETWORK_RESIZE_LINE_COLOR,_resizeLineWidth:De.Defaults.NETWORK_RESIZE_LINE_WIDTH,_resizeAnimate:De.Defaults.NETWORK_RESIZE_ANIMATE,_editPointSize:De.Defaults.NETWORK_EDIT_POINT_SIZE,_editPointFillColor:De.Defaults.NETWORK_EDIT_POINT_FILL_COLOR,_editPointOutlineColor:De.Defaults.NETWORK_EDIT_POINT_OUTLINE_COLOR,_editPointOutlineWidth:De.Defaults.NETWORK_EDIT_POINT_OUTLINE_WIDTH,_editLineColor:De.Defaults.NETWORK_EDIT_LINE_COLOR,_editLineWidth:De.Defaults.NETWORK_EDIT_LINE_WIDTH,_rotatePointSize:De.Defaults.NETWORK_ROTATE_POINT_SIZE,_rotatePointFillColor:De.Defaults.NETWORK_ROTATE_POINT_FILL_COLOR,_rotatePointOffset:De.Defaults.NETWORK_ROTATE_POINT_OFFSET,_rotatePointOutlineWidth:De.Defaults.NETWORK_ROTATE_POINT_OUTLINE_WIDTH,_rotatePointOutlineColor:De.Defaults.NETWORK_ROTATE_POINT_OUTLINE_COLOR,_rotateScaleWidth:kn.NETWORK_ROTATE_SCALE_WIDTH,_rotateScaleHeight:kn.NETWORK_ROTATE_SCALE_HEIGHT,_rotateScaleFillColor:kn.NETWORK_ROTATE_SCALE_FILL_COLOR,_rotateScaleFontColor:kn.NETWORK_ROTATE_SCALE_FONT_COLOR,_limitElementInPositiveLocation:kn.NETWORK_LIMIT_ELEMENT_INPOSITIVE_LOCATION,_linkFlowInterval:kn.NETWORK_LINK_FLOW_INTERVAL,_selectionTolerance:kn.NETWORK_SELECTION_TOLERANCE,_invalidateElementVisibility:!1,_invalidateViewRectFlag:!1,_repaintTopFlag:!1,_invalidateCanvasSizeFlag:!1,_isEditingElement:!1,_isRotatingElement:!1,_isMovingElement:!1,_isSelectingElement:!1,_hasEditInteraction:!1,_showRotateScale:!0,_paddingRight:0,_paddingBottom:0,_transparentSelectionEnable:De.Defaults.NETWORK_TRANSPARENT_SELECTION_ENABLE,_debug:!1,_showShadowInEdit:!1,adjustBounds:function(t){var e=!1,i=this._view.style;if(i.left==t.x+"px"&&i.top==t.y+"px"&&i.width==t.width+"px"&&i.height==t.height+"px"&&(e=!0),De.canvas.Network.superClass.adjustBounds.apply(this,arguments),1!=e){var n=this._view.offsetWidth,o=this._view.offsetHeight;this._rootCanvas.setAttribute("width",n),this._rootCanvas.setAttribute("height",o),this._topCanvas.setAttribute("width",n),this._topCanvas.setAttribute("height",o),this.setViewRect(this.viewRect.x,this.viewRect.y,n,o),void 0===De.gis&&(De.Util.makeHighRes(this._rootCanvas),De.Util.makeHighRes(this._topCanvas)),this.invalidateElementVisibility()}},getLabel:function(t){return t.getStyle("network.label")||t.getName()},getBackgroundImage:function(){return this._backgroundImage},setBackgroundImage:function(t){if(this._backgroundImage!=t){var e=this._backgroundImage;this._backgroundImage=t;var i=this._backgroundImage;if(i&&!i._viewRect)if(i.width>0)i._viewRect={x:0,y:0,width:i.width,height:i.height},this.validateCanvasSize(),this.firePropertyChange("backgroundImage",e,i);else{var n=this;i.onload=function(){i._viewRect={x:0,y:0,width:i.width,height:i.height},n.validateCanvasSize(),n.firePropertyChange("backgroundImage",e,i),i.onload=null}}else this.firePropertyChange("backgroundImage",e,i),this.validateCanvasSize()}},getRootCanvas:function(){return this._rootCanvas},getTopCanvas:function(){return this._topCanvas},validateImpl:function(){if(ci.twm(this),1==this._invalidateElementVisibility){this._invalidateElementVisibility=!1;var t,e,i,n=this.getElementBox().getDatas()._as,o=n.length,r={},a=this._visibleFunction,s=1===this._box._layerBox.size()?this._box._layerBox._defaultLayer:null;for(t=0;o>t;t++)e=n[t],r[e._id]=this.isVisible(e,a,s);if(this._visibleMap)for(t=0;o>t;t++)e=n[t],r[e._id]!==this._visibleMap[e._id]&&(i=this._elementUIMap[e._id])&&i.invalidate();for(t=0;o>t;t++)e=n[t],(i=this._elementUIMap[e._id])&&i.validate();this._visibleMap=r,this.paintRoot()}this.validateCanvasSize(),1==this._repaintTopFlag&&(this._repaintTopFlag=!1,this.paintTopCanvas())},isLinkFlowEnabled:function(){return!!this._linkFlowEnabled},setLinkFlowEnabled:function(t){t?(this._linkFlowEnabled||(this._linkFlowEnabled=!0,this.firePropertyChange("linkFlowEnabled",!1,!0)),clearInterval(this._linkFlowTimerId),this._linkFlowTimerId=setInterval(this._flowLink,this._linkFlowInterval)):(this._linkFlowEnabled&&(this._linkFlowEnabled=!1,this.firePropertyChange("linkFlowEnabled",!0,!1)),clearInterval(this._linkFlowTimerId),delete this._linkFlowTimerId)},getLinkFlowInterval:function(){return this._linkFlowInterval},setLinkFlowInterval:function(t){var e=this._linkFlowInterval;this._linkFlowInterval=t,this.firePropertyChange("linkFlowInterval",e,t),clearInterval(this._linkFlowTimerId),this.isLinkFlowEnabled()&&(this._linkFlowTimerId=setInterval(this._flowLink,this._linkFlowInterval))},getElementBox:function(){return this._box},setElementBox:function(t){if(!t)throw"ElementBox can not be null";if(this._box!==t){var e=this._box;e&&(e.removeDataBoxChangeListener(this.handleElementBoxChange,this),e.removeDataPropertyChangeListener(this.handleElementPropertyChange,this),e.removePropertyChangeListener(this.handleElementBoxPropertyChange,this),e.removeIndexChangeListener(this.handleIndexChange,this),e.getLayerBox().removeDataBoxChangeListener(this.handleLayerBoxChange,this),e.getLayerBox().removeDataPropertyChangeListener(this.handleLayerPropertyChange,this),e.getLayerBox().removeHierarchyChangeListener(this.handleLayerHierarchyChange,this),this._selectionModel||e.getSelectionModel().removeSelectionChangeListener(this.handleSelectionChange,this)),this._box=t,this._box.addDataBoxChangeListener(this.handleElementBoxChange,this),this._box.addDataPropertyChangeListener(this.handleElementPropertyChange,this),this._box.addPropertyChangeListener(this.handleElementBoxPropertyChange,this),this._box.addIndexChangeListener(this.handleIndexChange,this),this._box.getLayerBox().addDataBoxChangeListener(this.handleLayerBoxChange,this),this._box.getLayerBox().addDataPropertyChangeListener(this.handleLayerPropertyChange,this),this._box.getLayerBox().addHierarchyChangeListener(this.handleLayerHierarchyChange,this),this._flowLinkQuickFinder&&(this._flowLinkQuickFinder.dispose(),this._flowLinkQuickFinder=new De.QuickFinder(this._box,"link.flow","style")),this._selectionModel?this._selectionModel._setDataBox(t):this._box.getSelectionModel().addSelectionChangeListener(this.handleSelectionChange,this),this._elementUIMap={},this._box.forEach(this.createElementUI,this),this.invalidateElementVisibility(),this.invalidateCanvasSize(),this.firePropertyChange("elementBox",e,this._box)}},handleElementBoxChange:function(t){var e=t.data;if("add"===t.kind)this.createElementUI(e),this.invalidateBundleLink(e);else if("remove"===t.kind){var i=this.getElementUI(e);i&&(i.dispose(),delete this._elementUIMap[e.getId()]),e===this._currentSubNetwork&&null!=this._currentSubNetwork&&this._setCurrentSubNetwork(null)}else if("clear"===t.kind){for(var n in this._elementUIMap)this._elementUIMap[n]&&this._elementUIMap[n].dispose&&this._elementUIMap[n].dispose();this._elementUIMap={},null!=this._currentSubNetwork&&this._setCurrentSubNetwork(null)}this.invalidateElementVisibility(),this.invalidateCanvasSize()},handleElementPropertyChange:function(t){var e=t.source,i=this.getElementUI(e);i&&i.handlePropertyChange(t),this.invalidateBundleLink(e),this.invalidateElementVisibility(),this.invalidateCanvasSize()},handleElementBoxPropertyChange:function(){this.invalidateElementVisibility()},handleIndexChange:function(t){this.invalidateElementVisibility()},handleLayerBoxChange:function(){this.invalidateElementVisibility()},handleLayerPropertyChange:function(t){"editable"===t.property&&this.invalidateSelectedElementUIs(!0),this.invalidateElementVisibility()},handleLayerHierarchyChange:function(){this.invalidateElementVisibility()},handleSelectionChange:function(t){t.datas.forEach(function(e){var i=this.getElementUI(e);i&&i.handleSelectionChange(t)},this);var e=this.getSelectionModel().getLastData();e&&("append"===t.kind||"set"===t.kind)&&(this.isMakeVisibleOnSelected()&&this.makeVisible(e),this.isSendToTopOnSelected()&&this.sendToTop(e)),this.invalidateElementVisibility()},sendToTop:function(t){if(this._box.contains(t)){for(var e=t;e._parent&&this.isVisible(e._parent)&&(e=e._parent););e!==t&&this._box.adjustElementIndex(e),this._box.adjustElementIndex(t)}},getScopeRect:function(t){var e=this._zoom;if("viewsize"===t)return{x:this._unionBounds.x-this.viewRect.x,y:this._unionBounds.y-this.viewRect.y,width:this._unionBounds.width,height:this._unionBounds.height};if("viewport"===t){if(this.viewRect)return Me.cloneRect(this.viewRect)}else if("rootcanvas"===t)return{x:this.viewRect.x,y:this.viewRect.y,width:(Math.abs(this.viewRect.x-this._unionBounds.x)+this._unionBounds.width)*e,height:(Math.abs(this.viewRect.y-this._unionBounds.y)+this._unionBounds.height)*e};return{x:0,y:0,width:0,height:0}},getViewRect:function(){return this.viewRect?Me.clone(this.viewRect):{x:0,y:0,width:0,height:0}},getCanvasSize:function(){return{width:this.realWidth,height:this.realHeight}},getUnionBounds:function(){return this._unionBounds},setViewOffSet:function(t,e){var i=this.viewRect.x,n=this.viewRect.y,o=this.viewRect.width,r=this.viewRect.height;this.setViewRect(i+t,n+e,o,r)},setViewRect:function(t,e,i,n){1==this.isLimitViewInCanvas()&&(0>t&&(t=0),i>this.realWidth?t=0:t+i>this.realWidth&&(t=this.realWidth-i),0>e&&(e=0),n>this.realHeight?e=0:e+n>this.realHeight&&(e=this.realHeight-n));var o=this.viewRect;(null==this.viewRect||t!=this.viewRect.x||e!=this.viewRect.y||i!=this.viewRect.width||n!=this.viewRect.height)&&(this.viewRect={x:t,y:e,width:i,height:n},this.firePropertyChange("viewRect",o,this.viewRect),this.invalidateElementVisibility())},isHScrollBarVisible:function(){return this.hScrollBarVisible},setHScrollBarVisible:function(t){this.hScrollBarVisible=t},isVScrollBarVisible:function(){return this.vScrollBarVisible},setVScrollBarVisible:function(t){this.vScrollBarVisible=t},dispose:function(){De.imageUtil.removeEventListener(this.invalidateElementUIs,this);for(var t in this._elementUIMap){var e=this._elementUIMap[t];e.curInterval&&clearTimeout(e.curInterval)}this.setInteractions(null)},invalidateElementVisibility:function(){this._invalidateElementVisibility||(this._invalidateElementVisibility=!0,this.invalidate())},repaintTopCanvas:function(){this._repaintTopFlag||(this._repaintTopFlag=!0,this.invalidate())},invalidateCanvasSize:function(t){this._invalidateCanvasSizeFlag||(this._invalidateCanvasSizeFlag=!0,this.invalidate())},validateCanvasSize:function(){0!=this._invalidateCanvasSizeFlag&&(this._invalidateCanvasSizeFlag=!1,this._validateCanvasSize())},_validateCanvasSize:function(){if(!this.isMovingElement()){if(0==this.isAutoValidateCanvasSize())return this.realWidth=0,this.realHeight=0,void(this._unionBounds={x:0,y:0,width:0,height:0});var t=this.getElementBox().getDatas(),e=t.size();if(e>0){for(var i={x:0,y:0,width:0,height:0},n=0;e>n;n++){var o=t.get(n);if(this._visibleMap[o._id]){var r=this._elementUIMap[o._id];r&&(i=We.unionRect(i,r._viewRect))}}var a=this.getBackgroundImage();if(a&&(i=We.unionRect(i,a._viewRect)),i.x<0&&(i.width+=i.x,i.x=0),i.y<0&&(i.height+=i.y,i.y=0),this.realWidth==(i.x+i.width)*this.getZoom()&&this.realHeight==(i.y+i.height)*this.getZoom())return;var s=this.getZoom();this.realWidth=(i.x+i.width)*s+this._paddingRight,this.realHeight=(i.y+i.height)*s+this._paddingBottom,this._unionBounds={x:i.x*s,y:i.y*s,width:i.width*s+this._paddingRight,height:i.height*s+this._paddingRight}}else this.realWidth=0,this.realHeight=0,this._unionBounds={x:0,y:0,width:0,height:0};this.setViewRect(this.viewRect.x,this.viewRect.y,this.viewRect.width,this.viewRect.height),this.firePropertyChange("canvasSizeChange",null,this.viewRect)}},getElementUI:function(t){return null==t?null:this._elementUIMap[t._id]},createElementUI:function(t){var e=this._elementUIMap[t.getId()];e||(e=this._elementUIFunction(this,t))&&(this._elementUIMap[t.getId()]=e)},getElementUIFunction:function(){return this._elementUIFunction},setElementUIFunction:function(t){if(!t)throw"ElementUIFunction can not be null";if(this._elementUIFunction!==t){var e=this._elementUIFunction;this._elementUIFunction=t,this.firePropertyChange("elementUIFunction",e,t),this._box.isEmpty()||(this._elementUIMap={},this._box.forEach(this.createElementUI,this),this.invalidateElementVisibility(),this.invalidateCanvasSize())}},invalidateElementUI:function(t,e){var i=this.getElementUI(t);i&&i.invalidate(e)},invalidateElementUIs:function(t){for(var e in this._elementUIMap){this._elementUIMap[e].invalidate(t)}},invalidateSelectedElementUIs:function(t){this.getSelectionModel().getSelection().forEach(function(e){this.invalidateElementUI(e,t)},this)},invalidateBundleLink:function(t){if(t instanceof De.Link&&t._bundleLinks){var e=this._elementUIMap;t._bundleLinks.forEachSiblingLink(function(i){if(i!==t){var n=e[i._id];n&&n.invalidate(!1)}},this)}},paintRoot:function(){var t=this._rootCanvas.getContext("2d");if(t.clearRect(0,0,this._rootCanvas.width,this._rootCanvas.height),this.visibleList=new De.List,this._topAttachmentList=new De.List,null!=this.getElementBox()){sn.draw(t,this);var i=this.getElementBox().getDatas()._as,n=i.length;t.save(),t.scale(this.getZoom(),this.getZoom()),t.translate(-this.viewRect.x/this.getZoom(),-this.viewRect.y/this.getZoom()),this.paintBottom(t);var o={x:this.viewRect.x/this.getZoom(),y:this.viewRect.y/this.getZoom(),width:this.viewRect.width/this.getZoom(),height:this.viewRect.height/this.getZoom()},r=this.getBackgroundImage(),a=this.getBackgroundImageRect();if(r instanceof Ve&&(a?t.drawImage(r,a.x,a.y,a.width,a.height):t.drawImage(r,0,0,r.width,r.height),r._viewRect={x:0,y:0,width:r.width,height:r.height}),"string"==typeof r){var s=Me.getImageAsset(r),l={x:0,y:0,width:s.getWidth(),height:s.getHeight()};Di(t,r,null,l,null,this)}var h,c,u,d,f=this._box._layerBox;if(1===f.size())for(h=0;n>h;h++)c=i[h],this._visibleMap[c._id]&&(u=this._elementUIMap[c._id],null!=u&&this._isInView(u,o)?(u.paint(t),u.setAttachmentVisible&&u.setAttachmentVisible(!0),this.visibleList.add(c)):u.setAttachmentVisible&&u.setAttachmentVisible(!1));else f.forEachByDepthFirst(function(e){for(h=0;n>h;h++)c=i[h],f.getLayerByElement(c)===e&&this._visibleMap[c._id]&&(u=this._elementUIMap[c._id],null!=u&&this._isInView(u,o)?(u.paint(t),u.setAttachmentVisible&&u.setAttachmentVisible(!0),this.visibleList.add(c)):u.setAttachmentVisible&&u.setAttachmentVisible(!1))},null,this);for(n=this._topAttachmentList.size(),h=0;n>h;h++)d=this._topAttachmentList.get(h),d.getElementUI().paintAttachment(t,d);if(this._xyz){var n,p=this._xyz,g=p.markText,_=p.type,m=(p.expired,p.innerHTML),v=0,y=0,w=this.viewRect;t.translate(this.viewRect.x/this.getZoom(),this.viewRect.y/this.getZoom()),t.scale(1/this.getZoom(),1/this.getZoom()),this.getZoom(),g!=e&&null!=g&&""!=g||"2"==_?(t.font="15px Arial sans-serif",n=Me.g.getTextSize(t.font,m),t.fillStyle="red",v=w.width-n.width,y=w.height-20):(t.font="10px Arial sans-serif",n=Me.g.getTextSize(t.font,m),v=w.width/2-n.width/2,y=w.height/2),t.fillText(m,v,y)}t.restore()}},paintBottom:function(t){},_isInView:function(t,e){return We.intersects(e,t._viewRect)},paintTopCanvas:function(){var t=this._topCanvas.getContext("2d");t.clearRect(0,0,this._topCanvas.width,this._topCanvas.height),this.paintMarker(t)},paintMarker:function(t){for(var e=this.markerList.size(),i=0;e>i;i++){this.markerList.get(i).paint(t)}},getLayerByElement:function(t){return this._box.getLayerBox().getLayerByElement(t)},getLogicalPoint:function(t){if(Ue.isTouchable&&t.changedTouches&&t.changedTouches.length>0){var e=this._view.getBoundingClientRect(),i=t.changedTouches[0],n=Ue.isAndroid?0:wi.scrollLeft(),o=Ue.isAndroid?0:wi.scrollTop();return{x:(i.clientX+this.viewRect.x-e.left-n)/this._zoom,y:(i.clientY+this.viewRect.y-e.top-o)/this._zoom}}return Ue.isFirefox?{x:(t.layerX+this.viewRect.x)/this.getZoom(),y:(t.layerY+this.viewRect.y)/this.getZoom()}:{x:(t.offsetX+this.viewRect.x)/this.getZoom(),y:(t.offsetY+this.viewRect.y)/this.getZoom()}},getElementAt:function(t,e){if(null==this.visibleList)return null;1===arguments.length&&(e=!0);var i,n;if(t.target?i=this.getLogicalPoint(t):t.event?t.event.target&&(i=this.getLogicalPoint(t.event)):i=t,null!=this._topAttachmentList)for(var o=this._topAttachmentList.size(),r=o-1;r>=0;r--){var a=this._topAttachmentList.get(r);if(n=a.getElement(),(!e||this.isSelectable(n))&&a.hit(i.x,i.y))return n}if(null!=this.visibleList)for(var s=this.visibleList.size(),l=s-1;l>=0;l--){var h=this.visibleList.get(l),c=this.getElementUI(h);if((!e||this.isSelectable(h))&&c&&c.hit(i.x,i.y))return h}return null},hitTest:function(t){var e=this.getElementAt(t);if(!e)return null;var i=this.getElementUI(e);if(!i)return null;var n;return n=t.target?this.getLogicalPoint(t):t,i.hitTest(n.x,n.y)},getElementsAtRect:function(t,i,n,o){var r=new De.List;if(null==this.visibleList)return r;o=o===e||o;for(var a=this.visibleList.size(),s=a-1;s>=0;s--){var l=this.visibleList.get(s),h=this.getElementUI(l);h&&(!n||n(h._element))&&(o&&this.isSelectable(h._element)||!o)&&(i?h.intersects(t)&&r.add(l):We.contains(t,h.getViewRect())&&r.add(l))}return r},getPosition:function(t,e,i,n,o){var r,a=e instanceof De.canvas.ElementUI?e:this.getElementUI(e);if(a)if("from"===t||"to"===t){if(a.getFromPosition&&(r="from"===t?a.getFromPosition(n,o):a.getToPosition(n,o)))return i?{x:r.x-i.width/2,y:r.y-i.height/2}:r}else r="hotspot"===t?a.getHotSpot():Ze.get(t,a.getBodyRect(),i);if(!r&&e.getRect&&(r=Ze.get(t,e.getRect(),i)),r)return{x:r.x+n,y:r.y+o};throw"position '"+t+"' object '"+e+"'"},isValidEvent:function(t){if(!t)return!1;var e,i;if(t.currentTarget===this._view){if(Ue.isFirefox?(e=t.layerX,i=t.layerY):(e=t.offsetX,i=t.offsetY),1==this.isHScrollBarVisible()&&i>=this.viewRect.height-this.getScrollBarWidth())return!1;if(1==this.isVScrollBarVisible()&&e>=this.viewRect.width-this.getScrollBarWidth())return!1}return!0},addMarker:function(t){this.markerList.add(t),this.repaintTopCanvas()},removeMarker:function(t){this.markerList.remove(t),this.repaintTopCanvas()},clearMarker:function(){this.markerList.clear(),this.repaintTopCanvas()},isMovable:function(t){return!!this._box.contains(t)&&(!(t instanceof De.Link)&&(!(this._movableFunction&&!this._movableFunction(t))&&this.getLayerByElement(t).isMovable()))},hasMovableSelectedElements:function(){for(var t=this.getSelectionModel().getSelection(),e=0;e<t.size();e++){var i=t.get(e);if(this.isMovable(i))return!0}return!1},getMovableSelectedElements:function(){return this.getSelectionModel().toSelection(function(t){return this.isMovable(t)},this)},moveSelectedElements:function(t,e,i,n){if(0!==t||0!==e){var o=this.getMovableSelectedElementsRect();null!=o&&(this._limitElementInPositiveLocation&&(o.x+t<0&&(t=-o.x),o.y+e<0&&(e=-o.y)),De.Util.moveElements(this.getMovableSelectedElements(),t,e,i,n,this))}},getMovableSelectedElementsRect:function(){var t=this.getMovableSelectedElements();if(0===t.size())return null;for(var e=null,i=0,n=t.size();n>i;i++){var o=t.get(i);if(o instanceof On){var r=this.getElementUI(o);r&&(e=We.unionRect(e,r.getViewRect()))}}return e},isVisible:function(t,e,i){if(!this._box.contains(t))return!1;if(!t.isVisible())return!1;if(3!==arguments.length&&(e=this._visibleFunction),e&&!e(t))return!1;if(!(i||this._box._layerBox.getLayerByElement(t))._visible)return!1;if(_i.getSubNetwork(t)!==this._currentSubNetwork)return!1;if(t instanceof De.Link){if(!this._noAgentLinkVisible){if(!t._fromAgent||!t._toAgent)return!1;if(!this.isVisible(t._fromAgent,e,i)||!this.isVisible(t._toAgent,e,i))return!1}if(t.getBundleIndex()>0&&t.getBundleCount()>1&&!t.getStyle("link.bundle.expanded"))return!1}else for(var n=t._parent;n&&!n.ISubNetwork;){if(n instanceof De.Group&&(!n.isExpanded()||!this.isVisible(n,e,i)))return!1;n=n._parent}return!t.IDummy},getVisibleFunction:function(){return this._visibleFunction},setVisibleFunction:function(t){var e=this._visibleFunction;this._visibleFunction=t,this.firePropertyChange("visibleFunction",e,t),this.invalidateElementVisibility()},isEditable:function(t){return!!this._box.contains(t)&&(!(this._editableFunction&&!this._editableFunction(t))&&this.getLayerByElement(t).isEditable())},getEditableFunction:function(){return this._editableFunction},setEditableFunction:function(t){var e=this._editableFunction;this._editableFunction=t,this.firePropertyChange("editableFunction",e,t),this.invalidateSelectedElementUIs(!0)},isRotatable:function(t){return!(this._rotatableFunction&&!this._rotatableFunction(t))},getRotatableFunction:function(){return this._rotatableFunction},setRotatableFunction:function(t){var e=this._rotatableFunction;this._rotatableFunction=t,this.firePropertyChange("rotatableFunction",e,t),this.invalidateSelectedElementUIs(!0)},isLinkable:function(t){return null==this._linkableFunction||this._linkableFunction(t)},getLinkableFunction:function(){return this._linkableFunction},setLinkableFunction:function(t){var e=this._linkableFunction;this._linkableFunction=t,this.firePropertyChange("linkableFunction",e,t),this.invalidateSelectedElementUIs(!0)},onShareSelectionModelChanged:function(){this.invalidateElementUIs()},getShadowColor:function(t){var e=t.getStyle("shadow.color");return!e&&this.isSelected(t)&&"shadow"===t.getStyle("select.style")?t.getStyle("select.color"):e},getSelectColor:function(t){return t.getStyle("select.color")},getAlarmLabel:function(t){var e=t.getAlarmState().getHighestNewAlarmSeverity();if(e){var i=t.getAlarmState().getNewAlarmCount(e)+e.nickName;return t.getAlarmState().hasLessSevereNewAlarms()&&(i+="+"),i}return null},getLinkHandlerLabel:function(t){return t.isBundleAgent()?"+("+t.getBundleCount()+")":null},setInteractions:function(t){var e=this._interactions;e&&e.forEach(function(t){t.tearDown()}),this._interactions=t,t&&t.forEach(function(t){t.setUp()}),this.invalidateSelectedElementUIs(!0),this.firePropertyChange("interactions",e,t)},getInteractions:function(){return this._interactions},setDefaultInteractions:function(t){this.setInteractions([new De.canvas.interaction.DefaultInteraction(this),new De.canvas.interaction.SelectInteraction(this),new De.canvas.interaction.MoveInteraction(this,t),new De.canvas.interaction.ScrollInteraction(this)])},setTouchInteractions:function(){this.setInteractions([new De.canvas.interaction.DefaultInteraction(this),new De.canvas.interaction.SelectInteraction(this),new De.canvas.interaction.MoveInteraction(this,!1),new De.canvas.interaction.ScrollInteraction(this),new De.canvas.interaction.TouchInteraction(this)])},setMSTouchInteractions:function(){this.setInteractions([new De.canvas.interaction.ScrollInteraction(this),new De.canvas.interaction.MSTouchInteraction(this)])},setEditInteractions:function(t){this.setInteractions([new De.canvas.interaction.DefaultInteraction(this),new De.canvas.interaction.SelectInteraction(this),new De.canvas.interaction.EditInteraction(this,t),new De.canvas.interaction.MoveInteraction(this,t),new De.canvas.interaction.ScrollInteraction(this)])},setCreateElementInteractions:function(t){this.setInteractions([new De.canvas.interaction.DefaultInteraction(this),new De.canvas.interaction.CreateElementInteraction(this,t)])},setCreateLinkInteractions:function(t){this.setInteractions([new De.canvas.interaction.DefaultInteraction(this),new De.canvas.interaction.CreateLinkInteraction(this,t),new De.canvas.interaction.ScrollInteraction(this)])},setCreateShapeLinkInteractions:function(t){this.setInteractions([new De.canvas.interaction.DefaultInteraction(this),new De.canvas.interaction.CreateShapeLinkInteraction(this,t),new De.canvas.interaction.ScrollInteraction(this)])},setCreateShapeNodeInteractions:function(t){this.setInteractions([new De.canvas.interaction.DefaultInteraction(this),new De.canvas.interaction.CreateShapeNodeInteraction(this,t),new De.canvas.interaction.ScrollInteraction(this)])},setPanInteractions:function(){this.setInteractions([new De.canvas.interaction.DefaultInteraction(this),new De.canvas.interaction.PanInteraction(this),new De.canvas.interaction.ScrollInteraction(this)])},setMagnifyInteractions:function(){this.setInteractions([new De.canvas.interaction.DefaultInteraction(this),new De.canvas.interaction.SelectInteraction(this),new De.canvas.interaction.MoveInteraction(this),new De.canvas.interaction.ScrollInteraction(this),new De.canvas.interaction.MagnifyInteraction(this)])},hasEditInteraction:function(){return this._hasEditInteraction},setHasEditInteraction:function(t){var e=this._hasEditInteraction;this._hasEditInteraction=t,this.firePropertyChange("hasEditInteraction",e,t)},addElementByInteraction:function(t){t.getParent()||t.setParent(this._currentSubNetwork),this._box.add(t),this.getSelectionModel().setSelection(t),this.fireInteractionEvent({kind:"createElement",element:t})},getToolTip:function(t){if(t){var e=t.getToolTip();return e||t.getName()}return null},isToolTipEnabled:function(){return!!this._toolTipEnabled},setToolTipEnabled:function(t){if(this._toolTipEnabled=t,t){if(!this._toolTipListener){var e=this;this._toolTipListener=function(t){if(e.isMovingElement())return void xi.hideToolTip();var i=e.getElementAt(t);if(e._preElement!==i)if(e._preElement=i,i){var n=e.getToolTip(i);xi.showToolTip({x:t.pageX,y:t.pageY},n);var o=xi.getToolTipDiv(),o=xi.getToolTipDiv();if(o.children.length>0){var r=e._view.getBoundingClientRect(),a=o.getBoundingClientRect();a.width+a.left>r.width+r.left&&(o.style.left=r.width+r.left-a.width+(ze.documentElement.scrollLeft||ze.body.scrollLeft)+"px"),a.height+a.top>r.height+r.top&&(o.style.top=r.height+r.top-a.height+(ze.documentElement.scrollTop||ze.body.scrollTop)+"px")}}else xi.hideToolTip()},this._view.addEventListener("mousemove",this._toolTipListener,!1),this.firePropertyChange("toolTipEnabled",!1,!0)}}else this._toolTipListener&&(xi.hideToolTip(),this._view.removeEventListener("mousemove",this._toolTipListener,!1),delete this._toolTipListener,this.firePropertyChange("toolTipEnabled",!0,!1))},setZoom:function(t){t=this.checkZoom(t);var e=this._zoom;if(this._zoom!=t){var i={x:(this.viewRect.x+this.viewRect.width/2)/this.getZoom()*t,y:(this.viewRect.y+this.viewRect.height/2)/this.getZoom()*t};this._zoom=t,this.invalidateElementVisibility(),this.invalidateCanvasSize(),this.validateCanvasSize(),this.setViewRect(i.x-this.viewRect.width/2,i.y-this.viewRect.height/2,this.viewRect.width,this.viewRect.height),this.firePropertyChange("zoom",e,this._zoom)}},getZoom:function(){return this._zoom},setTouchZoom:function(t){this.setZoom(t,!1)},zoomOverview:function(t){if(!(this.realWidth<=0||this.realHeight<=0)){var e=this.realWidth/this.getZoom(),i=this.realHeight/this.getZoom(),n=this.viewRect.width/e,o=this.viewRect.height/i,r=Math.min(n,o);this.setZoom(r)}},zoomReset:function(){this.setZoom(1)},zoomIn:function(){this.setZoom(1.2*this.getZoom())},zoomOut:function(){this.setZoom(this.getZoom()/1.2)},upSubNetwork:function(t,e){this._currentSubNetwork&&this.setCurrentSubNetwork(_i.getSubNetwork(this._currentSubNetwork),t,e)},getCurrentSubNetwork:function(){return this._currentSubNetwork},setCurrentSubNetwork:function(t,e,i){if(De.animate.AnimateManager.endAnimate(),e){if(this._currentSubNetwork===t)return;if(t&&!this._box.contains(t))throw t+" is not contained in this network's elementBox";var n=new De.animate.AnimateSubNetwork(this,t,i);De.animate.AnimateManager.start(n)}else this._setCurrentSubNetwork(t),i&&i()},_setCurrentSubNetwork:function(t){if(this._currentSubNetwork!==t){if(t&&!this._box.contains(t))throw t+" is not contained in this network's elementBox";var e=this._currentSubNetwork;this._currentSubNetwork=t,this.firePropertyChange("currentSubNetwork",e,t),this.invalidateElementVisibility(),this.invalidateCanvasSize()}},makeVisible:function(t){var e=this.getElementUI(t);if(e){var i=_i.getSubNetwork(t);if(i!==this._currentSubNetwork){var n=this;return void this.setCurrentSubNetwork(i,this.isSubNetworkAnimate(),function(){Me.callLater(n.makeVisible,n,[t])})}for(var o=t;(o=o.getParent())&&o!==i;)o instanceof De.Group&&o.setExpanded(!0);var r=e.getViewRect();if(r){var a={x:r.x*this.getZoom(),y:r.y*this.getZoom(),width:r.width*this.getZoom(),height:r.height*this.getZoom()};We.intersects(this.viewRect,a)||this.isVisible(t)&&Me.callLater(this.centerByLogicalPoint,this,[a.x+a.width/2,a.y+a.height/2])}}},centerByLogicalPoint:function(t,e,i){var n=t-this.viewRect.width/2,o=e-this.viewRect.height/2;this.setViewRect(n,o,this.viewRect.width,this.viewRect.height)},panByOffset:function(t,e){this.setViewOffSet(t,e)},getIconsNames:function(t){return t.getStyle("icons.names")},getIconsColors:function(t){return t.getStyle("icons.colors")},getLinkFlowStepping:function(t){var e=parseInt(t.getStyle("link.flow.stepping"));return e||(e=kn.NETWORK_LINK_FLOW_STEPPING),e},getLinkFlowOffset:function(t){var e=t.getStyle("link.flow.offset");return isNaN(e)&&(e=0),e+this.getLinkFlowStepping(t)},toCanvas:function(t,e,i){i||(i=Xe.createCanvas()),i.setAttribute("width",t),i.setAttribute("height",e),i._viewRect?(i._viewRect.width=t,i._viewRect.height=e):i._viewRect={x:0,y:0,width:t,height:e};var n=i.getContext("2d");if(n.clearRect(0,0,t,e),sn.draw(n,this),0===this._view.clientWidth||0===this._view.clientHeight)return i;var o=t/this.realWidth*this._zoom,r=e/this.realHeight*this._zoom;n.scale(o,r);var a=this.getBackgroundImage();if(a&&a._viewRect){var s=a._viewRect;try{n.drawImage(a,s.x,s.y,s.width,s.height)}catch(t){}}var l=this.getElementBox().getDatas()._as,h=l.length;this._topAttachmentList=new De.List;var c,u,d,f,p,g,_=this.getElementBox().getLayerBox(),m=_.getRoots(),v=m.size();if(1===v)for(d=0;h>d;d++)f=l[d],this._visibleMap[f._id]&&null!=(p=this._elementUIMap[f._id])&&p.paint(n);else for(c=0;v>c;c++)for(u=m.get(c),d=0;h>d;d++)f=l[d],_.getLayerByElement(f)===u&&this._visibleMap[f._id]&&null!=(p=this._elementUIMap[f._id])&&p.paint(n);for(h=this._topAttachmentList.size(),d=0;h>d;d++)g=this._topAttachmentList.get(d),g.getElementUI().paintAttachment(n,g);return i},toCanvasByRegion:function(t,e,i){i||(i=Xe.createCanvas());var n=t.width*e,o=t.height*e;i.setAttribute("width",n),i.setAttribute("height",o),i._viewRect?(i._viewRect.width=n,i._viewRect.height=o):i._viewRect={x:0,y:0,width:n,height:o};var r=i.getContext("2d");if(r.clearRect(0,0,n,o),sn.draw(r,this),0===this._view.clientWidth||0===this._view.clientHeight)return i;r.save(),r.scale(e,e),r.beginPath(),r.translate(-t.x,-t.y);var a=this.getElementBox().getDatas()._as,s=a.length;this._topAttachmentList=new De.List;var l=this.getBackgroundImage();if(l&&l._viewRect&&We.intersects(t,l._viewRect)){var t=We.intersection(t,l._viewRect),h=l._viewRect;try{r.drawImage(l,h.x,h.y,h.width,h.height)}catch(t){}}var c,u,d,f,p,g,_=this.getElementBox().getLayerBox(),m=_.getRoots(),v=m.size();if(1===v)for(d=0;s>d;d++)f=a[d],this._visibleMap[f._id]&&null!=(p=this._elementUIMap[f._id])&&We.intersects(t,p._viewRect)&&p.paint(r);else for(c=0;v>c;c++)for(u=m.get(c),d=0;s>d;d++)f=a[d],_.getLayerByElement(f)===u&&this._visibleMap[f._id]&&null!=(p=this._elementUIMap[f._id])&&We.intersects(t,p._viewRect)&&p.paint(r);for(s=this._topAttachmentList.size(),d=0;s>d;d++)g=this._topAttachmentList.get(d),g.getElementUI().paintAttachment(r,g);return r.restore(),i},getGroupChildrenRects:function(t){var e=new hn;return t.getChildren().forEach(function(t){if(t instanceof On){var i=this.getElementUI(t);if(i){var n=i.getViewRect();n&&e.add(n)}}},this),e},getBackgroundImageRect:function(){return null},getLinkPathFunction:function(){return this._linkPathFunction},setLinkPathFunction:function(t){var e=this._linkPathFunction;this._linkPathFunction=t,this.firePropertyChange("linkPathFunction",e,t),this.invalidateElementUIs()},onClickElement:function(t,e){},onClickBackground:function(t){},onDoubleClickElement:function(t,e){},onDoubleClickBackground:function(t){},onLongClickElement:function(t,e){},onLongClickBackground:function(t){},onMouseMove:function(t,e){},onMouseEnter:function(t,e){},onMouseLeave:function(t,e){},setMovingElement:function(t){if(t!=this._movingElement){var e=this._movingElement;this._movingElement=t,this.firePropertyChange("movingElement",e,t),this._box._undoManager._enabled&&(t?this._box._undoManager.startBatch():this._box._undoManager.endBatch())}},setEditingElement:function(t){if(t!=this._editingElement){var e=this._editingElement;this._editingElement=t,this.firePropertyChange("editingElement",e,t),this._box._undoManager._enabled&&(t?this._box._undoManager.startBatch():this._box._undoManager.endBatch())}}}),De.canvas.Overview=function(t){De.canvas.Overview.superClass.constructor.apply(this,t),this._view=Xe.createView(),this._rootDiv=Xe.createDiv(),this._imageCanvas=Xe.createCanvas(),this._imageDiv=Xe.createDiv(),this._maskCanvas=Xe.createCanvas(),this._selectDiv=Xe.createDiv(),this._isNetworkDirty=!1,this._isMaskDirty=!1,Xe.setVisible(this._selectDiv,!1),this._view.appendChild(this._rootDiv),this._rootDiv.appendChild(this._imageDiv),this._rootDiv.appendChild(this._maskCanvas),this._rootDiv.appendChild(this._selectDiv),this._imageDiv.appendChild(this._imageCanvas),this.setNetwork(t),Ue.isTouchable?Ue.isMSTouchable?new De.canvas.OverviewMSTouchInteraction(this):(new De.canvas.OverviewTouchInteraction(this),new De.canvas.OverviewInteraction(this)):new De.canvas.OverviewInteraction(this)},Me.ext("twaver.canvas.Overview",De.controls.ControlBase,{__accessor:["fillColor","outlineColor","outlineWidth","selectColor","selectWidth","padding","maxPackingWidth","maxPackingHeight"],__bool:["animate"],_fillColor:kn.OVERVIEW_FILL_COLOR,_outlineColor:kn.OVERVIEW_OUTLINE_COLOR,_outlineWidth:kn.OVERVIEW_OUTLINE_WIDTH,_selectColor:kn.OVERVIEW_SELECT_COLOR,_selectWidth:kn.OVERVIEW_SELECT_WIDTH,_padding:kn.OVERVIEW_PADDING,_animate:kn.OVERVIEW_ANIMATE,_maxPackingWidth:kn.OVERVIEW_MAX_PACKING_WIDTH,_maxPackingHeight:kn.OVERVIEW_MAX_PACKING_HEIGHT,getNetwork:function(){return this._network},onPropertyChanged:function(t){this._invalidateMask()},setNetwork:function(t){t!==this._network&&(this._network&&(this._network.removePropertyChangeListener(this._handleNetworkPropertyChange,this),this._network.removeViewListener(this._handleNetworkViewChange,this),Xe.removeEventListener("scroll","_handleScrollChange",this._network.getView(),this)),this._network=t,this._network&&(this._network.addPropertyChangeListener(this._handleNetworkPropertyChange,this),this._network.addViewListener(this._handleNetworkViewChange,this),Xe.addEventListener("scroll","_handleScrollChange",this._network.getView(),this)),this.invalidate())},_handleNetworkPropertyChange:function(t){("zoom"===t.property||"currentSubNetwork"===t.property||"elementBox"===t.property||"dataBox"===t.property||"canvasSizeChange"===t.property)&&this.invalidate()},_handleNetworkViewChange:function(t){"validateEnd"===t.kind&&this.invalidate()},_handleScrollChange:function(){this._invalidateMask()},invalidate:function(t){this._isNetworkDirty&&this._isMaskDirty||(this._isNetworkDirty||(this._isNetworkDirty=!0),this._isMaskDirty||(this._isMaskDirty=!0),Me.callLater(this.validate,this,null,t))},_invalidateMask:function(){this._isMaskDirty||(this._isMaskDirty=!0,Me.callLater(this.validate,this,[],100))},validate:function(){if((this._isMaskDirty||this._isNetworkDirty)&&this._network&&(this._maxPackingWidth>0&&this._maxPackingHeight>0||this._view.clientWidth>0&&this._view.clientHeight>0)&&0!==this._network.getViewRect().width&&0!==this._network.getViewRect().height&&!this._network._invalidate){var t,e=this._maxPackingWidth>0&&this._maxPackingHeight>0;t=e?{x:0,y:0,width:this._maxPackingWidth,height:this._maxPackingHeight}:{x:0,y:0,width:this._view.clientWidth,height:this._view.clientHeight},We.grow(t,-this._padding,-this._padding);var i=Math.min(t.width/this._network.getCanvasSize().width,t.height/this._network.getCanvasSize().height);e&&(Xe.setDiv(this._view,{x:0,y:0,width:this._imageDiv._viewRect.width,height:this._imageDiv._viewRect.height},null,0,null),t.width=this._imageDiv._viewRect.width,t.height=this._imageDiv._viewRect.height);var n=this._network.getCanvasSize().width*i,o=this._network.getCanvasSize().height*i,r=t.x+(t.width-n)/2,a=t.y+(t.height-o)/2;if(this._isNetworkDirty){var s={x:r,y:a,width:n,height:o};this._network.toCanvas(s.width,s.height,this._imageCanvas),Xe.setDiv(this._imageDiv,s,null,0,null),this._network.getElementBox&&(this._imageDiv.style.backgroundColor=(this._network.getCurrentSubNetwork()||this._network.getElementBox()).getStyle("background.color")||""),this._isNetworkDirty=!1}if(this._isMaskDirty){var l={x:this._network.getViewRect().x*i,y:this._network.getViewRect().y*i,width:n*this._network._view.clientWidth/this._network.getCanvasSize().width,height:o*this._network._view.clientHeight/this._network.getCanvasSize().height};l.x=l.x<0?0:l.x,l.y=l.y<0?0:l.y;var h=Xe.setCanvas(this._maskCanvas,r,a,n,o);h.lineWidth=0,h.fillStyle=this._fillColor,h.beginPath(),Ye.drawVector(h,"rectangle",null,r,a,n,o),h.fill(),h.clearRect(r+l.x,a+l.y,l.width,l.height);var c=this._outlineWidth<0?0:this._outlineWidth;h.lineWidth=c,h.strokeStyle=this._outlineColor;var u=l.width-2*c,d=l.height-2*c;u=Math.min(u,n-2-l.x-this._outlineWidth),d=Math.min(d,o-2-l.y-this._outlineWidth),h.beginPath(),Ye.drawVector(h,"rectangle",null,r+l.x+c,a+l.y+c,u,d),c>=0&&h.stroke(),this._isMaskDirty=!1}}else this._isNetworkDirty=!1,this._isMaskDirty=!1},getLogicalPoint:function(t){return Xe.getLogicalPoint(this._view,t,1,this._rootDiv)},centerNetwork:function(t,e){var i=this._imageDiv._viewRect;We.containsPoint(i,t)&&(this._network.centerByLogicalPoint((t.x-i.x)/i.width*this._network.getCanvasSize().width,(t.y-i.y)/i.height*this._network.getCanvasSize().height,e),this._invalidateMask())}}),De.canvas.OverviewTouchInteraction=function(t){this.overview=t,this.network=t.getNetwork(),this.view=t._view,Xe.addEventListener("touchstart","handleTouchstart",this.view,this)},Me.ext("twaver.canvas.OverviewTouchInteraction",Object,{handleTouchstart:function(t){Xe.preventDefault(t),this.clear(),this.endPoint=this.overview.getLogicalPoint(t),wi.isMultiTouch(t)&&(this.distance=wi.getDistance(t),this.zoom=this.network.getZoom()),Xe.addEventListener("touchmove","handleTouchmove",this.view,this),Xe.addEventListener("touchend","handleTouchend",this.view,this)},handleTouchmove:function(t){if(this.moved||(this.moved=!0),this.endPoint=this.overview.getLogicalPoint(t),wi.isSingleTouch(t))this.overview.centerNetwork(this.endPoint,!1);else if(this.distance){var e=wi.getDistance(t)/this.distance;this.network.setZoom(this.zoom*e,!1)}},handleTouchend:function(t){if(!this.moved){this.endPoint=this.overview.getLogicalPoint(t);var e=this.lastPoint&&this.lastTouchStartTime&&(new Date).getTime()-this.lastTouchStartTime.getTime()<=300&&Math.abs(this.endPoint.x-this.lastPoint.x)<=10&&Math.abs(this.endPoint.y-this.lastPoint.y)<=10;e?(this.lastPoint=null,this.lastTouchStartTime=null):(this.lastPoint=this.endPoint,this.lastTouchStartTime=new Date),e?Me.callLater(this.network.zoomReset,this.network,[this.overview._animate]):this.overview.centerNetwork(this.endPoint,this.overview._animate)}this.clear()},clear:function(){this.endPoint&&(this.endPoint=null,Xe.removeEventListener("touchmove",this.view,this),Xe.removeEventListener("touchend",this.view,this)),this.moved=!1}}),De.canvas.OverviewMSTouchInteraction=function(t){this.overview=t,this.network=t.getNetwork(),this.view=t._view,this._pointerMap={},this._pointerIdArray=[],Xe.addEventListener("MSPointerDown","handleTouchstart",this.view,this),Xe.addEventListener("MSPointerMove","handleTouchmove",this.view,this),Xe.addEventListener("MSPointerUp","handleTouchend",this.view,this),Xe.addEventListener("MSPointerCancel","handleTouchend",this.view,this)},Me.ext("twaver.canvas.OverviewMSTouchInteraction",Object,{handleTouchstart:function(t){Xe.preventDefault(t),t.isPrimary&&this._pointerIdArray.length>0&&(this._pointerMap={},this._pointerIdArray=[]),!this._pointerMap[t.pointerId]&&this.overview.getLogicalPoint(t)&&(this._pointerIdArray.push(t.pointerId),this._pointerMap[t.pointerId]=t),1==this._pointerIdArray.length?(this._startTouchPoint=this.overview.getLogicalPoint(t),this._startTouchTime=new Date):2==this._pointerIdArray.length&&(this._distance=this._getDistance(),this._zoom=this.network.getZoom())},handleTouchmove:function(t){if(0!=this._pointerIdArray.length&&this._pointerMap[t.pointerId]&&!(We.getDistance({x:this._pointerMap[t.pointerId].pageX,y:this._pointerMap[t.pointerId].pageY},{x:t.pageX,y:t.pageY})<=10))if(this._pointerMap[t.pointerId]=t,2==this._pointerIdArray.length){var e=this._getDistance()/this._distance;this.network.setZoom(this._zoom*e,!1)}else if(1==this._pointerIdArray.length&&this._startTouchPoint){var i=this.overview.getLogicalPoint(t);if(null==i)return;this._startTouchPoint=i,this.overview.centerNetwork(this._startTouchPoint,!1)}},handleTouchend:function(t){var e=this.overview.getLogicalPoint(t);if(1==this._pointerIdArray.length&&e){var i=this._endTouchPoint&&this._endTouchTime&&(new Date).getTime()-this._endTouchTime.getTime()<=500&&We.getDistance(this._endTouchPoint,e)<=10;i?(this._endTouchPoint=null,this._endTouchTime=null):(this._endTouchPoint=e,this._endTouchTime=new Date),i?Me.callLater(this.network.zoomReset,this.network,[this.overview._animate]):this.overview.centerNetwork(this._endTouchPoint,this.overview._animate)}this._pointerMap={},this._pointerIdArray=[]},_getDistance:function(){return We.getDistance({x:this._pointerMap[this._pointerIdArray[0]].pageX,y:this._pointerMap[this._pointerIdArray[0]].pageY},{x:this._pointerMap[this._pointerIdArray[1]].pageX,y:this._pointerMap[this._pointerIdArray[1]].pageY})}}),De.canvas.OverviewInteraction=function(t){this.overview=t,this.network=t.getNetwork(),this.view=t._view,Xe.addEventListener("mousedown","handleMousedown",this.view,this)},Me.ext("twaver.canvas.OverviewInteraction",Object,{handleMousedown:function(t){0===t.button&&(this.clear(),this.endPoint=this.overview.getLogicalPoint(t),Me.isCtrlDown(t)&&(this.startPoint=this.endPoint,Xe.setVisible(this.overview._selectDiv,!0)),Xe.addEventListener("mousemove","handleMousemove",this.view,this),Xe.addEventListener("mouseup","handleMouseup",this.view,this))},handleMouseup:function(t){if(this.endPoint=this.overview.getLogicalPoint(t),"detail"in t&&2===t.detail)Me.callLater(this.network.zoomReset,this.network,[this.overview._animate]);else if(Xe.isVisible(this.overview._selectDiv)&&this.startPoint){var e=this.overview._imageDiv._viewRect,i=this.overview._selectDiv._viewRect.x,n=this.overview._selectDiv._viewRect.y,o=e.width/this.overview._selectDiv._viewRect.width,r=e.height/this.overview._selectDiv._viewRect.height,a=Math.min(o,r);this.network.setZoom(a*Math.min(this.network.getViewRect().width/this.network.getCanvasSize().width,this.network.getViewRect().height/this.network.getCanvasSize().height)*this.network.getZoom(),!1);var s=this.network.getCanvasSize().width*((i-e.x+this.overview._selectDiv._viewRect.width/2)/e.width),l=this.network.getCanvasSize().height*((n-e.y+this.overview._selectDiv._viewRect.height/2)/e.height);Me.callLater(this.network.centerByLogicalPoint,this.network,[s,l,this.overview._animate]),Xe.setVisible(this.overview._selectDiv,!1),Xe.setDiv(this.overview._selectDiv,{x:0,y:0,width:0,height:0},null,0,null),this.startPoint=null}else this.overview.centerNetwork(this.endPoint,this.overview._animate);this.clear()},handleMousemove:function(t){var e=this.overview.getLogicalPoint(t);if(this.endPoint=e,Xe.isVisible(this.overview._selectDiv)&&this.startPoint){var i=e.x>this.startPoint.x?this.startPoint.x:e.x,n=e.x>this.startPoint.x?this.startPoint.y:e.y;e.x>this.startPoint.x&&e.y<this.startPoint.y&&(n=e.y),e.x<this.startPoint.x&&e.y>this.startPoint.y&&(n=this.startPoint.y);var o=this.overview._imageDiv._viewRect;i<o.x&&(i=o.x),i>o.x+o.width&&(i=o.x+o.width),n<o.y&&(n=o.y),n>o.y+o.height&&(n=o.y+o.height);var r=Math.abs(e.x-this.startPoint.x),a=Math.abs(e.y-this.startPoint.y);i+r>o.x+o.width&&(r=o.x+o.width-i),n+a>o.y+o.height&&(a=o.y+o.height-n),Xe.setDiv(this.overview._selectDiv,{x:i,y:n,width:r,height:a},null,this.overview._selectWidth,this.overview._selectColor)}else this.overview.centerNetwork(e,!1)},clear:function(){this.endPoint&&(this.endPoint=null,Xe.removeEventListener("mousemove",this.view,this),Xe.removeEventListener("mouseup",this.view,this))}}),De.canvas.ElementUI=function(t,e){this._network=t,this._element=e,this._attachments=new De.List,this._bodyBounds=new De.List,this._hitTest=!1,this._hitTest=!1,this._intersectTest=!1,this.invalidate(!0)},Me.ext("twaver.canvas.ElementUI",Object,{getElement:function(){return this._element},getNetwork:function(){return this._network},handlePropertyChange:function(t){this.invalidate(!0)},handleSelectionChange:function(t){this.invalidate(!0)},invalidate:function(t){t===e&&(t=!0),t&&(this._invalidateAttachmentsFlag=!0),this._invalidateFlag||(this._hotSpot=null,this._bodyRect=null,this._invalidateFlag=!0,this._network.invalidateElementVisibility())},updateStyle:function(){this._innerColor=this._network.getInnerColor(this._element),this._outerColor=this._network.getOuterColor(this._element),this._shadowColor=this._network.getShadowColor(this._element),this._shadowXOffset=this._element.getStyle("shadow.xoffset"),this._shadowYOffset=this._element.getStyle("shadow.yoffset"),this._shadowBlur=this._element.getStyle("shadow.blur"),this._wholeAlpha=this._element.getStyle("whole.alpha")},validate:function(){if(0!=this._invalidateFlag){this._bodyBounds.clear(),this._invalidateAttachmentsFlag&&(this._invalidateAttachmentsFlag=!1,this.checkAttachments()),this._invalidateFlag=!1,this.updateStyle(),this.validateImpl(),this._attachments.forEach(function(t){t.validate()});var t;this._bodyBounds.forEach(function(e){t=We.unionRect(t,e)}),this._unionBodyBounds=Me.clone(t),this._attachments.forEach(function(e){t=We.unionRect(t,e.getViewRect())}),this._viewRect=t}},validateImpl:function(){},setShadow:function(t,e){var i=t.isShadowable()&&this._shadowColor&&!this._editAttachment;return e.shadowOffsetX===this._shadowXOffset&&e.shadowOffsetY===this._shadowYOffset&&e.shadowBlur===this._shadowBlur?e:((i||this._network._showShadowInEdit)&&(e.shadowOffsetX=this._shadowXOffset,e.shadowOffsetY=this._shadowYOffset,e.shadowBlur=this._shadowBlur,e.shadowColor=this._shadowColor),e)},clearShadow:function(t){(0!=t.shadowOffsetX||0!=t.shadowOffsetY||0!=t.shadowBlur)&&(t.shadowOffsetX=0,t.shadowOffsetY=0,t.shadowBlur=0)},appendShadowBound:function(t,e){return t.isShadowable()&&this._shadowColor&&!this._editAttachment&&(this._shadowXOffset>0?e.width+=this._shadowXOffset:(e.x+=this._shadowXOffset,e.width+=-this._shadowXOffset),this._shadowYOffset>0?e.height+=this._shadowYOffset:(e.y+=this._shadowYOffset,e.height+=-this._shadowYOffset),We.grow(e,this._shadowBlur,this._shadowBlur)),e},isShadowable:function(){return!(!this._shadowColor||!this._network.isSelected(this._element)||"shadow"!==this._element.getStyle("select.style"))},addAttachment:function(t){this._attachments.add(t)},removeAttachment:function(t){this._attachments.remove(t)},getAttachments:function(){return this._attachments},checkAttachments:function(){this.checkLabelAttachment(),this.checkAlarmAttachment(),this.checkIconsAttachment(),this.checkEditAttachment()},checkLabelAttachment:function(){var t=this._network.getLabel(this._element);null!=t&&""!==t?this._labelAttachment||(this._labelAttachment=new De.canvas.LabelAttachment(this,kn.SHOW_LABEL_IN_ATTACHMENT_DIV),this.addAttachment(this._labelAttachment)):this._labelAttachment&&(this.removeAttachment(this._labelAttachment),this._labelAttachment=null)},checkAlarmAttachment:function(){var t=this._network.getAlarmLabel(this._element);null!=t&&""!==t?this._alarmAttachment||(this._alarmAttachment=new De.canvas.AlarmAttachment(this,kn.SHOW_ALARM_IN_ATTACHMENT_DIV),this.addAttachment(this._alarmAttachment)):this._alarmAttachment&&(this.removeAttachment(this._alarmAttachment),this._alarmAttachment=null)},checkIconsAttachment:function(){var t=this._network.getIconsNames(this._element);t&&t.length>0?this._iconsAttachment||(this._iconsAttachment=new De.canvas.IconsAttachment(this),this.addAttachment(this._iconsAttachment)):this._iconsAttachment&&(this.removeAttachment(this._iconsAttachment),this._iconsAttachment=null)},checkEditAttachment:function(){this._network.hasEditInteraction()&&this._network.isSelected(this._element)&&this._network.isEditable(this._element)&&this.isEditable()?this._editAttachment||(this._editAttachment=new De.canvas.EditAttachment(this),this.addAttachment(this._editAttachment)):this._editAttachment&&(this.removeAttachment(this._editAttachment),this._editAttachment=null)},getLabelAttachment:function(){return this._labelAttachment},getAlarmAttachment:function(){return this._alarmAttachment},getIconsAttachment:function(){return this._iconsAttachment},getEditAttachment:function(){return this._editAttachment},isEditable:function(){return!0},getInnerColor:function(){return this._innerColor},getOuterColor:function(){return this._outerColor},getShadowColor:function(){return this._shadowColor},getDyeColor:function(t){return this._innerColor?this._innerColor:this.getStyle(t)},getStyle:function(t){return this._element.getStyle(t)},getFont:function(t){var e=this._element.getStyle(t);return e||De.Defaults.FONT},paint:function(t){t.save(),t.globalAlpha=this._wholeAlpha,t.beginPath(),this.paintBody(t),this.clearShadow(t),t.closePath(),t.beginPath(),this.paintAttachments(t),t.closePath(),t.restore()},paintBody:function(t){},paintAttachments:function(t){t.beginPath();for(var e=this._attachments.size(),i=0;e>i;i++){var n=this._attachments.get(i);1==this._hitTest&&0==n.isShowOnTop()&&this.paintAttachment(t,n),1==this._intersectTest&&this.paintAttachment(t,n),0==this._hitTest&&0==this._intersectTest&&(n.isShowOnTop()?this._network._topAttachmentList.add(n):this.paintAttachment(t,n))}},paintAttachment:function(t,e){t.beginPath(),e.paint(t),this.clearShadow(t)},getViewRect:function(){return Me.clone(this._viewRect)},getUnionBodyBounds:function(){return Me.clone(this._unionBodyBounds)},addBodyBounds:function(t){t&&this._bodyBounds.add(t)},getBodyRect:function(){return this._bodyRect||(this._bodyRect=this.createBodyRect()),Me.clone(this._bodyRect)},getHotSpot:function(){return this._hotSpot?Me.clone(this._hotSpot):{x:0,y:0}},setHotSpot:function(t){this._hotSpot=t},hit:function(t,e){return!1},intersects:function(t){return!!We.contains(t,this.getViewRect())},hitCanvasRectAtBody:function(t){var e=Nn.getHitCanvas(t.width,t.height),i=Nn.getCtx(e);if(i.save(),i.translate(-t.x,-t.y),this._element.getImage){var n=Me.getImageAsset(this._element.getImage());if(n&&n.getImage()instanceof In)return 1}this.paintBody(i);try{for(var o=i.getImageData(0,0,t.width,t.height),r=o.data,a=0;a<o.width;a++)for(var s=0;s<o.height;s++){var l=4*(s*o.width+a),h=r[l+3];if(0!==h)return i.restore(),1}}catch(e){if(Nn.disposeHitCanvas(),We.contains(this.getUnionBodyBounds(),t))return 0}return i.restore(),-1},hitCanvasRectAtAttachments:function(t){var e=Nn.getHitCanvas(t.width,t.height),i=Nn.getCtx(e);i.save(),i.translate(-t.x,-t.y),this.paintAttachments(i);try{for(var n=i.getImageData(0,0,t.width,t.height),o=n.data,r=0;r<n.width;r++)for(var a=0;a<n.height;a++){var s=4*(a*n.width+r),l=o[s+3];if(0!==l)return i.restore(),1}}catch(t){Nn.disposeHitCanvas()}return i.restore(),-1},hitCanvasRect:function(t){this._intersectTest=!0,1==this._hitTest&&(this._intersectTest=!1);var e=We.intersection(t,this._viewRect),i=this.hitCanvasRectAtBody(e);return 1==i?(this._intersectTest=!1,!0):1==this.hitCanvasRectAtAttachments(e)?(this._intersectTest=!1,!0):(this._intersectTest=!1,0==i)},hitCanvasPoint:function(t,e){var i={x:t,y:e,width:0,height:0},n=this._network.getSelectionTolerance();if(n&&n>0&&We.grow(i,n,n),!We.intersects(this._viewRect,i))return!1;this._hitTest=!0;var o=this.hitCanvasRect(i);return this._hitTest=!1,o},hitTest:function(t,e){var i={x:t,y:e,width:0,height:0},n=this._network.getSelectionTolerance();if(n&&n>0&&We.grow(i,n,n),!We.intersects(this._viewRect,i))return null;var o=We.intersection(i,this._viewRect),r=this.hitCanvasRectAtBody(o);if(1==r)return this;for(var a=this._attachments.size(),s=0;a>s;s++){var l=this._attachments.get(s);if(l.hit(t,e))return l}return 0==r?this:null},dispose:function(){this._attachments.forEach(function(t){t.dispose()}),this._attachments.clear()}}),De.canvas.NodeUI=function(t,e){De.canvas.NodeUI.superClass.constructor.call(this,t,e)},Me.ext("twaver.canvas.NodeUI",De.canvas.ElementUI,{invalidate:function(t){De.canvas.NodeUI.superClass.invalidate.call(this,t),this.curInterval&&clearInterval(this.curInterval);var e=this._element.getAgentLinks();e&&e.forEach(function(t){this._network.invalidateElementUI(t,!1)},this);var i=this._element.getParent();i instanceof De.Group&&this._network.invalidateElementUI(i,!1)},createBodyRect:function(){return this._element.getRect()},validateImpl:function(){De.canvas.NodeUI.superClass.validateImpl.call(this);var t=this.getStyle("vector.shape"),e=this.getBodyRect();this._hotSpot=We.getHotSpot(e.x,e.y,e.width,e.height,t),this.validateBodyBounds()},validate:function(){0!=this._invalidateFlag&&De.canvas.NodeUI.superClass.validate.call(this)},validateBodyBounds:function(){var t=this.getStyle("body.type");"default"===t?this.addBodyBounds(this.getDefaultBodyRect()):"vector"===t?this.addBodyBounds(this.getVectorBody()):"default.vector"===t?(this.addBodyBounds(this.getVectorBody()),this.addBodyBounds(this.getDefaultBodyRect())):"vector.default"===t&&(this.addBodyBounds(this.getDefaultBodyRect()),this.addBodyBounds(this.getVectorBody())),this._outerColor&&this.addBodyBounds(this.getOuterBorderRect()),!this._editAttachment&&"border"===this.getStyle("select.style")&&this._network.isSelected(this._element)&&this.addBodyBounds(this.getSelectBorderRect())},getDefaultBodyRect:function(){var t=this._element,e=Me.getImageAsset(t.getImage()),i=this.getBodyRect();if(!e)return i;We.addPadding(i,this._element,"image.padding",1),this._defaultRect=i;var n=Me.clone(i);return this.appendShadowBound(this,n),i=n},getVectorBody:function(){return this.getPathRect("vector")},getOuterBorderRect:function(){return this._getBorderRect("outer")},getSelectBorderRect:function(){return this._getBorderRect("select")},_getBorderRect:function(t){var e=this._element,i=e.getStyle(t+".width");if(i>0){var n=this.getBodyRect();We.addPadding(n,e,t+".padding",1);var o=Me.clone(n);return We.grow(o,i/2,i/2),o}return null},getPathRect:function(t,e){var i=this._element,n=this.getBodyRect();e&&We.addPadding(n,i,t+".padding",1);var o=Me.clone(n),r=i.getStyle(t+".outline.width");return r>0&&We.grow(o,r/2,r/2),this.appendShadowBound(this,o),o},paintBody:function(t){this.curInterval&&clearInterval(this.curInterval);var e=this.getStyle("body.type");"default"===e?this.drawDefaultBody(t):"vector"===e?this.drawVectorBody(t):"default.vector"===e?(this.drawVectorBody(t),this.drawDefaultBody(t)):"vector.default"===e&&(this.drawDefaultBody(t),this.drawVectorBody(t)),this._outerColor&&this.drawOuterBorder(t),"border"===this.getStyle("select.style")&&this._network.isSelected(this._element)&&this.drawSelectBorder(t)},drawOuterBorder:function(t){var e=this._element,i=e.getStyle("outer.width");if(i>0){var n=this.getBodyRect();We.addPadding(n,e,"outer.padding",1),t.lineWidth=i,t.lineCap=e.getStyle("outer.cap"),t.lineJoin=e.getStyle("outer.join"),t.strokeStyle=this._outerColor,Ye.drawVector(t,e.getStyle("outer.shape"),null,n),t.stroke()}},drawDefaultBody:function(t){var e=this._element,i=Me.getImageAsset(e.getImage()),n=this._defaultRect;if(i&&i.getImage()){if(0!=e.getAngle()&&(t.save(),n=e.getOriginalRect(),De.Util.rotateCanvas(t,n,e.getAngle())),this.setShadow(this,t),i.getImage()instanceof In){var o,r=i.getImage().frames,a=i.getImage().size,s=0;o=Rn(r,a,0),t.drawImage(o,n.x,n.y,n.width,n.height),this.curInterval=setInterval(function(){s=(s+r.length)%r.length,o=Rn(r,a,s),t.drawImage(o,n.x,n.y,n.width,n.height),s++},100)}else Di(t,e.getImage(),this.getInnerColor(),n,e,this._network);0!=e.getAngle()&&t.restore()}},drawSelectBorder:function(t){var e=this._element,i=e.getStyle("select.width");if(i>0){var n=this.getBodyRect();n=Me.clone(n);var o=e.getStyle("select.physicalZoom")?1:this._network.getGraphicsZoom();We.addPadding(n,e,"select.padding",1/o),We.grow(n,i/2/o,i/2/o),t.lineWidth=i/o,t.lineCap=e.getStyle("select.cap"),t.lineJoin=e.getStyle("select.join"),t.strokeStyle=e.getStyle("select.color"),Ye.drawVector(t,e.getStyle("select.shape"),null,n),t.stroke()}},drawVectorBody:function(t){this.drawPath(t,"vector",!0,this._element.getStyle("vector.outline.pattern"));var e=this.getStyle("vector.deep"),i=this.getStyle("vector.fill.color"),n=this.getBodyRect();if(0!==e&&i){var o=this._element.getAngle();0!=o&&(t.save(),n=this._element.getOriginalRect(),De.Util.rotateCanvas(t,n,o)),"rectangle"===this.getStyle("vector.shape")&&Ye.draw3DRect(t,i,e,n),0!=o&&t.restore()}},drawPath:function(t,e,i,n,o,r,a){var s=this._element,l=this.getBodyRect();i&&We.addPadding(l,s,e+".padding",1);var h=s.getStyle(e+".outline.width");this.setShadow(this,t),0!=s.getAngle()&&(s instanceof Mn||(l=s.getOriginalRect()),t.save(),De.Util.rotateCanvas(t,l,s.getAngle()));var c,u=s.getStyle(e+".fill");if(u){c=this._innerColor&&!_i.hasDefault(this._element)?this._innerColor:s.getStyle(e+".fill.color");var d=s.getStyle(e+".gradient");d?Ye.fill(t,c,d,s.getStyle(e+".gradient.color"),l):t.fillStyle=c}var f=s.getStyle(e+".shape"),p=s.getStyle("group.shape.roundrect.radius");u&&(t.beginPath(),o?Ye.drawLinePoints(t,o,null,r,a):"roundrect"===f&&"group"===e?Ye.drawVector(t,f,null,l,p):Ye.drawVector(t,f,null,l),t.fill()),h>0&&(t.lineWidth=h,t.lineCap=s.getStyle(e+".cap"),t.lineJoin=s.getStyle(e+".join"),t.strokeStyle=s.getStyle(e+".outline.color"),t.beginPath(),o?Ye.drawLinePoints(t,o,n,r,a):"roundrect"===f&&"group"===e?Ye.drawVector(t,f,n,l,p):Ye.drawVector(t,f,n,l),t.stroke()),0!=s.getAngle()&&t.restore()},hit:function(t,e){var i={x:t,y:e,width:0,height:0},n=this._network.getSelectionTolerance();if(n&&n>0&&We.grow(i,n,n),this._network._transparentSelectionEnable){var o=this.getBodyRect();if(Me.math.intersects(o,i))return!0}return!!We.intersects(this.getViewRect(),i)&&this.hitCanvasPoint(t,e)},intersects:function(t){if(1==De.canvas.NodeUI.superClass.intersects.apply(this,arguments))return!0;if(this._network._transparentSelectionEnable){var e=this.getBodyRect();if(Me.math.intersects(e,t))return!0}return!!We.intersects(t,this.getViewRect())&&this.hitCanvasRect(t)}}),De.canvas.LinkUI=function(t,e){De.canvas.LinkUI.superClass.constructor.call(this,t,e)},Me.ext("twaver.canvas.LinkUI",De.canvas.ElementUI,{isEditable:function(){return!(!vi.isOrthogonalLink(this._element)||!this.getControlPoint())},invalidate:function(t){this._linkPoints=null,this._fromPoint=null,this._toPoint=null,this._angle=null,De.canvas.LinkUI.superClass.invalidate.call(this,t)},validateImpl:function(){this.validateBodyBounds(),De.canvas.LinkUI.superClass.validateImpl.call(this)},validateBodyBounds:function(){var t=this.getLinkPoints();if(t&&!(t.size()<2)){var e=this._element,i=We.getLineRect(t),n=e.getStyle("link.width"),o=n;if(this._outerColor){o+=2*e.getStyle("outer.width")}if(!this._editAttachment&&"border"===e.getStyle("select.style")&&this._network.isSelected(this._element)){o+=2*e.getStyle("select.width")}We.grow(i,o/2,o/2),e.getStyle("arrow.from")&&(this._network._debug&&(this._arrowFromRect=cn.getArrowRect(this,t,!0,e.getStyle("arrow.from.shape"),e.getStyle("arrow.from.width"),e.getStyle("arrow.from.height"),e.getStyle("arrow.from.xoffset"),e.getStyle("arrow.from.yoffset"))),i=We.unionRect(i,cn.getArrowRect(this,t,!0,e.getStyle("arrow.from.shape"),e.getStyle("arrow.from.width"),e.getStyle("arrow.from.height"),e.getStyle("arrow.from.xoffset"),e.getStyle("arrow.from.yoffset")))),e.getStyle("arrow.to")&&(this._network._debug&&(this._arrowToRect=cn.getArrowRect(this,t,!1,e.getStyle("arrow.to.shape"),e.getStyle("arrow.to.width"),e.getStyle("arrow.to.height"),e.getStyle("arrow.to.xoffset"),e.getStyle("arrow.to.yoffset"))),i=We.unionRect(i,cn.getArrowRect(this,t,!1,e.getStyle("arrow.to.shape"),e.getStyle("arrow.to.width"),e.getStyle("arrow.to.height"),e.getStyle("arrow.to.xoffset"),e.getStyle("arrow.to.yoffset")))),this.appendShadowBound(this,i),this.addBodyBounds(i)}},createBodyRect:function(){var t=this.getHotSpot();return t?{x:t.x-1,y:t.y-1,width:2,height:2}:null},paintBody:function(t){var e=this._linkPoints;if(e&&!(e.size()<2)){var i=this._element,n=i.getStyle("link.width"),o=n;if(this._outerColor){var r=i.getStyle("outer.width");o+=2*r}var a=!this._editAttachment&&"border"===i.getStyle("select.style")&&this._network.isSelected(this._element);if(a){o+=2*i.getStyle("select.width")}this.setShadow(this,t),t.lineCap=i.getStyle("link.cap"),t.lineJoin=i.getStyle("link.join");var s=i.getStyle("link.pattern");a&&this.drawLinePoints(t,e,o,i.getStyle("select.color"),s),this._outerColor&&this.drawLinePoints(t,e,n+2*r,this._outerColor,s),this.drawLinePoints(t,e,n,this._innerColor||i.getStyle("link.color"),s),cn.drawLinkArrow(this,t,e)}},drawLinePoints:function(t,e,i,n,o){if(t.lineWidth=i,t.strokeStyle=n,!0===this._element.getStyle("link.flow")&&o&&o.length>1){var r=new gi(t,o[0],o[1]),a=this._element.getStyle("link.flow.offset"),s=Math.floor(a/(o[0]+o[1]));s>2&&(a-=(o[0]+o[1])*s),this._element.getStyle("link.flow.converse")?a<o[0]?r.overflow=o[0]-a:a>=o[0]&&a<=o[0]+o[1]?(r.overflow=o[1]-(a-o[0]),r.overflow&&(r.isLine=!1)):(a-=o[0]+o[1],r.overflow=o[0]-a):a<=o[1]?(r.overflow=a,a&&(r.isLine=!1)):a>o[1]&&a<=o[0]+o[1]?r.overflow=a-o[1]:(a-=o[0]+o[1],a&&(r.isLine=!1),r.overflow=a),this._element._styleMap["link.flow.offset"]=a,t.beginPath(),Ye._drawLine(e,t),t.stroke(),t.shadowColor="transparent",t.beginPath();var l=this._element.getStyle("link.flow.color");l=l||kn.NETWORK_LINK_FLOW_COLOR,t.strokeStyle=l,Ye._drawLine(e,r),t.stroke(),t.shadowColor=this._shadowColor}else t.beginPath(),Ye.drawLinePoints(t,e,o),t.stroke()},getLinkPoints:function(){return this._linkPoints||(this._linkPoints=this.createLinkPoints(),this._lineLength=We.calculateLineLength(this._linkPoints)),this._linkPoints},getFromPosition:function(t,e){var i=this.getFromPoint();return i?{x:i.x+t,y:i.y+e}:null},getToPosition:function(t,e){var i=this.getToPoint();return i?{x:i.x+t,y:i.y+e}:null},getFromPoint:function(){return this._fromPoint||(this._fromPoint=vi.createFromPoint(this)),this._fromPoint},getToPoint:function(){return this._toPoint||(this._toPoint=vi.createToPoint(this)),this._toPoint},createLinkPoints:function(){var t=this.getFromPoint(),e=this.getToPoint(),i=this.getStyle("link.type"),n=new De.List;if(vi.isOrthogonalOrFlexionalLink(this._element))n=vi.orthogonalAndFlexional(this,i);else if(this._element.isLooped()){var o=this._network.getElementUI(this._element.getFromAgent());null!=o&&(this._hotSpot=vi.fillLoopedPoints(this,o.getBodyRect(),n))}else{if("arc"!==i&&"triangle"!==i&&"parallel"!==i)throw"Can not resolve link type '"+i+"'";this._hotSpot=vi.fillBundlePoints(this,i,t,e,n)}if(this._network._linkPathFunction){var r=this._network._linkPathFunction(this,n);r&&(n=r)}return n},checkAttachments:function(){De.canvas.LinkUI.superClass.checkAttachments.call(this),this.checkLinkHandlerAttachment()},checkLinkHandlerAttachment:function(){var t=this._network.getLinkHandlerLabel(this._element);null!=t&&""!==t?this._linkHandlerAttachment||(this._linkHandlerAttachment=new De.canvas.LinkHandlerAttachment(this),this.addAttachment(this._linkHandlerAttachment)):this._linkHandlerAttachment&&(this.removeAttachment(this._linkHandlerAttachment),this._linkHandlerAttachment=null)},getLinkHandlerAttachment:function(){return this._linkHandlerAttachment},getControlPoint:function(){return vi.getControlPoint(this._element,this)},setControlPoint:function(t){if(t){var e=this.getStyle("link.type");if(vi.hasControlPoint(e)){var i=vi.getLinkSourceBounds(this),n=vi.getLinkTargetBounds(this);vi.setParamsByControlPoint(t,i,n,e,this._element)}}},getLineLength:function(){return this._lineLength},hit:function(t,e){var i={x:t,y:e,width:0,height:0},n=this._network.getSelectionTolerance();return n&&n>0&&We.grow(i,n,n),!!We.intersects(this.getViewRect(),i)&&this.hitCanvasPoint(t,e)},intersects:function(t){if(1==De.canvas.LinkUI.superClass.intersects.apply(this,arguments))return!0;if(0==We.intersects(t,this.getViewRect()))return!1;var e=this.getLinkPoints(),i=e.size();if(2==i)for(var n=0;i>n;n+=2){var o=e.get(n);if(i>n+1){var r=e.get(n+1);if(Nn.intersectsLine(o.x,o.y,r.x,r.y,t.x,t.y,t.width,t.height))return!0}}return this.hitCanvasRect(t)},getAngle:function(){return!this._angle&&this._fromPoint&&this._toPoint&&(this._angle=We.getAngle(this._fromPoint,this._toPoint)),this._angle||0}}),De.canvas.GroupUI=function(t,e){De.canvas.GroupUI.superClass.constructor.call(this,t,e)},Me.ext("twaver.canvas.GroupUI",De.canvas.NodeUI,{isEditable:function(){return!this._element.isExpanded()},paintBody:function(t){this._shapeRect?this.drawExpandedGroup(t):De.canvas.GroupUI.superClass.paintBody.apply(this,arguments)},validateBodyBounds:function(){this.getBodyRect(),this._shapeRect?this.addBodyBounds(this.getPathRect("group",!1)):De.canvas.GroupUI.superClass.validateBodyBounds.call(this)},drawExpandedGroup:function(t){this.drawPath(t,"group",!1,this._element.getStyle("vector.outline.pattern"));var e=this.getStyle("group.deep"),i=this.getStyle("group.fill.color");0!==e&&i&&"rectangle"===this.getStyle("group.shape")&&Ye.draw3DRect(t,i,e,this._bodyRect)},getChildrenRects:function(){return this._network.getGroupChildrenRects(this._element)},createBodyRect:function(){this._shapeRect=null;var t=this._element,e=this._network;if(t.isExpanded()){t.getChildren().forEach(function(t){var i=e.getElementUI(t);i&&i.validate()});var i=this.getChildrenRects();if(!i.isEmpty()){var n=t.getStyle("group.shape"),o=Ge[n];if(!o)throw"Can not resolve group shape '"+n+"'";this._shapeRect=o(i)}}return this._shapeRect?(We.addPadding(this._shapeRect,t,"group.padding",1),this._shapeRect):De.canvas.GroupUI.superClass.createBodyRect.call(this)}}),De.canvas.ShapeNodeUI=function(t,e){De.canvas.ShapeNodeUI.superClass.constructor.call(this,t,e)},Me.ext("twaver.canvas.ShapeNodeUI",De.canvas.NodeUI,{getDefaultBodyRect:function(){return this._element._points.size()<2?null:this.getPathRect("vector",!0)},drawDefaultBody:function(t){this._element._points.size()<2||(this.drawPath(t,"vector",!0,this._element.getStyle("vector.outline.pattern"),this._element._points,this._element._segments,this._element.getStyle("shapenode.closed")),cn.drawLinkArrow(this,t,We.getPointObject(this._element._points,this._element._segments)))},drawSelectBorder:function(t){var e=this._element,i=e.getStyle("select.width");if(i>0){var n=this.getBodyRect();n=Me.clone(n);var o=e.getStyle("select.physicalZoom")?1:this._network.getGraphicsZoom();We.addPadding(n,e,"select.padding",1/o),We.grow(n,i/2,i/2);var r=e.getStyle("vector.outline.width");r>0&&We.grow(n,r/2/o,r/2/o),t.lineWidth=i/o,t.lineCap=e.getStyle("select.cap"),t.lineJoin=e.getStyle("select.join"),t.strokeStyle=e.getStyle("select.color"),Ye.drawVector(t,e.getStyle("select.shape"),null,n),t.stroke()}}}),De.canvas.ShapeLinkUI=function(t,e){De.canvas.ShapeLinkUI.superClass.constructor.call(this,t,e)},Me.ext("twaver.canvas.ShapeLinkUI",De.canvas.LinkUI,{isEditable:function(){return!0},createLinkPoints:function(){var t=this.getFromPoint(),e=this.getToPoint(),i=new De.List,n=this.getStyle("shapelink.type");i.add(t),null!=this._element._points&&i.addAll(this._element._points),i.add(e);var o,r,a,s,l,h,c,u=We.calculateLineLength(i)/2,d=i.size(),f=0,p=0;for(o=0;d>o;o++)if(s=i.get(o),0!=o){if(a=s,a instanceof hn&&(a=a._as),a instanceof Array?(l=We.calculateCurveLength(r,a,1),r=a[a.length-1]):(c=s.y-r.y,h=s.x-r.x,l=Math.sqrt(h*h+c*c),r=a),p+=l,u>=f&&p>=u){var g=u-f,_=i.get(o-1);_ instanceof hn&&(_=_._as)instanceof Array&&(_=_[_.length-1]);var m=i.get(o),v=We.getPathInfo(m,_,g,0,-1).point;this._hotSpot=Me.clone(v)}f=p}else r=s;var y,w,b;if("lineto"===n);else if("quadto"===n){for(y=new De.List(i.get(0)),w=1,pointCount=i.size();w<pointCount;w++)y.add(w<pointCount-1?new De.List([i.get(w++),i.get(w)]):i.get(w));i=y}else if("cubicto"===n){for(y=new De.List(i.get(0)),w=1,pointCount=i.size();w<pointCount;w++)y.add(w<pointCount-2?new De.List([i.get(w++),i.get(w++),i.get(w)]):w<pointCount-1?new De.List([i.get(w++),i.get(w)]):i.get(w));i=y}else{if("orthogonalto"!==n)throw"Can not resolve shapelink type '"+n+"'";for(b=i.get(0),y=new De.List(b),w=1,pointCount=i.size();w<pointCount;w++)if(w<pointCount-1){var s=Me.clone(i.get(w)),x=s.x,A=s.y,h=x-b.x,c=A-b.y;Math.abs(h)>Math.abs(c)?(s.x=x,s.y=b.y):(s.x=b.x,s.y=A),b=s,y.add(b)}else y.add(i.get(w));i=y}return i}}),De.canvas.GridUI=function(t,e){De.canvas.GridUI.superClass.constructor.call(this,t,e)},Me.ext("twaver.canvas.GridUI",De.canvas.NodeUI,{drawDefaultBody:function(t){this._element.getImage()?De.canvas.GridUI.superClass.drawDefaultBody.apply(this,arguments):this.drawGridBody(t)},validateBodyBounds:function(){if(this._element.getImage())De.canvas.GridUI.superClass.validateBodyBounds.call(this);else{var t=this.getBodyRect(),e=Me.clone(t);this.appendShadowBound(this,e),this.addBodyBounds(e)}},drawGridBody:function(t){var e=this.getStyle("grid.fill"),i=this.getStyle("grid.deep"),n=this.getStyle("grid.cell.deep");if(e||0!==i||0!==n){t.beginPath();var o=this._element.getRect(),r=this.getDyeColor("grid.fill.color");if(this.setShadow(this,t),e&&(t.fillStyle=r,t.rect(o.x,o.y,o.width,o.height),t.fill()),t.closePath(),this.clearShadow(t),t.beginPath(),0!=i&&Ye.draw3DRect(t,r,i,o.x,o.y,o.width,o.height),t.closePath(),0!=n)for(var a=this.getStyle("grid.row.count"),s=this.getStyle("grid.column.count"),l=0;a>l;l++)for(var h=0;s>h;h++){var c=this._element.getCellRect(l,h);null!=c&&(t.beginPath(),Ye.draw3DRect(t,r,n,c.x,c.y,c.width,c.height),t.closePath())}}}}),De.canvas.RotatableNodeUI=function(t,e){De.canvas.RotatableNodeUI.superClass.constructor.call(this,t,e)},Me.ext("twaver.canvas.RotatableNodeUI",De.canvas.NodeUI,{isEditable:function(){return!1},getDefaultBodyRect:function(){var t=this._element,e=Me.getImageAsset(t.getImage()),i=this.getBodyRect();return e?(We.addPadding(i,this._element,"image.padding",1),i):i},drawDefaultBody:function(t){var e=this._element,i=Me.getImageAsset(e.getImage()),n=this.getBodyRect();if(We.addPadding(n,this._element,"image.padding",1),i.getImage()){var o=this._element._getOrignalWidth(),r=this._element._getOrignalHeight(),a=this._element._getRotateRect();t.save(),t.translate(n.x-a.x+o/2,n.y-a.y+r/2),t.rotate(this._element._angle*Math.PI/180);var n={x:-o/2,y:-r/2,width:o,height:r};Di(t,i.getImage(this._innerColor,n.width,n.height),this._innerColor,n,e,this._network),t.restore()}else if(i.getSrc());else if(!i.getFunction())throw"ImageAsset '"+e.getImage()+" ' is empty"}}),De.canvas.HTMLNodeUI=function(t,e){De.canvas.HTMLNodeUI.superClass.constructor.call(this,t,e)},Me.ext("twaver.canvas.HTMLNodeUI",De.canvas.NodeUI,{checkAttachments:function(){De.canvas.NodeUI.prototype.checkAttachments.call(this)},checkLabelAttachment:function(){var t=this._element.getStyle("attachment.label.style");if(t&&"none"===t)return void De.canvas.HTMLNodeUI.superClass.checkLabelAttachment.call(this);var e=this._network.getLabel(this._element);null!=e&&""!==e?this._labelAttachment||(this._labelAttachment=new De.canvas.HTMLLabelAttachment(this,kn.SHOW_LABEL_IN_ATTACHMENT_DIV),this.addAttachment(this._labelAttachment)):this._labelAttachment&&(this.removeAttachment(this._labelAttachment),this._labelAttachment=null)},checkAlarmAttachment:function(){var t=this._element.getStyle("attachment.alarm.style");if(t&&"none"===t)return void De.canvas.HTMLNodeUI.superClass.checkAlarmAttachment.call(this);var e=this._network.getAlarmLabel(this._element);null!=e&&""!==e?this._alarmAttachment||(this._alarmAttachment=new De.canvas.HTMLAlarmAttachment(this,!1),this.addAttachment(this._alarmAttachment)):this._alarmAttachment&&(this.removeAttachment(this._alarmAttachment),this._alarmAttachment=null)},setAttachmentVisible:function(t){t?(this._labelAttachment&&this._labelAttachment.setVisibility("visible"),this._alarmAttachment&&this._alarmAttachment.setVisibility("visible")):(this._labelAttachment&&this._labelAttachment.setVisibility("hidden"),this._alarmAttachment&&this._alarmAttachment.setVisibility("hidden"))}}),De.canvas.HTMLLinkUI=function(t,e){De.canvas.HTMLLinkUI.superClass.constructor.call(this,t,e)},Me.ext("twaver.canvas.HTMLLinkUI",De.canvas.LinkUI,{checkAttachments:function(){De.canvas.LinkUI.prototype.checkAttachments.call(this)},checkLabelAttachment:function(){var t=this._element.getStyle("attachment.label.style");if(t&&"none"===t)return void De.canvas.HTMLLinkUI.superClass.checkLabelAttachment.call(this);var e=this._network.getLabel(this._element);null!=e&&""!==e?this._labelAttachment||(this._labelAttachment=new De.canvas.HTMLLabelAttachment(this),this.addAttachment(this._labelAttachment)):this._labelAttachment&&(this.removeAttachment(this._labelAttachment),this._labelAttachment=null)},checkAlarmAttachment:function(){var t=this._element.getStyle("attachment.alarm.style");if(t&&"none"===t)return void De.canvas.HTMLLinkUI.superClass.checkAlarmAttachment.call(this);var e=this._network.getAlarmLabel(this._element);null!=e&&""!==e?this._alarmAttachment||(this._alarmAttachment=new De.canvas.HTMLAlarmAttachment(this,!1),this.addAttachment(this._alarmAttachment)):this._alarmAttachment&&(this.removeAttachment(this._alarmAttachment),this._alarmAttachment=null)}}),De.canvas.Attachment=function(t,e){this._ui=t,this._element=this._ui.getElement(),this._network=t.getNetwork(),this._showOnTop=e},Me.ext("twaver.canvas.Attachment",Object,{getElement:function(){return this._element},getElementUI:function(){return this._ui},getNetwork:function(){return this._network},isShowOnTop:function(){return!0===this._showOnTop},setShowOnTop:function(t){this._showOnTop=t},getStyle:function(t){return this._ui.getStyle(t)},getFont:function(t){return this._ui.getFont(t)},getViewRect:function(){return Me.clone(this._viewRect)},getAlpha:function(){return 1},validate:function(){},paint:function(t){},hit:function(t,e){return!!We.containsPoint(this._viewRect,t,e)&&this.hitCanvasRect({x:t-1,y:e-1,width:2,height:2})},hitCanvasRect:function(t){var e=Nn.getHitCanvas(t.width,t.height),i=Nn.getCtx(e);i.save(),i.translate(-t.x,-t.y),this.paint(i);try{for(var n=i.getImageData(0,0,t.width,t.height),o=n.data,r=0;r<n.width;r++)for(var a=0;a<n.height;a++){var s=4*(a*n.width+r),l=o[s+3];if(0!==l)return i.restore(),!0}}catch(t){Nn.disposeHitCanvas()}return i.restore(),!1},dispose:function(){},_rotatePoint:function(t,e,i){return We.createMatrix(e*Math.PI/180,i.x+i.width/2,i.y+i.height/2).transform(t)},_rotatePointList:function(t,e,i){var n=this,o=new De.List;return t.forEach(function(t){o.add(n._rotatePoint(t,e,i))}),o}}),De.canvas.BasicAttachment=function(t,e){De.canvas.BasicAttachment.superClass.constructor.call(this,t,e),this._roundRect={x:0,y:0,width:0,height:0},this._contentRect={x:0,y:0,width:0,height:0}},Me.ext("twaver.canvas.BasicAttachment",De.canvas.Attachment,{paint:function(t){De.canvas.BasicAttachment.superClass.paint.apply(this,arguments);var e=this.isFill(),i=this.getOutlineWidth();if(this.getElementUI().setShadow(this,t),(i>0||e)&&(Ye.drawRoundRect(t,this._roundRect.x,this._roundRect.y,this._roundRect.width,this._roundRect.height,this.getCornerRadius()),this._pointers&&(t.moveTo(this._pointers[0].x,this._pointers[0].y),t.lineTo(this._pointers[1].x,this._pointers[1].y),t.lineTo(this._pointers[2].x,this._pointers[2].y)),t.closePath(),i>0&&(t.lineWidth=i,t.strokeStyle=this.getOutlineColor(),t.lineCap=this.getCap(),t.lineJoin=this.getJoin(),t.stroke()),e)){var n=this.getFillColor(),o=this.getGradient();o?Ye.fill(t,n,o,this.getGradientColor(),this._viewRect):t.fillStyle=n,t.fill()}},validate:function(){De.canvas.BasicAttachment.superClass.validate.call(this),this.calculateMeasure();var t=this.getOutlineWidth();this._viewRect=We.getRect(this._pointers),this._viewRect=We.unionRect(this._viewRect,this._roundRect),t>0&&We.grow(this._viewRect,t/2,t/2),this._viewRect=this._ui.appendShadowBound(this,this._viewRect)},calculateMeasure:function(){var t=this.getContentWidth(),e=this.getContentHeight(),i=this.getCornerRadius(),n=this.getPointerLength(),o=this.getPointerWidth(),r=this.getPosition(),a=this.getXOffset(),s=this.getYOffset(),l=this._roundRect;l.width=t+i,l.height=e;var h;if(this._ui._element instanceof De.Link){var c,u=this._ui.getLinkPoints();c=this._ui.getLineLength?this._ui.getLineLength():this._ui._element.getLineLength(),Math.abs(a)>0&&Math.abs(a)<1?"from"===r?a*=c:"to"===r?a=c*(1-a):(a/=2,a+=.5,a*=c):"from"===r?a=a:"to"===r?a=c-a:a+=c/2;var d,f=We.calculatePointInfoAlongLine(u,!0,a,s),p=f.point;f.angle,d="from"===r?this._ui.getFromPoint():"to"===r?this._ui.getToPoint():this._ui._hotSpot,a=p.x-d.x,s=p.y-d.y}if(n>0){var g=this.getDirection();h=this._network.getPosition(r,this._ui,null,a,s,!1);var _;if("aboveleft"===g)l.y=h.y-n-l.height,l.x=h.x-(l.width-i),_=Math.max(h.x-o,h.x-(l.width-i)+i/2),this._pointers=[h,{x:h.x,y:h.y-n},{x:_,y:h.y-n}];else if("aboveright"===g)l.y=h.y-n-l.height,l.x=h.x-i,_=Math.min(h.x+o,h.x-i+l.width-i/2),this._pointers=[h,{x:h.x,y:h.y-n},{x:_,y:h.y-n}];else if("belowleft"===g)l.y=h.y+n,l.x=h.x-(l.width-i),_=Math.max(h.x-o,h.x-(l.width-i)+i/2),this._pointers=[h,{x:h.x,y:h.y+n},{x:_,y:h.y+n}];else if("belowright"===g)l.y=h.y+n,l.x=h.x-i,_=Math.min(h.x+o,h.x-i+l.width-i/2),this._pointers=[h,{x:h.x,y:h.y+n},{x:_,y:h.y+n}];else if("leftabove"===g)l.y=h.y+i-l.height,l.x=h.x-n-l.width,_=Math.max(h.y-o,h.y+i-l.height+i/2),this._pointers=[h,{x:h.x-n,y:h.y},{x:h.x-n,y:_}];else if("leftbelow"===g)l.y=h.y-i,l.x=h.x-n-l.width,_=Math.min(h.y+o,h.y-i+l.height-i/2),this._pointers=[h,{x:h.x-n,y:h.y},{x:h.x-n,y:_}];else if("rightabove"===g)l.y=h.y+i-l.height,l.x=h.x+n,_=Math.max(h.y-o,h.y+i-l.height+i/2),this._pointers=[h,{x:h.x+n,y:h.y},{x:h.x+n,y:_}];else if("rightbelow"===g)l.y=h.y-i,l.x=h.x+n,_=Math.min(h.y+o,h.y-i+l.height-i/2),this._pointers=[h,{x:h.x+n,y:h.y},{x:h.x+n,y:_}];else if("above"===g)l.y=h.y-n-l.height,l.x=h.x-l.width/2,_=Math.min(t/2,o/2),this._pointers=[h,{x:h.x-_,y:h.y-n},{x:h.x+_,y:h.y-n}];else if("below"===g)l.y=h.y+n,l.x=h.x-l.width/2,_=Math.min(t/2,o/2),this._pointers=[h,{x:h.x-_,y:h.y+n},{x:h.x+_,y:h.y+n}];else if("left"===g)l.y=h.y-l.height/2,l.x=h.x-n-l.width,_=Math.min(e/2,o/2),this._pointers=[h,{x:h.x-n,y:h.y+_},{x:h.x-n,y:h.y-_}];else{if("right"!==g)throw"Can not resolve '"+g+"' attachment direction";l.y=h.y-l.height/2,l.x=h.x+n,_=Math.min(e/2,o/2),this._pointers=[h,{x:h.x+n,y:h.y+_},{x:h.x+n,y:h.y-_}]}}else h=this._network.getPosition(r,this._ui,{width:l.width,height:l.height},a,s,!1),l.x=h.x,l.y=h.y,this._pointers=null;this._contentRect.x=l.x+(l.width-t)/2,this._contentRect.y=l.y+(l.height-e)/2,this._contentRect.width=t,this._contentRect.height=e;var m=this.getPadding();0!=m&&We.grow(l,m,m),m=this.getPaddingLeft(),0!=m&&(l.x-=m,l.width+=m),m=this.getPaddingRight(),0!=m&&(l.width+=m),m=this.getPaddingTop(),0!=m&&(l.y-=m,l.height+=m),m=this.getPaddingBottom(),0!=m&&(l.height+=m),l.width<0&&(l.width=l.width,l.x-=l.width),l.height<0&&(l.height=-l.height,l.y-=l.height)},getContentWidth:function(){return De.Defaults.ATTACHMENT_CONTENT_WIDTH},getContentHeight:function(){return De.Defaults.ATTACHMENT_CONTENT_HEIGHT},getCornerRadius:function(){return De.Defaults.ATTACHMENT_CORNER_RADIUS},getPointerLength:function(){return De.Defaults.ATTACHMENT_POINTER_LENGTH},getPointerWidth:function(){return De.Defaults.ATTACHMENT_POINTER_WIDTH},getPosition:function(){return De.Defaults.ATTACHMENT_POSITION},getXOffset:function(){return De.Defaults.ATTACHMENT_XOFFSET},getYOffset:function(){return De.Defaults.ATTACHMENT_YOFFSET},getPadding:function(){return De.Defaults.ATTACHMENT_PADDING},getPaddingLeft:function(){return De.Defaults.ATTACHMENT_PADDING_LEFT},getPaddingRight:function(){return De.Defaults.ATTACHMENT_PADDING_RIGHT},getPaddingTop:function(){return De.Defaults.ATTACHMENT_PADDING_TOP},getPaddingBottom:function(){return De.Defaults.ATTACHMENT_PADDING_BOTTOM},getDirection:function(){return De.Defaults.ATTACHMENT_DIRECTION},isFill:function(){return De.Defaults.ATTACHMENT_FILL},getFillColor:function(){return De.Defaults.ATTACHMENT_FILL_COLOR},getGradient:function(){return De.Defaults.ATTACHMENT_GRADIENT},getGradientColor:function(){return De.Defaults.ATTACHMENT_GRADIENT_COLOR},getOutlineWidth:function(){return De.Defaults.ATTACHMENT_OUTLINE_WIDTH},getOutlineColor:function(){return De.Defaults.ATTACHMENT_OUTLINE_COLOR},getCap:function(){return De.Defaults.ATTACHMENT_CAP},getJoin:function(){return De.Defaults.ATTACHMENT_JOIN},isShadowable:function(){return De.Defaults.ATTACHMENT_SHADOWABLE},getRoundRect:function(){return Me.clone(this._roundRect)},getContentRect:function(){return Me.clone(this._contentRect)}}),De.canvas.LabelAttachment=function(t,e){De.canvas.LabelAttachment.superClass.constructor.call(this,t,e)},Me.ext("twaver.canvas.LabelAttachment",De.canvas.BasicAttachment,{paint:function(t){var e=this._element instanceof De.Link&&this._element.getStyle("link.label.rotatable");if(e){t.save();var i=this._viewRect.x+this._viewRect.width/2,n=this._viewRect.y+this._viewRect.height/2;t.translate(i,n),t.rotate(this._network.getElementUI(this._element).getAngle()),t.translate(-i,-n)}De.canvas.LabelAttachment.superClass.paint.apply(this,arguments);var o=this._element.getStyle("label.align"),r=this._element&&this._element.getStyle("label.rotate.angle");0!==r&&(t.save(),De.Util.rotateCanvas(t,this._contentRect,r)),Ye.drawText(t,this.text,this._contentRect,this.font,this.getStyle("label.color"),o),(e||0!==r)&&t.restore()},validate:function(){this.font=this.getFont("label.font");var t=this.getLabel(),e=Me.g.getTextSize(this.font,t),i=this.getMaxLength();0!==i&&e.width>i?(this.text=Me.g.getCollapseTextInLength(this.font,t,i),this._textSize=Me.g.getTextSize(this.font,this.text)):(this.text=t,this._textSize=e),De.canvas.LabelAttachment.superClass.validate.call(this);var n=this._viewRect,o=this._element&&this._element.getStyle("label.rotate.angle");if(0!==o){var r=new De.List;r.add({x:n.x,y:n.y}),r.add({x:n.x+n.width,y:n.y}),r.add({x:n.x+n.width,y:n.y+n.height}),r.add({x:n.x,y:n.y+n.height}),r=this._rotatePointList(r,o,n);var a=De.Util.getRect(r);this._viewRect=a}},getLabel:function(){return this._network.getLabel(this._element)},getContentWidth:function(){return this._textSize?this._textSize.width:0},getContentHeight:function(){return this._textSize?this._textSize.height:0},getCornerRadius:function(){return this.getStyle("label.corner.radius")},getPointerLength:function(){return this.getStyle("label.pointer.length")},getPointerWidth:function(){return this.getStyle("label.pointer.width")},getPosition:function(){return this.getStyle("label.position")},getXOffset:function(){return this.getStyle("label.xoffset")},getYOffset:function(){return this.getStyle("label.yoffset")},getPadding:function(){return this.getStyle("label.padding")},getPaddingLeft:function(){return this.getStyle("label.padding.left")},getPaddingRight:function(){return this.getStyle("label.padding.right")},getPaddingTop:function(){return this.getStyle("label.padding.top")},getPaddingBottom:function(){return this.getStyle("label.padding.bottom")},getDirection:function(){return this.getStyle("label.direction")},isFill:function(){return this.getStyle("label.fill")},getFillColor:function(){return this.getStyle("label.fill.color")},getGradient:function(){return this.getStyle("label.gradient")},getGradientColor:function(){return this.getStyle("label.gradient.color")},getOutlineWidth:function(){return this.getStyle("label.outline.width")},getOutlineColor:function(){return this.getStyle("label.outline.color")},getCap:function(){return this.getStyle("label.cap")},getJoin:function(){return this.getStyle("label.join")},getAlpha:function(){return this.getStyle("label.alpha")},getMaxLength:function(){return this.getStyle("label.maxlength")},isShadowable:function(){return this.getStyle("label.shadowable")}}),De.canvas.AlarmAttachment=function(t,e){De.canvas.AlarmAttachment.superClass.constructor.call(this,t,e)},Me.ext("twaver.canvas.AlarmAttachment",De.canvas.BasicAttachment,{paint:function(t){De.canvas.AlarmAttachment.superClass.paint.apply(this,arguments),Ye.drawText(t,this.text,this._contentRect,this.font,this.getStyle("alarm.color"))},validate:function(){this.font=this.getFont("alarm.font"),this.text=this._network.getAlarmLabel(this._element),this._textSize=Ye.getTextSize(this.font,this.text),this._fillColor=this._network.getAlarmFillColor(this._element),De.canvas.LabelAttachment.superClass.validate.call(this)},getContentWidth:function(){return this._textSize?this._textSize.width:0},getContentHeight:function(){return this._textSize?this._textSize.height:0},getCornerRadius:function(){return this.getStyle("alarm.corner.radius")},getPointerLength:function(){return this.getStyle("alarm.pointer.length")},getPointerWidth:function(){return this.getStyle("alarm.pointer.width")},getPosition:function(){return this.getStyle("alarm.position")},getXOffset:function(){return this.getStyle("alarm.xoffset")},getYOffset:function(){return this.getStyle("alarm.yoffset")},getPadding:function(){return this.getStyle("alarm.padding")},getPaddingLeft:function(){return this.getStyle("alarm.padding.left")},getPaddingRight:function(){return this.getStyle("alarm.padding.right")},getPaddingTop:function(){return this.getStyle("alarm.padding.top")},getPaddingBottom:function(){return this.getStyle("alarm.padding.bottom")},getDirection:function(){return this.getStyle("alarm.direction")},isFill:function(){return null!=this._fillColor},getFillColor:function(){return this._fillColor},getGradient:function(){return this.getStyle("alarm.gradient")},getGradientColor:function(){return this.getStyle("alarm.gradient.color")},getOutlineWidth:function(){return this.getStyle("alarm.outline.width")},getOutlineColor:function(){return this.getStyle("alarm.outline.color")},getCap:function(){return this.getStyle("alarm.cap")},getJoin:function(){return this.getStyle("alarm.join")},getAlpha:function(){return this.getStyle("alarm.alpha")},isShadowable:function(){return this.getStyle("alarm.shadowable")}}),De.canvas.LinkHandlerAttachment=function(t,e){De.canvas.LinkHandlerAttachment.superClass.constructor.call(this,t,e)},Me.ext("twaver.canvas.LinkHandlerAttachment",De.canvas.BasicAttachment,{paint:function(t){De.canvas.LinkHandlerAttachment.superClass.paint.apply(this,arguments),Ye.drawText(t,this.linkHandlerLabel,this._contentRect,this.linkHandlerFont,this.getStyle("link.handler.color"))},validate:function(){this.linkHandlerFont=this.getFont("link.handler.font"),this.linkHandlerLabel=this._network.getLinkHandlerLabel(this._element),this._textSize=Ye.getTextSize(this.linkHandlerFont,this.linkHandlerLabel),De.canvas.LinkHandlerAttachment.superClass.validate.call(this)},getContentWidth:function(){return this._textSize?this._textSize.width:0},getContentHeight:function(){return this._textSize?this._textSize.height:0},getCornerRadius:function(){return this.getStyle("link.handler.corner.radius")},getPointerLength:function(){return this.getStyle("link.handler.pointer.length")},getPointerWidth:function(){return this.getStyle("link.handler.pointer.width")},getPosition:function(){return this.getStyle("link.handler.position")},getXOffset:function(){return this.getStyle("link.handler.xoffset")},getYOffset:function(){return this.getStyle("link.handler.yoffset")},getPadding:function(){return this.getStyle("link.handler.padding")},getPaddingLeft:function(){return this.getStyle("link.handler.padding.left")},getPaddingRight:function(){return this.getStyle("link.handler.padding.right")},getPaddingTop:function(){return this.getStyle("link.handler.padding.top")},getPaddingBottom:function(){return this.getStyle("link.handler.padding.bottom")},getDirection:function(){return this.getStyle("link.handler.direction")},isFill:function(){return this.getStyle("link.handler.fill")},getFillColor:function(){return this.getStyle("link.handler.fill.color")},getGradient:function(){return this.getStyle("link.handler.gradient")},getGradientColor:function(){return this.getStyle("link.handler.gradient.color")},getOutlineWidth:function(){return this.getStyle("link.handler.outline.width")},getOutlineColor:function(){return this.getStyle("link.handler.outline.color")},getCap:function(){return this.getStyle("link.handler.cap")},getJoin:function(){return this.getStyle("link.handler.join")},getAlpha:function(){return this.getStyle("link.handler.alpha")},isShadowable:function(){return this.getStyle("link.handler.shadowable")}}),De.canvas.IconsAttachment=function(t,e){De.canvas.IconsAttachment.superClass.constructor.call(this,t,e)},Me.ext("twaver.canvas.IconsAttachment",De.canvas.Attachment,{isShadowable:function(){return De.Defaults.ATTACHMENT_SHADOWABLE},validate:function(){if(De.canvas.IconsAttachment.superClass.validate.call(this),this.iconsNames=this._network.getIconsNames(this._element),this.iconsNames&&0!=this.iconsNames.length){var t=this._makeGroup(this.iconsNames),e=this._makeGroup(this._network.getIconsColors(this._element));len=t.length,this.iconsOrientation=this._makeArray(this._element.getStyle("icons.orientation"),len,"right"),this.iconsPosition=this._makeArray(this._element.getStyle("icons.position"),len,"topleft.bottomright"),this.iconsXoffset=this._makeArray(this._element.getStyle("icons.xoffset"),len,0),this.iconsYoffset=this._makeArray(this._element.getStyle("icons.yoffset"),len,0),this.iconsXgap=this._makeArray(this._element.getStyle("icons.xgap"),len,1),this.iconsYgap=this._makeArray(this._element.getStyle("icons.ygap"),len,1),this.locations=[],this.iconsSizes=[];var n,o;for(i=0;i<len;i++){var r=t[i],a=this.iconsOrientation[i]||"right",s=this.iconsPosition[i]||"topleft.bottomright",l=this.iconsXgap[i]||1,h=this.iconsYgap[i]||1,c=this.iconsXoffset[i]||0,u=this.iconsYoffset[i]||0;if(this._ui._element instanceof De.Link){var d,f=this._ui.getLinkPoints();d=this._ui.getLineLength?this._ui.getLineLength():this._ui._element.getLineLength(),Math.abs(c)>0&&Math.abs(c)<1?"from"===s?c*=d:"to"===s?c=d*(1-c):(c/=2,c+=.5,c*=d):"from"===s?c=c:"to"===s?c=d-c:c+=d/2;var p,g=We.calculatePointInfoAlongLine(f,!0,c,u),_=g.point;g.angle,p="from"===s?this._ui.getFromPoint():"to"===s?this._ui.getToPoint():this._ui._hotSpot,c=_.x-p.x,u=_.y-p.y}o=null,n=this._getIconsSize(r,a,l,h),n&&(o=this._network.getPosition(s,this._ui,n,c,u),"top"===a?o.y+=n.height:"left"===a&&(o.x+=n.width)),this.locations.push(o),this.iconsSizes.push(n)}var m=null;for(i=0;i<this.locations.length;i++)o=this.locations[i],n=this.iconsSizes[i],null!=o&&(m=null==m?{x:o.x,y:o.y,width:n.width,height:n.height}:We.unionRect(m,{x:o.x,y:o.y,width:n.width,height:n.height}));this._viewRect=m||{x:this._element.getLocation().x,y:this._element.getLocation().y,width:0,height:0},this.iconsGroups=t,this.colorGroups=e;var v=this._element instanceof De.Link&&this._element.getStyle("link.icons.rotatable");for(i=0;i<len;i++)if(v instanceof Array&&v[i]&&this._viewRect){var y=this._viewRect.x+this._viewRect.width/2,w=this._viewRect.y+this._viewRect.height/2,b=Math.sqrt(this._viewRect.height*this._viewRect.height+this._viewRect.width*this._viewRect.width);this._viewRect={x:y-b/2,y:w-b/2,width:b,height:b}}}},_makeGroup:function(t){if(!Array.isArray(t))return[[t]];var e,i,n,o=[],r=!1,a=t.length;for(e=0;a>e;e++)i=t[e],Array.isArray(i)?(r=!0,o.push(i)):(n=[i],o.push(n));return r||(o.length=0,o.push(t)),o},_makeArray:function(t,e,i){if(Array.isArray(t))return t;for(var n=[],o=0;e>o;o++)n.push(t||i);return n},paint:function(t){if(De.canvas.IconsAttachment.superClass.paint.apply(this,arguments),this.iconsNames&&0!=this.iconsNames.length&&this.locations){var e,i,n,o,r,a,s,l,h,c;for(e=0;e<this.iconsGroups.length;e++)if(i=this.locations[e]){r=i.x,a=i.y,o=this.iconsGroups[e],s=this.colorGroups[e],l=this.iconsOrientation[e],h=this.iconsXgap[e]||1,c=this.iconsYgap[e]||1,n=0;for(var u in o){var d=null,f=null;s&&s.length>n&&(f=s[n++]);var p=Me.getImageAsset(o[u]);if(null!=p){if("right"===l)d={x:r,y:a,width:p.getWidth(),height:p.getHeight()},r+=d.width+h;else if("left"===l)d={x:r-p.getWidth(),y:a,width:p.getWidth(),height:p.getHeight()},r-=d.width+h;else if("top"===l)d={x:r,y:a-p.getHeight(),width:p.getWidth(),height:p.getHeight()},a-=d.height+c;else{if("bottom"!==l)throw"Can not resolve '"+l+"' orientation";d={x:r,y:a,width:p.getWidth(),height:p.getHeight()},a+=d.height+c}var g=this._element instanceof De.Link&&this._element.getStyle("link.icons.rotatable");if(g instanceof Array&&g[e]){t.save();var _=d,r=_.x+_.width/2,a=_.y+_.height/2;t.translate(r,a),t.rotate(this._network.getElementUI(this._element).getAngle()),t.translate(-r,-a),Di(t,p.getImage(f,d.width,d.height),f,d,this._element,this._network),t.restore()}else Di(t,p.getImage(f,d.width,d.height),f,d,this._element,this._network);if(this._network._debug){var d=this._viewRect;Ye.strokeRect(t,d,"#FCFC00",1),Ye.strokeRect(t,d,"#FCFC00",1)}}}}}},_getIconsSize:function(t,e,i,n){var o=0,r=0,a=null,s=null,l=null;for(var h in t)if(s=Me.getImageAsset(t[h])){if("right"===e)a={x:o,y:r,width:s.getWidth(),height:s.getHeight()},o+=a.width+i;else if("left"===e)a={x:o-s.getWidth(),y:r,width:s.getWidth(),height:s.getHeight()},o-=a.width+i;else if("top"===e)a={x:o,y:r-s.getHeight(),width:s.getWidth(),height:s.getHeight()},r-=a.height+n;else{if("bottom"!==e)throw"Can not resolve '"+e+"' orientation";a={x:o,y:r,width:s.getWidth(),height:s.getHeight()},r+=a.height+n}l=null==l?Me.clone(a):We.unionRect(l,a)}return l?{width:Math.abs(l.width),height:Math.abs(l.height)}:null}}),De.canvas.EditAttachment=function(t,e){De.canvas.EditAttachment.superClass.constructor.call(this,t,e)},Me.ext("twaver.canvas.EditAttachment",De.canvas.Attachment,{paint:function(t){De.canvas.EditAttachment.superClass.paint.apply(this,arguments),this._viewRect=null,this.paintResizingPoints(t),this.paintEditPoints(t),this.paintRotatePoints(t)},paintResizingPoints:function(t){var e=this.resizingPoints.size();if(!(0>=e)){var i=2*this.resizePointSize,n=2*this.resizePointSize,o=this._network.getResizePointFillColor(),r=this._network.getResizePointOutlineWidth(),a=this._network.getResizePointOutlineColor(),s=this._element.getAngle(),l=this._element.getOriginalRect();t.lineWidth=r;for(var h=0;e>h;h++){var c=this.resizingPoints.get(h),u={x:c.x-this.resizePointSize,y:c.y-this.resizePointSize,width:2*this.resizePointSize,height:2*this.resizePointSize},d=this._getRotateRect(u,s,{x:l.x+l.width/2,y:l.y+l.height/2});t.save(),De.Util.rotateCanvas(t,d,s),Nn.rect(t,d.x,d.y,i,n),t.restore()}t.fillStyle=o,t.strokeStyle=a,t.fill(),t.stroke()}},paintEditPoints:function(t){var e=this.editPoints.size();if(!(0>=e)){var i=this._network.getEditPointOutlineColor(),n=this._network.getEditPointFillColor(),o=this._network.getEditPointOutlineWidth();t.beginPath(),t.lineWidth=o;for(var r=0;e>r;r++){var a=this.editPoints.get(r);t.beginPath(),Nn.circle(t,a.x,a.y,this.editPointSize,n,i),t.closePath()}}},paintRotatePoints:function(t){var e=this.rotatePoints.size();if(!(0>=e)){var i=this._network.getRotatePointOutlineColor(),n=this._network.getRotatePointFillColor(),o=this._network.getRotatePointOutlineWidth();t.beginPath(),t.lineWidth=o;for(var r=0;e>r;r++){var a=this.rotatePoints.get(r);t.beginPath(),Nn.circle(t,a.x,a.y,this.rotatePointSize,n,i),t.closePath()}}},validate:function(){De.canvas.EditAttachment.superClass.validate.call(this),this.editPointSize=this._network.getEditPointSize(),this.resizePointSize=this._network.getResizePointSize(),this.rotatePointSize=this._network.getRotatePointSize(),this.resizingPoints=new De.List,this.editPoints=new De.List,this.rotatePoints=new De.List,this._element instanceof De.Node&&this._addResizingPoint(this._element),!(this._network.isRotatable(this._element)&&this._element instanceof On)||this._element instanceof De.ShapeNode||this._element instanceof De.Grid||this._element instanceof De.Group||this._addRotatePoint(this._element),this._element instanceof De.ShapeNode&&(this._addResizingPoint(this._element),this._addShapeNodePoint(this._element)),this._ui instanceof De.canvas.ShapeLinkUI&&this._addShapeLinkPoints(this._element),this._ui instanceof De.canvas.LinkUI&&this._addLinkControlPoint(this._ui)},_addResizingPoint:function(t){var e=t.getOriginalRect();if(e){if(!(0>=this._network.getResizePointSize())){var i=new hn([{x:e.x,y:e.y},{x:e.x+e.width/2,y:e.y},{x:e.x+e.width,y:e.y},{x:e.x,y:e.y+e.height/2},{x:e.x+e.width,y:e.y+e.height/2},{x:e.x,y:e.y+e.height},{x:e.x+e.width/2,y:e.y+e.height},{x:e.x+e.width,y:e.y+e.height}]),n=this._network.getResizePointOutlineWidth(),o=this._network.getResizePointOutlineColor(),r=this._network.getResizePointFillColor();this._addPoints(t.getRect(),i,n,o,r,!0)}}},_addRotatePoint:function(t){var e=t.getOriginalRect();if(e){var i=this._network.getRotatePointSize();if(!(0>=i)){var n=2*i,o=new De.List([{x:e.x+e.width/2,y:e.y-this._network.getRotatePointOffset()-n/2}]),r=t.getAngle();0!=r&&(o=this._rotatePointList(o,r,t.getOriginalRect()));var a=o.get(0),s={x:a.x-n/2,y:a.y-n/2,width:n,height:n},l=this._network.getRotatePointOutlineWidth(),h=this.rotatePointSize+l;We.grow(e,h,h);var c=We.unionRect(t.getRect(),s);this._viewRect=We.unionRect(c,this._viewRect),this.rotatePoints=o}}},_addShapeNodePoint:function(t){this._addEditPoints(t.getPoints())},_addShapeLinkPoints:function(t){this._addEditPoints(t.getPoints())},_addLinkControlPoint:function(t){if(vi.isOrthogonalLink(t._element)){var e=t.getControlPoint();if(e){var i=new De.List;i.add(e),this._addEditPoints(i)}}},_addEditPoints:function(t){var e=We.getRect(t);if(e){if(!(0>=this._network.getEditPointSize())){var i=this._network.getEditPointOutlineWidth();this._addPoints(e,t,i,!1)}}},_addPoints:function(t,e,i,n,o,r){var a=r?this._network.getResizePointSize():this._network.getEditPointSize();if(!(0>a)){var s=a+i;We.grow(t,s,s),this._viewRect=We.unionRect(t,this._viewRect),1==r?this.resizingPoints=e:this.editPoints=e}},_rotatePoint:function(t,e,i){return We.createMatrix(e*Math.PI/180,i.x+i.width/2,i.y+i.height/2).transform(t)},_rotatePointList:function(t,e,i){var n=this,o=new De.List;return t.forEach(function(t){o.add(n._rotatePoint(t,e,i))}),o},_getRotateRect:function(t,e,i){var n=We.createMatrix(e*Math.PI/180,i.x,i.y),o={x:t.x+t.width/2,y:t.y+t.height/2},r=n.transform(o),a=new De.List([{x:r.x-t.width/2,y:r.y-t.height/2},{x:r.x+t.width/2,y:r.y-t.height/2},{x:r.x+t.width/2,y:r.y+t.height/2},{x:r.x-t.width/2,y:r.y+t.height/2}]);return We.getRect(a)}}),De.canvas.HTMLLabelAttachment=function(t,e){De.canvas.HTMLLabelAttachment.superClass.constructor.call(this,t,e),this._triangleDiv=De.Util.createDiv(),this._roundDiv=De.Util.createDiv(),this._contentDiv=De.Util.createDiv(),this._network.getView().appendChild(this._roundDiv),this._roundDiv.appendChild(this._contentDiv)},Me.ext("twaver.canvas.HTMLLabelAttachment",De.canvas.LabelAttachment,{validate:function(){this._element.getStyle("attachment.htmllabel.hyperlink")?(De.Util.setCSSStyle(this._triangleDiv,"pointer-events","auto"),De.Util.setCSSStyle(this._contentDiv,"pointer-events","auto")):(De.Util.setCSSStyle(this._triangleDiv,"pointer-events","none"),De.Util.setCSSStyle(this._contentDiv,"pointer-events","none")),De.Util.setCSSStyle(this._triangleDiv,"border-style","solid"),De.Util.setCSSStyle(this._contentDiv,"white-space","nowrap");var t=(this.getFont("label.font"),this.getLabel());this._contentDiv.innerHTML=t,this._contentDiv.style.visibility="hidden",De.canvas.HTMLLabelAttachment.superClass.validate.call(this)},getContentWidth:function(){return this._contentDiv.scrollWidth||parseInt(De.Util.getCSSStyle(this._contentDiv.firstChild,"width"))},getContentHeight:function(){return this._contentDiv.scrollHeight||parseInt(De.Util.getCSSStyle(this._contentDiv.firstChild,"height"))},paint:function(t){var e=this.isFill(),i=this.getOutlineWidth(),n=this._contentRect;if(this.getElementUI().setShadow(this,t),i>0||e){if(Ye.drawRoundRect(t,n.x,n.y,n.width,n.height,this.getCornerRadius()),this._pointers){var o=this._pointers;t.moveTo(o[0].x,o[0].y),t.lineTo(o[1].x,o[1].y),t.lineTo(o[2].x,o[2].y)}if(t.closePath(),i>0&&(t.lineWidth=i,t.strokeStyle=this.getOutlineColor(),t.lineCap=this.getCap(),t.lineJoin=this.getJoin(),t.stroke()),e){var r=this.getFillColor(),a=this.getGradient();a?Ye.fill(t,r,a,this.getGradientColor(),this._viewRect):t.fillStyle=r,t.fill()}}var s=(this.getFont("label.font"),this.getLabel(),this._network.getViewRect().x),l=this._network.getViewRect().y,h=this._network.getZoom(),c={x:this._contentRect.x+this._contentRect.width/2,y:this._contentRect.y+this._contentRect.height/2},u=c.x*h-s-this._contentDiv.offsetWidth/2*h+"px",d=c.y*h-l-this._contentDiv.offsetHeight/2*h+"px";this._contentDiv.style.left=u,this._contentDiv.style.top=d,this._contentDiv.style.setProperty("-webkit-transform","scale("+h+")",null),this._contentDiv.style.setProperty("-webkit-transform-origin","0 0",null),this._network._debug&&Ye.strokeRect(t,this._contentRect,"#AAAAAA")},setVisibility:function(t){this._contentDiv.style.visibility=t},dispose:function(){this._network.getView().removeChild(this._roundDiv)},getView:function(){return this._roundDiv}}),De.canvas.HTMLAlarmAttachment=function(t,e){De.canvas.HTMLAlarmAttachment.superClass.constructor.call(this,t,e),this._triangleDiv=De.Util.createDiv(),this._roundDiv=De.Util.createDiv(),this._contentDiv=De.Util.createDiv(),De.Util.setCSSStyle(this._triangleDiv,"border-style","solid"),De.Util.setCSSStyle(this._triangleDiv,"pointer-events","none"),De.Util.setCSSStyle(this._contentDiv,"white-space","nowrap"),De.Util.setCSSStyle(this._contentDiv,"pointer-events","none"),this._network.getView().appendChild(this._roundDiv),this._roundDiv.appendChild(this._contentDiv)},Me.ext("twaver.canvas.HTMLAlarmAttachment",De.canvas.AlarmAttachment,{validate:function(){var t=(this.getFont("alarm.font"),this._network.getAlarmLabel(this._element));this._contentDiv.innerHTML=t,this._contentDiv.style.visibility="hidden",De.canvas.HTMLAlarmAttachment.superClass.validate.call(this)},getContentWidth:function(){return this._contentDiv.scrollWidth||parseInt(De.Util.getCSSStyle(this._contentDiv.firstChild,"width"))},getContentHeight:function(){return this._contentDiv.scrollHeight||parseInt(De.Util.getCSSStyle(this._contentDiv.firstChild,"height"))},paint:function(t){var e=this.isFill(),i=this.getOutlineWidth(),n=this._contentRect;if(this.getElementUI().setShadow(this,t),i>0||e){if(Ye.drawRoundRect(t,n.x,n.y,n.width,n.height,this.getCornerRadius()),this._pointers){var o=this._pointers;t.moveTo(o[0].x,o[0].y),t.lineTo(o[1].x,o[1].y),t.lineTo(o[2].x,o[2].y)}if(t.closePath(),i>0&&(t.lineWidth=i,t.strokeStyle=this.getOutlineColor(),t.lineCap=this.getCap(),t.lineJoin=this.getJoin(),t.stroke()),e){var r=this.getFillColor(),a=this.getGradient();a?Ye.fill(t,r,a,this.getGradientColor(),this._viewRect):t.fillStyle=r,t.fill()}}var s=(this.getFont("alarm.font"),this._network.getAlarmLabel(this._element),this._network.getViewRect().x),l=this._network.getViewRect().y,h=this._network.getZoom(),c={x:this._contentRect.x+this._contentRect.width/2,y:this._contentRect.y+this._contentRect.height/2},u=c.x*h-s-this._contentDiv.offsetWidth/2*h+"px",d=c.y*h-l-this._contentDiv.offsetHeight/2*h+"px";this._contentDiv.style.left=u,this._contentDiv.style.top=d,this._contentDiv.style.setProperty("-webkit-transform","scale("+h+")",null),this._contentDiv.style.setProperty("-webkit-transform-origin","0 0",null),this._network._debug&&Ye.strokeRect(t,this._contentRect,"#AAAAAB"),De.canvas.AlarmAttachment.superClass.paint.apply(this,arguments)},setVisibility:function(t){this._contentDiv.style.visibility=t},dispose:function(){this._network.getView().removeChild(this._roundDiv)},getView:function(){return this._roundDiv}}),De.canvas.interaction.BaseInteraction=function(t){this.network=t},Me.ext("twaver.canvas.interaction.BaseInteraction",Object,{setUp:function(){},tearDown:function(){},repaint:function(){this.network.repaintTopCanvas()},convertPointFromView:function(t){return{x:t.x*this.network.getZoom()-this.network.getViewRect().x,y:t.y*this.network.getZoom()-this.network.getViewRect().y}},convertFromUIToMarkerRect:function(t,e,i){var n=this.network.getZoom();return{x:t.x*n-this.network.getViewRect().x+e*n,y:t.y*n-this.network.getViewRect().y+i*n,width:t.width*n,height:t.height*n}},getMarkerPoint:function(t){if(Ue.isTouchable&&t.changedTouches&&t.changedTouches.length>0){var e=t.changedTouches[0];return{x:e.clientX,y:e.clientY}}return Ue.isFirefox?{x:t.layerX,y:t.layerY}:{x:t.offsetX,y:t.offsetY}},paint:function(t){},addListener:function(){for(var t=0;t<arguments.length;t++){var e=arguments[t];Xe.addEventListener(e,"handle_"+e,this.network.getView(),this)}},removeListener:function(){for(var t=0;t<arguments.length;t++)Xe.removeEventListener(arguments[t],this.network.getView(),this)},_handle_mousedown:function(t){0===t.button&&(this._startLogical=this.network.getLogicalPoint(t),this._startClient=Xe.getClientPoint(t),this._startLogical&&Xe.handle_mousedown(this,t))},_handle_mousemove:function(t){this._endLogical={x:this._startLogical.x+(t.clientX-this._startClient.x)/this.network.getZoom(),y:this._startLogical.y+(t.clientY-this._startClient.y)/this.network.getZoom()}},_handle_mouseup:function(t){delete this._startClient,delete this._startLogical,delete this._endLogical}}),De.canvas.interaction.SelectInteraction=function(t){De.canvas.interaction.SelectInteraction.superClass.constructor.call(this,t)},Me.ext("twaver.canvas.interaction.SelectInteraction",De.canvas.interaction.BaseInteraction,{setUp:function(){this.addListener("mousedown","mouseup"),this.network.addMarker(this)},tearDown:function(){this.removeListener("mousedown","mouseup"),this.end(),this.network.removeMarker(this)},paint:function(t){if(null!=this.startPoint&&null!=this.endPoint){var e=this.convertPointFromView(this.startPoint),i=this.convertPointFromView(this.endPoint),n=e.x,o=e.y,r=i.x,a=i.y,s=We.getRect([{x:n,y:o},{x:r,y:a}]);if(null!=s){t.beginPath();var l=this.network.getSelectOutlineWidth(),h=this.getIntersectMode()?this.network.getSelectFillColor():null;t.strokeStyle=this.network.getSelectOutlineColor(),t.lineWidth=l,Nn.rect(t,s.x,s.y,s.width,s.height,h,this.network.getSelectOutlineColor()),t.closePath()}}},handle_mousedown:function(t){if(this.network.isValidEvent(t)&&!this.network.isMovingElement()&&!this.network.isEditingElement()&&!t.shiftKey){var e=this.network.getElementAt(t),i=this.network.getSelectionModel();e?Me.isCtrlDown(t)?i.contains(e)?i.removeSelection(e):i.appendSelection(e):i.contains(e)||i.setSelection(e):(Me.isCtrlDown(t)||i.clearSelection(),this.end(t),this.startPoint=this.network.getLogicalPoint(t),this.startPoint&&this.network.isRectSelectEnabled()&&this.addListener("mousemove"))}},handle_mouseup:function(t){this.end(t)},handle_mousemove:function(t){if(this.network.isMovingElement()||this.network.isEditingElement())return void this.end(t);var e=this.network.getLogicalPoint(t);e&&(this.network.setSelectingElement(!0),this.network.fireInteractionEvent(null==this.endPoint?{kind:"selectStart",event:t}:{kind:"selectBetween",event:t}),this.endPoint=e,this.repaint())},end:function(t){if(this.startPoint){if(this.endPoint&&this.startPoint.x!==this.endPoint.x&&this.startPoint.y!==this.endPoint.y){var e=We.getRect([this.startPoint,this.endPoint]),i=this.network.getElementsAtRect(e,this.getIntersectMode(),this.network.getRectSelectFilter());if(i&&i.size()>0){var n=this.network.getSelectionModel(),o=n.toSelection();i.forEach(function(t){n.contains(t)?o.remove(t):o.add(t)},this),n.setSelection(o)}this.network.fireInteractionEvent({kind:"selectEnd",event:t})}this.network.setSelectingElement(!1),this.removeListener("mousemove"),this.startPoint=null,this.endPoint=null,this.repaint()}},getIntersectMode:function(){return"intersect"===this.network.getSelectMode()||"contain"!==this.network.getSelectMode()&&(this.startPoint.x>this.endPoint.x&&this.startPoint.y>this.endPoint.y)}}),De.canvas.interaction.MoveInteraction=function(t,e){this.lazyMode=e,De.canvas.interaction.MoveInteraction.superClass.constructor.call(this,t)},Me.ext("twaver.canvas.interaction.MoveInteraction",De.canvas.interaction.BaseInteraction,{setUp:function(){this.addListener("mousedown","mouseup","keydown","mouseout"),this.network.addMarker(this)},tearDown:function(){this.removeListener("mousedown","mouseup","keydown","mouseout"),this.end(),this.network.removeMarker(this)},handle_keydown:function(t){this.currentKeyEvent=t,this.addListener("keyup")},handle_keyup:function(t){this.currentKeyEvent=null,this.removeListener("keyup")},isParenting:function(){return this.pressPoint&&null!=this.currentKeyEvent&&80===this.currentKeyEvent.keyCode},parentProcess:function(t,e){var i=null;this.parent=null;var n=this;if(!e&&this.isParenting()){var o={},r=this.network.getLogicalPoint(t);o.x=r.x-1,o.y=r.y-1,o.width=2,o.height=2;var a=this.network.getElementsAtRect(o,!0);if(a&&a.size()>0)for(var s=a.size(),l=0;s>l;l++){var h=a.get(l);if(!n.network.getElementBox().getSelectionModel().contains(h)){n.parent=h;break}}}else this.parent=null;null!=this.parent&&(i=this.network.getElementUI(this.parent).getViewRect()),this.parentRect=null==i||e?null:i},paint:function(t){if(this.lazyMode){if(null==this.pressPoint||null==this.dragPoint)return;t.beginPath();var e=this.dragPoint.x-this.pressPoint.x,i=this.dragPoint.y-this.pressPoint.y,n=this.network.getMovableSelectedElements(),o=n.size(),r=this.network.isLazyMoveFill()?this.network.getLazyMoveFillColor():null,a=this.network.getLazyMoveOutlineWidth(),s=this.network.getLazyMoveOutlineColor();t.strokeStyle=s,t.lineWidth=a,t.fillStyle=r;for(var l=0;o>l;l++){var h=n.get(l),c=this.network.getElementUI(h);if(c){var u=this.convertFromUIToMarkerRect(c.getViewRect(),e,i);Nn.rect(t,u.x,u.y,u.width,u.height)}}t.fill(),t.stroke()}if(this.parentRect){t.beginPath();var r=this.network.isLazyMoveFill()?this.network.getLazyMoveFillColor():null,a=this.network.getLazyMoveOutlineWidth(),s=this.network.getLazyMoveOutlineColor();t.strokeStyle=s,t.lineWidth=a,t.fillStyle=r;var u=this.parentRect;Nn.rect(t,u.x,u.y,u.width,u.height),t.fill(),t.stroke()}},handle_mousedown:function(t){if(0===t.button&&this.network.isValidEvent(t)&&!this.network.isSelectingElement()&&!this.network.isEditingElement()){var e=this.network.getElementAt(t);this.network.isMovable(e)&&(this.end(t),this.lastPoint=this.network.getLogicalPoint(t),this.lazyMode&&(this.pressPoint=this.lastPoint),this.lastPoint&&this.addListener("mousemove"))}},handle_mouseup:function(t){this.end(t)},handle_mouseout:function(t){this.end(t)},handle_mousemove:function(t){if(this.network.isSelectingElement()||this.network.isEditingElement()||!this.network.hasMovableSelectedElements())return void this.end(t);var e=this.network.getLogicalPoint(t);e&&this.lastPoint&&(this.xoffset=e.x-this.lastPoint.x,this.yoffset=e.y-this.lastPoint.y,Math.abs(this.xoffset)<1&&Math.abs(this.yoffset)<1||(this.lazyMode?null==this.dragPoint?(this.network.fireInteractionEvent({kind:"lazyMoveStart",event:t}),this.network.setMovingElement(!0)):this.network.fireInteractionEvent({kind:"lazyMoveBetween",event:t}):(this.lastPoint=e,this.network.isMovingElement()?this.network.fireInteractionEvent({kind:"liveMoveBetween",event:t}):(this.network.setMovingElement(!0),this.network.fireInteractionEvent({kind:"liveMoveStart",event:t})),this.network.moveSelectedElements(this.xoffset,this.yoffset)),this.parentProcess(t,!1),this.lazyMode&&(this.dragPoint=e),(this.lazyMode||this.isParenting())&&this.repaint()))},end:function(t){if(this.lazyMode){if(null!=this.dragPoint&&null!=this.pressPoint){var e=this,i=function(){e.network.fireInteractionEvent({kind:"lazyMoveEnd",event:t}),e.network.setMovingElement(!1)},n=this.dragPoint.x-this.pressPoint.x,o=this.dragPoint.y-this.pressPoint.y;this.network.moveSelectedElements(n,o,this.network.isLazyMoveAnimate(),i)}}else this.network.isMovingElement()&&(this.network.setMovingElement(!1),this.network.fireInteractionEvent({kind:"liveMoveEnd",event:t}));if(this.isParenting()){null==this.parent&&(this.parent=this.network.getCurrentSubNetwork());var e=this;this.network.getMovableSelectedElements().forEach(function(t){t.setParent(e.parent)},this.network)}this.parentProcess(t,!0),this.isParenting()&&this.repaint(),this.network.invalidateCanvasSize(),this.removeListener("mousemove"),this.lastPoint=null,this.dragPoint=null,this.pressPoint=null}}),De.canvas.interaction.ScrollInteraction=function(t){De.canvas.interaction.ScrollInteraction.superClass.constructor.call(this,t),this.hThumbRect=null,this.vThumbRect=null,this.scrollBarVisible=!1},Me.ext("twaver.canvas.interaction.ScrollInteraction",De.canvas.interaction.BaseInteraction,{setUp:function(){this.addListener("mousedown","mouseover","mouseout"),Ue.isFirefox?Xe.addEventListener("DOMMouseScroll","handleMouseWheel",this.network.getView(),this):Xe.addEventListener("mousewheel","handleMouseWheel",this.network.getView(),this),Xe.addEventListener("mouseup","handleMouseUp",t,this),Xe.addEventListener("mousemove","handleMouseMove",t,this),this.network.addPropertyChangeListener(this.handleViewRectChange,this),this.validateScrollBar(),this.network.addMarker(this)},tearDown:function(){this.removeListener("mousedown","mouseover","mouseout"),Ue.isFirefox?Xe.removeEventListener("DOMMouseScroll",this.network.getView(),this):Xe.removeEventListener("mousewheel",this.network.getView(),this),Xe.removeEventListener("mouseup",t,this),Xe.removeEventListener("mousemove",t,this),this.network.removePropertyChangeListener(this.handleViewRectChange,this),this.network.removeMarker(this)},handleViewRectChange:function(t){("viewRect"==t.property||"canvasSizeChange"==t.property)&&this.validateScrollBar()},getScrollBarWidth:function(){return this.network.getScrollBarWidth()},getScrollBarColor:function(){return"#cccccc"},validateScrollBar:function(){if(this.hThumbRect=null,this.vThumbRect=null,0==this.network.isScrollBarVisible())return void this.repaint();var t=this.network.getViewRect().height,e=this.network.getViewRect().width,i=this.network.getViewRect().x,n=this.network.getViewRect().y,o=this.network.getCanvasSize(),r=o.width,a=o.height;if(r>e&&(0>i||i+e>r))return void this.repaint();if(a>t&&(0>n||n+t>a))return void this.repaint();var s=0,l=a>t,h=r>e,c=this.getScrollBarWidth();if(a>t){s=h?t*(t-c)/a:t*t/a;var u=n/(a-t)*(t-s-c);this.vThumbRect={x:e-c,y:u,width:c,height:s}}var d=0;if(r>e){d=l?e*(e-c)/r:e*e/r;var f=i/(r-e)*(e-d-c);this.hThumbRect={x:f,y:t-c,width:d,height:c}}this.network.setHScrollBarVisible(null!=this.hThumbRect),this.network.setVScrollBarVisible(null!=this.vThumbRect),this.repaint()},scrollXOffset:function(t){var e=this.network.getViewRect().height,i=this.network.getViewRect().width,n=this.network.getViewRect().x,o=this.network.getViewRect().y,r=30;t&&(r=-30),this.network.setViewRect(n+r,o,i,e)},scrollYOffset:function(t){var e=this.network.getViewRect().height,i=this.network.getViewRect().width,n=this.network.getViewRect().x,o=this.network.getViewRect().y,r=30;t&&(r=-30),this.network.setViewRect(n,o+r,i,e)},handle_mousedown:function(t){if(1!=this.network.isValidEvent(t)){var e=this.getMarkerPoint(t);this.hBarDownPoint=null,this.vBarDownPoint=null,null!=this.vThumbRect&&We.containsPoint(this.vThumbRect,e.x,e.y)&&(this.vBarDownPoint={x:t.screenX,y:t.screenY},this.vBarDownOffset=this.vBarDownPoint.y-this.vThumbRect.y),null!=this.hThumbRect&&We.containsPoint(this.hThumbRect,e.x,e.y)&&(this.hBarDownPoint={x:t.screenX,y:t.screenY},this.hBarDownOffset=this.hBarDownPoint.x-this.hThumbRect.x)}},handle_mouseover:function(t){1!=this.scrollBarVisible&&(this.scrollBarVisible=!0,this.repaint())},handle_mouseout:function(t){0!=this.scrollBarVisible&&(this.scrollBarVisible=!1,this.repaint())},handleMouseUp:function(t){this.vBarDownPoint=null,this.hBarDownPoint=null,this.repaint()},handleMouseMove:function(t){var e={x:t.screenX,y:t.screenY},i=this.network.getCanvasSize(),n=this.network.getViewRect().height,o=this.network.getViewRect().width,r=this.getScrollBarWidth();if(null!=this.hBarDownPoint){var a=e.x-this.hBarDownPoint.x;return this.hBarDownPoint=e,void this.network.setViewOffSet(a*i.width/(o-r),0)}if(null!=this.vBarDownPoint){var s=e.y-this.vBarDownPoint.y;return this.vBarDownPoint=e,void this.network.setViewOffSet(0,s*i.height/(n-r))}},handleMouseWheel:function(t){var e=!1;t.wheelDelta,t.wheelDeltaX,t.wheelDelta?t.wheelDelta>0&&(e=!0):t.detail<0&&(e=!0),this.scrollYOffset(e)},paintRoundRect:function(t,e,i,n,o,r,a,s){t.beginPath(),t.globalAlpha=i,t.fillStyle=e,Ye.drawRoundRect(t,n,o,r,a,s),t.fill()},paint:function(t){if(0!=this.network.isScrollBarVisible()&&(0!=this.scrollBarVisible||null!=this.hBarDownPoint||null!=this.vBarDownPoint)){var e=this.getScrollBarWidth(),i=this.network.getViewRect().height,n=this.network.getViewRect().width;t.save();var o,r=this.getScrollBarColor();null!=this.hThumbRect&&(o=t.createLinearGradient(this.hThumbRect.x,this.hThumbRect.y,this.hThumbRect.x,this.hThumbRect.y+this.hThumbRect.height),o.addColorStop(0,r),o.addColorStop(1,"#666666"),this.paintRoundRect(t,this.getScrollBarColor(),.5,0,i-e,n-e,e,e/2),this.paintRoundRect(t,o,.9,this.hThumbRect.x,this.hThumbRect.y+1,this.hThumbRect.width,this.hThumbRect.height-2,e/2)),null!=this.vThumbRect&&(o=t.createLinearGradient(this.vThumbRect.x,this.vThumbRect.y,this.vThumbRect.x+this.vThumbRect.width,this.vThumbRect.y),o.addColorStop(0,r),o.addColorStop(1,"#666666"),this.paintRoundRect(t,this.getScrollBarColor(),.5,n-e,0,e,i-e,e/2),this.paintRoundRect(t,o,.9,this.vThumbRect.x+1,this.vThumbRect.y,this.vThumbRect.width-2,this.vThumbRect.height,e/2)),t.restore()}}}),De.canvas.interaction.DefaultInteraction=function(t){De.canvas.interaction.DefaultInteraction.superClass.constructor.call(this,t)},Me.ext("twaver.canvas.interaction.DefaultInteraction",De.canvas.interaction.BaseInteraction,{setUp:function(){this.addListener("mousedown","mousemove","keydown")},tearDown:function(){this.removeListener("mousedown","mousemove","keydown")},handle_mousedown:function(t){if(this.network.isValidEvent(t)){this.network.isFocusOnClick()&&De.Util.setFocus(this.network.getView());var e=this.network.getElementAt(t);2===t.detail?this.handleDoubleClicked(t,e):this.handleClicked(t,e)}},handleClicked:function(t,e){Ai.handleClicked(this.network,t,e)},handleDoubleClicked:function(t,e){Ai.handleDoubleClicked(this.network,t,e)},handle_keydown:function(t){Ai.handleKeyDown(this.network,t)},handle_mousemove:function(t){var e=this.network.getElementAt(t),i=this._preElement,n=Ci(i),o=Ci(e);i!==e&&(i&&(n&&n.onMouseLeave&&n.onMouseLeave(i,this.network),this.network.onMouseLeave(i,t)),e&&(o&&o.onMouseEnter&&o.onMouseEnter(e,this.network),this.network.onMouseEnter(e,t))),e&&o&&o.onMouseMove&&o.onMouseMove(e,this.network),this.network.onMouseMove(e,t),this._preElement=e}}),De.canvas.interaction.PanInteraction=function(t){De.canvas.interaction.PanInteraction.superClass.constructor.call(this,t)},Me.ext("twaver.canvas.interaction.PanInteraction",De.canvas.interaction.BaseInteraction,{setUp:function(){this.addListener("mousedown","mouseup"),this._oldCursor=this.network.getView().style.cursor},tearDown:function(){this.removeListener("mousedown","mouseup")},handle_mousedown:function(t){this.network.isValidEvent(t)&&(this.lastPoint=this.getMarkerPoint(t),this.lastPoint&&(this.addListener("mousemove"),this.network.getView().style.cursor="pointer"))},handle_mouseup:function(t){this._clear()},handle_mousemove:function(t){if(this.lastPoint){var e=this.getMarkerPoint(t);if(e){var i=e.x-this.lastPoint.x,n=e.y-this.lastPoint.y;this.network.panByOffset(-i,-n),this.lastPoint=e}}},_clear:function(t){this.lastPoint&&(this.lastPoint=null,this.network.getView().style.cursor=this._oldCursor,this.removeListener("mousemove"))}}),De.canvas.interaction.CreateElementInteraction=function(t,e){e||(e=De.Node),this.elementFunction=De.Util.isTypeOf(e,De.Node)?function(t){var i=new e;return i instanceof De.Node&&i.setCenterLocation(t),i}:e,De.canvas.interaction.CreateElementInteraction.superClass.constructor.call(this,t)},Me.ext("twaver.canvas.interaction.CreateElementInteraction",De.canvas.interaction.BaseInteraction,{setUp:function(){this.addListener("mousedown")},tearDown:function(){this.removeListener("mousedown")},handle_mousedown:function(t){var e=this.network.getLogicalPoint(t);if(e){var i=this.elementFunction(e);i&&this.network.addElementByInteraction(i)}}}),De.canvas.interaction.EditInteraction=function(t,e){this.lazyMode=e,this.pointIndex=-1,De.canvas.interaction.EditInteraction.superClass.constructor.call(this,t)},Me.ext("twaver.canvas.interaction.EditInteraction",De.canvas.interaction.BaseInteraction,{setUp:function(){this.addListener("mousedown","mouseup","mousemove"),this.oldCursor=this.network.getView().style.cursor,this.network.setHasEditInteraction(!0),this.network.addMarker(this)},tearDown:function(){this.removeListener("mousedown","mouseup","mousemove"),this.network.getView().style.cursor=this.oldCursor,this.network.setHasEditInteraction(!1),this.clear(),this.network.removeMarker(this)},paint:function(t){if(1==this.lazyMode&&null!=this.resizingRect){t.lineWidth=this.network.getResizeLineWidth();var e=this.convertFromUIToMarkerRect(this.resizingRect,0,0);t.save(),De.Util.rotateCanvas(t,e,this.node.getAngle()),t.beginPath(),Nn.rect(t,e.x,e.y,e.width,e.height,null,this.network.getResizeLineColor()),t.restore()}this.isStartRotate&&this.showRotateScale(t)},clear:function(){this.network.setEditingElement(!1),this.network.setRotatingElement(!1),this.isStart=!1,this.isStartRotate=!1,this.node=null,this.shapeNode=null,this.shapeLink=null,this.linkUI=null,this.resizingRect=null,this.resizeDirection=null,this.pointIndex=-1,this._removeCursor(),this.oldCursor=null,this.network.repaintTopCanvas()},_removeCursor:function(){this.cursorID&&(this.network.getView().style.cursor=this.oldCursor||"default",this.cursorID=null),this.resizeDirection=null,this.isCrossCursor=!1},_setCrossCursor:function(){this.isCrossCursor||(this._removeCursor(),this._setCursor("crosshair"),this.isCrossCursor=!0)},_setCursor:function(t){this.cursorID=t,this.network.getView().style.cursor!==this.cursorID&&(this.network.getView().style.cursor=this.cursorID)},handle_mousedown:function(t){if(0===t.button)if(!Me.isAltDown(t)||this.network.isEditingElement())!this.network.isEditingElement()||this.isStart||this.isStartRotate||(this.node&&this.resizeDirection?(this.isStart=!0,this._handle_mousedown(t),this.network.fireInteractionEvent({kind:this.lazyMode?"lazyResizeStart":"liveResizeStart",event:t,element:this.node,resizeDirection:this.resizeDirection})):this.shapeNode&&this.pointIndex>=0?Me.isAltDown(t)?(this.shapeNode.removeAt(this.pointIndex),this.network.fireInteractionEvent({kind:"removePoint",event:t,element:this.shapeNode})):(this.isStart=!0,this._handle_mousedown(t),this.network.fireInteractionEvent({kind:"liveMovePointStart",event:t,element:this.shapeNode,pointIndex:this.pointIndex})):this.shapeLink&&this.pointIndex>=0?Me.isAltDown(t)?(this.shapeLink.removeAt(this.pointIndex),this.network.fireInteractionEvent({kind:"removePoint",event:t,element:this.shapeLink})):(this.isStart=!0,this._handle_mousedown(t),this.network.fireInteractionEvent({kind:"liveMovePointStart",event:t,element:this.shapeLink,pointIndex:this.pointIndex})):this.linkUI?(this.isStart=!0,this.network.fireInteractionEvent({kind:"liveMovePointStart",event:t,element:this.linkUI._element})):this.node&&(this.isStartRotate=!0,this._handle_mousedown(t)));else{var e=this.network.getElementAt(t),i=this.network.getLogicalPoint(t);if(e instanceof De.ShapeNode){var n=this.getPointIndex(e.getPoints(),i,!0);n>0&&(this._handle_mousedown(t),this.pointIndex=n,this.shapeNode=e,e.addPoint(i,n),this._setCrossCursor(),this.network.setEditingElement(!0),this.isStart=!0,this.network.fireInteractionEvent({kind:"addPoint",event:t,element:e,pointIndex:n}),this.network.fireInteractionEvent({kind:"liveMovePointStart",event:t,element:e,pointIndex:n}))}if(e instanceof De.ShapeLink){var o=new De.List(e.getPoints()),r=this.network.getElementUI(e);o.add(r.getFromPoint(),0),o.add(r.getToPoint());var n=this.getPointIndex(o,i)-1;n>0&&(this._handle_mousedown(t),this.pointIndex=n,this.shapeLink=e,e.addPoint(i,n),this._setCrossCursor(),this.network.setEditingElement(!0),this.isStart=!0,this.network.fireInteractionEvent({kind:"addPoint",event:t,element:e,pointIndex:n}),this.network.fireInteractionEvent({kind:"liveMovePointStart",event:t,element:e,pointIndex:n}))}}},handle_mouseup:function(t){if(this.isStart){var e=this.network.getLogicalPoint(t);if(this.resizingRect)if(this.lazyMode)if(this.network.isResizeAnimate()){var i=this,n=new De.animate.AnimateBounds(this.node,this.resizingRect,function(){i.network.fireInteractionEvent({kind:"lazyResizeEnd",event:t,element:i.node,resizeDirection:i.resizeDirection}),i.clear()});De.animate.AnimateManager.start(n)}else this.node.setLocation(this.resizingRect.x,this.resizingRect.y),this.node.setSize(this.resizingRect.width,this.resizingRect.height),this.network.fireInteractionEvent({kind:"lazyResizeEnd",event:t,element:this.node,resizeDirection:this.resizeDirection});else this.node.setLocation(this.resizingRect.x,this.resizingRect.y),this.node.setSize(this.resizingRect.width,this.resizingRect.height),this.network.fireInteractionEvent({kind:"liveResizeEnd",event:t,element:this.node,resizeDirection:this.resizeDirection});else this.shapeNode&&this.pointIndex>=0&&e?(this.shapeNode.setPoint(this.pointIndex,e),this.network.fireInteractionEvent({kind:"liveMovePointEnd",event:t,element:this.shapeNode,pointIndex:this.pointIndex})):this.shapeLink&&this.pointIndex>=0&&e?(this.shapeLink.setPoint(this.pointIndex,e),this.network.fireInteractionEvent({kind:"liveMovePointEnd",event:t,element:this.shapeLink,pointIndex:this.pointIndex})):this.linkUI&&e&&(this.linkUI.setControlPoint(e),this.network.fireInteractionEvent({kind:"liveMovePointEnd",event:t,element:this.linkUI._element}))}this._handle_mouseup(t),this.lazyMode||this.clear()},handle_mousemove:function(t){if(this.network.isValidEvent(t)){if(this.isStartRotate&&this.node)return this._handleRotateElement(t,this.node),void(this.network.isShowRotateScale()&&this.repaint());if(this.isStart){if(this.shapeNode&&this.pointIndex>=0)return void this._handleMovingShapeNodePoint(t);if(this.shapeLink&&this.pointIndex>=0)return void this._handleMovingShapeLinkPoint(t);if(this.node&&this.resizeDirection)return void this._handleResizing(t);if(this.linkUI)return void this._handleMovingLinkControlPoint(t)}if(this.network.isSelectingElement()||this.network.isMovingElement()||0===this.network.getSelectionModel().size())return void this.clear();var e=this.network.getElementAt(t),i=this.network.getElementUI(e);if(!i||!i.getEditAttachment())return void this.clear();var n=this.network.getLogicalPoint(t);if(e instanceof De.Node){if(this.node=e,this._isEditingShapeNode(n)||this._isResizingNode(n))return void this.network.setEditingElement(!0);if(this._isRotatingElement(n))return this.network.setRotatingElement(!0),void this.network.setEditingElement(!0)}else if(e instanceof De.ShapeLink){if(this.shapeLink=e,this._isEditingShapeLink(n))return void this.network.setEditingElement(!0)}else if(i instanceof De.canvas.LinkUI){var o=this.network.getEditPointSize();if(vi.isOrthogonalLink(i._element)){this.linkUI=i;var r=this.linkUI.getControlPoint();return void(r&&this._contains(n,r,o)&&(this._setCrossCursor(),this.network.setEditingElement(!0)))}}this.clear()}},_isRotatingElement:function(t){if(0>=this.network.getRotatePointSize())return!1;var e=this.node.getOriginalRect(),i=this.node.getAngle();return this._isRotating(t,"crosshair",e,i)},_isRotating:function(t,e,i,n){var o=this.network.getRotatePointSize(),r={x:i.x+i.width/2,y:i.y-this.network.getRotatePointOffset()-o},a=this._rotatePoint(r,n,i),s={x:a.x-o,y:a.y-o,width:2*o,height:2*o};return!!We.containsPoint(s,t)&&(this._removeCursor(),this._setCursor(e),!0)},_handleRotateElement:function(t,e){this._handle_mousemove(t);var i=this._calculateAngle(this.network.getLogicalPoint(t),e);e.setAngle(i)},_calculateAngle:function(t,e){var i=e.getCenterLocation();return Math.round(180*Math.atan2(i.x-t.x,t.y-i.y)/Math.PI+180)},_handleMovingShapeNodePoint:function(t){var e=this.network.getLogicalPoint(t);this.shapeNode.setPoint(this.pointIndex,e),this.network.fireInteractionEvent({kind:"liveMovePointBetween",e:t,element:this.shapeNode,pointIndex:this.pointIndex})},_handleMovingShapeLinkPoint:function(t){var e=this.network.getLogicalPoint(t);this.shapeLink.setPoint(this.pointIndex,e),this.network.fireInteractionEvent({kind:"liveMovePointBetween",e:t,element:this.shapeLink,pointIndex:this.pointIndex})},_handleMovingLinkControlPoint:function(t){this.linkUI.setControlPoint(this.network.getLogicalPoint(t)),this.network.fireInteractionEvent({kind:"liveMovePointBetween",e:t,element:this.linkUI._element})},_handleResizing:function(t){this._handle_mousemove(t);var e=this.node.getAngle(),i=this.node.getLocation(),n=this.node.getWidth()/2,o=this.node.getHeight()/2,r={x:i.x+n,y:i.y+o},a={x:-n,y:-o},s={x:-n,y:o},l={x:n,y:o},h={x:n,y:-o},c={x:0,y:-o},u={x:n,y:0},d={x:0,y:o},f={x:-n,y:0};if("northwest"===this.resizeDirection&&(this._transformPoint(l,r,e),a.x=this._endLogical.x,a.y=this._endLogical.y,r.x=(a.x+l.x)/2,r.y=(a.y+l.y)/2,this._reversPoint(a,r,e),this._reversPoint(l,r,e),this.resizingRect={x:a.x,y:a.y,width:l.x-a.x,height:l.y-a.y}),"north"===this.resizeDirection){var p={x:this._endLogical.x,y:this._endLogical.y};this._reversPoint(p,r,e),c.y=p.y-r.y,this._transformPoint(c,r,e),this._transformPoint(d,r,e),r.x=(c.x+d.x)/2,r.y=(c.y+d.y)/2,this._reversPoint(c,r,e),this._reversPoint(d,r,e),this.resizingRect={x:r.x-this.node.getWidth()/2,y:r.y-(d.y-c.y)/2,width:this.node.getWidth(),height:d.y-c.y}}if("northeast"===this.resizeDirection&&(this._transformPoint(s,r,e),h.x=this._endLogical.x,h.y=this._endLogical.y,r.x=(s.x+h.x)/2,r.y=(s.y+h.y)/2,this._reversPoint(s,r,e),this._reversPoint(h,r,e),this.resizingRect={x:s.x,y:h.y,width:h.x-s.x,height:s.y-h.y}),"west"===this.resizeDirection){var p={x:this._endLogical.x,y:this._endLogical.y};this._reversPoint(p,r,e),f.x=p.x-r.x,this._transformPoint(u,r,e),this._transformPoint(f,r,e),r.x=(u.x+f.x)/2,r.y=(u.y+f.y)/2,this._reversPoint(u,r,e),this._reversPoint(f,r,e),this.resizingRect={x:r.x-(u.x-f.x)/2,y:r.y-this.node.getHeight()/2,width:u.x-f.x,height:this.node.getHeight()}}if("east"===this.resizeDirection){var p={x:this._endLogical.x,y:this._endLogical.y};this._reversPoint(p,r,e),u.x=p.x-r.x,this._transformPoint(u,r,e),this._transformPoint(f,r,e),r.x=(u.x+f.x)/2,r.y=(u.y+f.y)/2,this._reversPoint(u,r,e),this._reversPoint(f,r,e),this.resizingRect={x:r.x-(u.x-f.x)/2,y:r.y-this.node.getHeight()/2,width:u.x-f.x,height:this.node.getHeight()}}if("southwest"===this.resizeDirection&&(this._transformPoint(h,r,e),s.x=this._endLogical.x,s.y=this._endLogical.y,r.x=(s.x+h.x)/2,r.y=(s.y+h.y)/2,this._reversPoint(s,r,e),this._reversPoint(h,r,e),this.resizingRect={x:s.x,y:h.y,width:h.x-s.x,height:s.y-h.y}),"south"===this.resizeDirection){var p={x:this._endLogical.x,y:this._endLogical.y};this._reversPoint(p,r,e),d.y=p.y-r.y,this._transformPoint(c,r,e),this._transformPoint(d,r,e),r.x=(c.x+d.x)/2,r.y=(c.y+d.y)/2,this._reversPoint(c,r,e),this._reversPoint(d,r,e),this.resizingRect={x:r.x-this.node.getWidth()/2,y:r.y-(d.y-c.y)/2,width:this.node.getWidth(),height:d.y-c.y}}"southeast"===this.resizeDirection&&(this._transformPoint(a,r,e),l.x=this._endLogical.x,l.y=this._endLogical.y,r.x=(a.x+l.x)/2,r.y=(a.y+l.y)/2,this._reversPoint(a,r,e),this._reversPoint(l,r,e),this.resizingRect={x:a.x,y:a.y,width:l.x-a.x,height:l.y-a.y}),this.lazyMode?(this.repaint(),this.network.fireInteractionEvent({kind:"lazyResizeBetween",event:t,element:this.node,resizeDirection:this.resizeDirection})):(this.node.setLocation(this.resizingRect.x,this.resizingRect.y),this.node.setSize(this.resizingRect.width,this.resizingRect.height),this.network.fireInteractionEvent({kind:"liveResizeBetween",event:t,element:this.node,resizeDirection:this.resizeDirection}))},_isEditingShapeNode:function(t){var e=this.network.getEditPointSize();if(this.node instanceof De.ShapeNode){this.shapeNode=this.node;for(var i=this.shapeNode.getPoints(),n=0,o=i.size();o>n;n++){var r=i.get(n);if(this._contains(t,r,e))return this._setCrossCursor(),this.pointIndex=n,!0}}return this.pointIndex=-1,!1},_isEditingShapeLink:function(t){for(var e=this.network.getEditPointSize(),i=this.shapeLink.getPoints(),n=0,o=i.size();o>n;n++){var r=i.get(n);if(this._contains(t,r,e))return this._setCrossCursor(),this.pointIndex=n,!0}return this.pointIndex=-1,!1},_isResizingNode:function(t){if(0>=this.network.getResizePointSize())return!1;var e=this.node.getOriginalRect(),i=this.node.getAngle(),n={x:e.x,y:e.y},o=this._rotatePoint(n,i,e);return!!this._isResizing(t,o.x,o.y,"northwest","nwse-resize")||(n={x:e.x+e.width/2,y:e.y},o=this._rotatePoint(n,i,e),!!this._isResizing(t,o.x,o.y,"north","ns-resize")||(n={x:e.x+e.width,y:e.y},o=this._rotatePoint(n,i,e),!!this._isResizing(t,o.x,o.y,"northeast","nesw-resize")||(n={x:e.x,y:e.y+e.height/2},o=this._rotatePoint(n,i,e),!!this._isResizing(t,o.x,o.y,"west","ew-resize")||(n={x:e.x+e.width,y:e.y+e.height/2},o=this._rotatePoint(n,i,e),!!this._isResizing(t,o.x,o.y,"east","ew-resize")||(n={x:e.x,y:e.y+e.height},o=this._rotatePoint(n,i,e),!!this._isResizing(t,o.x,o.y,"southwest","nesw-resize")||(n={x:e.x+e.width/2,y:e.y+e.height},o=this._rotatePoint(n,i,e),!!this._isResizing(t,o.x,o.y,"south","ns-resize")||(n={x:e.x+e.width,y:e.y+e.height},o=this._rotatePoint(n,i,e),!!this._isResizing(t,o.x,o.y,"southeast","nwse-resize"))))))))},_rotatePoint:function(t,e,i){return We.createMatrix(e*Math.PI/180,i.x+i.width/2,i.y+i.height/2).transform(t)},_isResizing:function(t,e,i,n,o){var r=this.network.getResizePointSize();return!!this._contains(t,{x:e,y:i},r)&&(this.resizeDirection!==n&&(this._removeCursor(),o=this._changeCursorWithAngle(n,this.node.getAngle()),this._setCursor(o),this.resizeDirection=n),!0)},_getRect:function(t,e,i,n){return{x:i>t?t:i,y:n>e?e:n,width:Math.abs(t-i),height:Math.abs(e-n)}},_contains:function(t,e,i){var n={x:e.x-i,y:e.y-i,width:2*i,height:2*i};return We.containsPoint(n,t)},getPointIndex:function(t,e,i){if(t.size()<2)return 0;for(var n,o=t.get(0),r=1;r<t.size();r++){if(n=t.get(r),this.isPointOnLine(e,o,n,6))return r;o=n}return o=t.get(0),i&&this.isPointOnLine(e,o,n,6)?t.size():0},showRotateScale:function(t){var e,i,n,o,r,a=(new De.List,this.network.getRotateScaleWidth()),s=this.network.getRotateScaleHeight(),l=this.network.getRotatePointSize(),h=this.node.getAngle(),c=this.node.getOriginalRect(),u={x:c.x+c.width/2,y:c.y-this.network.getRotatePointOffset()-l},d=this._rotatePoint(u,h,c),f=h+"°";this.node.getAngle()>=0&&this.node.getAngle()<=180?(i={x:d.x+l,y:d.y},n={x:i.x+a,y:i.y},o={x:n.x,y:n.y-s},r={x:i.x,y:o.y}):this.node.getAngle()>180&&this.node.getAngle()<=360&&(i={x:d.x-l,y:d.y},n={x:i.x-a,y:i.y},o={x:n.x,y:n.y-s},r={x:i.x,y:o.y});var p=new De.List([i,n,o,r]),e=Me.math.getRect(p);t.fillStyle=this.network.getRotateScaleFillColor(),t.fillRect(e.x,e.y,e.width,e.height),t.fillStyle=this.network.getRotateScaleFontColor(),t.textBaseline="middle",t.textAlign="center",t.font="13px Arial",t.fillText(f,e.x+e.width/2,e.y+e.height/2)},isPointOnLine:function(t,e,i,n){return 0>n&&(n=0),n>=this.getDistanceFromPointToLine(t,e,i)&&t.x>=Math.min(e.x,i.x)-n&&t.x<=Math.max(e.x,i.x)+n&&t.y>=Math.min(e.y,i.y)-n&&t.y<=Math.max(e.y,i.y)+n},getDistanceFromPointToLine:function(t,e,i){if(e.x===i.x)return Math.abs(t.x-e.x);var n=(i.y-e.y)/(i.x-e.x),o=(i.x*e.y-e.x*i.y)/(i.x-e.x);return Math.abs(n*t.x-t.y+o)/Math.sqrt(n*n+1)},_transformPoint:function(t,e,i){var n=Math.cos(i*Math.PI/180),o=Math.sin(i*Math.PI/180),r=t.x,a=t.y,s=r*n-a*o,l=r*o+a*n;t.x=s+e.x,t.y=l+e.y},_reversPoint:function(t,e,i){i*=-1;var n=Math.cos(i*Math.PI/180),o=Math.sin(i*Math.PI/180),r=t.x-e.x,a=t.y-e.y,s=r*n-a*o,l=r*o+a*n;t.x=s+e.x,t.y=l+e.y},_changeCursorWithAngle:function(t,e){var i,n=["auto","nwse-resize","ns-resize","nesw-resize","ew-resize","nwse-resize","ns-resize","nesw-resize","ew-resize"];switch(t){case"northwest":i=1;break;case"north":i=2;break;case"northeast":i=3;break;case"east":i=4;break;case"southeast":i=5;break;case"south":i=6;break;case"southwest":i=7;break;case"west":i=8;break;default:i=0}return(e>=360||-360>=e)&&(e%=360),e>22.5&&67.5>=e&&(i+=1),-22.5>e&&e>=-67.5&&(i-=1),e>67.5&&112.5>=e&&(i+=2),-67.5>e&&e>=-112.5&&(i-=2),e>112.5&&157.5>=e&&(i+=3),-112.5>e&&e>=-157.5&&(i-=3),e>157.5&&202.5>=e&&(i+=4),-157.5>e&&e>=-202.5&&(i-=4),e>202.5&&247.5>=e&&(i+=5),-202.5>e&&e>=-247.5&&(i-=5),e>247.5&&292.5>=e&&(i+=6),-247.5>e&&e>=-292.5&&(i-=6),e>292.5&&337.5>=e&&(i+=7),-292.5>e&&e>=-337.5&&(i-=7),i>8&&(i-=8),0>=i&&(i+=8),n[i]}}),De.canvas.interaction.CreateLinkInteraction=function(t,e){e||(e=De.Link),this.linkFunction=De.Util.isTypeOf(e,De.Link)?function(t,i){var n=new e;return n instanceof De.Link&&(n.setFromNode(t),n.setToNode(i)),n}:e,De.canvas.interaction.CreateLinkInteraction.superClass.constructor.call(this,t)},Me.ext("twaver.canvas.interaction.CreateLinkInteraction",De.canvas.interaction.BaseInteraction,{setUp:function(){this.addListener("mousedown","mousemove"),this.network.addMarker(this)},tearDown:function(){this.removeListener("mousedown","mousemove"),this.clear(),this.network.removeMarker(this)},paint:function(t){t.beginPath();var e,i;t.lineWidth=this.network.getEditLineWidth();var n=this.network.getEditLineColor();this.currentNode&&this.currentNode!==this.fromNode&&(e=this.network.getElementUI(this.currentNode).getViewRect(),i=this.convertFromUIToMarkerRect(e,0,0),Nn.rect(t,i.x,i.y,i.width,i.height,null,n)),this.fromNode&&(e=this.network.getElementUI(this.fromNode).getViewRect(),i=this.convertFromUIToMarkerRect(e,0,0),Nn.rect(t,i.x,i.y,i.width,i.height,null,n)),this.currentPoint&&this.paintLine(t),t.closePath()},paintLine:function(t){var e=this.network.getEditLineColor(),i=this.convertPointFromView(this.fromNode.getCenterLocation()),n=i.x,o=i.y,r=this.currentPoint.x,a=this.currentPoint.y;t.strokeStyle=e,t.beginPath(),t.moveTo(n,o),t.lineTo(r,a),t.stroke()},clear:function(){this.currentPoint=null,this.currentNode=null,this.fromNode=null,this.toNode=null},createLink:function(){return this.linkFunction(this.fromNode,this.toNode)},handle_mousedown:function(t){if(this.network.isValidEvent(t))if(this.fromNode){if(this.toNode=this.currentNode,this.toNode){var e=this.createLink();e&&this.network.addElementByInteraction(e)}this.clear()}else this.fromNode=this.currentNode,this.currentNode=null,this.currentPoint=null,this.repaint()},handle_mousemove:function(t){var e=this.getMarkerPoint(t);if(e){if(this.network.isMovingElement()||this.network.isEditingElement())return void this.clear();var i=null;this.fromNode?(this.currentNode=this.getToNode(t),this.currentPoint=e,this.repaint()):(i=this.getFromNode(t),this.currentNode!==i&&(this.currentNode=i,this.repaint()))}},getFromNode:function(t){return this.getNode(t)},getToNode:function(t){return this.getNode(t)},getNode:function(t){var e=this.network.getElementAt(t);return e instanceof On&&this.network.isLinkable(e)&&this.network.getElementBox().getSelectionModel().isSelectable(e)?e:null}}),De.canvas.interaction.CreateShapeLinkInteraction=function(t,e){De.canvas.interaction.CreateShapeLinkInteraction.superClass.constructor.call(this,t),e||(e=De.ShapeLink),this.linkFunction=De.Util.isTypeOf(e,De.ShapeLink)?function(t,i,n){var o=new e;return o instanceof De.ShapeLink&&(o.setFromNode(t),o.setToNode(i),n&&o.setPoints(n)),o}:e},Me.ext("twaver.canvas.interaction.CreateShapeLinkInteraction",De.canvas.interaction.CreateLinkInteraction,{clear:function(){this.points=null,De.canvas.interaction.CreateShapeLinkInteraction.superClass.clear.call(this)},createLink:function(){return this.linkFunction(this.fromNode,this.toNode,this.points)},handle_mousedown:function(t){if(0===t.button){var e=this.network.getLogicalPoint(t);if(e){if(this.fromNode)if(this.toNode=this.currentNode,this.toNode){var i=this.createLink();i&&this.network.addElementByInteraction(i),this.clear()}else{if(this.points||(this.points=new De.List),this.points.size()>0){var n=this.points.get(this.points.size()-1);if(n.x===e.x&&n.y===e.y)return}this.points.add(e)}else this.fromNode=this.currentNode,this.points=null,this.currentNode=null,this.currentPoint=null;this.repaint()}}},paintLine:function(t){if(this.currentPoint){var e,i=new De.List;if(e=this.convertPointFromView(this.fromNode.getCenterLocation()),i.add(e,0),this.points&&this.points.size()>0)for(var n=this.points.size(),o=0;n>o;o++)e=this.convertPointFromView(this.points.get(o)),i.add(e);e=this.currentPoint,i.add(e),t.lineWidth=this.network.getEditLineWidth(),t.strokeStyle=this.network.getEditLineColor(),t.beginPath(),Ye.drawLinePoints(t,i),t.stroke()}}}),De.canvas.interaction.CreateShapeNodeInteraction=function(t,e){e||(e=De.ShapeNode),this.shapeNodeFunction=De.Util.isTypeOf(e,De.ShapeNode)?function(t){var i=new e;return i instanceof De.ShapeNode&&t&&i.setPoints(t),i}:e,De.canvas.interaction.CreateShapeNodeInteraction.superClass.constructor.call(this,t),this.timeStamp=-1},Me.ext("twaver.canvas.interaction.CreateShapeNodeInteraction",De.canvas.interaction.BaseInteraction,{setUp:function(){this.addListener("mousedown","mousemove"),this.network.addMarker(this)},tearDown:function(){this.removeListener("mousedown","mousemove"),this.clear(),this.network.removeMarker(this),this.network.setEditingElement(!1)},clear:function(){this.points=null,this.currentPoint=null},paint:function(t){if(this.points&&this.points.size()>0&&this.currentPoint){for(var e,i=new De.List,n=this.points.size(),o=0;n>o;o++)e=this.convertPointFromView(this.points.get(o)),i.add(e);e=this.convertPointFromView(this.currentPoint),i.add(e),t.lineWidth=this.network.getEditLineWidth(),t.strokeStyle=this.network.getEditLineColor(),t.beginPath(),Ye.drawLinePoints(t,i),t.stroke()}},handle_mousedown:function(t){if(0===t.button){var e=this.network.getLogicalPoint(t);if(e){if(2===t.detail||t.timeStamp-this.timeStamp<300){if(this.points){var i=this.shapeNodeFunction(this.points);this.network.addElementByInteraction(i),this.clear();var n=this;setTimeout(function(){n.network.setEditingElement(!1)},0)}}else{if(this.network.isEditingElement()||this.network.setEditingElement(!0),this.points||(this.points=new De.List),this.points.size()>0){var o=this.points.get(this.points.size()-1);if(o.x===e.x&&o.y===e.y)return}this.points.add(e)}this.timeStamp=t.timeStamp,this.repaint()}}},handle_mousemove:function(t){this.points&&(this.currentPoint=this.network.getLogicalPoint(t),this.repaint())}}),De.canvas.interaction.MagnifyInteraction=function(t,e,i,n,o){De.canvas.interaction.MagnifyInteraction.superClass.constructor.call(this,t),this.zoom=e||2,this.xRadius=i||100,this.yRadius=n||100,this.shape=o||"circle",this.borderColor="black",this.borderWidth=1,this.backgroundColor="white",this.markCanvas=Xe.createCanvas()},Me.ext("twaver.canvas.interaction.MagnifyInteraction",De.canvas.interaction.BaseInteraction,{setUp:function(){this.addListener("mousemove"),this.network.addMarker(this)},tearDown:function(){this.removeListener("mousemove"),this.network.removeMarker(this)},paint:function(t){if(this.point){var e=this.network._zoom,i=this.zoom*e,n=this.point.x*e-this.network.viewRect.x-this.xRadius,o=this.point.y*e-this.network.viewRect.y-this.yRadius,r=2*this.xRadius,a=2*this.yRadius,s={x:this.point.x-this.xRadius/i,y:this.point.y-this.yRadius/i,width:r/i,height:a/i},l=this.borderWidth,h=Xe.createCanvas();h.width=r,h.height=a,this.network.toCanvasByRegion(s,i,h),t.save(),t.beginPath(),Ye.drawVector(t,this.shape,null,n,o,r,a),t.clip(),t.fillStyle=this.backgroundColor,t.beginPath(),t.rect(n,o,r,a),t.fill(),t.drawImage(h,n,o),t.restore(),t.beginPath(),t.lineWidth=l,Ye.drawVector(t,this.shape,null,n+l/2,o+l/2,r-l,a-l),t.strokeStyle=this.borderColor,t.stroke()}},handle_mousemove:function(t){this.point=this.network.getLogicalPoint(t),this.point&&this.repaint()},getZoom:function(){return this.zoom},setZoom:function(t){this.zoom=t,this.network.repaintTopCanvas()},getShape:function(){return this.shape},setShape:function(t){this.shape=t,this.network.repaintTopCanvas()},getXRadius:function(){return this.xRadius},setXRadius:function(t){this.xRadius=t,this.network.repaintTopCanvas()},getYRadius:function(){return this.yRadius},setYRadius:function(t){this.yRadius=t,this.network.repaintTopCanvas()},getBorderColor:function(){return this.borderColor},setBorderColor:function(t){this.borderColor=t,this.network.repaintTopCanvas()},getBorderWidth:function(){return this.borderWidth},setBorderWidth:function(t){this.borderWidth=t,this.network.repaintTopCanvas()},getBackgroundColor:function(){return this.backgroundColor},setBackgroundColor:function(t){this.backgroundColor=t,this.network.repaintTopCanvas()}}),De.canvas.interaction.TouchInteraction=function(t){De.canvas.interaction.TouchInteraction.superClass.constructor.call(this,t)},Me.ext("twaver.canvas.interaction.TouchInteraction",De.canvas.interaction.BaseInteraction,{setUp:function(){var t=this.network.getView();Xe.addEventListener("touchstart","handleTouchstart",t,this),Xe.addEventListener("touchmove","handleTouchmove",t,this),Xe.addEventListener("touchend","handleTouchend",t,this),Xe.addEventListener("touchcancel","handleTouchend",t,this),this.network.addMarker(this)},tearDown:function(){var t=this.network.getView();Xe.removeEventListener("touchstart",this.network.getView(),this),Xe.removeEventListener("touchmove",t,this),Xe.removeEventListener("touchend",t,this),Xe.removeEventListener("touchcancel",t,this),this.network.removeMarker(this)},handleTouchstart:function(t){if(Xe.preventDefault(t),t.touches&&1==t.touches.length){var e=this.network.getLogicalPoint(t),i=this.network.getElementAt(e);this._startTouchTime=new Date,this._startTouchPoint=e,this._startTouchClient=this.getMarkerPoint(t),i?(this._haveElementUnderTouch=!0,this._startTouchElement=i):(this._haveElementUnderTouch=!1,this._startTouchElement=null),this.timer=setTimeout(function(){Ai.handleLongClicked(self.network,t,i)},1e3)}else t.touches&&2==t.touches.length&&(this._distance=wi.getDistance(t),this._zoom=this.network.getZoom());this._touchCount=t.touches.length},handleTouchmove:function(t){if(Xe.preventDefault(t),2==this._touchCount&&t.touches&&2==t.touches.length)if(this.timer&&clearTimeout(this.timer),Math.abs(this._distance-wi.getDistance(t))>=kn.TOUCH_ZOOM_THRESHOLD||this._zoomFlag){this._zoomFlag=!0;var e=wi.getDistance(t)/this._distance;this.network.setTouchZoom(this._zoom*e,!1)}else{var i=this.getMarkerPoint(t),n=this._startTouchClient.x-i.x,o=this._startTouchClient.y-i.y;this.network.panByOffset(n,o),this._startTouchClient=i}else if(1==this._touchCount&&t.touches&&1==t.touches.length)if(this._haveElementUnderTouch||!this.network.isRectSelectEnabled()){var r=this.network.getLogicalPoint(t),a=this.network.getElementAt(r);if(this.network.isMovingElement()||null!=this._startTouchElement&&this._startTouchElement==a&&this.network.getMovableSelectedElements().contains(a)){var n=r.x-this._startTouchPoint.x,o=r.y-this._startTouchPoint.y;(Math.abs(n)>=kn.TOUCH_MOVE_THRESHOLD||Math.abs(o)>=kn.TOUCH_MOVE_THRESHOLD)&&(this._startTouchPoint=r,this.network.moveSelectedElements(n,o),this.network.isMovingElement()?this.network.fireInteractionEvent({kind:"liveMoveBetween",event:t}):(this.network.setMovingElement(!0),this.network.fireInteractionEvent({kind:"liveMoveStart",event:t}),this.timer&&clearTimeout(this.timer)))}else{var n=r.x-this._startTouchPoint.x,o=r.y-this._startTouchPoint.y;(Math.abs(n)>=kn.TOUCH_MOVE_THRESHOLD||Math.abs(o)>=kn.TOUCH_MOVE_THRESHOLD)&&this.timer&&clearTimeout(this.timer);var i=this.getMarkerPoint(t),n=this._startTouchClient.x-i.x,o=this._startTouchClient.y-i.y;this.network.panByOffset(n,o),this._startTouchClient=i}}else{var s=this.network.getLogicalPoint(t);if(!s)return;var n=s.x-this._startTouchPoint.x,o=s.y-this._startTouchPoint.y;Math.abs(n)>=kn.TOUCH_RECT_SELECT_THRESHOLD&&Math.abs(o)>=kn.TOUCH_RECT_SELECT_THRESHOLD&&(this.network.setSelectingElement(!0),this._moveTouchPoint?this.network.fireInteractionEvent({kind:"selectBetween",event:t}):(this.network.fireInteractionEvent({kind:"selectStart",event:t}),this.timer&&clearTimeout(this.timer)),this._moveTouchPoint=s,this.repaint())}},handleTouchend:function(t){if(Xe.preventDefault(t),this.network.isMovingElement())this.network.setMovingElement(!1),this.network.fireInteractionEvent({kind:"liveMoveEnd",event:t});else if(this.network.isSelectingElement()){var e=We.getRect([this._startTouchPoint,this._moveTouchPoint]),i=this.network.getElementsAtRect(e,this.getIntersectMode(),this.network.getRectSelectFilter());if(i&&i.size()>0){var n=this.network.getSelectionModel(),o=n.toSelection();i.forEach(function(t){n.contains(t)?o.remove(t):o.add(t)},this),n.setSelection(o)}this.network.fireInteractionEvent({kind:"selectEnd",event:t}),this._moveTouchPoint=null,this.network.setSelectingElement(!1),this.repaint()}else if(this._startTouchPoint){this._zoomFlag=!1;var r=new Date,a=this.network.getLogicalPoint(t),s=this.network.getElementAt(this._startTouchPoint);a&&r.getTime()-this._startTouchTime.getTime()<=500&&We.getDistance(this._startTouchPoint,a)<=20&&(s?this.network.getSelectionModel().contains(s)||this.network.getSelectionModel().setSelection(s):this.network.getSelectionModel().clearSelection(),Ai.handleClicked(this.network,t,s),this.timer&&clearTimeout(this.timer),this._endTouchTime&&r.getTime()-this._endTouchTime.getTime()<=500&&We.getDistance(this._endTouchPoint,a)<=20?(delete this._endTouchTime,delete this._endTouchPoint,Ai.handleDoubleClicked(this.network,t,s)):(this._endTouchTime=r,this._endTouchPoint=a))}},paint:function(t){if(this._startTouchPoint&&this._moveTouchPoint){var e=this.convertPointFromView(this._startTouchPoint),i=this.convertPointFromView(this._moveTouchPoint),n=e.x,o=e.y,r=i.x,a=i.y,s=We.getRect([{x:n,y:o},{x:r,y:a}]);if(null!=s){t.beginPath();var l=this.network.getSelectOutlineWidth(),h=this.getIntersectMode()?this.network.getSelectFillColor():null;t.strokeStyle=this.network.getSelectOutlineColor(),t.lineWidth=l,Nn.rect(t,s.x,s.y,s.width,s.height,h,this.network.getSelectOutlineColor()),t.closePath()}}},getIntersectMode:function(){return"intersect"===this.network.getSelectMode()||"contain"!==this.network.getSelectMode()&&(this._startTouchPoint.x>this._moveTouchPoint.x&&this._startTouchPoint.y>this._moveTouchPoint.y)}}),De.canvas.interaction.MSTouchInteraction=function(t){De.canvas.interaction.MSTouchInteraction.superClass.constructor.call(this,t),this._pointerMap={},this._pointerIdArray=[]},Me.ext("twaver.canvas.interaction.MSTouchInteraction",De.canvas.interaction.BaseInteraction,{setUp:function(){var t=this.network.getView();Xe.addEventListener("MSPointerDown","handleTouchstart",t,this),Xe.addEventListener("MSPointerMove","handleTouchmove",t,this),Xe.addEventListener("MSPointerUp","handleTouchend",t,this),Xe.addEventListener("MSPointerCancel","handleTouchend",t,this),this.network.addMarker(this)},tearDown:function(){var t=this.network.getView();Xe.removeEventListener("MSPointerDown",t,this),Xe.removeEventListener("MSPointerMove",t,this),Xe.removeEventListener("MSPointerUp",t,this),Xe.removeEventListener("MSPointerCancel",t,this),this.network.removeMarker(this)},handleTouchstart:function(t){if(this.network.isFocusOnClick()&&De.Util.setFocus(this.network._view),!this.network.isSelectingElement()||t.pointerType!=t.MSPOINTER_TYPE_MOUSE){var e=this.network.getLogicalPoint(t),i=new Date;if(t.isPrimary&&this._pointerIdArray.length>0&&this.handle_mouseup(t),this._pointerMap[t.pointerId]||(this._pointerIdArray.push(t.pointerId),this._pointerMap[t.pointerId]=t),1==this._pointerIdArray.length){var n=this.network.getElementAt(e);this._startTouchElement=n,this._startClientPoint={x:t.clientX,y:t.clientY},Ai.handleClicked(this.network,t,n),this._startTouchTime&&this._startTouchPoint&&i.getTime()-this._startTouchTime.getTime()<=500&&We.getDistance(this._startTouchPoint,e)<=20?(Ai.handleDoubleClicked(this.network,t,n),this._doubleClick=!0):(Xe.handle_mousedown(this,t),this._startTouchPoint=e,this._startTouchTime=i);var o=this.network.getSelectionModel();n?Me.isCtrlDown(t)?o.contains(n)?o.removeSelection(n):o.appendSelection(n):o.contains(n)||o.setSelection(n):Me.isCtrlDown(t)||o.clearSelection()}else 2==this._pointerIdArray.length&&(this._distance=this._getDistance(),this._zoom=this.network.getZoom())}},handleTouchmove:function(t){if(null!=this._startTouchPoint&&0!=this._pointerIdArray.length&&this._pointerMap[t.pointerId]&&!(We.getDistance({x:this._pointerMap[t.pointerId].pageX,y:this._pointerMap[t.pointerId].pageY},{x:t.pageX,y:t.pageY})<=10)&&(this._pointerMap[t.pointerId]=t,2==this._pointerIdArray.length)){var e=this._getDistance()/this._distance;this.network.setZoom(this._zoom*e,!1)}},handleTouchend:function(t){if(this.network.isMovingElement()&&(this.network.setMovingElement(!1),this.network.fireInteractionEvent({kind:"liveMoveEnd",event:t})),this.network.isSelectingElement()){var e=We.getRect([this._startTouchPoint,this._moveTouchPoint]),i=this.network.getElementsAtRect(e,this.getIntersectMode(),this.network.getRectSelectFilter());if(i&&i.size()>0){var n=this.network.getSelectionModel(),o=n.toSelection();i.forEach(function(t){n.contains(t)?o.remove(t):o.add(t)},this),n.setSelection(o)}this.network.fireInteractionEvent({kind:"selectEnd",event:t}),this._moveTouchPoint=null,this.network.setSelectingElement(!1),this.repaint()}this._doubleClick&&(delete this._doubleClick,delete this._startTouchPoint,delete this._startTouchTime);for(var r=-1,a=0;a<this._pointerIdArray.length;a++)if(this._pointerIdArray[a]==t.pointerId){r=a;break}r>=0&&this._pointerIdArray.splice(r,1),delete this._pointerMap[t.pointerId],this._startTouchPoint=null,this._moveTouchPoint=null},_getDistance:function(){return We.getDistance({x:this._pointerMap[this._pointerIdArray[0]].pageX,y:this._pointerMap[this._pointerIdArray[0]].pageY},{x:this._pointerMap[this._pointerIdArray[1]].pageX,y:this._pointerMap[this._pointerIdArray[1]].pageY})},getIntersectMode:function(){return"intersect"===this.network.getSelectMode()||"contain"!==this.network.getSelectMode()&&(this._startTouchPoint.x>this._moveTouchPoint.x&&this._startTouchPoint.y>this._moveTouchPoint.y)},handle_mousemove:function(t){var e={x:t.clientX,y:t.clientY};if(!(We.getDistance(this._startClientPoint,e)<3)&&this._startTouchPoint&&1==this._pointerIdArray.length)if(this._moveTouchPoint={x:this._startTouchPoint.x+(e.x-this._startClientPoint.x)/this.network.getZoom(),y:this._startTouchPoint.y+(e.y-this._startClientPoint.y)/this.network.getZoom()},null==this._startTouchElement&&this.network.isRectSelectEnabled()){var i=this.network.getLogicalPoint(t);if(!i)return;this.network.setSelectingElement(!0),this.network.fireInteractionEvent(this._moveTouchPoint?{kind:"selectBetween",event:t}:{kind:"selectStart",event:t}),this.repaint()}else{var n=this.network.getElementAt(this._moveTouchPoint);if(null!=this._startTouchElement||this.network.isRectSelectEnabled()){if(this.network.isMovingElement()||null!=this._startTouchElement&&n==this._startTouchElement&&this.network.getMovableSelectedElements().contains(n)){var o=this._moveTouchPoint.x-this._startTouchPoint.x,r=this._moveTouchPoint.y-this._startTouchPoint.y;this.network.moveSelectedElements(o,r),this.network.isMovingElement()?this.network.fireInteractionEvent({kind:"liveMoveBetween",event:t}):(this.network.setMovingElement(!0),this.network.fireInteractionEvent({kind:"liveMoveStart",event:t}))}}else{var o=this._startClientPoint.x-e.x,r=this._startClientPoint.y-e.y;this.network.panByOffset(o,r)}this._startClientPoint=e}},handle_mouseup:function(t){this.handleTouchend(t),this._pointerIdArray=[],this._pointerMap={}},paint:function(t){if(this._startTouchPoint&&this._moveTouchPoint&&!this._startTouchElement&&this.network.isRectSelectEnabled()){var e=this.convertPointFromView(this._startTouchPoint),i=this.convertPointFromView(this._moveTouchPoint),n=e.x,o=e.y,r=i.x,a=i.y,s=We.getRect([{x:n,y:o},{x:r,y:a}]);if(null!=s){t.beginPath();var l=this.network.getSelectOutlineWidth(),h=this.getIntersectMode()?this.network.getSelectFillColor():null;t.strokeStyle=this.network.getSelectOutlineColor(),t.lineWidth=l,Nn.rect(t,s.x,s.y,s.width,s.height,h,this.network.getSelectOutlineColor()),t.closePath()}}}});var Bn=function(t,e){Me.registerImage(t,e),Fn[t]=1},Fn={};Bn("node_image",{w:32,h:24,origin:{x:0,y:0},v:[{shape:"path",data:"M32,23.5c0,0.276-0.224,0.5-0.5,0.5h-31C0.224,24,0,23.776,0,23.5v-2C0,21.224,0.224,21,0.5,21h31  c0.276,0,0.5,0.224,0.5,0.5V23.5z",gradient:{id:"SVGID_1_",type:"linear",x1:"15.9995",y1:"21",x2:"15.9995",y2:"24",stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"path",data:"M15,22.3c0-0.165-0.134-0.3-0.3-0.3H3.3C3.134,22,3,22.135,3,22.3V24h12V22.3z",gradient:{id:"SVGID_2_",type:"linear",x1:"9",y1:"22",x2:"9",y2:"25",stop:[{offset:"0",color:"#69B4A5"},{offset:"0.1",color:"#61AD9C"}]}},{shape:"path",data:"M31,20H1V1c0-0.553,0.448-1,1-1h28c0.553,0,1,0.447,1,1V20z",gradient:{id:"SVGID_3_",type:"linear",x1:"15.9995",y1:"-0.1221",x2:"15.9995",y2:"19.9471",stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"rect",x:2,y:1,w:28,h:18,fill:"#FFFFFF"},{shape:"rect",x:3,y:2,w:26,h:16,gradient:{id:"SVGID_4_",type:"linear",x1:"15.9995",y1:"2.0654",x2:"15.9995",y2:"17.3835",stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#0089C1"}]}},{shape:"path",data:"9.649,17.034 6.815,17.034 9.935,2.966 12.768,2.966 z",fill:"#FFFFFF"},{shape:"path",data:"12.065,17.034 10.815,17.034 13.935,2.966 15.185,2.966 z",fill:"#FFFFFF"},{shape:"path",data:"14.065,17.034 13.315,17.034 16.435,2.966 17.185,2.966 z",fill:"#FFFFFF"}]}),Bn("group_image",{w:32,h:24,origin:{x:0,y:0},v:[{shape:"path",data:"M32,16.5c0,0.276-0.224,0.5-0.5,0.5h-24C7.224,17,7,16.776,7,16.5v-1C7,15.224,7.224,15,7.5,15h24   c0.276,0,0.5,0.224,0.5,0.5V16.5z",gradient:{id:"SVGID_1_",type:"linear",x1:"19.5",y1:"15",x2:"19.5",y2:"17",stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"path",data:"M19,16.5c0-0.277-0.224-0.5-0.5-0.5h-8c-0.276,0-0.5,0.223-0.5,0.5V17h9V16.5z",gradient:{id:"SVGID_2_",type:"linear",x1:"14.4995",y1:"15.9209",x2:"14.4995",y2:"17.0459",stop:[{offset:"0",color:"#58AC9A"},{offset:"1",color:"#248576"}]}},{shape:"path",data:"M31,14H8V1c0-0.553,0.448-1,1-1h21c0.553,0,1,0.447,1,1V14z",gradient:{id:"SVGID_3_",type:"linear",x1:"19.5",y1:"0",x2:"19.5",y2:"14.0005",stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"rect",x:9,y:1,w:21,h:12,fill:"#FFFFFF"},{shape:"rect",x:10,y:2,w:19,h:10,gradient:{id:"SVGID_4_",type:"linear",x1:"19.5",y1:"1.9619",x2:"19.5",y2:"11.9744",stop:[{offset:"0",color:"#58AC9A"},{offset:"1",color:"#248576"}]}},{shape:"path",data:"M25,23.5c0,0.276-0.224,0.5-0.5,0.5h-24C0.224,24,0,23.776,0,23.5v-1C0,22.224,0.224,22,0.5,22h24   c0.276,0,0.5,0.224,0.5,0.5V23.5z",gradient:{id:"SVGID_5_",type:"linear",x1:"12.4995",y1:"22",x2:"12.4995",y2:"24",stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"path",data:"M12,23.5c0-0.277-0.224-0.5-0.5-0.5h-8C3.224,23,3,23.223,3,23.5V24h9V23.5z",gradient:{id:"SVGID_6_",type:"linear",x1:"7.5",y1:"22.9209",x2:"7.5",y2:"24.0459",stop:[{offset:"0",color:"#58AC9A"},{offset:"1",color:"#248576"}]}},{shape:"path",data:"M24,21H1V8c0-0.553,0.448-1,1-1h21c0.553,0,1,0.447,1,1V21z",gradient:{id:"SVGID_7_",type:"linear",x1:"12.4995",y1:"7",x2:"12.4995",y2:"21.0005",stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"rect",x:2,y:8,w:21,h:12,fill:"#FFFFFF"},{shape:"rect",x:3,y:9,w:19,h:10,gradient:{id:"SVGID_8_",type:"linear",x1:"12.4995",y1:"8.9619",x2:"12.4995",y2:"18.9749",stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#0089C1"}]}}]}),Bn("subnetwork_image",{w:32,h:24,origin:{x:0,y:0},v:[{shape:"path",data:"M32,14.499c0,0.276-0.224,0.5-0.5,0.5h-20c-0.276,0-0.5-0.224-0.5-0.5v-1c0-0.276,0.224-0.5,0.5-0.5  h20c0.276,0,0.5,0.224,0.5,0.5V14.499z",gradient:{id:"SVGID_1_",type:"linear",x1:21.5,y1:12.999,x2:21.5,y2:14.9995,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"path",data:"M22,14.499c0-0.277-0.224-0.5-0.5-0.5h-7c-0.276,0-0.5,0.223-0.5,0.5v0.5h8V14.499z",gradient:{id:"SVGID_2_",type:"linear",x1:18,y1:13.9199,x2:18,y2:15.0449,stop:[{offset:"0",color:"#58AC9A"},{offset:"1",color:"#248576"}]}},{shape:"path",data:"M31,11.499c0,0.276-0.224,0.5-0.5,0.5h-18c-0.276,0-0.5-0.224-0.5-0.5v-11c0-0.276,0.224-0.5,0.5-0.5  h18c0.276,0,0.5,0.224,0.5,0.5V11.499z",gradient:{id:"SVGID_3_",type:"linear",x1:21.5,y1:-.9502,x2:21.5,y2:12.5498,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"rect",x:13,y:.999,w:17,h:10,fill:"#FFFFFF"},{shape:"rect",x:14,y:1.999,w:15,h:8,gradient:{id:"SVGID_4_",type:"linear",x1:21.5,y1:1.9312,x2:21.5,y2:9.6537,stop:[{offset:"0",color:"#58AC9A"},{offset:"1",color:"#248576"}]}},{shape:"path",data:"M21,23.5c0,0.276-0.224,0.5-0.5,0.5h-20C0.224,24,0,23.776,0,23.5v-1C0,22.224,0.224,22,0.5,22h20  c0.276,0,0.5,0.224,0.5,0.5V23.5z",gradient:{id:"SVGID_5_",type:"linear",x1:10.4995,y1:22,x2:10.4995,y2:24,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"rect",x:22,y:20.5,w:3,h:1.999,gradient:{id:"SVGID_6_",type:"linear",x1:-464.9424,y1:-722.2754,x2:-462.9424,y2:-722.2754,stop:[{offset:"0",color:"#58AC9A"},{offset:"1",color:"#248576"}]}},{shape:"rect",x:28,y:16,w:2,h:3,gradient:{id:"SVGID_7_",type:"linear",x1:29,y1:16,x2:29,y2:19,stop:[{offset:"0",color:"#58AC9A"},{offset:"1",color:"#248576"}]}},{shape:"path",data:"M11,23.5c0-0.277-0.224-0.5-0.5-0.5h-7C3.224,23,3,23.223,3,23.5V24h8V23.5z",gradient:{id:"SVGID_8_",type:"linear",x1:7,y1:22.9209,x2:7,y2:24.0459,stop:[{offset:"0",color:"#58AC9A"},{offset:"1",color:"#248576"}]}},{shape:"path",data:"M20,20.5c0,0.276-0.224,0.5-0.5,0.5h-18C1.224,21,1,20.776,1,20.5v-11C1,9.224,1.224,9,1.5,9h18  C19.776,9,20,9.224,20,9.5V20.5z",gradient:{id:"SVGID_9_",type:"linear",x1:10.4995,y1:8.0508,x2:10.4995,y2:21.5513,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"rect",x:2,y:10,w:17,h:10,fill:"#FFFFFF"},{shape:"rect",x:3,y:11,w:15,h:8,gradient:{id:"SVGID_10_",type:"linear",x1:10.4995,y1:10.9321,x2:10.4995,y2:18.6551,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#0089C1"}]}},{shape:"path",data:"M32,22.7c0,0.165-0.135,0.3-0.301,0.3h-5.4C26.134,23,26,22.865,26,22.7v-2.4  c0-0.165,0.134-0.3,0.299-0.3h5.4C31.865,20,32,20.135,32,20.3V22.7z",gradient:{id:"SVGID_11_",type:"linear",x1:29,y1:20,x2:29,y2:23,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}}]}),Bn("bus_icon",{w:16,h:16,origin:{x:0,y:0},v:[{shape:"rect",x:4,y:6,w:1,h:1,fill:"#232424"},{shape:"path",data:"M7,4c0,0.552-0.448,1-1,1H3C2.448,5,2,4.552,2,4V3c0-0.552,0.448-1,1-1h3c0.552,0,1,0.448,1,1V4z",gradient:{id:"SVGID_1_",type:"linear",x1:4.5,y1:2,x2:4.5,y2:5,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"rect",x:3,y:3,w:3,h:1,fill:"#232424"},{shape:"rect",x:3,y:3,w:3,h:1,fill:"#FFFFFF"},{shape:"path",data:"M6,5.5C6,5.776,5.776,6,5.5,6h-2C3.224,6,3,5.776,3,5.5l0,0C3,5.224,3.224,5,3.5,5h2  C5.776,5,6,5.224,6,5.5L6,5.5z",gradient:{id:"SVGID_2_",type:"linear",x1:4.5,y1:6,x2:4.5,y2:5,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}},{shape:"rect",x:12,y:6,w:1,h:1,fill:"#232424"},{shape:"path",data:"M15,4c0,0.552-0.447,1-1,1h-3c-0.553,0-1-0.448-1-1V3c0-0.552,0.447-1,1-1h3c0.553,0,1,0.448,1,1V4z",gradient:{id:"SVGID_3_",type:"linear",x1:12.5,y1:2,x2:12.5,y2:5,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"rect",x:11,y:3,w:3,h:1,fill:"#232424"},{shape:"rect",x:11,y:3,w:3,h:1,fill:"#FFFFFF"},{shape:"path",data:"M14,5.5C14,5.776,13.777,6,13.5,6h-2C11.225,6,11,5.776,11,5.5l0,0C11,5.224,11.225,5,11.5,5h2  C13.777,5,14,5.224,14,5.5L14,5.5z",gradient:{id:"SVGID_4_",type:"linear",x1:12.5,y1:6,x2:12.5,y2:5,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}},{shape:"rect",x:8,y:10,w:1,h:1,fill:"#232424"},{shape:"path",data:"M6,13c0-0.553,0.448-1,1-1h3c0.553,0,1,0.447,1,1v1c0,0.553-0.447,1-1,1H7c-0.552,0-1-0.447-1-1V13z",gradient:{id:"SVGID_5_",type:"linear",x1:-1428.3853,y1:-571.5747,x2:-1428.3853,y2:-568.5747,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"rect",x:7,y:13,w:3,h:1,fill:"#232424"},{shape:"rect",x:7,y:13,w:3,h:1,fill:"#FFFFFF"},{shape:"path",data:"M7,11.5C7,11.223,7.224,11,7.5,11h2c0.277,0,0.5,0.223,0.5,0.5l0,0c0,0.275-0.223,0.5-0.5,0.5h-2  C7.224,12,7,11.775,7,11.5L7,11.5z",gradient:{id:"SVGID_6_",type:"linear",x1:-1428.3862,y1:-567.5737,x2:-1428.3862,y2:-568.5737,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}},{shape:"path",data:"M15,7.5C15,7.776,14.777,8,14.5,8h-12C2.224,8,2,7.776,2,7.5l0,0C2,7.224,2.224,7,2.5,7h12  C14.777,7,15,7.224,15,7.5L15,7.5z",gradient:{id:"SVGID_7_",type:"linear",x1:8.4995,y1:6.1152,x2:8.4995,y2:7.5558,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"path",data:"M15,9.5c0,0.275-0.223,0.5-0.5,0.5h-12C2.224,10,2,9.775,2,9.5l0,0C2,9.223,2.224,9,2.5,9h12  C14.777,9,15,9.223,15,9.5L15,9.5z",gradient:{id:"SVGID_8_",type:"linear",x1:8.4995,y1:8.1147,x2:8.4995,y2:9.556,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}}]}),Bn("data_icon",{w:16,h:16,origin:{x:0,y:0},v:[{shape:"path",data:"M15,12c0,0.553-0.447,1-1,1H7c-0.552,0-1-0.447-1-1V8c0-0.552,0.448-1,1-1h7c0.553,0,1,0.448,1,1V12   z",gradient:{id:"SVGID_1_",type:"linear",x1:10.5,y1:6.959,x2:10.5,y2:12.2259,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"rect",x:7,y:8,w:7,h:4,fill:"#FFFFFF"},{shape:"rect",x:8,y:9,w:5,h:2,gradient:{id:"SVGID_2_",type:"linear",x1:10.5,y1:8.6997,x2:10.5,y2:11.0333,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}},{shape:"path",data:"M15,14.5c0,0.275-0.225,0.5-0.5,0.5h-8C6.224,15,6,14.775,6,14.5l0,0C6,14.223,6.224,14,6.5,14h8   C14.775,14,15,14.223,15,14.5L15,14.5z",gradient:{id:"SVGID_3_",type:"linear",x1:10.5,y1:13.125,x2:10.5,y2:14.5518,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"rect",x:8,y:14,w:1,h:1,gradient:{id:"SVGID_4_",type:"linear",x1:8.4995,y1:14.0049,x2:8.4995,y2:14.9471,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}},{shape:"path",data:"M12,4H6c0,0-0.152-0.275-0.5-1C5.021,2,5.021,2,4,2C3.057,2,2,2,2,2C1.448,2,1,2.448,1,3v8  c0,0.553,0.448,1,1,1h3v-1H2V3h2.387l1.024,1.998L12,5v1h1V5C13,4.448,12.553,4,12,4z",gradient:{id:"SVGID_5_",type:"linear",x1:6.9995,y1:2.0527,x2:6.9995,y2:11.4757,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"path",data:"M12,5L5.411,4.998L4.387,3H2v8h3v-0.645V7.254V7c0-0.552,0.448-1,1-1h0.324h3.032H12V5z",gradient:{id:"SVGID_6_",type:"linear",x1:6.9995,y1:2.9902,x2:6.9995,y2:11.0032,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}}]}),Bn("grid_icon",{w:16,h:16,origin:{x:0,y:0},v:[{shape:"path",data:"M15,14c0,0.553-0.447,1-1,1H3c-0.552,0-1-0.447-1-1V3c0-0.552,0.448-1,1-1h11c0.553,0,1,0.448,1,1V14  z",gradient:{id:"SVGID_1_",type:"linear",x1:8.4995,y1:2.1255,x2:8.4995,y2:14.909,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"rect",x:3,y:3,w:11,h:11,fill:"#FFFFFF"},{shape:"rect",x:3,y:5,w:11,h:1,gradient:{id:"SVGID_2_",type:"linear",x1:8.4995,y1:3.209,x2:8.4995,y2:13.8043,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}},{shape:"rect",x:3,y:8,w:11,h:1,gradient:{id:"SVGID_3_",type:"linear",x1:8.4995,y1:3.209,x2:8.4995,y2:13.8043,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}},{shape:"rect",x:3,y:11,w:11,h:1,gradient:{id:"SVGID_4_",type:"linear",x1:8.4995,y1:3.2095,x2:8.4995,y2:13.8048,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}},{shape:"rect",x:11,y:3,w:1,h:11,gradient:{id:"SVGID_5_",type:"linear",x1:11.5,y1:3.209,x2:11.5,y2:13.8048,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}},{shape:"rect",x:8,y:3,w:1,h:11,gradient:{id:"SVGID_6_",type:"linear",x1:8.4995,y1:3.209,x2:8.4995,y2:13.8048,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}},{shape:"rect",x:5,y:3,w:1,h:11,gradient:{id:"SVGID_7_",type:"linear",x1:5.5,y1:3.209,x2:5.5,y2:13.8048,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}}]}),Bn("databox_icon",{w:16,h:16,origin:{x:0,y:0},v:[{shape:"path",data:"M14.5,6h-12H2v0.5v7C2,13.776,2.224,14,2.5,14h12c0.276,0,0.5-0.224,0.5-0.5v-7V6H14.5z",gradient:{id:"SVGID_1_",type:"linear",x1:8.4995,y1:6.0625,x2:8.4995,y2:14.063,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"path",data:"M14.776,5.553l-1.553-3.105C13.101,2.201,12.775,2,12.5,2h-8C4.225,2,3.899,2.201,3.776,2.447  L2.224,5.553L2,6h0.5h12H15L14.776,5.553z",gradient:{id:"SVGID_2_",type:"linear",x1:8.5005,y1:3.104,x2:8.5005,y2:-5.6467,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"path",data:"12,2 9.5,2 7.5,2 5,2 3,6 7.5,6 9.5,6 14,6 z",gradient:{id:"SVGID_3_",type:"linear",x1:8.5005,y1:9.2295,x2:8.5005,y2:5.4586,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"path",data:"M11.5,9c0,0.276-0.224,0.5-0.5,0.5H6C5.724,9.5,5.5,9.276,5.5,9l0,0c0-0.276,0.224-0.5,0.5-0.5h5  C11.276,8.5,11.5,8.724,11.5,9L11.5,9z",fill:"#FFFFFF"}]}),Bn("group_icon",{w:16,h:16,origin:{x:0,y:0},v:[{shape:"path",data:"M15,8.5C15,8.776,14.776,9,14.5,9h-10C4.224,9,4,8.776,4,8.5v-7C4,1.224,4.224,1,4.5,1h10    C14.776,1,15,1.224,15,1.5V8.5z",gradient:{id:"SVGID_1_",type:"linear",x1:9.5,y1:.9512,x2:9.5,y2:8.9787,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"rect",x:5,y:2,w:9,h:6,fill:"#FFFFFF"},{shape:"rect",x:6,y:3,w:7,h:4,gradient:{id:"SVGID_2_",type:"linear",x1:9.5,y1:3.02,x2:9.5,y2:6.9606,stop:[{offset:"0",color:"#58AC9A"},{offset:"1",color:"#248576"}]}},{shape:"path",data:"M16,10.5c0,0.276-0.224,0.5-0.5,0.5h-12C3.224,11,3,10.776,3,10.5l0,0C3,10.224,3.224,10,3.5,10h12    C15.776,10,16,10.224,16,10.5L16,10.5z",gradient:{id:"SVGID_3_",type:"linear",x1:9.5,y1:9.9941,x2:9.5,y2:10.9976,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"rect",x:6,y:10.001,w:2,h:.999,gradient:{id:"SVGID_4_",type:"linear",x1:7,y1:10.0059,x2:7,y2:10.9472,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}},{shape:"path",data:"M12,12.5c0,0.276-0.224,0.5-0.5,0.5h-10C1.224,13,1,12.776,1,12.5v-7C1,5.224,1.224,5,1.5,5h10    C11.776,5,12,5.224,12,5.5V12.5z",gradient:{id:"SVGID_5_",type:"linear",x1:6.4995,y1:4.9512,x2:6.4995,y2:12.9792,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"rect",x:2,y:6,w:9,h:6,fill:"#FFFFFF"},{shape:"rect",x:3,y:7,w:7,h:4,gradient:{id:"SVGID_6_",type:"linear",x1:6.4995,y1:7.02,x2:6.4995,y2:10.9611,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}},{shape:"path",data:"M13,14.5c0,0.276-0.224,0.5-0.5,0.5h-12C0.224,15,0,14.776,0,14.5l0,0C0,14.224,0.224,14,0.5,14h12    C12.776,14,13,14.224,13,14.5L13,14.5z",gradient:{id:"SVGID_7_",type:"linear",x1:6.4995,y1:13.9941,x2:6.4995,y2:14.9976,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"rect",x:3,y:14.001,w:2,h:.999,gradient:{id:"SVGID_8_",type:"linear",x1:4,y1:14.0059,x2:4,y2:14.9472,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}}]}),Bn("link_icon",{w:16,h:16,origin:{x:0,y:0},v:[{shape:"line",p1:{x:2.5,y:2.5},p2:{x:13.5,y:13.5},lineColor:"url(#SVGID_1_)",lineWidth:1},{shape:"ellipse",cx:13,cy:13,rx:2,ry:2,gradient:{id:"SVGID_2_",type:"linear",x1:11.5371,y1:11.5371,x2:14.2155,y2:14.2155,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}},{shape:"ellipse",cx:13,cy:13,rx:1,ry:1,fill:"#FFFFFF"},{shape:"ellipse",cx:3,cy:3,rx:2,ry:2,gradient:{id:"SVGID_3_",type:"linear",x1:1.4956,y1:1.4956,x2:4.1473,y2:4.1473,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}},{shape:"ellipse",cx:3,cy:3,rx:1,ry:1,fill:"#FFFFFF"}]}),Bn("linksubnetwork_icon",{w:16,h:16,origin:{x:0,y:0},v:[{shape:"path",data:"M15,7.661c0-1.202-0.642-2.247-1.596-2.835C12.848,3.188,11.314,2,9.486,2  c-1.587,0-2.95,0.902-3.649,2.211C4.573,4.22,3.548,5.194,3.438,6.432C3.389,6.429,3.342,6.417,3.292,6.417  C2.026,6.417,1,7.443,1,8.708C1,9.975,2.026,11,3.292,11h8.371l0,0C13.506,11,15,9.506,15,7.661z",gradient:{id:"SVGID_1_",type:"linear",x1:7.9995,y1:1.959,x2:7.9995,y2:11.0921,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"path",data:"M3.292,10C2.58,10,2,9.42,2,8.708c0-0.712,0.58-1.292,1.292-1.292C3.286,7.422,3.332,7.427,3.379,7.43  l0.969,0.058L4.435,6.52C4.5,5.779,5.106,5.216,5.844,5.211l0.595-0.004l0.28-0.524C7.273,3.645,8.334,3,9.486,3  c1.342,0,2.535,0.863,2.971,2.147l0.116,0.341l0.307,0.189C13.581,6.11,14,6.851,14,7.661C14,8.951,12.951,10,11.661,10H3.292z",fill:"#FFFFFF"},{shape:"path",data:"M3.292,10h8.37c1.11,0,2.04-0.781,2.276-1.821c-0.131-0.615-0.5-1.158-1.058-1.501l-0.307-0.189  l-0.116-0.341C12.021,4.863,10.828,4,9.486,4C8.334,4,7.273,4.645,6.719,5.682l-0.28,0.524L5.844,6.211  C5.106,6.216,4.5,6.779,4.435,7.52L4.349,8.487L3.379,8.43C3.332,8.427,3.286,8.422,3.292,8.417c-0.535,0-0.994,0.328-1.19,0.792  C2.297,9.672,2.757,10,3.292,10z",gradient:{id:"SVGID_2_",type:"linear",x1:8.019,y1:4.084,x2:8.019,y2:9.8062,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}},{shape:"line",p1:{x:8.01,y:8.01},p2:{x:13.186,y:13.186},lineColor:"url(#SVGID_3_)",lineWidth:1},{shape:"ellipse",cx:8,cy:8,rx:2,ry:2,gradient:{id:"SVGID_4_",type:"linear",x1:6.7881,y1:6.7881,x2:9.9924,y2:9.9924,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"ellipse",cx:8,cy:8,rx:1,ry:1,fill:"#FFFFFF"},{shape:"ellipse",cx:13,cy:13,rx:2,ry:2,gradient:{id:"SVGID_5_",type:"linear",x1:11.5791,y1:11.5791,x2:14.3132,y2:14.3132,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"ellipse",cx:13,cy:13,rx:1,ry:1,fill:"#FFFFFF"}]}),Bn("node_icon",{w:16,h:16,origin:{x:0,y:0},v:[{shape:"path",data:"M15,11.5c0,0.276-0.224,0.5-0.5,0.5h-13C1.224,12,1,11.776,1,11.5v-9C1,2.224,1.224,2,1.5,2h13  C14.776,2,15,2.224,15,2.5V11.5z",gradient:{id:"SVGID_1_",type:"linear",x1:7.9995,y1:1.939,x2:7.9995,y2:11.9739,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"rect",x:2,y:3,w:12,h:8,fill:"#FFFFFF"},{shape:"rect",x:3,y:4,w:10,h:6,gradient:{id:"SVGID_2_",type:"linear",x1:7.9995,y1:4.0513,x2:7.9995,y2:9.865,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}},{shape:"path",data:"M16,14.5c0,0.276-0.224,0.5-0.5,0.5h-15C0.224,15,0,14.776,0,14.5v-1C0,13.224,0.224,13,0.5,13h15  c0.276,0,0.5,0.224,0.5,0.5V14.5z",gradient:{id:"SVGID_3_",type:"linear",x1:7.9995,y1:13.0508,x2:7.9995,y2:14.9258,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"path",data:"M9,14.5C9,14.224,8.776,14,8.5,14h-5C3.224,14,3,14.224,3,14.5V15h6V14.5z",gradient:{id:"SVGID_4_",type:"linear",x1:5.9995,y1:14.0508,x2:5.9995,y2:15.9258,stop:[{offset:"0",color:"#69B4A5"},{offset:"0.1",color:"#61AD9C"},{offset:"0.4637",color:"#449981"},{offset:"0.7764",color:"#2C8E73"},{offset:"1",color:"#218A6E"}]}}]}),Bn("shapelink_icon",{w:16,h:16,origin:{x:0,y:0},v:[{shape:"line",p1:{x:7.5,y:2.5},p2:{x:2.5,y:7.5},lineColor:"url(#SVGID_1_)",lineWidth:1},{shape:"line",p1:{x:2.5,y:7.5},p2:{x:8.5,y:13.5},lineColor:"url(#SVGID_2_)",lineWidth:1},{shape:"line",p1:{x:9,y:13.186},p2:{x:13.5,y:6.5},lineColor:"url(#SVGID_3_)",lineWidth:1},{shape:"ellipse",cx:7,cy:3,rx:2,ry:2,gradient:{id:"SVGID_4_",type:"linear",x1:5.5864,y1:1.5864,x2:8.4149,y2:4.4149,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}},{shape:"ellipse",cx:7,cy:3,rx:1,ry:1,fill:"#FFFFFF"},{shape:"ellipse",cx:2,cy:8,rx:2,ry:2,gradient:{id:"SVGID_5_",type:"linear",x1:.5864,y1:6.5864,x2:3.4142,y2:9.4142,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}},{shape:"ellipse",cx:2,cy:8,rx:1,ry:1,fill:"#FFFFFF"},{shape:"ellipse",cx:8,cy:13,rx:2,ry:2,gradient:{id:"SVGID_6_",type:"linear",x1:6.5869,y1:11.5869,x2:9.4147,y2:14.4147,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}},{shape:"ellipse",cx:8,cy:13,rx:1,ry:1,fill:"#FFFFFF"},{shape:"ellipse",cx:13,cy:7,rx:2,ry:2,gradient:{id:"SVGID_7_",type:"linear",x1:11.5859,y1:5.5859,x2:14.4144,y2:8.4144,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}},{shape:"ellipse",cx:13,cy:7,rx:1,ry:1,fill:"#FFFFFF"}]}),Bn("shapenode_icon",{w:16,h:16,origin:{x:0,y:0},v:[{shape:"path",data:"M14.5,3h-9l-4,4v7h13L9,8.5L14.5,3z M12.086,13H2.5V7.414L5.914,4h6.172l-4.5,4.5L12.086,13z",gradient:{id:"SVGID_1_",type:"linear",x1:7.9995,y1:3.209,x2:7.9995,y2:13.6621,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"ellipse",cx:6,cy:3,rx:2,ry:2,gradient:{id:"SVGID_2_",type:"linear",x1:4.5859,y1:1.5859,x2:7.4151,y2:4.4151,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}},{shape:"ellipse",cx:6,cy:3,rx:1,ry:1,fill:"#FFFFFF"},{shape:"ellipse",cx:13,cy:3,rx:2,ry:2,gradient:{id:"SVGID_3_",type:"linear",x1:11.5869,y1:1.5864,x2:14.4153,y2:4.4149,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}},{shape:"ellipse",cx:13,cy:3,rx:1,ry:1,fill:"#FFFFFF"},{shape:"ellipse",cx:9,cy:8,rx:2,ry:2,gradient:{id:"SVGID_4_",type:"linear",x1:7.5864,y1:6.5864,x2:10.4149,y2:9.4149,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}},{shape:"ellipse",cx:9,cy:8,rx:1,ry:1,fill:"#FFFFFF"},{shape:"ellipse",cx:2,cy:7,rx:2,ry:2,gradient:{id:"SVGID_5_",type:"linear",x1:.5859,y1:5.5859,x2:3.4144,y2:8.4144,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}},{shape:"ellipse",cx:2,cy:7,rx:1,ry:1,fill:"#FFFFFF"},{shape:"ellipse",cx:12.825,cy:13,rx:2,ry:2,gradient:{id:"SVGID_6_",type:"linear",x1:11.4111,y1:11.5869,x2:14.2396,y2:14.4153,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}},{shape:"ellipse",cx:12.825,cy:13,rx:1,ry:1,fill:"#FFFFFF"}]}),Bn("shapesubnetwork_icon",{w:16,h:16,origin:{x:0,y:0},v:[{shape:"path",data:"M15,6.661c0-1.202-0.642-2.247-1.596-2.835C12.848,2.188,11.314,1,9.486,1  c-1.587,0-2.95,0.902-3.649,2.211C4.573,3.22,3.548,4.194,3.438,5.432C3.389,5.429,3.342,5.417,3.292,5.417  C2.026,5.417,1,6.443,1,7.708S2.026,10,3.292,10h8.371l0,0C13.506,10,15,8.505,15,6.661z",gradient:{id:"SVGID_1_",type:"linear",x1:7.9995,y1:1.3755,x2:7.9995,y2:9.733,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"path",data:"M3.292,9C2.58,9,2,8.42,2,7.708s0.58-1.292,1.292-1.292C3.286,6.422,3.332,6.427,3.379,6.43l0.969,0.058  L4.435,5.52C4.5,4.779,5.106,4.216,5.844,4.211l0.595-0.004l0.28-0.524C7.273,2.645,8.334,2,9.486,2  c1.342,0,2.535,0.863,2.971,2.147l0.116,0.341l0.307,0.189C13.581,5.11,14,5.851,14,6.661C14,7.951,12.951,9,11.661,9H3.292z",fill:"#FFFFFF"},{shape:"path",data:"M3.272,9h8.37c1.11,0,2.039-0.689,2.275-1.729c-0.131-0.615-0.499-1.249-1.057-1.593l-0.307-0.189  l-0.116-0.341C12.002,3.863,10.809,3,9.468,3C8.314,3,7.254,3.645,6.7,4.682L6.42,5.207L5.825,5.211  C5.087,5.216,4.481,5.779,4.416,6.52L4.33,7.487L3.36,7.43C3.313,7.427,3.267,7.422,3.272,7.417c-0.535,0-0.994,0.327-1.19,0.792  C2.278,8.672,2.738,9,3.272,9z",gradient:{id:"SVGID_2_",type:"linear",x1:7.9995,y1:3.459,x2:7.9995,y2:8.4597,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}},{shape:"path",data:"M11.516,7.102h-8l2.469,6h8.5L11.516,7.102z M5.024,8.123h5.905l1.938,3.979H6.662L5.024,8.123z",gradient:{id:"SVGID_3_",type:"linear",x1:7.4443,y1:7.1724,x2:10.1111,y2:12.8383,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"path",data:"5,8.112 10.904,8.112 12.842,12.092 6.638,12.092 z",fill:"#FFFFFF"},{shape:"ellipse",cx:5,cy:8,rx:2,ry:2,gradient:{id:"SVGID_4_",type:"linear",x1:3,y1:8,x2:7,y2:8,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"ellipse",cx:5,cy:8,rx:1,ry:1,fill:"#FFFFFF"},{shape:"ellipse",cx:12,cy:8,rx:2,ry:2,gradient:{id:"SVGID_5_",type:"linear",x1:10,y1:8,x2:14,y2:8,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"ellipse",cx:12,cy:8,rx:1,ry:1,fill:"#FFFFFF"},{shape:"ellipse",cx:7,cy:12,rx:2,ry:2,gradient:{id:"SVGID_6_",type:"linear",x1:5,y1:12,x2:9,y2:12,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"ellipse",cx:7,cy:12,rx:1,ry:1,fill:"#FFFFFF"},{shape:"ellipse",cx:14,cy:12,rx:2,ry:2,gradient:{id:"SVGID_7_",type:"linear",x1:12,y1:12,x2:16,y2:12,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"ellipse",cx:14,cy:12,rx:1,ry:1,fill:"#FFFFFF"}]}),Bn("subnetwork_icon",{w:16,h:16,origin:{x:0,y:0},v:[{shape:"rect",x:10,y:14.001,w:2,h:1,gradient:{id:"SVGID_1_",type:"linear",x1:11,y1:14.0059,x2:11,y2:14.9481,stop:[{offset:"0",color:"#58AC9A"},{offset:"1",color:"#248576"}]}},{shape:"rect",x:14,y:10.001,w:1,h:2,gradient:{id:"SVGID_2_",type:"linear",x1:14.5,y1:10.0117,x2:14.5,y2:11.8962,stop:[{offset:"0",color:"#58AC9A"},{offset:"1",color:"#248576"}]}},{shape:"path",data:"M16,6.001c0,0.552-0.447,1-1,1H8c-0.552,0-1-0.448-1-1v-4c0-0.552,0.448-1,1-1h7   c0.553,0,1,0.448,1,1V6.001z",gradient:{id:"SVGID_3_",type:"linear",x1:11.5,y1:.96,x2:11.5,y2:6.2265,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"rect",x:8,y:2.001,w:7,h:4,fill:"#FFFFFF"},{shape:"rect",x:9,y:3.001,w:5,h:2,gradient:{id:"SVGID_4_",type:"linear",x1:11.5,y1:2.7007,x2:11.5,y2:5.0337,stop:[{offset:"0",color:"#58AC9A"},{offset:"1",color:"#248576"}]}},{shape:"path",data:"M16,8.501c0,0.276-0.225,0.5-0.5,0.5h-8c-0.276,0-0.5-0.224-0.5-0.5l0,0c0-0.276,0.224-0.5,0.5-0.5   h8C15.775,8.001,16,8.225,16,8.501L16,8.501z",gradient:{id:"SVGID_5_",type:"linear",x1:11.5,y1:7.126,x2:11.5,y2:8.5535,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"rect",x:9,y:8.001,w:1,h:.999,gradient:{id:"SVGID_6_",type:"linear",x1:9.5,y1:8.0063,x2:9.5,y2:8.9477,stop:[{offset:"0",color:"#58AC9A"},{offset:"1",color:"#248576"}]}},{shape:"path",data:"M9,12c0,0.553-0.447,1-1,1H1c-0.552,0-1-0.447-1-1V8c0-0.552,0.448-1,1-1h7c0.553,0,1,0.448,1,1V12z   ",gradient:{id:"SVGID_7_",type:"linear",x1:4.4995,y1:6.959,x2:4.4995,y2:12.2259,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"rect",x:1,y:8,w:7,h:4,fill:"#FFFFFF"},{shape:"rect",x:2,y:9,w:5,h:2,gradient:{id:"SVGID_8_",type:"linear",x1:4.5,y1:8.6997,x2:4.5,y2:11.0333,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}},{shape:"path",data:"M9,14.5C9,14.776,8.775,15,8.5,15h-8C0.224,15,0,14.776,0,14.5l0,0C0,14.224,0.224,14,0.5,14h8   C8.775,14,9,14.224,9,14.5L9,14.5z",gradient:{id:"SVGID_9_",type:"linear",x1:4.4995,y1:13.125,x2:4.4995,y2:14.5518,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"rect",x:2,y:14,w:1,h:1,gradient:{id:"SVGID_10_",type:"linear",x1:2.5,y1:14.0049,x2:2.5,y2:14.9471,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}},{shape:"path",data:"M16,14.501c0,0.276-0.224,0.5-0.5,0.5h-2c-0.276,0-0.5-0.224-0.5-0.5v-1c0-0.276,0.224-0.5,0.5-0.5  h2c0.276,0,0.5,0.224,0.5,0.5V14.501z",gradient:{id:"SVGID_11_",type:"linear",x1:14.5,y1:13.0117,x2:14.5,y2:14.8962,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}}]});var Nn={_hitCanvas:null,getHitCanvas:function(t,e){return null==this._hitCanvas&&(this._hitCanvas=Xe.createCanvas()),0==arguments.length&&(t=2,e=2),this._hitCanvas.setAttribute("width",""+t-1),this._hitCanvas.setAttribute("height",""+e-1),this._hitCanvas.setAttribute("width",""+t),this._hitCanvas.setAttribute("height",""+e),this.getCtx(this._hitCanvas).clearRect(0,0,t,e),this._hitCanvas},disposeHitCanvas:function(){this._hitCanvas=null},getCtx:function(t){return t.getContext("2d")},render:function(t,i,n){i!=e&&(t.fillStyle=i,t.fill()),n!=e&&(t.strokeStyle=n,t.stroke())},text:function(t,e,i,n,o,r){t.textAlign="center",t.textBaseline="middle",null!=o&&(t.fillStyle=o,t.fillText(e,i,n)),r&&(t.strokeStyle=r,t.strokeText(e,i,n))},circle:function(t,e,i,n,o,r){t.arc(e,i,n,0,2*Math.PI,!0),t.closePath(),this.render(t,o,r)},rect:function(t,e,i,n,o,r,a){t.rect(e,i,n,o),t.closePath(),this.render(t,r,a)},OUT_LEFT:1,OUT_TOP:2,OUT_RIGHT:4,OUT_BOTTOM:8,outcode:function(t,e,i,n,o,r){var a=0;return 0>=o?a|=this.OUT_LEFT|this.OUT_RIGHT:i>t?a|=this.OUT_LEFT:t>i+o&&(a|=this.OUT_RIGHT),0>=r?a|=this.OUT_TOP|this.OUT_BOTTOM:n>e?a|=this.OUT_TOP:e>n+r&&(a|=this.OUT_BOTTOM),a},intersectsLine:function(t,e,i,n,o,r,a,s){var l,h;if(0==(h=this.outcode(i,n,o,r,a,s)))return!0;for(;0!=(l=this.outcode(t,e,o,r,a,s));){if(0!=(l&h))return!1;if(0!=(l&(this.OUT_LEFT|this.OUT_RIGHT))){var c=o;0!=(l&this.OUT_RIGHT)&&(c+=a),e+=(c-t)*(n-e)/(i-t),t=c}else{var u=r;0!=(l&this.OUT_BOTTOM)&&(u+=s),t+=(u-e)*(i-t)/(n-e),e=u}}return!0}};De.vector={},De.vector.interaction={},De.vector.Network=function(t){De.vector.Network.superClass.constructor.apply(this,arguments),this.zoomManager=new De.vector.PhysicalZoomManager(this),this._view=Xe.createView("hidden"),this._rootCanvas=Xe.createCanvas(),this._topCanvas=Xe.createCanvas(),this._view.appendChild(this._rootCanvas),this._view.appendChild(this._topCanvas),this.realWidth=0,this.realHeight=0,this._unionBounds={x:0,y:0,width:0,height:0},this._zoom=1,this._elementUIMap={},this._zoomMap={},this._viewRectMap={},this.viewRect={x:0,y:0,width:0,height:0},this.state={zooming:!1,panning:!1,autoLayout:!1},this.hScrollBarVisible=!1,this.vScrollBarVisible=!1,this.markerList=new De.List,this._topAttachmentList=new De.List,this._hitTestTopAttachmentList=new De.List,this.setElementBox(t||new De.ElementBox),Ue.isTouchable?Ue.isMSTouchable?this.setDefaultInteractions(!1):this.setTouchInteractions():this.setDefaultInteractions(!1);var e=this;this._flowLink=function(){if(!(e.isMovingElement()||e.isSelectingElement()||e.isEditingElement()||e._box._layoutMovingElements)){e._flowLinkQuickFinder||(e._flowLinkQuickFinder=new De.QuickFinder(e._box,"link.flow","style"));e._flowLinkQuickFinder.find(!0).forEach(function(t){t._styleMap["link.flow.offset"]=e.getLinkFlowOffset(t),e.invalidateElementUI(t)})}},this.setToolTipEnabled(De.Defaults.NETWORK_TOOLTIP_ENABLED),this._paintAll=!0,this._dirtyRects=new hn,this._invalidateMap={},this._invalidateAll=!0,e._count=0,e._invalidate=!0,function t(i){e._loopId=requestAnimationFrame(t),e._invalidate&&(e._count++,e._now=i,e.validate())}(0),De.imageUtil.addEventListener(this.invalidateElementUIs,this)},Me.ext("twaver.vector.Network",De.controls.View,{__accessor:["selectMode","makeVisibleOnSelected","movableFunction","editPointSize","editPointFillColor","scrollBarWidth","editPointOutlineWidth","editPointOutlineColor","editLineColor","editLineWidth","resizePointSize","resizePointFillColor","resizePointOutlineWidth","resizePointOutlineColor","resizeLineColor","resizeLineWidth","rotatePointSize","rotatePointFillColor","rotatePointOffset","rotatePointOutlineWidth","rotatePointOutlineColor","rotateScaleFillColor","rotateScaleFontColor","rotateScaleWidth","rotateScaleHeight","selectOutlineColor","selectOutlineWidth","selectFillColor","lazyMoveOutlineColor","lazyMoveOutlineWidth","lazyMoveFillColor","rectSelectFilter","selectionTolerance"],__bool:["doubleClickToUpSubNetwork","doubleClickToSubNetwork","doubleClickToEmptySubNetwork","doubleClickToLinkBundle","doubleClickToGroupExpand","scrollBarVisible","limitViewInCanvas","autoValidateCanvasSize","subNetworkAnimate","lazyMoveAnimate","resizeAnimate","noAgentLinkVisible","keyboardRemoveEnabled","keyboardSelectEnabled","sendToTopOnSelected","lazyMoveFill","editingElement","rotatingElement","movingElement","selectingElement","rectSelectEnabled","limitElementInPositiveLocation","showRotateScale","transparentSelectionEnable","edgeDetect","dragToPan","wheelToZoom","asyncZoomAndViewRect","debug","zoomDivVisible","showShadowInEdit","showAttachOnChg"],_currentSubNetwork:null,_subNetworkAnimate:De.Defaults.NETWORK_SUBNETWORK_ANIMATE,_scrollBarWidth:10,_scrollBarVisible:!0,_limitViewInCanvas:!1,_autoValidateCanvasSize:!0,_makeVisibleOnSelected:De.Defaults.NETWORK_MAKE_VISIBLE_ON_SELECTED,_keyboardRemoveEnabled:De.Defaults.NETWORK_KEYBOARD_REMOVE_ENABLED,_keyboardSelectEnabled:De.Defaults.NETWORK_KEYBOARD_SELECT_ENABLED,_rectSelectEnabled:kn.NETWORK_RECT_SELECT_ENABLED,_rectSelectFilter:null,_elementUIFunction:De.Defaults.VECTORUI_FUNCTION,_doubleClickToUpSubNetwork:De.Defaults.NETWORK_DOUBLECLICK_TO_UPSUBNETWORK,_doubleClickToSubNetwork:De.Defaults.NETWORK_DOUBLECLICK_TO_SUBNETWORK,_doubleClickToEmptySubNetwork:De.Defaults.NETWORK_DOUBLECLICK_TO_EMPTYSUBNETWORK,_doubleClickToLinkBundle:De.Defaults.NETWORK_DOUBLECLICK_TO_LINKBUNDLE,_doubleClickToGroupExpand:De.Defaults.NETWORK_DOUBLECLICK_TO_GROUPEXPAND,_selectOutlineColor:De.Defaults.NETWORK_SELECT_OUTLINE_COLOR,_selectOutlineWidth:De.Defaults.NETWORK_SELECT_OUTLINE_WIDTH,_selectFillColor:De.Defaults.NETWORK_SELECT_FILL_COLOR,_sendToTopOnSelected:De.Defaults.NETWORK_SENDTOTOP_ON_SELECTED,_lazyMoveOutlineColor:De.Defaults.NETWORK_LAZYMOVE_OUTLINE_COLOR,_lazyMoveOutlineWidth:De.Defaults.NETWORK_LAZYMOVE_OUTLINE_WIDTH,_lazyMoveFillColor:De.Defaults.NETWORK_LAZYMOVE_FILL_COLOR,_lazyMoveFill:De.Defaults.NETWORK_LAZYMOVE_FILL,_lazyMoveAnimate:De.Defaults.NETWORK_LAZYMOVE_ANIMATE,_resizePointSize:De.Defaults.NETWORK_RESIZE_POINT_SIZE,_resizePointFillColor:De.Defaults.NETWORK_RESIZE_POINT_FILL_COLOR,_resizePointOutlineColor:De.Defaults.NETWORK_RESIZE_POINT_OUTLINE_COLOR,_resizePointOutlineWidth:De.Defaults.NETWORK_RESIZE_POINT_OUTLINE_WIDTH,_resizeLineColor:De.Defaults.NETWORK_RESIZE_LINE_COLOR,_resizeLineWidth:De.Defaults.NETWORK_RESIZE_LINE_WIDTH,_resizeAnimate:De.Defaults.NETWORK_RESIZE_ANIMATE,_rotatePointSize:De.Defaults.NETWORK_ROTATE_POINT_SIZE,_rotatePointFillColor:De.Defaults.NETWORK_ROTATE_POINT_FILL_COLOR,_rotatePointOffset:De.Defaults.NETWORK_ROTATE_POINT_OFFSET,_rotatePointOutlineWidth:De.Defaults.NETWORK_ROTATE_POINT_OUTLINE_WIDTH,_rotatePointOutlineColor:De.Defaults.NETWORK_ROTATE_POINT_OUTLINE_COLOR,_rotateScaleWidth:kn.NETWORK_ROTATE_SCALE_WIDTH,_rotateScaleHeight:kn.NETWORK_ROTATE_SCALE_HEIGHT,_rotateScaleFillColor:kn.NETWORK_ROTATE_SCALE_FILL_COLOR,_rotateScaleFontColor:kn.NETWORK_ROTATE_SCALE_FONT_COLOR,_editPointSize:De.Defaults.NETWORK_EDIT_POINT_SIZE,_editPointFillColor:De.Defaults.NETWORK_EDIT_POINT_FILL_COLOR,_editPointOutlineColor:De.Defaults.NETWORK_EDIT_POINT_OUTLINE_COLOR,_editPointOutlineWidth:De.Defaults.NETWORK_EDIT_POINT_OUTLINE_WIDTH,_editLineColor:De.Defaults.NETWORK_EDIT_LINE_COLOR,_editLineWidth:De.Defaults.NETWORK_EDIT_LINE_WIDTH,_limitElementInPositiveLocation:!1,_linkFlowInterval:kn.NETWORK_LINK_FLOW_INTERVAL,_selectionTolerance:kn.NETWORK_SELECTION_TOLERANCE,_invalidateViewRectFlag:!1,_repaintTopFlag:!1,_invalidateCanvasSizeFlag:!1,_isEditingElement:!1,_isRotatingElement:!1,_isMovingElement:!1,_isSelectingElement:!1,_hasEditInteraction:!1,_showRotateScale:!0,_transparentSelectionEnable:De.Defaults.NETWORK_TRANSPARENT_SELECTION_ENABLE,_edgeDetect:!1,_dragToPan:!0,_wheelToZoom:!0,_asyncZoomAndViewRect:!1,_debug:!1,_zoomDivVisible:!0,_showShadowInEdit:!1,_showAttachOnChg:!0,adjustBounds:function(t){var e=!1,i=this._view.style;if(i.left==t.x+"px"&&i.top==t.y+"px"&&i.width==t.width+"px"&&i.height==t.height+"px"&&(e=!0),De.vector.Network.superClass.adjustBounds.apply(this,arguments),1!=e){var n=this._view.offsetWidth,o=this._view.offsetHeight;this._rootCanvas.setAttribute("width",n),this._rootCanvas.setAttribute("height",o),this._topCanvas.setAttribute("width",n),this._topCanvas.setAttribute("height",o),this.setViewRect(this.viewRect.x,this.viewRect.y,n,o),void 0===De.gis&&(De.Util.makeHighRes(this._rootCanvas),De.Util.makeHighRes(this._topCanvas)),this.invalidateElementVisibility()}},getLabel:function(t){return t.getStyle("network.label")||t.getName()},getLabel2:function(t){return t.getStyle("network.label")||t.getName2()},setZoomManager:function(t){var e=this.zoomManager;e!=t&&(this.zoomManager=t,this.invalidateElementVisibility(),this.invalidateCanvasSize(),this.validateCanvasSize(),this.invalidateElementUIs(),this.firePropertyChange("zoomManager",e,t))},getZoomManager:function(){return this.zoomManager},getRootCanvas:function(){return this._rootCanvas},getTopCanvas:function(){return this._topCanvas},validateImpl:function(){ci.twm(this);var t,e,i,n,o=this.getElementBox().getDatas()._as,r=o.length,a={},s=this._visibleFunction,l=1===this._box._layerBox.size()?this._box._layerBox._defaultLayer:null;for(t=0;r>t;t++)i=o[t],a[i._id]=this.isVisible(i,s,l);var h=this.getGraphicsZoom(),c=null,u={x:this.viewRect.x/h,y:this.viewRect.y/h,width:this.viewRect.width/h,height:this.viewRect.height/h};if(this._invalidateAll){if(this._visibleMap)for(t=0;r>t;t++)i=o[t],a[i._id]!==this._visibleMap[i._id]&&(n=this._elementUIMap[i._id])&&n.invalidate();for(t=0;r>t;t++)i=o[t],(n=this._elementUIMap[i._id])&&n.validate();this._paintAll=!0}else if(this._paintAll){for(e in this._invalidateMap)(n=this._elementUIMap[e])&&n.invalidate();for(e in this._invalidateMap)(n=this._elementUIMap[e])&&n.validate()}else{for(e in this._invalidateMap)(n=this._elementUIMap[e])&&(this._dirtyRects.add(n.getZoomViewRect(!1)),n.invalidate());for(e in this._invalidateMap)(n=this._elementUIMap[e])&&(n.validate(),this._dirtyRects.add(n.getZoomViewRect(!0)))}this._paintAll?c=u:(this._dirtyRects.forEach(function(t){c=null==c?Me.cloneRect(t):We.unionRect(c,t)}),c?(We.grow(c,2,2),c=We.intersection(c,u)):c=u),this._visibleMap=a,c&&this.paintRoot(c),this.validateCanvasSize(),1==this._repaintTopFlag&&(this._repaintTopFlag=!1,this.paintTopCanvas())},isLinkFlowEnabled:function(){return!!this._linkFlowEnabled},setLinkFlowEnabled:function(t){t?(this._linkFlowEnabled||(this._linkFlowEnabled=!0,this.firePropertyChange("linkFlowEnabled",!1,!0)),clearInterval(this._linkFlowTimerId),this._linkFlowTimerId=setInterval(this._flowLink,this._linkFlowInterval)):(this._linkFlowEnabled&&(this._linkFlowEnabled=!1,this.firePropertyChange("linkFlowEnabled",!0,!1)),clearInterval(this._linkFlowTimerId),delete this._linkFlowTimerId)},getLinkFlowInterval:function(){return this._linkFlowInterval},setLinkFlowInterval:function(t){var e=this._linkFlowInterval;this._linkFlowInterval=t,this.firePropertyChange("linkFlowInterval",e,t),clearInterval(this._linkFlowTimerId),this.isLinkFlowEnabled()&&(this._linkFlowTimerId=setInterval(this._flowLink,this._linkFlowInterval))},getElementBox:function(){return this._box},setElementBox:function(t){if(!t)throw"ElementBox can not be null";if(this._box!==t){var e=this._box;e&&(e.removeDataBoxChangeListener(this.handleElementBoxChange,this),e.removeDataPropertyChangeListener(this.handleElementPropertyChange,this),e.removePropertyChangeListener(this.handleElementBoxPropertyChange,this),e.removeIndexChangeListener(this.handleIndexChange,this),e.getLayerBox().removeDataBoxChangeListener(this.handleLayerBoxChange,this),e.getLayerBox().removeDataPropertyChangeListener(this.handleLayerPropertyChange,this),e.getLayerBox().removeHierarchyChangeListener(this.handleLayerHierarchyChange,this),this._selectionModel||e.getSelectionModel().removeSelectionChangeListener(this.handleSelectionChange,this)),this._box=t,this._box.addDataBoxChangeListener(this.handleElementBoxChange,this),this._box.addDataPropertyChangeListener(this.handleElementPropertyChange,this),this._box.addPropertyChangeListener(this.handleElementBoxPropertyChange,this),this._box.addIndexChangeListener(this.handleIndexChange,this),this._box.getLayerBox().addDataBoxChangeListener(this.handleLayerBoxChange,this),this._box.getLayerBox().addDataPropertyChangeListener(this.handleLayerPropertyChange,this),this._box.getLayerBox().addHierarchyChangeListener(this.handleLayerHierarchyChange,this),this._flowLinkQuickFinder&&(this._flowLinkQuickFinder.dispose(),this._flowLinkQuickFinder=new De.QuickFinder(this._box,"link.flow","style")),this._selectionModel?this._selectionModel._setDataBox(t):this._box.getSelectionModel().addSelectionChangeListener(this.handleSelectionChange,this),this._elementUIMap={},this._box.forEach(this.createElementUI,this),this.invalidateElementVisibility(),this.invalidateCanvasSize(),this.firePropertyChange("elementBox",e,this._box)}},handleElementBoxChange:function(t){var e=t.data;if("add"===t.kind)this.createElementUI(e),this.invalidateBundleLink(e);else if("remove"===t.kind){var i=this.getElementUI(e);i&&(this._dirtyRects.add(i.getZoomViewRect()),i.dispose(),delete this._elementUIMap[e.getId()]),e===this._currentSubNetwork&&null!=this._currentSubNetwork&&this._setCurrentSubNetwork(null),delete this._invalidateMap[e._id]}else if("clear"===t.kind){for(var n in this._elementUIMap)this._elementUIMap[n]&&this._elementUIMap[n].dispose&&this._elementUIMap[n].dispose();this._elementUIMap={},null!=this._currentSubNetwork&&this._setCurrentSubNetwork(null),this._paintAll=!0}else"layoutEnd"===t.kind?this.state.layouting=!1:"layouting"===t.kind&&(this.state.layouting=!0);this.invalidateElementVisibility(),this.invalidateCanvasSize()},handleElementPropertyChange:function(t){var e=t.source,i=this.getElementUI(e);i&&(this.invalidateElementUI(e),i.handlePropertyChange(t)),this.invalidateBundleLink(e),this.invalidateElementVisibility(),this.invalidateCanvasSize()},handleElementBoxPropertyChange:function(){this.invalidateElementVisibility()},handleIndexChange:function(t){this.invalidateElementVisibility()},handleLayerBoxChange:function(){this.invalidateElementVisibility()},handleLayerPropertyChange:function(t){"editable"===t.property&&this.invalidateSelectedElementUIs(!0),this.invalidateElementVisibility()},handleLayerHierarchyChange:function(){this.invalidateElementVisibility()},handleSelectionChange:function(t){var e=this.getSelectionModel().getLastData();e&&("append"===t.kind||"set"===t.kind)&&(this.isMakeVisibleOnSelected()&&this.makeVisible(e),this.isSendToTopOnSelected()&&this.sendToTop(e)),t.datas.forEach(function(e){var i=this.getElementUI(e);i&&i.handleSelectionChange(t),this.invalidateElementUI(e)},this),this.invalidateElementVisibility()},sendToTop:function(t){if(this._box.contains(t)){for(var e=t;e._parent&&this.isVisible(e._parent)&&(e=e._parent););e!==t&&this._box.adjustElementIndex(e),this._box.adjustElementIndex(t)}},getScopeRect:function(t){var e=this.getGraphicsZoom();if(this.zoomManager,"viewsize"===t)return{x:this._unionBounds.x-this.viewRect.x,y:this._unionBounds.y-this.viewRect.y,width:this._unionBounds.width,height:this._unionBounds.height};if("viewport"===t){if(this.viewRect)return Me.cloneRect(this.viewRect)}else if("rootcanvas"===t)return{x:this.viewRect.x,y:this.viewRect.y,width:(Math.abs(this.viewRect.x-this._unionBounds.x)+this._unionBounds.width)*e,height:(Math.abs(this.viewRect.y-this._unionBounds.y)+this._unionBounds.height)*e};return{x:0,y:0,width:0,height:0}},getViewRect:function(){return this.viewRect?Me.cloneRect(this.viewRect):{x:0,y:0,width:0,height:0}},getCanvasSize:function(){return{width:this.realWidth,height:this.realHeight}},setViewOffSet:function(t,e){var i=this.viewRect.x,n=this.viewRect.y,o=this.viewRect.width,r=this.viewRect.height;this.setViewRect(i+t,n+e,o,r)},setViewRect:function(t,e,i,n){1==this.isLimitViewInCanvas()&&(0>t&&(t=0),i>this.realWidth?t=0:t+i>this.realWidth&&(t=this.realWidth-i),0>e&&(e=0),n>this.realHeight?e=0:e+n>this.realHeight&&(e=this.realHeight-n));var o=this.viewRect;(null==this.viewRect||t!=this.viewRect.x||e!=this.viewRect.y||i!=this.viewRect.width||n!=this.viewRect.height)&&(this.viewRect={x:t,y:e,width:i,height:n},this.firePropertyChange("viewRect",o,this.viewRect),this.invalidateElementVisibility(),this._paintAll=!0)},isHScrollBarVisible:function(){return this.hScrollBarVisible},setHScrollBarVisible:function(t){this.hScrollBarVisible=t},isVScrollBarVisible:function(){return this.vScrollBarVisible},setVScrollBarVisible:function(t){this.vScrollBarVisible=t},setZoomVisibilityThresholds:function(t){var e=this._visibilityThresholds;this._zoomVisibilityThresholds=t,this.firePropertyChange("zoomVisibilityThresholds",e,t),this.invalidateElementVisibility()},getZoomVisibilityThresholds:function(){return this._zoomVisibilityThresholds||{}},invalidateElementVisibility:function(){this.invalidate()},repaintTopCanvas:function(){this._repaintTopFlag||(this._repaintTopFlag=!0,this.invalidate())},invalidateCanvasSize:function(t){this._invalidateCanvasSizeFlag||(this._invalidateCanvasSizeFlag=!0,this.invalidate())},validateCanvasSize:function(){0!=this._invalidateCanvasSizeFlag&&(this._invalidateCanvasSizeFlag=!1,this._validateCanvasSize())},_validateCanvasSize:function(){if(0==this.isAutoValidateCanvasSize())return this.realWidth=0,this.realHeight=0,void(this._unionBounds={x:0,y:0,width:0,height:0});var t,e=this.getElementBox().getDatas(),i=e.size();if(i>0){for(var n=0;i>n;n++){var o=e.get(n);if(this._visibleMap[o._id]){var r=this._elementUIMap[o._id];r&&(t=t?We.unionRect(t,r.getZoomViewRect(!0)):Me.cloneRect(r.getZoomViewRect(!0)))}}null==t&&(t={x:0,y:0,width:0,height:0});var a=this.getGraphicsZoom();if(this.realWidth==(t.x+t.width)*a&&this.realHeight==(t.y+t.height)*a)return;this.realWidth=(t.x+t.width)*a,this.realHeight=(t.y+t.height)*a,this._unionBounds={x:t.x*a,y:t.y*a,width:t.width*a,height:t.height*a}}else this.realWidth=0,this.realHeight=0,this._unionBounds={x:0,y:0,width:0,height:0};this.setViewRect(this.viewRect.x,this.viewRect.y,this.viewRect.width,this.viewRect.height),this.firePropertyChange("canvasSizeChange",null,this.viewRect)},getElementUI:function(t){return null==t?null:this._elementUIMap[t._id]},getUnionBounds:function(){return this._unionBounds},getZoomBodyRect:function(t){var e=this.getElementUI(t);return e?e.getZoomBodyRect():null},getShapeNodeZoomPoints:function(t,e){if(t._points){var i=this.getElementUI(t);if(i)return i._getZoomPoints()}return null},createElementUI:function(t){var e=this._elementUIMap[t.getId()];if(!e){if(!(e=this._elementUIFunction(this,t))){var i=t.getClassName(),n=i.substr(i.indexOf(".")+1)+"UI",o=De.vector[n];o&&(e=new o(this,t))}e&&(this._elementUIMap[t.getId()]=e)}return this._invalidateMap&&(this._invalidateMap[t._id]=t),e},getElementUIFunction:function(){return this._elementUIFunction},setElementUIFunction:function(t){if(!t)throw"ElementUIFunction can not be null";if(this._elementUIFunction!==t){var e=this._elementUIFunction;this._elementUIFunction=t,this.firePropertyChange("elementUIFunction",e,t),this._box.isEmpty()||(this._elementUIMap={},this._box.forEach(this.createElementUI,this),this.invalidateElementVisibility(),this.invalidateCanvasSize())}},invalidateElementUI:function(t,e){if(!this._invalidateAll){if(this._invalidateMap[t._id]=t,this.getElementUI(t),t instanceof On){var i=t.getAgentLinks();null!=i&&i.forEach(this.invalidateElementUI,this);var n=t.getParent();n instanceof De.Group&&this.invalidateElementUI(n)}this.invalidateElementVisibility()}},invalidateElementUIs:function(t){this._invalidateAll=!0,this._invalidateMap={},this._visibleMap={},this.invalidateElementVisibility(),this.invalidateCanvasSize(),this.invalidate()},invalidateSelectedElementUIs:function(t){this.getSelectionModel().getSelection().forEach(function(e){this.invalidateElementUI(e,t)},this)},invalidateBundleLink:function(t){if(t instanceof De.Link&&t._bundleLinks){var e=this._elementUIMap;t._bundleLinks.forEachSiblingLink(function(i){if(i!==t){var n=e[i._id];n&&n.invalidate(!1)}},this)}},paintRoot:function(t){var i=this._rootCanvas.getContext("2d");i.save();var n=this.getGraphicsZoom();i.beginPath(),i.rect(Math.round(t.x*n-this.viewRect.x),Math.round(t.y*n-this.viewRect.y),Math.round(t.width*n),Math.round(t.height*n)),i.clip(),i.clearRect(Math.round(t.x*n-this.viewRect.x),Math.round(t.y*n-this.viewRect.y),Math.round(t.width*n),Math.round(t.height*n)),this.visibleList=new De.List,this._topAttachmentList=new De.List,sn.draw(i,this);var o=this.getElementBox().getDatas()._as,r=o.length;this.zoomManager._zoomGraphicsBegin(i),this.paintBottom(i,t);var a,s,l,h,c=this._box._layerBox,n=this.getGraphicsZoom(),u={x:this.viewRect.x/n,y:this.viewRect.y/n,width:this.viewRect.width/n,height:this.viewRect.height/n};if(this.adjustLinkIndex(),1===c.size())for(a=0;r>a;a++)s=o[a],this._visibleMap[s._id]?(l=this._elementUIMap[s._id],this._debug&&Ye.strokeRect(i,t,"red"),null!=l&&this._isInView(l,t)&&(l.paint(i),l.setAttachmentVisible&&l.setAttachmentVisible(!0)),null!=l&&We.intersects(u,l.getZoomViewRect())?l.setAttachmentVisible&&l.setAttachmentVisible(!0):l.setAttachmentVisible&&l.setAttachmentVisible(!1),this.visibleList.add(s)):(l=this._elementUIMap[s._id])&&l.setAttachmentVisible&&l.setAttachmentVisible(!1);else c.forEachByDepthFirst(function(e){for(a=0;r>a;a++)s=o[a],c.getLayerByElement(s)===e&&this._visibleMap[s._id]?(l=this._elementUIMap[s._id],null!=l&&this._isInView(l,t)&&(l.paint(i),l.setAttachmentVisible&&l.setAttachmentVisible(!0)),null!=l&&We.intersects(u,l.getZoomViewRect())?l.setAttachmentVisible&&l.setAttachmentVisible(!0):l.setAttachmentVisible&&l.setAttachmentVisible(!1),l&&l.validateZIndex&&l.validateZIndex(c.getDatas().indexOf(e)),this.visibleList.add(s)):l=this._elementUIMap[s._id]},null,this);for(r=this._topAttachmentList.size(),a=0;r>a;a++)h=this._topAttachmentList.get(a),h.getElementUI().paintAttachment(i,h);if(this.paintTop(i,t),this._xyz!==e){var r,d=this._xyz,f=d.markText,p=d.type,g=(d.expired,d.innerHTML),_=0,m=0,v=this.viewRect;i.translate(this.viewRect.x/this.getZoom(),this.viewRect.y/this.getZoom()),i.scale(1/this.getZoom(),1/this.getZoom());var n=this.getZoom();f!=e&&null!=f&&""!=f||"2"==p?(i.font="15px Arial sans-serif",r=Me.g.getTextSize(i.font,g),i.fillStyle="red",_=v.width-r.width,m=v.height-20):(i.font="10px Arial sans-serif",r=Me.g.getTextSize(i.font,g),_=v.width/2-r.width/2,m=v.height/2),i.fillText(g,_,m)}i.restore(),this._invalidateMap={},this._invalidateAll=!1,this._paintAll=!1,this._dirtyRects=new hn},adjustLinkIndex:function(){var t,e,n=this._box.getDatas()._as;if(this.hasEditInteraction()){for(i=0;i<n.length;i++)if((t=n[i])instanceof De.Link)if(this.isEditable(t)&&this.getElementUI(t).isEditable()&&this.isSelected(t))e=this._box.getDatas().indexOf(t),this._box.getDatas().removeAt(e),this._box.getDatas().add(t);else{var o=t.getToNode();e=this._box.getDatas().indexOf(o),this._box.getDatas().removeAt(e),this._box.getDatas().add(o);var r=t.getFromNode();e=this._box.getDatas().indexOf(r),this._box.getDatas().removeAt(e),this._box.getDatas().add(r)}}else for(i=0;i<n.length;i++)if((t=n[i])instanceof De.Link){var o=t.getToNode();e=this._box.getDatas().indexOf(o),this._box.getDatas().removeAt(e),this._box.getDatas().add(o);var r=t.getFromNode();e=this._box.getDatas().indexOf(r),this._box.getDatas().removeAt(e),this._box.getDatas().add(r)}},paintBottom:function(t,e){},paintTop:function(t,e){},_isInView:function(t,e){return We.intersects(e,t.getZoomViewRect())},paintTopCanvas:function(){var t=this._topCanvas.getContext("2d");t.clearRect(0,0,this._topCanvas.width,this._topCanvas.height),this.paintMarker(t)},paintMarker:function(t){for(var e=this.markerList.size(),i=0;e>i;i++){this.markerList.get(i).paint(t)}},getLayerByElement:function(t){return this._box.getLayerBox().getLayerByElement(t)},getLogicalPoint2:function(t){return this.zoomManager._getLogicalPoint(t)},getLogicalPoint:function(t){return this.zoomManager._getLogicalPoint(t,!0)},getElementAt:function(t){if(null==this.visibleList)return null;var e;if(t.target?e=this.getLogicalPoint2(t):t.event?t.event.target&&(e=this.getLogicalPoint2(t.event)):e=t,null!=this._hitTestTopAttachmentList)for(var i=this._hitTestTopAttachmentList.size(),n=i-1;n>=0;n--){var o=this._hitTestTopAttachmentList.get(n);if(o.hit(e.x,e.y))return o.getElement()}if(null!=this.visibleList)for(var r=this.visibleList.size(),a=r-1;a>=0;a--){var s=this.visibleList.get(a),l=this.getElementUI(s);if(l&&l.hit(e.x,e.y))return s}return null},hitTest:function(t){var e=this.getElementAt(t);if(!e)return null;var i=this.getElementUI(e);if(!i)return null;var n;return n=t.target?this.getLogicalPoint2(t):t.event?this.getLogicalPoint2(t.event):t,i.hitTest(n.x,n.y)},getElementsAtRect:function(t,i,n,o){var r=new De.List;if(null==this.visibleList)return r;o=o===e||o;for(var a=this.visibleList.size(),s=a-1;s>=0;s--){var l=this.visibleList.get(s),h=this.getElementUI(l);h&&(!n||n(h._element))&&(o&&this.isSelectable(h._element)||!o)&&(i?h.intersects(t)&&r.add(l):We.contains(t,h.getZoomViewRect(si))&&r.add(l))}return r},getPosition:function(t,e,i,n,o,r){var a,s=e instanceof De.vector.ElementUI?e:this.getElementUI(e);if(s)if("from"===t||"to"===t){if(s.getFromPosition&&(a="from"===t?s.getFromPosition(n,o):s.getToPosition(n,o)))return i?{x:a.x-i.width/2,y:a.y-i.height/2}:a}else a="hotspot"===t?r?s.getZoomHotSpot(this.zoomManager):s.getHotSpot():Ze.get(t,r?s.getZoomBodyRect():s.getBodyRect(),i);if(!a&&e.getRect&&(a=Ze.get(t,e.getRect(),i)),a)return{x:a.x+n,y:a.y+o};throw"position '"+t+"' object '"+e+"'"},isValidEvent:function(t){if(!t)return!1;var e,i;if(t.currentTarget===this._view){if(Ue.isFirefox?(e=t.layerX,i=t.layerY):(e=t.offsetX,i=t.offsetY),1==this.isHScrollBarVisible()&&i>=this.viewRect.height-this.getScrollBarWidth())return!1;if(1==this.isVScrollBarVisible()&&e>=this.viewRect.width-this.getScrollBarWidth())return!1}return!0},addMarker:function(t){this.markerList.add(t),this.repaintTopCanvas()},removeMarker:function(t){this.markerList.remove(t),this.repaintTopCanvas()},clearMarker:function(){this.markerList.clear(),this.repaintTopCanvas()},isMovable:function(t){return!(!this._box.contains(t)||!t.isMovable())&&(!(t instanceof De.Link)&&(!(this._movableFunction&&!this._movableFunction(t))&&this.getLayerByElement(t).isMovable()))},hasMovableSelectedElements:function(){for(var t=this.getSelectionModel().getSelection(),e=0;e<t.size();e++){var i=t.get(e);if(this.isMovable(i))return!0}return!1},getMovableSelectedElements:function(){return this.getSelectionModel().toSelection(function(t){return this.isMovable(t)},this)},moveSelectedElements:function(t,e,i,n){if(0!==t||0!==e){var o=this.getMovableSelectedElementsRect();null!=o&&(this._limitElementInPositiveLocation&&(o.x+t<0&&(t=-o.x),o.y+e<0&&(e=-o.y)),De.Util.moveElements(this.getMovableSelectedElements(),t,e,i,n,this))}},getMovableSelectedElementsRect:function(){var t=this.getMovableSelectedElements();if(0===t.size())return null;for(var e=null,i=0,n=t.size();n>i;i++){var o=t.get(i);if(o instanceof On){var r=this.getElementUI(o);r&&(e=We.unionRect(e,r.getViewRect()))}}return e},isVisibleAttachment:function(t){return!this.state.zooming&&!this.state.panning&&!this.state.layouting},isVisible:function(t,e,i){if(!this._box.contains(t))return!1;if(!t.isVisible())return!1;if(3!==arguments.length&&(e=this._visibleFunction),e&&!e(t))return!1;if(!(i||this._box._layerBox.getLayerByElement(t))._visible)return!1;if(_i.getSubNetwork(t)!==this._currentSubNetwork)return!1;if(!this.zoomManager.isElementVisible(t))return!1;if(t instanceof De.Link){if(!this._noAgentLinkVisible){if(!t._fromAgent||!t._toAgent)return!1;if(!this.isVisible(t._fromAgent,e,i)||!this.isVisible(t._toAgent,e,i))return!1}if(t.getBundleIndex()>0&&t.getBundleCount()>1&&!t.getStyle("link.bundle.expanded"))return!1}else for(var n=t._parent;n&&!n.ISubNetwork;){if(n instanceof De.Group&&(!n.isExpanded()||!this.isVisible(n,e,i)))return!1;n=n._parent}return!t.IDummy},getVisibleFunction:function(){return this._visibleFunction},setVisibleFunction:function(t){var e=this._visibleFunction;this._visibleFunction=t,this.firePropertyChange("visibleFunction",e,t),this.invalidateElementVisibility()},isEditable:function(t){return!!this._box.contains(t)&&(!(this._editableFunction&&!this._editableFunction(t))&&this.getLayerByElement(t).isEditable())},getEditableFunction:function(){return this._editableFunction},setEditableFunction:function(t){var e=this._editableFunction;this._editableFunction=t,this.firePropertyChange("editableFunction",e,t),this.invalidateSelectedElementUIs(!0)},isRotatable:function(t){return!(this._rotatableFunction&&!this._rotatableFunction(t))},getRotatableFunction:function(){return this._rotatableFunction},setRotatableFunction:function(t){var e=this._rotatableFunction;this._rotatableFunction=t,this.firePropertyChange("rotatableFunction",e,t),this.invalidateSelectedElementUIs(!0)},isLinkable:function(t,e){return null==this._linkableFunction||this._linkableFunction(t,e)},getLinkableFunction:function(){return this._linkableFunction},setLinkableFunction:function(t){var e=this._linkableFunction;this._linkableFunction=t,this.firePropertyChange("linkableFunction",e,t),this.invalidateSelectedElementUIs(!0)},onShareSelectionModelChanged:function(){this.invalidateElementUIs()},getShadowColor:function(t){var e=t.getStyle("shadow.color");return!e&&this.isSelected(t)&&"shadow"===t.getStyle("select.style")?t.getStyle("select.color"):e},getSelectColor:function(t){return t.getStyle("select.color")},getAlarmLabel:function(t){var e=t.getAlarmState().getHighestNewAlarmSeverity();if(e){var i=t.getAlarmState().getNewAlarmCount(e)+e.nickName;return t.getAlarmState().hasLessSevereNewAlarms()&&(i+="+"),i}return null},getLinkHandlerLabel:function(t){return t.isBundleAgent()?"+("+t.getBundleCount()+")":null},setInteractions:function(t){var e=this._interactions;e&&e.forEach(function(t){t.tearDown()}),this._interactions=t,t&&t.forEach(function(t){t.setUp()}),this.invalidateSelectedElementUIs(!0),this.firePropertyChange("interactions",e,t)},getInteractions:function(){return this._interactions},setDefaultInteractions:function(t){this.setInteractions([new De.vector.interaction.DefaultInteraction(this,t)])},setTouchInteractions:function(){this.setInteractions([new De.vector.interaction.DefaultInteraction(this,!1),new De.vector.interaction.TouchInteraction(this)])},setMSTouchInteractions:function(){this.setInteractions([new De.vector.interaction.MSTouchInteraction(this)])},setEditInteractions:function(t){this.setInteractions([new De.vector.interaction.EditInteraction(this,t),new De.vector.interaction.DefaultInteraction(this)])},setCreateElementInteractions:function(t){this.setInteractions([new De.vector.interaction.CreateElementInteraction(this,t),new De.vector.interaction.DefaultInteraction(this)])},setCreateLinkInteractions:function(t){this.setInteractions([new De.vector.interaction.CreateLinkInteraction(this,t),new De.vector.interaction.DefaultInteraction(this)])},setCreateShapeLinkInteractions:function(t){this.setInteractions([new De.vector.interaction.CreateShapeLinkInteraction(this,t),new De.vector.interaction.DefaultInteraction(this)])},setCreateShapeNodeInteractions:function(t){this.setInteractions([new De.vector.interaction.CreateShapeNodeInteraction(this,t),new De.vector.interaction.DefaultInteraction(this)])},setMagnifyInteractions:function(){this.setInteractions([new De.vector.interaction.DefaultInteraction(this),new De.vector.interaction.MagnifyInteraction(this)])},hasEditInteraction:function(){return this._hasEditInteraction},setHasEditInteraction:function(t){var e=this._hasEditInteraction;this._hasEditInteraction=t,this.firePropertyChange("hasEditInteraction",e,t)},addElementByInteraction:function(t){t.getParent()||t.setParent(this._currentSubNetwork),this._box.add(t),this.getSelectionModel().setSelection(t),this.fireInteractionEvent({kind:"createElement",element:t})},getToolTip:function(t){if(t){var e=t.getToolTip();return e||t.getName()}return null},isToolTipEnabled:function(){return!!this._toolTipEnabled},setToolTipEnabled:function(t){if(this._toolTipEnabled=t,t){if(!this._toolTipListener){var e=this;this._toolTipListener=function(t){if(e.isMovingElement())return void xi.hideToolTip();var i=e.getElementAt(t);if(e._preElement!==i)if(e._preElement=i,i){var n=e.getToolTip(i);xi.showToolTip({x:t.pageX,y:t.pageY},n);var o=xi.getToolTipDiv();if(o.children.length>0){var r=e._view.getBoundingClientRect(),a=o.getBoundingClientRect();a.width+a.left>r.width+r.left&&(o.style.left=r.width+r.left-a.width+(ze.documentElement.scrollLeft||ze.body.scrollLeft)+"px"),a.height+a.top>r.height+r.top&&(o.style.top=r.height+r.top-a.height+(ze.documentElement.scrollTop||ze.body.scrollTop)+"px")}}else xi.hideToolTip()},this._view.addEventListener("mousemove",this._toolTipListener,!1),this.firePropertyChange("toolTipEnabled",!1,!0)}}else this._toolTipListener&&(xi.hideToolTip(),this._view.removeEventListener("mousemove",this._toolTipListener,!1),delete this._toolTipListener,this.firePropertyChange("toolTipEnabled",!0,!1))},setZoom:function(t,e){if(t=this.checkZoom(t),this.isAsyncZoomAndViewRect())var i=this._zoomMap[this._currentSubNetwork].zoom;else var i=this._zoom;if(t!=i){var n=this.getViewRect();e||(e={x:n.width/2,y:n.height/2});var o=this.viewRect,r=e.x-(e.x+o.x)*t/i,a=e.y-(e.y+o.y)*t/i;this.isAsyncZoomAndViewRect()?this._zoomMap[this._currentSubNetwork].zoom=t:this._zoom=t,this._paintAll=!0,this.invalidateElementVisibility(),this.invalidateCanvasSize(),this.zoomManager._invalidateZoom(),this.setViewRect(-r,-a,this.viewRect.width,this.viewRect.height),this._asyncZoomAndViewRect?this.firePropertyChange("zoom",i,this._zoomMap[this._currentSubNetwork].zoom):this.firePropertyChange("zoom",i,this._zoom),this.state.zooming=!0;var s=null,l=this;s?clearTimeout(s):s=setTimeout(function(){s=null,l.state.zooming=!1,l.invalidateElementUIs(!0)},100)}},getZoom:function(){if(this.isAsyncZoomAndViewRect()){return this._zoomMap[this._currentSubNetwork]||(this._zoomMap[this._currentSubNetwork]={zoom:1}),this._zoomMap[this._currentSubNetwork].zoom}return this._zoom},getSizeZoom:function(t){return this.zoomManager.getSizeZoom(t)},getLocationZoom:function(){return this.zoomManager.getLocationZoom()},getGraphicsZoom:function(){return this.zoomManager.getGraphicsZoom()},zoomOverview:function(t){if(!(this._unionBounds.width<=0||this._unionBounds.width<=0)){var e=this.getZoom(),i=this._unionBounds,n=i.width/e,o=i.height/e,r=this.viewRect.width/n,a=this.viewRect.height/o,s=Math.min(r,a);this.setZoom(s);var l=this.getZoom(),h=this.viewRect.width/2-this._unionBounds.width/2*l/e,c=this.viewRect.height/2-this._unionBounds.height/2*l/e;if(this.setViewRect(this._unionBounds.x*l/e-h,this._unionBounds.y*l/e-c,this.viewRect.width,this.viewRect.height),1!=this.getLocationZoom()){var u=null==arguments[1]?5:arguments[1];if(u>0){u--;var d=this;setTimeout(function(){d.zoomOverview(t,u)},25)}}}},zoomReset:function(t){this.setZoom(1,t)},zoomIn:function(t){this.setZoom(1.2*this.getZoom(),t)},zoomOut:function(t){this.setZoom(this.getZoom()/1.2,t)},upSubNetwork:function(t,e){this._currentSubNetwork&&this.setCurrentSubNetwork(_i.getSubNetwork(this._currentSubNetwork),t,e)},getCurrentSubNetwork:function(){return this._currentSubNetwork},setCurrentSubNetwork:function(t,e,i){if(De.animate.AnimateManager.endAnimate(),e){if(this._currentSubNetwork===t)return;if(t&&!this._box.contains(t))throw t+" is not contained in this network's elementBox";var n=new De.animate.AnimateSubNetwork(this,t,i);De.animate.AnimateManager.start(n)}else this._setCurrentSubNetwork(t),i&&i()},_setCurrentSubNetwork:function(t){if(this._currentSubNetwork!==t){if(t&&!this._box.contains(t))throw t+" is not contained in this network's elementBox";if(this.isAsyncZoomAndViewRect()){var e=this._viewRectMap[this._currentSubNetwork];this._viewRectMap[this._currentSubNetwork]=e?this.viewRect:this.viewRect?this.viewRect:{x:0,y:0,width:this.viewRect.width,height:this.viewRect.height}}var i=this._currentSubNetwork;if(this._currentSubNetwork=t,this.firePropertyChange("currentSubNetwork",i,t),this.isAsyncZoomAndViewRect()){this._viewRectMap[this._currentSubNetwork]||(this._viewRectMap[this._currentSubNetwork]={x:0,y:0,width:this.viewRect.width,height:this.viewRect.height});var e=this._viewRectMap[this._currentSubNetwork];this.setViewRect(e.x,e.y,e.width,e.height),this.invalidateElementUIs()}this.invalidateElementVisibility(),this.invalidateCanvasSize(),this._paintAll=!0}},makeVisible:function(t){var e=this.getElementUI(t);if(e){var i=_i.getSubNetwork(t);if(i!==this._currentSubNetwork){var n=this;return void this.setCurrentSubNetwork(i,this.isSubNetworkAnimate(),function(){Me.callLater(n.makeVisible,n,[t])})}for(var o=t;(o=o.getParent())&&o!==i;)o instanceof De.Group&&o.setExpanded(!0);var r=e.getViewRect();if(r){var a,s=e.getZoomViewRect(this.zoomManager);a=r.x==s.x&&r.y==s.y&&r.width==s.width&&r.height==s.height?{x:r.x*this.getGraphicsZoom(),y:r.y*this.getGraphicsZoom(),width:r.width*this.getGraphicsZoom(),height:r.height*this.getGraphicsZoom()}:s,We.intersects(this.viewRect,a)||this.isVisible(t)&&Me.callLater(this.centerByLogicalPoint,this,[a.x+a.width/2,a.y+a.height/2])}}},centerByLogicalPoint:function(t,e,i){var n=t-this.viewRect.width/2,o=e-this.viewRect.height/2;this.setViewRect(n,o,this.viewRect.width,this.viewRect.height)},panByOffset:function(t,e){this.setViewOffSet(t,e)},getIconsNames:function(t){return t.getStyle("icons.names")},getIconsColors:function(t){return t.getStyle("icons.colors")},getLinkFlowStepping:function(t){var e=parseInt(t.getStyle("link.flow.stepping"));return e||(e=kn.NETWORK_LINK_FLOW_STEPPING),e},getLinkFlowOffset:function(t){var e=t.getStyle("link.flow.offset");return isNaN(e)&&(e=0),e+this.getLinkFlowStepping(t)},toCanvas:function(t,e,i,n,o,r){i||(i=Xe.createCanvas()),i.setAttribute("width",t),i.setAttribute("height",e),i._viewRect?(i._viewRect.width=t,i._viewRect.height=e):i._viewRect={x:0,y:0,width:t,height:e};var a=i.getContext("2d");if(a.translate(-o,-r),a.clearRect(0,0,t,e),sn.draw(a,this),0===this._view.clientWidth||0===this._view.clientHeight)return i;this.realWidth,this.getGraphicsZoom(),this.realHeight,this.getGraphicsZoom(),a.scale(n,n);var s=this.getElementBox().getDatas()._as,l=s.length;this._topAttachmentList=new De.List;var h,c,u,d,f,p,g=this.getElementBox().getLayerBox(),_=g.getRoots(),m=_.size();if(this.adjustLinkIndex(),1===m)for(u=0;l>u;u++)d=s[u],this._visibleMap[d._id]&&null!=(f=this._elementUIMap[d._id])&&f.paint(a);else for(h=0;m>h;h++)for(c=_.get(h),u=0;l>u;u++)d=s[u],g.getLayerByElement(d)===c&&this._visibleMap[d._id]&&null!=(f=this._elementUIMap[d._id])&&f.paint(a);for(l=this._topAttachmentList.size(),u=0;l>u;u++)p=this._topAttachmentList.get(u),p.getElementUI().paintAttachment(a,p);return i},toCanvasByRegion:function(t,e,i){i||(i=Xe.createCanvas());var n=t.width*e,o=t.height*e;i.setAttribute("width",n),i.setAttribute("height",o),i._viewRect?(i._viewRect.width=n,i._viewRect.height=o):i._viewRect={x:0,y:0,width:n,height:o};var r=i.getContext("2d");if(r.clearRect(0,0,n,o),sn.draw(r,this),0===this._view.clientWidth||0===this._view.clientHeight)return i;r.save(),r.scale(e,e),r.beginPath(),r.translate(-t.x,-t.y);var a=this.getElementBox().getDatas()._as,s=a.length;this._topAttachmentList=new De.List;var l,h,c,u,d,f,p=this.getElementBox().getLayerBox(),g=p.getRoots(),_=g.size();if(this.adjustLinkIndex(),1===_)for(c=0;s>c;c++)u=a[c],this._visibleMap[u._id]&&null!=(d=this._elementUIMap[u._id])&&We.intersects(t,d.getZoomViewRect())&&d.paint(r);else for(l=0;_>l;l++)for(h=g.get(l),c=0;s>c;c++)u=a[c],p.getLayerByElement(u)===h&&this._visibleMap[u._id]&&null!=(d=this._elementUIMap[u._id])&&We.intersects(t,d.getZoomViewRect())&&d.paint(r);for(s=this._topAttachmentList.size(),c=0;s>c;c++)f=this._topAttachmentList.get(c),f.getElementUI().paintAttachment(r,f);return r.restore(),i},getGroupChildrenRects:function(t){return this.zoomManager._getGroupChildrenRects(t)},convertPointFromView:function(t){return this.zoomManager._convertPointFromView(t)},getOffset:function(t,e){return this.zoomManager._getOffset(t,e)},panToCenter:function(){this.setViewRect((this.realWidth-this.viewRect.width)/2,(this.realHeight-this.viewRect.height)/2,this.viewRect.width,this.viewRect.height)},moveElementsToCenter:function(){if(this._limitViewInCanvas){var t=this.viewRect,e=this._unionBounds,i=t.x+t.width/2-e.x-e.width/2,n=t.y+t.height/2-e.y-e.height/2;De.Util.moveElements(this._box.toDatas(),i,n)}else{var i=this.viewRect.width/2-this._unionBounds.width/2,n=this.viewRect.height/2-this._unionBounds.height/2;this.setViewRect(this._unionBounds.x-i,this._unionBounds.y-n,this.viewRect.width,this.viewRect.height)}},getLinkPathFunction:function(){return this._linkPathFunction},setLinkPathFunction:function(t){var e=this._linkPathFunction;this._linkPathFunction=t,this.firePropertyChange("linkPathFunction",e,t),this.invalidateElementUIs()},invalidate:function(){this._invalidate||(this._invalidate=!0,this.fireViewEvent({kind:"invalidate"}))},validate:function(){this._invalidate&&(0!==this._view.offsetWidth||0!==this._view.offsetHeight)&&(this._invalidate=!1,this._isValidating=!0,this.fireViewEvent({kind:"validateStart"}),this.validateImpl(),this.fireViewEvent({kind:"validateEnd"}),this._isValidating=!1)},onClickElement:function(t,e){},onClickBackground:function(t){},onDoubleClickElement:function(t,e){},onDoubleClickBackground:function(t){},onLongClickElement:function(t,e){},onLongClickBackground:function(t){},onMouseMove:function(t,e){},onMouseEnter:function(t,e){},onMouseLeave:function(t,e){},setMovingElement:function(t){if(t!=this._movingElement){var e=this._movingElement;this._movingElement=t,this.firePropertyChange("movingElement",e,t),this._box._undoManager._enabled&&(t?this._box._undoManager.startBatch():this._box._undoManager.endBatch())}},setEditingElement:function(t){if(t!=this._editingElement){var e=this._editingElement;this._editingElement=t,this.firePropertyChange("editingElement",e,t),this._box._undoManager._enabled&&(t?this._box._undoManager.startBatch():this._box._undoManager.endBatch())}},dispose:function(){De.imageUtil.removeEventListener(this.invalidateElementUIs,this),this.setInteractions(null),cancelAnimationFrame(this._loopId)}}),De.vector.Overview=function(t){De.vector.Overview.superClass.constructor.apply(this,t),this._view=Xe.createView(),this._rootDiv=Xe.createDiv(),this._imageCanvas=Xe.createCanvas(),this._imageDiv=Xe.createDiv(),this._maskCanvas=Xe.createCanvas(),this._selectDiv=Xe.createDiv(),this._isNetworkDirty=!1,this._isMaskDirty=!1,Xe.setVisible(this._selectDiv,!1),this._view.appendChild(this._rootDiv),this._rootDiv.appendChild(this._imageDiv),this._rootDiv.appendChild(this._maskCanvas),this._rootDiv.appendChild(this._selectDiv),this._imageDiv.appendChild(this._imageCanvas),this._exportImageCanvas=Xe.createCanvas(),this._imageCtx=this._imageCanvas.getContext("2d"),this.setNetwork(t),Ue.isTouchable?Ue.isMSTouchable?new De.vector.OverviewMSTouchInteraction(this):(new De.vector.OverviewTouchInteraction(this),new De.vector.OverviewInteraction(this)):new De.vector.OverviewInteraction(this)},Me.ext("twaver.vector.Overview",De.controls.ControlBase,{__accessor:["fillColor","outlineColor","outlineWidth","selectColor","selectWidth","padding","maxPackingWidth","maxPackingHeight"],__bool:["animate"],_fillColor:kn.OVERVIEW_FILL_COLOR,_outlineColor:kn.OVERVIEW_OUTLINE_COLOR,_outlineWidth:kn.OVERVIEW_OUTLINE_WIDTH,_selectColor:kn.OVERVIEW_SELECT_COLOR,_selectWidth:kn.OVERVIEW_SELECT_WIDTH,_padding:kn.OVERVIEW_PADDING,_animate:kn.OVERVIEW_ANIMATE,_maxPackingWidth:kn.OVERVIEW_MAX_PACKING_WIDTH,_maxPackingHeight:kn.OVERVIEW_MAX_PACKING_HEIGHT,getNetwork:function(){return this._network},onPropertyChanged:function(t){this._invalidateMask()},setNetwork:function(t){t!==this._network&&(this._network&&(this._network.removePropertyChangeListener(this._handleNetworkPropertyChange,this),this._network.removeViewListener(this._handleNetworkViewChange,this),Xe.removeEventListener("scroll","_handleScrollChange",this._network.getView(),this)),this._network=t,this._network&&(this._network.addPropertyChangeListener(this._handleNetworkPropertyChange,this),this._network.addViewListener(this._handleNetworkViewChange,this),Xe.addEventListener("scroll","_handleScrollChange",this._network.getView(),this)),this.invalidate())},_handleNetworkPropertyChange:function(t){("zoom"===t.property||"currentSubNetwork"===t.property||"elementBox"===t.property||"dataBox"===t.property||"canvasSizeChange"===t.property)&&this.invalidate()},_handleNetworkViewChange:function(t){"validateEnd"===t.kind&&this.invalidate()},_handleScrollChange:function(){this._invalidateMask()},invalidate:function(t){this._isNetworkDirty&&this._isMaskDirty||(this._isNetworkDirty||(this._isNetworkDirty=!0),this._isMaskDirty||(this._isMaskDirty=!0),Me.callLater(this.validate,this,null,t))},_invalidateMask:function(){this._isMaskDirty||(this._isMaskDirty=!0,Me.callLater(this.validate,this,[],100))},validate:function(){if((this._isMaskDirty||this._isNetworkDirty)&&this._network&&(this._maxPackingWidth>0&&this._maxPackingHeight>0||this._view.clientWidth>0&&this._view.clientHeight>0)&&0!==this._network.getViewRect().width&&0!==this._network.getViewRect().height&&!this._network._invalidate){var t,e=this._maxPackingWidth>0&&this._maxPackingHeight>0;t=e?{x:0,y:0,width:this._maxPackingWidth,height:this._maxPackingHeight}:{x:0,y:0,width:this._view.clientWidth,height:this._view.clientHeight},We.grow(t,-this._padding,-this._padding),e&&(Xe.setDiv(this._view,{x:0,y:0,width:this._imageDiv._viewRect.width,height:this._imageDiv._viewRect.height},null,0,null),t.width=this._imageDiv._viewRect.width,t.height=this._imageDiv._viewRect.height);var i=this._network.getGraphicsZoom(),n=this._network._unionBounds;n=We.unionRect(n,{x:0,y:0,width:n.x,height:n.y}),n={x:n.x/i,y:n.y/i,width:n.width/i,height:n.height/i};var o={x:this._network.viewRect.x/i,y:this._network.viewRect.y/i,width:this._network.viewRect.width/i,height:this._network.viewRect.height/i},r=We.unionRect(n,o),a=Math.min(t.width/r.width,t.height/r.height),s=r.width*a,l=r.height*a,h=r.width*a,c=r.height*a,u=t.x+(t.width-h)/2,d=t.y+(t.height-c)/2;if(this._isNetworkDirty){var f={x:u,y:d,width:h,height:c};this._network.toCanvas(s,l,this._exportImageCanvas,a,r.x*a,r.y*a),this._imageCanvas.setAttribute("width",h),this._imageCanvas.setAttribute("height",c),this._imageCtx.drawImage(this._exportImageCanvas,0,0,s,l),Xe.setDiv(this._imageDiv,f,null,0,null),this._network.getElementBox&&(this._imageDiv.style.backgroundColor=(this._network.getCurrentSubNetwork()||this._network.getElementBox()).getStyle("background.color")||""),this._isNetworkDirty=!1}if(this._isMaskDirty){var p={x:(o.x-r.x)*a,y:(o.y-r.y)*a,width:o.width*a,height:o.height*a},g=Xe.setCanvas(this._maskCanvas,u,d,h,c);g.lineWidth=0,g.fillStyle=this._fillColor,Ye.drawVector(g,"rectangle",null,u,d,h,c),g.closePath(),g.fill(),g.stroke(),g.clearRect(u+p.x,d+p.y,p.width,p.height),g.lineWidth=this._outlineWidth,g.strokeStyle=this._outlineColor;var _=p.width-2*this._outlineWidth,m=p.height-2*this._outlineWidth;_=Math.min(_,h-2-p.x-this._outlineWidth),m=Math.min(m,c-2-p.y-this._outlineWidth),Ye.drawVector(g,"rectangle",null,u+p.x+this._outlineWidth,d+p.y+this._outlineWidth,_,m),g.closePath(),g.stroke(),this._isMaskDirty=!1}}else this._isNetworkDirty=!1,this._isMaskDirty=!1},getLogicalPoint:function(t){return Xe.getLogicalPoint(this._view,t,1,this._rootDiv)},centerNetwork:function(t,e){var i=this._imageDiv._viewRect;if(We.containsPoint(i,t)){var n=this._network.getGraphicsZoom(),o=this._network._unionBounds;o=We.unionRect(o,{x:0,y:0,width:o.x,height:o.y}),o={x:o.x/n,y:o.y/n,width:o.width/n,height:o.height/n};var r={x:this._network.viewRect.x/n,y:this._network.viewRect.y/n,width:this._network.viewRect.width/n,height:this._network.viewRect.height/n},a=We.unionRect(o,r);this._network.centerByLogicalPoint((a.x+(t.x-i.x)/i.width*a.width)*n,(a.y+(t.y-i.y)/i.height*a.height)*n,e),this._invalidateMask()}}}),De.vector.OverviewTouchInteraction=function(t){this.overview=t,this.network=t.getNetwork(),this.view=t._view,Xe.addEventListener("touchstart","handleTouchstart",this.view,this)},Me.ext("twaver.vector.OverviewTouchInteraction",Object,{handleTouchstart:function(t){Xe.preventDefault(t),this.clear(),this.endPoint=this.overview.getLogicalPoint(t),wi.isMultiTouch(t)&&(this.distance=wi.getDistance(t),this.zoom=this.network.getZoom()),Xe.addEventListener("touchmove","handleTouchmove",this.view,this),Xe.addEventListener("touchend","handleTouchend",this.view,this)},handleTouchmove:function(t){if(this.moved||(this.moved=!0),this.endPoint=this.overview.getLogicalPoint(t),wi.isSingleTouch(t))this.overview.centerNetwork(this.endPoint,!1);else if(this.distance){var e=wi.getDistance(t)/this.distance;this.network.setZoom(this.zoom*e,!1)}},handleTouchend:function(t){if(!this.moved){this.endPoint=this.overview.getLogicalPoint(t);var e=this.lastPoint&&this.lastTouchStartTime&&(new Date).getTime()-this.lastTouchStartTime.getTime()<=300&&Math.abs(this.endPoint.x-this.lastPoint.x)<=10&&Math.abs(this.endPoint.y-this.lastPoint.y)<=10;e?(this.lastPoint=null,this.lastTouchStartTime=null):(this.lastPoint=this.endPoint,this.lastTouchStartTime=new Date),e?Me.callLater(this.network.zoomReset,this.network,[this.overview._animate]):this.overview.centerNetwork(this.endPoint,this.overview._animate)}this.clear()},clear:function(){this.endPoint&&(this.endPoint=null,Xe.removeEventListener("touchmove",this.view,this),Xe.removeEventListener("touchend",this.view,this)),this.moved=!1}}),De.vector.OverviewMSTouchInteraction=function(t){this.overview=t,this.network=t.getNetwork(),this.view=t._view,this._pointerMap={},this._pointerIdArray=[],Xe.addEventListener("MSPointerDown","handleTouchstart",this.view,this),Xe.addEventListener("MSPointerMove","handleTouchmove",this.view,this),Xe.addEventListener("MSPointerUp","handleTouchend",this.view,this),Xe.addEventListener("MSPointerCancel","handleTouchend",this.view,this)},Me.ext("twaver.vector.OverviewMSTouchInteraction",Object,{handleTouchstart:function(t){Xe.preventDefault(t),t.isPrimary&&this._pointerIdArray.length>0&&(this._pointerMap={},this._pointerIdArray=[]),!this._pointerMap[t.pointerId]&&this.overview.getLogicalPoint(t)&&(this._pointerIdArray.push(t.pointerId),this._pointerMap[t.pointerId]=t),1==this._pointerIdArray.length?(this._startTouchPoint=this.overview.getLogicalPoint(t),this._startTouchTime=new Date):2==this._pointerIdArray.length&&(this._distance=this._getDistance(),this._zoom=this.network.getZoom())},handleTouchmove:function(t){if(0!=this._pointerIdArray.length&&this._pointerMap[t.pointerId]&&!(We.getDistance({x:this._pointerMap[t.pointerId].pageX,y:this._pointerMap[t.pointerId].pageY},{x:t.pageX,y:t.pageY})<=10))if(this._pointerMap[t.pointerId]=t,2==this._pointerIdArray.length){var e=this._getDistance()/this._distance;this.network.setZoom(this._zoom*e,!1)}else if(1==this._pointerIdArray.length&&this._startTouchPoint){var i=this.overview.getLogicalPoint(t);if(null==i)return;this._startTouchPoint=i,this.overview.centerNetwork(this._startTouchPoint,!1)}},handleTouchend:function(t){var e=this.overview.getLogicalPoint(t);if(1==this._pointerIdArray.length&&e){var i=this._endTouchPoint&&this._endTouchTime&&(new Date).getTime()-this._endTouchTime.getTime()<=500&&We.getDistance(this._endTouchPoint,e)<=10;i?(this._endTouchPoint=null,this._endTouchTime=null):(this._endTouchPoint=e,this._endTouchTime=new Date),i?Me.callLater(this.network.zoomReset,this.network,[this.overview._animate]):this.overview.centerNetwork(this._endTouchPoint,this.overview._animate)}this._pointerMap={},this._pointerIdArray=[]},_getDistance:function(){return We.getDistance({x:this._pointerMap[this._pointerIdArray[0]].pageX,y:this._pointerMap[this._pointerIdArray[0]].pageY},{x:this._pointerMap[this._pointerIdArray[1]].pageX,y:this._pointerMap[this._pointerIdArray[1]].pageY})}}),De.vector.OverviewInteraction=function(t){this.overview=t,this.network=t.getNetwork(),this.view=t._view,Xe.addEventListener("mousedown","handleMousedown",this.view,this)},Me.ext("twaver.vector.OverviewInteraction",Object,{handleMousedown:function(t){this.clear(),this.endPoint=this.overview.getLogicalPoint(t),Me.isCtrlDown(t)&&(this.startPoint=this.endPoint,Xe.setVisible(this.overview._selectDiv,!0)),Xe.addEventListener("mousemove","handleMousemove",this.view,this),Xe.addEventListener("mouseup","handleMouseup",this.view,this)},handleMouseup:function(t){if(this.endPoint=this.overview.getLogicalPoint(t),"detail"in t&&2===t.detail)Me.callLater(this.network.zoomReset,this.network,[this.endPoint,this.overview._animate]);else if(Xe.isVisible(this.overview._selectDiv)&&this.startPoint){var e=this.overview._imageDiv._viewRect,i=this.overview._selectDiv._viewRect.x,n=this.overview._selectDiv._viewRect.y,o=e.width/this.overview._selectDiv._viewRect.width,r=e.height/this.overview._selectDiv._viewRect.height,a=Math.min(o,r);this.network.setZoom(a*Math.min(this.network.getViewRect().width/this.network.getCanvasSize().width,this.network.getViewRect().height/this.network.getCanvasSize().height)*this.network.getZoom(),!1);var s=this.network.getCanvasSize().width*((i-e.x+this.overview._selectDiv._viewRect.width/2)/e.width),l=this.network.getCanvasSize().height*((n-e.y+this.overview._selectDiv._viewRect.height/2)/e.height);Me.callLater(this.network.centerByLogicalPoint,this.network,[s,l,this.overview._animate]),Xe.setVisible(this.overview._selectDiv,!1),Xe.setDiv(this.overview._selectDiv,{x:0,y:0,width:0,height:0},null,0,null),this.startPoint=null}else this.overview.centerNetwork(this.endPoint,this.overview._animate);this.clear()},handleMousemove:function(t){var e=this.overview.getLogicalPoint(t);if(this.endPoint=e,Xe.isVisible(this.overview._selectDiv)&&this.startPoint){var i=e.x>this.startPoint.x?this.startPoint.x:e.x,n=e.x>this.startPoint.x?this.startPoint.y:e.y;e.x>this.startPoint.x&&e.y<this.startPoint.y&&(n=e.y),e.x<this.startPoint.x&&e.y>this.startPoint.y&&(n=this.startPoint.y);var o=this.overview._imageDiv._viewRect;i<o.x&&(i=o.x),i>o.x+o.width&&(i=o.x+o.width),n<o.y&&(n=o.y),n>o.y+o.height&&(n=o.y+o.height);var r=Math.abs(e.x-this.startPoint.x),a=Math.abs(e.y-this.startPoint.y);i+r>o.x+o.width&&(r=o.x+o.width-i),n+a>o.y+o.height&&(a=o.y+o.height-n),Xe.setDiv(this.overview._selectDiv,{x:i,y:n,width:r,height:a},null,this.overview._selectWidth,this.overview._selectColor)}else this.overview.centerNetwork(e,!1)},clear:function(){this.endPoint&&(this.endPoint=null,Xe.removeEventListener("mousemove",this.view,this),Xe.removeEventListener("mouseup",this.view,this))}}),De.vector.ElementUI=function(t,e){this._network=t,this._element=e,this._attachments=new De.List,this._bodyBounds=new De.List,this._hitTest=!1,this._hitTest=!1,this._intersectTest=!1,this.invalidate(!0)},Me.ext("twaver.vector.ElementUI",Object,{getElement:function(){return this._element},getNetwork:function(){return this._network},handlePropertyChange:function(t){},handleSelectionChange:function(t){},invalidate:function(t){t===e&&(t=!0),t&&(this._invalidateAttachmentsFlag=!0),this._invalidateFlag||(this._hotSpot=null,this._bodyRect=null,this._invalidateFlag=!0,this.invalidateZoom(),this.setAttachmentVisible&&this.setAttachmentVisible(!1))},invalidateZoom:function(){this._zoomBodyRect=null,this._zoomViewRect=null,this._zoomHotSpot=null},updateStyle:function(){this._innerColor=this._network.getInnerColor(this._element),this._outerColor=this._network.getOuterColor(this._element),this._glowBlur=this._element.getStyle("glow.blur"),this._shadowColor=this._network.getShadowColor(this._element),this._shadowXOffset=this._element.getStyle("shadow.xoffset"),this._shadowYOffset=this._element.getStyle("shadow.yoffset"),this._shadowBlur=this._element.getStyle("shadow.blur"),this._wholeAlpha=this._element.getStyle("whole.alpha")},validate:function(){var t=this;if(0!=this._invalidateFlag){this._bodyBounds.clear(),this._invalidateAttachmentsFlag&&(this._invalidateAttachmentsFlag=!1,this.checkAttachments()),this._invalidateFlag=!1,this.updateStyle(),this.validateImpl(),this._attachments.forEach(function(t){t.validate()});var e;this._bodyBounds.forEach(function(t){e=We.unionRect(e,t)}),null==e&&(e=Me.cloneRect(this._element.getLocation()),e.width=0,e.height=0),this._unionBodyBounds={x:e.x,y:e.y,width:e.width,height:e.height},this._attachments.forEach(function(i){e=i instanceof De.vector.EditAttachment?i.getElementUI()instanceof De.vector.LinkUI?We.unionRect(e,i._viewRect):We.unionRect(e,t._network.zoomManager._reverseElementZoomRect(t,i._viewRect)):i.getElementUI()instanceof De.vector.LinkUI?We.unionRect(e,t._network.zoomManager._getAttachmentZoomOutLineRect(i,i._viewRect)):i.getElementUI()instanceof De.vector.GroupUI&&i.getElementUI()._shapeRect?i instanceof De.vector.IconsAttachment?We.unionRect(e,i._viewRect):We.unionRect(e,t._network.zoomManager._getAttachmentZoomOutLineRect(i,i._viewRect)):We.unionRect(e,i._viewRect)}),this._viewRect=e}},validateImpl:function(){},setGlow:function(t,e){"glow"===this._element.getStyle("outer.style")&&(e.shadowColor=this._outerColor,e.shadowOffsetX=0,e.shadowOffsetY=0,e.shadowBlur=this._glowBlur)},clearGlow:function(t){(0!=t.shadowOffsetX||0!=t.shadowOffsetY||0!=t.shadowBlur)&&(t.shadowOffsetX=0,t.shadowOffsetY=0,t.shadowBlur=0)},setShadow:function(t,e){var i=this._network.zoomManager,n=t.isShadowable()&&this._shadowColor&&!this._editAttachment;if(e.shadowOffsetX===this._shadowXOffset&&e.shadowOffsetY===this._shadowYOffset&&e.shadowBlur===this._shadowBlur)return e;if(n||this._network._showShadowInEdit){var o=i.getGraphicsZoom();o*=i.getSizeZoom(),o>1&&(o=1),e.shadowOffsetX=this._shadowXOffset*o,e.shadowOffsetY=this._shadowYOffset*o,e.shadowBlur=this._shadowBlur*o,e.shadowColor=this._shadowColor}return e},clearShadow:function(t){(0!=t.shadowOffsetX||0!=t.shadowOffsetY||0!=t.shadowBlur)&&(t.shadowOffsetX=0,t.shadowOffsetY=0,t.shadowBlur=0)},appendShadowBound:function(t,e){if(t.isShadowable()&&this._shadowColor&&!this._editAttachment){var i=this._network.zoomManager,n=i.getGraphicsZoom();n*=i.getSizeZoom(),n>1&&(n=1),this._shadowXOffset>0?e.width+=this._shadowXOffset:(e.x+=this._shadowXOffset,e.width+=-this._shadowXOffset),this._shadowYOffset>0?e.height+=this._shadowYOffset:(e.y+=this._shadowYOffset,e.height+=-this._shadowYOffset);var o=this._shadowBlur;o=Math.ceil(o/n),We.grow(e,o+1,o+1)}return e},appendGlowBound:function(t,e){if("glow"===this._element.getStyle("outer.style")){var i=this._network.zoomManager,n=i.getGraphicsZoom();(n*=i.getSizeZoom())>1&&(n=1);var o=this._glowBlur;o=Math.ceil(o/n),We.grow(e,o+1,o+1)}},isShadowable:function(){return!(!this._shadowColor||!this._network.isSelected(this._element)||"shadow"!==this._element.getStyle("select.style"))},addAttachment:function(t){this._attachments.add(t),this.invalidate(!1)},removeAttachment:function(t){this._attachments.remove(t),this.invalidate(!1)},getAttachments:function(){return this._attachments},checkAttachments:function(){this.checkLabelAttachment(),this.checkLabel2Attachment(),this.checkAlarmAttachment(),this.checkIconsAttachment(),this.checkEditAttachment()},checkLabelAttachment:function(){var t=this._network.getLabel(this._element);null!=t&&""!==t?this._labelAttachment||(this._labelAttachment=new De.vector.LabelAttachment(this,kn.SHOW_LABEL_IN_ATTACHMENT_DIV),this.addAttachment(this._labelAttachment)):this._labelAttachment&&(this.removeAttachment(this._labelAttachment),this._labelAttachment=null)},checkLabel2Attachment:function(){var t=this._network.getLabel2(this._element);null!=t&&""!==t?this._label2Attachment||(this._label2Attachment=new De.vector.Label2Attachment(this,kn.SHOW_LABEL2_IN_ATTACHMENT_DIV),this.addAttachment(this._label2Attachment)):this._label2Attachment&&(this.removeAttachment(this._label2Attachment),this._label2Attachment=null)},checkAlarmAttachment:function(){var t=this._network.getAlarmLabel(this._element);null!=t&&""!==t?this._alarmAttachment||(this._alarmAttachment=new De.vector.AlarmAttachment(this,kn.SHOW_ALARM_IN_ATTACHMENT_DIV),this.addAttachment(this._alarmAttachment)):this._alarmAttachment&&(this.removeAttachment(this._alarmAttachment),this._alarmAttachment=null)},checkIconsAttachment:function(){var t=this._network.getIconsNames(this._element);t&&t.length>0?this._iconsAttachment||(this._iconsAttachment=new De.vector.IconsAttachment(this,kn.SHOW_ICON_IN_ATTACHMENT_DIV),this.addAttachment(this._iconsAttachment)):this._iconsAttachment&&(this.removeAttachment(this._iconsAttachment),this._iconsAttachment=null)},checkEditAttachment:function(){this._network.hasEditInteraction()&&this._network.isSelected(this._element)&&this._network.isEditable(this._element)&&this.isEditable()?this._editAttachment||(this._editAttachment=new De.vector.EditAttachment(this,kn.SHOW_EDIT_IN_ATTACHMENT_DIV),this.addAttachment(this._editAttachment)):this._editAttachment&&(this.removeAttachment(this._editAttachment),this._editAttachment=null)},getLabelAttachment:function(){return this._labelAttachment},getAlarmAttachment:function(){return this._alarmAttachment},getIconsAttachment:function(){return this._iconsAttachment},getEditAttachment:function(){return this._editAttachment},isEditable:function(){return!0},getInnerColor:function(){return this._innerColor},getOuterColor:function(){return this._outerColor},getShadowColor:function(){return this._shadowColor},getDyeColor:function(t){return this._innerColor?this._innerColor:this.getStyle(t)},getStyle:function(t){return this._element.getStyle(t)},getFont:function(t){var e=this._element.getStyle(t);return e||De.Defaults.FONT},paint:function(t){t.save(),t.globalAlpha=this._wholeAlpha,t.beginPath(),this.paintBody(t),this.clearShadow(t),this.clearGlow(t),t.closePath(),t.beginPath(),this.paintAttachments(t),t.closePath(),t.restore(),this._network._debug&&Ye.strokeRect(t,this.getZoomBodyRect(),"orange")},paintBody:function(t){},getZoomBodyRect:function(t){return this._network.zoomManager._getElementZoomRect(this,this.getBodyRect())},getZoomHotSpot:function(){return this._zoomHotSpot||(this._zoomHotSpot=this._network.zoomManager._getZoomHotSpot(this,this._hotSpot)),Me.clone(this._zoomHotSpot)},getZoomPointers:function(t,e){return this._network.zoomManager._getZoomPointers(t,this,e)},_getZoomViewRect:function(t,e,i){var n=this._network.zoomManager;if(e){return Me.cloneRect(n._getAttachmentZoomRect(e,t))}var o=n.getLocationZoom(),r=n.getSizeZoom(this),a=this._bodyRect?this._bodyRect:this.getBodyRect();t=t||{x:a.x,y:a.y,width:0,height:0};var s=a.x+a.width/2,l=a.y+a.height/2;return{x:s*o+(t.x-s)*r,y:l*o+(t.y-l)*r,width:t.width*r,height:t.height*r}},getZoomViewRect:function(t){var e=this._network.zoomManager,i=e.getLocationZoom();if(e.getGraphicsZoom(),1==i)return Me.cloneRect(this._viewRect);if(!this._zoomViewRect||t){var n,o=this._getZoomViewRect(Me.cloneRect(this._unionBodyBounds),!1);n=We.unionRect(n,o),this._attachments.forEach(function(t){n=t instanceof De.vector.EditAttachment?We.unionRect(n,t._viewRect):We.unionRect(n,t.getZoomViewRect())}),this._zoomViewRect=n}return Me.cloneRect(this._zoomViewRect)},paintAttachments:function(t){t.beginPath();for(var e=this._attachments.size(),i=0;e>i;i++){var n=this._attachments.get(i);(this._network.isShowAttachOnChg()||this._network.isVisibleAttachment(n))&&(1==this._hitTest&&0==n.isShowOnTop()&&this.paintAttachment(t,n),1==this._intersectTest&&this.paintAttachment(t,n),0==this._hitTest&&0==this._intersectTest&&(n.isShowOnTop()?this._network._topAttachmentList.add(n):this.paintAttachment(t,n)))}},paintAttachment:function(t,e){var i=this._network.zoomManager;i.isAttachmentVisible(this._element)&&(e!=this._labelAttachment&&e!=this._label2Attachment||i.isLabelVisible(this._element))&&(e!=this._alarmAttachment||i.isAlarmBalloonVisible(this._element))&&(t.beginPath(),e.paint(t),this.clearShadow(t))},getViewRect:function(){return Me.cloneRect(this._viewRect)},getUnionBodyBounds:function(){return Me.cloneRect(this._unionBodyBounds)},addBodyBounds:function(t){t&&this._bodyBounds.add(t)},getBodyRect:function(t){return t==e&&(t=!0),this._bodyRect||(this._bodyRect=this.createBodyRect()),t?Me.cloneRect(this._bodyRect):this._bodyRect},getHotSpot:function(){return this._hotSpot?Me.clone(this._hotSpot):{x:0,y:0}},setHotSpot:function(t){this._hotSpot=t},hit:function(t,e){return!1},intersects:function(t){return!!We.contains(t,this.getZoomViewRect())},hitCanvasRectAtBody:function(t){var e=Nn.getHitCanvas(t.width,t.height),i=Nn.getCtx(e);if(i.save(),i.translate(-t.x,-t.y),this._element.getImage){var n=Me.getImageAsset(this._element.getImage());if(n&&n.getImage()instanceof In)return 1}this.paintBody(i);try{for(var o=i.getImageData(0,0,t.width,t.height),r=o.data,a=0;a<o.width;a++)for(var s=0;s<o.height;s++){var l=4*(s*o.width+a),h=r[l+3];if(0!==h)return i.restore(),1}}catch(e){if(Nn.disposeHitCanvas(),We.contains(this.getUnionBodyBounds(),t))return 0}return i.restore(),-1},hitCanvasRectAtAttachments:function(t){var e=Nn.getHitCanvas(t.width,t.height),i=Nn.getCtx(e);i.save(),i.translate(-t.x,-t.y),this.paintAttachments(i);try{for(var n=i.getImageData(0,0,t.width,t.height),o=n.data,r=0;r<n.width;r++)for(var a=0;a<n.height;a++){var s=4*(a*n.width+r),l=o[s+3];if(0!==l)return i.restore(),1}}catch(t){Nn.disposeHitCanvas()}return i.restore(),-1},hitCanvasRect:function(t){this._intersectTest=!0,1==this._hitTest&&(this._intersectTest=!1);var e=We.intersection(t,this.getZoomViewRect()),i=this.hitCanvasRectAtBody(e);return 1==i?(this._intersectTest=!1,!0):1==this.hitCanvasRectAtAttachments(e)?(this._intersectTest=!1,!0):(this._intersectTest=!1,0==i)},hitCanvasPoint:function(t,e){var i={x:t,y:e,width:0,height:0},n=this._network.getSelectionTolerance();if(n&&n>0&&We.grow(i,n,n),!We.intersects(this.getZoomViewRect(),i))return!1;this._hitTest=!0;var o=this.hitCanvasRect(i);return this._hitTest=!1,o},hitTest:function(t,e){var i={x:t,y:e,width:0,height:0},n=this._network.getSelectionTolerance();if(n&&n>0&&We.grow(i,n,n),!We.intersects(this.getZoomViewRect(),i))return null;for(var o=We.intersection(i,this.getZoomViewRect()),r=this._attachments.size(),a=0;r>a;a++){var s=this._attachments.get(a);if(s.hit(t,e))return s}var l=this.hitCanvasRectAtBody(o);return 1==l?this:0==l?this:null},dispose:function(){this._attachments.forEach(function(t){t.dispose()}),this._attachments.clear()}}),De.vector.NodeUI=function(t,e){De.vector.NodeUI.superClass.constructor.call(this,t,e)},Me.ext("twaver.vector.NodeUI",De.vector.ElementUI,{invalidate:function(t){this.curInterval&&clearInterval(this.curInterval),De.vector.NodeUI.superClass.invalidate.call(this,t)},createBodyRect:function(){return this._element.getRect()},validateImpl:function(){De.vector.NodeUI.superClass.validateImpl.call(this);var t=this.getStyle("vector.shape"),e=this.getBodyRect();this._hotSpot=We.getHotSpot(e.x,e.y,e.width,e.height,t),this.validateBodyBounds()},validate:function(){0!=this._invalidateFlag&&De.vector.NodeUI.superClass.validate.call(this)},validateBodyBounds:function(){var t=this.getStyle("body.type");"default"===t?this.addBodyBounds(this.getDefaultBodyRect()):"vector"===t?this.addBodyBounds(this.getVectorBody()):"default.vector"===t?(this.addBodyBounds(this.getVectorBody()),this.addBodyBounds(this.getDefaultBodyRect())):"vector.default"===t&&(this.addBodyBounds(this.getDefaultBodyRect()),this.addBodyBounds(this.getVectorBody())),this._outerColor&&"border"===this.getStyle("outer.style")&&this.addBodyBounds(this.getOuterBorderRect()),!this._editAttachment&&"border"===this.getStyle("select.style")&&this._network.isSelected(this._element)&&this.addBodyBounds(this.getSelectBorderRect())},getDefaultBodyRect:function(){var t=this._element,e=this.getBodyRect();if(!t.getImage()||"string"==typeof t.getImage()&&!Me.getImageAsset(t.getImage()))return e;We.addPadding(e,this._element,"image.padding",1);var i=Me.cloneRect(e);return this.appendGlowBound(this,i),this.appendShadowBound(this,i),e=i},getVectorBody:function(){return this.getPathRect("vector")},getOuterBorderRect:function(){return this._getBorderRect("outer")},getSelectBorderRect:function(){return this._getBorderRect("select")},_getBorderRect:function(t){var e=this._element,i=e.getStyle(t+".width"),n=e.getStyle("select.physicalZoom")?1:this._network.getGraphicsZoom();if(i>0){i="select"===t?i/n:i;var o=this.getBodyRect();We.addPadding(o,e,t+".padding","select"===t?1/n:1);var r=Me.cloneRect(o);return We.grow(r,2*i,2*i),r}return null},getPathRect:function(t,e){var i=this._element,n=this.getBodyRect();this._network.zoomManager.getSizeZoom(),e&&We.addPadding(n,i,t+".padding",1);var o=Me.cloneRect(n),r=i.getStyle(t+".outline.width");if(r>0)if(this._getZoomPoints){for(var a=this._element._points,s=a.size(),l=0,h=0;s>h;h++){if(0==h)var c=a.get(h),u=a.get(s-1),d=a.get(h+1);else if(h==s-1)var c=a.get(h),u=a.get(h-1),d=a.get(0);else var c=a.get(h),u=a.get(h-1),d=a.get(h+1);var f=We.getCenterPoint(u,d),p=We.getAngle(f,c),g=Math.abs(5*(r+1)*Math.sin(p));l=g>l?g:l,g=Math.abs(5*(r+1)*Math.cos(p)),l=g>l?g:l}We.grow(o,l,l)}else We.grow(o,r/2,r/2);return this.appendGlowBound(this,o),this.appendShadowBound(this,o),o},getZoomPathRect:function(t,e){var i=this._element,n=this.getZoomBodyRect();this._network.zoomManager.getSizeZoom(),e&&We.addPadding(n,i,t+".padding",1);var o=Me.cloneRect(n),r=i.getStyle(t+".outline.width");if(r>0)if(this._getZoomPoints){for(var a=this._getZoomPoints(),s=a.size(),l=0,h=0;s>h;h++){if(0==h)var c=a.get(h),u=a.get(s-1),d=a.get(h+1);else if(h==s-1)var c=a.get(h),u=a.get(h-1),d=a.get(0);else var c=a.get(h),u=a.get(h-1),d=a.get(h+1);var f=We.getCenterPoint(u,d),p=We.getAngle(f,c),g=Math.abs(5*(r+1)*Math.sin(p));l=g>l?g:l,g=Math.abs(5*(r+1)*Math.cos(p)),l=g>l?g:l}We.grow(o,l,l)}else We.grow(o,r/2,r/2);return this.appendGlowBound(this,o),this.appendShadowBound(this,o),o},paintBody:function(t){this.curInterval&&clearInterval(this.curInterval);var e=this.getStyle("body.type");"default"===e?this.drawDefaultBody(t):"vector"===e?this.drawVectorBody(t):"default.vector"===e?(this.drawVectorBody(t),this.drawDefaultBody(t)):"vector.default"===e&&(this.drawDefaultBody(t),this.drawVectorBody(t)),this._outerColor&&"border"===this.getStyle("outer.style")&&this.drawOuterBorder(t),"border"===this.getStyle("select.style")&&this._network.isSelected(this._element)&&this.drawSelectBorder(t)},drawOuterBorder:function(t){var e=this._element,i=e.getStyle("outer.width");if(i>0){var n=this.getZoomBodyRect();We.addPadding(n,e,"outer.padding",1),t.lineWidth=i,t.lineCap=e.getStyle("outer.cap"),t.lineJoin=e.getStyle("outer.join"),t.strokeStyle=this._outerColor,Ye.drawVector(t,e.getStyle("outer.shape"),null,n),t.stroke()}},drawDefaultBody:function(t){var e,i=this._element;if(i.getImage()&&("string"!=typeof i.getImage()||(e=Me.getImageAsset(i.getImage())))&&(!this._shapeRect||i.getStyle("group.expend.image")&&("string"!=typeof i.getStyle("group.expend.image")||(e=Me.getImageAsset(i.getStyle("group.expend.image")))))){var n=this.getZoomBodyRect();if(We.addPadding(n,this._element,"image.padding",1),0!=i.getAngle()&&(t.save(),n=i.getOriginalRect(),n=this._network.zoomManager._getElementZoomRect(this,n),De.Util.rotateCanvas(t,n,i.getAngle())),this.setGlow(this,t),this.setShadow(this,t),e&&e.getImage()instanceof In){var o,r=e.getImage().frames,a=e.getImage().size,s=0;o=Rn(r,a,0),t.drawImage(o,n.x,n.y,n.width,n.height),this.curInterval=setInterval(function(){s=(s+r.length)%r.length,o=Rn(r,a,s),t.drawImage(o,n.x,n.y,n.width,n.height),s++},100)}else this._shapeRect?Di(t,i.getStyle("group.expend.image"),this.getInnerColor(),n,i,this._network):Di(t,i.getImage(),this.getInnerColor(),n,i,this._network);0!=i.getAngle()&&t.restore()}},drawSelectBorder:function(t){this.clearGlow(t);var e=this._element,i=e.getStyle("select.width");if(i>0){var n=this.getZoomBodyRect();n=Me.cloneRect(n);var o=e.getStyle("select.physicalZoom")?1:this._network.getGraphicsZoom();We.addPadding(n,e,"select.padding",1/o),We.grow(n,i/2/o,i/2/o),t.lineWidth=i/o,t.lineCap=e.getStyle("select.cap"),t.lineJoin=e.getStyle("select.join"),t.strokeStyle=e.getStyle("select.color"),Ye.drawVector(t,e.getStyle("select.shape"),null,n),t.stroke()}},drawVectorBody:function(t){this.drawPath(t,"vector",!0,this._element.getStyle("vector.outline.pattern"));var e=this.getStyle("vector.deep"),i=this.getStyle("vector.fill.color");if(0!==e&&i&&"rectangle"===this.getStyle("vector.shape")){var n=this.getZoomBodyRect(),o=this._element.getAngle();if(0!=o){t.save();var r=this._element.getOriginalRect();r=this._network.zoomManager._getElementZoomRect(this,r),De.Util.rotateCanvas(t,r,o)}Ye.draw3DRect(t,i,e,n),0!=o&&t.restore()}},drawPath:function(t,e,i,n,o,r,a){var s=this._network.zoomManager,l=this._element,h=null;h="group"==e?this._shapeRect:this.getZoomBodyRect(),i&&We.addPadding(h,l,e+".padding",1);var c=l.getStyle(e+".outline.width");this.setGlow(this,t),this.setShadow(this,t),0!=l.getAngle()&&(l instanceof Mn||(h=l.getOriginalRect(),h=s._getElementZoomRect(this,h)),t.save(),De.Util.rotateCanvas(t,h,l.getAngle()));var u,d=l.getStyle(e+".fill");if(d){u=this._innerColor&&!_i.hasDefault(this._element)?this._innerColor:l.getStyle(e+".fill.color");var f=l.getStyle(e+".gradient");f?Ye.fill(t,u,f,l.getStyle(e+".gradient.color"),h):t.fillStyle=u}var p=l.getStyle(e+".shape"),g=l.getStyle("group.shape.roundrect.radius");d&&(t.beginPath(),o?Ye.drawLinePoints(t,o,null,r,a):"roundrect"===p&&"group"===e?Ye.drawVector(t,p,null,h,g):Ye.drawVector(t,p,null,h),t.fill()),c>0&&(t.lineWidth=c,t.lineCap=l.getStyle(e+".cap"),t.lineJoin=l.getStyle(e+".join"),t.strokeStyle=l.getStyle(e+".outline.color"),t.beginPath(),o?Ye.drawLinePoints(t,o,n,r,a):"roundrect"===p&&"group"===e?Ye.drawVector(t,p,n,h,g):Ye.drawVector(t,p,n,h),t.stroke()),0!=l.getAngle()&&t.restore()},hit:function(t,e){var i={x:t,y:e,width:0,height:0},n=this._network.getSelectionTolerance();if(n&&n>0&&We.grow(i,n,n),this._network._transparentSelectionEnable){var o=this.getBodyRect();if(Me.math.intersects(o,i))return!0}return!!We.intersects(this.getZoomViewRect(),i)&&this.hitCanvasPoint(t,e)},intersects:function(t){if(1==De.vector.NodeUI.superClass.intersects.apply(this,arguments))return!0;if(this._network._transparentSelectionEnable){var e=this.getBodyRect();if(Me.math.intersects(e,t))return!0}return!!We.intersects(t,this.getZoomViewRect())&&this.hitCanvasRect(t)}}),De.vector.LinkUI=function(t,e){De.vector.LinkUI.superClass.constructor.call(this,t,e)},Me.ext("twaver.vector.LinkUI",De.vector.ElementUI,{isEditable:function(){return!0},invalidate:function(t){this._linkPoints=null,this._fromPoint=null,this._toPoint=null,this._angle=null,De.vector.LinkUI.superClass.invalidate.call(this,t)},invalidateZoom:function(){this._fromPoint=null,this._toPoint=null,this._linkPoints=null,De.vector.LinkUI.superClass.invalidateZoom.call(this)},validateImpl:function(){this.validateBodyBounds(),De.vector.LinkUI.superClass.validateImpl.call(this)},validateBodyBounds:function(){var t=this.getLinkPoints();if(t&&!(t.size()<2)){var e=this._element,i=We.getLineRect(t),n=e.getStyle("link.width"),o=n;if(this._outerColor){o+=2*e.getStyle("outer.width")}if(!this._editAttachment&&"border"===e.getStyle("select.style")&&this._network.isSelected(this._element)){o+=2*e.getStyle("select.width")}We.grow(i,o/2,o/2),e.getStyle("arrow.from")&&(this._network._edgeDetect?(this._network._debug&&(this._arrowFromRect=cn.getArrowRect(this,t,!0,e.getStyle("arrow.from.shape"),e.getStyle("arrow.from.width"),e.getStyle("arrow.from.height"),0,0,this._network.zoomManager)),i=We.unionRect(i,cn.getArrowRect(this,t,!0,e.getStyle("arrow.from.shape"),e.getStyle("arrow.from.width"),e.getStyle("arrow.from.height"),0,0,this._network.zoomManager))):(this._network._debug&&(this._arrowFromRect=cn.getArrowRect(this,t,!0,e.getStyle("arrow.from.shape"),e.getStyle("arrow.from.width"),e.getStyle("arrow.from.height"),e.getStyle("arrow.from.xoffset"),e.getStyle("arrow.from.yoffset"),this._network.zoomManager)),i=We.unionRect(i,cn.getArrowRect(this,t,!0,e.getStyle("arrow.from.shape"),e.getStyle("arrow.from.width"),e.getStyle("arrow.from.height"),e.getStyle("arrow.from.xoffset"),e.getStyle("arrow.from.yoffset"),this._network.zoomManager)))),e.getStyle("arrow.to")&&(this._network._edgeDetect?(this._network._debug&&(this._arrowToRect=cn.getArrowRect(this,t,!1,e.getStyle("arrow.to.shape"),e.getStyle("arrow.to.width"),e.getStyle("arrow.to.height"),0,0,this._network.zoomManager)),i=We.unionRect(i,cn.getArrowRect(this,t,!1,e.getStyle("arrow.to.shape"),e.getStyle("arrow.to.width"),e.getStyle("arrow.to.height"),0,0,this._network.zoomManager))):(this._network._debug&&(this._arrowToRect=cn.getArrowRect(this,t,!1,e.getStyle("arrow.to.shape"),e.getStyle("arrow.to.width"),e.getStyle("arrow.to.height"),e.getStyle("arrow.to.xoffset"),e.getStyle("arrow.to.yoffset"),this._network.zoomManager)),i=We.unionRect(i,cn.getArrowRect(this,t,!1,e.getStyle("arrow.to.shape"),e.getStyle("arrow.to.width"),e.getStyle("arrow.to.height"),e.getStyle("arrow.to.xoffset"),e.getStyle("arrow.to.yoffset"),this._network.zoomManager)))),this.appendShadowBound(this,i),this.addBodyBounds(i),this._growLinkJoinBounds(i,o)}},_growLinkJoinBounds:function(t,e){},createBodyRect:function(){var t=this.getHotSpot();return t?{x:t.x-1,y:t.y-1,width:2,height:2}:null},paintBody:function(t){var e=this.getLinkPoints();if(e&&!(e.size()<2)){var i=this._element,n=i.isBundleAgent()&&i.getStyle("link.agent"),o=i.getStyle(n?"link.agent.width":"link.width"),r=o;if(this._outerColor&&"border"===this.getStyle("outer.style")){var a=i.getStyle("outer.width");r+=2*a}var s=!this._editAttachment&&"border"===i.getStyle("select.style")&&this._network.isSelected(this._element);if(s){r+=2*i.getStyle("select.width")}this.setGlow(this,t),this.setShadow(this,t),t.lineCap=i.getStyle(n?"link.agent.cap":"link.cap"),t.lineJoin=i.getStyle(n?"link.agent.join":"link.join");var l=i.getStyle(n?"link.agent.pattern":"link.pattern");s&&this.drawLinePoints(t,e,r,i.getStyle("select.color"),l),this._outerColor&&"border"===this.getStyle("outer.style")&&this.drawLinePoints(t,e,o+2*a,this._outerColor,l),this.drawLinePoints(t,e,o,this._innerColor||i.getStyle(n?"link.agent.color":"link.color"),l),cn.drawLinkArrow(this,t,e,this._network.zoomManager),this._network._debug&&(Ye.strokeRect(t,this._arrowToRect,De.Util.randomColor()),Ye.strokeRect(t,this._arrowFromRect,De.Util.randomColor()))}},drawLinePoints:function(t,e,i,n,o){t.lineWidth=i,t.strokeStyle=n;var r=this._element.isBundleAgent()&&this._element.getStyle("link.agent");if(!0===this._element.getStyle(r?"link.agent.flow":"link.flow")&&o&&o.length>1){var a=new gi(t,o[0],o[1]),s=this._element.getStyle(r?"link.agent.flow.offset":"link.flow.offset"),l=Math.floor(s/(o[0]+o[1]));l>2&&(s-=(o[0]+o[1])*l),this._element.getStyle(r?"link.agent.flow.converse":"link.flow.converse")?s<o[0]?a.overflow=o[0]-s:s>=o[0]&&s<=o[0]+o[1]?(a.overflow=o[1]-(s-o[0]),a.overflow&&(a.isLine=!1)):(s-=o[0]+o[1],a.overflow=o[0]-s):s<=o[1]?(a.overflow=s,s&&(a.isLine=!1)):s>o[1]&&s<=o[0]+o[1]?a.overflow=s-o[1]:(s-=o[0]+o[1],s&&(a.isLine=!1),a.overflow=s),this._element._styleMap[r?"link.agent.flow.offset":"link.flow.offset"]=s,t.beginPath(),Ye._drawLine(e,t),t.stroke(),t.shadowColor="transparent",t.beginPath();var h=this._element.getStyle(r?"link.agent.flow.color":"link.flow.color");h=h||kn.NETWORK_LINK_FLOW_COLOR,t.strokeStyle=h,Ye._drawLine(e,a),t.stroke(),t.shadowColor=this._shadowColor}else t.beginPath(),Ye.drawLinePoints(t,e,o),t.stroke()},getLinkPoints:function(){return this._linkPoints||(this._linkPoints=this.createLinkPoints(),this._lineLength=We.calculateLineLength(this._linkPoints)),this._linkPoints},getFromPosition:function(t,e){var i=this.getFromPoint();return i?{x:i.x+t,y:i.y+e}:null},getToPosition:function(t,e){var i=this.getToPoint();return i?{x:i.x+t,y:i.y+e}:null},getFromPoint:function(){return this._fromPoint||(this._fromPoint=vi.createFromPoint(this,this._network.zoomManager)),this._fromPoint},getToPoint:function(){return this._toPoint||(this._toPoint=vi.createToPoint(this,this._network.zoomManager)),this._toPoint},getZoomBodyRect:function(){return this.getBodyRect()},getZoomViewRect:function(){return this._viewRect},createLinkPoints:function(){var t=this._network.zoomManager,e=this.getStyle("link.type"),i=new De.List;if(vi.isOrthogonalOrFlexionalLink(this._element))i=vi.orthogonalAndFlexional(this,e,t);else if(this._element.isLooped()){var n=this._network.getElementUI(this._element.getFromAgent());null!=n&&(this._hotSpot=vi.fillLoopedPoints(this,n.getZoomBodyRect(),i))}else{if("arc"!==e&&"triangle"!==e&&"parallel"!==e)throw"Can not resolve link type '"+e+"'";var o=this.getFromPoint(),r=this.getToPoint();this._hotSpot=vi.fillBundlePoints(this,e,o,r,i,t)}if(this._network._linkPathFunction){var a=this._network._linkPathFunction(this,i);a&&(i=a)}return i},checkAttachments:function(){De.vector.LinkUI.superClass.checkAttachments.call(this),this.checkLinkHandlerAttachment()},checkLinkHandlerAttachment:function(){var t=this._network.getLinkHandlerLabel(this._element);null!=t&&""!==t?this._linkHandlerAttachment||(this._linkHandlerAttachment=new De.vector.LinkHandlerAttachment(this),this.addAttachment(this._linkHandlerAttachment)):this._linkHandlerAttachment&&(this.removeAttachment(this._linkHandlerAttachment),this._linkHandlerAttachment=null)},getLinkHandlerAttachment:function(){return this._linkHandlerAttachment},getControlPoint:function(){return vi.getControlPoint(this._element,this,this._network.zoomManager)},setControlPoint:function(t){if(t){var e=this.getStyle("link.type");if(vi.hasControlPoint(e)){var i=vi.getLinkSourceBounds(this,this._network.zoomManager),n=vi.getLinkTargetBounds(this,this._network.zoomManager);vi.setParamsByControlPoint(t,i,n,e,this._element)}}},getLineLength:function(){return this._lineLength},hit:function(t,e){var i={x:t,y:e,width:0,height:0},n=this._network.getSelectionTolerance();return n&&n>0&&We.grow(i,n,n),!!We.intersects(this._viewRect,i)&&this.hitCanvasPoint(t,e)},intersects:function(t){if(1==De.vector.NodeUI.superClass.intersects.apply(this,arguments))return!0;if(0==We.intersects(t,this._viewRect))return!1;var e=this.getLinkPoints(),i=e.size();if(2==i)for(var n=0;i>n;n+=2){var o=e.get(n);if(i>n+1){var r=e.get(n+1);if(Nn.intersectsLine(o.x,o.y,r.x,r.y,t.x,t.y,t.width,t.height))return!0}}return this.hitCanvasRect(t)},getAngle:function(){return!this._angle&&this._fromPoint&&this._toPoint&&(this._angle=We.getAngle(this._fromPoint,this._toPoint)),this._angle||0},getAbsoluteAngle:function(){var t={x:10,y:0},e=this._fromPoint,i=this._toPoint,n={x:i.x-e.x,y:i.y-e.y},o=180*Math.acos((n.x*t.x+n.y*t.y)/(Math.sqrt(t.x*t.x+t.y*t.y)*Math.sqrt(n.x*n.x+n.y*n.y)))/Math.PI;return o=e.y<=i.y?o:360-o,o=o%360*Math.PI/180},appendShadowBound:function(t,e){if(t.isShadowable()&&this._shadowColor&&!this._editAttachment){this._shadowXOffset>0?e.width+=this._shadowXOffset:(e.x+=this._shadowXOffset,e.width+=-this._shadowXOffset),this._shadowYOffset>0?e.height+=this._shadowYOffset:(e.y+=this._shadowYOffset,e.height+=-this._shadowYOffset);var i=this._shadowBlur;We.grow(e,i+1,i+1)}return e}}),De.vector.GroupUI=function(t,e){De.vector.GroupUI.superClass.constructor.call(this,t,e)},Me.ext("twaver.vector.GroupUI",De.vector.NodeUI,{isEditable:function(){return!this._element.isExpanded()},paintBody:function(t){this._shapeRect?this._element.getStyle("group.expend.image")?(De.vector.GroupUI.superClass.paintBody.apply(this,arguments),this._element.getStyle("group.expend.image.vector")&&this.drawExpandedGroup(t)):this.drawExpandedGroup(t):De.vector.GroupUI.superClass.paintBody.apply(this,arguments)},validateBodyBounds:function(){if(this.getBodyRect(),this._shapeRect){var t=this.getPathRect("group",!1),e=this.getStyle("group.deep");We.grow(t,e+1,e+1),this.addBodyBounds(t)}else De.vector.GroupUI.superClass.validateBodyBounds.call(this)},getZoomBodyRect:function(){return this._element.isExpanded()?this.getBodyRect():De.vector.GroupUI.superClass.getZoomBodyRect.call(this)},getZoomViewRect:function(){return this._element.isExpanded()?this.getViewRect():De.vector.GroupUI.superClass.getZoomViewRect.call(this)},drawExpandedGroup:function(t){this.drawPath(t,"group",!1,this._element.getStyle("vector.outline.pattern"));var e=this.getStyle("group.deep"),i=this.getStyle("group.fill.color");0!==e&&i&&"rectangle"===this.getStyle("group.shape")&&Ye.draw3DRect(t,i,e,this._shapeRect)},getChildrenRects:function(){return this._network.getGroupChildrenRects(this._element)},createBodyRect:function(){this._shapeRect=null;var t=this._element,e=this._network;if(t.isExpanded()){t.getChildren().forEach(function(t){var i=e.getElementUI(t);i&&i.validate()});var i=this.getChildrenRects();if(!i.isEmpty()){var n=t.getStyle("group.shape"),o=Ge[n];if(!o)throw"Can not resolve group shape '"+n+"'";this._shapeRect=o(i)}}return this._shapeRect?(We.addPadding(this._shapeRect,t,"group.padding",1),this._shapeRect):De.vector.GroupUI.superClass.createBodyRect.call(this)},appendShadowBound:function(t,e){if(t.isShadowable()&&this._shadowColor&&!this._editAttachment){this._shadowXOffset>0?e.width+=this._shadowXOffset:(e.x+=this._shadowXOffset,e.width+=-this._shadowXOffset),this._shadowYOffset>0?e.height+=this._shadowYOffset:(e.y+=this._shadowYOffset,e.height+=-this._shadowYOffset);var i=this._shadowBlur;We.grow(e,i+1,i+1)}return e}}),De.vector.ShapeNodeUI=function(t,e){De.vector.ShapeNodeUI.superClass.constructor.call(this,t,e)},Me.ext("twaver.vector.ShapeNodeUI",De.vector.NodeUI,{getDefaultBodyRect:function(){return this._element._points.size()<2?null:this._reverseZoomPathRect()},drawDefaultBody:function(t){this._element._points.size()<2||(this.drawPath(t,"vector",!0,this._element.getStyle("vector.outline.pattern"),this._getZoomPoints(),this._element._segments,this._element.getStyle("shapenode.closed")),cn.drawLinkArrow(this,t,We.getPointObject(this._element._points,this._element._segments)))},invalidateZoom:function(){this._zoomPoints=null,De.vector.LinkUI.superClass.invalidateZoom.call(this)},_getZoomPoints:function(){return this._zoomPoints=this._network.zoomManager._getShapeNodeZoomPoints(this,this._element._points),this._zoomPoints},_reverseZoomPathRect:function(){return this._network.zoomManager._reverseElementZoomRect(this,this.getZoomPathRect("vector",!0))}}),De.vector.ShapeLinkUI=function(t,e){De.vector.ShapeLinkUI.superClass.constructor.call(this,t,e)},Me.ext("twaver.vector.ShapeLinkUI",De.vector.LinkUI,{isEditable:function(){return!0},createLinkPoints:function(){var t=this.getFromPoint(),e=this.getToPoint(),i=new De.List,n=this.getStyle("shapelink.type");i.add(t),null!=this._element._points&&i.addAll(this._network.zoomManager._getShapeLinkZoomPoints(this._element._points)),i.add(e);var o,r,a;if("lineto"===n);else if("quadto"===n){for(o=new De.List(i.get(0)),r=1,pointCount=i.size();r<pointCount;r++)o.add(r<pointCount-1?new De.List([i.get(r++),i.get(r)]):i.get(r));i=o}else if("cubicto"===n){for(o=new De.List(i.get(0)),r=1,pointCount=i.size();r<pointCount;r++)o.add(r<pointCount-2?new De.List([i.get(r++),i.get(r++),i.get(r)]):r<pointCount-1?new De.List([i.get(r++),i.get(r)]):i.get(r));i=o}else{if("orthogonalto"!==n)throw"Can not resolve shapelink type '"+n+"'";for(a=i.get(0),o=new De.List(a),r=1,pointCount=i.size();r<pointCount;r++)if(r<pointCount-1){var s=Me.clone(i.get(r)),l=s.x,h=s.y,c=l-a.x,u=h-a.y;Math.abs(c)>Math.abs(u)?(s.x=l,s.y=a.y):(s.x=a.x,s.y=h),a=s,o.add(a)}else o.add(i.get(r));i=o}var d,f,p,s,g,c,u,_=We.calculateLineLength(i)/2,m=i.size(),v=0,y=0;for(d=0;m>d;d++)if(s=i.get(d),0!=d){if(p=s,p instanceof hn&&(p=p._as),p instanceof Array?(g=We.calculateCurveLength(f,p,1),f=p[p.length-1]):(u=s.y-f.y,c=s.x-f.x,g=Math.sqrt(c*c+u*u),f=p),y+=g,_>=v&&y>=_){var w=_-v,b=i.get(d-1);b instanceof hn&&(b=b._as)instanceof Array&&(b=b[b.length-1]);var x=i.get(d),A=We.getPathInfo(x,b,w,0,-1).point;this._hotSpot=Me.clone(A)}v=y}else f=s;return i},_growLinkJoinBounds:function(t,e){We.grow(t,3*e,3*e)}}),De.vector.GridUI=function(t,e){De.vector.GridUI.superClass.constructor.call(this,t,e)},Me.ext("twaver.vector.GridUI",De.vector.NodeUI,{drawDefaultBody:function(t){this._element.getImage()?De.vector.GridUI.superClass.drawDefaultBody.apply(this,arguments):this.drawGridBody(t)},validateBodyBounds:function(){if(this._element.getImage())De.vector.GridUI.superClass.validateBodyBounds.call(this);else{var t=this.getBodyRect(),e=Me.clone(t),i=this._element.getStyle("outer.width");We.grow(e,i,i),this.appendShadowBound(this,e),this.addBodyBounds(e)}},_getZoomCellRect:function(t,e){var i=this._element.getCellRect(t,e),n=this._element.getRect(),o=n.x+n.width/2,r=n.y+n.height/2,a=this.getZoomBodyRect(),s=a.width/n.width,l=a.x+a.width/2,h=0==o?1:l/o;return{x:o*h+(i.x-o)*s,y:r*h+(i.y-r)*s,width:i.width*s,height:i.height*s}},drawGridBody:function(t){var e=this.getStyle("grid.fill"),i=this.getStyle("grid.deep"),n=this.getStyle("grid.cell.deep");if(e||0!==i||0!==n){t.beginPath();var o=this.getZoomBodyRect(),r=this.getDyeColor("grid.fill.color");if(this.setGlow(this,t),this.setShadow(this,t),e&&(t.fillStyle=r,t.rect(o.x,o.y,o.width,o.height),t.fill()),t.closePath(),this.clearShadow(t),t.beginPath(),0!=i&&Ye.draw3DRect(t,r,i,o.x,o.y,o.width,o.height),t.closePath(),0!=n)for(var a=this.getStyle("grid.row.count"),s=this.getStyle("grid.column.count"),l=0;a>l;l++)for(var h=0;s>h;h++){var c=this._getZoomCellRect(l,h);null!=c&&(t.beginPath(),Ye.draw3DRect(t,r,n,c.x,c.y,c.width,c.height),t.closePath())}}}}),De.vector.RotatableNodeUI=function(t,e){De.vector.RotatableNodeUI.superClass.constructor.call(this,t,e)},Me.ext("twaver.vector.RotatableNodeUI",De.vector.NodeUI,{isEditable:function(){return!1},getDefaultBodyRect:function(){var t=this._element,e=Me.getImageAsset(t.getImage()),i=this.getBodyRect();return e?(We.addPadding(i,this._element,"image.padding",1),i):i},drawDefaultBody:function(t){var e=this._element,i=Me.getImageAsset(e.getImage());if(i){var n=this.getBodyRect();if(We.addPadding(n,this._element,"image.padding",1),i.getImage()){var o=this._element._getOrignalWidth(),r=this._element._getOrignalHeight(),a=this._element._getRotateRect();t.save(),t.translate(n.x-a.x+o/2,n.y-a.y+r/2),t.rotate(this._element._angle*Math.PI/180),t.drawImage(i.getImage(this._innerColor),-o/2,-r/2,o,r),t.restore()}else if(i.getSrc());else if(!i.getFunction())throw"ImageAsset '"+e.getImage()+" ' is empty"}}}),De.vector.HTMLNodeUI=function(t,e){De.vector.HTMLNodeUI.superClass.constructor.call(this,t,e)},Me.ext("twaver.vector.HTMLNodeUI",De.vector.NodeUI,{checkAttachments:function(){De.vector.NodeUI.prototype.checkAttachments.call(this)},checkLabelAttachment:function(){var t=this._element.getStyle("attachment.label.style");if(t&&"none"===t)return void De.vector.HTMLNodeUI.superClass.checkLabelAttachment.call(this);var e=this._network.getLabel(this._element);null!=e&&""!==e?this._labelAttachment||(this._labelAttachment=new De.vector.HTMLLabelAttachment(this,kn.SHOW_LABEL_IN_ATTACHMENT_DIV),this.addAttachment(this._labelAttachment)):this._labelAttachment&&(this.removeAttachment(this._labelAttachment),this._labelAttachment=null)},checkLabel2Attachment:function(){var t=this._element.getStyle("attachment.label2.style");if(t&&"none"===t)return void De.vector.HTMLNodeUI.superClass.checkLabel2Attachment.call(this);var e=this._network.getLabel2(this._element);null!=e&&""!==e?this._label2Attachment||(this._label2Attachment=new De.vector.HTMLLabel2Attachment(this,kn.SHOW_LABEL_IN_ATTACHMENT_DIV),this.addAttachment(this._label2Attachment)):this._label2Attachment&&(this.removeAttachment(this._label2Attachment),this._label2Attachment=null)},checkAlarmAttachment:function(){var t=this._element.getStyle("attachment.alarm.style");if(t&&"none"===t)return void De.vector.HTMLNodeUI.superClass.checkAlarmAttachment.call(this);var e=this._network.getAlarmLabel(this._element);null!=e&&""!==e?this._alarmAttachment||(this._alarmAttachment=new De.vector.HTMLAlarmAttachment(this,!1),this.addAttachment(this._alarmAttachment)):this._alarmAttachment&&(this.removeAttachment(this._alarmAttachment),this._alarmAttachment=null)},setAttachmentVisible:function(t){t?(this._labelAttachment&&this._labelAttachment.setVisibility("visible"),this._label2Attachment&&this._label2Attachment.setVisibility("visible"),this._alarmAttachment&&this._alarmAttachment.setVisibility("visible")):(this._labelAttachment&&this._labelAttachment.setVisibility("hidden"),this._label2Attachment&&this._label2Attachment.setVisibility("hidden"),this._alarmAttachment&&this._alarmAttachment.setVisibility("hidden"))},validateZIndex:function(t){this._labelAttachment&&this._labelAttachment.validateZIndex(t)}}),De.vector.HTMLLinkUI=function(t,e){De.vector.HTMLLinkUI.superClass.constructor.call(this,t,e)},Me.ext("twaver.vector.HTMLLinkUI",De.vector.LinkUI,{checkAttachments:function(){De.vector.LinkUI.prototype.checkAttachments.call(this)},checkLabelAttachment:function(){var t=this._element.getStyle("attachment.label.style");if(t&&"none"===t)return void De.vector.HTMLLinkUI.superClass.checkLabelAttachment.call(this);var e=this._network.getLabel(this._element);null!=e&&""!==e?this._labelAttachment||(this._labelAttachment=new De.vector.HTMLLabelAttachment(this,kn.SHOW_LABEL_IN_ATTACHMENT_DIV),this.addAttachment(this._labelAttachment)):this._labelAttachment&&(this.removeAttachment(this._labelAttachment),this._labelAttachment=null)},checkLabel2Attachment:function(){var t=this._element.getStyle("attachment.label2.style");if(t&&"none"===t)return void De.vector.HTMLNodeUI.superClass.checkLabelAttachment.call(this);var e=this._network.getLabel2(this._element);null!=e&&""!==e?this._label2Attachment||(this._label2Attachment=new De.vector.HTMLLabel2Attachment(this,kn.SHOW_LABEL_IN_ATTACHMENT_DIV),this.addAttachment(this._label2Attachment)):this._label2Attachment&&(this.removeAttachment(this._label2Attachment),this._label2Attachment=null)},checkAlarmAttachment:function(){var t=this._element.getStyle("attachment.alarm.style");if(t&&"none"===t)return void De.vector.HTMLLinkUI.superClass.checkAlarmAttachment.call(this);var e=this._network.getAlarmLabel(this._element);null!=e&&""!==e?this._alarmAttachment||(this._alarmAttachment=new De.vector.HTMLAlarmAttachment(this,!1),this.addAttachment(this._alarmAttachment)):this._alarmAttachment&&(this.removeAttachment(this._alarmAttachment),this._alarmAttachment=null)},setAttachmentVisible:function(t){t?(this._labelAttachment&&this._labelAttachment.setVisibility("visible"),this._label2Attachment&&this._label2Attachment.setVisibility("visible"),this._alarmAttachment&&this._alarmAttachment.setVisibility("visible")):(this._labelAttachment&&this._labelAttachment.setVisibility("hidden"),this._label2Attachment&&this._label2Attachment.setVisibility("hidden"),this._alarmAttachment&&this._alarmAttachment.setVisibility("hidden"))}}),De.vector.Attachment=function(t,e){this._ui=t,this._element=this._ui.getElement(),this._network=t.getNetwork(),this._showOnTop=e,e&&this._network._hitTestTopAttachmentList.add(this)},Me.ext("twaver.vector.Attachment",Object,{getElement:function(){return this._element},getElementUI:function(){return this._ui},getNetwork:function(){return this._network},isShowOnTop:function(){return!0===this._showOnTop},setShowOnTop:function(t){this._showOnTop=t},getStyle:function(t){return this._ui.getStyle(t)},getFont:function(t){return this._ui.getFont(t)},getViewRect:function(){return Me.clone(this._viewRect)},getAlpha:function(){return 1},validate:function(){},paint:function(t){},getZoomViewRect:function(){return this._network.zoomManager._getAttachmentZoomOutLineRect(this,this._viewRect)},hit:function(t,e){return!!We.containsPoint(this.getZoomViewRect(),t,e)&&this.hitCanvasRect({x:t-1,y:e-1,width:2,height:2})},hitCanvasRect:function(t){var e=Nn.getHitCanvas(t.width,t.height),i=Nn.getCtx(e);i.save(),i.translate(-t.x,-t.y),this.paint(i);try{for(var n=i.getImageData(0,0,t.width,t.height),o=n.data,r=0;r<n.width;r++)for(var a=0;a<n.height;a++){var s=4*(a*n.width+r),l=o[s+3];if(0!==l)return i.restore(),!0}}catch(t){Nn.disposeHitCanvas()}return i.restore(),!1},dispose:function(){this._network._hitTestTopAttachmentList.remove(this)},_rotatePoint:function(t,e,i){return We.createMatrix(e*Math.PI/180,i.x+i.width/2,i.y+i.height/2).transform(t)},_rotatePointList:function(t,e,i){var n=this,o=new De.List;return t.forEach(function(t){o.add(n._rotatePoint(t,e,i))}),o}}),De.vector.BasicAttachment=function(t,e){De.vector.BasicAttachment.superClass.constructor.call(this,t,e),this._roundRect={x:0,y:0,width:0,height:0},this._contentRect={x:0,y:0,width:0,height:0}},Me.ext("twaver.vector.BasicAttachment",De.vector.Attachment,{paint:function(t){De.vector.BasicAttachment.superClass.paint.apply(this,arguments);var e=this.isFill(),i=this.getOutlineWidth(),n=this._network.zoomManager._getAttachmentZoomOutLineRect(this,this._roundRect);if(this.getElementUI().setGlow(this,t),this.getElementUI().setShadow(this,t),i>0||e){if(Ye.drawRoundRect(t,n.x,n.y,n.width,n.height,this.getCornerRadius()),this._network._debug&&Ye.strokeRect(t,n,"#C71585"),this._pointers){var o=this._ui.getZoomPointers(this,this._pointers);t.moveTo(o[0].x,o[0].y),t.lineTo(o[1].x,o[1].y),t.lineTo(o[2].x,o[2].y)}if(t.closePath(),i>0&&(t.lineWidth=i,t.strokeStyle=this.getOutlineColor(),t.lineCap=this.getCap(),t.lineJoin=this.getJoin(),t.stroke()),e){var r=this.getFillColor(),a=this.getGradient();a?Ye.fill(t,r,a,this.getGradientColor(),this._viewRect):t.fillStyle=r,t.fill()}}},validate:function(){De.vector.BasicAttachment.superClass.validate.call(this),this.calculateMeasure();var t=this.getOutlineWidth();if((null==t||0>=t)&&(t=1),this._viewRect=We.getRect(this._pointers),this._viewRect=We.unionRect(this._viewRect,this._roundRect),t>0&&We.grow(this._viewRect,2*t,2*t),this._viewRect=this._ui.appendShadowBound(this,this._viewRect),this._element instanceof De.Link&&this._element.getStyle("link.label.rotatable")){var e=this._viewRect.x+this._viewRect.width/2,i=this._viewRect.y+this._viewRect.height/2,n=Math.sqrt(this._viewRect.height*this._viewRect.height+this._viewRect.width*this._viewRect.width);this._viewRect={x:e-n,y:i-n,width:2*n,height:2*n}}},calculateMeasure:function(){var t=this.getContentWidth(),e=this.getContentHeight(),i=this.getCornerRadius(),n=this.getPointerLength(),o=this.getPointerWidth(),r=this.getPosition(),a=this.getXOffset(),s=this.getYOffset(),l=this._roundRect;l.width=t+i,l.height=e;var h;if(this._ui._element instanceof De.Link){var c,u=this._ui.getLinkPoints();c=this._ui.getLineLength?this._ui.getLineLength():this._ui._element.getLineLength(),Math.abs(a)>0&&Math.abs(a)<1?"from"===r?a*=c:"to"===r?a=c*(1-a):(a/=2,a+=.5,a*=c):"from"===r?a=a:"to"===r?a=c-a:a+=c/2;var d,f=We.calculatePointInfoAlongLine(u,!0,a,s),p=f.point;f.angle,d="from"===r?this._ui.getFromPoint():"to"===r?this._ui.getToPoint():this._ui._hotSpot,a=p.x-d.x,s=p.y-d.y}if(n>0){var g=this.getDirection();h=this._network.getPosition(r,this._ui,null,a,s,!1);var _;if("aboveleft"===g)l.y=h.y-n-l.height,l.x=h.x-(l.width-i),_=Math.max(h.x-o,h.x-(l.width-i)+i/2),this._pointers=[h,{x:h.x,y:h.y-n},{x:_,y:h.y-n}];else if("aboveright"===g)l.y=h.y-n-l.height,l.x=h.x-i,_=Math.min(h.x+o,h.x-i+l.width-i/2),this._pointers=[h,{x:h.x,y:h.y-n},{x:_,y:h.y-n}];else if("belowleft"===g)l.y=h.y+n,l.x=h.x-(l.width-i),_=Math.max(h.x-o,h.x-(l.width-i)+i/2),this._pointers=[h,{x:h.x,y:h.y+n},{x:_,y:h.y+n}];else if("belowright"===g)l.y=h.y+n,l.x=h.x-i,_=Math.min(h.x+o,h.x-i+l.width-i/2),this._pointers=[h,{x:h.x,y:h.y+n},{x:_,y:h.y+n}];else if("leftabove"===g)l.y=h.y+i-l.height,l.x=h.x-n-l.width,_=Math.max(h.y-o,h.y+i-l.height+i/2),this._pointers=[h,{x:h.x-n,y:h.y},{x:h.x-n,y:_}];else if("leftbelow"===g)l.y=h.y-i,l.x=h.x-n-l.width,_=Math.min(h.y+o,h.y-i+l.height-i/2),this._pointers=[h,{x:h.x-n,y:h.y},{x:h.x-n,y:_}];else if("rightabove"===g)l.y=h.y+i-l.height,l.x=h.x+n,_=Math.max(h.y-o,h.y+i-l.height+i/2),this._pointers=[h,{x:h.x+n,y:h.y},{x:h.x+n,y:_}];else if("rightbelow"===g)l.y=h.y-i,l.x=h.x+n,_=Math.min(h.y+o,h.y-i+l.height-i/2),this._pointers=[h,{x:h.x+n,y:h.y},{x:h.x+n,y:_}];else if("above"===g)l.y=h.y-n-l.height,l.x=h.x-l.width/2,_=Math.min(t/2,o/2),this._pointers=[h,{x:h.x-_,y:h.y-n},{x:h.x+_,y:h.y-n}];else if("below"===g)l.y=h.y+n,l.x=h.x-l.width/2,_=Math.min(t/2,o/2),this._pointers=[h,{x:h.x-_,y:h.y+n},{x:h.x+_,y:h.y+n}];else if("left"===g)l.y=h.y-l.height/2,l.x=h.x-n-l.width,_=Math.min(e/2,o/2),this._pointers=[h,{x:h.x-n,y:h.y+_},{x:h.x-n,y:h.y-_}];else{if("right"!==g)throw"Can not resolve '"+g+"' attachment direction";l.y=h.y-l.height/2,l.x=h.x+n,_=Math.min(e/2,o/2),this._pointers=[h,{x:h.x+n,y:h.y+_},{x:h.x+n,y:h.y-_}]}}else h=this._network.getPosition(r,this._ui,{width:l.width,height:l.height},a,s,!1),l.x=h.x,l.y=h.y,this._pointers=null;this._contentRect.x=l.x+(l.width-t)/2,this._contentRect.y=l.y+(l.height-e)/2,this._contentRect.width=t,this._contentRect.height=e;var m=this.getPadding();0!=m&&We.grow(l,m,m),m=this.getPaddingLeft(),0!=m&&(l.x-=m,l.width+=m),m=this.getPaddingRight(),0!=m&&(l.width+=m),m=this.getPaddingTop(),0!=m&&(l.y-=m,l.height+=m),m=this.getPaddingBottom(),0!=m&&(l.height+=m),l.width<0&&(l.width=l.width,l.x-=l.width),l.height<0&&(l.height=-l.height,l.y-=l.height)},getContentWidth:function(){return De.Defaults.ATTACHMENT_CONTENT_WIDTH},getContentHeight:function(){return De.Defaults.ATTACHMENT_CONTENT_HEIGHT},getCornerRadius:function(){return De.Defaults.ATTACHMENT_CORNER_RADIUS},getPointerLength:function(){return De.Defaults.ATTACHMENT_POINTER_LENGTH},getPointerWidth:function(){return De.Defaults.ATTACHMENT_POINTER_WIDTH},getPosition:function(){return De.Defaults.ATTACHMENT_POSITION},getXOffset:function(){return De.Defaults.ATTACHMENT_XOFFSET},getYOffset:function(){return De.Defaults.ATTACHMENT_YOFFSET},getPadding:function(){return De.Defaults.ATTACHMENT_PADDING},getPaddingLeft:function(){return De.Defaults.ATTACHMENT_PADDING_LEFT},getPaddingRight:function(){return De.Defaults.ATTACHMENT_PADDING_RIGHT},getPaddingTop:function(){return De.Defaults.ATTACHMENT_PADDING_TOP},getPaddingBottom:function(){return De.Defaults.ATTACHMENT_PADDING_BOTTOM},getDirection:function(){return De.Defaults.ATTACHMENT_DIRECTION},isFill:function(){return De.Defaults.ATTACHMENT_FILL},getFillColor:function(){return De.Defaults.ATTACHMENT_FILL_COLOR},getGradient:function(){return De.Defaults.ATTACHMENT_GRADIENT},getGradientColor:function(){return De.Defaults.ATTACHMENT_GRADIENT_COLOR},getOutlineWidth:function(){return De.Defaults.ATTACHMENT_OUTLINE_WIDTH},getOutlineColor:function(){return De.Defaults.ATTACHMENT_OUTLINE_COLOR},getCap:function(){return De.Defaults.ATTACHMENT_CAP},getJoin:function(){return De.Defaults.ATTACHMENT_JOIN},isShadowable:function(){return De.Defaults.ATTACHMENT_SHADOWABLE},getRoundRect:function(){return Me.clone(this._roundRect)},getContentRect:function(){return Me.clone(this._contentRect)}}),De.vector.LabelAttachment=function(t,e){De.vector.LabelAttachment.superClass.constructor.call(this,t,e)},Me.ext("twaver.vector.LabelAttachment",De.vector.BasicAttachment,{paint:function(t){var e=this._element instanceof De.Link&&this._element.getStyle("link.label.rotatable");if(e){t.save();var i=this.getZoomViewRect(),n=i.x+i.width/2,o=i.y+i.height/2;t.translate(n,o),t.rotate(this._network.getElementUI(this._element).getAngle()),t.translate(-n,-o)}De.vector.LabelAttachment.superClass.paint.apply(this,arguments);var r=this._network.zoomManager,a=r._getAttachmentZoomRect(this,this._contentRect),s=this._element.getStyle("label.align"),l=this._element&&this._element.getStyle("label.rotate.angle");if(0!==l&&(t.save(),De.Util.rotateCanvas(t,this._contentRect,l)),r._drawText(this,t,this.text,a,this.font,this.getStyle("label.color"),s),(e||0!==l)&&t.restore(),this._network._debug){var h=this._viewRect;Ye.strokeRect(t,h,"#AAABBB")}},validate:function(){this.font=this.getFont("label.font");var t=this.getLabel(),e=Me.g.getTextSize(this.font,t),i=this.getMaxLength();0!==i&&e.width>i?(this.text=Me.g.getCollapseTextInLength(this.font,t,i),this._textSize=Me.g.getTextSize(this.font,this.text)):(this.text=t,this._textSize=e),De.vector.LabelAttachment.superClass.validate.call(this);var n=this._viewRect,o=this._element&&this._element.getStyle("label.rotate.angle");if(0!==o){var r=new De.List;r.add({x:n.x,y:n.y}),r.add({x:n.x+n.width,y:n.y}),r.add({x:n.x+n.width,y:n.y+n.height}),r.add({x:n.x,y:n.y+n.height}),r=this._rotatePointList(r,o,n);var a=De.Util.getRect(r);this._viewRect=a}},getLabel:function(){return this._network.getLabel(this._element)},getContentWidth:function(){return this._textSize?this._textSize.width:0},getContentHeight:function(){return this._textSize?this._textSize.height:0},getCornerRadius:function(){return this.getStyle("label.corner.radius")},getPointerLength:function(){return this.getStyle("label.pointer.length")},getPointerWidth:function(){return this.getStyle("label.pointer.width")},getPosition:function(){return this.getStyle("label.position")},getXOffset:function(){return this.getStyle("label.xoffset")},getYOffset:function(){return this.getStyle("label.yoffset")},getPadding:function(){return this.getStyle("label.padding")},getPaddingLeft:function(){return this.getStyle("label.padding.left")},getPaddingRight:function(){return this.getStyle("label.padding.right")},getPaddingTop:function(){return this.getStyle("label.padding.top")},getPaddingBottom:function(){return this.getStyle("label.padding.bottom")},getDirection:function(){return this.getStyle("label.direction")},isFill:function(){return this.getStyle("label.fill")},getFillColor:function(){return this.getStyle("label.fill.color")},getGradient:function(){return this.getStyle("label.gradient")},getGradientColor:function(){return this.getStyle("label.gradient.color")},getOutlineWidth:function(){return this.getStyle("label.outline.width")},getOutlineColor:function(){return this.getStyle("label.outline.color")},getCap:function(){return this.getStyle("label.cap")},getJoin:function(){return this.getStyle("label.join")},getAlpha:function(){return this.getStyle("label.alpha")},getMaxLength:function(){return this.getStyle("label.maxlength")},isShadowable:function(){return this.getStyle("label.shadowable")}}),De.vector.Label2Attachment=function(t,e){De.vector.Label2Attachment.superClass.constructor.call(this,t,e)},Me.ext("twaver.vector.Label2Attachment",De.vector.BasicAttachment,{paint:function(t){var e=this._element instanceof De.Link&&this._element.getStyle("link.label.rotatable");if(e){t.save();var i=this.getZoomViewRect(),n=i.x+i.width/2,o=i.y+i.height/2;t.translate(n,o),t.rotate(this._network.getElementUI(this._element).getAngle()),t.translate(-n,-o)}De.vector.Label2Attachment.superClass.paint.apply(this,arguments);var r=this._network.zoomManager,a=r._getAttachmentZoomRect(this,this._contentRect),s=this._element.getStyle("label.align"),l=this._element&&this._element.getStyle("label2.rotate.angle");if(0!==l&&(t.save(),De.Util.rotateCanvas(t,this._contentRect,l)),r._drawText(this,t,this.text,a,this.font,this.getStyle("label2.color"),s),(e||0!==l)&&t.restore(),this._network._debug){var h=r.getAttachmentSizeZoom(this),c=a;c.width*=h,c.height*=h,Ye.strokeRect(t,c,"#AAABBB")}},validate:function(){this.font=this.getFont("label2.font");var t=this.getLabel(),e=Me.g.getTextSize(this.font,t),i=this.getMaxLength();0!==i&&e.width>i?(this.text=Me.g.getCollapseTextInLength(this.font,t,i),this._textSize=Me.g.getTextSize(this.font,this.text)):(this.text=t,this._textSize=e),De.vector.LabelAttachment.superClass.validate.call(this);var n=this._viewRect,o=this._element&&this._element.getStyle("label2.rotate.angle");if(0!==o){var r=new De.List;r.add({x:n.x,y:n.y}),r.add({x:n.x+n.width,y:n.y}),r.add({x:n.x+n.width,y:n.y+n.height}),r.add({x:n.x,y:n.y+n.height}),r=this._rotatePointList(r,o,n);var a=De.Util.getRect(r);this._viewRect=a}},getLabel:function(){return this._network.getLabel2(this._element)},getContentWidth:function(){return this._textSize?this._textSize.width:0},getContentHeight:function(){return this._textSize?this._textSize.height:0},getCornerRadius:function(){return this.getStyle("label2.corner.radius")},getPointerLength:function(){return this.getStyle("label2.pointer.length")},getPointerWidth:function(){return this.getStyle("label2.pointer.width")},getPosition:function(){return this.getStyle("label2.position")},getXOffset:function(){return this.getStyle("label2.xoffset")},getYOffset:function(){return this.getStyle("label2.yoffset")},getPadding:function(){return this.getStyle("label2.padding")},getPaddingLeft:function(){return this.getStyle("label2.padding.left")},getPaddingRight:function(){return this.getStyle("label2.padding.right")},getPaddingTop:function(){return this.getStyle("label2.padding.top")},getPaddingBottom:function(){return this.getStyle("label2.padding.bottom")},getDirection:function(){return this.getStyle("label2.direction")},isFill:function(){return this.getStyle("label2.fill")},getFillColor:function(){return this.getStyle("label2.fill.color")},getGradient:function(){return this.getStyle("label2.gradient")},getGradientColor:function(){return this.getStyle("label2.gradient.color")},getOutlineWidth:function(){return this.getStyle("label2.outline.width")},getOutlineColor:function(){return this.getStyle("label2.outline.color")},getCap:function(){return this.getStyle("label2.cap")},getJoin:function(){return this.getStyle("label2.join")},getAlpha:function(){return this.getStyle("label2.alpha")},getMaxLength:function(){return this.getStyle("label2.maxlength")},isShadowable:function(){return this.getStyle("label2.shadowable")}}),De.vector.AlarmAttachment=function(t,e){De.vector.AlarmAttachment.superClass.constructor.call(this,t,e)},Me.ext("twaver.vector.AlarmAttachment",De.vector.BasicAttachment,{paint:function(t){De.vector.AlarmAttachment.superClass.paint.apply(this,arguments);var e=this._network.zoomManager,i=e._getAttachmentZoomRect(this,this._contentRect);e._drawText(this,t,this.text,i,this.font,this.getStyle("alarm.color"))},validate:function(){this.font=this.getFont("alarm.font"),this.text=this._network.getAlarmLabel(this._element),this._textSize=Ye.getTextSize(this.font,this.text),this._fillColor=this._network.getAlarmFillColor(this._element),De.vector.AlarmAttachment.superClass.validate.call(this)},getContentWidth:function(){return this._textSize?this._textSize.width:0},getContentHeight:function(){return this._textSize?this._textSize.height:0},getCornerRadius:function(){return this.getStyle("alarm.corner.radius")},getPointerLength:function(){return this.getStyle("alarm.pointer.length")},getPointerWidth:function(){return this.getStyle("alarm.pointer.width")},getPosition:function(){return this.getStyle("alarm.position")},getXOffset:function(){return this.getStyle("alarm.xoffset")},getYOffset:function(){return this.getStyle("alarm.yoffset")},getPadding:function(){return this.getStyle("alarm.padding")},getPaddingLeft:function(){return this.getStyle("alarm.padding.left")},getPaddingRight:function(){return this.getStyle("alarm.padding.right")},getPaddingTop:function(){return this.getStyle("alarm.padding.top")},getPaddingBottom:function(){return this.getStyle("alarm.padding.bottom")},getDirection:function(){return this.getStyle("alarm.direction")},isFill:function(){return null!=this._fillColor},getFillColor:function(){return this._fillColor},getGradient:function(){return this.getStyle("alarm.gradient")},getGradientColor:function(){return this.getStyle("alarm.gradient.color")},getOutlineWidth:function(){return this.getStyle("alarm.outline.width")},getOutlineColor:function(){return this.getStyle("alarm.outline.color")},getCap:function(){return this.getStyle("alarm.cap")},getJoin:function(){return this.getStyle("alarm.join")},getAlpha:function(){return this.getStyle("alarm.alpha")},isShadowable:function(){return this.getStyle("alarm.shadowable")}}),De.vector.LinkHandlerAttachment=function(t,e){De.vector.LinkHandlerAttachment.superClass.constructor.call(this,t,e)},Me.ext("twaver.vector.LinkHandlerAttachment",De.vector.BasicAttachment,{paint:function(t){var e=this._network.zoomManager;De.vector.LinkHandlerAttachment.superClass.paint.apply(this,arguments);var i=e._getAttachmentZoomRect(this,this._contentRect);e._drawText(this,t,this.linkHandlerLabel,i,this.linkHandlerFont,this.getStyle("link.handler.color"))},validate:function(){this.linkHandlerFont=this.getFont("link.handler.font"),this.linkHandlerLabel=this._network.getLinkHandlerLabel(this._element),this._textSize=Ye.getTextSize(this.linkHandlerFont,this.linkHandlerLabel),De.vector.LinkHandlerAttachment.superClass.validate.call(this)},getContentWidth:function(){return this._textSize?this._textSize.width:0},getContentHeight:function(){return this._textSize?this._textSize.height:0},getCornerRadius:function(){return this.getStyle("link.handler.corner.radius")},getPointerLength:function(){return this.getStyle("link.handler.pointer.length")},getPointerWidth:function(){return this.getStyle("link.handler.pointer.width")},getPosition:function(){return this.getStyle("link.handler.position")},getXOffset:function(){return this.getStyle("link.handler.xoffset")},getYOffset:function(){return this.getStyle("link.handler.yoffset")},getPadding:function(){return this.getStyle("link.handler.padding")},getPaddingLeft:function(){return this.getStyle("link.handler.padding.left")},getPaddingRight:function(){return this.getStyle("link.handler.padding.right")},getPaddingTop:function(){return this.getStyle("link.handler.padding.top")},getPaddingBottom:function(){return this.getStyle("link.handler.padding.bottom")},getDirection:function(){return this.getStyle("link.handler.direction")},isFill:function(){return this.getStyle("link.handler.fill")},getFillColor:function(){return this.getStyle("link.handler.fill.color")},getGradient:function(){return this.getStyle("link.handler.gradient")},getGradientColor:function(){return this.getStyle("link.handler.gradient.color")},getOutlineWidth:function(){return this.getStyle("link.handler.outline.width")},getOutlineColor:function(){return this.getStyle("link.handler.outline.color")},getCap:function(){return this.getStyle("link.handler.cap")},getJoin:function(){return this.getStyle("link.handler.join")},getAlpha:function(){return this.getStyle("link.handler.alpha")},isShadowable:function(){return this.getStyle("link.handler.shadowable")}}),De.vector.IconsAttachment=function(t,e){De.vector.IconsAttachment.superClass.constructor.call(this,t,e)},Me.ext("twaver.vector.IconsAttachment",De.vector.Attachment,{isShadowable:function(){return De.Defaults.ATTACHMENT_SHADOWABLE},validate:function(){if(De.vector.IconsAttachment.superClass.validate.call(this),this.iconsNames=this._network.getIconsNames(this._element),this.iconsNames&&0!=this.iconsNames.length){var t=this._makeGroup(this.iconsNames),e=this._makeGroup(this._network.getIconsColors(this._element)),n=this._network.zoomManager;len=t.length,this.iconsOrientation=this._makeArray(this._element.getStyle("icons.orientation"),len,"right"),this.iconsPosition=this._makeArray(this._element.getStyle("icons.position"),len,"topleft.bottomright"),this.iconsXoffset=this._makeArray(this._element.getStyle("icons.xoffset"),len,0),this.iconsYoffset=this._makeArray(this._element.getStyle("icons.yoffset"),len,0),this.iconsXgap=this._makeArray(this._element.getStyle("icons.xgap"),len,1),this.iconsYgap=this._makeArray(this._element.getStyle("icons.ygap"),len,1),this.locations=[],this.iconsSizes=[],this.iconsOrientations=[];var o,r,a;for(i=0;i<len;i++){var s=t[i],a=this.iconsOrientation[i]||"right",l=this.iconsPosition[i]||"topleft.bottomright",h=this.iconsXgap[i]||1,c=this.iconsYgap[i]||1,u=this.iconsXoffset[i]||0,d=this.iconsYoffset[i]||0;if(this._ui._element instanceof De.Link){var f,p=this._ui.getLinkPoints();f=this._ui.getLineLength?this._ui.getLineLength():this._ui._element.getLineLength(),Math.abs(u)>0&&Math.abs(u)<1?"from"===l?u*=f:"to"===l?u=f*(1-u):(u/=2,u+=.5,u*=f):"from"===l?u=u:"to"===l?u=f-u:u+=f/2;var g,_=We.calculatePointInfoAlongLine(p,!0,u,d),m=_.point;_.angle,g="from"===l?this._ui.getFromPoint():"to"===l?this._ui.getToPoint():this._ui._hotSpot,u=m.x-g.x,d=m.y-g.y}r=null,o=this._getIconsSize(s,a,h,c,n),o&&(r=this._network.getPosition(l,this._ui,o,u,d),this._iconLocation=r,"top"===a?r.y+=o.height:"left"===a&&(r.x+=o.width)),this.locations.push(r),this.iconsSizes.push(o),this.iconsOrientations.push(a)}var v=null;for(i=0;i<this.locations.length;i++)r=this.locations[i],o=this.iconsSizes[i],a=this.iconsOrientations[i],null!=r&&(v=null==v?"top"===a?{x:r.x,y:r.y-o.height,width:o.width,height:o.height}:"left"===a?{x:r.x-o.width,y:r.y,width:o.width,height:o.height}:{x:r.x,y:r.y,width:o.width,height:o.height}:"top"===a?We.unionRect(v,{x:r.x,y:r.y-o.height,width:o.width,height:o.height}):"left"===a?We.unionRect(v,{x:r.x-o.width,y:r.y,width:o.width,height:o.height}):We.unionRect(v,{x:r.x,y:r.y,width:o.width,height:o.height}));this._viewRect=n?v||this.getElementUI().getViewRect():v||{x:this._element.getLocation().x,y:this._element.getLocation().y,width:0,height:0},this.iconsGroups=t,this.colorGroups=e;var y=this._element instanceof De.Link&&this._element.getStyle("link.icons.rotatable");for(i=0;i<len;i++)if(y instanceof Array&&y[i]&&this._viewRect){var w=this._viewRect.x+this._viewRect.width/2,b=this._viewRect.y+this._viewRect.height/2,x=Math.sqrt(this._viewRect.height*this._viewRect.height+this._viewRect.width*this._viewRect.width);this._viewRect={x:w-x/2,y:b-x/2,width:x,height:x}}}},_makeGroup:function(t){if(!Array.isArray(t))return[[t]];var e,i,n,o=[],r=!1,a=t.length;for(e=0;a>e;e++)i=t[e],Array.isArray(i)?(r=!0,o.push(i)):(n=[i],o.push(n));return r||(o.length=0,o.push(t)),o},_makeArray:function(t,e,i){if(Array.isArray(t))return t;for(var n=[],o=0;e>o;o++)n.push(t||i);return n},paint:function(t){if(De.vector.IconsAttachment.superClass.paint.apply(this,arguments),this.iconsNames&&0!=this.iconsNames.length&&this.locations){var e,i,n,o,r,a,s,l,h,c,u=this._network.zoomManager;for(e=0;e<this.iconsGroups.length;e++)if(i=this.locations[e]){r=i.x,a=i.y,o=this.iconsGroups[e],s=this.colorGroups[e],l=this.iconsOrientation[e],h=this.iconsXgap[e]||1,c=this.iconsYgap[e]||1,n=0;for(var d in o){var f=null,p=null;s&&s.length>n&&(p=s[n++]);var g=Me.getImageAsset(o[d]);if(null!=g){if(u&&this._ui instanceof De.vector.GroupUI&&this._ui._shapeRect){var _=u.getAttachmentSizeZoom(this),m=g.getWidth()*_,v=g.getHeight()*_;if("right"===l)f={x:r,y:a,width:m,height:v},r+=f.width+h;else if("left"===l)f={x:r-m,y:a,width:m,height:v},r-=f.width+h;else if("top"===l)f={x:r,y:a-v,width:m,height:v},a-=f.height+c;else{if("bottom"!==l)throw"Can not resolve '"+l+"' orientation";f={x:r,y:a,width:m,height:v},a+=f.height+c}}else{if("right"===l)f={x:r,y:a,width:g.getWidth(),height:g.getHeight()},r+=f.width+h;else if("left"===l)f={x:r-g.getWidth(),y:a,width:g.getWidth(),height:g.getHeight()},r-=f.width+h;else if("top"===l)f={x:r,y:a-g.getHeight(),width:g.getWidth(),height:g.getHeight()},a-=f.height+c;else{if("bottom"!==l)throw"Can not resolve '"+l+"' orientation";f={x:r,y:a,width:g.getWidth(),height:g.getHeight()},a+=f.height+c}f=u._getAttachmentZoomOutLineRect(this,f)}var y=this._element instanceof De.Link&&this._element.getStyle("link.icons.rotatable");if(y instanceof Array&&y[e]){t.save();var w=f,r=w.x+w.width/2,a=w.y+w.height/2;t.translate(r,a),t.rotate(this._network.getElementUI(this._element).getAbsoluteAngle()),t.translate(-r,-a),Di(t,g.getImage(p,f.width,f.height),p,f,this._element,this._network),t.restore()}else Di(t,g.getImage(p,f.width,f.height),p,f,this._element,this._network);if(this._network._debug){var f=this._viewRect;Ye.strokeRect(t,f,"#FCFC00",1),Ye.strokeRect(t,f,"#FCFC00",1)}}}}}},_getIconsSize:function(t,e,i,n,o){var r=0,a=0,s=null,l=null,h=null;for(var c in t)if(l=Me.getImageAsset(t[c])){if("right"===e)s={x:r,y:a,width:l.getWidth(),height:l.getHeight()},r+=s.width+i;else if("left"===e)s={x:r-l.getWidth(),y:a,width:l.getWidth(),height:l.getHeight()},r-=s.width+i;else if("top"===e)s={x:r,y:a-l.getHeight(),width:l.getWidth(),height:l.getHeight()},a-=s.height+n;else{if("bottom"!==e)throw"Can not resolve '"+e+"' orientation";s={x:r,y:a,width:l.getWidth(),height:l.getHeight()},a+=s.height+n}h=null==h?Me.clone(s):We.unionRect(h,s)}return h?o&&this._ui instanceof De.vector.GroupUI&&this._ui._shapeRect?{width:Math.abs(h.width)*o.getAttachmentSizeZoom(this),height:Math.abs(h.height)*o.getAttachmentSizeZoom(this)}:{width:Math.abs(h.width),height:Math.abs(h.height)}:null}}),De.vector.EditAttachment=function(t,e){De.vector.EditAttachment.superClass.constructor.call(this,t,e)},Me.ext("twaver.vector.EditAttachment",De.vector.Attachment,{paint:function(t){De.vector.EditAttachment.superClass.paint.apply(this,arguments),this.paintResizingPoints(t),this.paintEditPoints(t),this.paintRotatePoints(t)},paintResizingPoints:function(t){var e=this.resizingPoints.size();if(!(0>=e)){var i=this._element.getStyle("edit.physicalZoom")?1:this._network.getGraphicsZoom(),n=this.resizePointSize/i,o=2*n,r=2*n,a=this._network.getResizePointFillColor(),s=this._network.getResizePointOutlineWidth()/i,l=this._network.getResizePointOutlineColor(),h=this._element.getAngle(),c=this._network.zoomManager,u=c._getElementZoomRect(this.getElementUI(),this._element.getOriginalRect());t.lineWidth=s;for(var d=this.resizingPoints,f=0;e>f;f++){var p=d.get(f),g={x:p.x-n,y:p.y-n,width:2*n,height:2*n},_=this._getRotateRect(g,h,{x:u.x+u.width/2,y:u.y+u.height/2});t.save(),De.Util.rotateCanvas(t,_,h),Nn.rect(t,_.x,_.y,o,r),t.restore()}if(t.fillStyle=a,t.strokeStyle=l,t.fill(),t.stroke(),this._network._debug){var m=this.getViewRect("resize");Ye.strokeRect(t,m,"#CCDDCC");var m=c._getElementZoomRect(this.getElementUI(),this.getElementUI()._viewRect);Ye.strokeRect(t,m,"#FD7766")}}},paintEditPoints:function(t){var e=this.editPoints.size();if(!(0>=e)){var i=this._element.getStyle("edit.physicalZoom")?1:this._network.getGraphicsZoom(),n=this._network.getEditPointOutlineColor(),o=this._network.getEditPointFillColor(),r=this._network.getEditPointOutlineWidth()/i;t.beginPath(),t.lineWidth=r;for(var a=this.editPoints,s=0;e>s;s++){var l=a.get(s);t.beginPath(),Nn.circle(t,l.x,l.y,this.editPointSize,o,n),t.closePath()}if(this._network._debug){var h=this.getViewRect("edit");Ye.strokeRect(t,h,"#AAABBC")}}},paintRotatePoints:function(t){var e=this.rotatePoints.size();if(!(0>=e)){var i=this._element.getStyle("edit.physicalZoom")?1:this._network.getGraphicsZoom(),n=this._network.getRotatePointOutlineColor(),o=this._network.getRotatePointFillColor(),r=this._network.getRotatePointOutlineWidth()/i;t.beginPath(),t.lineWidth=r;for(var a=this.rotatePoints,s=0;e>s;s++){var l=a.get(s);t.beginPath(),Nn.circle(t,l.x,l.y,this.rotatePointSize/i,o,n),t.closePath(),t.beginPath()}if(this._network._debug){var h=this.getViewRect("rotate");Ye.strokeRect(t,h,"green")}}},getViewRect:function(t){if(t){if("resize"===t)return this._resizeRect;if("rotate"===t)return this._rotateRect;if("edit"===t)return this._editRect}return this._viewRect||{x:0,y:0,width:0,height:0}},validate:function(){De.vector.EditAttachment.superClass.validate.call(this);var t=this._network.getGraphicsZoom();this.editPointSize=this._network.getEditPointSize(),this.resizePointSize=this._network.getResizePointSize(),this.rotatePointSize=this._network.getRotatePointSize(),this.resizingPoints=new De.List,this.editPoints=new De.List,this.rotatePoints=new De.List,this._element instanceof De.Node&&this._addResizingPoint(this._element),!(this._network.isRotatable(this._element)&&this._element instanceof On)||this._element instanceof De.ShapeNode||this._element instanceof De.Grid||this._element instanceof De.Group||this._addRotatePoint(this._element),this._element instanceof De.ShapeNode&&(this._addResizingPoint(this._element),this._addShapeNodePoint(this._element)),this._ui instanceof De.vector.ShapeLinkUI&&this._addShapeLinkPoints(this._element),this._ui instanceof De.vector.LinkUI&&this._addLinkControlPoint(this._ui);var e=this._network.getResizePointOutlineWidth()/t,i=this.getElementUI().getZoomBodyRect(),n=2*Math.sqrt(2);if(this._resizeOffset=(this.resizePointSize+e+1)*n,We.grow(i,this._resizeOffset,this._resizeOffset),this._resizeRect=i,e=this._network.getEditPointOutlineWidth()/t,this.editPoints.size()>0){var o=We.getRect(this.editPoints);We.grow(o,2*this.editPointSize+2*e),i=We.unionRect(i,o)}this._editRect=o,e=this._network.getRotatePointOutlineWidth()/t;var r=this.rotatePointSize;if(this.rotatePoints.size()>0){var a=this.rotatePoints.get(0),s={x:a.x-r-e-1,y:a.y-r-e-1,width:2*r+2*e+2,height:2*r+2*e+2};i=We.unionRect(i,s),this._rotateRect=s}this._viewRect=i},_addResizingPoint:function(t){var e=this._network.zoomManager._getElementZoomRect(this.getElementUI(),t.getOriginalRect());if(e){if(!(0>=this._network.getResizePointSize())){var i=new hn([{x:e.x,y:e.y},{x:e.x+e.width/2,y:e.y},{x:e.x+e.width,y:e.y},{x:e.x,y:e.y+e.height/2},{x:e.x+e.width,y:e.y+e.height/2},{x:e.x,y:e.y+e.height},{x:e.x+e.width/2,y:e.y+e.height},{x:e.x+e.width,y:e.y+e.height}]),n=this._network.getResizePointOutlineWidth(),o=this._network.getResizePointOutlineColor(),r=this._network.getResizePointFillColor();this._addPoints(t.getRect(),i,n,o,r,!0)}}},_addRotatePoint:function(t){var e=this._network.zoomManager._getElementZoomRect(this.getElementUI(),t.getOriginalRect());if(e){var i=this._network.getRotatePointSize()/this._network.getGraphicsZoom();if(!(0>=i)){var n=2*i,o=new De.List([{x:e.x+e.width/2,y:e.y-this._network.getRotatePointOffset()/this._network.getGraphicsZoom()-i}]),r=t.getAngle();0!=r&&(o=this._rotatePointList(o,r,e));var a=o.get(0),s={x:a.x-n/2,y:a.y-n/2,width:n,height:n},l=this._network.getRotatePointOutlineWidth(),h=this.rotatePointSize+l;We.grow(e,h,h),We.unionRect(t.getRect(),s),this.rotatePoints=o}}},_addShapeNodePoint:function(t){var e=this._network.zoomManager._getShapeNodeZoomPoints(this.getElementUI(),t.getPoints());this._addEditPoints(e)},_addShapeLinkPoints:function(t){var e=this._network.zoomManager._getShapeLinkZoomPoints(t.getPoints());this._addEditPoints(e)},_addLinkControlPoint:function(t){var e,i=new De.List;e=t._element.getFromAgent()?t._element.getFromAgent():t._element.getFromNode();var n=t._element.getStyle("link.from.xoffset"),o=t._element.getStyle("link.from.yoffset"),r=this._network.getElementUI(e),a=r.getZoomBodyRect(),s={x:a.x+a.width/2,y:a.y+a.height/2},l={x:s.x+n,y:s.y+o};i.add(l);var h;h=t._element.getToAgent()?t._element.getToAgent():t._element.getToNode();var c=t._element.getStyle("link.to.xoffset"),u=t._element.getStyle("link.to.yoffset"),d=this._network.getElementUI(h),f=d.getZoomBodyRect(),p={x:f.x+f.width/2,y:f.y+f.height/2},g={x:p.x+c,y:p.y+u};if(i.add(g),vi.isOrthogonalLink(t._element)&&t.getControlPoint()){var _=t.getControlPoint();_&&i.add(_)}var m=this.editPoints.size();if(m>0)for(var v=0;m>v;v++)i.add(this.editPoints.get(v));this._addEditPoints(i)},_addEditPoints:function(t){var e=We.getRect(t);if(e){if(!(0>=this._network.getEditPointSize())){var i=this._network.getEditPointOutlineWidth();this._addPoints(e,t,i,!1)}}},_addPoints:function(t,e,i,n,o,r){var a=r?this._network.getResizePointSize():this._network.getEditPointSize();if(!(0>a)){var s=a+i;We.grow(t,s,s),1==r?this.resizingPoints=e:this.editPoints=e}},_rotatePoint:function(t,e,i){return We.createMatrix(e*Math.PI/180,i.x+i.width/2,i.y+i.height/2).transform(t)},_rotatePointList:function(t,e,i){var n=this,o=new De.List;return t.forEach(function(t){o.add(n._rotatePoint(t,e,i))}),o},_getRotateRect:function(t,e,i){var n=We.createMatrix(e*Math.PI/180,i.x,i.y),o={x:t.x+t.width/2,y:t.y+t.height/2},r=n.transform(o),a=new De.List([{x:r.x-t.width/2,y:r.y-t.height/2},{x:r.x+t.width/2,y:r.y-t.height/2},{x:r.x+t.width/2,y:r.y+t.height/2},{x:r.x-t.width/2,y:r.y+t.height/2}]);return We.getRect(a)}}),De.vector.HTMLLabelAttachment=function(t,e){De.vector.HTMLLabelAttachment.superClass.constructor.call(this,t,e),this._triangleDiv=De.Util.createDiv(),this._roundDiv=De.Util.createDiv(),this._contentDiv=De.Util.createDiv(),this._network.getView().appendChild(this._roundDiv),this._roundDiv.appendChild(this._contentDiv)},Me.ext("twaver.vector.HTMLLabelAttachment",De.vector.LabelAttachment,{validate:function(){this.validateZIndex(0),this._element.getStyle("attachment.htmllabel.hyperlink")?(De.Util.setCSSStyle(this._triangleDiv,"pointer-events","auto"),De.Util.setCSSStyle(this._contentDiv,"pointer-events","auto")):(De.Util.setCSSStyle(this._triangleDiv,"pointer-events","none"),De.Util.setCSSStyle(this._contentDiv,"pointer-events","none")),De.Util.setCSSStyle(this._triangleDiv,"border-style","solid"),De.Util.setCSSStyle(this._contentDiv,"white-space","nowrap");var e=(this.getFont("label.font"),this.getLabel());e!==this.text&&(this.text&&("object"==typeof this.text?t.jquery?t.jquery(this.text).remove():this._contentDiv.removeChild(this.text):this._contentDiv.innerHTML=""),e&&("object"==typeof e?t.jquery?t.jquery(this._contentDiv).append(e):this._contentDiv.appendChild(e):this._contentDiv.innerHTML=e),this.text=e),this._contentDiv.style.visibility="hidden",De.vector.HTMLLabelAttachment.superClass.validate.call(this)},validateZIndex:function(t){this._roundDiv.style.zIndex=1e5*t+this._network.getElementBox().getDatas().indexOf(this._element)},getContentWidth:function(){return this._contentDiv.scrollWidth||parseInt(De.Util.getCSSStyle(this._contentDiv.firstChild,"width"))},getContentHeight:function(){return this._contentDiv.scrollHeight||parseInt(De.Util.getCSSStyle(this._contentDiv.firstChild,"height"))},paint:function(t){var e=this.isFill(),i=this.getOutlineWidth(),n=this._contentRect;if(this.getElementUI().setGlow(this,t),this.getElementUI().setShadow(this,t),i>0||e){if(Ye.drawRoundRect(t,n.x,n.y,n.width,n.height,this.getCornerRadius()),this._pointers){var o=this._ui.getZoomPointers(this,this._pointers);t.moveTo(o[0].x,o[0].y),t.lineTo(o[1].x,o[1].y),t.lineTo(o[2].x,o[2].y)}if(t.closePath(),i>0&&(t.lineWidth=i,t.strokeStyle=this.getOutlineColor(),t.lineCap=this.getCap(),t.lineJoin=this.getJoin(),t.stroke()),e){var r=this.getFillColor(),a=this.getGradient();a?Ye.fill(t,r,a,this.getGradientColor(),this._viewRect):t.fillStyle=r,t.fill()}}var s=(this.getFont("label.font"),this.getLabel(),this._network.getViewRect().x),l=this._network.getViewRect().y,h=this._network.getZoom(),c={x:this._contentRect.x+this._contentRect.width/2,y:this._contentRect.y+this._contentRect.height/2},u=c.x*h-s-this._contentDiv.offsetWidth/2*h+"px",d=c.y*h-l-this._contentDiv.offsetHeight/2*h+"px";if(this._contentDiv.style.left=u,this._contentDiv.style.top=d,Ue.isFirefox?(De.Util.setCSSStyle(this._contentDiv,"-moz-transform","scale("+h+")"),De.Util.setCSSStyle(this._contentDiv,"-moz-transform-origin","0 0")):Ue.isOpera?(De.Util.setCSSStyle(this._contentDiv,"-o-transform","scale("+h+")"),De.Util.setCSSStyle(this._contentDiv,"-o-transform-origin","0 0")):Ue.isChrome||Ue.isSafari?(De.Util.setCSSStyle(this._contentDiv,"-webkit-transform","scale("+h+")"),De.Util.setCSSStyle(this._contentDiv,"-webkit-transform-origin","0 0")):Ue.isIE?(De.Util.setCSSStyle(this._contentDiv,"-ms-transform","scale("+h+")"),De.Util.setCSSStyle(this._contentDiv,"-ms-transform-origin","0 0")):(De.Util.setCSSStyle(this._contentDiv,"transform","scale("+h+")"),De.Util.setCSSStyle(this._contentDiv,"transform-origin","0 0")),this._network._debug&&(Ye.strokeRect(t,this._contentRect,"blue"),Ye.strokeRect(t,this._roundRect,"red"),Ye.strokeRect(t,this._viewRect,"green")),this._element instanceof De.Link&&this._element.getStyle("link.label.rotatable")){var f=this.getZoomViewRect(),p=(f.x,f.width,f.y,f.height,180*this._network.getElementUI(this._element).getAbsoluteAngle()/Math.PI);this._contentDiv.offsetWidth,this._contentDiv.offsetHeight,Ue.isFirefox?De.Util.setCSSStyle(this._contentDiv,"-moz-transform","translate(0px,0px) rotate("+p+"deg) scale("+h+")"):Ue.isOpera?De.Util.setCSSStyle(this._contentDiv,"-o-transform","translate(0px,0px) rotate("+p+"deg) scale("+h+")"):Ue.isChrome||Ue.isSafari?De.Util.setCSSStyle(this._contentDiv,"-webkit-transform","translate(0px, 0px) rotate("+p+"deg) scale("+h+")"):Ue.isIE?De.Util.setCSSStyle(this._contentDiv,"-ms-transform","translate(0px,0px) rotate("+p+"deg) scale("+h+")"):De.Util.setCSSStyle(this._contentDiv,"transform","translate(0px,0px) rotate("+p+"deg) scale("+h+")")}},setVisibility:function(t){this._contentDiv.style.visibility=t},dispose:function(){this._network.getView().removeChild(this._roundDiv)},getView:function(){return this._roundDiv}}),De.vector.HTMLLabel2Attachment=function(t,e){De.vector.HTMLLabel2Attachment.superClass.constructor.call(this,t,e),this._triangleDiv=De.Util.createDiv(),this._roundDiv=De.Util.createDiv(),this._contentDiv=De.Util.createDiv(),this._network.getView().appendChild(this._roundDiv),this._roundDiv.appendChild(this._contentDiv)},Me.ext("twaver.vector.HTMLLabel2Attachment",De.vector.LabelAttachment,{validate:function(){this.validateZIndex(0),this._element.getStyle("attachment.htmllabel2.hyperlink")?(De.Util.setCSSStyle(this._triangleDiv,"pointer-events","auto"),De.Util.setCSSStyle(this._contentDiv,"pointer-events","auto")):(De.Util.setCSSStyle(this._triangleDiv,"pointer-events","none"),De.Util.setCSSStyle(this._contentDiv,"pointer-events","none")),De.Util.setCSSStyle(this._triangleDiv,"border-style","solid"),De.Util.setCSSStyle(this._contentDiv,"white-space","nowrap");var e=(this.getFont("label2.font"),this.getLabel());e!==this.text&&(this.text&&("object"==typeof this.text?t.jquery?t.jquery(this.text).remove():this._contentDiv.removeChild(this.text):this._contentDiv.innerHTML=""),e&&("object"==typeof e?t.jquery?t.jquery(this._contentDiv).append(e):this._contentDiv.appendChild(e):this._contentDiv.innerHTML=e),this.text=e),this._contentDiv.style.visibility="hidden",De.vector.HTMLLabelAttachment.superClass.validate.call(this)},validateZIndex:function(t){this._roundDiv.style.zIndex=1e5*t+this._network.getElementBox().getDatas().indexOf(this._element)},getContentWidth:function(){return this._contentDiv.scrollWidth||parseInt(De.Util.getCSSStyle(this._contentDiv.firstChild,"width"))},getContentHeight:function(){return this._contentDiv.scrollHeight||parseInt(De.Util.getCSSStyle(this._contentDiv.firstChild,"height"))},paint:function(t){var e=this.isFill(),i=this.getOutlineWidth(),n=this._contentRect;if(this.getElementUI().setGlow(this,t),this.getElementUI().setShadow(this,t),i>0||e){if(Ye.drawRoundRect(t,n.x,n.y,n.width,n.height,this.getCornerRadius()),this._pointers){var o=this._ui.getZoomPointers(this,this._pointers);t.moveTo(o[0].x,o[0].y),t.lineTo(o[1].x,o[1].y),t.lineTo(o[2].x,o[2].y)}if(t.closePath(),i>0&&(t.lineWidth=i,t.strokeStyle=this.getOutlineColor(),t.lineCap=this.getCap(),t.lineJoin=this.getJoin(),t.stroke()),e){var r=this.getFillColor(),a=this.getGradient();a?Ye.fill(t,r,a,this.getGradientColor(),this._viewRect):t.fillStyle=r,t.fill()}}var s=(this.getFont("label2.font"),this.getLabel(),this._network.getViewRect().x),l=this._network.getViewRect().y,h=this._network.getZoom(),c={x:this._contentRect.x+this._contentRect.width/2,y:this._contentRect.y+this._contentRect.height/2},u=c.x*h-s-this._contentDiv.offsetWidth/2*h+"px",d=c.y*h-l-this._contentDiv.offsetHeight/2*h+"px";if(this._contentDiv.style.left=u,this._contentDiv.style.top=d,this._contentDiv.style.setProperty("-webkit-transform","scale("+h+")",null),this._contentDiv.style.setProperty("-webkit-transform-origin","0 0",null),this._network._debug&&(Ye.strokeRect(t,this._contentRect,"blue"),Ye.strokeRect(t,this._roundRect,"red"),Ye.strokeRect(t,this._viewRect,"green")),this._element instanceof De.Link&&this._element.getStyle("link.label2.rotatable")){var f=this.getZoomViewRect(),p=(f.x,f.width,f.y,f.height,180*this._network.getElementUI(this._element).getAbsoluteAngle()/Math.PI);this._contentDiv.offsetWidth,this._contentDiv.offsetHeight,Ue.isFirefox?De.Util.setCSSStyle(this._contentDiv,"-moz-transform","translate(0px,0px) rotate("+p+"deg) scale("+h+")"):Ue.isOpera?De.Util.setCSSStyle(this._contentDiv,"-o-transform","translate(0px,0px) rotate("+p+"deg) scale("+h+")"):Ue.isChrome||Ue.isSafari?De.Util.setCSSStyle(this._contentDiv,"-webkit-transform","translate(0px, 0px) rotate("+p+"deg) scale("+h+")"):Ue.isIE?De.Util.setCSSStyle(this._contentDiv,"-ms-transform","translate(0px,0px) rotate("+p+"deg) scale("+h+")"):De.Util.setCSSStyle(this._contentDiv,"transform","translate(0px,0px) rotate("+p+"deg) scale("+h+")")}},setVisibility:function(t){this._contentDiv.style.visibility=t},dispose:function(){this._network.getView().removeChild(this._roundDiv)},getView:function(){return this._roundDiv},getLabel:function(){return this._network.getLabel2(this._element)},getCornerRadius:function(){return this.getStyle("label2.corner.radius")},getPointerLength:function(){return this.getStyle("label2.pointer.length")},getPointerWidth:function(){return this.getStyle("label2.pointer.width")},getPosition:function(){return this.getStyle("label2.position")},getXOffset:function(){return this.getStyle("label2.xoffset")},getYOffset:function(){return this.getStyle("label2.yoffset")},getPadding:function(){return this.getStyle("label2.padding")},getPaddingLeft:function(){return this.getStyle("label2.padding.left")},getPaddingRight:function(){return this.getStyle("label2.padding.right")},getPaddingTop:function(){return this.getStyle("label2.padding.top")},getPaddingBottom:function(){return this.getStyle("label2.padding.bottom")},getDirection:function(){return this.getStyle("label2.direction")},isFill:function(){return this.getStyle("label2.fill")},getFillColor:function(){return this.getStyle("label2.fill.color")},getGradient:function(){return this.getStyle("label2.gradient")},getGradientColor:function(){return this.getStyle("label2.gradient.color")},getOutlineWidth:function(){return this.getStyle("label2.outline.width")},getOutlineColor:function(){return this.getStyle("label2.outline.color")},getCap:function(){return this.getStyle("label2.cap")},getJoin:function(){return this.getStyle("label2.join")},getAlpha:function(){return this.getStyle("label2.alpha")},isShadowable:function(){return this.getStyle("label2.shadowable")}}),De.vector.HTMLAlarmAttachment=function(t,e){De.vector.HTMLAlarmAttachment.superClass.constructor.call(this,t,e),this._triangleDiv=De.Util.createDiv(),this._roundDiv=De.Util.createDiv(),this._contentDiv=De.Util.createDiv(),De.Util.setCSSStyle(this._triangleDiv,"border-style","solid"),De.Util.setCSSStyle(this._triangleDiv,"pointer-events","none"),De.Util.setCSSStyle(this._contentDiv,"white-space","nowrap"),De.Util.setCSSStyle(this._contentDiv,"pointer-events","none"),this._network.getView().appendChild(this._roundDiv),this._roundDiv.appendChild(this._contentDiv)},Me.ext("twaver.vector.HTMLAlarmAttachment",De.vector.AlarmAttachment,{validate:function(){var t=(this.getFont("alarm.font"),this._network.getAlarmLabel(this._element));this._contentDiv.innerHTML=t,this._contentDiv.style.visibility="hidden",De.vector.HTMLAlarmAttachment.superClass.validate.call(this)},getContentWidth:function(){return this._contentDiv.scrollWidth||parseInt(De.Util.getCSSStyle(this._contentDiv.firstChild,"width"))},getContentHeight:function(){return this._contentDiv.scrollHeight||parseInt(De.Util.getCSSStyle(this._contentDiv.firstChild,"height"))},paint:function(t){var e=this.isFill(),i=this.getOutlineWidth(),n=this._contentRect;if(this.getElementUI().setShadow(this,t),i>0||e){if(Ye.drawRoundRect(t,n.x,n.y,n.width,n.height,this.getCornerRadius()),this._pointers){var o=this._ui.getZoomPointers(this,this._pointers);t.moveTo(o[0].x,o[0].y),t.lineTo(o[1].x,o[1].y),t.lineTo(o[2].x,o[2].y)}if(t.closePath(),i>0&&(t.lineWidth=i,t.strokeStyle=this.getOutlineColor(),t.lineCap=this.getCap(),t.lineJoin=this.getJoin(),t.stroke()),e){var r=this.getFillColor(),a=this.getGradient();a?Ye.fill(t,r,a,this.getGradientColor(),this._viewRect):t.fillStyle=r,t.fill()}}var s=(this.getFont("alarm.font"),this._network.getAlarmLabel(this._element),this._network.getViewRect().x),l=this._network.getViewRect().y,h=this._network.getZoom(),c={x:this._contentRect.x+this._contentRect.width/2,y:this._contentRect.y+this._contentRect.height/2},u=c.x*h-s-this._contentDiv.offsetWidth/2*h+"px",d=c.y*h-l-this._contentDiv.offsetHeight/2*h+"px";this._contentDiv.style.left=u,this._contentDiv.style.top=d,this._contentDiv.style.setProperty("-webkit-transform","scale("+h+")",null),this._contentDiv.style.setProperty("-webkit-transform-origin","0 0",null),this._network._debug&&Ye.strokeRect(t,this._contentRect,"#DDDDDD"),De.vector.AlarmAttachment.superClass.paint.apply(this,arguments)},setVisibility:function(t){this._contentDiv.style.visibility=t},dispose:function(){this._network.getView().removeChild(this._roundDiv)},getView:function(){return this._roundDiv}}),De.vector.BaseZoomManager=function(t){this.network=t,this.visibilityThresholds=t.visibilityThresholds},Me.ext("twaver.vector.BaseZoomManager",Object,{getZoom:function(){return this.network.getZoom()},getGraphicsZoom:function(){return 1},getSizeZoom:function(t){return 1},getAttachmentSizeZoom:function(t){var e=t.getElementUI();return this.getSizeZoom(e)},getLocationZoom:function(){return 1},_getZoomVisibilityThresholds:function(){return this.network.getZoomVisibilityThresholds()},_convertPointFromView:function(t){return{x:t.x*this.getGraphicsZoom()-this.network.getViewRect().x,y:t.y*this.getGraphicsZoom()-this.network.getViewRect().y}},_getElementViewRect:function(t,e){var i=this.getLocationZoom(),n=this.getSizeZoom(t);if(1==i&&1==n)return e;var o=this._getZoomPoint(t),r=o.x,a=o.y;return null==e&&console.log("View rect is null"),{x:r*i+(e.x-r)*n,y:a*i+(e.y-a)*n,width:e.width*n,height:e.height*n}},_invalidateZoom:function(){this.network.invalidateElementUIs()},_getGroupChildrenRects:function(t){var e=new hn;return t.getChildren().forEach(function(t){if(t instanceof On){var i=this.network.getElementUI(t);if(i){var n=i.getZoomViewRect(this);n&&e.add(n)}}},this),e},_zoomGraphicsBegin:function(t){var e=this.network,i=this.getGraphicsZoom();t.scale(i,i),t.translate(-e.viewRect.x/i,-e.viewRect.y/i)},_getEditZoomPoints:function(t,e){var i=this.getLocationZoom(),n=this.getSizeZoom(t);if(1==i&&1==n||t instanceof De.vector.LinkUI&&!(t instanceof De.vector.ShapeLinkUI))return e;var o;o=t instanceof De.vector.ShapeLinkUI?We.getCenterPoint(We.getRect(e)):this._getZoomPoint(t);var r=o.x,a=o.y;if(e.forEach){var s,l=new hn;return e.forEach(function(t){t instanceof hn?(s=new hn,t.forEach(function(t){s.add({x:r*i+(t.x-r)*n,y:a*i+(t.y-a)*n})}),l.add(s)):l.add({x:r*i+(t.x-r)*n,y:a*i+(t.y-a)*n})}),l}return e.x?{x:r*i+(e.x-r)*n,y:a*i+(e.y-a)*n}:void 0},_getShapeNodeZoomPoints:function(t,e,i){var n=this.getLocationZoom(),o=this.getSizeZoom(t);if(1==n&&1==o)return e;i&&(n=1/n,o=1/o);var r,a=We.getRect(e),s=a.x+a.width/2,l=a.y+a.height/2,h=new hn;return e.forEach(function(t){t instanceof hn?(r=new hn,t.forEach(function(t){r.add({x:s*n+(t.x-s)*o,y:l*n+(t.y-l)*o})}),h.add(r)):h.add({x:s*n+(t.x-s)*o,y:l*n+(t.y-l)*o})}),h},_getShapeLinkZoomPoints:function(t,e){var i=this.getLocationZoom(),n=i;if(1==i&&1==n)return t;e&&(i=1/i,n=1/n);var o,r=We.getRect(t),a=r.x+r.width/2,s=r.y+r.height/2,l=new hn;return t.forEach(function(t){t instanceof hn?(o=new hn,t.forEach(function(t){o.add({x:a*i+(t.x-a)*n,y:s*i+(t.y-s)*n})}),l.add(o)):l.add({x:a*i+(t.x-a)*n,y:s*i+(t.y-s)*n})}),l},_getLogicalPoint:function(t,e){var i=e?this.getZoom():this.getGraphicsZoom(),n=this.network;if(Ue.isTouchable&&t.changedTouches&&t.changedTouches.length>0){var o=n._view.getBoundingClientRect(),r=t.changedTouches[0],a=Ue.isAndroid?0:wi.scrollLeft(),s=Ue.isAndroid?0:wi.scrollTop();return{x:(r.clientX+n.viewRect.x-o.left-a)/i,y:(r.clientY+n.viewRect.y-o.top-s)/i}}return Ue.isFirefox?{x:(t.layerX+n.viewRect.x)/i,y:(t.layerY+n.viewRect.y)/i}:{x:(t.offsetX+n.viewRect.x)/i,y:(t.offsetY+n.viewRect.y)/i}},_getVisibleRect:function(t){return t},_getElementZoomRect:function(t,e){var i=this.getLocationZoom(),n=this.getSizeZoom(t);if(1==i&&1==n)return Me.cloneRect(e);var o=null!=t?this._getZoomPoint(t):{x:e.x+e.width/2,y:e.y+e.height/2},r=o.x,a=o.y;return{x:r*i+(e.x-r)*n,y:a*i+(e.y-a)*n,width:e.width*n,height:e.height*n}},_reverseElementZoomRect:function(t,e){var i=this.getLocationZoom(),n=this.getSizeZoom(t);if(1==i&&1==n)return Me.cloneRect(e);var o=null!=t?this._getZoomPoint(t):{x:e.x+e.width/2,y:e.y+e.height/2},r=o.x,a=o.y;return{x:r+(e.x-r*i)/n,y:a+(e.y-a*i)/n,width:e.width/n,height:e.height/n}},_getZoomContentRect:function(t,i,n,o,r,a){var s=this.getSizeZoom(t.getElementUI()),l=this.getAttachmentSizeZoom(t),h=t.getElementUI();return a==e?h instanceof De.vector.GroupUI&&h._shapeRect?{x:o.x*r+1*(i.x-o.x)+(n.x-i.x)*l,y:o.y*r+1*(i.y-o.y)+(n.y-i.y)*l,width:n.width,height:n.height}:{x:o.x*r+(i.x-o.x)*s+(n.x-i.x)*l,y:o.y*r+(i.y-o.y)*s+(n.y-i.y)*l,width:n.width,height:n.height}:{x:o.x*r+(i.x-o.x)*s+(n.x-i.x)*l,y:o.y*r+(i.y-o.y)*s+(n.y-i.y)*l+a*(t.textHeight-4)*l,width:n.width,height:t.textHeight}},_getAttachmentZoomRect:function(t,i,n){var o=this.getLocationZoom(),r=t.getElementUI(),a=this.getSizeZoom(t.getElementUI()),s=this.getAttachmentSizeZoom(t),l=t._pointers;if(1==o&&1==s&&1==a)return n==e?i:{x:i.x,y:i.y+n*(t.textHeight-4),width:i.width,height:t.textHeight};var r=t.getElementUI(),h=this._getZoomPoint(r,t),c=(h.x,h.y,t.getPosition?t.getPosition():"center"),u=l?l[0]:zn.get(c,i);return n==e?r instanceof De.vector.LinkUI||r instanceof De.vector.GroupUI&&r._shapeRect?this._getZoomContentRect(t,u,i,h,1):this._getZoomContentRect(t,u,i,h,o):this._getZoomContentRect(t,u,i,h,o,n)},_getZoomPoint:function(t,e){var i,n,o=t._element;if(o instanceof De.Follower&&o.getHost()&&o.getHost()instanceof De.Grid)return i=o.getHost(),n=i.getRect(),{x:n.x+n.width/2,y:n.y+n.height/2};if(n=t.getBodyRect(),t instanceof De.vector.LinkUI&&e&&e.getPosition){if(e.getXOffset(),e.getYOffset(),"from"===e.getPosition())return t._fromPoint;if("to"===e.getPosition())return t._toPoint}return{x:n.x+n.width/2,y:n.y+n.height/2}},_getZoomPointers:function(t,e,i){if(i){var n=this._getZoomPoint(e),o=this.getLocationZoom(),r=this.getSizeZoom(e),a=this.getAttachmentSizeZoom(t),s=i[0];return e instanceof De.vector.LinkUI?[{x:n.x+(s.x-n.x)*r,y:n.y+(s.y-n.y)*r},{x:n.x+(s.x-n.x)*r+(i[1].x-s.x)*a,y:n.y+(s.y-n.y)*r+(i[1].y-s.y)*a},{x:n.x+(s.x-n.x)*r+(i[2].x-s.x)*a,y:n.y+(s.y-n.y)*r+(i[2].y-s.y)*a}]:e instanceof De.vector.GroupUI&&e._shapeRect?[{x:n.x+1*(s.x-n.x),y:n.y+1*(s.y-n.y)},{x:n.x+1*(s.x-n.x)+(i[1].x-s.x)*a,y:n.y+1*(s.y-n.y)+(i[1].y-s.y)*a},{x:n.x+1*(s.x-n.x)+(i[2].x-s.x)*a,y:n.y+1*(s.y-n.y)+(i[2].y-s.y)*a}]:[{x:n.x*o+(s.x-n.x)*r,y:n.y*o+(s.y-n.y)*r},{x:n.x*o+(s.x-n.x)*r+(i[1].x-s.x)*a,y:n.y*o+(s.y-n.y)*r+(i[1].y-s.y)*a},{x:n.x*o+(s.x-n.x)*r+(i[2].x-s.x)*a,y:n.y*o+(s.y-n.y)*r+(i[2].y-s.y)*a}]}},_getZoomHotSpot:function(t,e){if(e){var i=this._getZoomPoint(t),n=this.getLocationZoom(),o=this.getSizeZoom(t);return{x:i.x*n+(e.x-i.x)*o,y:i.y*n+(e.y-i.y)*o}}return null},limitZoom:function(t){return t},_isVisible:function(t){var e,i=this._getZoomVisibilityThresholds(),n=i[t];if(null!=n){var o=i.zoomName;if(e="sizeZoom"==o?this.getSizeZoom():"locationZoom"==o?this.getLocationZoom():"graphicsZoom"==o?this.getGraphicsZoom():this.getZoom(),n>e)return!1}return!0},isElementVisible:function(t){var e=this.getZoom(),i=this._isVisible("element",e);return i&&t instanceof De.Link?this.isLinkVisible(t):i},isLinkVisible:function(t){var e=this.getZoom();return this._isVisible("link",e)},isLabelVisible:function(t){var e=this.getZoom();return this._isVisible("label",e)},isAttachmentVisible:function(t){var e=this.getZoom();return this._isVisible("attachment",e)},isAlarmBalloonVisible:function(t){var e=this.getZoom();return this._isVisible("alarmBallon",e)},_getAttachmentOutLineWidth:function(t){return t.getOutlineWidth()},_getAttachmentZoomOutLineRect:function(t,e){var i=this.getLocationZoom(),n=this.getAttachmentSizeZoom(t);if(1==i&&1==n)return e;var o=this._getAttachmentZoomRect(t,e,null),r=t.getElement();return this.isAttachmentVisible(r)?(t instanceof De.vector.LabelAttachment||t instanceof De.vector.Label2Attachment)&&!this.isLabelVisible(r)?{x:o.x,y:o.x,width:0,height:0}:t instanceof De.vector.AlarmAttachment&&!this.isAlarmBalloonVisible(r)?{x:o.x,y:o.x,width:0,height:0}:{x:o.x,y:o.y,width:o.width*n,height:o.height*n}:{x:o.x,y:o.x,width:0,height:0}},_drawText:function(t,e,i,n,o,r,a){var s=this.getLocationZoom(),l=this.getAttachmentSizeZoom(t);1!=s&&1!=l?(e.translate(n.x,n.y),e.scale(l,l),Ye.drawText(e,i,{x:0,y:0,width:n.width,height:n.height},o,r,a),e.scale(1/l,1/l),e.translate(-n.x,-n.y)):Ye.drawText(e,i,n,o,r,a)},_getOffset:function(t,e){var i=this.getLocationZoom();return{x:(t.x-e.x)/i,y:(t.y-e.y)/i}}});var zn={"topleft.topleft":function(t){return{x:t.x+t.width,y:t.y+t.height}},"topleft.topright":function(t){return{x:t.x,y:t.y+t.height}},"top.top":function(t){return{x:t.x+t.width/2,y:t.y+t.height}},"topright.topleft":function(t){return{x:t.x+t.width,y:t.y+t.height}},"topright.topright":function(t){return{x:t.x,y:t.y+t.height}},topleft:function(t){return{x:t.x+t.width/2,y:t.y+t.height/2}},top:function(t){return{x:t.x+t.width/2,y:t.y+t.height/2}},topright:function(t){return{x:t.x+t.width/2,y:t.y+t.height/2}},"topleft.bottomleft":function(t){return{x:t.x+t.width,y:t.y}},"topleft.bottomright":function(t){return{x:t.x,y:t.y}},"top.bottom":function(t){return{x:t.x+t.width/2,y:t.y}},"topright.bottomleft":function(t){return{x:t.x+t.width,y:t.y}},"topright.bottomright":function(t){return{x:t.x,y:t.y}},"left.left":function(t){return{x:t.x+t.width,y:t.y+t.height/2}},left:function(t){return{x:t.x+t.width/2,y:t.y+t.height/2}},"left.right":function(t){return{x:t.x,y:t.y+t.height/2}},center:function(t){return{x:t.x+t.width/2,y:t.y+t.height/2}},"right.left":function(t){return{x:t.x+t.width,y:t.y+t.height/2}},right:function(t){return{x:t.x+t.width/2,y:t.y+t.height/2}},"right.right":function(t){return{x:t.x,y:t.y+t.height/2}},"bottomleft.topleft":function(t){return{x:t.x+t.width,y:t.y+t.height}},"bottomleft.topright":function(t){return{x:t.x,y:t.y+t.height}},"bottom.top":function(t){return{x:t.x+t.width/2,y:t.y+t.height}},"bottomright.topleft":function(t){return{x:t.x+t.width,y:t.y+t.height}},"bottomright.topright":function(t){return{x:t.x,y:t.y+t.height}},bottomleft:function(t){return{x:t.x+t.width/2,y:t.y+t.height/2}},bottom:function(t){return{x:t.x+t.width/2,y:t.y+t.height/2}},bottomright:function(t){return{x:t.x+t.width/2,y:t.y+t.height/2}},"bottomleft.bottomleft":function(t){return{x:t.x+t.width,y:t.y}},"bottomleft.bottomright":function(t){return{x:t.x,y:t.y}},"bottom.bottom":function(t){return{x:t.x+t.width/2,y:t.y}},"bottomright.bottomleft":function(t){return{x:t.x+t.width,y:t.y}},"bottomright.bottomright":function(t){return{x:t.x,y:t.y}},from:function(t){return{x:t.x+t.width/2,y:t.y+t.height/2}},to:function(t){return{x:t.x+t.width/2,y:t.y+t.height/2}},get:function(t,e){if(!e)throw"rect can not be null";var i=zn[t];if(i)return i(e);throw"Can not resolve '"+t+"' position"}};De.vector.PhysicalZoomManager=function(t){De.vector.PhysicalZoomManager.superClass.constructor.apply(this,arguments)},Me.ext("twaver.vector.PhysicalZoomManager",De.vector.BaseZoomManager,{getGraphicsZoom:function(){return this.getZoom()},_invalidateZoom:function(){}}),De.vector.LogicalZoomManager=function(t,e){De.vector.LogicalZoomManager.superClass.constructor.apply(this,arguments),this.sizeChange=e},Me.ext("twaver.vector.LogicalZoomManager",De.vector.BaseZoomManager,{getLocationZoom:function(){return this.getZoom()},getSizeZoom:function(t){return this.sizeChange?this.getZoom():1}}),De.vector.MixedZoomManager=function(t,e){De.vector.MixedZoomManager.superClass.constructor.call(this,t,e)},Me.ext("twaver.vector.MixedZoomManager",De.vector.LogicalZoomManager,{}),function(){var t=De.vector.LogicalZoomManager.prototype,e=De.vector.PhysicalZoomManager.prototype,i=De.vector.MixedZoomManager.prototype;for(var n in e)"function"==typeof e[n]&&"constructor"!=n&&(t.hasOwnProperty(n)||e.hasOwnProperty(n))&&function(n){i[n]=function(){return this.getZoom()>1?t[n].apply(this,arguments):e[n].apply(this,arguments)}}(n);i._invalidateZoom=function(){this.network.invalidateElementUIs()}}(),De.vector.interaction.BaseInteraction=function(t){this.network=t},Me.ext("twaver.vector.interaction.BaseInteraction",Object,{setUp:function(){},tearDown:function(){},repaint:function(){this.network.repaintTopCanvas()},getOffset:function(t,e){return this.network.getOffset(t,e)},convertPointFromView:function(t){return this.network.convertPointFromView(t)},convertFromUIToMarkerRect:function(t,e,i,n){var o=this.network.zoomManager,r=o.getLocationZoom(),a=o.getGraphicsZoom(),s=o.getSizeZoom(this.network.getElementUI(n));return{x:t.x*r*a-this.network.getViewRect().x+e*r*a,y:t.y*r*a-this.network.getViewRect().y+i*r*a,width:t.width*s*a,height:t.height*s*a}},getMarkerPoint:function(t){if(Ue.isTouchable&&t.changedTouches&&t.changedTouches.length>0){var e=t.changedTouches[0];return{x:e.clientX,y:e.clientY}}return Ue.isFirefox?{x:t.layerX,y:t.layerY}:{x:t.offsetX,y:t.offsetY}},paint:function(t){},addListener:function(){for(var t=0;t<arguments.length;t++){var e=arguments[t];Xe.addEventListener(e,"handle_"+e,this.network.getView(),this)}},removeListener:function(){for(var t=0;t<arguments.length;t++)Xe.removeEventListener(arguments[t],this.network.getView(),this)},_handle_mousedown:function(t){0===t.button&&(this._startLogical=this.network.getLogicalPoint2(t),this._startClient=Xe.getClientPoint(t),this._startLogical&&Xe.handle_mousedown(this,t))},_handle_mousemove:function(t){this._endLogical={x:this._startLogical.x+(t.clientX-this._startClient.x)/this.network.getGraphicsZoom(),y:this._startLogical.y+(t.clientY-this._startClient.y)/this.network.getGraphicsZoom()}},_handle_mouseup:function(t){delete this._startClient,delete this._startLogical,delete this._endLogical}}),De.vector.interaction.DefaultInteraction=function(t,e){De.vector.interaction.DefaultInteraction.superClass.constructor.call(this,t),this.lazyMode=e},Me.ext("twaver.vector.interaction.DefaultInteraction",De.vector.interaction.BaseInteraction,{setUp:function(){this.addListener("mousedown","mouseover","mouseout","keydown"),Ue.isFirefox?Xe.addEventListener("DOMMouseScroll","handleMouseWheel",this.network.getView(),this):Xe.addEventListener("mousewheel","handleMouseWheel",this.network.getView(),this),Xe.addEventListener("mouseup","handle_mouseup",t,this),Xe.addEventListener("dblclick","handleDoubleClicked",this.network.getView(),this),this._oldCursor=this.network.getView().style.cursor,this.network.addPropertyChangeListener(this.handleViewRectChange,this),this.validateScrollBar(),this.network.addMarker(this),this.network.getView().oncontextmenu=function(t){t.preventDefault()},this._createZoomDiv()},tearDown:function(){this.removeListener("mousedown","mouseover","mouseout","keydown"),Ue.isFirefox?Xe.removeEventListener("DOMMouseScroll",this.network.getView(),this):Xe.removeEventListener("mousewheel",this.network.getView(),this),Xe.removeEventListener("mouseup",t,this),Xe.removeEventListener("dblclick",this.network.getView(),this),this.network.removePropertyChangeListener(this.handleViewRectChange,this),this.end(),this.network.removeMarker(this),this._zoomDiv=null},_createZoomDiv:function(){if(null==this._zoomDiv){this._zoomDiv=ze.createElement("div"),this._zoomLabel=ze.createElement("span"),this._zoomLabel.style.display="block",this._zoomLabel.style.textAlign="center";var e=ze.createElement("button");e.innerHTML="Reset to default",this._zoomDiv.appendChild(this._zoomLabel),this._zoomDiv.appendChild(e);var i=kn,n=this._zoomDiv.style;n.position="absolute",n.color=i.TOOLTIP_COLOR,n.background=i.TOOLTIP_BACKGROUND,n.fontSize=i.TOOLTIP_FONT_SIZE,n.padding=i.TOOLTIP_PADDING,n.border=i.TOOLTIP_BORDER,n.borderRadius=i.TOOLTIP_BORDER_RADIUS,n.boxShadow=i.TOOLTIP_BOX_SHADOW,n.zIndex=i.TOOLTIP_ZINDEX,n.setProperty&&n.setProperty("-webkit-box-shadow",i.TOOLTIP_BOX_SHADOW,null);var o=this;e.onclick=function(t){o.network.setZoom(1),o._setZoomDivVisible(!1)};var r=this._zoomDiv,a=function(){return r.style.opacity=parseFloat(r.style.opacity)-.05,parseFloat(r.style.opacity)<=.05?(o._setZoomDivVisible(!1),void(r._clearTimeout=null)):void(r._clearTimeout=setTimeout(r._clearFunc,100))};r._clearFunc=a,r.onmouseover=function(e){e||(e=t.event);for(var i=e.relatedTarget?e.relatedTarget:e.fromElement;i&&i!=r;)i=i.parentNode;i!=r&&(r._clearTimeout&&(clearTimeout(r._clearTimeout),r._clearTimeout=null),r.style.opacity=1)},r.onmouseout=function(e){e||(e=t.event);for(var i=e.relatedTarget?e.relatedTarget:e.toElement;i&&i!=r;)i=i.parentNode;i!=r&&(r._clearTimeout=setTimeout(r._clearFunc,10))}}},_isZoomDivVisible:function(){return null!=this._zoomDiv&&null!=this._zoomDiv.parentNode},_getZoomDiv:function(){return this._zoomDiv||this._createZoomDiv(),this._zoomDiv},_setZoomDivVisible:function(t,e,i){var n=this._getZoomDiv();t?(this._zoomLabel.innerHTML=i,n.style.opacity=1,this._isZoomDivVisible()||this.network.getView().appendChild(n),n.style.left=kn.TOOLTIP_XOFFSET+"px",n.style.top=kn.TOOLTIP_YOFFSET+"px",n._clearTimeout&&(clearTimeout(n._clearTimeout),n._clearTimeout=null),n._clearTimeout=setTimeout(n._clearFunc,250)):n.parentNode&&n.parentNode.removeChild(n)},handleViewRectChange:function(t){("viewRect"==t.property||"canvasSizeChange"==t.property)&&this.validateScrollBar()},getScrollBarWidth:function(){return this.network.getScrollBarWidth()},getScrollBarColor:function(){return"#cccccc"},validateScrollBar:function(){if(this.hThumbRect=null,this.vThumbRect=null,0==this.network.isScrollBarVisible())return void this.repaint();var t=this.network.getViewRect().height,e=this.network.getViewRect().width,i=this.network.getViewRect().x,n=this.network.getViewRect().y,o=this.network.getCanvasSize(),r=this.network._unionBounds,a=r.x,s=r.y,l=r.width,h=r.height,c=o.width,u=o.height,d=e,f=t,p=!1,g=!1;(i>a||c>e+i)&&(g=!0),(n>s||u>n+t)&&(p=!0);var _,m,v,y=0,w=0,b=0,x=0,A=d,C=f,T=this.getScrollBarWidth();g&&(p&&(A-=T),x=T,w=f-T,i>a&&i+e>c?(_=i-a,_=_*A/(_+d),y=_,b=A-_):a>i&&c>i+e?(_=c-(i+e),_=A*_/(_+d),y=0,b=A-_):(m=i-a,v=c-(i+e),m=A*m/l,v=A*v/l,y=m,b=d-m-v),this.hThumbRect={x:y,y:w,width:b,height:x}),y=0,w=0,b=0,x=0,A=d,C=f,p&&(g&&(C-=T),b=T,y=d-T,n>s&&n+t>u?(_=n-s,_=C*_/(_+f),w=_,x=C-_):s>n&&u>n+t?(_=u-(n+t),_=C*_/(_+f),w=0,x=C-_):(m=n-s,v=u-(n+t),m=C*m/h,v=C*v/h,w=m,x=C-m-v),this.vThumbRect={x:y,y:w,width:b,height:x}),this.network.setHScrollBarVisible(null!=this.hThumbRect),this.network.setVScrollBarVisible(null!=this.vThumbRect),this.repaint()},scrollXOffset:function(t){var e=this.network.getViewRect().height,i=this.network.getViewRect().width,n=this.network.getViewRect().x,o=this.network.getViewRect().y,r=30;t&&(r=-30),this.network.setViewRect(n+r,o,i,e)},scrollYOffset:function(t){var e=this.network.getViewRect().height,i=this.network.getViewRect().width,n=this.network.getViewRect().x,o=this.network.getViewRect().y,r=30;t&&(r=-30),this.network.setViewRect(n,o+r,i,e)},handle_mouseover:function(t){1!=this.scrollBarVisible&&(this.scrollBarVisible=!0,this.repaint())},handle_mouseout:function(t){0!=this.scrollBarVisible&&(this.scrollBarVisible=!1,this.repaint(),this.end(t))},handle_keydown:function(t){this.currentKeyEvent=t,this.addListener("keyup"),Ai.handleKeyDown(this.network,t)},handle_keyup:function(t){this.currentKeyEvent=null,this.removeListener("keyup")},start:function(e){this.end(e,!0),this.lastPoint=this.network.getLogicalPoint2(e),this.startPoint=this.network.getLogicalPoint2(e),this.lastPanPoint=this.getMarkerPoint(e),this.lazyMode&&(this.pressPoint=this.lastPoint),Xe.addEventListener("mousemove","handle_mousemove",t,this)},end:function(e,i){if(this.vBarDownPoint=null,this.hBarDownPoint=null,this.network.state.panning&&(this.network.state.panning=!1,this.network.invalidateElementUIs(!0)),i||(this.network.getView().style.cursor=this._oldCursor),this.isMoving){if(this.lazyMode){if(null!=this.dragPoint&&null!=this.pressPoint){var n=this,o=function(){n.network.fireInteractionEvent({kind:"lazyMoveEnd",event:e}),n.network.setMovingElement(!1)},r=this.getOffset(this.dragPoint,this.pressPoint),a=r.x,s=r.y;this.network.moveSelectedElements(a,s,this.network.isLazyMoveAnimate(),o)}}else this.network.isMovingElement()&&(this.network.setMovingElement(!1),this.network.fireInteractionEvent({kind:"liveMoveEnd",event:e}));if(this.isParenting()){null==this.parent&&(this.parent=this.network.getCurrentSubNetwork());var n=this;this.network.getMovableSelectedElements().forEach(function(t){t.setParent(n.parent)},this.network)}this.parentProcess(e,!0),this.isParenting()&&this.repaint(),this.network.invalidateCanvasSize(),this.lastPoint=null,this.dragPoint=null,this.pressPoint=null,this.repaint()}if(this.isSelecting&&this.startPoint){if(this.endPoint&&this.startPoint.x!==this.endPoint.x&&this.startPoint.y!==this.endPoint.y){var l=We.getRect([this.startPoint,this.endPoint]),h=this.network.getElementsAtRect(l,this.getIntersectMode(),this.network.getRectSelectFilter());if(h&&h.size()>0){var c=this.network.getSelectionModel(),u=c.toSelection();h.forEach(function(t){c.contains(t)?u.remove(t):u.add(t)},this),c.setSelection(u)}this.network.fireInteractionEvent({kind:"selectEnd",event:e})}this.network.setSelectingElement(!1),this.startPoint=null,this.endPoint=null,this.repaint()}this.isMouseDown=!1,Xe.removeEventListener("mousemove",t,this)},_isDragToSelect:function(t){return!this.network._dragToPan},handle_mousedown:function(t){var e=this.network;if(t.target==e.getView()||t.target==e._topCanvas||t.target==e._rootCanvas){if(this.isMoving=!1,this.isSelecting=!1,this.hBarDownPoint=null,this.vBarDownPoint=null,this._setZoomDivVisible(!1),!this.network.isValidEvent(t)){var i=this.getMarkerPoint(t);return this.start(t),null!=this.vThumbRect&&We.containsPoint(this.vThumbRect,i.x,i.y)&&(this.vBarDownPoint={x:t.screenX,y:t.screenY},this.vBarDownOffset=this.vBarDownPoint.y-this.vThumbRect.y),void(null!=this.hThumbRect&&We.containsPoint(this.hThumbRect,i.x,i.y)&&(this.hBarDownPoint={x:t.screenX,y:t.screenY},this.hBarDownOffset=this.hBarDownPoint.x-this.hThumbRect.x))}this.network.isFocusOnClick()&&De.Util.setFocus(this.network.getView());var n=this.network.getElementAt(t);if(this.network.isSelectingElement()||this.network.isEditingElement()||null==n||(this.network.isMovable(n)&&this.network.getElementBox().getSelectionModel().isSelectable(n)?this.isMoving=!0:this.network.getView().style.cursor="pointer",this.start(t)),!this.network.isSelectingElement()&&!this.network.isEditingElement()){var o=this.network.getSelectionModel();null==n||n&&!this.network.getElementBox().getSelectionModel().isSelectable(n)?(Me.isCtrlDown(t)?this.isSelecting=!0:this._isDragToSelect(t)?(this.isSelecting=!0,o.clearSelection()):this.network.isRectSelectEnabled()&&(o.clearSelection(),this.network.getView().style.cursor="pointer"),this.start(t)):Me.isCtrlDown(t)?o.contains(n)?o.removeSelection(n):o.appendSelection(n):o.contains(n)||o.setSelection(n)}this.handleClicked(t,n),this.isMouseDown=!0}},handle_mousemove:function(t){this._setZoomDivVisible(!1);var e=this.network.getLogicalPoint2(t);if(e){var i={x:t.screenX,y:t.screenY},n=this.network.getCanvasSize(),o=this.network.getViewRect().height,r=this.network.getViewRect().width,a=this.getScrollBarWidth();if(null!=this.hBarDownPoint){var s=i.x-this.hBarDownPoint.x;return this.hBarDownPoint=i,void this.network.setViewOffSet(s*n.width/(r-a),0)}if(null!=this.vBarDownPoint){var l=i.y-this.vBarDownPoint.y;return this.vBarDownPoint=i,void this.network.setViewOffSet(0,l*n.height/(o-a))}if(this.network.isSelectingElement()||this.network.isEditingElement()||!this.isMoving||!this.isMouseDown||Me.isCtrlDown(t))if(this.isSelecting&&(Me.isCtrlDown(t)||this._isDragToSelect()))this.network.setSelectingElement(!0),this.network.fireInteractionEvent(null==this.endPoint?{kind:"selectStart",event:t}:{kind:"selectBetween",event:t}),this.endPoint=e,this.repaint();else if(this.isMoving||this.isSelecting||!this.isMouseDown)this.end(t);else{if(!this.lastPanPoint||!this.network._dragToPan)return;var e=this.getMarkerPoint(t);if(!e)return;var h=e.x-this.lastPanPoint.x,c=e.y-this.lastPanPoint.y;this.network.panByOffset(-h,-c),this.network.fireInteractionEvent({kind:"panning",event:t}),this.network.state.panning=!0,this.lastPanPoint=e}else{var u=this.getOffset(e,this.lastPoint);if(this.xoffset=u.x,this.yoffset=u.y,Math.abs(this.xoffset)<1&&Math.abs(this.yoffset)<1)return;this.lazyMode?null==this.dragPoint?(this.network.fireInteractionEvent({kind:"lazyMoveStart",event:t}),this.network.setMovingElement(!0)):this.network.fireInteractionEvent({kind:"lazyMoveBetween",event:t}):(this.lastPoint=e,this.network.isMovingElement()?this.network.fireInteractionEvent({kind:"liveMoveBetween",event:t}):(this.network.setMovingElement(!0),this.network.fireInteractionEvent({kind:"liveMoveStart",event:t})),this.network.moveSelectedElements(this.xoffset,this.yoffset)),this.parentProcess(t,!1),this.lazyMode&&(this.dragPoint=e),(this.lazyMode||this.isParenting())&&this.repaint()}}},handleMouseWheel:function(t){if(ze.activeElement===this.network.getView()){if(!this.network._wheelToZoom)return void this._handleMouseWheelScroll(t);Xe.preventDefault(t);var e={x:t.offsetX||t.layerX,y:t.offsetY||t.layerY},i=this.network.getZoom();t.wheelDelta&&t.wheelDelta>0||t.detail&&t.detail<0?this.network.setZoom(1.1*i,e):this.network.setZoom(i/1.1,e),this._setZoomDivVisible(this.network.isZoomDivVisible(),t,"Zoom : "+parseFloat(this.network.getZoom().toFixed(4)))}},_handleMouseWheelScroll:function(t){Xe.preventDefault(t);var e=!1,i=this._getVisibleScrollBar();null!=i&&(e=t.wheelDelta?t.wheelDelta>0:t.detail<0,"v"==i?this.scrollYOffset(e):this.scrollXOffset(e))},handle_mouseup:function(t){this.end(t)},isParenting:function(){return this.pressPoint&&null!=this.currentKeyEvent&&80===this.currentKeyEvent.keyCode},parentProcess:function(t,e){var i=null;this.parent=null;var n=this;if(!e&&this.isParenting()){var o={},r=this.network.getLogicalPoint2(t);o.x=r.x-1,o.y=r.y-1,o.width=2,o.height=2;var a=this.network.getElementsAtRect(o,!0);if(a&&a.size()>0)for(var s=a.size(),l=0;s>l;l++){var h=a.get(l);if(!n.network.getElementBox().getSelectionModel().contains(h)){n.parent=h;break}}}else this.parent=null;null!=this.parent&&(i=this.network.getElementUI(this.parent).getViewRect()),this.parentRect=null==i||e?null:i},getIntersectMode:function(){return"intersect"===this.network.getSelectMode()||"contain"!==this.network.getSelectMode()&&(this.startPoint.x>this.endPoint.x&&this.startPoint.y>this.endPoint.y)},_getVisibleScrollBar:function(){return 0==this.network.isScrollBarVisible()?null:null!=this.vThumbRect?"v":null!=this.hThumbRect?"h":null},paintScroll:function(t){if(0!=this.network.isScrollBarVisible()&&(0!=this.scrollBarVisible||null!=this.hBarDownPoint||null!=this.vBarDownPoint)){var e=this.getScrollBarWidth(),i=this.network.getViewRect().height,n=this.network.getViewRect().width;t.save();var o,r=this.getScrollBarColor();null!=this.hThumbRect&&(o=t.createLinearGradient(this.hThumbRect.x,this.hThumbRect.y,this.hThumbRect.x,this.hThumbRect.y+this.hThumbRect.height),o.addColorStop(0,r),o.addColorStop(1,"#666666"),this.paintRoundRect(t,this.getScrollBarColor(),.5,0,i-e,n-e,e,e/2),this.paintRoundRect(t,o,.9,this.hThumbRect.x,this.hThumbRect.y+1,this.hThumbRect.width,this.hThumbRect.height-2,e/2)),null!=this.vThumbRect&&(o=t.createLinearGradient(this.vThumbRect.x,this.vThumbRect.y,this.vThumbRect.x+this.vThumbRect.width,this.vThumbRect.y),o.addColorStop(0,r),o.addColorStop(1,"#666666"),this.paintRoundRect(t,this.getScrollBarColor(),.5,n-e,0,e,i-e,e/2),this.paintRoundRect(t,o,.9,this.vThumbRect.x+1,this.vThumbRect.y,this.vThumbRect.width-2,this.vThumbRect.height,e/2)),t.restore()}},paintRoundRect:function(t,e,i,n,o,r,a,s){t.beginPath(),t.globalAlpha=i,t.fillStyle=e,Ye.drawRoundRect(t,n,o,r,a,s),t.fill()},paint:function(t){if(this.paintScroll(t),this.network.isSelectingElement()){if(null==this.startPoint||null==this.endPoint)return;var e=this.convertPointFromView(this.startPoint),i=this.convertPointFromView(this.endPoint),n=e.x,o=e.y,r=i.x,a=i.y,s=We.getRect([{x:n,y:o},{x:r,y:a}]);if(null!=s){t.beginPath();var l=this.network.getSelectOutlineWidth(),h=this.getIntersectMode()?this.network.getSelectFillColor():null;t.strokeStyle=this.network.getSelectOutlineColor(),t.lineWidth=l,Nn.rect(t,s.x,s.y,s.width,s.height,h,this.network.getSelectOutlineColor()),t.closePath()}}else{if(this.lazyMode){if(null==this.pressPoint||null==this.dragPoint)return;t.beginPath();var c=this.getOffset(this.dragPoint,this.pressPoint),u=c.x,d=c.y,f=this.network.getMovableSelectedElements(),p=f.size(),g=this.network.isLazyMoveFill()?this.network.getLazyMoveFillColor():null,l=this.network.getLazyMoveOutlineWidth(),_=this.network.getLazyMoveOutlineColor();t.strokeStyle=_,t.lineWidth=l,t.fillStyle=g;for(var m=0;p>m;m++){var v=f.get(m),y=this.network.getElementUI(v);if(y){var w=this.convertFromUIToMarkerRect(y.getViewRect(),u,d);Nn.rect(t,w.x,w.y,w.width,w.height)}}t.fill(),t.stroke()}if(this.parentRect){t.beginPath();var g=this.network.isLazyMoveFill()?this.network.getLazyMoveFillColor():null,l=this.network.getLazyMoveOutlineWidth(),_=this.network.getLazyMoveOutlineColor();t.strokeStyle=_,t.lineWidth=l,t.fillStyle=g;var w=this.parentRect;Nn.rect(t,w.x,w.y,w.width,w.height),t.fill(),t.stroke()}}},handleClicked:function(t,e){Ai.handleClicked(this.network,t,e)},handleDoubleClicked:function(t){var e=this.network.getElementAt(t);Ai.handleDoubleClicked(this.network,t,e)}}),De.vector.interaction.CreateElementInteraction=function(t,e){e||(e=De.Node),this.elementFunction=De.Util.isTypeOf(e,De.Node)?function(t){var i=new e;return i instanceof De.Node&&i.setCenterLocation(t),i}:e,De.vector.interaction.CreateElementInteraction.superClass.constructor.call(this,t)},Me.ext("twaver.vector.interaction.CreateElementInteraction",De.vector.interaction.BaseInteraction,{setUp:function(){this.addListener("mousedown")},tearDown:function(){this.removeListener("mousedown")},handle_mousedown:function(t){var e=this.network.getLogicalPoint2(t);if(e){var i=this.elementFunction(e);i&&this.network.addElementByInteraction(i)}}}),De.vector.interaction.EditInteraction=function(t,e){this.lazyMode=e,this.pointIndex=-1,this.linkPointsType=null,De.vector.interaction.EditInteraction.superClass.constructor.call(this,t)},Me.ext("twaver.vector.interaction.EditInteraction",De.vector.interaction.BaseInteraction,{setUp:function(){this.addListener("mousedown","mouseup","mousemove"),this.oldCursor=this.network.getView().style.cursor,this.network.setHasEditInteraction(!0),this.network.addMarker(this)},tearDown:function(){this.removeListener("mousedown","mouseup","mousemove"),this.network.getView().style.cursor=this.oldCursor,this.network.setHasEditInteraction(!1),this.clear(),this.network.removeMarker(this)},paint:function(t){if(1==this.lazyMode&&null!=this.resizingRect){t.lineWidth=this.network.getResizeLineWidth();var e=this.convertFromUIToMarkerRect(this.resizingRect,0,0,this.node);t.save(),De.Util.rotateCanvas(t,e,this.node.getAngle()),t.beginPath(),Nn.rect(t,e.x,e.y,e.width,e.height,null,this.network.getResizeLineColor()),t.restore()}this.isStartRotate&&this.showRotateScale(t)},clear:function(){this.network.setEditingElement(!1),this.network.setRotatingElement(!1),this.isStart=!1,this.isStartRotate=!1,this.node=null,this.shapeNode=null,this.shapeLink=null,this.linkUI=null,this.resizingRect=null,this.resizeDirection=null,this.pointIndex=-1,this._removeCursor(),this.oldCursor=null,this.network.repaintTopCanvas()},_removeCursor:function(){this.cursorID&&(this.network.getView().style.cursor=this.oldCursor||"default",this.cursorID=null),this.resizeDirection=null,this.isCrossCursor=!1},_setCrossCursor:function(){this.isCrossCursor||(this._removeCursor(),this._setCursor("crosshair"),this.isCrossCursor=!0)},_setCursor:function(t){this.cursorID=t,this.network.getView().style.cursor!==this.cursorID&&(this.network.getView().style.cursor=this.cursorID)},handle_mousedown:function(t){if(0===t.button)if(!Me.isAltDown(t)||this.network.isEditingElement())!this.network.isEditingElement()||this.isStart||this.isStartRotate||(this.node&&this.resizeDirection?(this.isStart=!0,this._handle_mousedown(t),this.network.fireInteractionEvent({kind:this.lazyMode?"lazyResizeStart":"liveResizeStart",event:t,element:this.node,resizeDirection:this.resizeDirection})):this.shapeNode&&this.pointIndex>=0?Me.isAltDown(t)?(this.shapeNode.removeAt(this.pointIndex),this.network.fireInteractionEvent({kind:"removePoint",event:t,element:this.shapeNode})):(this.isStart=!0,this._handle_mousedown(t),this.network.fireInteractionEvent({kind:"liveMovePointStart",event:t,element:this.shapeNode,pointIndex:this.pointIndex})):this.shapeLink?Me.isAltDown(t)?this.pointIndex>=0&&(this.shapeLink.removeAt(this.pointIndex),this.network.fireInteractionEvent({kind:"removePoint",event:t,element:this.shapeLink})):(this.isStart=!0,this._handle_mousedown(t),this.network.fireInteractionEvent({kind:"liveMovePointStart",event:t,element:this.shapeLink,pointIndex:this.pointIndex})):this.linkUI?(this.isStart=!0,this.network.fireInteractionEvent({kind:"liveMovePointStart",event:t,element:this.linkUI._element})):this.node&&(this.isStartRotate=!0,this._handle_mousedown(t)));else{var e=this.network.getElementAt(t),i=this.network.getLogicalPoint2(t);if(e instanceof De.ShapeNode){var n=this.getPointIndex(this.network.getShapeNodeZoomPoints(e),i,!0);n>0&&(this._handle_mousedown(t),this.pointIndex=n,this.shapeNode=e,e.addPoint(i,n),this._setCrossCursor(),this.network.setEditingElement(!0),this.isStart=!0,this.network.fireInteractionEvent({kind:"addPoint",event:t,element:e,pointIndex:n}),this.network.fireInteractionEvent({kind:"liveMovePointStart",event:t,element:e,pointIndex:n}))}if(e instanceof De.ShapeLink){var o=new De.List(e.getPoints()),r=this.network.getElementUI(e);o.add(r.getFromPoint(),0),o.add(r.getToPoint());var n=this.getPointIndex(o,i)-1;n>0&&(this._handle_mousedown(t),this.pointIndex=n,this.shapeLink=e,e.addPoint(i,n),this._setCrossCursor(),this.network.setEditingElement(!0),this.isStart=!0,this.network.fireInteractionEvent({kind:"addPoint",event:t,element:e,pointIndex:n}),this.network.fireInteractionEvent({kind:"liveMovePointStart",event:t,element:e,pointIndex:n}))}}},handle_mouseup:function(t){if(this.isStart){var e=this.network.getLogicalPoint2(t);if(this.resizingRect)if(this.lazyMode)if(this.network.isResizeAnimate()){var i=this,n=new De.animate.AnimateBounds(this.node,this.resizingRect,function(){i.network.fireInteractionEvent({kind:"lazyResizeEnd",event:t,element:i.node,resizeDirection:i.resizeDirection}),i.clear()});De.animate.AnimateManager.start(n)}else this.node.setLocation(this.resizingRect.x,this.resizingRect.y),this.node.setSize(this.resizingRect.width,this.resizingRect.height),this.network.fireInteractionEvent({kind:"lazyResizeEnd",event:t,element:this.node,resizeDirection:this.resizeDirection});else this.node.setLocation(this.resizingRect.x,this.resizingRect.y),this.node.setSize(this.resizingRect.width,this.resizingRect.height),this.network.fireInteractionEvent({kind:"liveResizeEnd",event:t,element:this.node,resizeDirection:this.resizeDirection});else this.shapeNode&&this.pointIndex>=0&&e?(this._resetShapeNodePoints(e),this.network.fireInteractionEvent({kind:"liveMovePointEnd",event:t,element:this.shapeNode,pointIndex:this.pointIndex})):e&&(this.shapeLink||this.linkUI)&&("from"===this.linkPointsType?this._setFromPoint(e):"to"===this.linkPointsType?this._setToPoint(e):"shapeControl"===this.linkPointsType?(this._resetShapeLinkPoints(e),this.network.fireInteractionEvent({kind:"liveMovePointEnd",event:t,element:this.shapeLink,pointIndex:this.pointIndex})):"control"===this.linkPointsType&&vi.isOrthogonalLink(this.linkUI._element)&&this.linkUI.getControlPoint()&&(this._setLinkControlPoint(e),this.network.fireInteractionEvent({kind:"liveMovePointEnd",event:t,element:this.linkUI._element})))}this._handle_mouseup(t),this.lazyMode||this.clear()},handle_mousemove:function(t){var e=this.network.getEditPointSize();if(this.network.isValidEvent(t)){if(this.isStartRotate&&this.node)return this._handleRotateElement(t,this.node),void(this.network.isShowRotateScale()&&this.repaint());if(this.isStart){if(this.shapeNode&&this.pointIndex>=0)return void this._handleMovingShapeNodePoint(t);if(this.node&&this.resizeDirection)return void this._handleResizing(t);if((this.shapeLink||this.linkUI)&&this.linkPointsType){if("from"===this.linkPointsType)return void this._handleMovingFromPoint(t);if("to"===this.linkPointsType)return void this._handleMovingToPoint(t);if("shapeControl"===this.linkPointsType)return void this._handleMovingShapeLinkPoint(t);if("control"===this.linkPointsType&&vi.isOrthogonalLink(this.linkUI._element)&&this.linkUI.getControlPoint())return void this._handleMovingLinkControlPoint(t)}}if(this.network.isSelectingElement()||this.network.isMovingElement()||0===this.network.getSelectionModel().size())return void this.clear();var i=this.network.getElementAt(t),n=this.network.getElementUI(i);if(!n||!n.getEditAttachment())return void this.clear();var o=this.network.getLogicalPoint2(t);if(i instanceof De.Node){if(this.node=i,this._isEditingShapeNode(o)||this._isResizingNode(o))return void this.network.setEditingElement(!0);if(this._isRotatingElement(o))return this.network.setRotatingElement(!0),void this.network.setEditingElement(!0)}else if(i instanceof De.Link){i instanceof De.ShapeLink?this.shapeLink=i:n instanceof De.vector.LinkUI&&(this.linkUI=n);var r,a=i.getFromAgent();r=a?i.getFromAgent():i.getFromNode();var s,l=i.getStyle("link.from.xoffset"),h=i.getStyle("link.from.yoffset"),c=this.network.getElementUI(r),u=c.getZoomBodyRect(),d={x:u.x+u.width/2,y:u.y+u.height/2},f={x:d.x+l,y:d.y+h},p=i.getToAgent();s=p?i.getToAgent():i.getToNode();var g=i.getStyle("link.to.xoffset"),_=i.getStyle("link.to.yoffset"),m=this.network.getElementUI(s),v=m.getZoomBodyRect(),y={x:v.x+v.width/2,y:v.y+v.height/2},w={x:y.x+g,y:y.y+_};if(f&&this._contains(o,f,e))return this.linkPointsType="from",this._setCrossCursor(),void this.network.setEditingElement(!0);if(w&&this._contains(o,w,e))return this.linkPointsType="to",this._setCrossCursor(),void this.network.setEditingElement(!0);if(i instanceof De.ShapeLink){if(this._isEditingShapeLink(o))return this.linkPointsType="shapeControl",void this.network.setEditingElement(!0)}else if(n instanceof De.vector.LinkUI){if(vi.isOrthogonalLink(n._element)){var b=this.linkUI.getControlPoint();if(b&&this._contains(o,b,e))return this.linkPointsType="control",this._setCrossCursor(),void this.network.setEditingElement(!0)}return void(this.linkPointsType=null)}this.linkPointsType=null}this.clear()}},_isRotatingElement:function(t){if(0>=this.network.getRotatePointSize())return!1;var e=this.network.zoomManager,i=this.network.getElementUI(this.node),n=e.getSizeZoom(i),o=e._getElementZoomRect(i,this.node.getOriginalRect()),r=this.node.getAngle();return this._isRotating(t,"crosshair",o,r,n)},_isRotating:function(t,e,i,n,o){var r=this.network.getRotatePointSize()/this.network.getGraphicsZoom(),a={x:i.x+i.width/2,y:i.y-this.network.getRotatePointOffset()/this.network.getGraphicsZoom()-r},s=this._rotatePoint(a,n,i),l={x:s.x-r,y:s.y-r,width:2*r,height:2*r};return!!We.containsPoint(l,t)&&(this._removeCursor(),this._setCursor(e),!0)},_handleRotateElement:function(t,e){this._handle_mousemove(t);var i=this._calculateAngle(this.network.getLogicalPoint2(t),e);e.setAngle(i)},_calculateAngle:function(t,e){var i=this.network.getZoomBodyRect(e),n=We.getCenterPoint(i);return Math.round(180*Math.atan2(n.x-t.x,t.y-n.y)/Math.PI+180)},_resetShapeNodePoints:function(t){var e=this.network.getShapeNodeZoomPoints(this.shapeNode);e.set(this.pointIndex,t);var i=this.network.getElementUI(this.shapeNode),n=this.network.zoomManager._getShapeNodeZoomPoints(i,e,!0);this.shapeNode.setPoints(n)},_handleMovingShapeNodePoint:function(t){var e=this.network.getLogicalPoint2(t);this._resetShapeNodePoints(e),this.network.fireInteractionEvent({kind:"liveMovePointBetween",e:t,element:this.shapeNode,pointIndex:this.pointIndex})},_resetShapeLinkPoints:function(t){var e=this.network.zoomManager._getShapeLinkZoomPoints(this.shapeLink._points);e.set(this.pointIndex,t);var i=this.network.zoomManager._getShapeLinkZoomPoints(e,!0);this.shapeLink.setPoints(i)},_handleMovingShapeLinkPoint:function(t){var e=this.network.getLogicalPoint2(t);this._resetShapeLinkPoints(e),this.network.fireInteractionEvent({kind:"liveMovePointBetween",e:t,element:this.shapeLink,pointIndex:this.pointIndex})},_setLinkControlPoint:function(t){var e=this.linkUI.getControlPoint(),i=this.linkUI.getControlPoint(),n=(this.network.zoomManager,{x:t.x-i.x,y:t.y-i.y});e.x+=n.x,e.y+=n.y,this.linkUI.setControlPoint(e)},_handleMovingLinkControlPoint:function(t){var e=this.network.getLogicalPoint2(t);this._setLinkControlPoint(e),this.network.fireInteractionEvent({kind:"liveMovePointBetween",e:t,element:this.linkUI._element})},_setFromPoint:function(t){var e;if(this.linkUI)e=this.linkUI._element;else{if(!this.shapeLink)return;e=this.shapeLink}var i;i=e.getFromAgent()?e.getFromAgent():e.getFromNode();var n=this.network.getElementUI(i),o=n.getZoomBodyRect(),r={x:o.x+o.width/2,y:o.y+o.height/2},a={x:t.x-r.x,y:t.y-r.y};e.setStyle("link.from.xoffset",a.x),e.setStyle("link.from.yoffset",a.y)},_handleMovingFromPoint:function(t){var e=this.network.getLogicalPoint2(t);this._setFromPoint(e)},_setToPoint:function(t){var e;if(this.linkUI)e=this.linkUI._element;else{if(!this.shapeLink)return;e=this.shapeLink}var i;i=e.getToAgent()?e.getToAgent():e.getToNode();var n=this.network.getElementUI(i),o=n.getZoomBodyRect(),r={x:o.x+o.width/2,y:o.y+o.height/2},a={x:t.x-r.x,y:t.y-r.y};e.setStyle("link.to.xoffset",a.x),e.setStyle("link.to.yoffset",a.y)},_handleMovingToPoint:function(t){var e=this.network.getLogicalPoint2(t);this._setToPoint(e)},convertFromUIToMarkerRect:function(t,e,i,n){var o=this.network.zoomManager,r=o.getLocationZoom(),a=o.getGraphicsZoom(),s=this.network.getElementUI(n),l=o.getSizeZoom(s),h=t.x+t.width/2,c=t.y+t.height/2,u=h-t.x,d=c-t.y;return{x:h*r*a-this.network.getViewRect().x+e*r*a-u*l*a,y:c*r*a-this.network.getViewRect().y+i*r*a-d*l*a,width:t.width*l*a,height:t.height*l*a}},_getReverseZoomPoint:function(t,e,i){var n=this.network.zoomManager,o=n.getLocationZoom(),r=n.getSizeZoom(this.network.getElementUI(t));return e.x*=o,e.y*=o,{x:e.x/o+(i.x-e.x)/r,y:e.y/o+(i.y-e.y)/r}},_getReverseZoomRect:function(t,e){var i=this.network.zoomManager,n=i.getLocationZoom(),o=i.getSizeZoom(r);if(n==o)return t;var r=this.network.getElementUI(e),a=r.getBodyRect(),s=a.x+a.width/2,l=a.y+a.height/2,h={x:s*n+(t.x-s)*o,y:l*n+(t.y-l)*o,width:t.width*o,height:t.height*o};return s=h.x+h.width/2,l=h.y+h.height/2,{x:s/n+(h.x-s)*o,y:l/n+(h.y-l)*o,width:t.width,height:t.height}},_handleResizing:function(t){this._handle_mousemove(t);var e=this.node.getAngle(),i=this.node.getLocation(),n=this.node.getWidth()/2,o=this.node.getHeight()/2,r={x:i.x+n,y:i.y+o},a={x:-n,y:-o},s={x:-n,y:o},l={x:n,y:o},h={x:n,y:-o},c={x:0,y:-o},u={x:n,y:0},d={x:0,y:o},f={x:-n,y:0},p=this._getReverseZoomPoint(this.node,Me.clone(r),this._endLogical);if("northwest"===this.resizeDirection&&(this._transformPoint(l,r,e),a.x=p.x,a.y=p.y,r.x=(a.x+l.x)/2,r.y=(a.y+l.y)/2,this._reversPoint(a,r,e),this._reversPoint(l,r,e),this.resizingRect={x:a.x,y:a.y,width:l.x-a.x,height:l.y-a.y},Me.isShiftDown(t)&&this._revertResizeRect(this.node,this.resizingRect,1)),"north"===this.resizeDirection){var g={x:p.x,y:p.y};this._reversPoint(g,r,e),c.y=g.y-r.y,this._transformPoint(c,r,e),this._transformPoint(d,r,e),r.x=(c.x+d.x)/2,r.y=(c.y+d.y)/2,this._reversPoint(c,r,e),this._reversPoint(d,r,e),this.resizingRect={x:r.x-this.node.getWidth()/2,y:r.y-(d.y-c.y)/2,width:this.node.getWidth(),height:d.y-c.y}}if("northeast"===this.resizeDirection&&(this._transformPoint(s,r,e),h.x=p.x,h.y=p.y,r.x=(s.x+h.x)/2,r.y=(s.y+h.y)/2,this._reversPoint(s,r,e),this._reversPoint(h,r,e),this.resizingRect={x:s.x,y:h.y,width:h.x-s.x,height:s.y-h.y},Me.isShiftDown(t)&&this._revertResizeRect(this.node,this.resizingRect,2)),"west"===this.resizeDirection){var g={x:p.x,y:p.y};this._reversPoint(g,r,e),f.x=g.x-r.x,this._transformPoint(u,r,e),this._transformPoint(f,r,e),r.x=(u.x+f.x)/2,r.y=(u.y+f.y)/2,this._reversPoint(u,r,e),this._reversPoint(f,r,e),this.resizingRect={x:r.x-(u.x-f.x)/2,y:r.y-this.node.getHeight()/2,width:u.x-f.x,height:this.node.getHeight()}}if("east"===this.resizeDirection){var g={x:p.x,y:p.y};this._reversPoint(g,r,e),u.x=g.x-r.x,this._transformPoint(u,r,e),this._transformPoint(f,r,e),r.x=(u.x+f.x)/2,r.y=(u.y+f.y)/2,this._reversPoint(u,r,e),this._reversPoint(f,r,e),this.resizingRect={x:r.x-(u.x-f.x)/2,y:r.y-this.node.getHeight()/2,width:u.x-f.x,height:this.node.getHeight()}}if("southwest"===this.resizeDirection&&(this._transformPoint(h,r,e),s.x=p.x,s.y=p.y,r.x=(s.x+h.x)/2,r.y=(s.y+h.y)/2,this._reversPoint(s,r,e),this._reversPoint(h,r,e),this.resizingRect={x:s.x,y:h.y,width:h.x-s.x,height:s.y-h.y},Me.isShiftDown(t)&&this._revertResizeRect(this.node,this.resizingRect,4)),"south"===this.resizeDirection){var g={x:p.x,y:p.y};this._reversPoint(g,r,e),d.y=g.y-r.y,this._transformPoint(c,r,e),this._transformPoint(d,r,e),r.x=(c.x+d.x)/2,r.y=(c.y+d.y)/2,this._reversPoint(c,r,e),this._reversPoint(d,r,e),this.resizingRect={x:r.x-this.node.getWidth()/2,y:r.y-(d.y-c.y)/2,width:this.node.getWidth(),height:d.y-c.y}}"southeast"===this.resizeDirection&&(this._transformPoint(a,r,e),l.x=p.x,l.y=p.y,r.x=(a.x+l.x)/2,r.y=(a.y+l.y)/2,this._reversPoint(a,r,e),this._reversPoint(l,r,e),this.resizingRect={x:a.x,y:a.y,width:l.x-a.x,height:l.y-a.y},Me.isShiftDown(t)&&this._revertResizeRect(this.node,this.resizingRect,3)),this.resizingRect=this._getReverseZoomRect(this.resizingRect,this.node),this.lazyMode?(this.repaint(),this.network.fireInteractionEvent({kind:"lazyResizeBetween",event:t,element:this.node,resizeDirection:this.resizeDirection})):(this.node.setLocation(this.resizingRect.x,this.resizingRect.y),this.node.setSize(this.resizingRect.width,this.resizingRect.height),this.network.fireInteractionEvent({kind:"liveResizeBetween",event:t,element:this.node,resizeDirection:this.resizeDirection}))},_revertResizeRect:function(t,e,i){var n=t.getOriginalRect(),o=Math.max(e.width/n.width,e.height/n.height),r=n.width*o,a=n.height*o,s=e.x,l=e.y;1==i?(s+=e.width-r,l+=e.height-a):2==i?l+=e.height-a:3==i||4==i&&(s+=e.width-r),e.x=s,e.y=l,e.width=r,e.height=a},_isEditingShapeNode:function(t){var e=this.network.getEditPointSize();if(this.node instanceof De.ShapeNode){this.shapeNode=this.node;for(var i=this.network.getShapeNodeZoomPoints(this.node),n=0,o=i.size();o>n;n++){var r=i.get(n);if(this._contains(t,r,e))return this._setCrossCursor(),this.pointIndex=n,!0}}return this.pointIndex=-1,!1},_isEditingShapeLink:function(t){for(var e=this.network.getEditPointSize(),i=this.network.zoomManager._getShapeLinkZoomPoints(this.shapeLink.getPoints()),n=0,o=i.size();o>n;n++){var r=i.get(n);if(this._contains(t,r,e))return this._setCrossCursor(),this.pointIndex=n,!0}return this.pointIndex=-1,!1},_isResizingNode:function(t){if(0>=this.network.getResizePointSize())return!1;var e=this.network.zoomManager,i=this.network.getElementUI(this.node),n=e._getElementZoomRect(i,this.node.getOriginalRect()),o=this.node.getAngle(),r={x:n.x,y:n.y},a=this._rotatePoint(r,o,n);return!!this._isResizing(t,a.x,a.y,"northwest","nwse-resize")||(r={x:n.x+n.width/2,y:n.y},a=this._rotatePoint(r,o,n),!!this._isResizing(t,a.x,a.y,"north","ns-resize")||(r={x:n.x+n.width,y:n.y},a=this._rotatePoint(r,o,n),!!this._isResizing(t,a.x,a.y,"northeast","nesw-resize")||(r={x:n.x,y:n.y+n.height/2},a=this._rotatePoint(r,o,n),!!this._isResizing(t,a.x,a.y,"west","ew-resize")||(r={x:n.x+n.width,y:n.y+n.height/2},a=this._rotatePoint(r,o,n),!!this._isResizing(t,a.x,a.y,"east","ew-resize")||(r={x:n.x,y:n.y+n.height},a=this._rotatePoint(r,o,n),!!this._isResizing(t,a.x,a.y,"southwest","nesw-resize")||(r={x:n.x+n.width/2,y:n.y+n.height},a=this._rotatePoint(r,o,n),!!this._isResizing(t,a.x,a.y,"south","ns-resize")||(r={x:n.x+n.width,y:n.y+n.height},a=this._rotatePoint(r,o,n),!!this._isResizing(t,a.x,a.y,"southeast","nwse-resize"))))))))},_rotatePoint:function(t,e,i){return We.createMatrix(e*Math.PI/180,i.x+i.width/2,i.y+i.height/2).transform(t)},_isResizing:function(t,e,i,n,o){var r=this.network.getGraphicsZoom(),a=this.network.getResizePointSize()/r;return!!this._contains(t,{x:e,y:i},a)&&(this.resizeDirection!==n&&(this._removeCursor(),o=this._changeCursorWithAngle(n,this.node.getAngle()),this._setCursor(o),this.resizeDirection=n),!0)},_getRect:function(t,e,i,n){return{x:i>t?t:i,y:n>e?e:n,width:Math.abs(t-i),height:Math.abs(e-n)}},_contains:function(t,e,i){var n={x:e.x-i,y:e.y-i,width:2*i,height:2*i};return We.containsPoint(n,t)},getPointIndex:function(t,e,i){if(t.size()<2)return 0;for(var n,o=t.get(0),r=1;r<t.size();r++){if(n=t.get(r),this.isPointOnLine(e,o,n,6))return r;o=n}return o=t.get(0),i&&this.isPointOnLine(e,o,n,6)?t.size():0},showRotateScale:function(t){var e,i,n,o,r,a=(new De.List,this.network.getRotateScaleWidth()),s=this.network.getRotateScaleHeight(),l=this.network.getRotatePointSize(),h=this.node.getAngle(),c=this.network.zoomManager,u=this.network.getElementUI(this.node),d=c._getElementZoomRect(u,this.node.getOriginalRect()),f={x:d.x+d.width/2,y:d.y-this.network.getRotatePointOffset()-l},p=this._rotatePoint(f,h,d),g=h+"°",_=this.network.getViewRect();1===c.getLocationZoom()&&(t.translate(-_.x,-_.y),t.scale(this.network.getZoom(),this.network.getZoom())),this.node.getAngle()>=0&&this.node.getAngle()<=180?(i={x:p.x+l,y:p.y},n={x:i.x+a,y:i.y},o={x:n.x,y:n.y-s},r={x:i.x,y:o.y}):this.node.getAngle()>180&&this.node.getAngle()<=360&&(i={x:p.x-l,y:p.y},n={x:i.x-a,y:i.y},o={x:n.x,y:n.y-s},r={x:i.x,y:o.y});var m=new De.List([i,n,o,r]),e=Me.math.getRect(m);1!==c.getLocationZoom()&&(e.x-=_.x,e.y-=_.y),t.fillStyle=this.network.getRotateScaleFillColor(),t.fillRect(e.x,e.y,e.width,e.height),t.fillStyle=this.network.getRotateScaleFontColor(),t.textBaseline="middle",t.textAlign="center",t.font="13px Arial",t.fillText(g,e.x+e.width/2,e.y+e.height/2),1===c.getLocationZoom()&&(t.scale(1/this.network.getZoom(),1/this.network.getZoom()),t.translate(_.x,_.y))},isPointOnLine:function(t,e,i,n){return 0>n&&(n=0),n>=this.getDistanceFromPointToLine(t,e,i)&&t.x>=Math.min(e.x,i.x)-n&&t.x<=Math.max(e.x,i.x)+n&&t.y>=Math.min(e.y,i.y)-n&&t.y<=Math.max(e.y,i.y)+n},getDistanceFromPointToLine:function(t,e,i){if(e.x===i.x)return Math.abs(t.x-e.x);var n=(i.y-e.y)/(i.x-e.x),o=(i.x*e.y-e.x*i.y)/(i.x-e.x);return Math.abs(n*t.x-t.y+o)/Math.sqrt(n*n+1)},_transformPoint:function(t,e,i){var n=Math.cos(i*Math.PI/180),o=Math.sin(i*Math.PI/180),r=t.x,a=t.y,s=r*n-a*o,l=r*o+a*n;t.x=s+e.x,t.y=l+e.y},_reversPoint:function(t,e,i){i*=-1;var n=Math.cos(i*Math.PI/180),o=Math.sin(i*Math.PI/180),r=t.x-e.x,a=t.y-e.y,s=r*n-a*o,l=r*o+a*n;t.x=s+e.x,t.y=l+e.y},_changeCursorWithAngle:function(t,e){var i,n=["auto","nwse-resize","ns-resize","nesw-resize","ew-resize","nwse-resize","ns-resize","nesw-resize","ew-resize"];switch(t){case"northwest":i=1;break;case"north":i=2;break;case"northeast":i=3;break;case"east":i=4;break;case"southeast":i=5;break;case"south":i=6;break;case"southwest":i=7;break;case"west":i=8;break;default:i=0}return(e>=360||-360>=e)&&(e%=360),e>22.5&&67.5>=e&&(i+=1),-22.5>e&&e>=-67.5&&(i-=1),e>67.5&&112.5>=e&&(i+=2),-67.5>e&&e>=-112.5&&(i-=2),e>112.5&&157.5>=e&&(i+=3),-112.5>e&&e>=-157.5&&(i-=3),e>157.5&&202.5>=e&&(i+=4),-157.5>e&&e>=-202.5&&(i-=4),e>202.5&&247.5>=e&&(i+=5),-202.5>e&&e>=-247.5&&(i-=5),e>247.5&&292.5>=e&&(i+=6),-247.5>e&&e>=-292.5&&(i-=6),e>292.5&&337.5>=e&&(i+=7),-292.5>e&&e>=-337.5&&(i-=7),i>8&&(i-=8),0>=i&&(i+=8),n[i]}}),De.vector.interaction.CreateLinkInteraction=function(t,e){e||(e=De.Link),this.linkFunction=De.Util.isTypeOf(e,De.Link)?function(t,i){var n=new e;return n instanceof De.Link&&(n.setFromNode(t),n.setToNode(i)),n}:e,De.vector.interaction.CreateLinkInteraction.superClass.constructor.call(this,t)},Me.ext("twaver.vector.interaction.CreateLinkInteraction",De.vector.interaction.BaseInteraction,{setUp:function(){this.addListener("mousedown","mousemove"),this.network.addMarker(this)},tearDown:function(){this.removeListener("mousedown","mousemove"),this.clear(),this.network.removeMarker(this)},paint:function(t){t.beginPath();var e,i;t.lineWidth=this.network.getEditLineWidth();var n=this.network.getEditLineColor();this.currentNode&&this.currentNode!==this.fromNode&&(e=this.network.getElementUI(this.currentNode).getZoomViewRect(!0),i=this.convertFromUIToMarkerRect(e,0,0),Nn.rect(t,i.x,i.y,i.width,i.height,null,n)),this.fromNode&&(e=this.network.getElementUI(this.fromNode).getZoomViewRect(!0),i=this.convertFromUIToMarkerRect(e,0,0),Nn.rect(t,i.x,i.y,i.width,i.height,null,n)),this.currentPoint&&this.paintLine(t),t.closePath()},convertFromUIToMarkerRect:function(t,e,i){var n=this.network.zoomManager,o=n.getGraphicsZoom();return{x:t.x*o-this.network.getViewRect().x+e*o,y:t.y*o-this.network.getViewRect().y+i*o,width:t.width*o,height:t.height*o}},getZoomNodeRectOrPoint:function(t,e){var i=this.network.getElementUI(t).getZoomBodyRect();return e?{x:i.x+i.width/2,y:i.y+i.height/2}:i},paintLine:function(t){var e=this.network.getEditLineColor(),i=this.network.getElementUI(this.fromNode).getZoomBodyRect(),n=this.convertPointFromView({x:i.x+i.width/2,y:i.y+i.height/2}),o=n.x,r=n.y,a=this.currentPoint.x,s=this.currentPoint.y;t.strokeStyle=e,t.beginPath(),t.moveTo(o,r),t.lineTo(a,s),t.stroke()},clear:function(){this.currentPoint=null,this.currentNode=null,this.fromNode=null,this.toNode=null},createLink:function(){return this.linkFunction(this.fromNode,this.toNode)},handle_mousedown:function(t){if(this.network.isValidEvent(t))if(this.fromNode){if(this.toNode=this.currentNode,this.toNode){var e=this.createLink();e&&this.network.addElementByInteraction(e)}this.clear()}else this.fromNode=this.currentNode,this.currentNode=null,this.currentPoint=null,this.repaint()},handle_mousemove:function(t){var e=this.getMarkerPoint(t);if(e){if(this.network.isMovingElement()||this.network.isEditingElement())return void this.clear();var i=null;this.fromNode?(this.currentNode=this.getToNode(t,this.fromNode),this.currentPoint=e,this.repaint()):(i=this.getFromNode(t),this.currentNode!==i&&(this.currentNode=i,this.repaint()))}},getFromNode:function(t){return this.getNode(t)},getToNode:function(t,e){return this.getNode(t,e)},getNode:function(t,e){var i=this.network.getElementAt(t);return i instanceof On&&this.network.isLinkable(i,e)&&this.network.getElementBox().getSelectionModel().isSelectable(i)?i:null}}),De.vector.interaction.CreateShapeLinkInteraction=function(t,e){De.vector.interaction.CreateShapeLinkInteraction.superClass.constructor.call(this,t),e||(e=De.ShapeLink),this.linkFunction=De.Util.isTypeOf(e,De.ShapeLink)?function(t,i,n){var o=new e;if(o instanceof De.ShapeLink&&(o.setFromNode(t),o.setToNode(i),n)){var r=this.network.zoomManager;o.setPoints(r._getShapeLinkZoomPoints(n,!0))}return o}:e},Me.ext("twaver.vector.interaction.CreateShapeLinkInteraction",De.vector.interaction.CreateLinkInteraction,{clear:function(){this.points=null,De.vector.interaction.CreateShapeLinkInteraction.superClass.clear.call(this)},createLink:function(){return this.linkFunction(this.fromNode,this.toNode,this.points)},handle_mousedown:function(t){if(0===t.button){var e=this.network.getLogicalPoint2(t);if(e){if(this.fromNode)if(this.toNode=this.currentNode,this.toNode){var i=this.createLink();i&&this.network.addElementByInteraction(i),this.clear()}else{if(this.points||(this.points=new De.List),this.points.size()>0){var n=this.points.get(this.points.size()-1);if(n.x===e.x&&n.y===e.y)return}this.points.add(e)}else this.fromNode=this.currentNode,this.points=null,this.currentNode=null,this.currentPoint=null;this.repaint()}}},paintLine:function(t){if(this.currentPoint){var e,i=new De.List;if(e=this.convertPointFromView(this.getZoomNodeRectOrPoint(this.fromNode,!0)),i.add(e,0),this.points&&this.points.size()>0)for(var n=this.points.size(),o=0;n>o;o++)e=this.convertPointFromView(this.points.get(o)),i.add(e);e=this.currentPoint,i.add(e),t.lineWidth=this.network.getEditLineWidth(),t.strokeStyle=this.network.getEditLineColor(),t.beginPath(),Ye.drawLinePoints(t,i),t.stroke()}}}),De.vector.interaction.CreateShapeNodeInteraction=function(t,e){e||(e=De.ShapeNode),this.shapeNodeFunction=De.Util.isTypeOf(e,De.ShapeNode)?function(t){var i=new e;if(i instanceof De.ShapeNode){var n=this.network.zoomManager,o=this.network.createElementUI(i);if(t){var r=n._getShapeNodeZoomPoints(o,t,!0);o.invalidateZoom(),i.setPoints(r)}}return i}:e,De.vector.interaction.CreateShapeNodeInteraction.superClass.constructor.call(this,t),this.timeStamp=-1},Me.ext("twaver.vector.interaction.CreateShapeNodeInteraction",De.vector.interaction.BaseInteraction,{setUp:function(){this.addListener("mousedown","mousemove"),this.network.addMarker(this)},tearDown:function(){this.removeListener("mousedown","mousemove"),this.clear(),this.network.removeMarker(this),this.network.setEditingElement(!1)},clear:function(){this.points=null,this.currentPoint=null},paint:function(t){if(this.points&&this.points.size()>0&&this.currentPoint){for(var e,i=new De.List,n=this.points.size(),o=0;n>o;o++)e=this.convertPointFromView(this.points.get(o)),i.add(e);e=this.convertPointFromView(this.currentPoint),i.add(e),t.lineWidth=this.network.getEditLineWidth(),t.strokeStyle=this.network.getEditLineColor(),t.beginPath(),Ye.drawLinePoints(t,i),t.stroke()}},handle_mousedown:function(t){if(0===t.button){var e=this.network.getLogicalPoint2(t);if(e){if(2===t.detail||t.timeStamp-this.timeStamp<300){if(this.points){var i=this.shapeNodeFunction(this.points);this.network.addElementByInteraction(i),this.clear();var n=this;setTimeout(function(){n.network.setEditingElement(!1)},0)}}else{if(this.network.isEditingElement()||this.network.setEditingElement(!0),this.points||(this.points=new De.List),this.points.size()>0){var o=this.points.get(this.points.size()-1);if(o.x===e.x&&o.y===e.y)return}this.points.add(e)}this.timeStamp=t.timeStamp,this.repaint()}}},handle_mousemove:function(t){this.points&&(this.currentPoint=this.network.getLogicalPoint2(t),this.repaint())}}),De.vector.interaction.MagnifyInteraction=function(t,e,i,n,o){De.vector.interaction.MagnifyInteraction.superClass.constructor.call(this,t),this.scale=e||2,this.xRadius=i||100,this.yRadius=n||100,this.shape=o||"circle",this.borderColor="black",this.borderWidth=1,this.backgroundColor="white",this.markCanvas=Xe.createCanvas()},Me.ext("twaver.vector.interaction.MagnifyInteraction",De.vector.interaction.BaseInteraction,{setUp:function(){this.addListener("mousemove"),this.addListener("mousewheel"),this.network.addMarker(this)},tearDown:function(){this.removeListener("mousemove"),this.removeListener("mousewheel"),this.network.removeMarker(this)},paint:function(t){if(this.point){var e=this.network.zoomManager,i=e.getLocationZoom(),n=e.getGraphicsZoom(),o=(e.getSizeZoom(),this.network.getZoom(),this.xRadius/this.scale/n),r=this.yRadius/this.scale/n;if("mousewheel"===this.mouseFlag){var a={x:this.zoomPoint.x-o,y:this.zoomPoint.y-r,width:2*o,height:2*r};this.network.toCanvasByRegion(a,this.scale*n,this.markCanvas,"white");var s={x:this.zoomPoint.x-this.xRadius-this.network.viewRect.x,y:this.zoomPoint.y-this.yRadius-this.network.viewRect.y,width:this.markCanvas.width,height:this.markCanvas.height}}else{var a={x:this.point.x*i-o,y:this.point.y*i-r,width:2*o,height:2*r};this.network.toCanvasByRegion(a,this.scale*n,this.markCanvas,"white");var s={x:this.point.x*i*n-this.xRadius-this.network.viewRect.x,y:this.point.y*i*n-this.yRadius-this.network.viewRect.y,width:this.markCanvas.width,height:this.markCanvas.height}}t.save(),t.beginPath(),Ye.drawVector(t,this.shape,null,s.x,s.y,2*a.width*n,2*a.height*n),t.clip(),t.fillStyle=this.backgroundColor,t.beginPath(),t.rect(s.x,s.y,s.width,s.height),t.fill(),t.drawImage(this.markCanvas,s.x,s.y),t.restore(),t.beginPath(),t.lineWidth=this.borderWidth,Ye.drawVector(t,this.shape,null,s.x+this.borderWidth/2,s.y+this.borderWidth/2,2*a.width*n-this.borderWidth,2*a.height*n-this.borderWidth),t.strokeStyle=this.borderColor,t.stroke(),this.mouseFlag=null}},handle_mousemove:function(t){this.point=this.network.getLogicalPoint(t),this.point&&(this.mouseFlag="mousemove",this.repaint())},handle_mousewheel:function(t){1!==this.network.zoomManager.getLocationZoom()&&(this.zoomPoint=this.network.getLogicalPoint2(t)),this.zoomPoint&&(this.mouseFlag="mousewheel",this.repaint())},getScale:function(){return this.scale},setScale:function(t){this.scale=t,this.network.repaintTopCanvas()},getShape:function(){return this.shape},setShape:function(t){this.shape=t,this.network.repaintTopCanvas()},getXRadius:function(){return this.xRadius},setXRadius:function(t){this.xRadius=t,this.network.repaintTopCanvas()},getYRadius:function(){return this.yRadius},setYRadius:function(t){this.yRadius=t,this.network.repaintTopCanvas()},getBorderColor:function(){return this.borderColor},setBorderColor:function(t){this.borderColor=t,this.network.repaintTopCanvas()},getBorderWidth:function(){return this.borderWidth},setBorderWidth:function(t){this.borderWidth=t,this.network.repaintTopCanvas()},getBackgroundColor:function(){return this.backgroundColor},setBackgroundColor:function(t){this.backgroundColor=t,this.network.repaintTopCanvas()}}),De.vector.interaction.TouchInteraction=function(t){De.vector.interaction.TouchInteraction.superClass.constructor.call(this,t)},Me.ext("twaver.vector.interaction.TouchInteraction",De.vector.interaction.BaseInteraction,{setUp:function(){var t=this.network.getView();Xe.addEventListener("touchstart","handleTouchstart",t,this),Xe.addEventListener("touchmove","handleTouchmove",t,this),Xe.addEventListener("touchend","handleTouchend",t,this),Xe.addEventListener("touchcancel","handleTouchend",t,this)},tearDown:function(){var t=this.network.getView();Xe.removeEventListener("touchstart",t,this),Xe.removeEventListener("touchmove",t,this),Xe.removeEventListener("touchend",t,this),Xe.removeEventListener("touchcancel",t,this)},handleTouchstart:function(t){if(Xe.preventDefault(t),1==t.touches.length){var e=this.network.getLogicalPoint2(t),i=this._element=this.network.getElementAt(e);this._startTouchTime=new Date,this._currentTouchPoint=e,this._startTouchClient=this._currentTouchClient=this.getMarkerPoint(t),i?this.network.getSelectionModel().contains(i)||this.network.getSelectionModel().setSelection(i):this.network.getSelectionModel().clearSelection(),Ai.handleClicked(this.network,t,i),this._endTouchTime&&this._startTouchTime.getTime()-this._endTouchTime.getTime()<=500&&We.getDistance(this._endTouchClient,this._startTouchClient)<=20?(delete this._endTouchTime,delete this._endTouchClient,Ai.handleDoubleClicked(this.network,t,i)):(this._endTouchTime=this._startTouchTime,this._endTouchClient=this._startTouchClient)}else this._distance=wi.getDistance(t),this._zoom=this.network.getZoom()},handleTouchmove:function(t){if(Xe.preventDefault(t),t.touches.length>1){var e=wi.getDistance(t);if(Math.abs(e-this._distance)<20)return;var i=e/this._distance;this.network.setZoom(this._zoom*i,!1)}else if(null==this._zoom){var n=this.getMarkerPoint(t);if(We.getDistance(this._startTouchClient,n)<20)return;if(this._element){var o=this.network.getLogicalPoint2(t),r=this.getOffset(o,this._currentTouchPoint),a=r.x,s=r.y;this._currentTouchPoint=o,this.network.moveSelectedElements(a,s),this.network.isMovingElement()?this.network.fireInteractionEvent({kind:"liveMoveBetween",event:t}):(this.network.setMovingElement(!0),this.network.fireInteractionEvent({kind:"liveMoveStart",event:t}))}else{var a=this._currentTouchClient.x-n.x,s=this._currentTouchClient.y-n.y;this.network.panByOffset(a,s),this._currentTouchClient=n}}},handleTouchend:function(t){Xe.preventDefault(t),this.network.isMovingElement()&&(this.network.setMovingElement(!1),this.network.fireInteractionEvent({kind:"liveMoveEnd",event:t})),0===t.touches.length&&(this._distance=null,this._zoom=null,this._element=null,this._startTouchTime=null,this._currentTouchPoint=null,this._startTouchClient=this._currentTouchClient=null)}}),De.vector.interaction.MSTouchInteraction=function(t){De.vector.interaction.MSTouchInteraction.superClass.constructor.call(this,t),this._pointerMap={},this._pointerIdArray=[]},Me.ext("twaver.vector.interaction.MSTouchInteraction",De.vector.interaction.BaseInteraction,{setUp:function(){var t=this.network.getView();Xe.addEventListener("MSPointerDown","handleTouchstart",t,this),Xe.addEventListener("MSPointerMove","handleTouchmove",t,this),Xe.addEventListener("MSPointerUp","handleTouchend",t,this),Xe.addEventListener("MSPointerCancel","handleTouchend",t,this),this.network.addMarker(this)},tearDown:function(){var t=this.network.getView();Xe.removeEventListener("MSPointerDown",t,this),Xe.removeEventListener("MSPointerMove",t,this),Xe.removeEventListener("MSPointerUp",t,this),Xe.removeEventListener("MSPointerCancel",t,this),this.network.removeMarker(this)},handleTouchstart:function(t){if(this.network.isFocusOnClick()&&De.Util.setFocus(this.network._view),!this.network.isSelectingElement()||t.pointerType!=t.MSPOINTER_TYPE_MOUSE){var e=this.network.getLogicalPoint2(t),i=new Date;if(t.isPrimary&&this._pointerIdArray.length>0&&this.handle_mouseup(t),this._pointerMap[t.pointerId]||(this._pointerIdArray.push(t.pointerId),this._pointerMap[t.pointerId]=t),1==this._pointerIdArray.length){var n=this.network.getElementAt(e);this._startTouchElement=n,this._startClientPoint={x:t.clientX,y:t.clientY};var o=this.network.getSelectionModel();n?Me.isCtrlDown(t)?o.contains(n)?o.removeSelection(n):o.appendSelection(n):o.contains(n)||o.setSelection(n):Me.isCtrlDown(t)||o.clearSelection(),Ai.handleClicked(this.network,t,n),this._startTouchTime&&this._startTouchPoint&&i.getTime()-this._startTouchTime.getTime()<=500&&We.getDistance(this._startTouchPoint,e)<=20?(Ai.handleDoubleClicked(this.network,t,n),this._doubleClick=!0):(Xe.handle_mousedown(this,t),this._startTouchPoint=e,this._startTouchTime=i)}else 2==this._pointerIdArray.length&&(this._distance=this._getDistance(),this._zoom=this.network.getZoom())}},handleTouchmove:function(t){if(null!=this._startTouchPoint&&0!=this._pointerIdArray.length&&this._pointerMap[t.pointerId]&&!(We.getDistance({x:this._pointerMap[t.pointerId].pageX,y:this._pointerMap[t.pointerId].pageY},{x:t.pageX,y:t.pageY})<=10)&&(this._pointerMap[t.pointerId]=t,2==this._pointerIdArray.length)){var e=this._getDistance()/this._distance;this.network.setZoom(this._zoom*e,!1)}},handleTouchend:function(t){if(this.network.isMovingElement()&&(this.network.setMovingElement(!1),this.network.fireInteractionEvent({kind:"liveMoveEnd",event:t})),this.network.isSelectingElement()){var e=We.getRect([this._startTouchPoint,this._moveTouchPoint]),i=this.network.getElementsAtRect(e,this.getIntersectMode(),this.network.getRectSelectFilter());if(i&&i.size()>0){var n=this.network.getSelectionModel(),o=n.toSelection();i.forEach(function(t){n.contains(t)?o.remove(t):o.add(t)},this),n.setSelection(o)}this.network.fireInteractionEvent({kind:"selectEnd",event:t}),this._moveTouchPoint=null,this.network.setSelectingElement(!1),this.repaint()}this._doubleClick&&(delete this._doubleClick,delete this._startTouchPoint,delete this._startTouchTime);for(var r=-1,a=0;a<this._pointerIdArray.length;a++)if(this._pointerIdArray[a]==t.pointerId){r=a;break}r>=0&&this._pointerIdArray.splice(r,1),delete this._pointerMap[t.pointerId],this._moveTouchPoint=null},_getDistance:function(){return We.getDistance({x:this._pointerMap[this._pointerIdArray[0]].pageX,y:this._pointerMap[this._pointerIdArray[0]].pageY},{x:this._pointerMap[this._pointerIdArray[1]].pageX,y:this._pointerMap[this._pointerIdArray[1]].pageY})},getIntersectMode:function(){return"intersect"===this.network.getSelectMode()||"contain"!==this.network.getSelectMode()&&(this._startTouchPoint.x>this._moveTouchPoint.x&&this._startTouchPoint.y>this._moveTouchPoint.y)},handle_mousemove:function(t){var e={x:t.clientX,y:t.clientY};if(!(We.getDistance(this._startClientPoint,e)<3)&&this._startTouchPoint&&1==this._pointerIdArray.length)if(this._moveTouchPoint={x:this._startTouchPoint.x+(e.x-this._startClientPoint.x)/this.network.getZoom(),y:this._startTouchPoint.y+(e.y-this._startClientPoint.y)/this.network.getZoom()},null==this._startTouchElement&&this.network.isRectSelectEnabled()){var i=this.network.getLogicalPoint2(t);if(!i)return;this.network.setSelectingElement(!0),this.network.fireInteractionEvent(this._moveTouchPoint?{kind:"selectBetween",event:t}:{kind:"selectStart",event:t}),this.repaint()}else{var n=this.network.getElementAt(this._moveTouchPoint);if(null!=this._startTouchElement||this.network.isRectSelectEnabled()){if(this.network.isMovingElement()||null!=this._startTouchElement&&n==this._startTouchElement&&this.network.getMovableSelectedElements().contains(n)){var o=this._moveTouchPoint.x-this._startTouchPoint.x,r=this._moveTouchPoint.y-this._startTouchPoint.y;this.network.moveSelectedElements(o,r),this.network.isMovingElement()?this.network.fireInteractionEvent({kind:"liveMoveBetween",event:t}):(this.network.setMovingElement(!0),this.network.fireInteractionEvent({kind:"liveMoveStart",event:t}))}}else{var o=this._startClientPoint.x-e.x,r=this._startClientPoint.y-e.y;this.network.panByOffset(o,r)}this._startClientPoint=e}},handle_mouseup:function(t){this.handleTouchend(t),this._pointerIdArray=[],this._pointerMap={}},paint:function(t){if(this._startTouchPoint&&this._moveTouchPoint&&!this._startTouchElement&&this.network.isRectSelectEnabled()){var e=this.convertPointFromView(this._startTouchPoint),i=this.convertPointFromView(this._moveTouchPoint),n=e.x,o=e.y,r=i.x,a=i.y,s=We.getRect([{x:n,y:o},{x:r,y:a}]);if(null!=s){t.beginPath();var l=this.network.getSelectOutlineWidth(),h=this.getIntersectMode()?this.network.getSelectFillColor():null;t.strokeStyle=this.network.getSelectOutlineColor(),t.lineWidth=l,Nn.rect(t,s.x,s.y,s.width,s.height,h,this.network.getSelectOutlineColor()),t.closePath()}}}}),De.XmlSerializer=function(t,e,i){this.dataBox=t,this.settings=e||new De.SerializationSettings,this.filterFunction=i,this.ref=0,this.refMap={},this.idMap={},this.xmlString=""},Me.ext("twaver.XmlSerializer",Object,{serialize:function(){return this.xmlString="<twaver version='"+De.Util.getVersion()+"' platform='html5'>\n",this.serializeBody(),this.xmlString+="</twaver>\n",this.xmlString},serializeBody:function(){this.ref=0,this.dataBox.getRoots().forEach(this.initRefs,this),this.settings.isDataBoxSerializable&&(this.xmlString+="<dataBox class='"+this.dataBox.getClassName()+"'>\n",this.dataBox.serializeXml(this,this.dataBox.newInstance()),this.xmlString+="</dataBox>\n"),this.dataBox.getRoots().forEach(this.serializeData,this)},initRefs:function(t){this.refMap[t.getId()]=this.ref++,t.getChildren().forEach(this.initRefs,this)},isSerializable:function(t){return!!this.dataBox.contains(t)&&!(this.filterFunction&&!this.filterFunction(t))},serializeData:function(t){if(this.isSerializable(t)){var e=t.newInstance(),i=this.refMap[t.getId()];this.xmlString+="<data class='"+t.getClassName()+"' ref='"+i+"'",null!=this.settings.getPropertyType("id")&&(this.xmlString+=" id='"+t.getId()+"'"),this.xmlString+=">\n",t.serializeXml(this,e),this.xmlString+="</data>\n"}t.getChildren().forEach(this.serializeData,this)},serializePropertyXml:function(t,e,i){var n=this.settings.getPropertyType(e);if(n){var o=Me.getValue(t,e,n),r=Me.getValue(i,e,n);o!==r&&this.serializeValue("p",e,o,r,n)}},serializeStyleXml:function(t,e,i){var n=this.settings.getStyleType(e);if(n){var o=t.getStyle(e),r=i.getStyle(e);o!=r&&this.serializeValue("s",e,o,r,n)}},serializeClientXml:function(t,e,i){var n=this.settings.getClientType(e);if(null!=n){var o=t.getClient(e),r=i.getClient(e);o!=r&&this.serializeValue("c",e,o,r,n)}},serializeValue:function(t,e,i,n,o){if(null==i)this.xmlString+="\t<"+t+" n='"+e+"' none=''/>\n";else if("cdata"===o)this.xmlString+="\t<"+t+" n='"+e+"'><![CDATA["+i+"]]></"+t+">\n";else if("data"===o){var r=this.refMap[i.getId()];null!=r&&(this.xmlString+="\t<"+t+" n='"+e+"' ref='"+r+"'/>\n")}else"point"===o?n&&i.x===n.x&&i.y===n.y||(this.xmlString+="\t<"+t+" n='"+e+"' x='"+i.x+"' y='"+i.y+"'/>\n"):"list.point"===o?(this.xmlString+="\t<"+t+" n='"+e+"'>\n",i.forEach(function(t){this.xmlString+="\t\t<p x='"+t.x+"' y='"+t.y+"'/>\n"},this),this.xmlString+="\t</"+t+">\n"):"list.string"===o||"list.number"===o?(this.xmlString+="\t<"+t+" n='"+e+"'>\n",i.forEach(function(t){this.xmlString+="\t\t<s>"+t+"</s>\n"},this),this.xmlString+="\t</"+t+">\n"):this.xmlString+="rectangle"===o?"\t<"+t+" n='"+e+"' x='"+i.x+"' y='"+i.y+"' w='"+i.width+"' h='"+i.height+"'/>\n":"\t<"+t+" n='"+e+"'>"+i+"</"+t+">\n"},deserialize:function(t,e){Me.isDeserializing=!0,this.xmlString=t;var i=Me.xml(t).documentElement;this.refMap={},this.idMap={};var n,o,r,a=new hn,s=new hn,l=i.getElementsByTagName("data"),h=l.length;for(r=0;h>r;r++){o=l[r];var c=o.getAttribute("class"),u=this.settings.getPropertyType("id");if(u&&o.hasAttribute("id")){var d=null;if("string"===u)d=o.getAttribute("id");else if("int"===u)d=parseInt(o.getAttribute("id"));else{if("number"!==u)throw"Unsupported id type '"+u+"'";d=parseFloat(o.getAttribute("id"))}if("remove"===o.getAttribute("action")){this.dataBox.removeById(d);continue}(n=this.dataBox.getDataById(d))||(n=Me.newInstance(c,d))}else n=Me.newInstance(c);if(o.hasAttribute("ref")){var f=o.getAttribute("ref");this.refMap[f]=n}a.add(n),s.add(o),this.idMap[n.getId()]=n}for(this.dataBox.forEach(function(t){this.idMap[t.getId()]=t},this),h=a.size(),r=0;h>r;r++)n=a.get(r),o=s.get(r),n.deserializeXml(this,o);for(r=0;h>r;r++)n=a.get(r),this.dataBox.containsById(n.getId())||(e&&!n.getParent()&&n.setParent(e),this.dataBox.add(n));this.settings.isDataBoxSerializable&&1===i.getElementsByTagName("dataBox").length&&this.dataBox.deserializeXml(this,i.getElementsByTagName("dataBox")[0]),Me.isDeserializing=!1},deserializePropertyXml:function(t,e,i){var n=this.settings.getPropertyType(i);n&&Me.setValue(t,i,this.deserializeValue(e,n))},deserializeStyleXml:function(t,e,i){var n=this.settings.getStyleType(i);n&&t.setStyle(i,this.deserializeValue(e,n))},deserializeClientXml:function(t,e,i){var n=this.settings.getClientType(i);n&&t.setClient(i,this.deserializeValue(e,n))},deserializeValue:function(t,e){if(t.hasAttribute("@none"))return null;if("string"===e)return t.textContent;if("number"===e)return parseFloat(t.textContent);if("boolean"===e)return"true"===t.textContent;if("int"===e)return parseInt(t.textContent);if("point"===e)return{x:parseFloat(t.getAttribute("x")),y:parseFloat(t.getAttribute("y"))};if("data"===e){var i=t.getAttribute("ref"),n=this.refMap[i];return n||this.idMap[i]}var o,r,a,s;if("list.point"===e){var l=new hn,h=t.getElementsByTagName("p");for(o=h.length,s=0;o>s;s++){var c=h[s];l.add({x:parseFloat(c.getAttribute("x")),y:parseFloat(c.getAttribute("y"))})}return l}if("list.string"===e){var u=new hn;for(a=t.getElementsByTagName("s"),o=a.length,s=0;o>s;s++)u.add(a[s].textContent);return u}if("list.number"===e){for(r=new hn,a=t.getElementsByTagName("s"),o=a.length,s=0;o>s;s++)r.add(parseFloat(a[s].textContent));return r}if("array.string"===e)return t.textContent.split(",");if("array.number"===e){for(r=t.textContent.split(","),o=r.length,s=0;o>s;s++)r[s]=parseFloat(r[s]);return r}return"rectangle"===e?{x:parseFloat(t.getAttribute("x")),y:parseFloat(t.getAttribute("y")),width:parseFloat(t.getAttribute("w")),height:parseFloat(t.getAttribute("h"))}:t.textContent}}),Me.addMethod(De.Data,{serializeXml:function(t,e){if(t.settings.isClientSerializable&&this._clientMap)for(var i in this._clientMap)this.serializeClientXml(t,i,e);this.serializePropertyXml(t,"name",e),this.serializePropertyXml(t,"icon",e),this.serializePropertyXml(t,"toolTip",e),this.serializePropertyXml(t,"parent",e)},serializePropertyXml:function(t,e,i){t.serializePropertyXml(this,e,i)},serializeClientXml:function(t,e,i){t.serializeClientXml(this,e,i)},deserializeXml:function(t,e){var i,n,o,r,a=e.getElementsByTagName("p"),s=a.length;for(i=0;s>i;i++)n=a[i],n.hasAttribute("n")&&this.deserializePropertyXml(t,n,n.getAttribute("n"));if(t.settings.isClientSerializable)for(o=e.getElementsByTagName("c"),s=o.length,i=0;s>i;i++)r=o[i],r.hasAttribute("n")&&this.deserializeClientXml(t,r,r.getAttribute("n"))},deserializePropertyXml:function(t,e,i){t.deserializePropertyXml(this,e,i)},deserializeClientXml:function(t,e,i){t.deserializeClientXml(this,e,i)}}),Me.addMethod(De.Element,{serializeXml:function(t,e){if(t.settings.isStyleSerializable&&this._styleMap)for(var i in this._styleMap)this.serializeStyleXml(t,i,e);De.Element.superClass.serializeXml.call(this,t,e),this.serializePropertyXml(t,"layerId",e),this._alarmState.getHighestNativeAlarmSeverity()&&"alarmstate"===t.settings.getPropertyType("alarmState")&&(t.xmlString+="\t<p n='alarmState'>\n",De.AlarmSeverity.forEach(function(e){var i=this.getNewAlarmCount(e);i>0&&(t.xmlString+="\t\t<n n='"+e.name+"' c='"+i+"'/>\n")},this._alarmState),De.AlarmSeverity.forEach(function(e){var i=this.getAcknowledgedAlarmCount(e);i>0&&(t.xmlString+="\t\t<a n='"+e.name+"' c='"+i+"'/>\n")},this._alarmState),t.xmlString+="\t</p>\n")},serializeStyleXml:function(t,e,i){t.serializeStyleXml(this,e,i)},deserializeXml:function(t,e){if(De.Element.superClass.deserializeXml.call(this,t,e),t.settings.isStyleSerializable){var i,n,o=e.getElementsByTagName("s"),r=o.length;for(i=0;r>i;i++)n=o[i],n.hasAttribute("n")&&this.deserializeStyleXml(t,n,n.getAttribute("n"))}},deserializeStyleXml:function(t,e,i){t.deserializeStyleXml(this,e,i)},deserializePropertyXml:function(t,e,i){if("alarmState"===i){if("alarmstate"===t.settings.getPropertyType("alarmState")){var n,o,r,a=e.getElementsByTagName("n");for(o=0;o<a.length;o++)r=a[o],n=De.AlarmSeverity.getByName(r.getAttribute("n")),this._alarmState.setNewAlarmCount(n,parseInt(r.getAttribute("c")));for(a=e.getElementsByTagName("a"),o=0;o<a.length;o++)r=a[o],n=De.AlarmSeverity.getByName(r.getAttribute("n")),this._alarmState.setAcknowledgedAlarmCount(n,parseInt(r.getAttribute("c")))}}else De.Element.superClass.deserializePropertyXml.call(this,t,e,i)}}),Me.addMethod(On,{serializeXml:function(t,e){On.superClass.serializeXml.call(this,t,e),this.serializePropertyXml(t,"image",e),this.serializePropertyXml(t,"location",e),Me.num(this._width)&&this._width>=0&&this.serializePropertyXml(t,"width",e),Me.num(this._height)&&this._height>=0&&this.serializePropertyXml(t,"height",e)}}),Me.addMethod(De.Link,{serializeXml:function(t,e){De.Link.superClass.serializeXml.call(this,t,e),this.serializePropertyXml(t,"fromNode",e),this.serializePropertyXml(t,"toNode",e)}}),Me.addMethod(De.Follower,{serializeXml:function(t,e){De.Follower.superClass.serializeXml.call(this,t,e),this.serializePropertyXml(t,"host",e)}}),Me.addMethod(Mn,{serializeXml:function(t,e){Mn.superClass.serializeXml.call(this,t,e),this.serializePropertyXml(t,"expanded",e)}}),Me.addMethod(De.ShapeNode,{serializeXml:function(t,e){De.ShapeNode.superClass.serializeXml.call(this,t,e),this.serializePropertyXml(t,"points",e),this.serializePropertyXml(t,"segments",e)}}),Me.addMethod(De.ShapeLink,{serializeXml:function(t,e){De.ShapeLink.superClass.serializeXml.call(this,t,e),this.serializePropertyXml(t,"points",e)}}),Me.addMethod(De.RotatableNode,{serializeXml:function(t,e){De.RotatableNode.superClass.serializeXml.call(this,t,e),this.serializePropertyXml(t,"angle",e)}}),Me.addMethod(De.DataBox,{serializeXml:function(t,e){if(t.settings.isClientSerializable&&this._clientMap)for(var i in this._clientMap)this.serializeClientXml(t,i,e);this.serializePropertyXml(t,"name",e),this.serializePropertyXml(t,"icon",e),this.serializePropertyXml(t,"toolTip",e)},serializePropertyXml:function(t,e,i){t.serializePropertyXml(this,e,i)},serializeClientXml:function(t,e,i){t.serializeClientXml(this,e,i)},deserializeXml:function(t,e){var i,n,o,r,a=e.getElementsByTagName("p"),s=a.length;for(i=0;s>i;i++)n=a[i],n.hasAttribute("n")&&this.deserializePropertyXml(t,n,n.getAttribute("n"));if(t.settings.isClientSerializable)for(o=e.getElementsByTagName("c"),s=o.length,i=0;s>i;i++)r=o[i],r.hasAttribute("n")&&this.deserializeClientXml(t,r,r.getAttribute("n"))},deserializePropertyXml:function(t,e,i){t.deserializePropertyXml(this,e,i)},deserializeClientXml:function(t,e,i){t.deserializeClientXml(this,e,i)}}),Me.addMethod(De.ElementBox,{serializeXml:function(t,e){if(t.settings.isLayerBoxSerializable&&(t.xmlString+="\t<layerBox>\n",this._layerBox.forEachByDepthFirst(function(e){t.xmlString+=this._layerBox.getDefaultLayer()===e?"\t\t<layer ":"\t\t<layer id='"+e.getId()+"' ",e.getName()&&(t.xmlString+="name='"+e.getName()+"' "),t.xmlString+="visible='"+e.isVisible()+"' editable='"+e.isEditable()+"' movable='"+e.isMovable()+"'/>\n"},null,this),t.xmlString+="\t</layerBox>\n"),t.settings.isStyleSerializable&&this._styleMap)for(var i in this._styleMap)this.serializeStyleXml(t,i,e);De.ElementBox.superClass.serializeXml.call(this,t,e)},serializeStyleXml:function(t,e,i){t.serializeStyleXml(this,e,i)},deserializeStyleXml:function(t,e,i){t.deserializeStyleXml(this,e,i)},deserializeXml:function(t,e){if(De.ElementBox.superClass.deserializeXml.call(this,t,e),t.settings.isLayerBoxSerializable&&1==e.getElementsByTagName("layerBox").length)for(var i=e.getElementsByTagName("layerBox")[0].getElementsByTagName("layer"),n=0;n<i.length;n++){var o,r=i[n];if(r.hasAttribute("id")){var a=t.settings.getPropertyType("layerId");if("string"===a)o=new De.Layer(r.getAttribute("id"));else if("int"===a)o=new De.Layer(parseInt(r.getAttribute("id")));else{if("number"!==a)throw"Unsupported layer id type '"+a+"'";o=new De.Layer(parseFloat(r.getAttribute("id")))}this._layerBox.getDataById(o.getId())?o=this._layerBox.getDataById(o.getId()):this._layerBox.add(o)}else o=this._layerBox.getDefaultLayer(),this._layerBox.moveToBottom(o);r.hasAttribute("name")&&o.setName(r.getAttribute("name")),r.hasAttribute("visible")&&o.setVisible("true"===r.getAttribute("visible")),r.hasAttribute("editable")&&o.setEditable("true"===r.getAttribute("editable")),r.hasAttribute("movable")&&o.setMovable("true"===r.getAttribute("movable"))}if(t.settings.isStyleSerializable)for(var s=e.getElementsByTagName("s"),l=s.length,n=0;l>n;n++){var h=s[n];h.hasAttribute("n")&&this.deserializeStyleXml(t,h,h.getAttribute("n"))}}}),De.JsonSerializer=function(t,e,i){this.dataBox=t,this.settings=e||new De.SerializationSettings,this.filterFunction=i,this.ref=0,this.refMap={},this.idMap={},this.jsonObject={}},Me.ext("twaver.JsonSerializer",Object,{serialize:function(){return this.jsonObject={version:De.Util.getVersion(),platform:"html5"},this.settings.isImageSerializable&&(this.jsonObject.images={}),this.serializeBody(),JSON.stringify(this.jsonObject)},serializeBody:function(){if(this.ref=0,this.dataBox.getRoots().forEach(this.initRefs,this),this.settings.isDataBoxSerializable){var t={class:this.dataBox.getClassName(),p:{},s:{},c:{}};this.jsonObject.dataBox=t,this.dataBox.serializeJson(this,this.dataBox.newInstance(),t),Me.isEmptyObject(t.p)&&delete t.p,Me.isEmptyObject(t.s)&&delete t.s,Me.isEmptyObject(t.c)&&delete t.c}this.jsonObject.datas=[],this.dataBox.getRoots().forEach(this.serializeData,this)},initRefs:function(t){this.refMap[t.getId()]=this.ref++,t.getChildren().forEach(this.initRefs,this)},isSerializable:function(t){return!!this.dataBox.contains(t)&&!(this.filterFunction&&!this.filterFunction(t))},serializeData:function(t){if(this.isSerializable(t)){var e=t.newInstance(),i=this.refMap[t.getId()],n={class:t.getClassName(),ref:i,p:{},s:{},c:{}};if(this.settings.getPropertyType("id")&&(this.jsonObject.id=t.getId()),this.jsonObject.datas.push(n),t.serializeJson(this,e,n),Me.isEmptyObject(n.p)&&delete n.p,Me.isEmptyObject(n.s)&&delete n.s,Me.isEmptyObject(n.c)&&delete n.c,this.settings.isImageSerializable&&t.getImage){var o=t.getImage();if("string"==typeof o&&!Fn[o]&&!this.jsonObject.images[o]){var r=Me.getImageAsset(o),a=r&&r.getImage();a&&!Ki(a)&&(this.jsonObject.images[o]=a)}}}t.getChildren().forEach(this.serializeData,this)},serializePropertyJson:function(t,e,i,n){var o=this.settings.getPropertyType(e);if(o){var r=Me.getValue(t,e,o),a=Me.getValue(i,e,o);r!==a&&this.serializeValue(e,r,a,o,n.p)}},serializeStyleJson:function(t,e,i,n){var o=this.settings.getStyleType(e);if(o){var r=t.getStyle(e),a=i.getStyle(e);r!=a&&this.serializeValue(e,r,a,o,n.s)}},serializeClientJson:function(t,e,i,n){var o=this.settings.getClientType(e);if(null!=o){var r=t.getClient(e),a=i.getClient(e);r!=a&&this.serializeValue(e,r,a,o,n.c)}},serializeValue:function(t,e,i,n,o){if(null==e)o[t]=null;else if(e instanceof hn)o[t]=e._as;else if("data"===n){var r=this.refMap[e.getId()];null!=r&&(o[t]=r)}else o[t]=e},deserialize:function(t,e){Me.isDeserializing=!0,this.jsonObject=JSON.parse(t);var i=this.jsonObject.images;this.settings.isImageSerializable&&i&&Object.keys(i).forEach(function(t){Me.registerImage(t,i[t])}),this.refMap={},this.idMap={};for(var n,o=new hn,r=new hn,a=this.jsonObject.datas.length,s=0;a>s;s++){var l=this.jsonObject.datas[s],h=l.class;if(this.settings.getPropertyType("id")&&null!=l.id){if("remove"===l.action){this.dataBox.removeById(l.id);continue}(n=this.dataBox.getDataById(l.id))||(n=Me.newInstance(h,l.id))}else n=Me.newInstance(h);null!=l.ref&&(this.refMap[l.ref]=n),o.add(n),r.add(l),this.idMap[n.getId()]=n}for(this.dataBox.forEach(function(t){this.idMap[t.getId()]=t},this),a=o.size(),s=0;a>s;s++)n=o.get(s),n.deserializeJson(this,r.get(s));for(s=0;a>s;s++)n=o.get(s),this.dataBox.containsById(n.getId())||(e&&!n.getParent()&&n.setParent(e),this.dataBox.add(n));this.settings.isDataBoxSerializable&&this.jsonObject.dataBox&&this.dataBox.deserializeJson(this,this.jsonObject.dataBox),Me.isDeserializing=!1},deserializePropertyJson:function(t,e,i){var n=this.settings.getPropertyType(i);n&&Me.setValue(t,i,this.deserializeValue(e,n))},deserializeStyleJson:function(t,e,i){var n=this.settings.getStyleType(i);n&&t.setStyle(i,this.deserializeValue(e,n))},deserializeClientJson:function(t,e,i){var n=this.settings.getClientType(i);n&&t.setClient(i,this.deserializeValue(e,n))},deserializeValue:function(t,e){if("data"===e){var i=this.refMap[t];return i||this.idMap[t]}return"array.number"===e?t:t instanceof Array?new hn(t):t}}),Me.addMethod(De.Data,{serializeJson:function(t,e,i){if(t.settings.isClientSerializable&&this._clientMap)for(var n in this._clientMap)this.serializeClientJson(t,n,e,i);this.serializePropertyJson(t,"name",e,i),this.serializePropertyJson(t,"icon",e,i),this.serializePropertyJson(t,"toolTip",e,i),this.serializePropertyJson(t,"parent",e,i)},serializePropertyJson:function(t,e,i,n){t.serializePropertyJson(this,e,i,n)},serializeClientJson:function(t,e,i,n){t.serializeClientJson(this,e,i,n)},deserializeJson:function(t,e){var i;for(i in e.p)this.deserializePropertyJson(t,e.p[i],i);if(t.settings.isClientSerializable)for(i in e.c)this.deserializeClientJson(t,e.c[i],i)},deserializePropertyJson:function(t,e,i){t.deserializePropertyJson(this,e,i)},deserializeClientJson:function(t,e,i){t.deserializeClientJson(this,e,i)}}),Me.addMethod(De.Element,{serializeJson:function(t,e,i){if(t.settings.isStyleSerializable&&this._styleMap)for(var n in this._styleMap)this.serializeStyleJson(t,n,e,i);if(De.Element.superClass.serializeJson.call(this,t,e,i),this.serializePropertyJson(t,"layerId",e,i),this._alarmState.getHighestNativeAlarmSeverity()&&"alarmstate"===t.settings.getPropertyType("alarmState")){var o={n:{},a:{}};i.p.alarmState=o,De.AlarmSeverity.forEach(function(t){var e=this.getNewAlarmCount(t);e>0&&(o.n[t.name]=e)},this._alarmState),De.AlarmSeverity.forEach(function(t){var e=this.getAcknowledgedAlarmCount(t);e>0&&(o.a[t.name]=e)},this._alarmState),Me.isEmptyObject(o.n)&&delete o.n,Me.isEmptyObject(o.a)&&delete o.a,Me.isEmptyObject(o)&&delete i.p.alarmState}},serializeStyleJson:function(t,e,i,n){t.serializeStyleJson(this,e,i,n)},deserializeJson:function(t,e){if(De.Element.superClass.deserializeJson.call(this,t,e),t.settings.isStyleSerializable)for(var i in e.s)this.deserializeStyleJson(t,e.s[i],i)},deserializeStyleJson:function(t,e,i){t.deserializeStyleJson(this,e,i)},deserializePropertyJson:function(t,e,i){if("alarmState"===i){if("alarmstate"===t.settings.getPropertyType("alarmState")){var n;for(n in e.n)this._alarmState.setNewAlarmCount(De.AlarmSeverity.getByName(n),e.n[n]);for(n in e.a)this._alarmState.setAcknowledgedAlarmCount(De.AlarmSeverity.getByName(n),e.a[n])}}else De.Element.superClass.deserializePropertyJson.call(this,t,e,i)}}),Me.addMethod(On,{serializeJson:function(t,e,i){On.superClass.serializeJson.call(this,t,e,i),this.serializePropertyJson(t,"image",e,i),this.serializePropertyJson(t,"location",e,i),Me.num(this._width)&&this._width>=0&&this.serializePropertyJson(t,"width",e,i),Me.num(this._height)&&this._height>=0&&this.serializePropertyJson(t,"height",e,i)}}),Me.addMethod(De.Link,{serializeJson:function(t,e,i){De.Link.superClass.serializeJson.call(this,t,e,i),this.serializePropertyJson(t,"fromNode",e,i),this.serializePropertyJson(t,"toNode",e,i)}}),Me.addMethod(De.Follower,{serializeJson:function(t,e,i){De.Follower.superClass.serializeJson.call(this,t,e,i),this.serializePropertyJson(t,"host",e,i)}}),Me.addMethod(Mn,{serializeJson:function(t,e,i){Mn.superClass.serializeJson.call(this,t,e,i),this.serializePropertyJson(t,"expanded",e,i)}}),Me.addMethod(De.ShapeNode,{serializeJson:function(t,e,i){De.ShapeNode.superClass.serializeJson.call(this,t,e,i),this.serializePropertyJson(t,"points",e,i),this.serializePropertyJson(t,"segments",e,i)}}),Me.addMethod(De.ShapeLink,{serializeJson:function(t,e,i){De.ShapeLink.superClass.serializeJson.call(this,t,e,i),this.serializePropertyJson(t,"points",e,i)}}),Me.addMethod(De.RotatableNode,{serializeJson:function(t,e,i){De.RotatableNode.superClass.serializeJson.call(this,t,e,i),this.serializePropertyJson(t,"angle",e,i)}}),Me.addMethod(De.DataBox,{serializeJson:function(t,e,i){if(t.settings.isClientSerializable&&this._clientMap)for(var n in this._clientMap)this.serializeClientJson(t,n,e,i);this.serializePropertyJson(t,"name",e,i),this.serializePropertyJson(t,"icon",e,i),this.serializePropertyJson(t,"toolTip",e,i)},serializePropertyJson:function(t,e,i,n){t.serializePropertyJson(this,e,i,n)},serializeClientJson:function(t,e,i,n){t.serializeClientJson(this,e,i,n)},deserializeJson:function(t,e){var i;for(i in e.p)this.deserializePropertyJson(t,e.p[i],i);if(t.settings.isClientSerializable)for(i in e.c)this.deserializeClientJson(t,e.c[i],i)},deserializePropertyJson:function(t,e,i){t.deserializePropertyJson(this,e,i)},deserializeClientJson:function(t,e,i){t.deserializeClientJson(this,e,i)}}),Me.addMethod(De.ElementBox,{serializeJson:function(t,e,i){if(t.settings.isLayerBoxSerializable&&(i.layers=[],this._layerBox.forEachByDepthFirst(function(t){var e={};i.layers.push(e),this._layerBox.getDefaultLayer()!==t&&(e.id=t.getId()),t.getName()&&(e.name=t.getName()),e.visible=t.isVisible(),e.editable=t.isEditable(),e.movable=t.isMovable()},null,this)),t.settings.isStyleSerializable&&this._styleMap)for(var n in this._styleMap)this.serializeStyleJson(t,n,e,i);De.ElementBox.superClass.serializeJson.call(this,t,e,i)},serializeStyleJson:function(t,e,i,n){t.serializeStyleJson(this,e,i,n)},deserializeStyleJson:function(t,e,i){t.deserializeStyleJson(this,e,i)},deserializeJson:function(t,e){if(De.ElementBox.superClass.deserializeJson.call(this,t,e),t.settings.isLayerBoxSerializable&&e.layers&&e.layers)for(var i=e.layers.length,n=0;i>n;n++){var o,r=e.layers[n];null!=r.id?(o=new De.Layer(r.id),this._layerBox.getDataById(o.getId())?o=this._layerBox.getDataById(o.getId()):this._layerBox.add(o)):(o=this._layerBox.getDefaultLayer(),this._layerBox.moveToBottom(o)),r.name&&o.setName(r.name),null!=r.visible&&o.setVisible(r.visible),null!=r.editable&&o.setEditable(r.editable),null!=r.movable&&o.setMovable(r.movable)}if(t.settings.isStyleSerializable)for(var a in e.s)this.deserializeStyleJson(t,e.s[a],a)}}),De.layout.SpringLayouter=function(t){this._network=t,this._damper=1,this._maxMotion=0,this._motionRatio=0,this._isAdjusting=!1,this._timer=null,this._snodeMap={},this._snodes=new hn,this._slinks=new hn,this._network.getElementBox().addDataBoxChangeListener(this._handleDataBoxChange,this),this._network.getElementBox().addDataPropertyChangeListener(this._handleDataPropertyChange,this),this._network.addPropertyChangeListener(this._handleNetworkPropertyChange,this)},Me.ext("twaver.layout.SpringLayouter",Object,{_nodeRepulsionFactor:.6,_linkRepulsionFactor:.6,_limitBounds:null,_interval:50,_stepCount:10,_motionLimit:.01,start:function(){if(!this._timer){var e=this,i=function(){e.relax.call(e)};this._timer=t.setInterval(i,this._interval),this._damper=1}},stop:function(){this._timer&&(t.clearInterval(this._timer),this._timer=null)},relax:function(){if(!(this._damper<.1&&this._maxMotion<this._motionLimit)){this._rebuild();for(var t=this._snodes.size(),e=0;e<this._stepCount;e++){this._slinks.forEach(this._relaxLink,this);for(var i=0;t>i;i++)for(var n=0;t>n;n++){var o=this._snodes.get(i),r=this._snodes.get(n);o!=r&&this._relaxNodePair(o,r)}this._moveNodes()}this._isAdjusting=!0;for(var e=0;t>e;e++){var a=this._snodes.get(e);a.fix||a.element.setLocation(a.x,a.y)}this._isAdjusting=!1}},isRunning:function(){return!!this._timer},getNetwork:function(){return this._network},isVisible:function(t){return this._network.isVisible(t)},isMovable:function(t){return!!this._network.isMovable(t)&&(!this._network.getSelectionModel().contains(t)&&!(t instanceof Mn))},getNodeRepulsionFactor:function(){return this._nodeRepulsionFactor},setNodeRepulsionFactor:function(t){.02>t&&(t=.02),this._nodeRepulsionFactor=t,this._damper=1},getLinkRepulsionFactor:function(){return this._linkRepulsionFactor},setLinkRepulsionFactor:function(t){.02>t&&(t=.02),this._linkRepulsionFactor=t,this._damper=1},getStepCount:function(){return this._stepCount},setStepCount:function(t){this._stepCount=t,this._damper=1},getInterval:function(){return this._interval},setInterval:function(e){if(this._interval!==e&&(this._interval=e,this._timer)){t.clearInterval(this._timer);var i=this,n=function(){i.relax.call(i)};this._timer=t.setInterval(n,this._interval)}},getLimitBounds:function(){return this._limitBounds},setLimitBounds:function(t){this._limitBounds=t,this._damper=1},_handleDataPropertyChange:function(t){this._isAdjusting||(this._damper=1)},_handleDataBoxChange:function(t){this._damper=0===this._network.getElementBox().size()?0:1},_handleNetworkPropertyChange:function(t){if("elementBox"===t.property){var e=t.oldValue;null!=e&&(e.removeDataBoxChangeListener(this._handleDataBoxChange,this),e.removeDataPropertyChangeListener(this._handleDataPropertyChange,this)),this._network.getElementBox().addDataBoxChangeListener(this._handleDataBoxChange,this),this._network.getElementBox().addDataPropertyChangeListener(this._handleDataPropertyChange,this)}},_relaxLink:function(t){var e=t.toNode.x-t.fromNode.x,i=t.toNode.y-t.fromNode.y,n=Math.sqrt(e*e+i*i),o=.25*e,r=.25*i;o/=100*t.length;var a=t.length,s=100*a,l=r;r/=s,l/=100*t.length,t.toNode.dx=t.toNode.dx-o*n,t.toNode.dy=t.toNode.dy-r*n,t.fromNode.dx=t.fromNode.dx+o*n,t.fromNode.dy=t.fromNode.dy+r*n},_relaxNodePair:function(t,e){var i=0,n=0,o=t.x-e.x,r=t.y-e.y,a=o*o+r*r;0===a?(i=De.Util.random(),n=De.Util.random()):36e4>a&&(i=o/a,n=r/a);var s=t.repulsion*e.repulsion/100,l=.25*s;t.dx+=i*l,t.dy+=n*l,e.dx-=i*l,e.dy-=n*l},_moveNodes:function(){for(var t=this._maxMotion,e=0,i=0,n=this._snodes.size();n>i;i++){var o=this._snodes.get(i),r=o.dx,a=o.dy;r*=this._damper,a*=this._damper,o.dx=r/2,o.dy=a/2;var s=Math.sqrt(r*r+a*a);if(!o.fix)if(o.x=o.x+Math.max(-30,Math.min(30,r)),o.y=o.y+Math.max(-30,Math.min(30,a)),this._limitBounds){o.x<this._limitBounds.x&&(o.x=this._limitBounds.x,this._adjustLocation(1,0)),o.y<this._limitBounds.y&&(o.y=this._limitBounds.y,this._adjustLocation(0,1));var l,h=this._network.getElementUI(o.element);(l=h?h._viewRect:o.element.getRect())&&(o.x+l.width>this._limitBounds.x+this._limitBounds.width&&(o.x=this._limitBounds.x+this._limitBounds.width-l.width,this._adjustLocation(-1,0)),o.y+l.height>this._limitBounds.y+this._limitBounds.height&&(o.y=this._limitBounds.y+this._limitBounds.height-l.height,this._adjustLocation(0,-1)))}else o.x<1&&this._adjustLocation(1,0),o.y<1&&this._adjustLocation(0,1);e=Math.max(s,e)}this._maxMotion=e,this._motionRatio=this._maxMotion>0?t/this._maxMotion-1:0,this._damp()},_damp:function(){this._motionRatio<=.001&&((this._maxMotion<.2||this._maxMotion>1&&this._damper<.9)&&this._damper>.01?this._damper-=.01:this._maxMotion<.4&&this._damper>.003?this._damper-=.003:this._damper>1e-4&&(this._damper-=1e-4)),this._maxMotion<this._motionLimit&&(this._damper=0)},_rebuild:function(){this._snodeMap={},this._snodes.clear(),this._slinks.clear(),this._network.getElementBox().forEach(function(t){this.isVisible(t)&&(t instanceof De.Link?this._addLink(t):t instanceof On&&this._addNode(t))},this)},_addNode:function(t){var e=this._snodeMap[t.getId()];return e||(e={},e.element=t,e.repulsion=this._getRepulsion(t),e.x=t.getX(),e.y=t.getY(),e.dx=0,e.dy=0,e.fix=!this.isMovable(t),this._snodeMap[t.getId()]=e,this._snodes.add(e),e)},_addLink:function(t){var e={};e.fromNode=this._addNode(t.getFromNode()),e.toNode=this._addNode(t.getToNode()),e.element=t;var i,n,o=this._network.getElementUI(t.getToNode()),r=this._network.getElementUI(t.getFromNode());o&&o._viewRect&&r&&r._viewRect?(i=o._viewRect.width+r._viewRect.width,n=o._viewRect.height+r._viewRect.height):(i=t.getToNode().getWidth()+t.getFromNode().getWidth(),n=t.getToNode().getHeight()+t.getFromNode().getHeight()),e.length=Math.floor(Math.sqrt(i*i+n*n)*this._linkRepulsionFactor),e.length<=0&&(e.length=100),this._slinks.add(e)},_getRepulsion:function(t){var e,i=this._network.getElementUI(t);if(i&&i._viewRect){var n=i._viewRect;e=Math.floor(Math.sqrt(n.width*n.width+n.height*n.height)*this._nodeRepulsionFactor)}else e=100;return 0>=e&&(e=100),e},_adjustLocation:function(t,e){for(var i=0,n=this._snodes.size();n>i;i++){var o,r=this._snodes.get(i),a=this._network.getElementUI(r.element);if(!(o=a?a._viewRect:r.element.getRect()))return;t>0?(!this._limitBounds||r.x+o.width+t<this._limitBounds.x+this._limitBounds.width)&&(r.x+=t):(!this._limitBounds||r.x+t>this._limitBounds.x)&&(r.x+=t),e>0?(!this._limitBounds||r.y+o.height+e<this._limitBounds.y+this._limitBounds.height)&&(r.y+=e):(!this._limitBounds||r.y+e>this._limitBounds.y)&&(r.y+=e)}}}),De.layout.CloudLayouter=function(t){De.layout.CloudLayouter.superClass.constructor.apply(this,arguments),this._network=t,this._centerX=0,this._centerY=0,this._radius=1,this._rect=null,this._localPoint=null,this._lastWidth=-1e3,this._lastHeight=-1e3,this._nodes=new hn,this._sa=0,this._ca=0,this._sb=0,this._cb=0,this._sc=0,this._cc=0,this._lasta=0,this._lastb=0,this._active=!1,this._horizontalElliptical=1,this._verticalElliptical=1,this._timer=null,this._centering=!1,this._centeringNode=null,this._freeze=!1,this._network.setInteractions("twaver.network.Network"===this._network.getClassName()?[new De.network.interaction.SelectInteraction(this._network)]:[new De.canvas.interaction.SelectInteraction(this._network)])},Me.ext("twaver.layout.CloudLayouter",De.PropertyChangeDispatcher,{__accessor:["updateNodeFunction","mouseMoveFunction","mouseOverFunction","percentPadding","ceaseRate","ceaseLimit"],__bool:["elliptical","active","updateLayoutRectOnResized","reloadOnDataBoxChanged"],_moveSpeed:2,_ceaseRate:.9,_ceaseLimit:.01,_percentPadding:.2,_elliptical:!0,_interval:50,_reloadOnDataBoxChanged:!0,_updateLayoutRectOnResized:!0,getNetwork:function(){return this._network},isLayoutable:function(t){return this._network.isVisible(t)&&this._network.isMovable(t)},start:function(e){if(0===arguments.length&&(e=!0),!this._timer){this._installListeners(),e&&this.updateLayoutRect(!0);var i=this,n=function(){i._update.call(i)};this._timer=t.setInterval(n,this._interval),this._update()}},stop:function(){this._timer&&(t.clearInterval(this._timer),this._timer=null)},isRunning:function(){return!!this._timer},getInterval:function(){return this._interval},setInterval:function(e){if(this._interval!==e){var i=this._interval;if(this._interval=e,this._timer){t.clearInterval(this._timer);var n=this,o=function(){n._update.call(n)};this._timer=t.setInterval(o,this._interval)}this.firePropertyChange("interval",i,e)}},getMoveSpeed:function(){return this._moveSpeed},setMoveSpeed:function(t){var e=this._moveSpeed;this._moveSpeed=t,this.firePropertyChange("moveSpeed",e,t)},getLayoutRect:function(){var t=this._network.getView().offsetWidth/this._network.getZoom(),e=this._network.getView().offsetHeight/this._network.getZoom(),i=t*this._percentPadding,n=e*this._percentPadding;return{x:i,y:n,width:t-2*i,height:e-2*n}},getCount:function(){return this._nodes.size()},updateLayoutRect:function(t){var e=this._radius;if(this._rect=this.getLayoutRect(),this._rect.width<=2&&(this._rect.width=2),this._rect.height<=2&&(this._rect.height=2),this._radius=Math.min(this._rect.width/2,this._rect.height/2),this.isElliptical()?(this._horizontalElliptical=this._rect.width/2/this._radius,this._verticalElliptical=this._rect.height/2/this._radius):(this._horizontalElliptical=1,this._verticalElliptical=1),this._centerX=this._rect.x+this._rect.width/2,this._centerY=this._rect.y+this._rect.height/2,t)this.reload();else{this._lasta=1,this._lastb=1;for(var i=this._nodes.size(),n=0;i>n;n++){var o=this._nodes.get(n);o.cx*=this._radius/e,o.cy*=this._radius/e,o.cz*=this._radius/e}this._freeze?this._updateNodes(0,0,0):this._update()}this._lastWidth=this._network.getView().offsetWidth,this._lastHeight=this._network.getView().offsetHeight},reload:function(){this._freeze=!1,this._centeringNode=null,this._localPoint=null,this._centering=!1,this._nodes=new hn,this._box.forEach(function(t){if(t&&this.isLayoutable(t)){var e={};e.node=t,this._nodes.add(e)}},this),this._sineCosine(0,0,0),this._active=!1,this._lasta=1,this._lastb=1;for(var t=0,e=0,i=this._nodes.size(),n=0;i>n;n++){t=Math.acos((2*(n+1)-1)/i-1),e=Math.sqrt(i*Math.PI)*t;var o=this._nodes.get(n);o.cx=this._radius*Math.cos(e)*Math.sin(t),o.cy=this._radius*Math.sin(e)*Math.sin(t),o.cz=this._radius*Math.cos(t)}},_sineCosine:function(t,e,i){var n=Math.PI/180;this._sa=Math.sin(t*n),this._ca=Math.cos(t*n),this._sb=Math.sin(e*n),this._cb=Math.cos(e*n),this._sc=Math.sin(i*n),this._cc=Math.cos(i*n)},handleSelectionChange:function(t){this.centerNode(this._network.getSelectionModel().getLastData())},handleDataBoxChange:function(t){(this._reloadOnDataBoxChanged||"clear"===t.kind)&&this.reload()},handleMouseMove:function(t){this._centering||this._updateLogicalPoint(t),this._active=!this._mouseMoveFunction||this._mouseMoveFunction(t)},handleMouseOver:function(t){this._centering||this._updateLogicalPoint(t),this._active=!this._mouseOverFunction||this._mouseOverFunction(t)},_updateLogicalPoint:function(t){this._localPoint=this._network.getLogicalPoint(t)},handleRollOut:function(t){this._active=!1},handleResize:function(t){if("validateEnd"===t.kind){if(!this._updateLayoutRectOnResized)return;if(Math.abs(this._network.getView().offsetWidth-this._lastWidth)<=2&&Math.abs(this._network.getView().offsetHeight-this._lastHeight)<=2)return;this.updateLayoutRect()}},handleNetworkPropertyChange:function(t){"elementBox"===t.property&&(this._box.removeDataBoxChangeListener(this.handleDataBoxChange,this),this._box=this._network.getElementBox(),this._box.addDataBoxChangeListener(this.handleDataBoxChange,this),this.reload()),"zoom"===t.property&&(this._localPoint=null,this.updateLayoutRect())},_adjustIndex:function(){this._nodes.sort(this._sortFunction);for(var t=this._nodes.size(),e=0;t>e;e++){var i=this._nodes.get(e).node,n=this._box.getDatas().indexOf(i);this._box.getDatas().removeAt(n),this._box.getDatas().add(i,e),this._box.fireIndexChange(i,n,e),this.updateNode(i,e,t,this._nodes.get(e).alpha)}},_sortFunction:function(t,e){return e.cz>t.cz?1:e.cz<t.cz?-1:0},updateNode:function(t,e,i,n){this._updateNodeFunction&&this._updateNodeFunction(t,e,i,n)},_update:function(){if(!this._freeze){var t,e;if(this._centering&&this._centeringNode){if(this.isAtCenter(this._centeringNode.node,this._centeringNode.perspective,this._centeringNode.cx,this._centeringNode.cy,this._centeringNode.cz))return this._freeze=!0,this._centering=!1,void(this._centeringNode=null)}if(!this._freeze&&(this._active||this._centering)&&this._localPoint?this.isElliptical()?(t=(this._centerY-this._localPoint.y)/(this._rect.height/2)*this._moveSpeed,e=(this._localPoint.x-this._centerX)/(this._rect.width/2)*this._moveSpeed):(t=(this._centerY-this._localPoint.y)/this._radius*this._moveSpeed,e=(this._localPoint.x-this._centerX)/this._radius*this._moveSpeed):(t=this._lasta*this._ceaseRate,e=this._lastb*this._ceaseRate),this._lasta=t,this._lastb=e,Math.abs(t)>this._ceaseLimit||Math.abs(e)>this._ceaseLimit){this._sineCosine(t,e,0);for(var i=0,n=this._nodes.size();n>i;i++){var o=this._nodes.get(i),r=o.cx,a=o.cy*this._ca+o.cz*-this._sa,s=o.cy*this._sa+o.cz*this._ca,l=r*this._cb+s*this._sb,h=a,c=r*-this._sb+s*this._cb,u=l*this._cc+h*-this._sc,d=l*this._sc+h*this._cc,f=c;o.cx=u,o.cy=d,o.cz=f;var p=2*this._radius;p/=p+f,o.perspective=p,o.alpha=(this._radius-f)/(2*this._radius);var g=this._horizontalElliptical*u*p-2*this._horizontalElliptical+this._centerX,_=d*p*this._verticalElliptical+this._centerY;o.node.setCenterLocation(g,_)}this._adjustIndex()}}},centerNode:function(t){if(t&&this.isLayoutable(t)){if(this._centeringNode&&t===this._centeringNode.node&&this._freeze)return;for(var e=0,i=this._nodes.size();i>e;e++){var n=this._nodes.get(e);if(n&&t===n.node){this._centering=!0,this._freeze=!1,this._active=!0,this._centeringNode=n,this._localPoint=this.createControlPoint(this._centeringNode.node);break}}}else this._centering=!1,this._freeze=!1,this._active=!1,this._localPoint=null},createControlPoint:function(t){var e=t.getCenterLocation(),i=this.getLayoutRect(),n=i.x+i.width/2,o=i.y+i.height/2,r=Math.atan2(e.y-o,e.x-n),a=i.width+i.height;return{x:n+a*Math.cos(r),y:o+a*Math.sin(r)}},isAtCenter:function(t,e,i,n,o){if(this._moveSpeed<=0)return!0;var r=16/this._moveSpeed;return r>20?r=20:2>r&&(r=2),-o/Math.sqrt(i*i+n*n)>r},_updateNodes:function(t,e,i){this._sineCosine(t,e,i);for(var n=0,o=this._nodes.size();o>n;n++){var r=this._nodes.get(n),a=r.cx,s=r.cy*this._ca+r.cz*-this._sa,l=r.cy*this._sa+r.cz*this._ca,h=a*this._cb+l*this._sb,c=s,u=a*-this._sb+l*this._cb,d=h*this._cc+c*-this._sc,f=h*this._sc+c*this._cc,p=u;r.cx=d,r.cy=f,r.cz=p;var g=2*this._radius;g/=g+p,r.perspective=g;var _=this._horizontalElliptical*d*g-2*this._horizontalElliptical+this._centerX,m=f*g*this._verticalElliptical+this._centerY;r.node.setCenterLocation(_,m)}this._adjustIndex()},_installListeners:function(){this._box=this._network.getElementBox(),this._box.addDataBoxChangeListener(this.handleDataBoxChange,this),this._network.getSelectionModel().addSelectionChangeListener(this.handleSelectionChange,this),this._network.addViewListener(this.handleResize,this),Xe.addEventListener("mouseout","handleRollOut",this._network.getView(),this),Xe.addEventListener("mousemove","handleMouseMove",this._network.getView(),this),Xe.addEventListener("mouseover","handleMouseOver",this._network.getView(),this),this._network.addPropertyChangeListener(this.handleNetworkPropertyChange,this)},_uninstallListeners:function(){this._box.removeDataBoxChangeListener(this.handleDataBoxChange,this),this._network.getSelectionModel().removeSelectionChangeListener(this.handleSelectionChange,this),this._network.removeViewListener(this.handleResize,this),Xe.removeEventListener("mouseout",this._network.getView(),this),Xe.removeEventListener("mousemove",this._network.getView(),this),Xe.removeEventListener("mouseover",this._network.getView(),this),this._network.removePropertyChangeListener(this.handleNetworkPropertyChange,this)}}),De.layout.AutoLayouter=function(t){this._box=t},Me.ext("twaver.layout.AutoLayouter",Object,{_expandGroup:!1,_repulsion:1,_type:null,_animate:!0,_explicitXOffset:Number.NaN,_explicitYOffset:Number.NaN,_xOffset:0,_yOffset:0,isExpandGroup:function(){return this._expandGroup},setExpandGroup:function(t){this._expandGroup=t},getRepulsion:function(){return this._repulsion},setRepulsion:function(t){this._repulsion=t},getType:function(){return this._type},isAnimate:function(){return this._animate},setAnimate:function(t){this._animate=t},getElementBox:function(){return this._box},getExplicitXOffset:function(){return this._explicitXOffset},setExplicitXOffset:function(t){this._explicitXOffset=t},getExplicitYOffset:function(){return this._explicitYOffset},setExplicitYOffset:function(t){this._explicitYOffset=t},getDimension:function(t){if(t instanceof Mn&&t.getChildrenSize()>0){for(var e=null,i=0,n=t.getChildrenSize();n>i;i++){var o=t.getChildAt(i);o instanceof On&&(e=e?We.unionRect(e,o.getRect()):o.getRect())}return e?{width:e.width,height:e.height}:null}return{width:t.getWidth(),height:t.getHeight()}},isVisible:function(t){return!0},isMovable:function(t){return!0},getGroupLayoutType:function(t){return this._type},getElements:function(){var t,e=this._box,i=e.getSelectionModel().size()>1;i?t=e.getSelectionModel().getSelection():(t=new hn,e.forEachByBreadthFirst(t.add,null,t)),this._xOffset=-1,this._yOffset=-1;for(var n=new hn,o=0,r=t.size();r>o;o++){var a=t.get(o);this.isVisible(a)&&(a instanceof De.Link?n.add(a):this.isMovable(a)&&a instanceof On&&(n.add(a),i&&((this._xOffset<0||a.getX()<this._xOffset)&&(this._xOffset=a.getX()),(this._yOffset<0||a.getY()<this._yOffset)&&(this._yOffset=a.getY()))))}return i||(this._xOffset=isNaN(this._explicitXOffset)?50/this._repulsion:this._explicitXOffset,this._yOffset=isNaN(this._explicitYOffset)?50/this._repulsion:this._explicitYOffset),n},getLayoutResult:function(t){var e={};return this.doLayoutImpl(t,null,e),e},doLayout:function(t,e){return this.doLayoutImpl(t,e)},doLayoutImpl:function(t,e,i){var n=this,o=e;e=function(){n._box._layoutMovingElements=!1,o&&o()},this._type=t;var r=null;if("round"===t?r=new tr:"symmetry"===t?r=new pr:"hierarchic"===t?r=new Cr:("topbottom"===t||"bottomtop"===t||"rightleft"===t||"leftright"===t)&&(r=new Vo),null==r)return!1;n._box._layoutMovingElements=!0;var a={},s=this.getElements(),l=new gr(this,s,!0,null);s=l.process();var h=new hr(this,s,t,!0,null);try{r.i2(h)}catch(t){return l.resetGroup(),null!=e&&e(),!1}var c,u;for(c in h._a){u=h._a[c];var d=h.g4(u);a[c]={x:d.x+this._xOffset,y:d.y+this._yOffset}}var f;if("rightleft"===t||"leftright"===t||"bottomtop"===t){var p=gr.createMatrix(t),g=Number.MAX_VALUE,_=Number.MAX_VALUE;for(c in a){u=h._a[c],f=a[c];var m=p.transform(f);f.x=m.x,f.y=m.y;var v;"rightleft"===t||"leftright"===t?(v=m.x-h.g9(u)/2/this._repulsion,g>v&&(g=v),v=m.y-h.gj(u)/2/this._repulsion,_>v&&(_=v)):(v=m.x-h.gj(u)/2/this._repulsion,g>v&&(g=v),v=m.y-h.g9(u)/2/this._repulsion,_>v&&(_=v))}for(c in a)u=h._a[c],f=a[c],f.x=f.x-g+this._xOffset,f.y=f.y-_+this._yOffset}if(null==i&&this._animate){var y=new hn,w=new hn;for(c in a)y.add(h._a[c].node),w.add(a[c]);De.animate.AnimateManager.endAnimate(),n._box._dataBoxChangeDispatcher.fire({kind:"layouting"}),De.animate.AnimateManager.start(new De.animate.AnimateCenterLocation(y,w,function(){l.resetGroup(),n._box._dataBoxChangeDispatcher.fire({kind:"layoutEnd"}),null!=e&&Me.callLater(e)}))}else{n._box._dataBoxChangeDispatcher.fire({kind:"layouting"});for(c in a)u=h._a[c],f=a[c],null==i?u.node.setCenterLocation(f.x,f.y):i[u.node.getId()]=f;l.resetGroup(),n._box._dataBoxChangeDispatcher.fire({kind:"layoutEnd"}),null!=e&&Me.callLater(e)}return!0}});var Vn=function(t,e){this.x=t,this.y=e};Me.ext(Vn,Object,{equals:function(t){return this===t||t instanceof Vn&&(t.x==this.x&&t.y==this.y)}});var Un=function(t,e){this.width=t,this.height=e};Me.ext(Un,Object,{});var jn=function(t,e){this.x=t,this.y=e};Me.ext(jn,Object,{});var Hn=function(){2===arguments.length?(Hn.superClass.constructor.call(this,arguments[1].width,arguments[1].height),this.x=arguments[0].x,this.y=arguments[0].y):(Hn.superClass.constructor.call(this,arguments[2],arguments[3]),this.x=arguments[0],this.y=arguments[1])};Me.ext(Hn,Un,{});var Wn=function(t,e){if(Wn.a2(t.x,e.x))this._a=1,this._b=0,this._c=-t.x;else{this._b=-1;var i=(e.y-t.y)/(e.x-t.x),n=t.y-t.x*i;this._a=i,this._c=n}};Me.ext(Wn,Object,{a3:function(){return this._a},a4:function(){return this._b},a5:function(){return this._c}}),Wn.a6=function(t,e){if(Wn.a1(t.a3())&&Wn.a1(e.a3()))return null;if(Wn.a1(t.a4())&&Wn.a1(e.a4()))return null;if(Wn.a1(e.a4())){var i=t;t=e,e=i}var n,o,r=t.a3(),a=t.a4(),s=-t.a5();Wn.a1(t.a3())?(n=e.a4(),o=-e.a5()):(n=e.a4()-e.a3()/t.a3()*t.a4(),o=-e.a5()-e.a3()/t.a3()*-t.a5());var l=o/n;return new Vn((s-l*a)/r,l)},Wn.a1=function(t){return Wn.a2(t,0)},Wn.a2=function(t,e){return Math.abs(t-e)<1e-5};var Gn=function(t){if(this._a=new fo,t)for(var e=0;e<t.size();e++)this._a.aa(t.get(e))};Me.ext(Gn,Object,{c:function(){return this._a.ah()},d:function(){return this._a.ah()},a:function(){for(var t=new hn,e=this.c();e.i1();e.i2())t.add(e.i6(),0);return new Gn(t)},b:function(){return this._a.ay()}});var Zn=function(t,e){this.x=t,this.y=e};Me.ext(Zn,Object,{a:function(t,e){this.x=t,this.y=e}});var Xn=function(t,e){this.x=t||0,this.y=e||0};Me.ext(Xn,Object,{b:function(){return new Xn(this.x,this.y)},a:function(t){this.z=t},c:function(){return this.x},d:function(){return this.y},f:function(t,e){this.x=t,this.y=e}});var Yn=function(t){this._c=new fo,t?(this.ac(t.a8().b()),this.ad(t.a9().b())):(this.ac(new Xn),this.ad(new Xn))};Me.ext(Yn,Object,{a6:function(){return this.a5(this)},ac:function(t){t.a(this),this._a=t},ad:function(t){t.a(this),this._b=t},a8:function(){return this._a},a9:function(){return this._b},a1:function(t,e){return this.a4(t,e,this.aa())},a2:function(){return this._c.ay()},a7:function(t){return this._c.ak(t)},aa:function(){return 0===this._c.ay()?null:this._c.as()},a3:function(){this._c.af()},i2:function(t){var e=this.a7(t);return null!=e?new Vn(e.x,e.y):null},i1:function(){return this.a2()},i6:function(){var t=this.a8();return new Vn(t.c(),t.d())},i7:function(){var t=this.a9();return new Vn(t.c(),t.d())},i8:function(t){this.a8().f(t.x,t.y)},i9:function(t){this.a9().f(t.x,t.y)},i3:function(t,e,i){var n=this.a7(t);null!=n&&n.a(e,i)},i4:function(t,e){this.a1(t,e)},i5:function(){this.a3()}});var $n=function(t){$n.superClass.constructor.call(this,t)};Me.ext($n,Yn,{a5:function(t){return new $n(t)},a4:function(t,e,i){var n=new Zn(t,e);return this.ab(n,i),n},ab:function(t,e){this._c.an(t,this._c.al(e))}});var qn=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];this._s=!1,this._w=30,this._h=30,this._x=t-this._w/2,this._y=e-this._h/2}else{var i=arguments[0];this._s=i._s,this._w=i._w,this._h=i._h,this._x=i._x,this._y=i._y}};Me.ext(qn,Object,{m3:function(){return this.m2(this)},m4:function(){return this._x+this._w/2},m5:function(){return this._y+this._h/2},m6:function(t,e){this._x=t-this._w/2,this._y=e-this._h/2},i1:function(){return this._x},i2:function(){return this._y},i5:function(t,e){this._x=t,this._y=e},i3:function(){return this._w},i4:function(){return this._h},i6:function(t,e){var i=(this._w-t)/2,n=(this._h-e)/2;this._x+=i,this._y+=n,this._w=t,this._h=e},m1:function(t){var e,i,n,o;t.width<=0?(e=this._x,i=this._x+this._w,n=this._y,o=this._y+this._h):(e=Math.min(this._x,t.x),i=Math.max(this._x+this._w,t.x+t.width),n=Math.min(this._y,t.y),o=Math.max(this._y+this._h,t.y+t.height)),t.x=e,t.y=n,t.width=i-e,t.height=o-n}});var Kn=function(t){t?Kn.superClass.constructor.call(this,t):Kn.superClass.constructor.call(this,0,0)};Me.ext(Kn,qn,{m2:function(t){return new Kn(t)}});var Jn={};Jn.a2=function(t){var e=No.a2(Ir.a(t.xa()));return Jn.a4(t,e,Jn.a3(t,e))},Jn.a3=function(t,e){for(var i=t.x9();i.i1();i.i2())e.i7(i.i9(),-1);for(var n=0,o=new yo(t.xa()),r=t.x9();r.i1();r.i2()){var a=r.i9();-1===e.i2(a)&&Jn.a(a,o,e,n++)}return n},Jn.a6=function(t){for(var e=new po,i=Jn.a2(t),n=0;n<i.length-1;n++){var o=t.xo(i[n].x2(),i[n+1].x3());e.aa(o)}return e},Jn.a4=function(t,e,i){for(var n=[],o=0;i>o;o++)n[o]=new Po;for(var r=t.x9();r.i1();r.i2())n[e.i2(r.i9())].ae(r.i9());return n},Jn.a=function(t,e,i,n){for(e.c(t),i.i7(t,n);!e.a();){t=e.b();for(var o=t.ag();null!=o;o=o.a8()){var r=o.a3();-1===i.i2(r)&&(i.i7(r,n),e.c(r))}for(var a=t.ae();null!=a;a=a.a7()){var s=a.a2();-1===i.i2(s)&&(i.i7(s,n),e.c(s))}}},Jn.a1=function(t,e,i){var n=new so(e,i);return n.a8(t),n._i},Jn.a5=function(t,e,i){for(var n=[],o=0;i>o;o++)n[o]=new po;for(var r=t.xf();r.i1();r.i2())n[e.i2(r.i8())].aa(r.i8());return n},Jn.a7=function(t){var e=new po,i=No.a3(Ir.b(t.xa())),n=No.a4(Ir.a(t.xh())),o=Jn.a1(t,n,i),r=Jn.a5(t,n,o);if(r.length>1){for(var a=new Po,s=0;s<r.length;s++){var l=r[s],h=null;if(1===l.ay()){var c=l.c2();1===c.a2().ad()?h=c.a2():1===c.a3().ad()&&(h=c.a3())}else{for(var u=l.c1();u.i1();u.i2()){var d=u.i8();if(i.i4(d.a2()))if(null==h)h=d.a2();else if(h!==d.a2()){h=null;break}if(i.i4(d.a3()))if(null!=h){if(h!==d.a3()){h=null;break}}else h=d.a3()}if(null!=h){var f=l.c2();h=f.a2()!==h?f.a2():f.a3()}}null!=h&&a.aa(h)}for(var p,g=a.x4();!a.ar();g=p)p=a.x4(),e.ac(t.xo(g,p))}return e};var Qn=function(){this._c=0,this._d=0,this._e=0,this._b=!0,this._f=!1};Me.ext(Qn,Object,{a6:function(t){this._f=t},a7:function(t){this._b=t},a8:function(t){0!==t.x0()&&this.a9(t,t.x9().i9())},a9:function(t,e){if(this._xx=t.xk(),this._c=t.xl(),this._d=0,this._e=0,this.a0(e),this._b)for(var i=t.x9();i.i1();i.i2()){var n=i.i9();null==this._xx.i1(n)&&(this.a1(n),this.a0(n))}t.xi(this._xx),t.xj(this._c)},a0:function(t){var e=++this._d;this._xx.z1(t,Qn._B),this.a5(t,e);for(var i=this._f?t.ap():t.af();i.i1();i.i2()){var n=i.i8();if(!this._c.i4(n)){this._c.i7(n,!0);var o=n.a1(t);null==this._xx.i1(o)?(this.a3(n,o,!0),this.a0(o),this.a2(n,o)):this.a3(n,o,!1)}}this.a4(t,e,++this._e),this._xx.z1(t,Qn._C)},a5:function(t,e){},a4:function(t,e,i){},a3:function(t,e,i){},a2:function(t,e){},a1:function(t){}}),Qn._B={},Qn._C={};var to=function(t){this._a=t};Me.ext(to,Qn,{a5:function(t,e){var i=this._a._ah.i2(t);this._a._ad[i].ae(t)}});var eo=function(t){this._a=t};Me.ext(eo,Qn,{a2:function(t,e){var i=t.a1(e),n=this._a[i.al()],o=this._a[e.al()];o._a+1>n._a?(n._c=n._a,n._b=n._d,n._a=o._a+1,n._d=t):o._a+1>n._c&&(n._c=o._a+1,n._b=t)}});var io=function(t){this._a=t};Me.ext(io,Qn,{a3:function(t,e,i){i&&t.a2()===e&&this._a.ac(t)}});var no=function(){this._a=0,this._c=0};Me.ext(no,Object,{});var oo=function(){this._a=0};Me.ext(oo,Object,{a1:function(t,e){this._a=0;for(var i=e.length-1;i>=0;i--)e[i]=-1;for(var n=t.x9();n.i1();n.i2()){var o=n.i9();if(0===o.ak()){this.a2(o,o.al(),e);break}}for(var r=t.x9();r.i1();r.i2()){var a=r.i9(),s=a.al();-1===e[s]&&this.a2(a,s,e)}},a2:function(t,e,i){i[e]=-2;for(var n=t.ag();null!=n;){var o=n.a3(),r=o.al();switch(i[r]){case-1:this.a2(o,r,i);case-2:default:n=n.a8()}}i[e]=this._a++}});var ro={};ro.a1=function(t){var e=new ao;return e.a8(t),e._n},ro.a2=function(t){var e=t.x9(),i=null,n=0;for(e.i4();e.i1();e.i2())0===e.i9().ak()&&(i=e.i9(),n++);if(1===n)return i;for(n=0,e.i4();e.i1();e.i2())0===e.i9().ao()&&(i=e.i9(),n++);return 1===n?i:ro.a8(t)},ro.a8=function(t){var e=Ir.a(t.x0()),i=No.a2(e);return ro.a6(t,i)},ro.a6=function(t,e){var i=t.xd(),n=Ir.d(1),o=Ir.a(t.x0(),-1),r=ro.a4(t,i);ro.a7(i,e,n,o,-1);for(var a=r.c1();a.i1();a.i2())t.x3(a.i8());return n[0]},ro.a7=function(t,e,i,n,o){for(var r=0,a=t.ag();null!=a;a=a.a8()){var s=a.a3(),l=ro.a7(s,e,i,n,o);l>o&&(o=l),r+=n[s.al()]}for(var h=r*(t._g.xa()-1-r),c=t.ag();null!=c;c=c.a8())for(var u=c.a3(),d=c.a8();null!=d;d=d.a8()){var f=d.a3();h+=n[u.al()]*n[f.al()]}return e.i7(t,h),n[t.al()]=r+1,h>o&&(o=h,i[0]=t),o},ro.a4=function(t,e){var i=new po,n=new io(i);n.a6(!1),n.a9(t,e);for(var o=i.c1();o.i1();o.i2())t.x3(o.i8());return i},ro.a3=function(t){return ro.a4(t,ro.a2(t))};var ao=function(){this._n=!0,this.a6(!1)};Me.ext(ao,Qn,{a3:function(t,e,i){i||(this._n=!1)},a1:function(t){this._n=!1}});var so=function(t,e){this._i=0,this._m=e,this._j=t,this._l=!1};Me.ext(so,Qn,{a8:function(t){this._h=Ir.a(t.x0()),this._k=Ir.a(t.x0()),this._g=new yo(t.xh()),so.superClass.a8.call(this,t)},a5:function(t,e){this._k[t.al()]=this._h[t.al()]=e},a3:function(t,e,i){if(this._g.c(t),!i){var n=t.a1(e);this._h[n.al()]=Math.min(this._h[n.al()],this._k[e.al()])}},a1:function(t){this._l=!1},a2:function(t,e){var i=t.a1(e);if(this._h[e.al()]>=this._k[i.al()]){for(;this._g.d()!==t;this._j.i5(this._g.b(),this._i));this._j.i5(this._g.b(),this._i),this._i++,this._g.a()?this._l?this._m.i5(i,!0):this._l=!0:this._m.i5(i,!0)}this._h[i.al()]=Math.min(this._h[i.al()],this._h[e.al()])}});var lo=function(t,e){this._h=!1,this._i=t,this._g=e};Me.ext(lo,Object,{z1:function(t,e){t._c[this._i]=e},i1:function(t){return t._c[this._i]},i5:function(t,e){t._c[this._i]=e},i4:function(t){return t._c[this._i]},i7:function(t,e){t._c[this._i]=e},i2:function(t){var e=t._c[this._i];return null==e?0:e},i6:function(t,e){t._c[this._i]=e},i3:function(t){var e=t._c[this._i];return null==e?0:e},c:function(){return this._h},d:function(){this._h=!0}});var ho=function(t,e){this._c=!1,this._d=t,this._b=e};Me.ext(ho,Object,{i8:function(t,e){t._c[this._d]=e},i1:function(t){return t._c[this._d]},i7:function(t,e){t._c[this._d]=e},i4:function(t){var e=t._c[this._d];return null!=e&&e},i5:function(t,e){t._c[this._d]=e},i2:function(t){var e=t._c[this._d];return null==e?0:e},i6:function(t,e){t._c[this._d]=e},i3:function(t){var e=t._c[this._d];return null==e?0:e},a:function(){return this._c},b:function(){this._c=!0}});var co=function(t){this._bb=t,this.i4()};Me.ext(co,Object,{i1:function(){return null!=this._aa},i2:function(){this._aa=this._aa._a},i3:function(){this._aa=this._aa._b},i4:function(){this._aa=this._bb._b},i5:function(){this._aa=this._bb._c},i7:function(){return this._bb.ay()},i6:function(){return this._aa._c}});var uo=function(t){uo.superClass.constructor.call(this,t)};Me.ext(uo,co,{i8:function(){return this.i6()}});var fo=function(t){if(this._id=Me.id(),this._a=0,t)for(t.i4();t.i1();t.i2())this.ae(t.i6())};Me.ext(fo,Object,{ac:function(t){var e=this.ag(t);return null==this._b?this._b=this._c=e:(this._b._b=e,e._a=this._b,this._b=e),this._a++,e},ae:function(t){var e=this.ag(t);return null==this._c?this._b=this._c=e:(this._c._a=e,e._b=this._c,this._c=e),this._a++,e},z1:function(t){t._b=null,t._a=null,null==this._c?this._b=this._c=t:(this._c._a=t,t._b=this._c,this._c=t),this._a++},ad:function(t){t._b=null,t._a=null,null==this._b?this._b=this._c=t:(this._b._b=t,t._a=this._b,this._b=t),this._a++},aa:function(t){return this.ae(t),!0},ab:function(t){for(;t.i1();t.i2())this.ae(t.i6())},ao:function(t,e){if(e===this._b)return this.ac(t);if(null==e)return this.ae(t);var i=this.ag(t);return this.aq(i,e),i},aq:function(t,e){if(null==e)this.ad(t);else if(e===this._b)this.ad(t);else{if(null==this._c)t._b=null,t._a=null,this._b=this._c=t;else{var i=e._b;e._b=t,t._a=e,i._a=t,t._b=i}this._a++}},ap:function(t,e){if(null==e)this.z1(t);else if(e===this._c)this.z1(t);else{if(null==this._b)t._b=null,t._a=null,this._b=this._c=t;else{var i=e._a;e._a=t,t._a=i,i._b=t,t._b=e}this._a++}},an:function(t,e){if(e===this._c)return this.ae(t);if(null==e)return this.ac(t);var i=this.ag(t);return this.ap(i,e),i},ay:function(){return this._a},ar:function(){return 0===this._a},af:function(){this._b=this._c=null,this._a=0},am:function(){return this._b._c},at:function(){var t=this.am();return this.aw(this._b),t},as:function(){return this._c._c},au:function(){return this.aw(this._c)},ak:function(t){for(var e=0,i=this._b;null!=i;){if(t===e)return i._c;i=i._a,e++}return null},aj:function(t){return null==t._a?this._b:t._a},ai:function(t){return null==t._b?this._c:t._b},aw:function(t){return t!==this._b?t._b._a=t._a:this._b=t._a,t!==this._c?t._a._b=t._b:this._c=t._b,this._a--,t._c},av:function(t){return this.aw(t._aa)},ah:function(){return new co(this)},al:function(t){for(var e=this._b;null!=e;){if(null==e._c&&null==t)return e;if(e._c===t)return e;e=e._a}return null},a0:function(){for(var t=Ir.d(this._a),e=0,i=this._b;null!=i;)t[e]=i._c,i=i._a,e++;return t},ax:function(){for(var t=this._b;null!=t;t=t._b){var e=t._a;t._a=t._b,t._b=e}var i=this._b;this._b=this._c,this._c=i},a1:function(t){var e=this.a0();e.sort(t);for(var i=0,n=this._b;null!=n;)n._c=e[i],n=n._a,i++},a2:function(){var t=this.a0();t.sort(Ir.c);for(var e=0,i=this._b;null!=i;)i._c=t[e],i=i._a,e++},az:function(t){null==this._b?(this._b=t._b,this._c=t._c):null!=t._b&&(this._c._a=t._b,t._b._b=this._c,this._c=t._c),this._a+=t._a,t._b=t._c=null,t._a=0},ag:function(t){return new mo(t)}});var po=function(t){po.superClass.constructor.call(this,t)};Me.ext(po,fo,{c1:function(){return new uo(this)},c2:function(){return this.am()},c3:function(){return this.at()}});var go=function(){this._c=0};Me.ext(go,Object,{a:function(t){this._c++,t._b=this._b,t._a=null,null!=this._b?(this._b._a=t,this._b=t):this._b=this._a=t},b:function(t,e){if(null==e)return void this.a(t);var i=e._b;null!=i?i._a=t:this._a=t,t._b=i,t._a=e,e._b=t,this._c++},c:function(t){var e=t._a,i=t._b;this._c--,null!=e?e._b=i:this._b=i,null!=i?i._a=e:this._a=e}});var _o=function(t,e){this._p=t,this._j=e,this._o=t._o[e]};Me.ext(_o,Object,{i1:function(){return null!=this._o},i2:function(){this._o=this._o._k[this._j]},i3:function(){this._o=this._o._f[this._j]},i4:function(){this._o=this._p._o[this._j]},i5:function(){this._o=this._p._q[this._j]},i7:function(){return this._p._n[this._j]},i6:function(){return this._o},i8:function(){return this._o}});var mo=function(t){this._c=t};Me.ext(mo,Object,{a:function(){return this._a},b:function(){return this._b},c:function(t){this._c=t},d:function(){return this._c}});var vo=function(t,e,i,n){this._r=t,this._s=e,this._q=i,this._p=n};Me.ext(vo,Object,{i1:function(t){return this._p[t.a5()]},i3:function(t){return this._r[t.a5()]},i2:function(t){return this._s[t.a5()]},i4:function(t){return this._q[t.a5()]},i8:function(t,e){this._p[t.a5()]=e},i6:function(t,e){this._r[t.a5()]=e},i5:function(t,e){this._s[t.a5()]=e},i7:function(t,e){this._q[t.a5()]=e}});var yo=function(t){this._a=Ir.d(t),this._b=-1};Me.ext(yo,Object,{d:function(){return this._a[this._b]},b:function(){return this._a[this._b--]},c:function(t){this._a[++this._b]=t},a:function(){return this._b<0}});var wo=function(){};Me.ext(wo,Object,{a0:function(t){this._c=Ir.d(t)}});var bo=function(t,e,i,n,o,r,a){this._g=0,t.xt(this,e,i,n,o,r,a)};Me.ext(bo,wo,{a5:function(){return this._h._u&&this._h.b1(),this._g},a2:function(){return this._d},a3:function(){return this._e},a1:function(t){return this._d!==t?this._d:this._e},a4:function(){for(var t=0;1>=t;t++)this._k[t]=null,this._f[t]=null},a8:function(){return this._k[0]},a7:function(){return this._k[1]},a6:function(t,e,i,n){this.a0(n),this._h=t,this._k=Ir.d(2),this._f=Ir.d(2),this._d=e,this._e=i}});var xo=function(t){this._j=0,this._h=t,this.i4()};Me.ext(xo,Object,{i2:function(){this._k=this._k._k[this._j],null==this._k&&0===this._j&&(this._k=this._h._o[1],this._j=1)},i3:function(){this._k=this._k._f[this._j],null==this._k&&1===this._j&&(this._k=this._h._q[0],this._j=0)},i4:function(){this._k=this._h._o[0],null==this._k?(this._k=this._h._o[1],this._j=1):this._j=0},i5:function(){this._k=this._h._q[1],null==this._k?(this._k=this._h._q[0],this._j=0):this._j=1},i1:function(){return null!=this._k},i6:function(){return this._k},i8:function(){return this._k},i7:function(){return this._h.ad()}});var Ao=function(){this._a=ir._A,this._b=ir._A,this._c=new hn};Me.ext(Ao,Object,{i1:function(){return this._c.size()},i2:function(t){return this._c.get(t)},i3:function(t,e,i){this._c.set(t,new Vn(e,i))},i4:function(t,e){this._c.add(new Vn(t,e))},i5:function(){this._c.clear()},i6:function(){return this._a},i7:function(){return this._b},i8:function(t){this._a=t},i9:function(t){this._b=t}});var Co=function(){this._x=0,this._y=0,this._w=0,this._h=0};Me.ext(Co,Object,{i5:function(t,e){this._x=t,this._y=e},i6:function(t,e){this._w=t,this._h=e},i4:function(){return this._h},i3:function(){return this._w},i1:function(){return this._x},i2:function(){return this._y}});var To=function(t,e,i,n){this._m=t,this._n=e,this._l=i,this._k=n};Me.ext(To,Object,{i1:function(t){return this._k[t.al()]},i3:function(t){return this._m[t.al()]},i2:function(t){return this._n[t.al()]},i4:function(t){return this._l[t.al()]},z1:function(t,e){this._k[t.al()]=e},i6:function(t,e){this._m[t.al()]=e},i7:function(t,e){this._n[t.al()]=e},i5:function(t,e){this._l[t.al()]=e}});var ko=function(t,e){this._b=t,this._r=e,this._a=[];for(var i=this._b-1;i>=0;i--)this._a.push(i);this._c=new hn};Me.ext(ko,Object,{a1:function(t){var e;if(0===this._a.length){this.a2(t,this._b,this._b+this._r);for(var i=this._b+this._r-1;i>this._b;i--)this._a.push(i);e=this._b,this._b+=this._r}else e=this._a.pop();return e},b:function(t){var e=this.a1(t),i=new lo(e,this);return this._c.add(i),this.a4(t,e),i},c:function(t){var e=this.a1(t),i=new ho(e,this);return this._c.add(i),this.a4(t,e),i},a2:function(t,e,i){for(var n=t._a;null!=n;n=n._a){var o=Ir.d(i);Ir.f(n._c,o,e),n._c=o}},a3:function(t,e,i){var n=Ir.d(i);Ir.f(t._c,n,e),t._c=n},a4:function(t,e){for(var i=t._a;null!=i;i=i._a)i._c[e]=null},a5:function(t,e){if(t instanceof lo){var i=t;if(i.c())throw"Error";i.d();var n=t._i;this._a.indexOf(n)<0&&(this.a4(e,n),this._a.push(n),this._c.remove(t))}},a6:function(t,e){if(t instanceof ho){var i=t;if(i.a())throw"Error";i.b();var n=i._d;this._a.indexOf(n)<0&&(this.a4(e,n),this._a.push(n),this._c.remove(t))}}});var So=function(t){this._id=Me.id(),this._p=0,t.xs(this)};Me.ext(So,wo,{ad:function(){return this._n[0]+this._n[1]},ak:function(){return this._n[1]},ao:function(){return this._n[0]},al:function(){return this._g._y&&this._g.c(),this._p},ag:function(){return this._o[0]},ae:function(){return this._o[1]},af:function(){return new xo(this)},am:function(){return new _o(this,1)},ap:function(){return new _o(this,0)},an:function(){return new Io(this)},aq:function(){return new Eo(this,1)},aw:function(){return new Eo(this,0)},ah:function(t){for(var e=this._o[0];null!=e;e=e._k[0])if(e.a3()===t)return e;return null},ai:function(t){for(var e=this._o[1];null!=e;e=e._k[1])if(e.a2()===t)return e;return null},aj:function(t){var e=this.ah(t);return null==e&&(e=this.ai(t)),e},au:function(t){this.at(t,1,Ir.d(this.ak()))},av:function(t){this.at(t,0,Ir.d(this.ao()))},as:function(t,e){this.a0(e),this._g=t,this._o=Ir.d(2),this._q=Ir.d(2),this._n=Ir.a(2)},ab:function(t,e,i,n,o){if(null==e)return void this.aa(t,i,n);var r;if(r=e._d===e._e?n:this!==e._d?1:0,0===o){var a=e._k[r];t._f[n]=e,t._k[n]=a,e._k[r]=t,null==a?this._q[i]=t:a._d===a._e?a._f[n]=t:a._f[this!==a._d?1:0]=t}else{var s=e._f[r];t._k[n]=e,t._f[n]=s,e._f[r]=t,null==s?this._o[i]=t:s._d===s._e?s._k[n]=t:s._k[this!==s._d?1:0]=t}this._n[i]++},aa:function(t,e,i){var n=this._q[e];t._k[i]=null,null==n?(this._o[e]=t,t._f[i]=null):(t._f[i]=n,n._d===n._e?n._k[i]=t:n._k[this!==n._d?1:0]=t),this._q[e]=t,this._n[e]++},ar:function(t,e,i){var n,o;n=t._k[i],o=t._f[i],null==n?this._q[e]=o:n._f[n._d!==this?1:0]=o,null==o?this._o[e]=n:o._k[o._d!==this?1:0]=n,this._n[e]--},ac:function(){for(var t=0;1>=t;t++)this._o[t]=null,this._q[t]=null,this._n[t]=0},at:function(t,e,i){if(!(this._n[e]<2)){var n,o=this._n[e],r=0;for(n=this._o[e];null!=n;n=n._k[e])i[r]=n,r++;Ir.s(i,o,t);var a=this._o[e]=i[0];a._f[e]=null;for(var s=1;o>s;)n=i[s],n._f[e]=a,a._k[e]=n,s++,a=n;this._q[e]=n,n._k[e]=null}}});var Eo=function(t,e){Eo.superClass.constructor.call(this,t,e),this._h=1!==e?1:0};Me.ext(Eo,_o,{i6:function(){return this.i9()},i9:function(){return 0!==this._h?this._o._e:this._o._d}});var Io=function(t){Io.superClass.constructor.call(this,t)};Me.ext(Io,xo,{i6:function(){return this._k.a1(this._h)},i9:function(){return this._k.a1(this._h)}});var Lo=function(t){Lo.superClass.constructor.call(this,t)};Me.ext(Lo,co,{i9:function(){return this.i6()}});var Ro=function(t){this._o=t,this._c=t._a};Me.ext(Ro,Object,{i1:function(){return null!=this._c},i2:function(){this._c=this._c._a},i3:function(){this._c=this._c._b},i5:function(){this._c=this._o._b},i4:function(){this._c=this._o._a},i7:function(){return this._o._c},i6:function(){return this._c},i9:function(){return this._c},i8:function(){return this._c}});var Po=function(t){if(t&&t.length){Po.superClass.constructor.call(this);for(var e=0;e<t.length;e++)this.ae(t[e])}else Po.superClass.constructor.call(this,t)};Me.ext(Po,fo,{x1:function(){return new Lo(this)},x2:function(){return this.am()},x3:function(){return this.as()},x4:function(){return this.at()}});var Oo=function(t){this._d=t,Oo.superClass.constructor.call(this)};Me.ext(Oo,Po,{});var Do=function(t){this._a=t,this._b=new po,this._c=new Po};Me.ext(Do,Object,{a:function(){for(var t=this._a.x9();t.i1();t.i2())this.e(t.i9())},b:function(){this.c(),this.d()},c:function(){for(;!this._c.ar();){var t=this._c.x4();this._a.xq(t)||this.g(t)}},d:function(){for(;!this._b.ar();){var t=this._b.c3();this._a.xp(t)||this.f(t)}},e:function(t){for(var e=t.af();e.i1();e.i2())this._b.ac(e.i8()),this._a.h1(e.i8());this._c.ac(t),this._a.h2(t)},f:function(t){this._a.u1(t)},g:function(t){this._a.h3(t)}}),Do.h=function(t,e){for(e.i4();e.i1();e.i2()){var i=e.i8();t.xq(i.a2())||t.h3(i.a2()),t.xq(i.a3())||t.h3(i.a3()),t.xp(i)||t.u1(i)}},Do.i=function(t,e){for(e.i4();e.i1();e.i2()){var i=e.i8();t.xp(i)&&t.h1(i),0===i.a2().ad()&&t.h2(i.a2()),0===i.a3().ad()&&t.h2(i.a3())}};var Mo=function(){this._g=arguments[0],this._f=this._g.xk(),this._h=this._g.xk(),this._d=new fo,this._e=0,1!==arguments.length&&this.a(arguments[1],arguments[2],arguments[3],arguments[4])};Me.ext(Mo,Object,{a:function(t,e,i,n){for(var o=Ir.d(i-e+1),r=e;i>=r;r++)o[r]=new Oo(r);for(var a=this._g.x9();a.i1();a.i2()){var s=a.i9();(null==n||n.i4(s))&&(this._f.z1(s,o[t.i2(s)-e].ac(s)),this._e++)}for(var l=0;l<o.length;l++)for(var h=o[l],c=this._d.ae(h),u=h.x1();u.i1();u.i2())this._h.z1(u.i9(),c)},c:function(){this._g.xi(this._h),this._g.xi(this._f)},e:function(){return 0===this._e},g:function(){for(;this._d.am().ar();this._d.at());this._e--;var t=this._d.am().x4();return this._h.z1(t,null),this._f.z1(t,null),t},f:function(){for(;this._d.as().ar();this._d.au());this._e--;var t=this._d.as().x4();return this._h.z1(t,null),this._f.z1(t,null),t},d:function(t){var e=this._f.i1(t),i=this._h.i1(t),n=i.d(),o=null,r=i.a();null!=r?(o=r.d(),this._h.z1(t,r)):(o=new Oo(n._d+1),this._h.z1(t,this._d.ae(o))),n.aw(e),this._f.z1(t,o.ac(t))},b:function(t){var e=this._f.i1(t),i=this._h.i1(t),n=i.d(),o=null,r=i.b();null!=r?(o=r.d(),this._h.z1(t,r)):(o=new Oo(n._d-1),this._h.z1(t,this._d.ac(o))),n.aw(e),this._f.z1(t,o.ac(t))}});var No={};No.a1=function(t){return new To(t,null,null,null)},No.a2=function(t){return new To(null,t,null,null)},No.a3=function(t){return new To(null,null,t,null)},No.a4=function(t){return new vo(null,t,null,null)},No.a5=function(t){return new vo(null,null,t,null)},No.a6=function(t){return new vo(null,null,null,t)};var Bo=function(){if(2===arguments.length){this._a=new fo,this._b=new fo,this._c=0;var t=arguments[0],e=arguments[1],i=new Fo(t._j2.gj(e)/2,0);this._a.ac(i),i=new Fo(t._j2.gj(e)/2,0),this._b.ac(i)}else this._a=arguments[1],this._b=arguments[2],this._c=arguments[3]};Me.ext(Bo,Object,{});var Fo=function(t,e){this._b=t,this._a=e};Me.ext(Fo,Object,{});var zo=function(){this._cx=!0,this._cs=new Ko,this._ct=new $o,this._cw=new qo};Me.ext(zo,Object,{i5:function(t){this._cx=t},k:function(){var t=new Jo(this);return this._cx&&(this._cs.w1(t),t=this._cs),this._cw.w1(t),t=this._cw,this._ct.w1(t),t=this._ct},i2:function(t){this.k().i2(t)},i1:function(t){return this.k().i1(t)}});var Vo=function(){Vo.superClass.constructor.call(this),this._jv=20,this._jw=40,this._jx=function(t,e){var i=t.a3(),n=e.a3(),o=i._g;return Math.floor(100*(o.g5(i)-o.g5(n)))}};Me.ext(Vo,zo,{i4:function(t){return ro.a1(t)},i3:function(t){if(!this.i4(t))throw"Error";var e=ro.a3(t);if(this._j2=t,this._j3=new Uo(t),cr.c(t),this._jy=t.xk(),!t.xb()){this.bu();var i=this._j3.c1();this.f(i),this.b(this._j3),this.c(this._j3)}for(var n;!e.ar();t.x3(n))n=e.c3(),cr.b(t.g2(n))},bu:function(){if(null!=this._jx)for(var t=this._j2.x9();t.i1();t.i2())t.i9().av(this._jx)},c:function(t){for(var e=this.a2(t),i=Ir.a(e.length),n=0;n<e.length;n++){for(var o=e[n],r=0,a=o.ah();a.i1();a.i2()){var s=a.i6();r=Math.max(r,this._j2.g9(s))}i[n]=r}for(var l=-this._jw,h=0;h<e.length;h++){l+=this._jw+i[h];for(var c=e[h],u=c.ah();u.i1();u.i2()){var d=u.i6();this._j2.s2(d,this._j2.g5(d),l-i[h]/2)}}},a2:function(t){for(var e=Ir.d(t.b()),i=0,n=t.b();n>i;i++)e[i]=new fo;return t.c1(),this.a1(t.c1(),0,e),e},a1:function(t,e,i){i[e].ae(t);for(var n=t.aw();n.i1();n.i2())this.a1(n.i9(),e+1,i)},b:function(t){var e=t.c1();this._j2.s2(e,0,this._j2.g6(e)),this.g(e)},g:function(t){for(var e=t.aw();e.i1();e.i2()){var i=e.i9(),n=this._jy.i1(i);this._j2.s2(i,this._j2.g5(t)+n._c,this._j2.g6(i)),this.g(i)}},f:function(t){if(this._j3.c2(t))return void this._jy.z1(t,new Bo(this,t));var e=t.aw(),i=e.i9();e.i2(),this.f(i);var n=this._jy.i1(i),o=new Bo(this,n._a,n._b,0);if(!e.i1())return o._a.ac(new Fo(this._j2.gj(t)/2,0)),o._b.ac(new Fo(this._j2.gj(t)/2,0)),void this._jy.z1(t,o);for(;e.i1();){i=e.i9(),e.i2(),this.f(i),n=this._jy.i1(i);for(var r=o._b.ah(),a=n._a.ah(),s=2147483647,l=0,h=0;r.i1()&&a.i1();){var c=r.i6();r.i2();var u=a.i6();a.i2(),h+=c._a,l+=u._a,s=Math.min(s,l-h-c._b-u._b)}n._c=this._jv-s,l+=n._c;if(n._b.am()._a=n._c,r.i1()&&!a.i1())for(var d=h-this.a3(n._b);r.i1();d=0){var f=r.i6();r.i2(),n._b.ae(new Fo(f._b,f._a+d))}else if(!r.i1()&&a.i1()){var p=this.a3(o._a);for(p=l-p;a.i1();p=0){var g=a.i6();a.i2(),o._a.ae(new Fo(g._b,g._a+p))}}o._b=n._b}this._jy.z1(t,o);for(var _=-n._c/2,m=t.aw();m.i1();){var v=m.i9();m.i2();var y=this._jy.i1(v);y._c+=_;var w=y._b.am();w._a+=_,w=y._a.am(),w._a+=_}o._a.ac(new Fo(this._j2.gj(t)/2,0)),o._b.ac(new Fo(this._j2.gj(t)/2,0))},a3:function(t){for(var e=0,i=t.ah();i.i1();i.i2()){e+=i.i6()._a}return e}});var Uo=function(t){this._b=t,this.a()};Me.ext(Uo,Object,{c1:function(){return null==this._a&&this.a(),this._a},b:function(){return null==this._a?-1:this.d(this._a)},d:function(t){for(var e=0,i=t.aw();i.i1();i.i2())e=Math.max(e,this.d(i.i9()));return e+1},c2:function(t){return 0===t.ao()},a:function(){for(var t=this._b.x9();t.i1();t.i2())if(0===t.i9().ak())return void(this._a=t.i9())}});var jo=function(t){this._d=0,this._e=0,this._f=0,this._a=0,this._b=0,this._g=t,this._c=new fo};Me.ext(jo,Object,{a:function(){return this._d+this._e+this._f}});var Ho=function(){Ho.superClass.constructor.call(this),this._kl=340,this._km=360,this._kk=40,this._ko=.5};Me.ext(Ho,zo,{ic:function(){return this._km},ia:function(){return this._kl},i9:function(){return this._ko},i3:function(t){if(!ro.a1(t))throw"Error";this._a=t;var e=this.i8(),i=ro.a4(t,e);cr.c(t),this._kn=Ir.d(t.x0());for(var n=t.x9();n.i1();n.i2()){var o=n.i9();o!==e?this.aa(o,new jo(this._kk+this.q(o.aq().i9()))):this.aa(o,new jo(this._kk))}this.s(e),t.s2(e,0,0),this.t(e);for(var r;!i.ar();t.x3(r))r=i.c3()},i4:function(t){return ro.a1(t)},i0:function(t){return this._kn[t.al()]},i8:function(){return ro.a2(this._a)},i7:function(t){for(var e,i=this.ib(t);e=this.i6(t),!(i>=e);)for(var n=t.aw();n.i1();n.i2()){var o=n.i9();this.i0(o)._g*=1+this._ko}var r=(i-e)/(2*t.ao());e=0;for(var a=t.aw();a.i1();a.i2()){var s=this.i0(a.i9());s._d+=r,s._e+=r,e+=s._d+s._e}this.id(t)},id:function(t){for(var e=Ir.d(t.ao()),i=0,n=t.ap();n.i1();)e[i]=n.i8(),n.i2(),i++;var o=this;e.sort(function(t,e){var i=t.a3(),n=e.a3(),r=o.i0(i).a()-o.i0(n).a();return r>0?1:r>=0?0:-1});for(var r=0;r<e.length;r++)this._a.h1(e[r]);for(var a=0;a<e.length;a+=2)this._a.u1(e[a]);for((i=e.length-1)%2==0&&i--;i>0;i-=2)this._a.u1(e[i])},ib:function(t){return 0===t.ak()?this._km:2===t.ao()?Math.min(180,this._kl):this._kl},i6:function(t){for(var e=0,i=t.ap();i.i1();i.i2()){for(var n,o=i.i8(),r=o.a3(),a=this.i0(r),s=-a._g,l=a._b,h=a._c,c=0,u=c+1,d=h._b,f=d.d();u>c;u=(n.y-l)/(n.x-s))n=f,d=h.ai(d),f=d.d(),c=(f.y-n.y)/(f.x-n.x);for(a._d=180*-Math.atan(u)/Math.PI,c=0,u=c-1,d=h._b,f=d.d();d.a().d().x===f.x;f=d.d())d=d.a();for(var p;c>u;u=(p.y-l)/(p.x-s))p=f,d=h.aj(d),f=d.d(),c=(f.y-p.y)/(f.x-p.x);a._e=180*Math.atan(u)/Math.PI,e+=a._d+a._e}return e},aa:function(t,e){this._kn[t.al()]=e},p:function(t){var e=this.i0(t),i=new fo,n=2*this.q(t);i.aa(new Vn(0,0)),i.aa(new Vn(0,n)),i.aa(new Vn(n,n)),i.aa(new Vn(n,0)),e._c=i,e._a=n/2,e._b=n/2},r:function(t){if(0===t.ao())this.p(t);else{var e=this.i0(t),i=this.q(t),n=new fo;n.aa(new Vn(-i,-i)),n.aa(new Vn(-i,i)),n.aa(new Vn(i,-i)),n.aa(new Vn(i,i));for(var o=t.aw();o.i1();o.i2()){var r=this.i0(o.i9());n.az(r._c)}for(var a=ir.h(n),s=Number.MAX_VALUE,l=Number.MAX_VALUE,h=Number.MIN_VALUE,c=Number.MIN_VALUE,u=a.ah();u.i1();u.i2()){var d=u.i6();d.x<s&&(s=d.x),d.x>h&&(h=d.x),d.y<l&&(l=d.y),d.y>c&&(c=d.y)}for(var f=new fo,p=a.ah();p.i1();p.i2()){var g=p.i6();f.aa(new Vn(g.x-s,g.y-l))}e._c=f,e._a=-s,e._b=-l}},s:function(t){if(0===t.ao())this.r(t);else{for(var e=t.aw();e.i1();e.i2())this.s(e.i9());this.i7(t);for(var i=0,n=t.aw();n.i1();n.i2()){var o=n.i9(),r=this.i0(o),a=180-(360-this.ib(t))/2-i-(r._e+r._f);i+=r.a(),a=a/180*Math.PI;for(var s=Math.sin(a),l=Math.cos(a),h=r._c._b;null!=h;h=h.a()){var c=h.d(),u=c.x+r._g,d=c.y-r._b,f=new Vn(u*l-s*d,u*s+l*d);h.c(f)}var p=r._a+r._g;r._a=p*l,r._b=p*s}this.r(t)}},t:function(t){var e=this._a.g4(t),i=0;if(t.ak()>0){var n=t.aq().i9(),o=this._a.g4(n);i=Math.PI+Math.atan2(o.y-e.y,o.x-e.x)}for(var r=t.aw();r.i1();r.i2()){var a=r.i9(),s=this.i0(a);if(0!==i){var l=Math.cos(i),h=Math.sin(i),c=s._a*l-h*s._b,u=s._a*h+l*s._b;s._a=c,s._b=u}this._a.s2(a,e.x+s._a,e.y+s._b),this.t(a)}},q:function(t){return Math.max(this._a.gj(t),this._a.g9(t))/2*1.41}});var Wo=function(){};Me.ext(Wo,Object,{i2:function(t){return t.ad()},i1:function(t){throw"Error"},i3:function(t){throw"Error"},i4:function(t){throw"Error"}});var Go=function(t){this._a=t};Me.ext(Go,Object,{i2:function(t){for(var e=0,i=t.an();i.i1();i.i2())null!=this._a.i1(i.i9())&&e++;return e},i4:function(t){return null==this._a.i1(t)},i1:function(t){throw"Error"},i3:function(t){throw"Error"}});var Zo=function(){Zo.superClass.constructor.call(this),this._kq=!1,this._kp=90};Me.ext(Zo,Ho,{a:function(t,e){this._kr=e,this._ks=t,this._kq=!0},i7:function(t){if(!this.u(t))return void Zo.superClass.i7.call(this,t);for(var e=this.i9(),i=this.ib(t),n=(360-i)/2+i,o=new po(t.ap());;){var r=this.i6(t);r=(360-i)/2;for(var a=null,s=null,l=o._b;null!=l;l=l.a()){var h=l.d(),c=h.a3(),u=this.i0(c),d=this._ks.i3(h),f=d-(r+u._e);if(f>=0&&d+u._d>=n&&(f=r+u.a()<=n?n-r-u.a():2*(n-(d+u._d))),u._f=0,f>=0)u._f=f,a=l,s=u;else{for(-f>u._d+u._e?f=(u._d+u._e)/2:f/=-2,r-=f,n>=r&&r+u.a()>n&&(r+=f,f=r+u.a()-n,r-=f);null!=a&&f>s._f;s=this.i0(a.d().a3()))if(f-=s._f,s._f=0,null==(a=a.b())){s=null;break}null!=a?s._f-=f:r+=f}r+=u.a()}if(n>=r){for(var p=0,g=(360-i)/2,_=t.ap();_.i1();_.i2()){var m=_.i8(),v=m.a3(),y=this._ks.i3(m),w=this.i0(v),b=g+w._f+w._e;p<Math.abs(b-y)&&(p=Math.abs(b-y)),g+=w.a()}if(p<=this._kp)break}for(var x=t.aw();x.i1();x.i2()){var A=x.i9();this.i0(A)._g*=1+e}}},ib:function(t){return this.u(t)?0===t.ak()?this.ic():this.ia():Zo.superClass.ib.call(this,t)},u:function(t){return!(!this._kq||0===t.ao())&&null!=this._ks.i1(t.ag())}});var Xo=function(t){this._a=t};Me.ext(Xo,Object,{i1:function(t){return this._a.i1(t)},i2:function(t){throw"Error"},i3:function(t){throw"Error"},i4:function(t){throw"Error"}});var Yo=function(){};Me.ext(Yo,Object,{w1:function(t){this._bb=t},w2:function(){return this._bb},w4:function(t){null!=this._bb&&this._bb.i2(t)},w3:function(t){return null==this._bb||this._bb.i1(t)}});var $o=function(){this._cg=45,this._ce=400,this._ch=400,this._cf=0};Me.ext($o,Yo,{i1:function(t){if(null!=this.w2()){for(var e=!0,i=t.xk(),n=Jn.a3(t,i),o=Ir.d(n),r=Ir.d(n),a=0;n>a;a++)o[a]=new Po,r[a]=new po;for(var s=t.xf();s.i1();s.i2()){var l=s.i8();r[i.i2(l.a2())].aa(l),t.h1(l)}for(var h=t.x9();h.i1();h.i2()){var c=h.i9();o[i.i2(c)].aa(c),t.h2(h.i9())}for(var u=0;n>u;u++){for(var d=o[u].x1();d.i1();d.i2())t.h3(d.i9());for(var f=r[u].c1();f.i1();f.i2())t.u1(f.i8());e=this.w3(t);for(var p=r[u].c1();p.i1();p.i2())t.h1(p.i8());for(var g=o[u].x1();g.i1();g.i2())t.h2(g.i9());if(!e)break}for(var _=0;n>_;_++)for(var m=o[_].x1();m.i1();m.i2())t.h3(m.i9());for(var v=0;n>v;v++)for(var y=r[v].c1();y.i1();y.i2())t.u1(y.i8());return t.xi(i),e}return!0},i2:function(t){if(!t.xb()){for(var e=t.xk(),i=Jn.a3(t,e),n=Ir.d(i),o=Ir.d(i),r=Ir.d(i),a=Ir.d(i),s=0;i>s;s++)n[s]=new Po,o[s]=new po;for(var l=t.xf();l.i1();l.i2()){var h=l.i8();o[e.i2(h.a2())].aa(h),t.h1(h)}for(var c=t.x9();c.i1();c.i2()){var u=c.i9();n[e.i2(u)].aa(u),t.h2(c.i9())}for(var d=0;i>d;d++){for(var f=n[d].x1();f.i1();f.i2())t.h3(f.i9());for(var p=o[d].c1();p.i1();p.i2())t.u1(p.i8());this.w4(t);var g=t.g3();r[d]=new Hn(g.x,g.y,g.width,g.height);var _={};if(a[d]=_,this._cf>0){var m=this._cg+Math.ceil((g.width+1)/this._cf)*this._cf,v=this._cg+Math.ceil((g.height+1)/this._cf)*this._cf;_.x=g.x,_.y=g.y,_.width=m,_.height=v}else _.x=g.x,_.y=g.y,_.width=g.width+this._cg,_.height=g.height+this._cg;for(var y=o[d].c1();y.i1();y.i2())t.h1(y.i8());for(var w=n[d].x1();w.i1();w.i2())t.h2(w.i9())}for(var b=0;i>b;b++)for(var x=n[b].x1();x.i1();x.i2())t.h3(x.i9());for(var A=0;i>A;A++)for(var C=o[A].c1();C.i1();C.i2())t.u1(C.i8());if(cr.a(a,null,this._ce/this._ch),this._cf<=0)for(var T=0;T<a.length;T++)this.w5(t,n[T],o[T],new Vn(a[T].x,a[T].y),r[T]);else for(var k=0;k<a.length;k++){var S=Math.floor((a[k].x-r[k].x)/this._cf)*this._cf,E=Math.floor((a[k].y-r[k].y)/this._cf)*this._cf,I=r[k].x+S,L=r[k].y+E;this.w5(t,n[k],o[k],new Vn(I,L),r[k])}t.xi(e)}},w5:function(t,e,i,n,o){for(var r=-o.x+n.x,a=-o.y+n.y,s=e.x1();s.i1();s.i2()){var l=t.ga(s.i9());t.s4(s.i9(),new Vn(l.x+r,l.y+a))}for(var h=i.c1();h.i1();h.i2()){for(var c=h.i8(),u=new hn,d=t.gp(c).c();d.i1();d.i2()){var f=d.i6();u.add(new Vn(f.x+r,f.y+a))}t.s5(c,new Gn(u))}}});var qo=function(){};Me.ext(qo,Yo,{i1:function(t){return this.w3(t)},i2:function(t){this.w7(t),null!=this.w2()&&this.w4(t),this.w6(t)},w7:function(t){this.e(t),this.k(t),this.i(t)},e:function(t){for(var e=t.x9();e.i1();e.i2()){var i=t.g4(e.i9());t.s1(e.i9(),i)}},w6:function(t){this.l(t),this.j(t),this.f(t)},l:function(t){for(var e=t.x9();e.i1();e.i2()){var i=t.g4(e.i9());t.s1(e.i9(),i)}},j:function(t){for(var e=t.xf();e.i1();e.i2()){var i=t.g7(e.i8()),n=i.i6();i.i8(n),n=i.i7(),i.i9(n);for(var o=0;o<i.i1();o++){var r=i.i2(o);i.i3(o,r.x,r.y)}}},k:function(t){for(var e=t.xf();e.i1();e.i2()){var i=t.g7(e.i8()),n=i.i6();i.i8(n),n=i.i7(),i.i9(n);for(var o=0;o<i.i1();o++){var r=i.i2(o);i.i3(o,r.x,r.y)}}},f:function(t){null!=this._ca&&(t.x1("A",this._ca),this._ca=null,this._b6=null),null!=this._b8&&(t.x1("B",this._b8),this._b8=null,this._b9=null)},i:function(t){this._ca=t.xc("A"),null!=this._ca&&(this._b6=new Xo(this._ca),t.x1("A",this._b6)),this._b8=t.xc("B"),null!=this._b8&&(this._b9=new Xo(this._b8),t.x1("B",this._b9))}});var Ko=function(){this._a=new po,this._c=10};Me.ext(Ko,Yo,{i2:function(t){this._b=t.xl(),this.w9(t),this.w4(t),this.c(t),this.w8(t,this._b),t.xj(this._b)},i1:function(t){if(null==this.w2())return!0;this._b=t.xl(),this.w9(t);var e=this.w3(t);return this.c(t),t.xj(this._b),e},w8:function(t,e){for(var i=t.xf();i.i1();i.i2()){var n=i.i8();if(null!=e.i1(n)){var o=e.i1(n);cr.g(t,n,o,this._c)}}},w9:function(t){for(var e=t.xk(),i=t.x9();i.i1();i.i2()){for(var n=i.i9(),o=n.af();o.i1();o.i2()){var r=o.i8(),a=r.a1(n),s=e.i1(a);if(s!==r)if(null==s)e.z1(a,r);else{null==this._b.i1(s)&&this._b.i8(s,new po);var l=this._b.i1(s);l.aa(r),this._a.ac(r),t.h1(r)}}for(var h=n.af();h.i1();h.i2()){var c=h.i8(),u=c.a1(n);e.z1(u,null)}}t.xi(e)},c:function(t){for(;!this._a.ar();t.u1(this._a.c3()));}});var Jo=function(t){this._a=t};Me.ext(Jo,Object,{i2:function(t){this._a.i3(t)},i1:function(t){return this._a.i4(t)}});var Qo=function(){Qo.superClass.constructor.call(this),this._jo=30,this._jp=new nr,this._jt=5};Me.ext(Qo,zo,{i4:function(t){return!0},i3:function(t){this._ju=t,cr.c(t);for(var e=this._jp.i1(t),i=0,n=t.x9();n.i1();n.i2())i=Math.max(i,this.e(n.i9()));i<this._jt&&(i=this._jt),this.a(e,i)},a:function(t,e){var i=t.i7(),n=2*Math.PI/i,o=0,r=Ir.a(i);t.i4();for(var a=0;i>a;)r[a]=this.e(t.i9())+this._jo,o+=r[a],a++,t.i2();var s=o/i,l=o/(2*Math.PI);e>l&&(l=e),t.i4();for(var h=0,c=0;i>c;){var u=n/s*r[c];h+=u/2;var d=Math.cos(h)*l,f=Math.sin(h)*l;h+=u/2,this._ju.s2(t.i9(),d,f),c++,t.i2()}return l},e:function(t){var e=this._ju.gj(t),i=this._ju.g9(t);return i>=e?i:e}});var tr=function(){tr.superClass.constructor.call(this),this._jm=new Qo,this._jk=new Zo};Me.ext(tr,zo,{i4:function(t){return!0},i3:function(t){if(!(t.x0()<2)){this._jn=t,cr.c(this._jn),cr.e(this._jn);var e=new lr(this._jn);e.a1(),e.h();var i=new Do(this._jn);i.a();for(var n=e.x9();n.i1();n.i2()){var o=n.i9(),r=e.c2(o);if(r.ay()>1){var a=e.d1(o);Do.h(this._jn,a.c1()),this._jm.i3(this._jn);var s=this._jn.g3();e.s7(o,s.width,s.height)}else if(1===r.ay()){var l=r.x2();e.s8(o,this._jn.gm(l)),this._jn.s2(l,0,0)}else e.s7(o,1,1);Do.i(this._jn,this._jn.xf())}i.b();var h=this.a7(e);ro.a4(e,h);var c=e.xk(),u=e.xl();this.a2(e,u,c),this.a1(e,u),this.a3(e,h,u),this._jk.a(u,c),this._jk.i3(e),this.a5(e,h,c);for(var d=e.x9();d.i1();d.i2())for(var f=d.i9(),p=e.g4(f),g=e.c2(f).x1();g.i1();g.i2()){var _=g.i9();this._jn.s2(_,p.x+this._jn.g5(_),p.y+this._jn.g6(_))}}},a7:function(t){for(var e=-1,i=null,n=t.x9();n.i1();n.i2()){var o=n.i9();t.c2(o).ay()>e&&(i=o,e=t.c2(o).ay())}return i},a1:function(t,e){for(var i=function(t,i){var n=e.i3(t)-e.i3(i);return n>0?1:n>=0?0:-1},n=t.x9();n.i1();n.i2())n.i9().av(i)},a2:function(t,e,i){for(var n=Ir.a(this._jn.x0()),o=t.x9();o.i1();o.i2())for(var r=o.i9(),a=t.c2(r),s=a.x1();s.i1();s.i2()){var l=s.i9();n[l.al()]=r.al()}var h=ro.a2(t);this.a4(t,h,n,e,i)},a3:function(t,e,i){if(t.c2(e).ay()>1){for(var n=0,o=0,r=0,a=e.ap();a.i1();a.i2()){var s=a.i8(),l=i.i3(s);l-n>o&&(o=l-n,r=(n+l)/2),n=l}360-n>o&&(r=(360+n)/2),this.a6(t,e,r);for(var h=e.ap();h.i1();h.i2()){var c=h.i8(),u=i.i3(c);for(u-=r;0>u;u+=360);i.i6(c,u)}e.av(function(t,e){var n=i.i3(t)-i.i3(e);return n>0?1:n>=0?0:-1})}},a4:function(t,e,i,n,o){for(var r=e.al(),a=o.i3(e),s=e.ap();s.i1();s.i2()){for(var l=s.i8(),h=t.b(l),c=0,u=0,d=0,f=0,p=h.c1();p.i1();p.i2()){var g=p.i8(),_=null,m=null;i[g.a2().al()]===r?(_=g.a2(),m=g.a3()):(_=g.a3(),m=g.a2()),d-=this._jn.g5(_),f+=this._jn.g6(_),c-=this._jn.g5(m),u+=this._jn.g6(m)}if(0!==d||0!==f){var v;for(v=180*Math.atan2(f,d)/Math.PI-a;0>v;v+=360);n.i6(l,v)}if(0!==c&&0!==u){var y=180*Math.atan2(u,c)/Math.PI;0>y&&(y+=360),o.i6(l.a3(),y)}this.a4(t,l.a3(),i,n,o)}},a5:function(t,e,i){for(var n=t.g4(e),o=e.ap();o.i1();o.i2()){var r=o.i8(),a=r.a3(),s=t.g4(a),l=s.x-n.x,h=s.y-n.y,c=180*Math.atan2(h,l)/Math.PI;if(null!=i.i1(a)){c+=i.i3(a)}this.a6(t,a,c),this.a5(t,a,i)}},a6:function(t,e,i){i=i/180*Math.PI;var n=t.c2(e);if(!(n.ay()<=1))for(var o=n.x1();o.i1();o.i2()){var r=o.i9(),a=this._jn.g5(r),s=this._jn.g6(r),l=Math.cos(i),h=Math.sin(i),c=a*l-h*s,u=a*h+l*s;this._jn.s2(r,c,u)}}});var er=function(){this._a=(new Date).getTime()};Me.ext(er,Object,{b:function(){return(new Date).getTime()-this._a}});var ir={};ir._A=new Vn(0,0),ir.b=function(t,e,i){return ir.c(t.x,t.y,e.x,e.y,i.x,i.y)},ir.c=function(t,e,i,n,o,r){i-=t,n-=e,o-=t,r-=e;var a=o*n-r*i;return Math.abs(a)<1e-5?0:a>=0?0>=a?0:-1:1},ir.d=function(t,e,i){return ir.b(t,e,i)>0},ir.f=function(t,e,i){return ir.b(t,e,i)<0},ir.g=function(t,e,i){return 0===ir.b(t,e,i)},ir.h=function(t){return ir.i(t)},ir.i=function(t){var e=new fo(t.ah()),i=new fo;if(e.a2(),e.ar())return i;var n=e.at();for(i.ae(n);!e.ar()&&n.equals(e.am());e.at());if(e.ar())return i;n=e.at();for(var o=i.ae(n),r=e.ah();r.i1();r.i2()){var a=r.i6();if(!a.equals(n))if(n=a,2===i.ay()&&ir.g(i.am(),i.as(),a))o.c(a);else{var s;for(s=o;!ir.f(i.ai(s).d(),s.d(),a);s=i.ai(s));var l;for(l=o;!ir.d(i.aj(l).d(),l.d(),a);l=i.aj(l));for(;l!==i.aj(s);i.aw(i.aj(s)));o=i.an(a,s)}}return i},ir.j=function(){return ir.k(Number.MAX_VALUE)},ir.k=function(t){return Math.floor(De.Util.random()*t)},ir.l=function(t,e){return De.Util.random()*(e-t)+t};var nr=function(){};Me.ext(nr,Object,{i1:function(t){this._b=t;var e=new po;e=Jn.a6(t),e.az(Jn.a7(t));for(var i=this.a1();!e.ar();t.x5(e.c3()));return i.x1()},a1:function(){if(this._b.x0()<3)return new Po(this._b.x9());for(var t=this._b.xk(),e=this._b.xk(),i=this._b.xl(),n=new Mo(this._b,new Wo,0,this.a3(this._b)),o=this._b.x0(),r=new po,a=new po,s=new Do(this._b);o>3;o--){for(var l=n.g(),h=l.an();h.i1();h.i2())t.z1(h.i9(),o),e.i5(h.i9(),!1);for(var c=l.an();c.i1();c.i2())for(var u=c.i9(),d=u.ap();d.i1();d.i2()){var f=d.i8();t.i2(f.a3())===o&&(a.aa(f),e.i5(f.a2(),!0),e.i5(f.a3(),!0))}if(a.ay()<l.ad()-1){for(var p=null,g=l.an();g.i1();g.i2()){var _=g.i9();if(t.i2(_)===o&&!e.i4(_))if(null==p)p=_;else{var m=this._b.xo(p,_);i.i7(m,!0),a.aa(m),p=null}}if(null!=p)for(var v=l.an();v.i1();v.i2()){var y=v.i9();if(y!==p&&null==y.aj(p)){var w=this._b.xo(p,y);i.i7(w,!0),a.aa(w);break}}if(a.ay()<l.ad()-1){for(var b=2147483647,x=null,A=l.an();A.i1();A.i2()){var C=A.i9();C.ad()<b&&(x=C,b=C.ad())}for(var T=l.an();T.i1();T.i2()){var k=T.i9();if(null==x.aj(k)&&x!==k){var S=this._b.xo(x,k);if(i.i7(S,!0),a.aa(S),a.ay()>=l.ad()-1)break}}}}for(var E=l.an();E.i1();E.i2())n.b(E.i9());for(var I=a.c1();I.i1();I.i2()){var L=I.i8();i.i4(L)&&(n.d(L.a2()),n.d(L.a3()))}r.az(a),s.e(l)}s.b(),n.c();for(var R=r.c1();R.i1();R.i2()){var P=R.i8();null!=P._h&&(i.i4(P)?this._b.x5(P):this._b.h1(P))}var O=this.a4(this._b),D=new Po,M=O.ak(0),N=O.ak(1),B=null;B=M.a2()===N.a2()||M.a2()===N.a3()?M.a3():M.a2(),D.aa(B);for(var F=O.c1();F.i1();F.i2()){B=F.i8().a1(B),D.aa(B)}for(var z=r.c1();z.i1();z.i2()){var V=z.i8();i.i4(V)||null!=V._h||this._b.u1(V)}return this._b.xi(e),this._b.xj(i),this._b.xi(t),this.a2(D),D},a2:function(t){if(t.ay()<this._b.x0()){for(var e=this._b.xk(),i=t._b;null!=i;i=i.a()){var n=i.d();e.z1(n,i)}var o;for(o=new Mo(this._b,new Go(e),0,t.ay(),new Go(e));!o.e();){for(var r=o.f(),a=r.an();a.i1();a.i2()){var s=a.i9();if(null!=e.i1(s)){var l=e.i1(s),h=t.ai(l).d(),c=null;c=null!=r.aj(h)?t.ao(r,l):t.an(r,l),e.z1(r,c);break}}for(var u=r.an();u.i1();u.i2()){var d=u.i9();null==e.i1(d)&&o.d(d)}}this._b.xi(e),o.c()}},a3:function(t){for(var e=0,i=t.x9();i.i1();i.i2())e=Math.max(e,i.i9().ad());return e},a4:function(t){for(var e=[],i=0,n=t.x0();n>i;i++)e[i]=new no;var o=new eo(e);o.a6(!1),o.a8(t);for(var r=-1,a=null,s=t.x9();s.i1();s.i2()){var l=s.i9(),h=e[l.al()];h._a+h._c>r&&(r=h._a+h._c,a=l)}for(var c=new po,u=a,d=e[u.al()]._d;null!=d;d=e[u.al()]._d)c.ac(d),u=d.a1(u);u=a;for(var f=e[u.al()]._b;null!=f;f=e[u.al()]._d)c.ae(f),u=f.a1(u);return c}});var or=function(){this._v=new go,this._x=new go,this._z=new ko(3,5),this._w=new ko(3,5),this._y=!1,this._u=!1,this._t={}};Me.ext(or,Object,{xm:function(){return new So(this)},xo:function(t,e){return this.xn(t,null,e,null,0,0)},xn:function(t,e,i,n,o,r){return new bo(this,t,e,i,n,o,r)},x4:function(t){this.b3(t)},b3:function(t){for(var e;null!=(e=t._o[0]);)this.x5(e);for(;null!=(e=t._o[1]);)this.x5(e);this._v.c(t),t._g=null,this._y=!0},x5:function(t){this.a11(t)},a11:function(t){if(t._h!==this)throw"Error";var e=t.a2(),i=t.a3();this.a12(t,e,i),this._x.c(t),t._h=null,this._u=!0},x7:function(t){t._p=this._v._c,t._g=this,t.ac(),t._c.length<this._z._b&&this._z.a3(t,t._c.length,this._z._b),this._v.a(t),this._y=!0},x8:function(t){if(null!=t._h)throw"Error";t._c.length<this._w._b&&this._w.a3(t,t._c.length,this._w._b),null==t._a||t._a._h!==this?this._x.a(t):this._x.b(t,t._a),t._h=this,t.a4(),this.b2(t,t.a2(),null,t.a3(),null,0,0),this._u=!0},xr:function(t,e,i){var n=t.a2(),o=t.a3();null==t._h?(t._d=e,t._e=i):(n!==e&&(n.ar(t,0,0),t._d=e,e.ab(t,null,0,0,0)),o!==i&&(o.ar(t,1,1),t._e=i,i.ab(t,null,1,1,0)))},x3:function(t){this.xr(t,t.a3(),t.a2())},h1:function(t){this.a11(t)},u1:function(t){this.x8(t)},h2:function(t){this.x4(t)},h3:function(t){this.x7(t)},xa:function(){return this._v._c},x0:function(){return this._v._c},xh:function(){return this._x._c},xg:function(){return this._x._c},xb:function(){return 0===this._v._c},xq:function(t){return t._g===this},xp:function(t){return t._h===this},xd:function(){return this._v._a},x9:function(){return new Ro(this._v)},xf:function(){return new Ro(this._x)},x2:function(t,e){var i=Ir.d(this.xh());if(null!=t&&null!=e)for(var n=this.x9();n.i1();n.i2())n.i9().at(t,1,i),n.i9().at(e,0,i);else if(null==e&&null!=t)for(var o=this.x9();o.i1();o.i2())o.i9().at(t,1,i);else if(null!=e&&null==t)for(var r=this.x9();r.i1();r.i2())r.i9().at(e,0,i)},xk:function(){return this._z.b(this._v)},xl:function(){return this._w.c(this._x)},xi:function(t){this._z.a5(t,this._v)},xj:function(t){this._w.a6(t,this._x)},xc:function(t){return this._t[t]},x1:function(t,e){this._t[t]=e},x6:function(t){delete this._t[t]},b2:function(t,e,i,n,o,r,a){e.ab(t,i,0,0,r),n.ab(t,o,1,1,a)},a12:function(t,e,i){e.ar(t,0,0),i.ar(t,1,1)},c:function(){for(var t=0,e=this.x9();e.i1();e.i2())e.i9()._p=t++;this._y=!1},b1:function(){for(var t=0,e=this.xf();e.i1();e.i2())e.i8()._g=t++;this._u=!1},xs:function(t){t.as(this,this._z._b),t._p=this._v._c,this._v.a(t)},xt:function(t,e,i,n,o,r,a){t.a6(this,e,n,this._w._b),t._g=this._x._c,this._x.a(t),this.b2(t,t.a2(),i,t.a3(),o,r,a)}});var rr=function(){rr.superClass.constructor.call(this)};Me.ext(rr,or,{gb:function(t){return this.g1(t)},g7:function(t){return this.g2(t)},g5:function(t){var e=this.g1(t);return e.i1()+e.i3()/2},g6:function(t){var e=this.g1(t);return e.i2()+e.i4()/2},g4:function(t){return new Vn(this.g5(t),this.g6(t))},gi:function(t){return this.g1(t).i1()},gh:function(t){return this.g1(t).i2()},ga:function(t){var e=this.g1(t);return new Vn(e.i1(),e.i2())},gj:function(t){return this.g1(t).i3()},g9:function(t){return this.g1(t).i4()},gm:function(t){return new Un(this.gj(t),this.g9(t))},s1:function(t,e){this.s2(t,e.x,e.y)},s2:function(t,e,i){var n=this.g1(t);n.i5(e-n.i3()/2,i-n.i4()/2)},s7:function(t,e,i){this.g1(t).i6(e,i)},s8:function(t,e){this.s7(t,e.width,e.height)},s3:function(t,e,i){this.g1(t).i5(e,i)},s4:function(t,e){this.s3(t,e.x,e.y)},gp:function(t){for(var e=this.g2(t),i=new hn,n=0;n<e.i1();n++)i.add(e.i2(n));return new Gn(i)},gf:function(t){for(var e=this.g2(t),i=new fo,n=0;n<e.i1();n++)i.aa(e.i2(n));return i},gc:function(t){var e=new hn;e.add(this.gs(t));for(var i=this.gp(t).d();i.i1();i.i2())e.add(i.i6());return e.add(this.gl(t)),new Gn(e)},gd:function(t){var e=new fo;e.aa(this.gs(t));for(var i=this.gp(t).d();i.i1();i.i2())e.aa(i.i6());return e.aa(this.gl(t)),e},m1:function(t,e){var i=this.g2(t);i.i5();var n=e.ah(),o=n.i6();this.gx(t,o);var r=e.as();for(n.i2();n.i6()!==r;n.i2()){var a=n.i6();i.i4(a.x,a.y)}this.gy(t,r)},s5:function(t,e){var i=this.g2(t);i.i5();for(var n=e.d();n.i1();n.i2()){var o=n.i6();i.i4(o.x,o.y)}},s6:function(t,e){var i=this.g2(t);i.i5();for(var n=e.ah();n.i1();n.i2()){var o=n.i6();i.i4(o.x,o.y)}},m2:function(t,e,i){this.gx(t,e),this.gy(t,i)},gn:function(t){return this.g2(t).i6()},gk:function(t){return this.g2(t).i7()},gt:function(t,e){this.g2(t).i8(e)},gz:function(t,e){this.g2(t).i9(e)},gs:function(t){var e=this.g2(t).i6();return null==e?this.g4(t.a2()):new Vn(this.g5(t.a2())+e.x,this.g6(t.a2())+e.y)},gl:function(t){var e=this.g2(t).i7();return null==e?this.g4(t.a3()):new Vn(this.g5(t.a3())+e.x,this.g6(t.a3())+e.y)},gx:function(t,e){var i=new Vn(e.x-this.g5(t.a2()),e.y-this.g6(t.a2()));this.g2(t).i8(i)},gy:function(t,e){var i=new Vn(e.x-this.g5(t.a3()),e.y-this.g6(t.a3()));this.g2(t).i9(i)},g8:function(){for(var t=new po,e=this.xf();e.i1();e.i2())t.aa(e.i8());return t},g3:function(){for(var t,e,i=t=Number.MAX_VALUE,n=e=Number.MIN_VALUE,o=this.x9();o.i1();o.i2()){var r=this.ga(o.i9()),a=this.gm(o.i9());i=Math.min(r.x,i),t=Math.min(r.y,t),n=Math.max(r.x+a.width,n),e=Math.max(r.y+a.height,e)}for(var s=this.xf();s.i1();s.i2())for(var l=this.gp(s.i8()).c();l.i1();l.i2()){var h=l.i6();i=Math.min(h.x,i),t=Math.min(h.y,t),n=Math.max(h.x,n),e=Math.max(h.y,e)}return{x:Math.floor(i),y:Math.floor(t),width:Math.floor(n-i),height:Math.floor(e-t)}}});var ar=function(){ar.superClass.constructor.call(this),this.a(new Kn,new $n)};Me.ext(ar,rr,{a:function(t,e){this._a3=t,this._a4=e},xo:function(t,e){return this.l2(t,e,this._a4.a6())},l2:function(t,e,i){return this.l1(t,null,e,null,0,0,i)},xn:function(t,e,i,n,o,r){return this.l1(t,e,i,n,o,r,this._a4.a6())},l1:function(t,e,i,n,o,r,a){var s=new bo(this,t,e,i,n,o,r);return s._l=a,s},xm:function(){var t=new So(this);return t._r=this._a3.m3(),t},g3:function(){for(var t={x:0,y:0,width:-1,height:-1},e=this.x9();e.i1();e.i2())e.i9()._r.m1(t);return t},g1:function(t){return t._r},g2:function(t){return t._l},g5:function(t){return t._r.m4()},g6:function(t){return t._r.m5()},gi:function(t){return t._r.i1()},gh:function(t){return t._r.i2()},gj:function(t){return t._r.i3()},g9:function(t){return t._r.i4()},s2:function(t,e,i){t._r.m6(e,i)},s7:function(t,e,i){t._r.i6(e,i)},s3:function(t,e,i){t._r.i5(e,i)}});var sr=function(){sr.superClass.constructor.call(this),this._ap=this.xk(),this._as=this.xl()};Me.ext(sr,rr,{g1:function(t){var e=this._ap.i1(t);return null==e&&(e=new Co,this._ap.z1(t,e)),e},g2:function(t){var e=this._as.i1(t);return null==e&&(e=new Ao,this._as.i8(t,e)),e}});var lr=function(t){lr.superClass.constructor.call(this),this._ay=t,this._a0=this.xk(),this._au=this.xl()};Me.ext(lr,sr,{c2:function(t){return this._a0.i1(t)},a2:function(t,e){this._a0.z1(t,e)},h:function(){null==this._az&&(this._az=this.xk());for(var t=Ir.a(this._ay.x0()+1),e=1,i=this.x9();i.i1();){for(var n=this.c2(i.i9()),o=n.x1();o.i1();o.i2()){t[o.i9().al()]=e}for(var r=new po,a=n.x1();a.i1();a.i2())for(var s=a.i9(),l=t[s.al()],h=s.ap();h.i1();h.i2()){var c=h.i8(),u=c.a3(),d=t[u.al()];d===l&&r.ac(c)}this._az.z1(i.i9(),r),i.i2(),e++}},d1:function(t){return this._az.i1(t)},b:function(t){return this._au.i1(t)},a3:function(t,e){this._au.i8(t,e)},a1:function(){var t=this._ay.xk(),e=No.a4(Ir.a(this._ay.xh())),i=Jn.a1(this._ay,e,t),n=Jn.a5(this._ay,e,i);this.d2(t,n),this._ay.xi(t)},c1:function(t){for(var e=null,i=-1,n=0,o=t.length;o>n;n++){var r=t[n];r.ay()>i&&(e=r,i=r.ay())}return e},d2:function(t,e){for(var i=this._ay.xl(),n=this._ay.xk(),o=e.length,r=0;o>r;r++)for(var a=e[r],s=a.c1();s.i1();s.i2())i.i8(s.i8(),a);var l=this.c1(e);this.a4(l,t,i,new hn,n);var h={};o=e.length;for(var c=0;o>c;c++){var u=e[c];if(u.ay()>1){var d=this.xm();h[u._id]=d}}for(var f=this._ay.x9();f.i1();f.i2()){var p=f.i9();if(t.i4(p)&&null==n.i1(p)){var g=this.xm();h[p._id]=g;var _=new Po;_.aa(p),this.a2(g,_)}}var m=Ir.d(2);o=e.length;for(var v=0;o>v;v++){var y=e[v];if(1===y.ay()){var w=y.c2();m[0]=w.a2(),m[1]=w.a3();for(var b=0;2>b;b++){var x=m[b];if(1===x.ad()){var A=this.xm();h[x._id]=A;var C=new Po;C.aa(x),this.a2(A,C)}}}}for(var T=this._ay.x9();T.i1();T.i2()){var k=T.i9();if(null!=n.i1(k))for(var S=n.i1(k),E=h[S._id],I=k.af();I.i1();I.i2()){var L=I.i8();if(i.i1(L)!==S){var R=h[i.i1(L)._id];if(null==R){var P=L.a1(k),O=n.i1(P);R=null!=O?h[O._id]:h[P._id]}var D=E.aj(R),M=null;null==D?(D=this.xo(E,R),M=new po):M=this.b(D),M.aa(L),this.a3(D,M)}}else if(t.i4(k))for(var N=h[k._id],B=k.af();B.i1();B.i2()){var F=B.i8(),z=F.a1(k),V=h[z._id];if(null!=V){var U=N.aj(V);if(null==U){var j=this.xo(N,V),H=new po;H.aa(F),this.a3(j,H)}}}}if(2===this._ay.x0()&&1===this._ay.xg()){var W=this._ay.xf().i8(),G=h[W.a2()._id],Z=h[W.a3()._id];if(null!=Z&&null!=G&&null==Z.aj(G)){var X=this.xo(G,Z),Y=new po;Y.aa(W),this.a3(X,Y)}}var $=Ir.a(this._ay.x0());o=e.length;for(var q=0;o>q;q++){var K=e[q],J=h[K._id];if(null!=J){var Q=this.c2(J);null==Q&&(Q=new Po,this.a2(J,Q));for(var tt=K.c1();tt.i1();tt.i2()){var et=tt.i8(),it=et.a2();1===$[it.al()]||t.i4(it)&&n.i1(it)!==K||($[it.al()]=1,Q.aa(it)),it=et.a3(),1===$[it.al()]||t.i4(it)&&n.i1(it)!==K||($[it.al()]=1,Q.aa(it))}}}this._ay.xj(i),this._ay.xi(n)},a4:function(t,e,i,n,o){if(!n.contains(t)){n.add(t);for(var r=[],a=t.c1();a.i1();a.i2()){var s=a.i8();r[0]=s.a2(),r[1]=s.a3();for(var l=0;2>l;l++){var h=r[l];if(e.i4(h)&&null==o.i1(h)){t.ay()>1&&o.z1(h,t);for(var c=h.af();c.i1();c.i2()){var u=i.i1(c.i8());this.a4(u,e,i,n,o)}}}}}}});var hr=function(t,e,i,n,o){this._a={},hr.superClass.constructor.call(this);var r,a,s=new hn;for(r=0,a=e.size();a>r;r++){var l=e.get(r);if(l instanceof De.Link)s.add(l);else{var h=n&&null==o&&l instanceof Mn;h&&l.setExpanded(!0);var c=t.getDimension(l);if(h&&l.setExpanded(!1),null==c)continue;var u=this.xm(),d=t._repulsion;"rightleft"===i||"leftright"===i?this.s7(u,c.height*d,c.width*d):this.s7(u,c.width*d,c.height*d),u.node=l,this._a[l.getId()]=u}}for(r=0,a=s.size();a>r;r++){var f=s.get(r),p=f.getFromAgent(),g=f.getToAgent(),_=this._a[p.getId()],m=this._a[g.getId()];null!=_&&null!=m&&_!==m&&this.xo(_,m)}};Me.ext(hr,ar,{});var cr={};cr._D=new Gn,cr._E=new Vn(0,0),cr.b=function(t){if(t.i1()>0){for(var e=new hn,i=t.i1()-1;i>=0;i--)e.add(t.i2(i));t.i5();for(var n=0,o=e.size();o>n;n++){var r=e.get(n);t.i4(r.x,r.y)}}var a=t.i6();t.i8(t.i7()),t.i9(a)},cr.c=function(t){cr.d(t,!0)},cr.d=function(t,e){if(e)for(var i=t.xf();i.i1();i.i2()){var n=i.i8();t.gt(n,cr._E),t.gz(n,cr._E),t.s5(n,cr._D)}else for(var o=t.xf();o.i1();o.i2())t.s5(o.i8(),cr._D)},cr.e=function(t){for(var e=new Vn(0,0),i=t.xf();i.i1();i.i2()){var n=i.i8();t.gt(n,e),t.gz(n,e)}},cr.f=function(t,e,i,n){for(var o=t.gc(e).b(),r=Ir.d(o),a=0,s=t.gc(e).c();s.i1();s.i2()){var l=s.i6();(0>=a||!l.equals(r[a-1]))&&(r[a]=new Vn(l.x,l.y),a++)}if(!(2>(o=a))){var h=new hn,c=new jn(r[1].x-r[0].x,r[1].y-r[0].y),u=cr.i(c);u.x*=n,u.y*=n;for(var d=cr.h(r[0],u),f=cr.h(r[1],u),p=new Wn(d,f),g=1;o-1>g;g++){var _=p,m=cr.i(new jn(r[g+1].x-r[g].x,r[g+1].y-r[g].y));m.x*=n,m.y*=n;var v=cr.h(r[g],m),y=cr.h(r[g+1],m);p=new Wn(v,y);var w=Wn.a6(_,p);null!=w&&h.add(new Vn(w.x,w.y))}var b=new jn(r[o-1].x-r[o-2].x,r[o-1].y-r[o-2].y);b=cr.i(b),b.x*=n,b.y*=n;var x=cr.h(r[o-1],b),A=new Gn(h);e.a2()===i.a2()?(t.s5(i,A),t.m2(i,d,x)):(t.s5(i,A.a()),t.m2(i,x,d))}},cr.g=function(t,e,i,n){for(var o=n,r=i.c1();r.i1();r.i2()){var a=r.i8();cr.f(t,e,a,o),0>o&&(o-=n),o=-o}},cr.a=function(t,e,i){return cr.j(t,e,i,1)},cr.l=function(t,e,i){if(null==t||t.length<1)return null!=e&&(e.x=0,e.y=0,e.width=0,e.height=0),{width:0,height:0};for(var n=0,o=0,r=0;r<t.length;r++){var a=t[r];n=Math.max(n,a.width),o=Math.max(o,a.height)}var s,l,h=n*o*t.length,c=Math.sqrt(h/i),u=h/c,d=Math.floor(u/n),f=Math.ceil(u/n),p=Math.ceil(t.length/d),g=Math.ceil(t.length/f);f*g>d*p?(s=d,l=p):(s=f,l=g);var _,m=0,v=0,y=0,w=0;if(n>o)for(var b=0;b<t.length;b++)_=t[b],_.x=v*n,_.y=m*o,y=Math.max(y,_.x+_.width),w=Math.max(w,_.y+_.height),++v>=s&&(m++,v=0);else for(var x=0;x<t.length;x++)_=t[x],_.x=v*n,_.y=m*o,y=Math.max(y,_.x+_.width),w=Math.max(w,_.y+_.height),++m>=l&&(v++,m=0);return null!=e&&(e.x=0,e.y=0,e.width=y,e.height=w),{width:l,height:s}},cr.j=function(t,e,i,n){if(null==t||t.length<1)return null!=e&&(e.x=0,e.y=0,e.width=0,e.height=0),0;for(var o,r,a=o=t[0].width,s=r=t[0].height,l=t.length,h=1;l>h;h++){var c=t[h].width;a=Math.min(a,c),o=Math.max(o,c);var u=t[h].height;s=Math.min(s,u),r=Math.max(r,u)}if(s/r>.95&&a/o>.95)return cr.l(t,e,i).width;for(var d=new fo,f=0,p=0;l>p;p++){var g=t[p];d.aa(t[p]),f=Math.floor(f+g.width*g.height)}d.a1(function(t,e){var i=Math.floor(e.height)-Math.floor(t.height);return 0===i?Math.floor(e.width)-Math.floor(t.width):i});var _=0,m=0,v=Math.floor(i*Math.sqrt(f/i)),y=v,w=0,b=new fo;do{var x=new fo;b.aa(x);for(var A,C,T=A=C=0,k=d.ah();k.i1();k.i2()){var S=k.i6();T+S.width>y&&x.ay()>0?(C=Math.max(C,T),x=new fo,x.aa(S),b.aa(x),T=Math.floor(S.width)):(x.aa(S),T=Math.floor(T+S.width)),1===x.ay()&&(A=Math.floor(A+x.am().height))}C=Math.max(C,T),i*A>C&&w!==C&&(b.af(),y=Math.floor(1.1*y),w=C)}while(b.ar());for(var E=0,I=b.ah();I.i1();I.i2()){for(var L=0,R=I.i6(),P=R.ah();P.i1();P.i2()){var O=P.i6();O.x=L,O.y=E,L+=O.width}_=Math.max(_,L),E+=cr.k(R),m=Math.max(m,E)}return null!=e&&(e.x=0,e.y=0,e.width=_,e.height=m),b.ay()},cr.k=function(t){for(var e=0,i=t.ah();i.i1();i.i2())e=Math.max(i.i6().height,e);return e},cr.h=function(t,e){return new Vn(t.x+e.x,t.y+e.y)},cr.i=function(t){var e=Math.sqrt(t.x*t.x+t.y*t.y);return new jn(-t.y/e,t.x/e)};var ur=function(t){this._a=t,this._b=!1};Me.ext(ur,Object,{a:function(){return this._b},b:function(){return this._a},c:function(){return 1===this._a},d:function(){return 2===this._a},e:function(){return 4===this._a},f:function(){return 8===this._a},g:function(){return 0===this._a}}),ur.h=function(t,e){var i=t.xc("A");return null==i?null:i.i1(e)},ur.i=function(t,e){var i=t.xc("B");return null==i?null:i.i1(e)},ur.j=function(t){switch(t){case 1:return ur.k;case 2:return ur.l}return null},ur.k=new ur(1),ur.l=new ur(2);var dr=function(t,e,i,n,o){this._o=0,this._l=0,this._i=0,this._d=0,this._f=0,this._b=t,this._a=1e-4,this._r=e,this._p=1,this._e=(o.gj(t)+o.g9(t))/4;var r=.45*i*Math.sqrt(n);this._k=ir.l(-r,r),this._h=ir.l(-r,r),this._g=ir.l(-r,r)};Me.ext(dr,Object,{});var fr=function(){this._a=0,this._c=0,this._b=0};Me.ext(fr,Object,{});var pr=function(){pr.superClass.constructor.call(this),this._dj=0,this._dh=0,this._dq=0,this._dp=0,this._dt=0,this._de=0,this._d3=0,this._dr=0,this._ed=0,this._dw=.65,this._ea=1,this._dl=80,this._dx=3,this._d8=!0,this._eb=3e5,this._ee=2,this._di=2,this._df=1e3};Me.ext(pr,zo,{i4:function(t){return!0},i3:function(t){if(null!=t&&(this._d5=t,this.s(t))){var e=new fr,i=0,n=Math.floor(this._dx*this._dz.length*this._dz.length+20*this._dz.length);n=Math.max(n,1e4);var o=this._ea*this._ea*this._dz.length,r=this._df;try{for(;this._dj>o&&n>i;i++){var a=this.b(2147483647&i);0==r--&&(this._dy.b()>this._eb&&(i=n),r=this._df),this.h(a,e),this.d(a,e),this.i(a,e),this._d8?(this.g(a,e),this.j(a,e)):(this.f(a,e),this.c(a,e));var s=Math.sqrt(e._a*e._a+e._c*e._c+e._b*e._b);this.ac(a,e,s),this.aa(a,e,s)}}catch(t){}finally{this.r()}}},s:function(t){if(null==t||t.xa()<1)return!1;this._d5=t,this._dp=1,this._dy=new er,this._dt=t.x0(),this._d2=Ir.d(this._dt),this._df=1+1e5/this._dt,this._ed=1/(2*this._di),this._de=this._ed*this._ee/(.05*this._dl),this._d3=Math.pow(this._dl,-1)*this._ed,this._dr=Math.pow(this._dl,3)*this._ed,this._dj=0,this._du=new fr,this._dq=Math.max(20*this._dl,10);var e=Math.max(.1,Math.min(this._dw*this._dl,this._dq)),i=this._dt;cr.c(t),this._dz=Ir.d(i);for(var n=t.x9();n.i1();n.i2()){var o=n.i9(),r=new dr(o,e,this._dl,this._dt,t);this._dz[--i]=r,this._dj+=r._r,this._dh+=r._r*r._r,this._du._a+=r._k,this._du._c+=r._h,this._du._b+=r._g,this._d2[o.al()]=r}return this._d8=!1,this._dz.length>0},b:function(t){var e=this._dz.length,i=e-t%e-1,n=ir.k(i+1),o=this._dz[n];return this._dz[n]=this._dz[i],this._dz[i]=o,o},f:function(t,e){for(var i,n,o=i=n=0,r=t._b.ae();null!=r;r=r.a7()){var a,s=this._d2[r.a2().al()],l=s._k-t._k,h=s._h-t._h,c=s._g-t._g,u=l*l+h*h+c*c,d=Math.sqrt(u),f=d-(s._e+t._e);0>=f||(a=f*f*this._d3/d,o+=l*a,i+=h*a,n+=c*a)}for(var p=t._b.ag();null!=p;p=p.a8()){var g,_=this._d2[p.a3().al()],m=_._k-t._k,v=_._h-t._h,y=_._g-t._g,w=m*m+v*v+y*y,b=Math.sqrt(w),x=b-(_._e+t._e);0>=x||(g=x*x*this._d3/b,o+=m*g,i+=v*g,n+=y*g)}e._a+=o,e._c+=i,e._b+=n},g:function(t,e){var i,n,o=i=n=0;this._dp++,t._f=this._dp;for(var r=t._b.ae();null!=r;r=r.a7()){var a=this._d2[r.a2().al()];a._f=this._dp;var s=a._k-t._k,l=a._h-t._h,h=a._g-t._g,c=s*s+l*l+h*h,u=Math.sqrt(c);if(0!==u){var d=Math.max(1e-6,u-(t._e+a._e)),f=-this._ef[r.a5()]/(d*d);f+=d*d*this._d1[r.a5()],f/=u,o+=s*f,i+=l*f,n+=h*f}}for(var p=t._b.ag();null!=p;p=p.a8()){var g=this._d2[p.a3().al()];g._f=this._dp;var _=g._k-t._k,m=g._h-t._h,v=g._g-t._g,y=_*_+m*m+v*v,w=Math.sqrt(y);if(0!==w){var b=Math.max(1e-6,w-(t._e+g._e)),x=-this._ef[p.a5()]/(b*b);x+=b*b*this._d1[p.a5()],x/=w,o+=_*x,i+=m*x,n+=v*x}}e._a+=o,e._c+=i,e._b+=n},j:function(t,e){for(var i,n,o=i=n=0,r=this._dt-1;r>=0;r--){var a=this._d2[r];if(a._f!==t._f){var s=t._k-a._k,l=t._h-a._h,h=t._g-a._g,c=s*s+l*l+h*h;if(0!==c){var u=Math.sqrt(c),d=Math.max(1e-6,u-(t._e+a._e)),f=this._dr/(d*d*u);o+=s*f,i+=l*f,n+=h*f}}}e._a+=o,e._c+=i,e._b+=n},c:function(t,e){for(var i,n,o=i=n=0,r=this._dt-1;r>=0;r--){var a=this._d2[r],s=t._k-a._k,l=t._h-a._h,h=t._g-a._g,c=s*s+l*l+h*h;if(0!==c){var u,d=Math.sqrt(c),f=d-(t._e+a._e);u=0>=f?this._dr/(1e-8*d):this._dr/(f*f*d),o+=s*u,i+=l*u,n+=h*u}}e._a+=o,e._c+=i,e._b+=n},i:function(t,e){var i=this._du._b/this._dt-t._g;e._b+=i*this._dl*this._dt/this._dh},d:function(t,e){if(0!==this._de){var i=this._du._a/this._dt-t._k,n=this._du._c/this._dt-t._h,o=this._du._b/this._dt-t._g;e._a+=i*this._de,e._c+=n*this._de,e._b+=o*this._de}},h:function(t,e){var i=.05*(t._r+2);i>0&&(e._a=ir.l(-i,i),e._c=ir.l(-i,i),e._b=ir.l(-i,i))},ac:function(t,e,i){if(0!==i&&0!==t._a){var n=e._a*t._o+e._c*t._l+e._b*t._i,o=n/(i*t._a);this._dh-=t._r*t._r,this._dj-=t._r,t._r+=t._p*o>0?.45*o:.15*o,t._r>this._dq?t._r=this._dq:t._r<.1&&(t._r=.1),this._dj+=t._r,this._dh+=t._r*t._r,t._p=o}},aa:function(t,e,i){if(i>0){var n=t._r/i,o=e._a*n,r=e._c*n,a=e._b*n;t._k+=o,t._h+=r,t._g+=a,this._du._a+=o,this._du._c+=r,this._du._b+=a,t._a=i,t._o=e._a,t._l=e._c,t._i=e._b}},r:function(){for(var t=this._d2.length-1;t>=0;t--){var e=this._d2[t];this._d5.s2(e._b,e._k,e._h)}}});var gr=function(t,e,i,n){this._e=t,this._f=e,this._a=i,this._b=n,this._c={}};Me.ext(gr,Object,{resetGroup:function(){if(this._a&&null==this._b)for(var t in this._c){var e=this._c[t];e.group.setExpanded(!!this._e.isExpandGroup()||e.b)}},process:function(){for(var t=new hn,e=0,i=this._f.size();i>e;e++){var n=this._f.get(e);if(n instanceof De.Link)n.isLooped()||t.add(n);else{if(null==this._b&&n.getParent()instanceof Mn)continue;(null==this._b||null!=this._b&&this._b!==n)&&t.add(n),null==this._b&&n instanceof Mn&&this.layoutGroup(n)}}return t},layoutGroup:function(t){if(this._a&&null==this._c[t.getId()]&&null==this._b){this._c[t.getId()]={group:t,b:t.isExpanded()};var e=this._e.getGroupLayoutType(t);if(e){t.setExpanded(!0);for(var i,n=new hn,o=t.getChildren(),r=0,a=o.size();a>r;r++)if(i=o.get(r),i instanceof Mn&&(this.layoutGroup(i),i.setExpanded(!1)),i instanceof De.Link||n.contains(i)||n.add(i),i instanceof On){var s=i.getLinks();if(null!=s)for(var l=0,h=s.size();h>l;l++){var c=s.get(l);n.contains(c)||n.add(c)}}var u=new hr(this._e,n,e,this._a,this._b);try{var d=null;if("round"===e?d=new tr:"symmetry"===e?d=new pr:"hierarchic"===e?d=new Cr:("topbottom"===e||"bottomtop"===e||"rightleft"===e||"leftright"===e)&&(d=new Vo),null!=d){d.i2(u);var f=gr.createMatrix(e),p={},g={};for(var _ in u._a){var m=u._a[_],v=m.node,y=u.g4(m);if(p[_]=v.getCenterLocation(),null!=f){var w=f.transform(y);v.setCenterLocation(w.x,w.y)}else v.setCenterLocation(y.x,y.y);g[_]=v.getCenterLocation()}}}catch(t){}for(o=t.getChildren(),r=0,a=o.size();a>r;r++)(i=o.get(r))instanceof Mn&&i.setExpanded(!0)}}}}),gr.createMatrix=function(t){return"rightleft"===t?We.createMatrix(Math.PI/2,0,0):"leftright"===t?We.createMatrix(-Math.PI/2,0,0):"bottomtop"===t?We.createMatrix(Math.PI,0,0):null};var _r=function(){};Me.ext(_r,Object,{i1:function(t,e,i){var n=this.a1(t,e);return this.a2(t,e,i),n},a1:function(t,e){var i=_r.i4(t);i.ax();for(var n=0,o=i.x1();o.i1();o.i2())e.i7(o.i9(),-1);for(var r=i.x1();r.i1();r.i2()){for(var a=r.i9(),s=-1,l=a.aq();l.i1();l.i2())s=Math.max(s,e.i2(l.i9()));e.i7(a,s+1),n=Math.max(n,s+1)}return n+1},a2:function(t,e,i){i.az(_r.i3(t,e))}}),_r.i3=function(t,e){for(var i=new po,n=t.xf();n.i1();n.i2()){var o=n.i8();e.i2(o.a2())>e.i2(o.a3())&&(t.x3(o),i.ac(o))}return i},_r.i4=function(t){var e=Ir.a(t.xa());return(new oo).a1(t,e),_r.i2(t,e)},_r.i2=function(t,e){for(var i=Ir.d(t.x0()),n=t.x9();n.i1();n.i2()){var o=n.i9();i[e[o.al()]]=o}return new Po(i)};var mr=function(){mr.superClass.constructor.call(this),this.c0()};Me.ext(mr,po,{c0:function(){this._bc=1,this._bd=0}});var vr=function(){this._m1=20,this._m2=60,this._m3=5,this._m4=0};Me.ext(vr,Object,{i4:function(t){this._m3=t},i5:function(t){this._m4=t},i3:function(t){this._m1=t},i6:function(t){this._m2=t},i2:function(t){this._m5=t},t1:function(){return this._m2},a1:function(t,e){for(var i=Ir.d(e.length),n=0;n<e.length;n++)i[n]=e[n].x1();this.a2(t,i)},a2:function(t,e){for(var i=Ir.a(e.length),n=0,o=0;o<e.length;o++){var r=0,a=e[o];for(a.i4();a.i1();a.i2())r=Math.max(r,t.g9(a.i9()));for(i[o]=r,a.i4();a.i1();a.i2()){var s=(i[o]-t.g9(a.i9()))/2;t.s4(a.i9(),new Vn(t.gi(a.i9()),n+s))}var l=this.t1();n+=i[o]+l,a.i4()}},i1:function(t,e,i){this._m6=t,this.t2(e,i)}});var yr=function(t,e){yr.superClass.constructor.call(this)};Me.ext(yr,vr,{t2:function(t,e){var i=this._m6;this._a=i.xc("D"),this._h=i.xc("C"),this.a1(i,t),this.tg(i,t),this.tf(t,No.a5(this._e),this._m5,this._l),this.tb(i,this._f[0]),this.ta(t),this.th(i,this._f[0],t),this.b(t),this.tb(i,this._f[1]),this.ta(t),this.th(i,this._f[1],t),this.b(t),this.a11(this._f[1]),this.a12(t),this.tb(i,this._f[2]),this.ta(t),this.th(i,this._f[2],t),this.b(t),this.tb(i,this._f[3]),this.ta(t),this.th(i,this._f[3],t),this.b(t),this.a11(this._f[3]),this.a12(t),this.tc(i),this.tj()},a11:function(t){for(var e=0;e<t.length;e++)t[e]=-t[e]},b:function(t){for(var e=0;e<t.length;e++){t[e].ax()}for(var i=0;i<t.length;i++)for(var n=0,o=null,r=t[i].x1();r.i1();r.i2()){var a=r.i9(),s=a.al();this._l[s]=n++,this._b[s]=o,this._k[s]=null,null!=o&&(this._k[o.al()]=a),o=a}var l=this._a;this._a=this._h,this._h=l;for(var h=this._m6.xf();h.i1();h.i2()){var c=h.i8(),u=this._m6.gn(c);this._m6.gt(c,new Vn(-u.x,u.y));var d=this._m6.gk(c);this._m6.gz(c,new Vn(-d.x,d.y))}var f=this._l,p=function(t,e){return null==t&&null!=e?1:null!=t&&null==e?-1:null==t&&null==e?0:f[t.a2().al()]-f[e.a2().al()]},g=function(t,e){return null==t&&null!=e?1:null!=t&&null==e?-1:null==t&&null==e?0:f[t.a3().al()]-f[e.a3().al()]};this._m6.x2(p,g)},a12:function(t){for(var e=this._m6.xf();e.i1();e.i2()){var i=e.i8();this._m6.x3(i);var n=this._m6.gn(i),o=this._m6.gk(i);this._m6.gz(i,n),this._m6.gt(i,o)}for(var r=new fo,a=0;a<t.length;a++)r.ae(t[a]);for(var s=0;s<t.length;s++)t[s]=r.au();var l=this._l,h=function(t,e){return null==t&&null!=e?1:null!=t&&null==e?-1:null==t&&null==e?0:l[t.a2().al()]-l[e.a2().al()]},c=function(t,e){return null==t&&null!=e?1:null!=t&&null==e?-1:null==t&&null==e?0:l[t.a3().al()]-l[e.a3().al()]};this._m6.x2(h,c)},tg:function(t,e){var i=t.x0(),n=t.xg();this._l=Ir.a(i),this._b=Ir.d(i),this._k=Ir.d(i),this._m=Ir.d(i),this._i=Ir.d(i),this._o=Ir.d(i),this._f=Ir.e(4,i),this._c=Ir.a(i),this._g=Ir.a(i),this._j=Ir.a(i),this._d=Ir.b(i),this._e=Ir.b(n);for(var o=0;o<e.length;o++)for(var r=0,a=null,s=e[o].x1();s.i1();s.i2()){var l=s.i9(),h=l.al();this._l[h]=r++,this._b[h]=a,this._k[h]=null,null!=a&&(this._k[a.al()]=l),a=l}var c=this._l,u=function(t,e){return null==t&&null!=e?1:null!=t&&null==e?-1:null==t&&null==e?0:c[t.a2().al()]-c[e.a2().al()]},d=function(t,e){return null==t&&null!=e?1:null!=t&&null==e?-1:null==t&&null==e?0:c[t.a3().al()]-c[e.a3().al()]};t.x2(u,d)},tb:function(t,e){for(var i=t.x9();i.i1();i.i2()){var n=i.i9(),o=n.al();this._m[o]=n,this._i[o]=n,e[o]=Number.MAX_VALUE,this._o[o]=n,this._c[o]=Number.MAX_VALUE,this._d[o]=!1,this._j[o]=this._g[o]=0}},ta:function(t){for(var e=1;e<t.length;e++)for(var i=-1,n=t[e]._b;null!=n;n=n.a()){var o=n.d(),r=o.al(),a=o.ak();if(0!==a){var s,l=Math.floor((a+1)/2),h=Math.ceil((a+1)/2),c=1;for(s=o.ae();l>c;s=s.a7())c++;for(var u=!1;h>=c&&!u;c++){var d=this._m6.g2(s),f=s.a2(),p=f.al();this._i[r]===o&&!this._e[s.a5()]&&i<this._l[p]&&(i=this._l[p],this._i[p]=o,this._m[r]=this._m[p],this._i[r]=this._m[r],u=!0,this._j[p]=d.i6().x,this._g[r]=d.i7().x),s=s.a7()}}}},th:function(t,e,i){for(var n=t.x9();n.i1();n.i2()){var o=n.i9(),r=o.al();this._m[r]===o&&this.td(t,o,e)}for(var a=0;a<i.length;a++){if(i[a].x1().i1()){var s=i[a].x1().i9(),l=s.al();this._o[this._m[l].al()]===s&&this.tk(t,s,e)}}for(var h=t.x9();h.i1();h.i2()){var c=h.i9(),u=c.al(),d=this._c[this._o[this._m[u].al()].al()];d<Number.MAX_VALUE&&(e[u]+=d)}},td:function(t,e,i){var n=e.al();if(i[n]===Number.MAX_VALUE){i[n]=0;var o=e,r=0;do{var a=o.al();if(a!==n&&(r-=this._g[a]),this._l[a]>0){var s=this._b[a],l=this._m[this._b[a].al()],h=l.al();this.td(t,l,i),this._o[n]===e&&(this._o[n]=this._o[h]),this._o[n]===this._o[h]&&(i[n]=Math.max(i[n],i[s.al()]+this.ti(t,s,o)-r))}r+=this._j[a],o=this._i[a]}while(o!==e);r=0,o=e;do{var c=o.al();c!==n&&(r-=this._g[c]),i[c]=i[n]+r,r+=this._j[c],o=this._i[c]}while(o!==e)}},tk:function(t,e,i){var n=e.al();if(!this._d[n]){this._d[n]=!0;var o=e;do{var r=o.al(),a=this._k[r];if(null!=a){var s=a.al(),l=this._o[this._m[s].al()];if(l!==this._o[n]){var h=i[s]-i[n]-this.ti(t,o,a);this._c[l.al()]!==Number.MAX_VALUE&&(h+=this._c[l.al()]),this._c[this._o[n].al()]=Math.min(this._c[this._o[n].al()],h)}else this.tk(t,this._m[s],i)}o=this._i[r]}while(o!==e)}},tc:function(t){for(var e=Ir.a(4),i=Ir.a(4),n=t.x9();n.i1();n.i2()){var o=n.i9(),r=o.al();i[0]+=this._f[0][r],i[1]+=this._f[1][r],i[2]+=this._f[2][r],i[3]+=this._f[3][r]}i[0]/=t.xa(),i[1]/=t.xa(),i[2]/=t.xa(),i[3]/=t.xa();for(var a=t.x9();a.i1();a.i2()){var s=a.i9(),l=s.al(),h=t.g4(s);e[0]=this._f[0][l]-i[0],e[1]=this._f[1][l]-i[1],e[2]=this._f[2][l]-i[2],e[3]=this._f[3][l]-i[3],e.sort(Ir.n);var c=(e[1]+e[2])/2;t.s1(s,new Vn(c,h.y))}},ti:function(t,e,i){var n,o=t.gj(e),r=t.gj(i);return n=o>1&&r>1?this._m1+(o+r)/2:this._m3+(o+r)/2,this._l[e.al()]<this._l[i.al()]?(null!=this._a&&(n+=this._a.i3(i)),null!=this._h&&(n+=this._h.i3(e))):(null!=this._a&&(n+=this._a.i3(e)),null!=this._h&&(n+=this._h.i3(i))),n},tj:function(){this._l=null,this._b=null,this._k=null,this._e=null,this._m=null,this._i=null,this._f=null,this._c=null,this._o=null,this._d=null,this._j=null,this._g=null},tf:function(t,e,i,n){for(var o=t.length,r=2;o-1>r;r++)for(var a=-1,s=0,l=0,h=t[r].x1(),c=t[r].x1();c.i1();c.i2()){var u=c.i9(),d=null,f=!1;if(1===u.ak()&&(d=u.ae().a2(),null!=i.i1(d)&&null!=i.i1(u)&&(f=!0)),l===t[r].ay()-1||f){for(var p=f?n[d.al()]:t[r-1].ay();l>=s;s++){for(var g=h.i9(),_=g.am();_.i1();_.i2()){var m=_.i8(),v=n[m.a2().al()];(a>v||v>p)&&e.i7(_.i8(),!0)}h.i2()}a=p}l++}}});var wr=function(t,e){this._b=20,this._a=e,this._d=t,this._f={}};Me.ext(wr,Object,{a3:function(t){this._b=t},a4:function(t,e,i,n,o){if(this.a2(t)){var r=this.b2(t);r._o=e,r._m=o,r._n=n,r._f=i}},b2:function(t){var e=this._f[t._id];return null==e&&(e=new br,this._f[t._id]=e),e},a2:function(t){return null!=this._f[t._id]},c:function(){for(var t=No.a1(Ir.a(this._d.xa())),e=No.a1(Ir.a(this._d.xa())),i=this._d.x9();i.i1();i.i2()){var n=i.i9();if(this.a2(n)){var o=this.b2(n);t.i6(n,this._b*(o.c()-1)),e.i6(n,this._b*(o.b()-1))}}this._d.x1("D",t),this._d.x1("C",e)},g:function(){this._d.x6("D"),this._d.x6("C")},f:function(){for(var t=this._d.x9();t.i1();t.i2()){var e=t.i9();if(this.a2(e)){var i=this._d.gi(e),n=this._d.gh(e),o=this._d.gj(e),r=this._d.g9(e),a=this.b2(e),s=a._q.ay()+a._b.ay()+a._f,l=a._d.ay()+a._g.ay()+a._o,h=a._i.ay()+a._l.ay()+a._n,c=a._h.ay()+a._k.ay()+a._m,u=this._a.a7(o,s),d=this._a.a7(o,l),f=this._a.a7(r,c),p=this._a.a7(r,h);a.a2(this._a.a8(o,s,u),this._a.a8(o,l,d),this._a.a8(r,c,f),this._a.a8(r,h,p));for(var g=a._j.c1();g.i1();g.i2()){var _=g.i8(),m=this.a1(_),v=this.b1(_),y=new fo;m.b()===v.b()?(m.c()?(y.aa(new Vn(i+a._g._bd*d+a._c,n)),y.aa(new Vn(i+a._g._bd*d+a._c,n-this._b)),a._g._bd++,y.aa(new Vn(i+a._g._bd*d+a._c,n-this._b)),y.aa(new Vn(i+a._g._bd*d+a._c,n)),a._g._bd++,a._g._bc=Math.max(a._g._bc,2)):m.d()?(y.aa(new Vn(i+a._b._bd*u+a._p,n+r)),y.aa(new Vn(i+a._b._bd*u+a._p,n+r+this._b)),a._b._bd++,y.aa(new Vn(i+a._b._bd*u+a._p,n+r+this._b)),y.aa(new Vn(i+a._b._bd*u+a._p,n+r)),a._b._bd++,a._b._bc=Math.max(a._b._bc,2)):m.f()?(y.aa(new Vn(i,n+a._i._bd*p+a._a)),y.aa(new Vn(i-this._b,n+a._i._bd*p+a._a)),a._i._bd++,y.aa(new Vn(i-this._b,n+a._i._bd*p+a._a)),y.aa(new Vn(i,n+a._i._bd*p+a._a)),a._i._bd++,a._i._bc=Math.max(a._i._bc,2)):m.e()&&(y.aa(new Vn(i+o,n+a._h._bd*f+a._e)),y.aa(new Vn(i+o+this._b,n+a._h._bd*f+a._e)),a._h._bd++,y.aa(new Vn(i+o+this._b,n+a._h._bd*f+a._e)),y.aa(new Vn(i+o,n+a._h._bd*f+a._e)),a._h._bd++,a._h._bc=Math.max(a._h._bc,2)),this._d.m1(_,y)):m.c()||v.c()?m.e()||v.e()?(y.aa(new Vn(i+o-a._d._bd*d-a._c,n)),y.aa(new Vn(i+o-a._d._bd*d-a._c,n-this._b*a._d._bc)),y.aa(new Vn(i+o+this._b*a._h._bc,n-this._b*a._d._bc)),y.aa(new Vn(i+o+this._b*a._h._bc,n+a._h._bd*f+a._e)),y.aa(new Vn(i+o,n+a._h._bd*f+a._e)),a._d._bd++,a._d._bc++,a._h._bd++,a._h._bc++,v.c()&&y.ax(),this._d.m1(_,y)):m.f()||v.f()?(y.aa(new Vn(i+a._g._bd*d+a._c,n)),y.aa(new Vn(i+a._g._bd*d+a._c,n-this._b*a._g._bc)),y.aa(new Vn(i-this._b*a._i._bc,n-this._b*a._g._bc)),y.aa(new Vn(i-this._b*a._i._bc,n+a._i._bd*p+a._a)),y.aa(new Vn(i,n+a._i._bd*p+a._a)),a._g._bd++,a._g._bc++,a._i._bd++,a._i._bc++,v.c()&&y.ax(),this._d.m1(_,y)):(m.d()||v.d())&&(y.aa(new Vn(i+o-a._d._bd*d-a._c,n)),y.aa(new Vn(i+o-a._d._bd*d-a._c,n-this._b*a._d._bc)),y.aa(new Vn(i+o+this._b*a.b(),n-this._b*a._d._bc)),y.aa(new Vn(i+o+this._b*a.b(),n+r+this._b*a._q._bc)),y.aa(new Vn(i+o-a._q._bd*u-a._p,n+r+this._b*a._q._bc)),y.aa(new Vn(i+o-a._q._bd*u-a._p,n+r)),a._d._bd++,a._d._bc++,a._k._bc++,a._h._bc++,a._q._bc++,a._q._bd++,v.c()&&y.ax(),this._d.m1(_,y)):m.d()||v.d()?m.e()||v.e()?(y.aa(new Vn(i+o-a._q._bd*u-a._p,n+r)),y.aa(new Vn(i+o-a._q._bd*u-a._p,n+r+this._b*a._q._bc)),y.aa(new Vn(i+o+this._b*a._k._bc,n+r+this._b*a._q._bc)),y.aa(new Vn(i+o+this._b*a._k._bc,n+r-a._k._bd*f-a._e)),y.aa(new Vn(i+o,n+r-a._k._bd*f-a._e)),a._q._bd++,a._q._bc++,a._k._bd++,a._k._bc++,v.d()&&y.ax(),this._d.m1(_,y)):(m.f()||v.f())&&(y.aa(new Vn(i+a._b._bd*u+a._p,n+r)),y.aa(new Vn(i+a._b._bd*u+a._p,n+r+this._b*a._b._bc)),y.aa(new Vn(i-this._b*a._l._bc,n+r+this._b*a._b._bc)),y.aa(new Vn(i-this._b*a._l._bc,n+r-a._l._bd*p-a._a)),y.aa(new Vn(i,n+r-a._l._bd*p-a._a)),a._b._bd++,a._b._bc++,a._l._bd++,a._l._bc++,v.d()&&y.ax(),this._d.m1(_,y)):(y.aa(new Vn(i,n+r-a._l._bd*p-a._a)),y.aa(new Vn(i-this._b*a._l._bc,n+r-a._l._bd*p-a._a)),y.aa(new Vn(i-this._b*a._l._bc,n+r+this._b*a.a1())),y.aa(new Vn(i+o+this._b*a._k._bc,n+r+this._b*a.a1())),y.aa(new Vn(i+o+this._b*a._k._bc,n+r-a._k._bd*f-a._e)),y.aa(new Vn(i+o,n+r-a._k._bd*f-a._e)),a._l._bd++,a._l._bc++,a._b._bc++,a._q._bc++,a._k._bc++,a._k._bd++,v.f()&&y.ax(),this._d.m1(_,y))}}}},a5:function(t,e){for(var i=0;i<t.length;i++)for(var n=t[i],o=e[i],r=n.x1();r.i1();r.i2()){var a=r.i9();if(this.a2(a)){var s=this.b2(a);o._g=Math.max(o._g,this._b*(s.d()-1)),o._j=Math.max(o._j,this._b*(s.a1()-1))}}},a1:function(t){var e=this._d.xc("A"),i=null;if(null!=e&&(i=e.i1(t)),null==i||i.g()){var n=this._d.xc("B");if(null==n)return ur.j(1);var o=n.i1(t);if(null==o||o.g())return ur.j(1);if(o.c())return ur.j(8);if(o.f())return ur.j(1);if(o.d())return ur.j(4);if(o.e())return ur.j(2)}return i},b1:function(t){var e=this._d.xc("B"),i=null;if(null!=e&&(i=e.i1(t)),null==i||i.g()){var n=this._d.xc("A");if(null==n)return ur.j(8);var o=n.i1(t);if(null==o||o.g())return ur.j(8);if(o.c())return ur.j(8);if(o.f())return ur.j(1);if(o.d())return ur.j(4);if(o.e())return ur.j(2)}return i}});var br=function(){this._o=0,this._f=0,this._n=0,this._m=0,this._c=0,this._p=0,this._e=0,this._a=0,this._j=new po,this._g=new mr,this._d=new mr,this._b=new mr,this._q=new mr,this._h=new mr,this._k=new mr,this._i=new mr,this._l=new mr};Me.ext(br,Object,{a1:function(){return Math.max(this._q._bc,this._b._bc)},d:function(){return Math.max(this._d._bc,this._g._bc)},b:function(){return Math.max(this._k._bc,this._h._bc)},c:function(){return Math.max(this._l._bc,this._i._bc)},a2:function(t,e,i,n){this._c=e,this._a=n,this._p=t,this._e=i,this._g.c0(),this._d.c0(),this._b.c0(),this._q.c0(),this._k.c0(),this._h.c0(),this._l.c0(),this._i.c0()}});var xr=function(t,e,i,n){this._k=20,this._r=.5,this._d=t,this._c=e,this._j=i,this._m=n,this._i=null!=t.xc("A")||null!=t.xc("B"),this._t=new Tr(t,e,i,n),this._b=new wr(t,this)};Me.ext(xr,Object,{a6:function(t){this._k=t,this._t.a1(t),this._b.a3(t)},g1:function(){return this._k},a9:function(t){return this.c1(),t},a5:function(t){return this.a1(),t},b3:function(t){return this.c1(),t=this.c4(t),this._b.c(),t},g2:function(t){return this._b.g(),t},e2:function(t){t=this.f(t),this._b.f()},e1:function(){this._t.d(),null!=this._n&&this._d.xi(this._n),this.a1(),this._d=null},a1:function(){this._i&&(null!=this._q&&(this._d.x1("A",this._q),this._q=null),null!=this._p&&(this._d.x1("B",this._p),this._p=null),null!=this._h&&(this._d.xj(this._h),this._h=null),null!=this._l&&(this._d.xj(this._l),this._l=null))},c1:function(){if(this._i){null==this._h&&(this._h=this._d.xl()),null==this._l&&(this._l=this._d.xl());for(var t=this._d.xf();t.i1();t.i2()){var e=t.i8(),i=null!=this._j.i1(e.a2()),n=null!=this._j.i1(e.a3());if(i&&!n){var o=this._j.i1(e.a2());this._m.i4(o)?this._l.i8(e,ur.h(this._d,o)):this._l.i8(e,ur.i(this._d,o))}else if(!i&&n){var r=this._j.i1(e.a3());this._m.i4(r)?this._h.i8(e,ur.i(this._d,r)):this._h.i8(e,ur.h(this._d,r))}else i||n||(this._m.i4(e)?(this._h.i8(e,ur.i(this._d,e)),this._l.i8(e,ur.h(this._d,e))):(this._h.i8(e,ur.h(this._d,e)),this._l.i8(e,ur.i(this._d,e))))}this._q=this._d.xc("A"),this._p=this._d.xc("B"),this._d.x1("A",this._h),this._d.x1("B",this._l)}},c4:function(t){this._n=this._d.xk(),this._a=this._d.xl(),this._g=this._d.xl();for(var e=new po,i=new po,n=new po,o=new po,r=new po,a=new po,s=new po,l=new po,h=new po,c=this._d.xk(),u=0;u<t.length;u++)for(var d=0,f=t[u].x1();f.i1();)c.i6(f.i9(),d),f.i2(),d++;for(var p=function(t,e){var i=c.i3(t.a3())-c.i3(e.a3());return 0>=i?i>=0?0:-1:1},g=function(t,e){var i=c.i3(t.a2())-c.i3(e.a2());return 0>=i?i>=0?0:-1:1},_=0;_<t.length;_++)for(var m=t[_],v=m._b;null!=v;v=v.a()){var y=v.d();y.av(p),y.au(g);var w=0;e.af(),i.af(),n.af(),o.af(),r.af(),a.af(),s.af(),l.af(),h.af();for(var b=y.ap();b.i1();){var x=b.i8(),A=this.b1(x);null==A||A.d()||A.g()?n.aa(x):A.e()?e.aa(x):A.f()?(i.aa(x),h.aa(x)):A.c()&&(l.aa(x),h.aa(x)),b.i2(),w++}w=0;for(var C=y.am();C.i1();){var T=C.i8(),k=this.a2(T);null==k||k.c()||k.g()?o.aa(T):k.e()?e.aa(T):k.f()?(i.aa(T),h.aa(T)):k.d()&&(a.aa(T),h.aa(T)),C.i2(),w++}var S=c.i3(y);if(!h.ar())for(var E=.1/h.ay(),I=S-.4;!h.ar();I+=E){var L=h.c3();if(L.a2()===y){var R=this._d.xm();this._n.z1(R,L.a2()),this._d.s7(R,1,1),this._c.z1(R,this._c.i1(y)),c.i6(R,I),this._a.i8(L,this._d.gn(L)),this._d.gt(L,ir._A),this._d.xr(L,R,L.a3()),m.ao(R,v)}else{var P=this._d.xm();this._n.z1(P,L.a3()),this._d.s7(P,1,1),this._c.z1(P,this._c.i1(y)),c.i6(P,I),this._g.i8(L,this._d.gk(L)),this._d.gz(L,ir._A),this._d.xr(L,L.a2(),P),m.ao(P,v)}}if(!e.ar())for(var O=.1/e.ay(),D=S+.1;!e.ar();D+=O){var M=e.c3();if(M.a2()===y){var N=this._d.xm();this._n.z1(N,M.a2()),this._d.s7(N,1,1),this._c.z1(N,this._c.i1(y)),c.i6(N,D),this._a.i8(M,this._d.gn(M)),this._d.gt(M,ir._A),this._d.xr(M,N,M.a3()),v=m.an(N,v)}else{var B=this._d.xm();this._n.z1(B,M.a3()),this._d.s7(B,1,1),this._c.z1(B,this._c.i1(y)),c.i6(B,D),this._g.i8(M,this._d.gk(M)),this._d.gz(M,ir._A),this._d.xr(M,M.a2(),B),v=m.an(B,v)}}var F=xr._z;this._b.a2(y)&&(F=this._b.b2(y));var z=F._b.ay()+a.ay()+y.ao()+r.ay()+F._q.ay();if(z>0)for(var V=this._d.g9(y)/2,U=this._d.gj(y),j=this.a7(U,z),H=-.5*U+this.a8(this._d.gj(y),z,j)+j*(F._b.ay()+a.ay()),W=y.ap();W.i1();W.i2()){var G=W.i8();this.c2(G)||null!=this._j.i1(G.a2())||(this._d.g2(G).i8(new Vn(H,V)),H+=j)}var Z=this._t.a3(y),X=0,Y=0,$=0,q=0;if(null!=Z&&(X=Z._e.ay(),Y=Z._c.ay(),$=Z._b.ay(),q=Z._d.ay()),(z=F._g.ay()+X+l.ay()+y.ak()+s.ay()+Y+F._d.ay())>0){for(var K=this._d.gj(y),J=this.a7(K,z),Q=this.a8(K,z,J),tt=-.5*K+Q+J*(F._g.ay()+X+l.ay()),et=-this._d.g9(y)/2,it=y.am();it.i1();it.i2()){var nt=it.i8();this.d1(nt)||null!=this._j.i1(nt.a3())||(this._d.g2(nt).i9(new Vn(tt,et)),tt+=J)}if(null!=Z){for(var ot=-.5*K+Q+J*(F._g.ay()+l.ay()+Z._e.ay()-1),rt=Z._e.c1();rt.i1();rt.i2()){var at=rt.i8();this._d.u1(at),at.a2()!==y||this.c2(at)?this.d1(at)||(this._d.g2(rt.i8()).i9(new Vn(ot,et)),ot-=J):(this._d.g2(rt.i8()).i8(new Vn(ot,et)),ot-=J),this._d.h1(at)}ot=.5*K-Q-J*(F._d.ay()+s.ay());for(var st=Z._c.c1();st.i1();st.i2()){var lt=st.i8();this._d.u1(lt),lt.a2()!==y||this.c2(lt)?this.d1(lt)||(this._d.g2(st.i8()).i9(new Vn(ot,et)),ot-=J):(this._d.g2(st.i8()).i8(new Vn(ot,et)),ot-=J),this._d.h1(lt)}}}this._b.a2(y)&&this._b.a4(y,X+l.ay()+y.ak()+s.ay()+Y,a.ay()+y.ao()+r.ay(),$+i.ay(),q+e.ay())}return this._d.xi(c),t},a7:function(t,e){return 1>=e?0:t/(e-1+2*this._r)},a8:function(t,e,i){return 1>=e?.5*t:.5*(t-i*(e-1))},f:function(t){var e=this.g1();this._f=this._d.xk();for(var i=0;i<t.length;i++)for(var n=t[i],o=n._b;null!=o;){var r=o.d(),a=this._n.i1(r);if(null!=a||this._t.b2(r))o=o.a();else{var s=new Po,l=new Po,h=new Po,c=new Po,u=new Po,d=new Po,f=new po,p=new po,g=new Er(s,l,h,c,u,d,f,p);this._f.z1(r,g),f.ab(r.am()),p.ab(r.ap());for(var _=o.b();null!=_&&this._n.i1(_.d())===r;_=_.b()){var m=_.d(),v=this.c3(m);v.f()?l.ac(m):v.c()?c.ac(m):v.d()&&d.ac(m)}var y;for(y=o.a();null!=y&&this._n.i1(y.d())===r;y=y.a()){var w=y.d(),b=this.c3(w);b.e()?s.aa(w):b.c()?h.aa(w):b.d()&&u.aa(w)}o=y}}for(var x=this.d2(t),A=0,C=0;C<t.length;C++){var T=x[C];C>0&&(A+=x[C-1]._j+x[C-1]._h+x[C-1]._b),A+=T._g+T._f+T._a+T._d;for(var k=t[C].x1();k.i1();k.i2()){var S=k.i9();this._d.s3(S,this._d.gi(S),this._d.gh(S)+A)}T._c+=A,T._i+=A}for(var E=0;E<t.length;E++)for(var I=t[E],L=I.x1();L.i1();L.i2()){var R=L.i9();null!=this._n.i1(R)&&I.av(L)}for(var P=this,O=function(t,e){return P.a3(t)?P.a3(e)&&P._d.gi(t)>=P._d.gi(e)?-1:1:P.a3(e)?-1:P._d.gi(t)>=P._d.gi(e)?1:-1},D=function(t,e){return P.a3(t)?P.a3(e)?P._d.gi(t)>=P._d.gi(e)?1:-1:1:P.a3(e)?-1:P._d.gi(t)>=P._d.gi(e)?-1:1},M=0;M<t.length;M++)for(var N=x[M],B=t[M].x1();B.i1();B.i2()){var F=B.i9();if(!this._t.b2(F)){var z=this._f.i1(F),V=z._d,U=z._a,j=z._b,H=z._h,W=z._f,G=z._c,Z=z._g,X=z._e,Y=0,$=0,q=0,K=0,J=F.ao(),Q=F.ak(),tt=this._d.gi(F),et=this._d.gh(F),it=this._d.gj(F),nt=this._d.g9(F),ot=this._t.a3(F),rt=xr._z;if(this._b.a2(F)&&(rt=this._b.b2(F)),null!=ot){if(Y=ot._d.ay(),$=ot._b.ay(),q=ot._e.ay(),K=ot._c.ay(),Y>0)for(var at=rt._h.ay()+V.ay()+Y+rt._k.ay(),st=this.a7(nt,at),lt=this.a8(nt,at,st),ht=et+lt+st*(rt._h.ay()+this.a4(V)),ct=ot._d.c1();ct.i1();ct.i2()){var ut=ct.i8();this._d.u1(ut),ut.a2()===F?this.c2(ut)||this._d.gx(ut,new Vn(tt+it,ht)):(this.d1(ut),this._d.gy(ut,new Vn(tt+it,ht))),ht+=st,this._d.h1(ut)}if($>0)for(var dt=rt._i.ay()+U.ay()+$+rt._l.ay(),ft=this.a7(nt,dt),pt=this.a8(nt,dt,ft),gt=et+pt+ft*(rt._i.ay()+this.a4(U)),_t=ot._b.c1();_t.i1();_t.i2()){var mt=_t.i8();this._d.u1(mt),mt.a2()===F?this.c2(mt)||this._d.gx(mt,new Vn(tt,gt)):this.d1(mt)||this._d.gy(mt,new Vn(tt,gt)),gt+=ft,this._d.h1(mt)}}if(V.ay()>0){V.a1(O);for(var vt=rt._h.ay()+V.ay()+Y+rt._k.ay(),yt=this.a7(nt,vt),wt=this.a8(nt,vt,yt),bt=et+wt+yt*rt._h.ay(),xt=!0;!V.ar();){var At=V.x4();if(this.a3(At)){xt&&(xt=!1,bt+=yt*Y);var Ct=At.ag(),Tt=this._d.gd(Ct),kt=Tt.at();if(Tt.ac(new Vn(kt.x,N.b())),this.c2(Ct)){var St=this._a.i1(Ct);Tt.ac(new Vn(kt.x,St.y+this._d.g6(F))),Tt.ac(new Vn(St.x+this._d.g5(F),St.y+this._d.g6(F)))}else Tt.ac(new Vn(kt.x,bt)),Tt.ac(new Vn(tt+it,bt));this._d.xr(Ct,F,Ct.a3()),this._d.m1(Ct,Tt)}else{var Et=At.ae(),It=this._d.gd(Et),Lt=It.au();if(It.ae(new Vn(Lt.x,N.a())),this.d1(Et)){var Rt=this._g.i1(Et);It.ae(new Vn(Lt.x,Rt.y+this._d.g6(F))),It.ae(new Vn(Rt.x+this._d.g5(F),Rt.y+this._d.g6(F)))}else It.ae(new Vn(Lt.x,bt)),It.ae(new Vn(tt+it,bt));this._d.xr(Et,Et.a2(),F),this._d.m1(Et,It)}this._d.x4(At),bt+=yt}}if(U.ay()>0){U.a1(D);for(var Pt=rt._i.ay()+U.ay()+$+rt._l.ay(),Ot=this.a7(nt,Pt),Dt=this.a8(nt,Pt,Ot),Mt=et+Dt+Ot*rt._i.ay(),Nt=!0;!U.ar();){var Bt=U.x4();if(this.a3(Bt)){Nt&&(Nt=!1,Mt+=Ot*$);var Ft=Bt.ag(),zt=this._d.gd(Ft),Vt=zt.at();if(zt.ac(new Vn(Vt.x,N.b())),this.c2(Ft)){var Ut=this._a.i1(Ft);zt.ac(new Vn(Vt.x,Ut.y+this._d.g6(F))),zt.ac(new Vn(Ut.x+this._d.g5(F),Ut.y+this._d.g6(F)))}else zt.ac(new Vn(Vt.x,Mt)),zt.ac(new Vn(tt,Mt));this._d.xr(Ft,F,Ft.a3()),this._d.m1(Ft,zt)}else{var jt=Bt.ae(),Ht=this._d.gd(jt),Wt=Ht.au();if(Ht.ae(new Vn(Wt.x,N.a())),this.d1(jt)){var Gt=this._g.i1(jt);Ht.ae(new Vn(Wt.x,Gt.y+this._d.g6(F))),Ht.ae(new Vn(Gt.x+this._d.g5(F),Gt.y+this._d.g6(F)))}else Ht.ae(new Vn(Wt.x,Mt)),Ht.ae(new Vn(tt,Mt));this._d.xr(jt,jt.a2(),F),this._d.m1(jt,Ht)}this._d.x4(Bt),Mt+=Ot}}var Zt=rt._g.ay()+rt._d.ay()+Q+H.ay()+j.ay()+q+K;it=this._d.gj(F);var Xt=this.a7(it,Zt),Yt=this.a8(it,Zt,Xt);Zt=rt._b.ay()+rt._q.ay()+J+G.ay()+W.ay();var $t=this.a7(it,Zt),qt=this.a8(it,Zt,$t);if(H.ay()>0)for(var Kt,Jt=Xt,Qt=e,te=this._d.gi(F)+Yt+Jt*(rt._g.ay()+H.ay()-1),ee=this._d.gh(F),ie=N._c-N._g-H.ay()*Qt;!H.ar();this._d.x4(Kt)){Kt=H.x4();var ne=Kt.ag(),oe=this._d.gd(ne),re=oe.at();if(oe.ac(new Vn(re.x,N.b())),oe.ac(new Vn(re.x,ie)),this.c2(ne)){var ae=this._a.i1(ne);oe.ac(new Vn(ae.x+this._d.g5(F),ie)),oe.ac(new Vn(ae.x+this._d.g5(F),ae.y+this._d.g6(F)))}else oe.ac(new Vn(te,ie)),oe.ac(new Vn(te,ee)),te-=Jt;ie+=Qt,this._d.xr(ne,F,ne.a3()),this._d.m1(ne,oe)}if(j.ay()>0)for(var se,le=Xt,he=e,ce=this._d.gi(F)+this._d.gj(F)-Yt-le*rt._d.ay(),ue=this._d.gh(F),de=N._c-N._g-he;!j.ar();this._d.x4(se)){se=j.x4();var fe=se.ag(),pe=this._d.gd(fe),ge=pe.at();if(pe.ac(new Vn(ge.x,N.b())),pe.ac(new Vn(ge.x,de)),this.c2(fe)){var _e=this._a.i1(fe);pe.ac(new Vn(_e.x+this._d.g5(F),de)),pe.ac(new Vn(_e.x+this._d.g5(F),_e.y+this._d.g6(F)))}else pe.ac(new Vn(ce,de)),pe.ac(new Vn(ce,ue)),ce-=le;de-=he,this._d.xr(fe,F,fe.a3()),this._d.m1(fe,pe)}if(G.ay()>0)for(var me,ve=$t,ye=e,we=this._d.gi(F)+qt+ve*(rt._b.ay()+G.ay()-1),be=this._d.gh(F)+this._d.g9(F),xe=be+G.ay()*ye;!G.ar();this._d.x4(me)){me=G.x4();var Ae=me.ae(),Ce=this._d.gd(Ae),Te=Ce.au();if(Ce.ae(new Vn(Te.x,N.a())),Ce.ae(new Vn(Te.x,xe)),this.d1(Ae)){var ke=this._g.i1(Ae);Ce.ae(new Vn(ke.x+this._d.g5(F),xe)),Ce.ae(new Vn(ke.x+this._d.g5(F),ke.y+this._d.g6(F)))}else Ce.ae(new Vn(we,xe)),Ce.ae(new Vn(we,be)),we-=ve;xe-=ye,this._d.xr(Ae,Ae.a2(),F),this._d.m1(Ae,Ce)}if(W.ay()>0)for(var Se,Ee=$t,Ie=e,Le=this._d.gi(F)+this._d.gj(F)-qt-$t*rt._q.ay(),Re=this._d.gh(F)+this._d.g9(F),Pe=Re+Ie;!W.ar();this._d.x4(Se)){Se=W.x4();var Oe=Se.ae(),De=this._d.gd(Oe),Me=De.au();if(De.ae(new Vn(Me.x,N.a())),De.ae(new Vn(Me.x,Pe)),this.d1(Oe)){var Ne=this._g.i1(Oe);De.ae(new Vn(Ne.x+this._d.g5(F),Pe)),De.ae(new Vn(Ne.x+this._d.g5(F),Ne.y+this._d.g6(F)))}else De.ae(new Vn(Le,Pe)),De.ae(new Vn(Le,Re)),Le-=Ee;Pe+=Ie,this._d.xr(Oe,Oe.a2(),F),this._d.m1(Oe,De)}for(;!X.ar();){var Be=X.c3(),Fe=this._d.gl(Be);N.a()+12<Fe.y&&this._d.g7(Be).i4(Fe.x,N.a())}for(;!Z.ar();){var ze=Z.c3(),Ve=this._d.gs(ze);if(N.b()-12>Ve.y){var Ue=this._d.gf(ze);Ue.ac(new Vn(Ve.x,N.b())),this._d.s6(ze,Ue)}}}}for(var je=0;je<t.length;je++)for(var He=t[je],We=He._b;null!=We;We=We.a()){var Ge=We.d(),Ze=this._t.a3(Ge);null!=Ze&&null!=Ze._a&&(this._d.x4(Ze._a),He.aw(We.b()))}return this._d.xi(this._f),this._d.xj(this._a),this._d.xj(this._g),t},c3:function(t){return this.a3(t)?this.b1(t.ag()):this.a2(t.ae())},b1:function(t){return null==this._h?xr.s:this._h.i1(t)},a2:function(t){return null==this._l?xr.u:this._l.i1(t)},c2:function(t){if(null==t)return!1;var e=this.b1(t);return null!=e&&e.a()},d1:function(t){if(null==t)return!1;var e=this.a2(t);return null!=e&&e.a()},a3:function(t){return 1===t.ao()},b2:function(t){return 1===t.ak()},a4:function(t){for(var e=0,i=t._b;null!=i;i=i.a())this.b2(i.d())&&e++;return e},d2:function(t){for(var e=this._k,i=Ir.d(t.length+1),n=0;n<t.length;n++){var o=t[n],r=new kr;i[n]=r,r._c=Number.MAX_VALUE,r._i=Number.MIN_VALUE;for(var a=o.x1();a.i1();a.i2()){var s=a.i9(),l=this._d.gb(s);r._c=Math.min(r._c,l.i2()),r._i=Math.max(r._i,l.i2()+l.i4())}}this._b.a5(t,i);for(var h=0;h<t.length;h++)for(var c=i[h],u=t[h].x1();u.i1();u.i2()){var d=u.i9(),f=this._f.i1(d);null!=f&&(c._h=Math.max(c._h,Math.max(f._f.ay()*e,f._c.ay()*e)),c._f=Math.max(c._f,Math.max(f._b.ay()*e,f._h.ay()*e)))}return i}}),xr.s=ur.j(2),xr.u=ur.j(1),xr._z=new br;var Ar=function(){this._af=0,this._b=0};Me.ext(Ar,Object,{ib:function(t){this._af=t},ia:function(t,e,i){this.a6(t,e,i),this.b2(!1);var n=this.g();if(this.o()&&n>0){for(var o=this.r(),r=0;20>r&&n>0&&this.o();r++){this.b2(!0);var a=this.g();n>a&&(this.a7(o),n=a)}this.b3(o),this.b1()}return this.c()},a6:function(t,e,i){this._b=(new Date).getTime(),this._ac=t,this._ah=e;var n=this;this._p=function(t,e){var i=n._n[t.al()]-n._n[e.al()];return i>0?1:i>=0?0:-1},this._ad=Ir.d(i);for(var o=0;o<this._ad.length;o++)this._ad[o]=new Po;this._ab=Ir.a(this._ac.x0()),this._f=Ir.d(this._ac.x0()),this._n=Ir.a(this._ac.x0()+1);var r=this._ab;this._o=function(t,e){if(null==t&&null!=e)return 1;if(null!=t&&null==e)return-1;if(null==t&&null==e)return 0;var i=t,n=e,o=i._h,a=i.a2(),s=n.a2(),l=r[a.al()]-r[s.al()];if(0===l){var h=Ar.b(ur.h(o,i),o.gn(i)),c=Ar.b(ur.h(o,n),o.gn(n)),u=h-c;if(0===u){var d=r[i.a3().al()]-r[n.a3().al()];if(0===d){return Ar.a(ur.i(o,i),o.gk(i))-Ar.a(ur.i(o,n),o.gk(n))}return d}return u}return l},this._l=function(t,e){if(null==t&&null!=e)return 1;if(null!=t&&null==e)return-1;if(null==t&&null==e)return 0;var i=t,n=e,o=i._h,a=i.a3(),s=n.a3(),l=r[a.al()]-r[s.al()];if(0===l){var h=Ar.a(ur.i(o,i),o.gk(i)),c=Ar.a(ur.i(o,n),o.gk(n)),u=h-c;if(0===u){var d=r[i.a2().al()]-r[n.a2().al()];if(0===d){return Ar.b(ur.h(o,i),o.gn(i))-Ar.b(ur.h(o,n),o.gn(n))}return d}return u}return l},this._z=function(t,e){if(null==t&&null!=e)return 1;if(null!=t&&null==e)return-1;if(null==t&&null==e)return 0;var i=t,n=e,o=i._h;return Ar.b(ur.h(o,i),o.gn(i))-Ar.b(ur.h(o,n),o.gn(n))},this._e=function(t,e){if(null==t&&null!=e)return 1;if(null!=t&&null==e)return-1;if(null==t&&null==e)return 0;var i=t,n=e,o=i._h;return Ar.a(ur.i(o,i),o.gk(i))-Ar.a(ur.i(o,n),o.gk(n))},this._ac.x2(this._e,this._z)},c:function(){this._ah=null,this._aa=null,this._f=null,this._n=null,this._p=null,this._o=null,this._l=null,this._ac=null;var t=this._ad;return this._ad=null,t},o:function(){return(new Date).getTime()-this._b<=this._af},m:function(){for(var t=this,e=function(e,i){return Math.ceil(t._n[e.a3().al()])-Math.ceil(t._n[i.a3().al()])},i=this._ac.x9();i.i1();i.i2()){for(var n=i.i9().aw();n.i1();n.i2())this._n[n.i9().al()]=ir.j();i.i9().av(e)}},b2:function(t){for(var e=0;e<this._ad.length;e++)this._ad[e].af();if(t){this.m();for(var i=0,n=this._ab.length;n>i;i++)this._ab[i]=0;this._ac.x2(null,this._z)}var o=this._ac.xm();this._ah.i7(o,0);for(var r=this._ac.x9();r.i1();r.i2())0===r.i9().ak()&&r.i9()!==o&&this._ac.xo(o,r.i9());var a=new to(this);a.a6(!0),a.a9(this._ac,o),this._ad[0].at(),this._ac.x4(o),this.d()},a1:function(){this._ac.x2(this._o,this._l);for(var t=0,e=1;e<this._ad.length;e++){t+=this.a2(this._ad[e-1],this._ad[e])}return t+=0},a2:function(t,e){var i=t.ah(),n=e.ah(),o=new fo,r=new fo;this._aa=Ir.d(this._ac.x0());for(var a=0;i.i1()&&n.i1();n.i2())a+=this.a8(i.i6(),o,r,!0),a+=this.a8(n.i6(),r,o,!1),i.i2();for(;i.i1();i.i2())a+=this.a8(i.i6(),o,r,!0);for(;n.i1();n.i2())a+=this.a8(n.i6(),r,o,!1);return a},a8:function(t,e,i,n){var o=0,r=0,a=0;if(null!=this._aa[t.al()])for(var s=this._aa[t.al()].a(),l=e._b;l!==s;l=l.a()){var h=l._c;h===t?(o++,a+=r,e.aw(l)):r++}var c=o*i.ay()+a;if(n)for(var u=t.ag();null!=u;u=u.a8()){var d=u.a3();this._ab[d.al()]>=this._ab[t.al()]&&(this._aa[d.al()]=i.ae(d))}else for(var f=t.ae();null!=f;f=f.a7()){var p=f.a2();this._ab[p.al()]>this._ab[t.al()]&&(this._aa[p.al()]=i.ae(p))}return c},g:function(){for(var t=this.r(),e=this.a1(),i=!0,n=0;3>n&&this.o()&&e>0;){var o=this.k();e>o?(this.a7(t),e=o):n++,i=!i}if(this.b3(t),this.b1(),e>0){for(var r=1,a=0;1===r&&e>0;a++){this.e(),this.i();var s=this.a1();e>s?(r=1,this.a7(t)):r=-1,e=s}this.b3(t),this.b1()}return e},e:function(){for(var t=this.l(),e=this.r(),i=Ir.d(this._ac.x0()),n=this._ad.length-1;n>=0;n--)for(var o=this._ad[n].ah();o.i1();o.i2()){var r=o.i6();if(1===r.ak()&&1===r.ao()){var a=t.i1(r.ag());if(null!=a&&null==i[a.al()])for(var s=this.a4(r,a),l=a.al(),h=i[l]=Ir.d(s+1),c=h.length-1;c>=0;c--)h[c]=new fo}}for(var u=0;u<this._ad.length;u++)for(var d=this._ad[u].ah();d.i1();d.i2()){var f=d.i6();if(1===f.ak()&&1===f.ao()){var p=t.i1(f.ag());if(null!=p){var g=p.al(),_=this.a4(f,p)-1;i[g][_].ae(f.ae())}}else for(var m=f.ae();null!=m;m=m.a7()){var v=t.i1(m);if(null!=v){var y=v.al(),w=this.a4(f,v)-1;i[y][w].ae(m)}}}for(var b=this._ac.x9();b.i1();b.i2()){var x=b.i9();if(null!=i[x.al()])for(var A=x.ag();null!=A;A=A.a8()){var C=t.i1(A);if(null!=C)for(var T=i[C.al()];T[0].ay()>0;){for(var k,S=0;;){k=T[S].am();var E=k.a3();if(1!==E.ak()||1!==E.ao())break;S++}var I=T[S].at().a3();S--,I=k.a2(),k=T[S].at();for(var L=k.a3();S>=0;)if(e[I.al()]!==e[L.al()]&&(this._ab[I.al()]=e[L.al()]),I=I.ae().a2(),--S>=0){var R=T[S].at();L=R.a3()}}}}this.b1(),this._ac.xj(t)},i:function(){for(var t=this.f(),e=this.r(),i=Ir.d(this._ac.x0()),n=0;n<this._ad.length;n++)for(var o=this._ad[n].ah();o.i1();o.i2()){var r=o.i6();if(1===r.ak()&&1===r.ao()){var a=t.i1(r.ae());if(null!=a&&null==i[a.al()])for(var s=this.a4(a,r),l=a.al(),h=i[l]=Ir.d(s+1),c=h.length-1;c>=0;c--)h[c]=new fo}}for(var u=this._ad.length-1;u>=0;u--)for(var d=this._ad[u].ah();d.i1();d.i2()){var f=d.i6();if(1===f.ak()&&1===f.ao()){var p=t.i1(f.ae());if(null!=p){var g=p.al(),_=this.a4(p,f)-1;i[g][_].ae(f.ag())}}else for(var m=f.ag();null!=m;m=m.a8()){var v=t.i1(m);if(null!=v){var y=v.al(),w=this.a4(v,f)-1;i[y][w].ae(m)}}}for(var b=this._ac.x9();b.i1();b.i2()){var x=b.i9();if(null!=i[x.al()])for(var A=x.ae();null!=A;A=A.a7()){var C=t.i1(A);if(null!=C)for(var T=i[C.al()];T[0].ay()>0;){for(var k,S=0;;){k=T[S].am();var E=k.a2();if(1!==E.ak()||1!==E.ao())break;S++}var I=T[S].at().a2();S--,I=k.a3(),k=T[S].at();for(var L=k.a2();S>=0;)if(e[I.al()]!==e[L.al()]&&(this._ab[I.al()]=e[L.al()]),I=I.ag().a3(),--S>=0){var R=T[S].at();L=R.a2()}}}}this.b1(),this._ac.xj(t)},a4:function(t,e){return this._ah.i2(t)-this._ah.i2(e)},l:function(){for(var t=No.a6(Ir.d(this._ac.xg())),e=this._ac.x9();e.i1();e.i2()){var i=e.i9();if(i.ao()>1){for(var n=0,o=i.ag();null!=o;o=o.a8()){var r=o.a3();1===r.ak()&&1===r.ao()&&n++}if(n>1)for(var a=i.ag();null!=a;a=a.a8()){var s=a,l=s.a3();if(1===l.ak()&&1===l.ao()){for(;1===l.ak()&&1===l.ao();l=s.a3())t.i8(s,i),s=l.ag();t.i8(s,i)}}}}return t},f:function(){for(var t=No.a6(Ir.d(this._ac.xg())),e=this._ac.x9();e.i1();e.i2()){var i=e.i9();if(i.ak()>1){for(var n=0,o=i.ae();null!=o;o=o.a7()){var r=o.a2();1===r.ak()&&1===r.ao()&&n++}if(n>1)for(var a=i.ae();null!=a;a=a.a7()){var s=a,l=s.a2();if(1===l.ak()&&1===l.ao()){for(;1===l.ak()&&1===l.ao();l=s.a2())t.i8(s,i),s=l.ae();t.i8(s,i)}}}}return t},k:function(){for(var t=1;t<this._ad.length;t++){for(var e=this._ad[t],i=e.ah();i.i1();i.i2()){var n=i.i6();this._n[n.al()]=this.a5(n,e.ay(),n.am(),this._ad[t-1].ay()),this._n[n.al()]+=this._ab[n.al()]/(3*this._ad[t-1].ay())}this.a3(e,this._p)}return this.a1()},a5:function(t,e,i,n){var o=0;if(0===i.i7())o=n*this._ab[t.al()]/e;else{for(;i.i1();i.i2()){var r=i.i8();o+=r.a2()===t?this._ab[r.a3().al()]:this._ab[r.a2().al()]}o/=i.i7()}return o},a7:function(t){Ir.f(this._ab,t,t.length)},b3:function(t){Ir.f(t,this._ab,t.length)},r:function(){var t=Ir.a(this._ab.length);return this.a7(t),t},d:function(){for(var t=0;t<this._ad.length;t++)for(var e=0,i=this._ad[t].ah();i.i1();)this._ab[i.i6().al()]=e,i.i2(),e++},b1:function(){for(var t=0;t<this._ad.length;t++){for(var e=this._ad[t],i=e._b;null!=i;i=i.a()){var n=i.d();this._f[this._ab[n.al()]]=n}for(var o=0,r=e._b;null!=r;)r.c(this._f[o]),r=r.a(),o++}},a3:function(t,e){for(var i=t.ah(),n=0;n<t.ay();i.i2())this._f[n]=i.i6(),n++;Ir.s(this._f,t.ay(),e);for(var o=0,r=t._b;null!=r;)r.c(this._f[o]),this._ab[this._f[o].al()]=o,r=r.a(),o++}}),Ar.b=function(t,e){if(null==t)return 0;var i=t.a()?Math.floor(e.x):0,n=t.a()?Math.floor(e.y):0;return t.e()?1e4-n:t.f()?-1e4+n:t.c()?-2e4-i:i},Ar.a=function(t,e){if(null==t)return 0;var i=t.a()?Math.floor(e.x):0,n=t.a()?Math.floor(e.y):0;return t.e()?1e4+n:t.f()?-1e4-n:t.d()?-2e4-i:i};var Cr=function(){Cr.superClass.constructor.call(this),this._i6=0,this._i3=2147483647,this._i0=60,this._iz=20,this._i2=20,this._i4=20,this.i5(!1),this._i7=new _r,this._i1=new Ar,this._i8=new yr};Me.ext(Cr,zo,{j2:function(){return this._i2},i4:function(t){return!0},i3:function(t){this._i6=(new Date).getTime(),cr.d(t,!1);var e=t.xk(),i=t.xk(),n=t.xl(),o=new po,r=new xr(t,e,i,n);r.a6(this.j2()),this._i8.i3(this._iz),this._i8.i6(this._i0),this._i8.i4(this._i2),this._i8.i5(this._i4),this._i8.i2(i);for(var a=this._i7.i1(t,e,o),s=o.c1();s.i1();s.i2()){var l=s.i8();n.i7(l,!0);var h=t.gn(l);t.gt(l,t.gk(l)),t.gz(l,h)}this.a2(t,e,i),a=r.a9(a);var c=this.j1(t,e,a);c=r.a5(c),c=r.b3(c),this._i8.i1(t,c,e),c=r.g2(c),r.e2(c),this.b(t,i),this.w(t),this.a1(t,o),r.e1(),t.xj(n),t.xi(i),t.xi(e)},j1:function(t,e,i){if(this._i1 instanceof Ar){var n=this._i1,o=(new Date).getTime()-this._i6;n.ib(this._i3-o)}return this._i1.ia(t,e,i)},a1:function(t,e){for(var i=e.c1();i.i1();i.i2()){var n=i.i8(),o=t.gs(n),r=t.gl(n);t.x3(n);var a=t.gp(n);t.s5(n,a.a()),t.gy(n,o),t.gx(n,r)}},b:function(t,e){for(var i=t.x9();i.i1();i.i2()){var n=i.i9(),o=e.i1(n);if(null!=o&&!t.xp(o)){for(var r=n.am().i8().a2();null!=e.i1(r);r=n.am().i8().a2())n=r;t.u1(o);for(var a=n.ae(),s=new fo;null!=e.i1(a.a3());a=a.a3().ag()){var l=t.gs(a);s.aa(l),s.az(t.gf(a));var h=t.gl(a);h.equals(l)||s.aa(h)}var c=t.gs(a);s.aa(c),s.az(t.gf(a));var u=t.gl(a);u.equals(c)||s.aa(u),t.m1(o,s)}}for(var d=t.x9();d.i1();d.i2())null!=e.i1(d.i9())&&t.x4(d.i9())},w:function(t){for(var e=t.xf();e.i1();e.i2()){var i=e.i8(),n=t.g2(i);if(n.i1()>0){var o=new hn,r=t.gc(i),a=r.c(),s=a.i6();a.i2();var l=s.x,h=s.y;if(a.i1()){var c=a.i6(),u=c.x,d=c.y;for(a.i2();a.i1();a.i2()){var f=a.i6(),p=f.x,g=f.y,_=(l-p)*(d-g)/(h-g)+p;Math.abs(_-u)>=1&&(o.add(c),l=u,h=d),c=f,u=p,d=g}}o.size()<n.i1()&&t.s5(i,new Gn(o))}}},a2:function(t,e,i){var n=t.g8().c1();for(n.i5();n.i1();n.i3()){var o=n.i8().a2(),r=n.i8().a3(),a=e.i2(r)-e.i2(o);if(a>1){for(var s=null,l=null,h=o;a>1;a--)s=t.xm(),t.s7(s,1,1),t.s4(s,ir._A),l=t.xo(h,s),h===o&&t.gt(l,t.gn(n.i8())),e.i7(s,e.i2(h)+1),i.z1(s,n.i8()),h=s;l=t.xo(s,r),t.gz(l,t.gk(n.i8())),t.h1(n.i8())}}}});var Tr=function(t,e,i,n){this._i=20,this._j=t,this._g=e,this._a=i,this._h=n};Me.ext(Tr,Object,{a1:function(t){this._i=t},b2:function(t){return null!=this._e&&this._e.i4(t)},a3:function(t){return null==this._f?null:this._f.i1(t)},d:function(){this._j.xi(this._f),this._j.xi(this._e)}});var kr=function(){this._c=0,this._i=0,this._g=0,this._j=0,this._f=0,this._h=0,this._d=0,this._e=0,this._a=0,this._b=0};Me.ext(kr,Object,{a:function(){return this._c-this._g-this._f-this._a},b:function(){return this._i+this._j+this._h+this._b}});var Sr=function(){this._d=new po,this._b=new po,this._c=new po,this._e=new po};Me.ext(Sr,Object,{});var Er=function(t,e,i,n,o,r,a,s){this._d=t,this._a=e,this._b=i,this._h=n,this._f=o,this._c=r,this._e=a,this._g=s};Me.ext(Er,Object,{});var Ir={};Ir.a=function(t,e){for(var i=[],n=0;t>n;n++)i[n]=e||0;return i},Ir.b=function(t){for(var e=[],i=0;t>i;i++)e[i]=!1;return e},Ir.c=function(t,e){if(t instanceof Vn)return t.x<e.x?-1:t.x>e.x?1:t.y<e.y?-1:t.y<=e.y?0:1;if(t instanceof Un)return e.width>t.width?-1:e.width<t.width?1:e.height>t.height?-1:e.height>=t.height?0:1;if(t instanceof Hn)return t.x<e.x?-1:t.x>e.x?1:t.y<e.y?-1:t.y>e.y?1:e.width>t.width?-1:e.width<t.width?1:e.height>t.height?-1:e.height>=t.height?0:1;throw"Unkown Type: "+t},Ir.d=function(t){for(var e=[],i=0;t>i;i++)e[i]=null;return e},Ir.e=function(t,e){for(var i=[],n=0;t>n;n++)i[n]=Ir.a(e);return i},Ir.f=function(t,e,i){for(var n=0;i>n;n++)e[n]=t[n]},Ir.s=function(t,e,i){var n=[];Ir.f(t,n,e),n.sort(i),Ir.f(n,t,e)},Ir.n=function(t,e){return t-e}}(window)},"78b2":function(t,e,i){var n=i("2c74"),o=n.Uint8Array;t.exports=o},"79b9":function(t,e,i){var n=i("d5d3"),o=Object.create,r=function(){function t(){}return function(e){if(!n(e))return{};if(o)return o(e);t.prototype=e;var i=new t;return t.prototype=void 0,i}}();t.exports=r},"7f88":function(t,e){function i(){this.__data__=[],this.size=0}t.exports=i},"801a":function(t,e,i){function n(t,e){return o(t,r(t),e)}var o=i("f34d"),r=i("7714");t.exports=n},"81cc":function(t,e,i){function n(t){return o(this,t).has(t)}var o=i("6ca4");t.exports=n},8281:function(t,e,i){},"845f":function(t,e,i){function n(t){return null!=t&&r(t.length)&&!o(t)}var o=i("68f1"),r=i("dc7c");t.exports=n},"84dc":function(t,e,i){"use strict";var n=i("fdd3"),o=i.n(n);o.a},8541:function(t,e,i){"use strict";var n=i("c6fa"),o=i.n(n);o.a},"882c":function(t,e){function i(t,e){for(var i=-1,n=null==t?0:t.length;++i<n&&!1!==e(t[i],i,t););return t}t.exports=i},"88f9":function(t,e,i){function n(t){var e=-1,i=null==t?0:t.length;for(this.clear();++e<i;){var n=t[e];this.set(n[0],n[1])}}var o=i("7f88"),r=i("0ea7"),a=i("b892"),s=i("3bce"),l=i("65ab");n.prototype.clear=o,n.prototype.delete=r,n.prototype.get=a,n.prototype.has=s,n.prototype.set=l,t.exports=n},"8a0d":function(t,e,i){"use strict";var n=i("f1f9"),o=i.n(n);o.a},"8bbf":function(t,e){t.exports=n("8bbf")},"8bed":function(t,e,i){function n(t,e,i,O,D,M){var N,B=e&T,F=e&k,z=e&S;if(i&&(N=D?i(t,O,D,M):i(t)),void 0!==N)return N;if(!x(t))return t;var V=y(t);if(V){if(N=_(t),!B)return c(t,N)}else{var U=g(t),j=U==I||U==L;if(w(t))return h(t,B);if(U==R||U==E||j&&!D){if(N=F||j?{}:v(t),!B)return F?d(t,l(N,t)):u(t,s(N,t))}else{if(!P[U])return D?t:{};N=m(t,U,B)}}M||(M=new o);var H=M.get(t);if(H)return H;if(M.set(t,N),A(t))return t.forEach(function(o){N.add(n(o,e,i,o,t,M))}),N;if(b(t))return t.forEach(function(o,r){N.set(r,n(o,e,i,r,t,M))}),N;var W=z?F?p:f:F?keysIn:C,G=V?void 0:W(t);return r(G||t,function(o,r){G&&(r=o,o=t[r]),a(N,r,n(o,e,i,r,t,M))}),N}var o=i("0d91"),r=i("882c"),a=i("cde6"),s=i("fa30"),l=i("620b"),h=i("9b7b"),c=i("d8d3"),u=i("801a"),d=i("c7ee"),f=i("07bd"),p=i("c94b"),g=i("e688"),_=i("a9f1"),m=i("53a9"),v=i("e729"),y=i("c326"),w=i("ae99"),b=i("db19"),x=i("d5d3"),A=i("1fda"),C=i("3c3d"),T=1,k=2,S=4,E="[object Arguments]",I="[object Function]",L="[object GeneratorFunction]",R="[object Object]",P={};P[E]=P["[object Array]"]=P["[object ArrayBuffer]"]=P["[object DataView]"]=P["[object Boolean]"]=P["[object Date]"]=P["[object Float32Array]"]=P["[object Float64Array]"]=P["[object Int8Array]"]=P["[object Int16Array]"]=P["[object Int32Array]"]=P["[object Map]"]=P["[object Number]"]=P[R]=P["[object RegExp]"]=P["[object Set]"]=P["[object String]"]=P["[object Symbol]"]=P["[object Uint8Array]"]=P["[object Uint8ClampedArray]"]=P["[object Uint16Array]"]=P["[object Uint32Array]"]=!0,P["[object Error]"]=P[I]=P["[object WeakMap]"]=!1,t.exports=n},"8c04":function(t,e,i){function n(){this.size=0,this.__data__={hash:new o,map:new(a||r),string:new o}}var o=i("1549"),r=i("88f9"),a=i("f1e1");t.exports=n},"8d09":function(t,e,i){function n(t,e){var i=this.__data__;return this.size+=this.has(t)?0:1,i[t]=o&&void 0===e?r:e,this}var o=i("2817"),r="__lodash_hash_undefined__";t.exports=n},"8d51":function(t,e,i){function n(t,e){for(var i=t.length;i--;)if(o(t[i][0],e))return i;return-1}var o=i("1943");t.exports=n},"8dae":function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA4RpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTM4IDc5LjE1OTgyNCwgMjAxNi8wOS8xNC0wMTowOTowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpmMzdjMzk2YS1mNmExLTUzNDktOThlNC04YWI1ZTI0ZjY4NmIiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NEFCMjYyQ0I4QjI2MTFFODg2MEVGMjBDRTMwM0UyMkMiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NEFCMjYyQ0E4QjI2MTFFODg2MEVGMjBDRTMwM0UyMkMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTcgKFdpbmRvd3MpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6MzhjMjFhMmQtM2EwZi1jMzRjLTgyZWYtOGQ1NDlkYjI2MmQwIiBzdFJlZjpkb2N1bWVudElEPSJhZG9iZTpkb2NpZDpwaG90b3Nob3A6Y2ExNGMyMjUtODk5ZS0xMWU4LWJiOWQtYjg2NDA5OWUzYTIzIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+duIy9QAAADdJREFUeNpi/P//PwM1ABMDlcCoQUPRIBYYw3E+wwcgxU+i/o/7ExkEqOoixtGUPWoQFQBAgAEAS/8KH4IWdxQAAAAASUVORK5CYII="},"904b":function(t,e){function i(t,e){for(var i=-1,n=e.length,o=t.length;++i<n;)t[o+i]=e[i];return t}t.exports=i},"92c7":function(t,e,i){function n(t){return null==t?void 0===t?l:s:h&&h in Object(t)?r(t):a(t)}var o=i("9991"),r=i("4b04"),a=i("f8db"),s="[object Null]",l="[object Undefined]",h=o?o.toStringTag:void 0;t.exports=n},"96cf":function(t,e,i){var n=function(t){"use strict";function e(t,e,i,o){var r=e&&e.prototype instanceof n?e:n,a=Object.create(r.prototype),s=new d(o||[]);return a._invoke=l(t,i,s),a}function i(t,e,i){try{return{type:"normal",arg:t.call(e,i)}}catch(t){return{type:"throw",arg:t}}}function n(){}function o(){}function r(){}function a(t){["next","throw","return"].forEach(function(e){t[e]=function(t){return this._invoke(e,t)}})}function s(t){function e(n,o,r,a){var s=i(t[n],t,o);if("throw"!==s.type){var l=s.arg,h=l.value;return h&&"object"==typeof h&&m.call(h,"__await")?Promise.resolve(h.__await).then(function(t){e("next",t,r,a)},function(t){e("throw",t,r,a)}):Promise.resolve(h).then(function(t){l.value=t,r(l)},function(t){return e("throw",t,r,a)})}a(s.arg)}function n(t,i){function n(){return new Promise(function(n,o){e(t,i,n,o)})}return o=o?o.then(n,n):n()}var o;this._invoke=n}function l(t,e,n){var o=x;return function(r,a){if(o===C)throw new Error("Generator is already running");if(o===T){if("throw"===r)throw a;return p()}for(n.method=r,n.arg=a;;){var s=n.delegate;if(s){var l=h(s,n);if(l){if(l===k)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===x)throw o=T,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=C;var c=i(t,e,n);if("normal"===c.type){if(o=n.done?T:A,c.arg===k)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=T,n.method="throw",n.arg=c.arg)}}}function h(t,e){var n=t.iterator[e.method];if(n===g){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=g,h(t,e),"throw"===e.method))return k;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return k}var o=i(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,k;var r=o.arg;return r?r.done?(e[t.resultName]=r.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=g),e.delegate=null,k):r:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,k)}function c(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function u(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function d(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(c,this),this.reset(!0)}function f(t){if(t){var e=t[y];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,n=function e(){for(;++i<t.length;)if(m.call(t,i))return e.value=t[i],e.done=!1,e;return e.value=g,e.done=!0,e};return n.next=n}}return{next:p}}function p(){return{value:g,done:!0}}var g,_=Object.prototype,m=_.hasOwnProperty,v="function"==typeof Symbol?Symbol:{},y=v.iterator||"@@iterator",w=v.asyncIterator||"@@asyncIterator",b=v.toStringTag||"@@toStringTag";t.wrap=e;var x="suspendedStart",A="suspendedYield",C="executing",T="completed",k={},S={};S[y]=function(){return this};var E=Object.getPrototypeOf,I=E&&E(E(f([])));I&&I!==_&&m.call(I,y)&&(S=I);var L=r.prototype=n.prototype=Object.create(S);return o.prototype=L.constructor=r,r.constructor=o,r[b]=o.displayName="GeneratorFunction",t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===o||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,r):(t.__proto__=r,b in t||(t[b]="GeneratorFunction")),t.prototype=Object.create(L),t},t.awrap=function(t){return{__await:t}},a(s.prototype),s.prototype[w]=function(){return this},t.AsyncIterator=s,t.async=function(i,n,o,r){var a=new s(e(i,n,o,r));return t.isGeneratorFunction(n)?a:a.next().then(function(t){return t.done?t.value:a.next()})},a(L),L[b]="Generator",L[y]=function(){return this},L.toString=function(){return"[object Generator]"},t.keys=function(t){var e=[];for(var i in t)e.push(i);return e.reverse(),function i(){for(;e.length;){var n=e.pop();if(n in t)return i.value=n,i.done=!1,i}return i.done=!0,i}},t.values=f,d.prototype={constructor:d,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=g,this.done=!1,this.delegate=null,this.method="next",this.arg=g,this.tryEntries.forEach(u),!t)for(var e in this)"t"===e.charAt(0)&&m.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=g)},stop:function(){this.done=!0;var t=this.tryEntries[0],e=t.completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){function e(e,n){return r.type="throw",r.arg=t,i.next=e,n&&(i.method="next",i.arg=g),!!n}if(this.done)throw t;for(var i=this,n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n],r=o.completion;if("root"===o.tryLoc)return e("end");if(o.tryLoc<=this.prev){var a=m.call(o,"catchLoc"),s=m.call(o,"finallyLoc");if(a&&s){if(this.prev<o.catchLoc)return e(o.catchLoc,!0);if(this.prev<o.finallyLoc)return e(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return e(o.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return e(o.finallyLoc)}}}},abrupt:function(t,e){for(var i=this.tryEntries.length-1;i>=0;--i){var n=this.tryEntries[i];if(n.tryLoc<=this.prev&&m.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var r=o?o.completion:{};return r.type=t,r.arg=e,o?(this.method="next",this.next=o.finallyLoc,k):this.complete(r)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),k},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.finallyLoc===t)return this.complete(i.completion,i.afterLoc),u(i),k}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.tryLoc===t){var n=i.completion;if("throw"===n.type){var o=n.arg;u(i)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,i){return this.delegate={iterator:f(t),resultName:e,nextLoc:i},"next"===this.method&&(this.arg=g),k}},t}(t.exports);try{regeneratorRuntime=n}catch(t){Function("r","regeneratorRuntime = r")(n)}},9991:function(t,e,i){var n=i("2c74"),o=n.Symbol;t.exports=o},"9a0b":function(t,e,i){},"9b7b":function(t,e,i){(function(t){function n(t,e){if(e)return t.slice();var i=t.length,n=h?h(i):new t.constructor(i);return t.copy(n),n}var o=i("2c74"),r=e&&!e.nodeType&&e,a=r&&"object"==typeof t&&t&&!t.nodeType&&t,s=a&&a.exports===r,l=s?o.Buffer:void 0,h=l?l.allocUnsafe:void 0;t.exports=n}).call(this,i("62e4")(t))},"9bb8":function(t,e,i){function n(t){return r(t)&&o(t)==a}var o=i("e688"),r=i("00c2"),a="[object Map]";t.exports=n},"9cad":function(t,e,i){t.exports=function(t){function e(n){if(i[n])return i[n].exports;var o=i[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var i={};return e.m=t,e.c=i,e.d=function(t,i,n){e.o(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:n})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,i){if(1&i&&(t=e(t)),8&i)return t;if(4&i&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(e.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&i&&"string"!=typeof t)for(var o in t)e.d(n,o,function(e){return t[e]}.bind(null,o));return n},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s="fb15")}({"014b":function(t,e,i){"use strict";var n=i("e53d"),o=i("07e3"),r=i("8e60"),a=i("63b6"),s=i("9138"),l=i("ebfd").KEY,h=i("294c"),c=i("dbdb"),u=i("45f2"),d=i("62a0"),f=i("5168"),p=i("ccb9"),g=i("6718"),_=i("47ee"),m=i("9003"),v=i("e4ae"),y=i("f772"),w=i("241e"),b=i("36c3"),x=i("1bc3"),A=i("aebd"),C=i("a159"),T=i("0395"),k=i("bf0b"),S=i("9aa9"),E=i("d9f6"),I=i("c3a1"),L=k.f,R=E.f,P=T.f,O=n.Symbol,D=n.JSON,M=D&&D.stringify,N=f("_hidden"),B=f("toPrimitive"),F={}.propertyIsEnumerable,z=c("symbol-registry"),V=c("symbols"),U=c("op-symbols"),j=Object.prototype,H="function"==typeof O&&!!S.f,W=n.QObject,G=!W||!W.prototype||!W.prototype.findChild,Z=r&&h(function(){return 7!=C(R({},"a",{get:function(){return R(this,"a",{value:7}).a}})).a})?function(t,e,i){var n=L(j,e);n&&delete j[e],R(t,e,i),n&&t!==j&&R(j,e,n)}:R,X=function(t){var e=V[t]=C(O.prototype);return e._k=t,e},Y=H&&"symbol"==typeof O.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof O},$=function(t,e,i){return t===j&&$(U,e,i),v(t),e=x(e,!0),v(i),o(V,e)?(i.enumerable?(o(t,N)&&t[N][e]&&(t[N][e]=!1),i=C(i,{enumerable:A(0,!1)})):(o(t,N)||R(t,N,A(1,{})),t[N][e]=!0),Z(t,e,i)):R(t,e,i)},q=function(t,e){v(t);for(var i,n=_(e=b(e)),o=0,r=n.length;r>o;)$(t,i=n[o++],e[i]);return t},K=function(t,e){return void 0===e?C(t):q(C(t),e)},J=function(t){var e=F.call(this,t=x(t,!0));return!(this===j&&o(V,t)&&!o(U,t))&&(!(e||!o(this,t)||!o(V,t)||o(this,N)&&this[N][t])||e)},Q=function(t,e){if(t=b(t),e=x(e,!0),t!==j||!o(V,e)||o(U,e)){var i=L(t,e);return!i||!o(V,e)||o(t,N)&&t[N][e]||(i.enumerable=!0),i}},tt=function(t){for(var e,i=P(b(t)),n=[],r=0;i.length>r;)o(V,e=i[r++])||e==N||e==l||n.push(e);return n},et=function(t){for(var e,i=t===j,n=P(i?U:b(t)),r=[],a=0;n.length>a;)!o(V,e=n[a++])||i&&!o(j,e)||r.push(V[e]);return r};H||(O=function(){if(this instanceof O)throw TypeError("Symbol is not a constructor!");var t=d(arguments.length>0?arguments[0]:void 0),e=function(i){this===j&&e.call(U,i),o(this,N)&&o(this[N],t)&&(this[N][t]=!1),Z(this,t,A(1,i))};return r&&G&&Z(j,t,{configurable:!0,set:e}),X(t)},s(O.prototype,"toString",function(){return this._k}),k.f=Q,E.f=$,i("6abf").f=T.f=tt,i("355d").f=J,S.f=et,r&&!i("b8e3")&&s(j,"propertyIsEnumerable",J,!0),p.f=function(t){return X(f(t))}),a(a.G+a.W+a.F*!H,{Symbol:O});for(var it="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),nt=0;it.length>nt;)f(it[nt++]);for(var ot=I(f.store),rt=0;ot.length>rt;)g(ot[rt++]);a(a.S+a.F*!H,"Symbol",{for:function(t){return o(z,t+="")?z[t]:z[t]=O(t)},keyFor:function(t){if(!Y(t))throw TypeError(t+" is not a symbol!");for(var e in z)if(z[e]===t)return e},useSetter:function(){G=!0},useSimple:function(){G=!1}}),a(a.S+a.F*!H,"Object",{create:K,defineProperty:$,defineProperties:q,getOwnPropertyDescriptor:Q,getOwnPropertyNames:tt,getOwnPropertySymbols:et});var at=h(function(){S.f(1)});a(a.S+a.F*at,"Object",{getOwnPropertySymbols:function(t){return S.f(w(t))}}),D&&a(a.S+a.F*(!H||h(function(){var t=O();return"[null]"!=M([t])||"{}"!=M({a:t})||"{}"!=M(Object(t))})),"JSON",{stringify:function(t){for(var e,i,n=[t],o=1;arguments.length>o;)n.push(arguments[o++]);if(i=e=n[1],(y(e)||void 0!==t)&&!Y(t))return m(e)||(e=function(t,e){if("function"==typeof i&&(e=i.call(this,t,e)),!Y(e))return e}),n[1]=e,M.apply(D,n)}}),O.prototype[B]||i("35e8")(O.prototype,B,O.prototype.valueOf),u(O,"Symbol"),u(Math,"Math",!0),u(n.JSON,"JSON",!0)},"01f9":function(t,e,i){"use strict";var n=i("2d00"),o=i("5ca1"),r=i("2aba"),a=i("32e9"),s=i("84f2"),l=i("41a0"),h=i("7f20"),c=i("38fd"),u=i("2b4c")("iterator"),d=!([].keys&&"next"in[].keys()),f=function(){return this};t.exports=function(t,e,i,p,g,_,m){l(i,e,p);var v,y,w,b=function(t){if(!d&&t in T)return T[t];switch(t){case"keys":case"values":return function(){return new i(this,t)}}return function(){return new i(this,t)}},x=e+" Iterator",A="values"==g,C=!1,T=t.prototype,k=T[u]||T["@@iterator"]||g&&T[g],S=k||b(g),E=g?A?b("entries"):S:void 0,I="Array"==e?T.entries||k:k;if(I&&(w=c(I.call(new t)))!==Object.prototype&&w.next&&(h(w,x,!0),n||"function"==typeof w[u]||a(w,u,f)),A&&k&&"values"!==k.name&&(C=!0,S=function(){return k.call(this)}),n&&!m||!d&&!C&&T[u]||a(T,u,S),s[e]=S,s[x]=f,g)if(v={values:A?S:b("values"),keys:_?S:b("keys"),entries:E},m)for(y in v)y in T||r(T,y,v[y]);else o(o.P+o.F*(d||C),e,v);return v}},"02f4":function(t,e,i){var n=i("4588"),o=i("be13");t.exports=function(t){return function(e,i){var r,a,s=String(o(e)),l=n(i),h=s.length;return l<0||l>=h?t?"":void 0:(r=s.charCodeAt(l),r<55296||r>56319||l+1===h||(a=s.charCodeAt(l+1))<56320||a>57343?t?s.charAt(l):r:t?s.slice(l,l+2):a-56320+(r-55296<<10)+65536)}}},"0390":function(t,e,i){"use strict";var n=i("02f4")(!0);t.exports=function(t,e,i){return e+(i?n(t,e).length:1)}},"0395":function(t,e,i){var n=i("36c3"),o=i("6abf").f,r={}.toString,a="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],s=function(t){try{return o(t)}catch(t){return a.slice()}};t.exports.f=function(t){return a&&"[object Window]"==r.call(t)?s(t):o(n(t))}},"07e3":function(t,e){var i={}.hasOwnProperty;t.exports=function(t,e){return i.call(t,e)}},"0a49":function(t,e,i){var n=i("9b43"),o=i("626a"),r=i("4bf8"),a=i("9def"),s=i("cd1c");t.exports=function(t,e){var i=1==t,l=2==t,h=3==t,c=4==t,u=6==t,d=5==t||u,f=e||s;return function(e,s,p){for(var g,_,m=r(e),v=o(m),y=n(s,p,3),w=a(v.length),b=0,x=i?f(e,w):l?f(e,0):void 0;w>b;b++)if((d||b in v)&&(g=v[b],_=y(g,b,m),t))if(i)x[b]=_;else if(_)switch(t){case 3:return!0;case 5:return g;case 6:return b;case 2:x.push(g)}else if(c)return!1;return u?-1:h||c?c:x}}},"0bfb":function(t,e,i){"use strict";var n=i("cb7c");t.exports=function(){var t=n(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}},"0d58":function(t,e,i){var n=i("ce10"),o=i("e11e");t.exports=Object.keys||function(t){return n(t,o)}},"0fc9":function(t,e,i){var n=i("3a38"),o=Math.max,r=Math.min;t.exports=function(t,e){return t=n(t),t<0?o(t+e,0):r(t,e)}},1169:function(t,e,i){var n=i("2d95");t.exports=Array.isArray||function(t){return"Array"==n(t)}},1388:function(t,e,i){t.exports=function(t){function e(n){if(i[n])return i[n].exports;var o=i[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var i={};return e.m=t,e.c=i,e.d=function(t,i,n){e.o(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:n})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,i){if(1&i&&(t=e(t)),8&i)return t;if(4&i&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(e.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&i&&"string"!=typeof t)for(var o in t)e.d(n,o,function(e){return t[e]}.bind(null,o));return n},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="/dist/",e(e.s=124)}({0:function(t,e,i){"use strict";function n(t,e,i,n,o,r,a,s){var l="function"==typeof t?t.options:t;e&&(l.render=e,l.staticRenderFns=i,l._compiled=!0),n&&(l.functional=!0),r&&(l._scopeId="data-v-"+r);var h;if(a?(h=function(t){t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,t||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),o&&o.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(a)},l._ssrRegister=h):o&&(h=s?function(){o.call(this,this.$root.$options.shadowRoot)}:o),h)if(l.functional){l._injectStyles=h;var c=l.render;l.render=function(t,e){return h.call(e),c(t,e)}}else{var u=l.beforeCreate;l.beforeCreate=u?[].concat(u,h):[h]}return{exports:t,options:l}}i.d(e,"a",function(){return n})},124:function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement;return(t._self._c||e)("div",{staticClass:"el-button-group"},[t._t("default")],2)},o=[];n._withStripped=!0;var r={name:"ElButtonGroup"},a=r,s=i(0),l=Object(s.a)(a,n,o,!1,null,null,null);l.options.__file="packages/button/src/button-group.vue";var h=l.exports;h.install=function(t){t.component(h.name,h)},h.name="FiButtonGroup";e.default=h}})},1495:function(t,e,i){var n=i("86cc"),o=i("cb7c"),r=i("0d58");t.exports=i("9e1e")?Object.defineProperties:function(t,e){o(t);for(var i,a=r(e),s=a.length,l=0;s>l;)n.f(t,i=a[l++],e[i]);return t}},1654:function(t,e,i){"use strict";var n=i("71c1")(!0);i("30f1")(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,e=this._t,i=this._i;return i>=e.length?{value:void 0,done:!0}:(t=n(e,i),this._i+=t.length,{value:t,done:!1})})},1691:function(t,e){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},"1bc3":function(t,e,i){var n=i("f772");t.exports=function(t,e){if(!n(t))return t;var i,o;if(e&&"function"==typeof(i=t.toString)&&!n(o=i.call(t)))return o;if("function"==typeof(i=t.valueOf)&&!n(o=i.call(t)))return o;if(!e&&"function"==typeof(i=t.toString)&&!n(o=i.call(t)))return o;throw TypeError("Can't convert object to primitive value")}},"1ec9":function(t,e,i){var n=i("f772"),o=i("e53d").document,r=n(o)&&n(o.createElement);t.exports=function(t){return r?o.createElement(t):{}}},"214f":function(t,e,i){"use strict";i("b0c5");var n=i("2aba"),o=i("32e9"),r=i("79e5"),a=i("be13"),s=i("2b4c"),l=i("520a"),h=s("species"),c=!r(function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")}),u=function(){var t=/(?:)/,e=t.exec;t.exec=function(){return e.apply(this,arguments)};var i="ab".split(t);return 2===i.length&&"a"===i[0]&&"b"===i[1]}();t.exports=function(t,e,i){var d=s(t),f=!r(function(){var e={};return e[d]=function(){return 7},7!=""[t](e)}),p=f?!r(function(){var e=!1,i=/a/;return i.exec=function(){return e=!0,null},"split"===t&&(i.constructor={},i.constructor[h]=function(){return i}),i[d](""),!e}):void 0;if(!f||!p||"replace"===t&&!c||"split"===t&&!u){var g=/./[d],_=i(a,d,""[t],function(t,e,i,n,o){return e.exec===l?f&&!o?{done:!0,value:g.call(e,i,n)}:{done:!0,value:t.call(i,e,n)}:{done:!1}}),m=_[0],v=_[1];n(String.prototype,t,m),o(RegExp.prototype,d,2==e?function(t,e){return v.call(t,this,e)}:function(t){return v.call(t,this)})}}},"230e":function(t,e,i){var n=i("d3f4"),o=i("7726").document,r=n(o)&&n(o.createElement);t.exports=function(t){return r?o.createElement(t):{}}},"23af":function(t,e,i){"use strict";function n(){}function o(t,e){return u.call(t,e)}function r(t,e){for(var i in e)t[i]=e[i];return t}function a(t){for(var e={},i=0;i<t.length;i++)t[i]&&r(e,t[i]);return e}function s(t,e,i){var n=t;e=e.replace(/\[(\w+)\]/g,".$1"),e=e.replace(/^\./,"");for(var o=e.split("."),r=0,a=o.length;r<a-1&&(n||i);++r){var s=o[r];if(!(s in n)){if(i)throw new Error("please transfer a valid prop path to form item!");break}n=n[s]}return{o:n,k:o[r],v:n?n[o[r]]:null}}e.__esModule=!0,e.kebabCase=e.autoprefixer=e.isEdge=e.isIE=e.coerceTruthyValueToArray=e.arrayFind=e.arrayFindIndex=e.escapeRegexpString=e.valueEquals=e.generateId=e.getValueByPath=void 0;var l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.noop=n,e.hasOwn=o,e.toObject=a,e.getPropByPath=s;var h=i("8bbf"),c=function(t){return t&&t.__esModule?t:{default:t}}(h),u=Object.prototype.hasOwnProperty,d=(e.getValueByPath=function(t,e){e=e||"";for(var i=e.split("."),n=t,o=null,r=0,a=i.length;r<a;r++){var s=i[r];if(!n)break;if(r===a-1){o=n[s];break}n=n[s]}return o},e.generateId=function(){return Math.floor(1e4*Math.random())},e.valueEquals=function(t,e){if(t===e)return!0;if(!(t instanceof Array))return!1;if(!(e instanceof Array))return!1;if(t.length!==e.length)return!1;for(var i=0;i!==t.length;++i)if(t[i]!==e[i])return!1;return!0},e.escapeRegexpString=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return String(t).replace(/[|\\{}()[\]^$+*?.]/g,"\\$&")},e.arrayFindIndex=function(t,e){for(var i=0;i!==t.length;++i)if(e(t[i]))return i;return-1});e.arrayFind=function(t,e){var i=d(t,e);return-1!==i?t[i]:void 0},e.coerceTruthyValueToArray=function(t){return Array.isArray(t)?t:t?[t]:[]},e.isIE=function(){return!c.default.prototype.$isServer&&!isNaN(Number(document.documentMode))},e.isEdge=function(){return!c.default.prototype.$isServer&&navigator.userAgent.indexOf("Edge")>-1},e.autoprefixer=function(t){if("object"!==(void 0===t?"undefined":l(t)))return t;var e=["ms-","webkit-"];return["transform","transition","animation"].forEach(function(i){var n=t[i];i&&n&&e.forEach(function(e){t[e+i]=n})}),t},e.kebabCase=function(t){var e=/([^-])([A-Z])/g;return t.replace(e,"$1-$2").replace(e,"$1-$2").toLowerCase()}},"23c6":function(t,e,i){var n=i("2d95"),o=i("2b4c")("toStringTag"),r="Arguments"==n(function(){return arguments}()),a=function(t,e){try{return t[e]}catch(t){}};t.exports=function(t){var e,i,s;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(i=a(e=Object(t),o))?i:r?n(e):"Object"==(s=n(e))&&"function"==typeof e.callee?"Arguments":s}},"241e":function(t,e,i){var n=i("25eb");t.exports=function(t){return Object(n(t))}},"25eb":function(t,e){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},"28a5":function(t,e,i){"use strict";var n=i("aae3"),o=i("cb7c"),r=i("ebd6"),a=i("0390"),s=i("9def"),l=i("5f1b"),h=i("520a"),c=i("79e5"),u=Math.min,d=[].push,f="length",p=!c(function(){RegExp(4294967295,"y")});i("214f")("split",2,function(t,e,i,c){var g;return g="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1)[f]||2!="ab".split(/(?:ab)*/)[f]||4!=".".split(/(.?)(.?)/)[f]||".".split(/()()/)[f]>1||"".split(/.?/)[f]?function(t,e){var o=String(this);if(void 0===t&&0===e)return[];if(!n(t))return i.call(o,t,e);for(var r,a,s,l=[],c=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),u=0,p=void 0===e?4294967295:e>>>0,g=new RegExp(t.source,c+"g");(r=h.call(g,o))&&!((a=g.lastIndex)>u&&(l.push(o.slice(u,r.index)),r[f]>1&&r.index<o[f]&&d.apply(l,r.slice(1)),s=r[0][f],u=a,l[f]>=p));)g.lastIndex===r.index&&g.lastIndex++;return u===o[f]?!s&&g.test("")||l.push(""):l.push(o.slice(u)),l[f]>p?l.slice(0,p):l}:"0".split(void 0,0)[f]?function(t,e){return void 0===t&&0===e?[]:i.call(this,t,e)}:i,[function(i,n){var o=t(this),r=void 0==i?void 0:i[e];return void 0!==r?r.call(i,o,n):g.call(String(o),i,n)},function(t,e){var n=c(g,t,this,e,g!==i);if(n.done)return n.value;var h=o(t),d=String(this),f=r(h,RegExp),_=h.unicode,m=(h.ignoreCase?"i":"")+(h.multiline?"m":"")+(h.unicode?"u":"")+(p?"y":"g"),v=new f(p?h:"^(?:"+h.source+")",m),y=void 0===e?4294967295:e>>>0;if(0===y)return[];if(0===d.length)return null===l(v,d)?[d]:[];for(var w=0,b=0,x=[];b<d.length;){v.lastIndex=p?b:0;var A,C=l(v,p?d:d.slice(b));if(null===C||(A=u(s(v.lastIndex+(p?0:b)),d.length))===w)b=a(d,b,_);else{if(x.push(d.slice(w,b)),x.length===y)return x;for(var T=1;T<=C.length-1;T++)if(x.push(C[T]),x.length===y)return x;b=w=A}}return x.push(d.slice(w)),x}]})},"294c":function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},"2aba":function(t,e,i){var n=i("7726"),o=i("32e9"),r=i("69a8"),a=i("ca5a")("src"),s=i("fa5b"),l=(""+s).split("toString");i("8378").inspectSource=function(t){return s.call(t)},(t.exports=function(t,e,i,s){var h="function"==typeof i;h&&(r(i,"name")||o(i,"name",e)),t[e]!==i&&(h&&(r(i,a)||o(i,a,t[e]?""+t[e]:l.join(String(e)))),t===n?t[e]=i:s?t[e]?t[e]=i:o(t,e,i):(delete t[e],o(t,e,i)))})(Function.prototype,"toString",function(){return"function"==typeof this&&this[a]||s.call(this)})},"2aeb":function(t,e,i){var n=i("cb7c"),o=i("1495"),r=i("e11e"),a=i("613b")("IE_PROTO"),s=function(){},l=function(){var t,e=i("230e")("iframe"),n=r.length;for(e.style.display="none",i("fab2").appendChild(e),e.src="javascript:",t=e.contentWindow.document,t.open(),t.write("<script>document.F=Object<\/script>"),t.close(),l=t.F;n--;)delete l.prototype[r[n]];return l()};t.exports=Object.create||function(t,e){var i;return null!==t?(s.prototype=n(t),i=new s,s.prototype=null,i[a]=t):i=l(),void 0===e?i:o(i,e)}},"2b4c":function(t,e,i){var n=i("5537")("wks"),o=i("ca5a"),r=i("7726").Symbol,a="function"==typeof r;(t.exports=function(t){return n[t]||(n[t]=a&&r[t]||(a?r:o)("Symbol."+t))}).store=n},"2d00":function(t,e){t.exports=!1},"2d95":function(t,e){var i={}.toString;t.exports=function(t){return i.call(t).slice(8,-1)}},"30f1":function(t,e,i){"use strict";var n=i("b8e3"),o=i("63b6"),r=i("9138"),a=i("35e8"),s=i("481b"),l=i("8f60"),h=i("45f2"),c=i("53e2"),u=i("5168")("iterator"),d=!([].keys&&"next"in[].keys()),f=function(){return this};t.exports=function(t,e,i,p,g,_,m){l(i,e,p);var v,y,w,b=function(t){if(!d&&t in T)return T[t];switch(t){case"keys":case"values":return function(){return new i(this,t)}}return function(){return new i(this,t)}},x=e+" Iterator",A="values"==g,C=!1,T=t.prototype,k=T[u]||T["@@iterator"]||g&&T[g],S=k||b(g),E=g?A?b("entries"):S:void 0,I="Array"==e?T.entries||k:k;if(I&&(w=c(I.call(new t)))!==Object.prototype&&w.next&&(h(w,x,!0),n||"function"==typeof w[u]||a(w,u,f)),A&&k&&"values"!==k.name&&(C=!0,S=function(){return k.call(this)}),n&&!m||!d&&!C&&T[u]||a(T,u,S),s[e]=S,s[x]=f,g)if(v={values:A?S:b("values"),keys:_?S:b("keys"),entries:E},m)for(y in v)y in T||r(T,y,v[y]);else o(o.P+o.F*(d||C),e,v);return v}},"32e9":function(t,e,i){var n=i("86cc"),o=i("4630");t.exports=i("9e1e")?function(t,e,i){return n.f(t,e,o(1,i))}:function(t,e,i){return t[e]=i,t}},"32fc":function(t,e,i){var n=i("e53d").document;t.exports=n&&n.documentElement},"335c":function(t,e,i){var n=i("6b4c");t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==n(t)?t.split(""):Object(t)}},"355d":function(t,e){e.f={}.propertyIsEnumerable},"35e8":function(t,e,i){var n=i("d9f6"),o=i("aebd");t.exports=i("8e60")?function(t,e,i){return n.f(t,e,o(1,i))}:function(t,e,i){return t[e]=i,t}},"36c3":function(t,e,i){var n=i("335c"),o=i("25eb");t.exports=function(t){return n(o(t))}},"38fd":function(t,e,i){var n=i("69a8"),o=i("4bf8"),r=i("613b")("IE_PROTO"),a=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=o(t),n(t,r)?t[r]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?a:null}},"39d2":function(t,e,i){"use strict";e.__esModule=!0;var n=i("8bbf"),o=function(t){return t&&t.__esModule?t:{default:t}}(n),r=i("73fa"),a=!1,s=!1,l=2e3,h=function(){if(!o.default.prototype.$isServer){var t=u.modalDom;return t?a=!0:(a=!1,t=document.createElement("div"),u.modalDom=t,t.addEventListener("touchmove",function(t){t.preventDefault(),t.stopPropagation()}),t.addEventListener("click",function(){u.doOnModalClick&&u.doOnModalClick()})),t}},c={},u={modalFade:!0,getInstance:function(t){return c[t]},register:function(t,e){t&&e&&(c[t]=e)},deregister:function(t){t&&(c[t]=null,delete c[t])},nextZIndex:function(){return u.zIndex++},modalStack:[],doOnModalClick:function(){var t=u.modalStack[u.modalStack.length-1];if(t){var e=u.getInstance(t.id);e&&e.closeOnClickModal&&e.close()}},openModal:function(t,e,i,n,s){if(!o.default.prototype.$isServer&&t&&void 0!==e){this.modalFade=s;for(var l=this.modalStack,c=0,u=l.length;c<u;c++){if(l[c].id===t)return}var d=h();if((0,r.addClass)(d,"v-modal"),this.modalFade&&!a&&(0,r.addClass)(d,"v-modal-enter"),n){n.trim().split(/\s+/).forEach(function(t){return(0,r.addClass)(d,t)})}setTimeout(function(){(0,r.removeClass)(d,"v-modal-enter")},200),i&&i.parentNode&&11!==i.parentNode.nodeType?i.parentNode.appendChild(d):document.body.appendChild(d),e&&(d.style.zIndex=e),d.tabIndex=0,d.style.display="",this.modalStack.push({id:t,zIndex:e,modalClass:n})}},closeModal:function(t){var e=this.modalStack,i=h();if(e.length>0){var n=e[e.length-1];if(n.id===t){if(n.modalClass){n.modalClass.trim().split(/\s+/).forEach(function(t){return(0,r.removeClass)(i,t)})}e.pop(),e.length>0&&(i.style.zIndex=e[e.length-1].zIndex)}else for(var o=e.length-1;o>=0;o--)if(e[o].id===t){e.splice(o,1);break}}0===e.length&&(this.modalFade&&(0,r.addClass)(i,"v-modal-leave"),setTimeout(function(){0===e.length&&(i.parentNode&&i.parentNode.removeChild(i),i.style.display="none",u.modalDom=void 0),(0,r.removeClass)(i,"v-modal-leave")},200))}};Object.defineProperty(u,"zIndex",{configurable:!0,get:function(){return s||(l=(o.default.prototype.$ELEMENT||{}).zIndex||l,s=!0),l},set:function(t){l=t}});var d=function(){if(!o.default.prototype.$isServer&&u.modalStack.length>0){var t=u.modalStack[u.modalStack.length-1];if(!t)return;return u.getInstance(t.id)}};o.default.prototype.$isServer||window.addEventListener("keydown",function(t){if(27===t.keyCode){var e=d();e&&e.closeOnPressEscape&&(e.handleClose?e.handleClose():e.handleAction?e.handleAction("cancel"):e.close())}}),e.default=u},"3a38":function(t,e){var i=Math.ceil,n=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?n:i)(t)}},"3aff":function(t,e,i){"use strict";var n=i("7144"),o=i.n(n);o.a},"3eaf":function(t,e,i){"use strict";e.__esModule=!0,e.default=function(t){for(var e=1,i=arguments.length;e<i;e++){var n=arguments[e]||{};for(var o in n)if(n.hasOwnProperty(o)){var r=n[o];void 0!==r&&(t[o]=r)}}return t}},"41a0":function(t,e,i){"use strict";var n=i("2aeb"),o=i("4630"),r=i("7f20"),a={};i("32e9")(a,i("2b4c")("iterator"),function(){return this}),t.exports=function(t,e,i){t.prototype=n(a,{next:o(1,i)}),r(t,e+" Iterator")}},"437e":function(t,e,i){"use strict";var n,o;"function"==typeof Symbol&&Symbol.iterator;!function(r,a){n=a,void 0!==(o="function"==typeof n?n.call(e,i,e,t):n)&&(t.exports=o)}(0,function(){function t(t,e,i){this._reference=t.jquery?t[0]:t,this.state={};var n=void 0===e||null===e,o=e&&"[object Object]"===Object.prototype.toString.call(e);return this._popper=n||o?this.parse(o?e:{}):e.jquery?e[0]:e,this._options=Object.assign({},_,i),this._options.modifiers=this._options.modifiers.map(function(t){if(-1===this._options.modifiersIgnored.indexOf(t))return"applyStyle"===t&&this._popper.setAttribute("x-placement",this._options.placement),this.modifiers[t]||t}.bind(this)),this.state.position=this._getPosition(this._popper,this._reference),h(this._popper,{position:this.state.position,top:0}),this.update(),this._setupEventListeners(),this}function e(t){var e=t.style.display,i=t.style.visibility;t.style.display="block",t.style.visibility="hidden";var n=(t.offsetWidth,g.getComputedStyle(t)),o=parseFloat(n.marginTop)+parseFloat(n.marginBottom),r=parseFloat(n.marginLeft)+parseFloat(n.marginRight),a={width:t.offsetWidth+r,height:t.offsetHeight+o};return t.style.display=e,t.style.visibility=i,a}function i(t){var e={left:"right",right:"left",bottom:"top",top:"bottom"};return t.replace(/left|right|bottom|top/g,function(t){return e[t]})}function n(t){var e=Object.assign({},t);return e.right=e.left+e.width,e.bottom=e.top+e.height,e}function o(t,e){var i,n=0;for(i in t){if(t[i]===e)return n;n++}return null}function r(t,e){return g.getComputedStyle(t,null)[e]}function a(t){var e=t.offsetParent;return e!==g.document.body&&e?e:g.document.documentElement}function s(t){var e=t.parentNode;return e?e===g.document?g.document.body.scrollTop||g.document.body.scrollLeft?g.document.body:g.document.documentElement:-1!==["scroll","auto"].indexOf(r(e,"overflow"))||-1!==["scroll","auto"].indexOf(r(e,"overflow-x"))||-1!==["scroll","auto"].indexOf(r(e,"overflow-y"))?e:s(t.parentNode):t}function l(t){return t!==g.document.body&&("fixed"===r(t,"position")||(t.parentNode?l(t.parentNode):t))}function h(t,e){function i(t){return""!==t&&!isNaN(parseFloat(t))&&isFinite(t)}Object.keys(e).forEach(function(n){var o="";-1!==["width","height","top","right","bottom","left"].indexOf(n)&&i(e[n])&&(o="px"),t.style[n]=e[n]+o})}function c(t){var e={};return t&&"[object Function]"===e.toString.call(t)}function u(t){var e={width:t.offsetWidth,height:t.offsetHeight,left:t.offsetLeft,top:t.offsetTop};return e.right=e.left+e.width,e.bottom=e.top+e.height,e}function d(t){var e=t.getBoundingClientRect(),i=-1!=navigator.userAgent.indexOf("MSIE"),n=i&&"HTML"===t.tagName?-t.scrollTop:e.top;return{left:e.left,top:n,right:e.right,bottom:e.bottom,width:e.right-e.left,height:e.bottom-n}}function f(t,e,i){var n=d(t),o=d(e);if(i){var r=s(e);o.top+=r.scrollTop,o.bottom+=r.scrollTop,o.left+=r.scrollLeft,o.right+=r.scrollLeft}return{top:n.top-o.top,left:n.left-o.left,bottom:n.top-o.top+n.height,right:n.left-o.left+n.width,width:n.width,height:n.height}}function p(t){for(var e=["","ms","webkit","moz","o"],i=0;i<e.length;i++){var n=e[i]?e[i]+t.charAt(0).toUpperCase()+t.slice(1):t;if(void 0!==g.document.body.style[n])return n}return null}var g=window,_={placement:"bottom",gpuAcceleration:!0,offset:0,boundariesElement:"viewport",boundariesPadding:5,preventOverflowOrder:["left","right","top","bottom"],flipBehavior:"flip",arrowElement:"[x-arrow]",arrowOffset:0,modifiers:["shift","offset","preventOverflow","keepTogether","arrow","flip","applyStyle"],modifiersIgnored:[],forceAbsolute:!1};return t.prototype.destroy=function(){return this._popper.removeAttribute("x-placement"),this._popper.style.left="",this._popper.style.position="",this._popper.style.top="",this._popper.style[p("transform")]="",this._removeEventListeners(),this._options.removeOnDestroy&&this._popper.remove(),this},t.prototype.update=function(){var t={instance:this,styles:{}};t.placement=this._options.placement,t._originalPlacement=this._options.placement,t.offsets=this._getOffsets(this._popper,this._reference,t.placement),t.boundaries=this._getBoundaries(t,this._options.boundariesPadding,this._options.boundariesElement),t=this.runModifiers(t,this._options.modifiers),"function"==typeof this.state.updateCallback&&this.state.updateCallback(t)},t.prototype.onCreate=function(t){return t(this),this},t.prototype.onUpdate=function(t){return this.state.updateCallback=t,this},t.prototype.parse=function(t){function e(t,e){e.forEach(function(e){t.classList.add(e)})}function i(t,e){e.forEach(function(e){t.setAttribute(e.split(":")[0],e.split(":")[1]||"")})}var n={tagName:"div",classNames:["popper"],attributes:[],parent:g.document.body,content:"",contentType:"text",arrowTagName:"div",arrowClassNames:["popper__arrow"],arrowAttributes:["x-arrow"]};t=Object.assign({},n,t);var o=g.document,r=o.createElement(t.tagName);if(e(r,t.classNames),i(r,t.attributes),"node"===t.contentType?r.appendChild(t.content.jquery?t.content[0]:t.content):"html"===t.contentType?r.innerHTML=t.content:r.textContent=t.content,t.arrowTagName){var a=o.createElement(t.arrowTagName);e(a,t.arrowClassNames),i(a,t.arrowAttributes),r.appendChild(a)}var s=t.parent.jquery?t.parent[0]:t.parent;if("string"==typeof s){if(s=o.querySelectorAll(t.parent),s.length>1&&console.warn("WARNING: the given `parent` query("+t.parent+") matched more than one element, the first one will be used"),0===s.length)throw"ERROR: the given `parent` doesn't exists!";s=s[0]}return s.length>1&&s instanceof Element==!1&&(console.warn("WARNING: you have passed as parent a list of elements, the first one will be used"),s=s[0]),s.appendChild(r),r},t.prototype._getPosition=function(t,e){var i=a(e);return this._options.forceAbsolute?"absolute":l(e,i)?"fixed":"absolute"},t.prototype._getOffsets=function(t,i,n){n=n.split("-")[0];var o={};o.position=this.state.position;var r="fixed"===o.position,s=f(i,a(t),r),l=e(t);return-1!==["right","left"].indexOf(n)?(o.top=s.top+s.height/2-l.height/2,o.left="left"===n?s.left-l.width:s.right):(o.left=s.left+s.width/2-l.width/2,o.top="top"===n?s.top-l.height:s.bottom),o.width=l.width,o.height=l.height,{popper:o,reference:s}},t.prototype._setupEventListeners=function(){if(this.state.updateBound=this.update.bind(this),g.addEventListener("resize",this.state.updateBound),"window"!==this._options.boundariesElement){var t=s(this._reference);t!==g.document.body&&t!==g.document.documentElement||(t=g),t.addEventListener("scroll",this.state.updateBound),this.state.scrollTarget=t}},t.prototype._removeEventListeners=function(){g.removeEventListener("resize",this.state.updateBound),"window"!==this._options.boundariesElement&&this.state.scrollTarget&&(this.state.scrollTarget.removeEventListener("scroll",this.state.updateBound),this.state.scrollTarget=null),this.state.updateBound=null},t.prototype._getBoundaries=function(t,e,i){var n,o,r={};if("window"===i){var l=g.document.body,h=g.document.documentElement;o=Math.max(l.scrollHeight,l.offsetHeight,h.clientHeight,h.scrollHeight,h.offsetHeight),n=Math.max(l.scrollWidth,l.offsetWidth,h.clientWidth,h.scrollWidth,h.offsetWidth),r={top:0,right:n,bottom:o,left:0}}else if("viewport"===i){var c=a(this._popper),d=s(this._popper),f=u(c),p="fixed"===t.offsets.popper.position?0:function(t){return t==document.body?Math.max(document.documentElement.scrollTop,document.body.scrollTop):t.scrollTop}(d),_="fixed"===t.offsets.popper.position?0:function(t){return t==document.body?Math.max(document.documentElement.scrollLeft,document.body.scrollLeft):t.scrollLeft}(d);r={top:0-(f.top-p),right:g.document.documentElement.clientWidth-(f.left-_),bottom:g.document.documentElement.clientHeight-(f.top-p),left:0-(f.left-_)}}else r=a(this._popper)===i?{top:0,left:0,right:i.clientWidth,bottom:i.clientHeight}:u(i);return r.left+=e,r.right-=e,r.top=r.top+e,r.bottom=r.bottom-e,r},t.prototype.runModifiers=function(t,e,i){var n=e.slice();return void 0!==i&&(n=this._options.modifiers.slice(0,o(this._options.modifiers,i))),n.forEach(function(e){c(e)&&(t=e.call(this,t))}.bind(this)),t},t.prototype.isModifierRequired=function(t,e){var i=o(this._options.modifiers,t);return!!this._options.modifiers.slice(0,i).filter(function(t){return t===e}).length},t.prototype.modifiers={},t.prototype.modifiers.applyStyle=function(t){var e,i={position:t.offsets.popper.position},n=Math.round(t.offsets.popper.left),o=Math.round(t.offsets.popper.top);return this._options.gpuAcceleration&&(e=p("transform"))?(i[e]="translate3d("+n+"px, "+o+"px, 0)",i.top=0,i.left=0):(i.left=n,i.top=o),Object.assign(i,t.styles),h(this._popper,i),this._popper.setAttribute("x-placement",t.placement),this.isModifierRequired(this.modifiers.applyStyle,this.modifiers.arrow)&&t.offsets.arrow&&h(t.arrowElement,t.offsets.arrow),t},t.prototype.modifiers.shift=function(t){var e=t.placement,i=e.split("-")[0],o=e.split("-")[1];if(o){var r=t.offsets.reference,a=n(t.offsets.popper),s={y:{start:{top:r.top},end:{top:r.top+r.height-a.height}},x:{start:{left:r.left},end:{left:r.left+r.width-a.width}}},l=-1!==["bottom","top"].indexOf(i)?"x":"y";t.offsets.popper=Object.assign(a,s[l][o])}return t},t.prototype.modifiers.preventOverflow=function(t){var e=this._options.preventOverflowOrder,i=n(t.offsets.popper),o={left:function(){var e=i.left;return i.left<t.boundaries.left&&(e=Math.max(i.left,t.boundaries.left)),{left:e}},right:function(){var e=i.left;return i.right>t.boundaries.right&&(e=Math.min(i.left,t.boundaries.right-i.width)),{left:e}},top:function(){var e=i.top;return i.top<t.boundaries.top&&(e=Math.max(i.top,t.boundaries.top)),{top:e}},bottom:function(){var e=i.top;return i.bottom>t.boundaries.bottom&&(e=Math.min(i.top,t.boundaries.bottom-i.height)),{top:e}}};return e.forEach(function(e){t.offsets.popper=Object.assign(i,o[e]())}),t},t.prototype.modifiers.keepTogether=function(t){var e=n(t.offsets.popper),i=t.offsets.reference,o=Math.floor;return e.right<o(i.left)&&(t.offsets.popper.left=o(i.left)-e.width),e.left>o(i.right)&&(t.offsets.popper.left=o(i.right)),e.bottom<o(i.top)&&(t.offsets.popper.top=o(i.top)-e.height),e.top>o(i.bottom)&&(t.offsets.popper.top=o(i.bottom)),t},t.prototype.modifiers.flip=function(t){if(!this.isModifierRequired(this.modifiers.flip,this.modifiers.preventOverflow))return console.warn("WARNING: preventOverflow modifier is required by flip modifier in order to work, be sure to include it before flip!"),t;if(t.flipped&&t.placement===t._originalPlacement)return t;var e=t.placement.split("-")[0],o=i(e),r=t.placement.split("-")[1]||"",a=[];return a="flip"===this._options.flipBehavior?[e,o]:this._options.flipBehavior,a.forEach(function(s,l){if(e===s&&a.length!==l+1){e=t.placement.split("-")[0],o=i(e);var h=n(t.offsets.popper),c=-1!==["right","bottom"].indexOf(e);(c&&Math.floor(t.offsets.reference[e])>Math.floor(h[o])||!c&&Math.floor(t.offsets.reference[e])<Math.floor(h[o]))&&(t.flipped=!0,t.placement=a[l+1],r&&(t.placement+="-"+r),t.offsets.popper=this._getOffsets(this._popper,this._reference,t.placement).popper,t=this.runModifiers(t,this._options.modifiers,this._flip))}}.bind(this)),t},t.prototype.modifiers.offset=function(t){var e=this._options.offset,i=t.offsets.popper;return-1!==t.placement.indexOf("left")?i.top-=e:-1!==t.placement.indexOf("right")?i.top+=e:-1!==t.placement.indexOf("top")?i.left-=e:-1!==t.placement.indexOf("bottom")&&(i.left+=e),t},t.prototype.modifiers.arrow=function(t){var i=this._options.arrowElement,o=this._options.arrowOffset;if("string"==typeof i&&(i=this._popper.querySelector(i)),!i)return t;if(!this._popper.contains(i))return console.warn("WARNING: `arrowElement` must be child of its popper element!"),t;if(!this.isModifierRequired(this.modifiers.arrow,this.modifiers.keepTogether))return console.warn("WARNING: keepTogether modifier is required by arrow modifier in order to work, be sure to include it before arrow!"),t;var r={},a=t.placement.split("-")[0],s=n(t.offsets.popper),l=t.offsets.reference,h=-1!==["left","right"].indexOf(a),c=h?"height":"width",u=h?"top":"left",d=h?"left":"top",f=h?"bottom":"right",p=e(i)[c];l[f]-p<s[u]&&(t.offsets.popper[u]-=s[u]-(l[f]-p)),l[u]+p>s[f]&&(t.offsets.popper[u]+=l[u]+p-s[f]);var g=l[u]+(o||l[c]/2-p/2),_=g-s[u];return _=Math.max(Math.min(s[c]-p-8,_),8),r[u]=_,r[d]="",t.offsets.arrow=r,t.arrowElement=i,t},Object.assign||Object.defineProperty(Object,"assign",{enumerable:!1,configurable:!0,writable:!0,value:function(t){if(void 0===t||null===t)throw new TypeError("Cannot convert first argument to object");for(var e=Object(t),i=1;i<arguments.length;i++){var n=arguments[i];if(void 0!==n&&null!==n){n=Object(n);for(var o=Object.keys(n),r=0,a=o.length;r<a;r++){var s=o[r],l=Object.getOwnPropertyDescriptor(n,s);void 0!==l&&l.enumerable&&(e[s]=n[s])}}}return e}}),t})},"456d":function(t,e,i){var n=i("4bf8"),o=i("0d58");i("5eda")("keys",function(){return function(t){return o(n(t))}})},4588:function(t,e){var i=Math.ceil,n=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?n:i)(t)}},"45f2":function(t,e,i){var n=i("d9f6").f,o=i("07e3"),r=i("5168")("toStringTag");t.exports=function(t,e,i){t&&!o(t=i?t:t.prototype,r)&&n(t,r,{configurable:!0,value:e})}},4630:function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},"47ee":function(t,e,i){var n=i("c3a1"),o=i("9aa9"),r=i("355d");t.exports=function(t){var e=n(t),i=o.f;if(i)for(var a,s=i(t),l=r.f,h=0;s.length>h;)l.call(t,a=s[h++])&&e.push(a);return e}},4800:function(t,e,i){t.exports=function(t){function e(n){if(i[n])return i[n].exports;var o=i[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var i={};return e.m=t,e.c=i,e.d=function(t,i,n){e.o(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:n})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,i){if(1&i&&(t=e(t)),8&i)return t;if(4&i&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(e.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&i&&"string"!=typeof t)for(var o in t)e.d(n,o,function(e){return t[e]}.bind(null,o));return n},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="/dist/",e(e.s=64)}({0:function(t,e,i){"use strict";function n(t,e,i,n,o,r,a,s){var l="function"==typeof t?t.options:t;e&&(l.render=e,l.staticRenderFns=i,l._compiled=!0),n&&(l.functional=!0),r&&(l._scopeId="data-v-"+r);var h;if(a?(h=function(t){t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,t||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),o&&o.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(a)},l._ssrRegister=h):o&&(h=s?function(){o.call(this,this.$root.$options.shadowRoot)}:o),h)if(l.functional){l._injectStyles=h;var c=l.render;l.render=function(t,e){return h.call(e),c(t,e)}}else{var u=l.beforeCreate;l.beforeCreate=u?[].concat(u,h):[h]}return{exports:t,options:l}}i.d(e,"a",function(){return n})},5:function(t,e){t.exports=i("c27e")},64:function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("transition",{attrs:{name:"el-zoom-in-top"},on:{"after-leave":t.doDestroy}},[i("ul",{directives:[{name:"show",rawName:"v-show",value:t.showPopper,expression:"showPopper"}],staticClass:"el-dropdown-menu el-popper",class:[t.size&&"el-dropdown-menu--"+t.size]},[t._t("default")],2)])},o=[];n._withStripped=!0;var r=i(5),a=i.n(r),s={name:"ElDropdownMenu",componentName:"ElDropdownMenu",mixins:[a.a],props:{visibleArrow:{type:Boolean,default:!0},arrowOffset:{type:Number,default:0}},data:function(){return{size:this.dropdown.dropdownSize}},inject:["dropdown"],created:function(){var t=this;this.$on("updatePopper",function(){t.showPopper&&t.updatePopper()}),this.$on("visible",function(e){t.showPopper=e})},mounted:function(){this.dropdown.popperElm=this.popperElm=this.$el,this.referenceElm=this.dropdown.$el,this.dropdown.initDomOperation()},watch:{"dropdown.placement":{immediate:!0,handler:function(t){this.currentPlacement=t}}}},l=s,h=i(0),c=Object(h.a)(l,n,o,!1,null,null,null);c.options.__file="packages/dropdown/src/dropdown-menu.vue";var u=c.exports;u.install=function(t){t.component(u.name,u)},u.name="FiDropdownMenu";e.default=u}})},"481b":function(t,e){t.exports={}},"4bf8":function(t,e,i){var n=i("be13");t.exports=function(t){return Object(n(t))}},"4ff6":function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0,e.PopupManager=void 0;var o=i("8bbf"),r=n(o),a=i("3eaf"),s=n(a),l=i("39d2"),h=n(l),c=i("9aea"),u=n(c),d=i("73fa"),f=1,p=void 0;e.default={props:{visible:{type:Boolean,default:!1},openDelay:{},closeDelay:{},zIndex:{},modal:{type:Boolean,default:!1},modalFade:{type:Boolean,default:!0},modalClass:{},modalAppendToBody:{type:Boolean,default:!1},lockScroll:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!1},closeOnClickModal:{type:Boolean,default:!1}},beforeMount:function(){this._popupId="popup-"+f++,h.default.register(this._popupId,this)},beforeDestroy:function(){h.default.deregister(this._popupId),h.default.closeModal(this._popupId),this.restoreBodyStyle()},data:function(){return{opened:!1,bodyPaddingRight:null,computedBodyPaddingRight:0,withoutHiddenClass:!0,rendered:!1}},watch:{visible:function(t){var e=this;if(t){if(this._opening)return;this.rendered?this.open():(this.rendered=!0,r.default.nextTick(function(){e.open()}))}else this.close()}},methods:{open:function(t){var e=this;this.rendered||(this.rendered=!0);var i=(0,s.default)({},this.$props||this,t);this._closeTimer&&(clearTimeout(this._closeTimer),this._closeTimer=null),clearTimeout(this._openTimer);var n=Number(i.openDelay);n>0?this._openTimer=setTimeout(function(){e._openTimer=null,e.doOpen(i)},n):this.doOpen(i)},doOpen:function(t){if(!this.$isServer&&(!this.willOpen||this.willOpen())&&!this.opened){this._opening=!0;var e=this.$el,i=t.modal,n=t.zIndex;if(n&&(h.default.zIndex=n),i&&(this._closing&&(h.default.closeModal(this._popupId),this._closing=!1),h.default.openModal(this._popupId,h.default.nextZIndex(),this.modalAppendToBody?void 0:e,t.modalClass,t.modalFade),t.lockScroll)){this.withoutHiddenClass=!(0,d.hasClass)(document.body,"el-popup-parent--hidden"),this.withoutHiddenClass&&(this.bodyPaddingRight=document.body.style.paddingRight,this.computedBodyPaddingRight=parseInt((0,d.getStyle)(document.body,"paddingRight"),10)),p=(0,u.default)();var o=document.documentElement.clientHeight<document.body.scrollHeight,r=(0,d.getStyle)(document.body,"overflowY");p>0&&(o||"scroll"===r)&&this.withoutHiddenClass&&(document.body.style.paddingRight=this.computedBodyPaddingRight+p+"px"),(0,d.addClass)(document.body,"el-popup-parent--hidden")}"static"===getComputedStyle(e).position&&(e.style.position="absolute"),e.style.zIndex=h.default.nextZIndex(),this.opened=!0,this.onOpen&&this.onOpen(),this.doAfterOpen()}},doAfterOpen:function(){this._opening=!1},close:function(){var t=this;if(!this.willClose||this.willClose()){null!==this._openTimer&&(clearTimeout(this._openTimer),this._openTimer=null),clearTimeout(this._closeTimer);var e=Number(this.closeDelay);e>0?this._closeTimer=setTimeout(function(){t._closeTimer=null,t.doClose()},e):this.doClose()}},doClose:function(){this._closing=!0,this.onClose&&this.onClose(),this.lockScroll&&setTimeout(this.restoreBodyStyle,200),this.opened=!1,this.doAfterClose()},doAfterClose:function(){h.default.closeModal(this._popupId),this._closing=!1},restoreBodyStyle:function(){this.modal&&this.withoutHiddenClass&&(document.body.style.paddingRight=this.bodyPaddingRight,(0,d.removeClass)(document.body,"el-popup-parent--hidden")),this.withoutHiddenClass=!0}}},e.PopupManager=h.default},"50ed":function(t,e){t.exports=function(t,e){return{value:e,done:!!t}}},5168:function(t,e,i){var n=i("dbdb")("wks"),o=i("62a0"),r=i("e53d").Symbol,a="function"==typeof r;(t.exports=function(t){return n[t]||(n[t]=a&&r[t]||(a?r:o)("Symbol."+t))}).store=n},"520a":function(t,e,i){"use strict";var n=i("0bfb"),o=RegExp.prototype.exec,r=String.prototype.replace,a=o,s=function(){var t=/a/,e=/b*/g;return o.call(t,"a"),o.call(e,"a"),0!==t.lastIndex||0!==e.lastIndex}(),l=void 0!==/()??/.exec("")[1];(s||l)&&(a=function(t){var e,i,a,h,c=this;return l&&(i=new RegExp("^"+c.source+"$(?!\\s)",n.call(c))),s&&(e=c.lastIndex),a=o.call(c,t),s&&a&&(c.lastIndex=c.global?a.index+a[0].length:e),l&&a&&a.length>1&&r.call(a[0],i,function(){for(h=1;h<arguments.length-2;h++)void 0===arguments[h]&&(a[h]=void 0)}),a}),t.exports=a},"53e2":function(t,e,i){var n=i("07e3"),o=i("241e"),r=i("5559")("IE_PROTO"),a=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=o(t),n(t,r)?t[r]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?a:null}},5537:function(t,e,i){var n=i("8378"),o=i("7726"),r=o["__core-js_shared__"]||(o["__core-js_shared__"]={});(t.exports=function(t,e){return r[t]||(r[t]=void 0!==e?e:{})})("versions",[]).push({version:n.version,mode:i("2d00")?"pure":"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})},5559:function(t,e,i){var n=i("dbdb")("keys"),o=i("62a0");t.exports=function(t){return n[t]||(n[t]=o(t))}},"584a":function(t,e){var i=t.exports={version:"2.6.9"};"number"==typeof __e&&(__e=i)},"5b4e":function(t,e,i){var n=i("36c3"),o=i("b447"),r=i("0fc9");t.exports=function(t){return function(e,i,a){var s,l=n(e),h=o(l.length),c=r(a,h);if(t&&i!=i){for(;h>c;)if((s=l[c++])!=s)return!0}else for(;h>c;c++)if((t||c in l)&&l[c]===i)return t||c||0;return!t&&-1}}},"5ca1":function(t,e,i){var n=i("7726"),o=i("8378"),r=i("32e9"),a=i("2aba"),s=i("9b43"),l=function(t,e,i){var h,c,u,d,f=t&l.F,p=t&l.G,g=t&l.S,_=t&l.P,m=t&l.B,v=p?n:g?n[e]||(n[e]={}):(n[e]||{}).prototype,y=p?o:o[e]||(o[e]={}),w=y.prototype||(y.prototype={});p&&(i=e);for(h in i)c=!f&&v&&void 0!==v[h],u=(c?v:i)[h],d=m&&c?s(u,n):_&&"function"==typeof u?s(Function.call,u):u,v&&a(v,h,u,t&l.U),y[h]!=u&&r(y,h,d),_&&w[h]!=u&&(w[h]=u)};n.core=o,l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,t.exports=l},"5d58":function(t,e,i){t.exports=i("d8d6")},"5eda":function(t,e,i){var n=i("5ca1"),o=i("8378"),r=i("79e5");t.exports=function(t,e){var i=(o.Object||{})[t]||Object[t],a={};a[t]=e(i),n(n.S+n.F*r(function(){i(1)}),"Object",a)}},"5f1b":function(t,e,i){"use strict";var n=i("23c6"),o=RegExp.prototype.exec;t.exports=function(t,e){var i=t.exec;if("function"==typeof i){var r=i.call(t,e);if("object"!=typeof r)throw new TypeError("RegExp exec method returned something other than an Object or null");return r}if("RegExp"!==n(t))throw new TypeError("RegExp#exec called on incompatible receiver");return o.call(t,e)}},"613b":function(t,e,i){var n=i("5537")("keys"),o=i("ca5a");t.exports=function(t){return n[t]||(n[t]=o(t))}},"626a":function(t,e,i){var n=i("2d95");t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==n(t)?t.split(""):Object(t)}},"62a0":function(t,e){var i=0,n=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++i+n).toString(36))}},"63b6":function(t,e,i){var n=i("e53d"),o=i("584a"),r=i("d864"),a=i("35e8"),s=i("07e3"),l=function(t,e,i){var h,c,u,d=t&l.F,f=t&l.G,p=t&l.S,g=t&l.P,_=t&l.B,m=t&l.W,v=f?o:o[e]||(o[e]={}),y=v.prototype,w=f?n:p?n[e]:(n[e]||{}).prototype;f&&(i=e);for(h in i)(c=!d&&w&&void 0!==w[h])&&s(v,h)||(u=c?w[h]:i[h],v[h]=f&&"function"!=typeof w[h]?i[h]:_&&c?r(u,n):m&&w[h]==u?function(t){var e=function(e,i,n){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(e);case 2:return new t(e,i)}return new t(e,i,n)}return t.apply(this,arguments)};return e.prototype=t.prototype,e}(u):g&&"function"==typeof u?r(Function.call,u):u,g&&((v.virtual||(v.virtual={}))[h]=u,t&l.R&&y&&!y[h]&&a(y,h,u)))};l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,t.exports=l},"66b5":function(t,e,i){},6718:function(t,e,i){var n=i("e53d"),o=i("584a"),r=i("b8e3"),a=i("ccb9"),s=i("d9f6").f;t.exports=function(t){var e=o.Symbol||(o.Symbol=r?{}:n.Symbol||{});"_"==t.charAt(0)||t in e||s(e,t,{value:a.f(t)})}},"67bb":function(t,e,i){t.exports=i("f921")},6821:function(t,e,i){var n=i("626a"),o=i("be13");t.exports=function(t){return n(o(t))}},"69a8":function(t,e){var i={}.hasOwnProperty;t.exports=function(t,e){return i.call(t,e)}},"69d3":function(t,e,i){i("6718")("asyncIterator")},"6a99":function(t,e,i){var n=i("d3f4");t.exports=function(t,e){if(!n(t))return t;var i,o;if(e&&"function"==typeof(i=t.toString)&&!n(o=i.call(t)))return o;if("function"==typeof(i=t.valueOf)&&!n(o=i.call(t)))return o;if(!e&&"function"==typeof(i=t.toString)&&!n(o=i.call(t)))return o;throw TypeError("Can't convert object to primitive value")}},"6abf":function(t,e,i){var n=i("e6f3"),o=i("1691").concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return n(t,o)}},"6b4c":function(t,e){var i={}.toString;t.exports=function(t){return i.call(t).slice(8,-1)}},"6b6b":function(t,e,i){"use strict";function n(t,e,i){this.$children.forEach(function(o){o.$options.componentName===t?o.$emit.apply(o,[e].concat(i)):n.apply(o,[t,e].concat([i]))})}e.__esModule=!0,e.default={methods:{dispatch:function(t,e,i){for(var n=this.$parent||this.$root,o=n.$options.componentName;n&&(!o||o!==t);)(n=n.$parent)&&(o=n.$options.componentName);n&&n.$emit.apply(n,[e].concat(i))},broadcast:function(t,e,i){n.call(this,t,e,i)}}}},"6c1c":function(t,e,i){i("c367");for(var n=i("e53d"),o=i("35e8"),r=i("481b"),a=i("5168")("toStringTag"),s="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),l=0;l<s.length;l++){var h=s[l],c=n[h],u=c&&c.prototype;u&&!u[a]&&o(u,a,h),r[h]=r.Array}},7144:function(t,e,i){},"71c1":function(t,e,i){var n=i("3a38"),o=i("25eb");t.exports=function(t){return function(e,i){var r,a,s=String(o(e)),l=n(i),h=s.length;return l<0||l>=h?t?"":void 0:(r=s.charCodeAt(l),r<55296||r>56319||l+1===h||(a=s.charCodeAt(l+1))<56320||a>57343?t?s.charAt(l):r:t?s.slice(l,l+2):a-56320+(r-55296<<10)+65536)}}},"73fa":function(t,e,i){"use strict";function n(t,e){if(!t||!e)return!1;if(-1!==e.indexOf(" "))throw new Error("className should not contain space.");return t.classList?t.classList.contains(e):(" "+t.className+" ").indexOf(" "+e+" ")>-1}function o(t,e){if(t){for(var i=t.className,o=(e||"").split(" "),r=0,a=o.length;r<a;r++){var s=o[r];s&&(t.classList?t.classList.add(s):n(t,s)||(i+=" "+s))}t.classList||(t.className=i)}}function r(t,e){if(t&&e){for(var i=e.split(" "),o=" "+t.className+" ",r=0,a=i.length;r<a;r++){var s=i[r];s&&(t.classList?t.classList.remove(s):n(t,s)&&(o=o.replace(" "+s+" "," ")))}t.classList||(t.className=p(o))}}function a(t,e,i){if(t&&e)if("object"===(void 0===e?"undefined":s(e)))for(var n in e)e.hasOwnProperty(n)&&a(t,n,e[n]);else e=g(e),"opacity"===e&&f<9?t.style.filter=isNaN(i)?"":"alpha(opacity="+100*i+")":t.style[e]=i}e.__esModule=!0,e.isInContainer=e.getScrollContainer=e.isScroll=e.getStyle=e.once=e.off=e.on=void 0;var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.hasClass=n,e.addClass=o,e.removeClass=r,e.setStyle=a;var l=i("8bbf"),h=function(t){return t&&t.__esModule?t:{default:t}}(l),c=h.default.prototype.$isServer,u=/([\:\-\_]+(.))/g,d=/^moz([A-Z])/,f=c?0:Number(document.documentMode),p=function(t){return(t||"").replace(/^[\s\uFEFF]+|[\s\uFEFF]+$/g,"")},g=function(t){return t.replace(u,function(t,e,i,n){return n?i.toUpperCase():i}).replace(d,"Moz$1")},_=e.on=function(){return!c&&document.addEventListener?function(t,e,i){t&&e&&i&&t.addEventListener(e,i,!1)}:function(t,e,i){t&&e&&i&&t.attachEvent("on"+e,i)}}(),m=e.off=function(){return!c&&document.removeEventListener?function(t,e,i){t&&e&&t.removeEventListener(e,i,!1)}:function(t,e,i){t&&e&&t.detachEvent("on"+e,i)}}(),v=(e.once=function(t,e,i){_(t,e,function n(){i&&i.apply(this,arguments),m(t,e,n)})},e.getStyle=f<9?function(t,e){if(!c){if(!t||!e)return null;e=g(e),"float"===e&&(e="styleFloat");try{switch(e){case"opacity":try{return t.filters.item("alpha").opacity/100}catch(t){return 1}default:return t.style[e]||t.currentStyle?t.currentStyle[e]:null}}catch(i){return t.style[e]}}}:function(t,e){if(!c){if(!t||!e)return null;e=g(e),"float"===e&&(e="cssFloat");try{var i=document.defaultView.getComputedStyle(t,"");return t.style[e]||i?i[e]:null}catch(i){return t.style[e]}}}),y=e.isScroll=function(t,e){if(!c){return(null!==e||void 0!==e?e?v(t,"overflow-y"):v(t,"overflow-x"):v(t,"overflow")).match(/(scroll|auto)/)}};e.getScrollContainer=function(t,e){if(!c){for(var i=t;i;){if([window,document,document.documentElement].includes(i))return window;if(y(i,e))return i;i=i.parentNode}return i}},e.isInContainer=function(t,e){if(c||!t||!e)return!1;var i=t.getBoundingClientRect(),n=void 0;return n=[window,document,document.documentElement,null,void 0].includes(e)?{top:0,right:window.innerWidth,bottom:window.innerHeight,left:0}:e.getBoundingClientRect(),i.top<n.bottom&&i.bottom>n.top&&i.right>n.left&&i.left<n.right}},7514:function(t,e,i){"use strict";var n=i("5ca1"),o=i("0a49")(5),r=!0;"find"in[]&&Array(1).find(function(){r=!1}),n(n.P+n.F*r,"Array",{find:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0)}}),i("9c6c")("find")},"765d":function(t,e,i){i("6718")("observable")},7726:function(t,e){var i=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=i)},"77f1":function(t,e,i){var n=i("4588"),o=Math.max,r=Math.min;t.exports=function(t,e){return t=n(t),t<0?o(t+e,0):r(t,e)}},"794b":function(t,e,i){t.exports=!i("8e60")&&!i("294c")(function(){return 7!=Object.defineProperty(i("1ec9")("div"),"a",{get:function(){return 7}}).a})},"797b":function(t,e,i){t.exports=function(t){function e(n){if(i[n])return i[n].exports;var o=i[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var i={};return e.m=t,e.c=i,e.d=function(t,i,n){e.o(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:n})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,i){if(1&i&&(t=e(t)),8&i)return t;if(4&i&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(e.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&i&&"string"!=typeof t)for(var o in t)e.d(n,o,function(e){return t[e]}.bind(null,o));return n},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="/dist/",e(e.s=115)}({0:function(t,e,i){"use strict";function n(t,e,i,n,o,r,a,s){var l="function"==typeof t?t.options:t;e&&(l.render=e,l.staticRenderFns=i,l._compiled=!0),n&&(l.functional=!0),r&&(l._scopeId="data-v-"+r);var h;if(a?(h=function(t){t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,t||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),o&&o.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(a)},l._ssrRegister=h):o&&(h=s?function(){o.call(this,this.$root.$options.shadowRoot)}:o),h)if(l.functional){l._injectStyles=h;var c=l.render;l.render=function(t,e){return h.call(e),c(t,e)}}else{var u=l.beforeCreate;l.beforeCreate=u?[].concat(u,h):[h]}return{exports:t,options:l}}i.d(e,"a",function(){return n})},115:function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("li",{staticClass:"el-dropdown-menu__item",class:{"is-disabled":t.disabled,"el-dropdown-menu__item--divided":t.divided},attrs:{"aria-disabled":t.disabled,tabindex:t.disabled?null:-1},on:{click:t.handleClick}},[t.icon?i("i",{class:t.icon}):t._e(),t._t("default")],2)},o=[];n._withStripped=!0;var r=i(3),a=i.n(r),s={name:"ElDropdownItem",mixins:[a.a],props:{command:{},disabled:Boolean,divided:Boolean,icon:String},methods:{handleClick:function(t){this.dispatch("ElDropdown","menu-item-click",[this.command,this])}}},l=s,h=i(0),c=Object(h.a)(l,n,o,!1,null,null,null);c.options.__file="packages/dropdown/src/dropdown-item.vue";var u=c.exports;u.install=function(t){t.component(u.name,u)},u.name="FiDropdownItem";e.default=u},3:function(t,e){t.exports=i("6b6b")}})},"79aa":function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},"79e5":function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},"7e90":function(t,e,i){var n=i("d9f6"),o=i("e4ae"),r=i("c3a1");t.exports=i("8e60")?Object.defineProperties:function(t,e){o(t);for(var i,a=r(e),s=a.length,l=0;s>l;)n.f(t,i=a[l++],e[i]);return t}},"7f20":function(t,e,i){var n=i("86cc").f,o=i("69a8"),r=i("2b4c")("toStringTag");t.exports=function(t,e,i){t&&!o(t=i?t:t.prototype,r)&&n(t,r,{configurable:!0,value:e})}},"7f7f":function(t,e,i){var n=i("86cc").f,o=Function.prototype,r=/^\s*function ([^ (]*)/;"name"in o||i("9e1e")&&n(o,"name",{configurable:!0,get:function(){try{return(""+this).match(r)[1]}catch(t){return""}}})},8306:function(t,e,i){},8378:function(t,e){var i=t.exports={version:"2.6.9"};"number"==typeof __e&&(__e=i)},8436:function(t,e){t.exports=function(){}},"84f2":function(t,e){t.exports={}},"86cc":function(t,e,i){var n=i("cb7c"),o=i("c69a"),r=i("6a99"),a=Object.defineProperty;e.f=i("9e1e")?Object.defineProperty:function(t,e,i){if(n(t),e=r(e,!0),n(i),o)try{return a(t,e,i)}catch(t){}if("get"in i||"set"in i)throw TypeError("Accessors not supported!");return"value"in i&&(t[e]=i.value),t}},"8bbf":function(t,e){t.exports=i("8bbf")},"8e60":function(t,e,i){t.exports=!i("294c")(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},"8f60":function(t,e,i){"use strict";var n=i("a159"),o=i("aebd"),r=i("45f2"),a={};i("35e8")(a,i("5168")("iterator"),function(){return this}),t.exports=function(t,e,i){t.prototype=n(a,{next:o(1,i)}),r(t,e+" Iterator")}},9003:function(t,e,i){var n=i("6b4c");t.exports=Array.isArray||function(t){return"Array"==n(t)}},9138:function(t,e,i){t.exports=i("35e8")},"9aa9":function(t,e){e.f=Object.getOwnPropertySymbols},"9aea":function(t,e,i){"use strict";e.__esModule=!0,e.default=function(){if(o.default.prototype.$isServer)return 0;if(void 0!==r)return r;var t=document.createElement("div");t.className="el-scrollbar__wrap",t.style.visibility="hidden",t.style.width="100px",t.style.position="absolute",t.style.top="-9999px",document.body.appendChild(t);var e=t.offsetWidth;t.style.overflow="scroll";var i=document.createElement("div");i.style.width="100%",t.appendChild(i);var n=i.offsetWidth;return t.parentNode.removeChild(t),r=e-n};var n=i("8bbf"),o=function(t){return t&&t.__esModule?t:{default:t}}(n),r=void 0},"9b43":function(t,e,i){var n=i("d8e8");t.exports=function(t,e,i){if(n(t),void 0===e)return t;switch(i){case 1:return function(i){return t.call(e,i)};case 2:return function(i,n){return t.call(e,i,n)};case 3:return function(i,n,o){return t.call(e,i,n,o)}}return function(){return t.apply(e,arguments)}}},"9c6c":function(t,e,i){var n=i("2b4c")("unscopables"),o=Array.prototype;void 0==o[n]&&i("32e9")(o,n,{}),t.exports=function(t){o[n][t]=!0}},"9def":function(t,e,i){var n=i("4588"),o=Math.min;t.exports=function(t){return t>0?o(n(t),9007199254740991):0}},"9e1e":function(t,e,i){t.exports=!i("79e5")(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},a159:function(t,e,i){var n=i("e4ae"),o=i("7e90"),r=i("1691"),a=i("5559")("IE_PROTO"),s=function(){},l=function(){var t,e=i("1ec9")("iframe"),n=r.length;for(e.style.display="none",i("32fc").appendChild(e),e.src="javascript:",t=e.contentWindow.document,t.open(),t.write("<script>document.F=Object<\/script>"),t.close(),l=t.F;n--;)delete l.prototype[r[n]];return l()};t.exports=Object.create||function(t,e){var i;return null!==t?(s.prototype=n(t),i=new s,s.prototype=null,i[a]=t):i=l(),void 0===e?i:o(i,e)}},a481:function(t,e,i){"use strict";var n=i("cb7c"),o=i("4bf8"),r=i("9def"),a=i("4588"),s=i("0390"),l=i("5f1b"),h=Math.max,c=Math.min,u=Math.floor,d=/\$([$&`']|\d\d?|<[^>]*>)/g,f=/\$([$&`']|\d\d?)/g,p=function(t){return void 0===t?t:String(t)};i("214f")("replace",2,function(t,e,i,g){function _(t,e,n,r,a,s){var l=n+t.length,h=r.length,c=f;return void 0!==a&&(a=o(a),c=d),i.call(s,c,function(i,o){var s;switch(o.charAt(0)){case"$":return"$";case"&":return t;case"`":return e.slice(0,n);case"'":return e.slice(l);case"<":s=a[o.slice(1,-1)];break;default:var c=+o;if(0===c)return i;if(c>h){var d=u(c/10);return 0===d?i:d<=h?void 0===r[d-1]?o.charAt(1):r[d-1]+o.charAt(1):i}s=r[c-1]}return void 0===s?"":s})}return[function(n,o){var r=t(this),a=void 0==n?void 0:n[e];return void 0!==a?a.call(n,r,o):i.call(String(r),n,o)},function(t,e){var o=g(i,t,this,e);if(o.done)return o.value;var u=n(t),d=String(this),f="function"==typeof e;f||(e=String(e));var m=u.global;if(m){var v=u.unicode;u.lastIndex=0}for(var y=[];;){var w=l(u,d);if(null===w)break;if(y.push(w),!m)break;""===String(w[0])&&(u.lastIndex=s(d,r(u.lastIndex),v))}for(var b="",x=0,A=0;A<y.length;A++){w=y[A];for(var C=String(w[0]),T=h(c(a(w.index),d.length),0),k=[],S=1;S<w.length;S++)k.push(p(w[S]));var E=w.groups;if(f){var I=[C].concat(k,T,d);void 0!==E&&I.push(E);var L=String(e.apply(void 0,I))}else L=_(C,d,T,k,E,e);T>=x&&(b+=d.slice(x,T)+L,x=T+C.length)}return b+d.slice(x)}]})},a78e:function(t,e,i){var n,o;!function(r){var a=!1;if(n=r,void 0!==(o="function"==typeof n?n.call(e,i,e,t):n)&&(t.exports=o),a=!0,t.exports=r(),a=!0,!a){var s=window.Cookies,l=window.Cookies=r();l.noConflict=function(){return window.Cookies=s,l}}}(function(){function t(){for(var t=0,e={};t<arguments.length;t++){var i=arguments[t];for(var n in i)e[n]=i[n]}return e}function e(i){function n(e,o,r){var a;if("undefined"!=typeof document){if(arguments.length>1){if(r=t({path:"/"},n.defaults,r),"number"==typeof r.expires){var s=new Date;s.setMilliseconds(s.getMilliseconds()+864e5*r.expires),r.expires=s}r.expires=r.expires?r.expires.toUTCString():"";try{a=JSON.stringify(o),/^[\{\[]/.test(a)&&(o=a)}catch(t){}o=i.write?i.write(o,e):encodeURIComponent(String(o)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),e=encodeURIComponent(String(e)),e=e.replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent),e=e.replace(/[\(\)]/g,escape);var l="";for(var h in r)r[h]&&(l+="; "+h,!0!==r[h]&&(l+="="+r[h]));return document.cookie=e+"="+o+l}e||(a={});for(var c=document.cookie?document.cookie.split("; "):[],u=/(%[0-9A-Z]{2})+/g,d=0;d<c.length;d++){var f=c[d].split("="),p=f.slice(1).join("=");this.json||'"'!==p.charAt(0)||(p=p.slice(1,-1));try{var g=f[0].replace(u,decodeURIComponent);if(p=i.read?i.read(p,g):i(p,g)||p.replace(u,decodeURIComponent),this.json)try{p=JSON.parse(p)}catch(t){}if(e===g){a=p;break}e||(a[g]=p)}catch(t){}}return a}}return n.set=n,n.get=function(t){return n.call(n,t)},n.getJSON=function(){return n.apply({json:!0},[].slice.call(arguments))},n.defaults={},n.remove=function(e,i){n(e,"",t(i,{expires:-1}))},n.withConverter=e,n}return e(function(){})})},aae3:function(t,e,i){var n=i("d3f4"),o=i("2d95"),r=i("2b4c")("match");t.exports=function(t){var e;return n(t)&&(void 0!==(e=t[r])?!!e:"RegExp"==o(t))}},ac6a:function(t,e,i){for(var n=i("cadf"),o=i("0d58"),r=i("2aba"),a=i("7726"),s=i("32e9"),l=i("84f2"),h=i("2b4c"),c=h("iterator"),u=h("toStringTag"),d=l.Array,f={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},p=o(f),g=0;g<p.length;g++){var _,m=p[g],v=f[m],y=a[m],w=y&&y.prototype;if(w&&(w[c]||s(w,c,d),w[u]||s(w,u,m),l[m]=d,v))for(_ in n)w[_]||r(w,_,n[_],!0)}},aebd:function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},b0c5:function(t,e,i){"use strict";var n=i("520a");i("5ca1")({target:"RegExp",proto:!0,forced:n!==/./.exec},{exec:n})},b447:function(t,e,i){var n=i("3a38"),o=Math.min;t.exports=function(t){return t>0?o(n(t),9007199254740991):0}},b8e3:function(t,e){t.exports=!0},bce7:function(t,e,i){"use strict";e.__esModule=!0;i("23af");e.default={mounted:function(){return},methods:{getMigratingConfig:function(){return{props:{},events:{}}}}}},be13:function(t,e){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},bf0b:function(t,e,i){var n=i("355d"),o=i("aebd"),r=i("36c3"),a=i("1bc3"),s=i("07e3"),l=i("794b"),h=Object.getOwnPropertyDescriptor;e.f=i("8e60")?h:function(t,e){if(t=r(t),e=a(e,!0),l)try{return h(t,e)}catch(t){}if(s(t,e))return o(!n.f.call(t,e),t[e])}},c207:function(t,e){},c27e:function(t,e,i){"use strict";e.__esModule=!0;var n=i("8bbf"),o=function(t){return t&&t.__esModule?t:{default:t}}(n),r=i("4ff6"),a=o.default.prototype.$isServer?function(){}:i("437e"),s=function(t){return t.stopPropagation()};e.default={props:{transformOrigin:{type:[Boolean,String],default:!0},placement:{type:String,default:"bottom"},boundariesPadding:{type:Number,default:5},reference:{},popper:{},offset:{default:0},value:Boolean,visibleArrow:Boolean,arrowOffset:{type:Number,default:35},appendToBody:{type:Boolean,default:!0},popperOptions:{type:Object,default:function(){return{gpuAcceleration:!1}}}},data:function(){return{showPopper:!1,currentPlacement:""}},watch:{value:{immediate:!0,handler:function(t){this.showPopper=t,this.$emit("input",t)}},showPopper:function(t){this.disabled||(t?this.updatePopper():this.destroyPopper(),this.$emit("input",t))}},methods:{createPopper:function(){var t=this;if(!this.$isServer&&(this.currentPlacement=this.currentPlacement||this.placement,/^(top|bottom|left|right)(-start|-end)?$/g.test(this.currentPlacement))){var e=this.popperOptions,i=this.popperElm=this.popperElm||this.popper||this.$refs.popper,n=this.referenceElm=this.referenceElm||this.reference||this.$refs.reference;!n&&this.$slots.reference&&this.$slots.reference[0]&&(n=this.referenceElm=this.$slots.reference[0].elm),i&&n&&(this.visibleArrow&&this.appendArrow(i),this.appendToBody&&document.body.appendChild(this.popperElm),this.popperJS&&this.popperJS.destroy&&this.popperJS.destroy(),e.placement=this.currentPlacement,e.offset=this.offset,e.arrowOffset=this.arrowOffset,this.popperJS=new a(n,i,e),this.popperJS.onCreate(function(e){t.$emit("created",t),t.resetTransformOrigin(),t.$nextTick(t.updatePopper)}),"function"==typeof e.onUpdate&&this.popperJS.onUpdate(e.onUpdate),this.popperJS._popper.style.zIndex=r.PopupManager.nextZIndex(),this.popperElm.addEventListener("click",s))}},updatePopper:function(){var t=this.popperJS;t?(t.update(),t._popper&&(t._popper.style.zIndex=r.PopupManager.nextZIndex())):this.createPopper()},doDestroy:function(t){!this.popperJS||this.showPopper&&!t||(this.popperJS.destroy(),this.popperJS=null)},destroyPopper:function(){this.popperJS&&this.resetTransformOrigin()},resetTransformOrigin:function(){if(this.transformOrigin){var t={top:"bottom",bottom:"top",left:"right",right:"left"},e=this.popperJS._popper.getAttribute("x-placement").split("-")[0],i=t[e];this.popperJS._popper.style.transformOrigin="string"==typeof this.transformOrigin?this.transformOrigin:["top","bottom"].indexOf(e)>-1?"center "+i:i+" center"}},appendArrow:function(t){var e=void 0;if(!this.appended){this.appended=!0;for(var i in t.attributes)if(/^_v-/.test(t.attributes[i].name)){e=t.attributes[i].name;break}var n=document.createElement("div");e&&n.setAttribute(e,""),n.setAttribute("x-arrow",""),n.className="popper__arrow",t.appendChild(n)}}},beforeDestroy:function(){this.doDestroy(!0),this.popperElm&&this.popperElm.parentNode===document.body&&(this.popperElm.removeEventListener("click",s),document.body.removeChild(this.popperElm))},deactivated:function(){this.$options.beforeDestroy[0].call(this)}}},c366:function(t,e,i){var n=i("6821"),o=i("9def"),r=i("77f1");t.exports=function(t){return function(e,i,a){var s,l=n(e),h=o(l.length),c=r(a,h);if(t&&i!=i){for(;h>c;)if((s=l[c++])!=s)return!0}else for(;h>c;c++)if((t||c in l)&&l[c]===i)return t||c||0;return!t&&-1}}},c367:function(t,e,i){"use strict";var n=i("8436"),o=i("50ed"),r=i("481b"),a=i("36c3");t.exports=i("30f1")(Array,"Array",function(t,e){this._t=a(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,i=this._i++;return!t||i>=t.length?(this._t=void 0,o(1)):"keys"==e?o(0,i):"values"==e?o(0,t[i]):o(0,[i,t[i]])},"values"),r.Arguments=r.Array,n("keys"),n("values"),n("entries")},c3a1:function(t,e,i){var n=i("e6f3"),o=i("1691");t.exports=Object.keys||function(t){return n(t,o)}},c69a:function(t,e,i){t.exports=!i("9e1e")&&!i("79e5")(function(){return 7!=Object.defineProperty(i("230e")("div"),"a",{get:function(){return 7}}).a})},ca5a:function(t,e){var i=0,n=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++i+n).toString(36))}},cadf:function(t,e,i){"use strict";var n=i("9c6c"),o=i("d53b"),r=i("84f2"),a=i("6821");t.exports=i("01f9")(Array,"Array",function(t,e){this._t=a(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,i=this._i++;return!t||i>=t.length?(this._t=void 0,o(1)):"keys"==e?o(0,i):"values"==e?o(0,t[i]):o(0,[i,t[i]])},"values"),r.Arguments=r.Array,n("keys"),n("values"),n("entries")},cb7c:function(t,e,i){var n=i("d3f4");t.exports=function(t){if(!n(t))throw TypeError(t+" is not an object!");return t}},ccb9:function(t,e,i){e.f=i("5168")},cd1c:function(t,e,i){var n=i("e853");t.exports=function(t,e){return new(n(t))(e)}},ce10:function(t,e,i){var n=i("69a8"),o=i("6821"),r=i("c366")(!1),a=i("613b")("IE_PROTO");t.exports=function(t,e){var i,s=o(t),l=0,h=[];for(i in s)i!=a&&n(s,i)&&h.push(i);for(;e.length>l;)n(s,i=e[l++])&&(~r(h,i)||h.push(i));return h}},d062:function(t,e,i){t.exports=function(t){function e(n){if(i[n])return i[n].exports;var o=i[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var i={};return e.m=t,e.c=i,e.d=function(t,i,n){e.o(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:n})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,i){if(1&i&&(t=e(t)),8&i)return t;if(4&i&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(e.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&i&&"string"!=typeof t)for(var o in t)e.d(n,o,function(e){return t[e]}.bind(null,o));return n},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="/dist/",e(e.s=122)}({0:function(t,e,i){"use strict";function n(t,e,i,n,o,r,a,s){var l="function"==typeof t?t.options:t;e&&(l.render=e,l.staticRenderFns=i,l._compiled=!0),n&&(l.functional=!0),r&&(l._scopeId="data-v-"+r);var h;if(a?(h=function(t){t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,t||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),o&&o.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(a)},l._ssrRegister=h):o&&(h=s?function(){o.call(this,this.$root.$options.shadowRoot)}:o),h)if(l.functional){l._injectStyles=h;var c=l.render;l.render=function(t,e){return h.call(e),c(t,e)}}else{var u=l.beforeCreate;l.beforeCreate=u?[].concat(u,h):[h]}return{exports:t,options:l}}i.d(e,"a",function(){return n})},122:function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("button",{staticClass:"el-button",class:[t.type?"el-button--"+t.type:"",t.buttonSize?"el-button--"+t.buttonSize:"",{"is-disabled":t.buttonDisabled,"is-loading":t.loading,"is-plain":t.plain,"is-round":t.round,"is-circle":t.circle}],attrs:{disabled:t.buttonDisabled||t.loading,autofocus:t.autofocus,type:t.nativeType},on:{click:t.handleClick}},[t.loading?i("i",{staticClass:"el-icon-loading"}):t._e(),t.icon&&!t.loading?i("i",{class:t.icon}):t._e(),t.$slots.default?i("span",[t._t("default")],2):t._e()])},o=[];n._withStripped=!0;var r={name:"ElButton",inject:{elForm:{default:""},elFormItem:{default:""}},props:{type:{type:String,default:"default"},size:String,icon:{type:String,default:""},nativeType:{type:String,default:"button"},loading:Boolean,disabled:Boolean,plain:Boolean,autofocus:Boolean,round:Boolean,circle:Boolean},computed:{_elFormItemSize:function(){return(this.elFormItem||{}).elFormItemSize},buttonSize:function(){return this.size||this._elFormItemSize||(this.$ELEMENT||{}).size},buttonDisabled:function(){return this.disabled||(this.elForm||{}).disabled}},methods:{handleClick:function(t){this.$emit("click",t)}}},a=r,s=i(0),l=Object(s.a)(a,n,o,!1,null,null,null);l.options.__file="packages/button/src/button.vue";var h=l.exports;h.install=function(t){t.component(h.name,h)},h.name="FiButton";e.default=h}})},d3f4:function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},d53b:function(t,e){t.exports=function(t,e){return{value:e,done:!!t}}},d864:function(t,e,i){var n=i("79aa");t.exports=function(t,e,i){if(n(t),void 0===e)return t;switch(i){case 1:return function(i){return t.call(e,i)};case 2:return function(i,n){return t.call(e,i,n)};case 3:return function(i,n,o){return t.call(e,i,n,o)}}return function(){return t.apply(e,arguments)}}},d8d6:function(t,e,i){i("1654"),i("6c1c"),t.exports=i("ccb9").f("iterator")},d8e8:function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},d9f6:function(t,e,i){var n=i("e4ae"),o=i("794b"),r=i("1bc3"),a=Object.defineProperty;e.f=i("8e60")?Object.defineProperty:function(t,e,i){if(n(t),e=r(e,!0),n(i),o)try{return a(t,e,i)}catch(t){}if("get"in i||"set"in i)throw TypeError("Accessors not supported!");return"value"in i&&(t[e]=i.value),t}},db7e:function(t,e,i){},dbdb:function(t,e,i){var n=i("584a"),o=i("e53d"),r=o["__core-js_shared__"]||(o["__core-js_shared__"]={});(t.exports=function(t,e){return r[t]||(r[t]=void 0!==e?e:{})})("versions",[]).push({version:n.version,mode:i("b8e3")?"pure":"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})},e0c7:function(t,e,i){t.exports=function(t){function e(n){if(i[n])return i[n].exports;var o=i[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var i={};return e.m=t,e.c=i,e.d=function(t,i,n){e.o(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:n})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,i){if(1&i&&(t=e(t)),8&i)return t;if(4&i&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(e.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&i&&"string"!=typeof t)for(var o in t)e.d(n,o,function(e){return t[e]}.bind(null,o));return n},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="/dist/",e(e.s=62)}({0:function(t,e,i){"use strict";function n(t,e,i,n,o,r,a,s){var l="function"==typeof t?t.options:t;e&&(l.render=e,l.staticRenderFns=i,l._compiled=!0),n&&(l.functional=!0),r&&(l._scopeId="data-v-"+r);var h;if(a?(h=function(t){t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,t||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),o&&o.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(a)},l._ssrRegister=h):o&&(h=s?function(){o.call(this,this.$root.$options.shadowRoot)}:o),h)if(l.functional){l._injectStyles=h;var c=l.render;l.render=function(t,e){return h.call(e),c(t,e)}}else{var u=l.beforeCreate;l.beforeCreate=u?[].concat(u,h):[h]}return{exports:t,options:l}}i.d(e,"a",function(){return n})},10:function(t,e){t.exports=i("bce7")},11:function(t,e){t.exports=i("e145")},18:function(t,e){t.exports=i("d062")},3:function(t,e){t.exports=i("6b6b")},4:function(t,e){t.exports=i("23af")},51:function(t,e){t.exports=i("1388")},62:function(t,e,i){"use strict";i.r(e);var n=i(11),o=i.n(n),r=i(3),a=i.n(r),s=i(10),l=i.n(s),h=i(18),c=i.n(h),u=i(51),d=i.n(u),f=i(4),p={name:"ElDropdown",componentName:"ElDropdown",mixins:[a.a,l.a],directives:{Clickoutside:o.a},components:{ElButton:c.a,ElButtonGroup:d.a},provide:function(){return{dropdown:this}},props:{trigger:{type:String,default:"hover"},type:String,size:{type:String,default:""},splitButton:Boolean,hideOnClick:{type:Boolean,default:!0},placement:{type:String,default:"bottom-end"},visibleArrow:{default:!0},showTimeout:{type:Number,default:250},hideTimeout:{type:Number,default:150},tabindex:{type:Number,default:0}},data:function(){return{timeout:null,visible:!1,triggerElm:null,menuItems:null,menuItemsArray:null,dropdownElm:null,focusing:!1,listId:"dropdown-menu-"+Object(f.generateId)()}},computed:{dropdownSize:function(){return this.size||(this.$ELEMENT||{}).size}},mounted:function(){this.$on("menu-item-click",this.handleMenuItemClick)},watch:{visible:function(t){this.broadcast("ElDropdownMenu","visible",t),this.$emit("visible-change",t)},focusing:function(t){var e=this.$el.querySelector(".el-dropdown-selfdefine");e&&(t?e.className+=" focusing":e.className=e.className.replace("focusing",""))}},methods:{getMigratingConfig:function(){return{props:{"menu-align":"menu-align is renamed to placement."}}},show:function(){var t=this;this.triggerElm.disabled||(clearTimeout(this.timeout),this.timeout=setTimeout(function(){t.visible=!0},"click"===this.trigger?0:this.showTimeout))},hide:function(){var t=this;this.triggerElm.disabled||(this.removeTabindex(),this.tabindex>=0&&this.resetTabindex(this.triggerElm),clearTimeout(this.timeout),this.timeout=setTimeout(function(){t.visible=!1},"click"===this.trigger?0:this.hideTimeout))},handleClick:function(){this.triggerElm.disabled||(this.visible?this.hide():this.show())},handleTriggerKeyDown:function(t){var e=t.keyCode;[38,40].indexOf(e)>-1?(this.removeTabindex(),this.resetTabindex(this.menuItems[0]),this.menuItems[0].focus(),t.preventDefault(),t.stopPropagation()):13===e?this.handleClick():[9,27].indexOf(e)>-1&&this.hide()},handleItemKeyDown:function(t){var e=t.keyCode,i=t.target,n=this.menuItemsArray.indexOf(i),o=this.menuItemsArray.length-1,r=void 0;[38,40].indexOf(e)>-1?(r=38===e?0!==n?n-1:0:n<o?n+1:o,this.removeTabindex(),this.resetTabindex(this.menuItems[r]),this.menuItems[r].focus(),t.preventDefault(),t.stopPropagation()):13===e?(this.triggerElmFocus(),i.click(),this.hideOnClick&&(this.visible=!1)):[9,27].indexOf(e)>-1&&(this.hide(),this.triggerElmFocus())},resetTabindex:function(t){this.removeTabindex(),t.setAttribute("tabindex","0")},removeTabindex:function(){this.triggerElm.setAttribute("tabindex","-1"),this.menuItemsArray.forEach(function(t){t.setAttribute("tabindex","-1")})},initAria:function(){this.dropdownElm.setAttribute("id",this.listId),this.triggerElm.setAttribute("aria-haspopup","list"),this.triggerElm.setAttribute("aria-controls",this.listId),this.splitButton||(this.triggerElm.setAttribute("role","button"),this.triggerElm.setAttribute("tabindex",this.tabindex),this.triggerElm.setAttribute("class",(this.triggerElm.getAttribute("class")||"")+" el-dropdown-selfdefine"))},initEvent:function(){var t=this,e=this.trigger,i=this.show,n=this.hide,o=this.handleClick,r=this.splitButton,a=this.handleTriggerKeyDown,s=this.handleItemKeyDown;this.triggerElm=r?this.$refs.trigger.$el:this.$slots.default[0].elm;var l=this.dropdownElm;this.triggerElm.addEventListener("keydown",a),l.addEventListener("keydown",s,!0),r||(this.triggerElm.addEventListener("focus",function(){t.focusing=!0}),this.triggerElm.addEventListener("blur",function(){t.focusing=!1}),this.triggerElm.addEventListener("click",function(){t.focusing=!1})),"hover"===e?(this.triggerElm.addEventListener("mouseenter",i),this.triggerElm.addEventListener("mouseleave",n),l.addEventListener("mouseenter",i),l.addEventListener("mouseleave",n)):"click"===e&&this.triggerElm.addEventListener("click",o)},handleMenuItemClick:function(t,e){this.hideOnClick&&(this.visible=!1),this.$emit("command",t,e)},triggerElmFocus:function(){this.triggerElm.focus&&this.triggerElm.focus()},initDomOperation:function(){this.dropdownElm=this.popperElm,this.menuItems=this.dropdownElm.querySelectorAll("[tabindex='-1']"),this.menuItemsArray=[].slice.call(this.menuItems),this.initEvent(),this.initAria()}},render:function(t){var e=this,i=this.hide,n=this.splitButton,o=this.type,r=this.dropdownSize,a=function(t){e.$emit("click",t),i()},s=n?t("el-button-group",[t("el-button",{attrs:{type:o,size:r},nativeOn:{click:a}},[this.$slots.default]),t("el-button",{ref:"trigger",attrs:{type:o,size:r},class:"el-dropdown__caret-button"},[t("i",{class:"el-dropdown__icon el-icon-arrow-down"})])]):this.$slots.default;return t("div",{class:"el-dropdown",directives:[{name:"clickoutside",value:i}]},[s,this.$slots.dropdown])}},g=p,_=i(0),m=Object(_.a)(g,void 0,void 0,!1,null,null,null);m.options.__file="packages/dropdown/src/dropdown.vue";var v=m.exports,y={props:{widthType:String},mounted:function(){this.initWidth()},methods:{show:function(){var t=this;this.triggerElm.getAttribute("disabled")||(clearTimeout(this.timeout),this.timeout=setTimeout(function(){t.visible=!0},"click"===this.trigger?0:this.showTimeout))},initWidth:function(){if(this.widthType){var t="follow"===this.widthType?this.$el.offsetWidth+"px":this.widthType;this.dropdownElm&&(this.dropdownElm.style.width=t)}}}},w={name:"FiDropdown",extends:v,mixins:[y]};w.install=function(t){t.component(w.name,w)};e.default=w}})},e11e:function(t,e){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},e145:function(t,e,i){"use strict";function n(t,e,i){return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!(i&&i.context&&n.target&&o.target)||t.contains(n.target)||t.contains(o.target)||t===n.target||i.context.popperElm&&(i.context.popperElm.contains(n.target)||i.context.popperElm.contains(o.target))||(e.expression&&t[l].methodName&&i.context[t[l].methodName]?i.context[t[l].methodName]():t[l].bindingFn&&t[l].bindingFn())}}e.__esModule=!0;var o=i("8bbf"),r=function(t){return t&&t.__esModule?t:{default:t}}(o),a=i("73fa"),s=[],l="@@clickoutsideContext",h=void 0,c=0;!r.default.prototype.$isServer&&(0,a.on)(document,"mousedown",function(t){return h=t}),!r.default.prototype.$isServer&&(0,a.on)(document,"mouseup",function(t){s.forEach(function(e){return e[l].documentHandler(t,h)})}),e.default={bind:function(t,e,i){s.push(t);var o=c++;t[l]={id:o,documentHandler:n(t,e,i),methodName:e.expression,bindingFn:e.value}},update:function(t,e,i){t[l].documentHandler=n(t,e,i),t[l].methodName=e.expression,t[l].bindingFn=e.value},unbind:function(t){for(var e=s.length,i=0;i<e;i++)if(s[i][l].id===t[l].id){s.splice(i,1);break}delete t[l]}}},e4ae:function(t,e,i){var n=i("f772");t.exports=function(t){if(!n(t))throw TypeError(t+" is not an object!");return t}},e53d:function(t,e){var i=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=i)},e6f3:function(t,e,i){var n=i("07e3"),o=i("36c3"),r=i("5b4e")(!1),a=i("5559")("IE_PROTO");t.exports=function(t,e){var i,s=o(t),l=0,h=[];for(i in s)i!=a&&n(s,i)&&h.push(i);for(;e.length>l;)n(s,i=e[l++])&&(~r(h,i)||h.push(i));return h}},e853:function(t,e,i){var n=i("d3f4"),o=i("1169"),r=i("2b4c")("species");t.exports=function(t){var e;return o(t)&&(e=t.constructor,"function"!=typeof e||e!==Array&&!o(e.prototype)||(e=void 0),n(e)&&null===(e=e[r])&&(e=void 0)),void 0===e?Array:e}},ebd6:function(t,e,i){var n=i("cb7c"),o=i("d8e8"),r=i("2b4c")("species");t.exports=function(t,e){var i,a=n(t).constructor;return void 0===a||void 0==(i=n(a)[r])?e:o(i)}},ebfd:function(t,e,i){var n=i("62a0")("meta"),o=i("f772"),r=i("07e3"),a=i("d9f6").f,s=0,l=Object.isExtensible||function(){return!0},h=!i("294c")(function(){return l(Object.preventExtensions({}))}),c=function(t){a(t,n,{value:{i:"O"+ ++s,w:{}}})},u=function(t,e){if(!o(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!r(t,n)){if(!l(t))return"F";if(!e)return"E";c(t)}return t[n].i},d=function(t,e){if(!r(t,n)){if(!l(t))return!0;if(!e)return!1;c(t)}return t[n].w},f=function(t){return h&&p.NEED&&l(t)&&!r(t,n)&&c(t),t},p=t.exports={KEY:n,NEED:!1,fastKey:u,getWeak:d,onFreeze:f}},f6fd:function(t,e){!function(t){var e=t.getElementsByTagName("script");"currentScript"in t||Object.defineProperty(t,"currentScript",{get:function(){try{throw new Error}catch(n){var t,i=(/.*at [^\(]*\((.*):.+:.+\)$/gi.exec(n.stack)||[!1])[1];for(t in e)if(e[t].src==i||"interactive"==e[t].readyState)return e[t];return null}}})}(document)},f772:function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},f921:function(t,e,i){i("014b"),i("c207"),i("69d3"),i("765d"),t.exports=i("584a").Symbol},fa5b:function(t,e,i){t.exports=i("5537")("native-function-to-string",Function.toString)},fab2:function(t,e,i){var n=i("7726").document;t.exports=n&&n.documentElement},fb15:function(t,e,i){"use strict";function n(){return $.a.get(q)||K}function o(t){$.a.set(q,t)}function r(){return J}function a(t){J=t}function s(t,e){"undefined"!=typeof console&&(console.warn("[vue-i18n] "+t),e&&console.warn(e.stack))}function l(t,e){"undefined"!=typeof console&&(console.error("[vue-i18n] "+t),e&&console.error(e.stack))}function h(t){return null!==t&&"object"==typeof t}function c(t){return at.call(t)===st}function u(t){return null===t||void 0===t}function d(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var i=null,n=null;return 1===t.length?h(t[0])||Array.isArray(t[0])?n=t[0]:"string"==typeof t[0]&&(i=t[0]):2===t.length&&("string"==typeof t[0]&&(i=t[0]),(h(t[1])||Array.isArray(t[1]))&&(n=t[1])),{locale:i,params:n}}function f(t){return JSON.parse(JSON.stringify(t))}function p(t,e){if(t.length){var i=t.indexOf(e);if(i>-1)return t.splice(i,1)}}function g(t,e){return lt.call(t,e)}function _(t){for(var e=arguments,i=Object(t),n=1;n<arguments.length;n++){var o=e[n];if(void 0!==o&&null!==o){var r=void 0;for(r in o)g(o,r)&&(h(o[r])?i[r]=_(i[r],o[r]):i[r]=o[r])}}return i}function m(t,e){if(t===e)return!0;var i=h(t),n=h(e);if(!i||!n)return!i&&!n&&String(t)===String(e);try{var o=Array.isArray(t),r=Array.isArray(e);if(o&&r)return t.length===e.length&&t.every(function(t,i){return m(t,e[i])});if(o||r)return!1;var a=Object.keys(t),s=Object.keys(e);return a.length===s.length&&a.every(function(i){return m(t[i],e[i])})}catch(t){return!1}}function v(t){t.prototype.hasOwnProperty("$i18n")||Object.defineProperty(t.prototype,"$i18n",{get:function(){return this._i18n}}),t.prototype.$t=function(t){for(var e=[],i=arguments.length-1;i-- >0;)e[i]=arguments[i+1];var n=this.$i18n;return n._t.apply(n,[t,n.locale,n._getMessages(),this].concat(e))},t.prototype.$tc=function(t,e){for(var i=[],n=arguments.length-2;n-- >0;)i[n]=arguments[n+2];var o=this.$i18n;return o._tc.apply(o,[t,o.locale,o._getMessages(),this,e].concat(i))},t.prototype.$te=function(t,e){var i=this.$i18n;return i._te(t,i.locale,i._getMessages(),e)},t.prototype.$d=function(t){for(var e,i=[],n=arguments.length-1;n-- >0;)i[n]=arguments[n+1];return(e=this.$i18n).d.apply(e,[t].concat(i))},t.prototype.$n=function(t){for(var e,i=[],n=arguments.length-1;n-- >0;)i[n]=arguments[n+1];return(e=this.$i18n).n.apply(e,[t].concat(i))}}function y(t,e,i){x(t,i)&&C(t,e,i)}function w(t,e,i,n){if(x(t,i)){var o=i.context.$i18n;A(t,i)&&m(e.value,e.oldValue)&&m(t._localeMessage,o.getLocaleMessage(o.locale))||C(t,e,i)}}function b(t,e,i,n){if(!i.context)return void s("Vue instance does not exists in VNode context");var o=i.context.$i18n||{};e.modifiers.preserve||o.preserveDirectiveContent||(t.textContent=""),t._vt=void 0,delete t._vt,t._locale=void 0,delete t._locale,t._localeMessage=void 0,delete t._localeMessage}function x(t,e){var i=e.context;return i?!!i.$i18n||(s("VueI18n instance does not exists in Vue instance"),!1):(s("Vue instance does not exists in VNode context"),!1)}function A(t,e){var i=e.context;return t._locale===i.$i18n.locale}function C(t,e,i){var n,o,r=e.value,a=T(r),l=a.path,h=a.locale,c=a.args,u=a.choice;if(!l&&!h&&!c)return void s("value type not supported");if(!l)return void s("`path` is required in v-t directive");var d=i.context;t._vt=t.textContent=u?(n=d.$i18n).tc.apply(n,[l,u].concat(k(h,c))):(o=d.$i18n).t.apply(o,[l].concat(k(h,c))),t._locale=d.$i18n.locale,t._localeMessage=d.$i18n.getLocaleMessage(d.$i18n.locale)}function T(t){var e,i,n,o;return"string"==typeof t?e=t:c(t)&&(e=t.path,i=t.locale,n=t.args,o=t.choice),{path:e,locale:i,args:n,choice:o}}function k(t,e){var i=[];return t&&i.push(t),e&&(Array.isArray(e)||c(e))&&i.push(e),i}function S(t){S.installed=!0,nt=t;nt.version&&Number(nt.version.split(".")[0]);v(nt),nt.mixin(ht),nt.directive("t",{bind:y,update:w,unbind:b}),nt.component(ct.name,ct),nt.component(ut.name,ut),nt.config.optionMergeStrategies.i18n=function(t,e){return void 0===e?t:e}}function E(t){for(var e=[],i=0,n="";i<t.length;){var o=t[i++];if("{"===o){n&&e.push({type:"text",value:n}),n="";var r="";for(o=t[i++];void 0!==o&&"}"!==o;)r+=o,o=t[i++];var a="}"===o,s=ft.test(r)?"list":a&&pt.test(r)?"named":"unknown";e.push({value:r,type:s})}else"%"===o?"{"!==t[i]&&(n+=o):n+=o}return n&&e.push({type:"text",value:n}),e}function I(t,e){var i=[],n=0,o=Array.isArray(e)?"list":h(e)?"named":"unknown";if("unknown"===o)return i;for(;n<t.length;){var r=t[n];switch(r.type){case"text":i.push(r.value);break;case"list":i.push(e[parseInt(r.value,10)]);break;case"named":"named"===o&&i.push(e[r.value])}n++}return i}function L(t){return kt.test(t)}function R(t){var e=t.charCodeAt(0);return e!==t.charCodeAt(t.length-1)||34!==e&&39!==e?t:t.slice(1,-1)}function P(t){if(void 0===t||null===t)return"eof";switch(t.charCodeAt(0)){case 91:case 93:case 46:case 34:case 39:return t;case 95:case 36:case 45:return"ident";case 9:case 10:case 13:case 160:case 65279:case 8232:case 8233:return"ws"}return"ident"}function O(t){var e=t.trim();return("0"!==t.charAt(0)||!isNaN(t))&&(L(e)?R(e):"*"+e)}function D(t){var e,i,n,o,r,a,s,l=[],h=-1,c=yt,u=0,d=[];for(d[_t]=function(){void 0!==i&&(l.push(i),i=void 0)},d[gt]=function(){void 0===i?i=n:i+=n},d[mt]=function(){d[gt](),u++},d[vt]=function(){if(u>0)u--,c=wt,d[gt]();else{if(u=0,!1===(i=O(i)))return!1;d[_t]()}};null!==c;)if(h++,"\\"!==(e=t[h])||!function(){var e=t[h+1];if(c===bt&&"'"===e||c===xt&&'"'===e)return h++,n="\\"+e,d[gt](),!0}()){if(o=P(e),s=Tt[c],(r=s[o]||s.else||Ct)===Ct)return;if(c=r[0],(a=d[r[1]])&&(n=r[2],n=void 0===n?e:n,!1===a()))return;if(c===At)return l}}function M(t,e){t.use(Bt);var i=n();return new Bt({locale:i,fallbackLocale:i,messages:e})}function N(t){return(N="function"==typeof Ht.a&&"symbol"==typeof Ut.a?function(t){return typeof t}:function(t){return t&&"function"==typeof Ht.a&&t.constructor===Ht.a&&t!==Ht.a.prototype?"symbol":typeof t})(t)}function B(t){return(B="function"==typeof Ht.a&&"symbol"===N(Ut.a)?function(t){return N(t)}:function(t){return t&&"function"==typeof Ht.a&&t.constructor===Ht.a&&t!==Ht.a.prototype?"symbol":N(t)})(t)}function F(t,e){return Object.prototype.hasOwnProperty.call(t,e)}if(i.r(e),"undefined"!=typeof window){i("f6fd");var z;(z=window.document.currentScript)&&(z=z.src.match(/(.+\/)[^\/]+\.js(\?.*)?$/))&&(i.p=z[1])}var V=(i("7f7f"),function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("dropdown",{staticClass:"fi-lang-select",on:{command:t.handleCommand}},[i("span",{staticClass:"fi-lang-select__link"},[i("span",{staticClass:"fi-lang-select__link__text"},[t._v(t._s(t.lang))]),i("i",{staticClass:"el-icon-arrow-down fi-lang-select__link__icon"})]),i("dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},t._l(t.localList,function(e,n){return i("dropdown-item",{key:n,attrs:{command:e.value}},[t._v(t._s(e.label))])}),1)],1)}),U=[],j=(i("ac6a"),i("cadf"),i("456d"),i("7514"),i("66b5"),i("8306"),i("797b")),H=i.n(j),W=(i("db7e"),i("4800")),G=i.n(W),Z=(i("ff3c"),i("e0c7")),X=i.n(Z),Y=i("a78e"),$=i.n(Y),q="LOCALE",K="zh-CN",J={"zh-CN":"简体中文",en:"English"},Q={name:"FiLangSelect",components:{Dropdown:X.a,DropdownMenu:G.a,DropdownItem:H.a},props:{options:{type:Array}},data:function(){return{langValue:n(),autoLocalList:[]}},computed:{localList:function(){return this.options?this.options:this.autoLocalList},lang:function(){var t=this;return(this.localList.find(function(e){return e.value===t.langValue})||{}).label}},created:function(){var t=this;if(!this.options&&this.$i18n){var e=Object.keys(this.$i18n._getMessages()),i=r();e.forEach(function(e){t.autoLocalList.push({value:e,label:i[e]})})}},methods:{handleCommand:function(t){t!==n()&&(this.langValue=t,this.$i18n.locale=t,o(t),this.$emit("change",t))}}},tt=Q,et=(i("3aff"),function(t,e,i,n,o,r,a,s){var l="function"==typeof t?t.options:t;e&&(l.render=e,l.staticRenderFns=i,l._compiled=!0),n&&(l.functional=!0),r&&(l._scopeId="data-v-"+r);var h;if(a?(h=function(t){t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,t||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),o&&o.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(a)},l._ssrRegister=h):o&&(h=s?function(){o.call(this,this.$root.$options.shadowRoot)}:o),h)if(l.functional){l._injectStyles=h;var c=l.render;l.render=function(t,e){return h.call(e),c(t,e)}}else{var u=l.beforeCreate;l.beforeCreate=u?[].concat(u,h):[h]}return{exports:t,options:l}}(tt,V,U,!1,null,"a687b908",null)),it=et.exports;it.install=function(t){t.component(it.name,it)};var nt,ot=it,rt=["style","currency","currencyDisplay","useGrouping","minimumIntegerDigits","minimumFractionDigits","maximumFractionDigits","minimumSignificantDigits","maximumSignificantDigits","localeMatcher","formatMatcher"],at=Object.prototype.toString,st="[object Object]",lt=Object.prototype.hasOwnProperty,ht={beforeCreate:function(){var t=this.$options;if(t.i18n=t.i18n||(t.__i18n?{}:null),t.i18n){if(t.i18n instanceof Dt){if(t.__i18n)try{var e={};t.__i18n.forEach(function(t){e=_(e,JSON.parse(t))}),Object.keys(e).forEach(function(i){t.i18n.mergeLocaleMessage(i,e[i])})}catch(t){}this._i18n=t.i18n,this._i18nWatcher=this._i18n.watchI18nData()}else if(c(t.i18n)){if(this.$root&&this.$root.$i18n&&this.$root.$i18n instanceof Dt&&(t.i18n.root=this.$root,t.i18n.formatter=this.$root.$i18n.formatter,t.i18n.fallbackLocale=this.$root.$i18n.fallbackLocale,t.i18n.silentTranslationWarn=this.$root.$i18n.silentTranslationWarn,t.i18n.silentFallbackWarn=this.$root.$i18n.silentFallbackWarn,t.i18n.pluralizationRules=this.$root.$i18n.pluralizationRules,t.i18n.preserveDirectiveContent=this.$root.$i18n.preserveDirectiveContent),t.__i18n)try{var i={};t.__i18n.forEach(function(t){i=_(i,JSON.parse(t))}),t.i18n.messages=i}catch(t){}this._i18n=new Dt(t.i18n),this._i18nWatcher=this._i18n.watchI18nData(),(void 0===t.i18n.sync||t.i18n.sync)&&(this._localeWatcher=this.$i18n.watchLocale())}}else this.$root&&this.$root.$i18n&&this.$root.$i18n instanceof Dt?this._i18n=this.$root.$i18n:t.parent&&t.parent.$i18n&&t.parent.$i18n instanceof Dt&&(this._i18n=t.parent.$i18n)},beforeMount:function(){var t=this.$options;t.i18n=t.i18n||(t.__i18n?{}:null),t.i18n?t.i18n instanceof Dt?(this._i18n.subscribeDataChanging(this),this._subscribing=!0):c(t.i18n)&&(this._i18n.subscribeDataChanging(this),this._subscribing=!0):this.$root&&this.$root.$i18n&&this.$root.$i18n instanceof Dt?(this._i18n.subscribeDataChanging(this),this._subscribing=!0):t.parent&&t.parent.$i18n&&t.parent.$i18n instanceof Dt&&(this._i18n.subscribeDataChanging(this),this._subscribing=!0)},beforeDestroy:function(){if(this._i18n){var t=this;this.$nextTick(function(){t._subscribing&&(t._i18n.unsubscribeDataChanging(t),delete t._subscribing),t._i18nWatcher&&(t._i18nWatcher(),t._i18n.destroyVM(),delete t._i18nWatcher),t._localeWatcher&&(t._localeWatcher(),delete t._localeWatcher),t._i18n=null})}}},ct={name:"i18n",functional:!0,props:{tag:{type:String,default:"span"},path:{type:String,required:!0},locale:{type:String},places:{type:[Array,Object]}},render:function(t,e){var i=e.props,n=e.data,o=e.children,r=e.parent,a=r.$i18n;if(o=(o||[]).filter(function(t){return t.tag||(t.text=t.text.trim())}),!a)return o;var s=i.path,l=i.locale,h={},c=i.places||{},u=(Array.isArray(c)?c.length:Object.keys(c).length,o.every(function(t){if(t.data&&t.data.attrs){var e=t.data.attrs.place;return void 0!==e&&""!==e}}));return Array.isArray(c)?c.forEach(function(t,e){h[e]=t}):Object.keys(c).forEach(function(t){h[t]=c[t]}),o.forEach(function(t,e){var i=u?""+t.data.attrs.place:""+e;h[i]=t}),t(i.tag,n,a.i(s,l,h))}},ut={name:"i18n-n",functional:!0,props:{tag:{type:String,default:"span"},value:{type:Number,required:!0},format:{type:[String,Object]},locale:{type:String}},render:function(t,e){var i=e.props,n=e.parent,o=e.data,r=n.$i18n;if(!r)return null;var a=null,s=null;"string"==typeof i.format?a=i.format:h(i.format)&&(i.format.key&&(a=i.format.key),s=Object.keys(i.format).reduce(function(t,e){var n;return rt.includes(e)?Object.assign({},t,(n={},n[e]=i.format[e],n)):t},null));var l=i.locale||r.locale,c=r._ntp(i.value,l,a,s),u=c.map(function(t,e){var i,n=o.scopedSlots&&o.scopedSlots[t.type];return n?n((i={},i[t.type]=t.value,i.index=e,i.parts=c,i)):t.value});return t(i.tag,{attrs:o.attrs,class:o.class,staticClass:o.staticClass},u)}},dt=function(){this._caches=Object.create(null)};dt.prototype.interpolate=function(t,e){if(!e)return[t];var i=this._caches[t];return i||(i=E(t),this._caches[t]=i),I(i,e)};var ft=/^(?:\d)+/,pt=/^(?:\w)+/,gt=0,_t=1,mt=2,vt=3,yt=0,wt=4,bt=5,xt=6,At=7,Ct=8,Tt=[];Tt[yt]={ws:[yt],ident:[3,gt],"[":[wt],eof:[At]},Tt[1]={ws:[1],".":[2],"[":[wt],eof:[At]},Tt[2]={ws:[2],ident:[3,gt],0:[3,gt],number:[3,gt]},Tt[3]={ident:[3,gt],0:[3,gt],number:[3,gt],ws:[1,_t],".":[2,_t],"[":[wt,_t],eof:[At,_t]},Tt[wt]={"'":[bt,gt],'"':[xt,gt],"[":[wt,mt],"]":[1,vt],eof:Ct,else:[wt,gt]},Tt[bt]={"'":[wt,gt],eof:Ct,else:[bt,gt]},Tt[xt]={'"':[wt,gt],eof:Ct,else:[xt,gt]};var kt=/^\s?(?:true|false|-?[\d.]+|'[^']*'|"[^"]*")\s?$/,St=function(){this._cache=Object.create(null)};St.prototype.parsePath=function(t){var e=this._cache[t];return e||(e=D(t))&&(this._cache[t]=e),e||[]},St.prototype.getPathValue=function(t,e){if(!h(t))return null;var i=this.parsePath(e);if(0===i.length)return null;for(var n=i.length,o=t,r=0;r<n;){var a=o[i[r]];if(void 0===a)return null;o=a,r++}return o};var Et=/<\/?[\w\s="\/.':;#-\/]+>/,It=/(?:@(?:\.[a-z]+)?:(?:[\w\-_|.]+|\([\w\-_|.]+\)))/g,Lt=/^@(?:\.([a-z]+))?:/,Rt=/[()]/g,Pt={upper:function(t){return t.toLocaleUpperCase()},lower:function(t){return t.toLocaleLowerCase()}},Ot=new dt,Dt=function(t){var e=this;void 0===t&&(t={}),!nt&&"undefined"!=typeof window&&window.Vue&&S(window.Vue);var i=t.locale||"en-US",n=t.fallbackLocale||"en-US",o=t.messages||{},r=t.dateTimeFormats||{},a=t.numberFormats||{};this._vm=null,this._formatter=t.formatter||Ot,this._missing=t.missing||null,this._root=t.root||null,this._sync=void 0===t.sync||!!t.sync,this._fallbackRoot=void 0===t.fallbackRoot||!!t.fallbackRoot,this._silentTranslationWarn=void 0!==t.silentTranslationWarn&&!!t.silentTranslationWarn,this._silentFallbackWarn=void 0!==t.silentFallbackWarn&&!!t.silentFallbackWarn,this._dateTimeFormatters={},this._numberFormatters={},this._path=new St,this._dataListeners=[],this._preserveDirectiveContent=void 0!==t.preserveDirectiveContent&&!!t.preserveDirectiveContent,this.pluralizationRules=t.pluralizationRules||{},this._warnHtmlInMessage=t.warnHtmlInMessage||"off",this._exist=function(t,i){return!(!t||!i)&&(!u(e._path.getPathValue(t,i))||!!t[i])},"warn"!==this._warnHtmlInMessage&&"error"!==this._warnHtmlInMessage||Object.keys(o).forEach(function(t){e._checkLocaleMessage(t,e._warnHtmlInMessage,o[t])}),this._initVM({locale:i,fallbackLocale:n,messages:o,dateTimeFormats:r,numberFormats:a})},Mt={vm:{configurable:!0},messages:{configurable:!0},dateTimeFormats:{configurable:!0},numberFormats:{configurable:!0},availableLocales:{configurable:!0},locale:{configurable:!0},fallbackLocale:{configurable:!0},missing:{configurable:!0},formatter:{configurable:!0},silentTranslationWarn:{configurable:!0},silentFallbackWarn:{configurable:!0},preserveDirectiveContent:{configurable:!0},warnHtmlInMessage:{configurable:!0}};Dt.prototype._checkLocaleMessage=function(t,e,i){var n=[],o=function(t,e,i,n){if(c(i))Object.keys(i).forEach(function(r){var a=i[r];c(a)?(n.push(r),n.push("."),o(t,e,a,n),n.pop(),n.pop()):(n.push(r),o(t,e,a,n),n.pop())});else if(Array.isArray(i))i.forEach(function(i,r){c(i)?(n.push("["+r+"]"),n.push("."),o(t,e,i,n),n.pop(),n.pop()):(n.push("["+r+"]"),o(t,e,i,n),n.pop())});else if("string"==typeof i){var r=Et.test(i);if(r){var a="Detected HTML in message '"+i+"' of keypath '"+n.join("")+"' at '"+e+"'. Consider component interpolation with '<i18n>' to avoid XSS. See https://bit.ly/2ZqJzkp";"warn"===t?s(a):"error"===t&&l(a)}}};o(e,t,i,n)},Dt.prototype._initVM=function(t){var e=nt.config.silent;nt.config.silent=!0,this._vm=new nt({data:t}),nt.config.silent=e},Dt.prototype.destroyVM=function(){this._vm.$destroy()},Dt.prototype.subscribeDataChanging=function(t){this._dataListeners.push(t)},Dt.prototype.unsubscribeDataChanging=function(t){p(this._dataListeners,t)},Dt.prototype.watchI18nData=function(){var t=this;return this._vm.$watch("$data",function(){for(var e=t._dataListeners.length;e--;)nt.nextTick(function(){t._dataListeners[e]&&t._dataListeners[e].$forceUpdate()})},{deep:!0})},Dt.prototype.watchLocale=function(){if(!this._sync||!this._root)return null;var t=this._vm;return this._root.$i18n.vm.$watch("locale",function(e){t.$set(t,"locale",e),t.$forceUpdate()},{immediate:!0})},Mt.vm.get=function(){return this._vm},Mt.messages.get=function(){return f(this._getMessages())},Mt.dateTimeFormats.get=function(){return f(this._getDateTimeFormats())},Mt.numberFormats.get=function(){return f(this._getNumberFormats())},Mt.availableLocales.get=function(){return Object.keys(this.messages).sort()},Mt.locale.get=function(){return this._vm.locale},Mt.locale.set=function(t){this._vm.$set(this._vm,"locale",t)},Mt.fallbackLocale.get=function(){return this._vm.fallbackLocale},Mt.fallbackLocale.set=function(t){this._vm.$set(this._vm,"fallbackLocale",t)},Mt.missing.get=function(){return this._missing},Mt.missing.set=function(t){this._missing=t},Mt.formatter.get=function(){return this._formatter},Mt.formatter.set=function(t){this._formatter=t},Mt.silentTranslationWarn.get=function(){return this._silentTranslationWarn},Mt.silentTranslationWarn.set=function(t){this._silentTranslationWarn=t},Mt.silentFallbackWarn.get=function(){return this._silentFallbackWarn},Mt.silentFallbackWarn.set=function(t){this._silentFallbackWarn=t},Mt.preserveDirectiveContent.get=function(){return this._preserveDirectiveContent},Mt.preserveDirectiveContent.set=function(t){this._preserveDirectiveContent=t},Mt.warnHtmlInMessage.get=function(){return this._warnHtmlInMessage},Mt.warnHtmlInMessage.set=function(t){var e=this,i=this._warnHtmlInMessage;if(this._warnHtmlInMessage=t,i!==t&&("warn"===t||"error"===t)){var n=this._getMessages();Object.keys(n).forEach(function(t){e._checkLocaleMessage(t,e._warnHtmlInMessage,n[t])})}},Dt.prototype._getMessages=function(){return this._vm.messages},Dt.prototype._getDateTimeFormats=function(){return this._vm.dateTimeFormats},Dt.prototype._getNumberFormats=function(){return this._vm.numberFormats},Dt.prototype._warnDefault=function(t,e,i,n,o){if(!u(i))return i;if(this._missing){var r=this._missing.apply(null,[t,e,n,o]);if("string"==typeof r)return r}return e},Dt.prototype._isFallbackRoot=function(t){return!t&&!u(this._root)&&this._fallbackRoot},Dt.prototype._isSilentFallback=function(t){return this._silentFallbackWarn&&(this._isFallbackRoot()||t!==this.fallbackLocale)},Dt.prototype._interpolate=function(t,e,i,n,o,r,a){if(!e)return null;var s=this._path.getPathValue(e,i);if(Array.isArray(s)||c(s))return s;var l;if(u(s)){if(!c(e))return null;if("string"!=typeof(l=e[i]))return null}else{if("string"!=typeof s)return null;l=s}return(l.indexOf("@:")>=0||l.indexOf("@.")>=0)&&(l=this._link(t,e,l,n,"raw",r,a)),this._render(l,o,r,i)},Dt.prototype._link=function(t,e,i,n,o,r,a){var s=i,l=s.match(It);for(var h in l)if(l.hasOwnProperty(h)){var c=l[h],u=c.match(Lt),d=u[0],f=u[1],p=c.replace(d,"").replace(Rt,"");if(a.includes(p))return s;a.push(p);var g=this._interpolate(t,e,p,n,"raw"===o?"string":o,"raw"===o?void 0:r,a);if(this._isFallbackRoot(g)){if(!this._root)throw Error("unexpected error");var _=this._root.$i18n;g=_._translate(_._getMessages(),_.locale,_.fallbackLocale,p,n,o,r)}g=this._warnDefault(t,p,g,n,Array.isArray(r)?r:[r]),Pt.hasOwnProperty(f)&&(g=Pt[f](g)),a.pop(),s=g?s.replace(c,g):s}return s},Dt.prototype._render=function(t,e,i,n){var o=this._formatter.interpolate(t,i,n);return o||(o=Ot.interpolate(t,i,n)),"string"===e?o.join(""):o},Dt.prototype._translate=function(t,e,i,n,o,r,a){var s=this._interpolate(e,t[e],n,o,r,a,[n]);return u(s)?(s=this._interpolate(i,t[i],n,o,r,a,[n]),u(s)?null:s):s},Dt.prototype._t=function(t,e,i,n){for(var o,r=[],a=arguments.length-4;a-- >0;)r[a]=arguments[a+4];if(!t)return"";var s=d.apply(void 0,r),l=s.locale||e,h=this._translate(i,l,this.fallbackLocale,t,n,"string",s.params);if(this._isFallbackRoot(h)){if(!this._root)throw Error("unexpected error");return(o=this._root).$t.apply(o,[t].concat(r))}return this._warnDefault(l,t,h,n,r)},Dt.prototype.t=function(t){for(var e,i=[],n=arguments.length-1;n-- >0;)i[n]=arguments[n+1];return(e=this)._t.apply(e,[t,this.locale,this._getMessages(),null].concat(i))},Dt.prototype._i=function(t,e,i,n,o){var r=this._translate(i,e,this.fallbackLocale,t,n,"raw",o);if(this._isFallbackRoot(r)){if(!this._root)throw Error("unexpected error");return this._root.$i18n.i(t,e,o)}return this._warnDefault(e,t,r,n,[o])},Dt.prototype.i=function(t,e,i){return t?("string"!=typeof e&&(e=this.locale),this._i(t,e,this._getMessages(),null,i)):""},Dt.prototype._tc=function(t,e,i,n,o){for(var r,a=[],s=arguments.length-5;s-- >0;)a[s]=arguments[s+5];if(!t)return"";void 0===o&&(o=1);var l={count:o,n:o},h=d.apply(void 0,a);return h.params=Object.assign(l,h.params),a=null===h.locale?[h.params]:[h.locale,h.params],this.fetchChoice((r=this)._t.apply(r,[t,e,i,n].concat(a)),o)},Dt.prototype.fetchChoice=function(t,e){if(!t&&"string"!=typeof t)return null;var i=t.split("|");return e=this.getChoiceIndex(e,i.length),i[e]?i[e].trim():t},Dt.prototype.getChoiceIndex=function(t,e){return this.locale in this.pluralizationRules?this.pluralizationRules[this.locale].apply(this,[t,e]):function(t,e){return t=Math.abs(t),2===e?t?t>1?1:0:1:t?Math.min(t,2):0}(t,e)},Dt.prototype.tc=function(t,e){for(var i,n=[],o=arguments.length-2;o-- >0;)n[o]=arguments[o+2];return(i=this)._tc.apply(i,[t,this.locale,this._getMessages(),null,e].concat(n))},Dt.prototype._te=function(t,e,i){for(var n=[],o=arguments.length-3;o-- >0;)n[o]=arguments[o+3];var r=d.apply(void 0,n).locale||e;return this._exist(i[r],t)},Dt.prototype.te=function(t,e){return this._te(t,this.locale,this._getMessages(),e)},Dt.prototype.getLocaleMessage=function(t){return f(this._vm.messages[t]||{})},Dt.prototype.setLocaleMessage=function(t,e){("warn"!==this._warnHtmlInMessage&&"error"!==this._warnHtmlInMessage||(this._checkLocaleMessage(t,this._warnHtmlInMessage,e),"error"!==this._warnHtmlInMessage))&&this._vm.$set(this._vm.messages,t,e)},Dt.prototype.mergeLocaleMessage=function(t,e){("warn"!==this._warnHtmlInMessage&&"error"!==this._warnHtmlInMessage||(this._checkLocaleMessage(t,this._warnHtmlInMessage,e),"error"!==this._warnHtmlInMessage))&&this._vm.$set(this._vm.messages,t,_(this._vm.messages[t]||{},e))},Dt.prototype.getDateTimeFormat=function(t){return f(this._vm.dateTimeFormats[t]||{})},Dt.prototype.setDateTimeFormat=function(t,e){this._vm.$set(this._vm.dateTimeFormats,t,e)},Dt.prototype.mergeDateTimeFormat=function(t,e){this._vm.$set(this._vm.dateTimeFormats,t,_(this._vm.dateTimeFormats[t]||{},e))},Dt.prototype._localizeDateTime=function(t,e,i,n,o){var r=e,a=n[r];if((u(a)||u(a[o]))&&(r=i,a=n[r]),u(a)||u(a[o]))return null;var s=a[o],l=r+"__"+o,h=this._dateTimeFormatters[l];return h||(h=this._dateTimeFormatters[l]=new Intl.DateTimeFormat(r,s)),h.format(t)},Dt.prototype._d=function(t,e,i){if(!i)return new Intl.DateTimeFormat(e).format(t);var n=this._localizeDateTime(t,e,this.fallbackLocale,this._getDateTimeFormats(),i);if(this._isFallbackRoot(n)){if(!this._root)throw Error("unexpected error");return this._root.$i18n.d(t,i,e)}return n||""},Dt.prototype.d=function(t){for(var e=[],i=arguments.length-1;i-- >0;)e[i]=arguments[i+1];var n=this.locale,o=null;return 1===e.length?"string"==typeof e[0]?o=e[0]:h(e[0])&&(e[0].locale&&(n=e[0].locale),e[0].key&&(o=e[0].key)):2===e.length&&("string"==typeof e[0]&&(o=e[0]),"string"==typeof e[1]&&(n=e[1])),this._d(t,n,o)},Dt.prototype.getNumberFormat=function(t){return f(this._vm.numberFormats[t]||{})},Dt.prototype.setNumberFormat=function(t,e){this._vm.$set(this._vm.numberFormats,t,e)},Dt.prototype.mergeNumberFormat=function(t,e){this._vm.$set(this._vm.numberFormats,t,_(this._vm.numberFormats[t]||{},e))},Dt.prototype._getNumberFormatter=function(t,e,i,n,o,r){var a=e,s=n[a];if((u(s)||u(s[o]))&&(a=i,s=n[a]),u(s)||u(s[o]))return null;var l,h=s[o];if(r)l=new Intl.NumberFormat(a,Object.assign({},h,r));else{var c=a+"__"+o;l=this._numberFormatters[c],l||(l=this._numberFormatters[c]=new Intl.NumberFormat(a,h))}return l},Dt.prototype._n=function(t,e,i,n){if(!Dt.availabilities.numberFormat)return"";if(!i){return(n?new Intl.NumberFormat(e,n):new Intl.NumberFormat(e)).format(t)}var o=this._getNumberFormatter(t,e,this.fallbackLocale,this._getNumberFormats(),i,n),r=o&&o.format(t);if(this._isFallbackRoot(r)){if(!this._root)throw Error("unexpected error");return this._root.$i18n.n(t,Object.assign({},{key:i,locale:e},n))}return r||""},Dt.prototype.n=function(t){for(var e=[],i=arguments.length-1;i-- >0;)e[i]=arguments[i+1];var n=this.locale,o=null,r=null;return 1===e.length?"string"==typeof e[0]?o=e[0]:h(e[0])&&(e[0].locale&&(n=e[0].locale),e[0].key&&(o=e[0].key),r=Object.keys(e[0]).reduce(function(t,i){var n;return rt.includes(i)?Object.assign({},t,(n={},n[i]=e[0][i],n)):t},null)):2===e.length&&("string"==typeof e[0]&&(o=e[0]),"string"==typeof e[1]&&(n=e[1])),this._n(t,n,o,r)},Dt.prototype._ntp=function(t,e,i,n){if(!Dt.availabilities.numberFormat)return[];if(!i){return(n?new Intl.NumberFormat(e,n):new Intl.NumberFormat(e)).formatToParts(t)}var o=this._getNumberFormatter(t,e,this.fallbackLocale,this._getNumberFormats(),i,n),r=o&&o.formatToParts(t);if(this._isFallbackRoot(r)){if(!this._root)throw Error("unexpected error");return this._root.$i18n._ntp(t,e,i,n)}return r||[]},Object.defineProperties(Dt.prototype,Mt);var Nt;Object.defineProperty(Dt,"availabilities",{get:function(){if(!Nt){var t="undefined"!=typeof Intl;Nt={dateTimeFormat:t&&void 0!==Intl.DateTimeFormat,numberFormat:t&&void 0!==Intl.NumberFormat}}return Nt}}),Dt.install=S,Dt.version="8.11.2";var Bt=Dt,Ft=(i("28a5"),i("8bbf")),zt=i.n(Ft),Vt=(i("a481"),i("5d58")),Ut=i.n(Vt),jt=i("67bb"),Ht=i.n(jt),Wt=/(%|)\{([0-9a-zA-Z_]+)\}/g,Gt=function(){function t(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];return 1===i.length&&"object"===B(i[0])&&(i=i[0]),i&&i.hasOwnProperty||(i={}),t.replace(Wt,function(e,n,o,r){if("{"===t[r-1]&&"}"===t[r+e.length])return o;var a=F(i,o)?i[o]:null;return null===a||void 0===a?"":a})}return t}(zt.a),Zt={},Xt=n(),Yt=!1,$t=function(t,e){var i=this;if(this.$i18n)return Yt||(Yt=!0,Object.keys(Zt).forEach(function(t){i.$i18n.mergeLocaleMessage(t,Zt[t])})),this.$t.apply(this,[t,e]);for(var n,o=t.split("."),r=Zt[Xt],a=0,s=o.length;a<s;a++){if(n=r[o[a]],a===s-1)return Gt(n,e);if(!n)return"";r=n}return""},qt=function(t){var e=t.messages,i=t.locale;Zt=e||Zt,Xt=i||Xt},Kt={use:qt},Jt={methods:{t:function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return $t.apply(this,e)}}},Qt=[ot],te={version:"0.1.0",install:function(t,e){te.i18n=M(t,e),Qt.map(function(e){return t.component(e.name,e)})},LangSelect:ot,i18n:null,setLocalMap:a,i18n4Lib:Kt,localeMixin:Jt};"undefined"!=typeof window&&window.Vue&&te.install(window.Vue);var ee=te;e.default=ee},ff3c:function(t,e,i){}}).default},"9f1c":function(t,e,i){function n(t){var e=new t.constructor(t.byteLength);return new o(e).set(new o(t)),e}var o=i("78b2");t.exports=n},"9f57":function(t,e,i){"use strict";var n=i("8281"),o=i.n(n);o.a},a20e:function(t,e){function i(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||n)}var n=Object.prototype;t.exports=i},a34a:function(t,e,i){t.exports=i("96cf")},a485:function(t,e){function i(t,e){return function(i){return t(e(i))}}t.exports=i},a54a:function(t,e,i){},a5c5:function(t,e,i){var n=i("e80d"),o=i("2c74"),r=n(o,"WeakMap");t.exports=r},a720:function(t,e,i){},a729:function(t,e,i){},a77d:function(t,e,i){"use strict";var n=i("d58b"),o=i.n(n);o.a},a9f1:function(t,e){function i(t){var e=t.length,i=new t.constructor(e);return e&&"string"==typeof t[0]&&o.call(t,"index")&&(i.index=t.index,i.input=t.input),i}var n=Object.prototype,o=n.hasOwnProperty;t.exports=i},aa3b:function(t,e){function i(){return[]}t.exports=i},ae99:function(t,e,i){(function(t){var n=i("2c74"),o=i("6efc"),r=e&&!e.nodeType&&e,a=r&&"object"==typeof t&&t&&!t.nodeType&&t,s=a&&a.exports===r,l=s?n.Buffer:void 0,h=l?l.isBuffer:void 0,c=h||o;t.exports=c}).call(this,i("62e4")(t))},b101:function(t,e,i){function n(t,e,i){var n=e(t);return r(t)?n:o(n,i(t))}var o=i("904b"),r=i("c326");t.exports=n},b25f:function(t,e,i){"use strict";var n=i("0809"),o=i.n(n);o.a},b892:function(t,e,i){function n(t){var e=this.__data__,i=o(e,t);return i<0?void 0:e[i][1]}var o=i("8d51");t.exports=n},b913:function(t,e,i){function n(t,e,i){"__proto__"==e&&o?o(t,e,{configurable:!0,enumerable:!0,value:i,writable:!0}):t[e]=i}var o=i("40a0");t.exports=n},bb61:function(t,e,i){},bd6a:function(t,e,i){"use strict";var n=i("de26"),o=i.n(n);o.a},c1b0:function(t,e,i){function n(t){return a(t)&&r(t.length)&&!!s[o(t)]}var o=i("92c7"),r=i("dc7c"),a=i("00c2"),s={};s["[object Float32Array]"]=s["[object Float64Array]"]=s["[object Int8Array]"]=s["[object Int16Array]"]=s["[object Int32Array]"]=s["[object Uint8Array]"]=s["[object Uint8ClampedArray]"]=s["[object Uint16Array]"]=s["[object Uint32Array]"]=!0,s["[object Arguments]"]=s["[object Array]"]=s["[object ArrayBuffer]"]=s["[object Boolean]"]=s["[object DataView]"]=s["[object Date]"]=s["[object Error]"]=s["[object Function]"]=s["[object Map]"]=s["[object Number]"]=s["[object Object]"]=s["[object RegExp]"]=s["[object Set]"]=s["[object String]"]=s["[object WeakMap]"]=!1,t.exports=n},c326:function(t,e){var i=Array.isArray;t.exports=i},c5f3:function(t,e,i){(function(e){var i="object"==typeof e&&e&&e.Object===Object&&e;t.exports=i}).call(this,i("c8ba"))},c6fa:function(t,e,i){},c7ee:function(t,e,i){function n(t,e){return o(t,r(t),e)}var o=i("f34d"),r=i("4534");t.exports=n},c8ba:function(t,e){var i;i=function(){return this}();try{i=i||new Function("return this")()}catch(t){"object"==typeof window&&(i=window)}t.exports=i},c8da:function(t,e){function i(t){return this.__data__.get(t)}t.exports=i},c94b:function(t,e,i){function n(t){return o(t,a,r)}var o=i("b101"),r=i("4534"),a=i("7117");t.exports=n},cab6:function(t,e,i){"use strict";var n=i("10eb"),o=i.n(n);o.a},cbdb:function(t,e,i){var n=i("e80d"),o=i("2c74"),r=n(o,"Promise");t.exports=r},cd10:function(t,e){function i(t){var e=[];if(null!=t)for(var i in Object(t))e.push(i);return e}t.exports=i},cde6:function(t,e,i){function n(t,e,i){var n=t[e];s.call(t,e)&&r(n,i)&&(void 0!==i||e in t)||o(t,e,i)}var o=i("b913"),r=i("1943"),a=Object.prototype,s=a.hasOwnProperty;t.exports=n},ce0f:function(t,e,i){function n(t){return o(this,t).get(t)}var o=i("6ca4");t.exports=n},ce4b:function(t,e,i){function n(){this.__data__=o?o(null):{},this.size=0}var o=i("2817");t.exports=n},cebe:function(t,e){t.exports=n("bc3a")},cf09:function(t,e,i){function n(t){return!!r&&r in t}var o=i("0e04"),r=function(){var t=/[^.]+$/.exec(o&&o.keys&&o.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();t.exports=n},d0cb:function(t,e,i){var n=i("e80d"),o=i("2c74"),r=n(o,"DataView");t.exports=r},d1cd:function(t,e,i){i("7725"),i("6b5a")},d49e:function(t,e,i){},d58b:function(t,e,i){},d5d3:function(t,e){function i(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}t.exports=i},d880:function(t,e,i){"use strict";var n=i("a54a"),o=i.n(n);o.a},d8d3:function(t,e){function i(t,e){var i=-1,n=t.length;for(e||(e=Array(n));++i<n;)e[i]=t[i];return e}t.exports=i},db19:function(t,e,i){var n=i("9bb8"),o=i("1513"),r=i("519f"),a=r&&r.isMap,s=a?o(a):n;t.exports=s},dc7c:function(t,e){function i(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=n}var n=9007199254740991;t.exports=i},de26:function(t,e,i){},def0:function(t,e,i){function n(t,e){var i=this.__data__;if(i instanceof o){var n=i.__data__;if(!r||n.length<s-1)return n.push([t,e]),this.size=++i.size,this;i=this.__data__=new a(n)}return i.set(t,e),this.size=i.size,this}var o=i("88f9"),r=i("f1e1"),a=i("122e"),s=200;t.exports=n},df37:function(t,e,i){function n(t,e){var i=a(t),n=!i&&r(t),c=!i&&!n&&s(t),d=!i&&!n&&!c&&h(t),f=i||n||c||d,p=f?o(t.length,String):[],g=p.length;for(var _ in t)!e&&!u.call(t,_)||f&&("length"==_||c&&("offset"==_||"parent"==_)||d&&("buffer"==_||"byteLength"==_||"byteOffset"==_)||l(_,g))||p.push(_);return p}var o=i("f567"),r=i("31f8"),a=i("c326"),s=i("ae99"),l=i("084e"),h=i("4bb3"),c=Object.prototype,u=c.hasOwnProperty;t.exports=n},e075:function(t,e,i){"use strict";var n=i("386d"),o=i.n(n);o.a},e1e5:function(t,e,i){function n(t){return r(t)&&o(t)==a}var o=i("92c7"),r=i("00c2"),a="[object Arguments]";t.exports=n},e688:function(t,e,i){var n=i("d0cb"),o=i("f1e1"),r=i("cbdb"),a=i("f8e3"),s=i("a5c5"),l=i("92c7"),h=i("2206"),c=h(n),u=h(o),d=h(r),f=h(a),p=h(s),g=l;(n&&"[object DataView]"!=g(new n(new ArrayBuffer(1)))||o&&"[object Map]"!=g(new o)||r&&"[object Promise]"!=g(r.resolve())||a&&"[object Set]"!=g(new a)||s&&"[object WeakMap]"!=g(new s))&&(g=function(t){var e=l(t),i="[object Object]"==e?t.constructor:void 0,n=i?h(i):"";if(n)switch(n){case c:return"[object DataView]";case u:return"[object Map]";case d:return"[object Promise]";case f:return"[object Set]";case p:return"[object WeakMap]"}return e}),t.exports=g},e729:function(t,e,i){function n(t){return"function"!=typeof t.constructor||a(t)?{}:o(r(t))}var o=i("79b9"),r=i("f989"),a=i("a20e");t.exports=n},e80d:function(t,e,i){function n(t,e){var i=r(t,e);return o(i)?i:void 0}var o=i("6cb3"),r=i("280b");t.exports=n},e87a:function(t,e,i){var n=i("a485"),o=n(Object.keys,Object);t.exports=o},eb19:function(t,e,i){function n(t){if(!o(t))return a(t);var e=r(t),i=[];for(var n in t)("constructor"!=n||!e&&l.call(t,n))&&i.push(n);return i}var o=i("d5d3"),r=i("a20e"),a=i("cd10"),s=Object.prototype,l=s.hasOwnProperty;t.exports=n},eba4:function(t,e,i){"use strict";var n=i("212a"),o=i.n(n);o.a},ef66:function(t,e,i){function n(t,e){var i=e?o(t.buffer):t.buffer;return new t.constructor(i,t.byteOffset,t.length)}var o=i("9f1c");t.exports=n},f1e1:function(t,e,i){var n=i("e80d"),o=i("2c74"),r=n(o,"Map");t.exports=r},f1f9:function(t,e,i){},f34d:function(t,e,i){function n(t,e,i,n){var a=!i;i||(i={});for(var s=-1,l=e.length;++s<l;){var h=e[s],c=n?n(i[h],t[h],h,i,t):void 0;void 0===c&&(c=t[h]),a?r(i,h,c):o(i,h,c)}return i}var o=i("cde6"),r=i("b913");t.exports=n},f3ef:function(t,e,i){function n(t,e){var i=e?o(t.buffer):t.buffer;return new t.constructor(i,t.byteOffset,t.byteLength)}var o=i("9f1c");t.exports=n},f567:function(t,e){function i(t,e){for(var i=-1,n=Array(t);++i<t;)n[i]=e(i);return n}t.exports=i},f6a0:function(t,e,i){function n(t){var e=this.__data__;if(o){var i=e[t];return i===r?void 0:i}return s.call(e,t)?e[t]:void 0}var o=i("2817"),r="__lodash_hash_undefined__",a=Object.prototype,s=a.hasOwnProperty;t.exports=n},f6fd:function(t,e){!function(t){var e=t.getElementsByTagName("script");"currentScript"in t||Object.defineProperty(t,"currentScript",{get:function(){try{throw new Error}catch(n){var t,i=(/.*at [^\(]*\((.*):.+:.+\)$/gi.exec(n.stack)||[!1])[1];for(t in e)if(e[t].src==i||"interactive"==e[t].readyState)return e[t];return null}}})}(document)},f79e:function(t,e,i){"use strict";var n=i("fa55"),o=i.n(n);o.a},f8db:function(t,e){function i(t){return o.call(t)}var n=Object.prototype,o=n.toString;t.exports=i},f8e3:function(t,e,i){var n=i("e80d"),o=i("2c74"),r=n(o,"Set");t.exports=r},f989:function(t,e,i){var n=i("a485"),o=n(Object.getPrototypeOf,Object);t.exports=o},fa30:function(t,e,i){function n(t,e){return t&&o(e,r(e),t)}var o=i("f34d"),r=i("3c3d");t.exports=n},fa55:function(t,e,i){},fb15:function(t,e,i){"use strict";function n(t){return a(t)||r(t)||o()}function o(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function r(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function a(t){if(Array.isArray(t)){for(var e=0,i=new Array(t.length);e<t.length;e++)i[e]=t[e];return i}}function s(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,n)}return i}function l(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?s(Object(i),!0).forEach(function(e){h(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):s(Object(i)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}function h(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function c(t,e){var i=(t.getFromLinks()||{})._as||[],n=i.some(function(t){return t.getStyle("link.from.position")===e}),o=t.getClient("focus")||t.getClient("hover");return n&&!o}function u(t){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]).map(function(e){var i="circle"===t?tn.circle.r:"right"===e?tn.rect.rect.w/2:tn.rect.rect.h/2;return l({},on,{},rn[e](i))})}function d(t){Sn=t}function f(){return Sn}function p(t){var e=t.msg,i=t.params,n=void 0===i?{type:"warning"}:i,o=t.titile,r=void 0===o?"提示":o;return kn.MessageBox.confirm(e,r,n)}function g(){kn.Message.apply(void 0,arguments)}function _(t){var e=t.split("?")[1];return e?JSON.parse('{"'.concat(decodeURIComponent(e).replace(/"/g,'\\"').replace(/&/g,'","').replace(/=/g,'":"'),'"}')):{}}function m(t){t=t||"";var e=t.match(/[^\x00-\xff]/gi);return t.length+(null===e?0:e.length)}function v(t){function e(i,n,o){if(i===n)return void(r&&r());var a=i+o>n?n:i+o;i>n&&(a=i-o<n?n:i-o),t===window?window.scrollTo(a,a):t.scrollTop=a,window.requestAnimationFrame(function(){return e(a,n,o)})}var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:500,r=arguments.length>4?arguments[4]:void 0;window.requestAnimationFrame||(window.requestAnimationFrame=window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(t){return window.setTimeout(t,1e3/60)});var a=Math.abs(i-n);e(i,n,Math.ceil(a/o*50))}function y(t){wn=t}function w(){return wn}function b(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,n)}return i}function x(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?b(Object(i),!0).forEach(function(e){A(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):b(Object(i)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}function A(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function C(t){var e=new Error(t);throw Object(kn.Message)({message:e.message,type:"error",duration:5e3}),e}function T(){return On({url:"/flow/tacheModel/getTchMod",method:"get"})}function k(){return On({url:"/flow/tacheModel/getGroupId",method:"get"})}function S(t){return On({url:"/flow/flowFormModel/getFlowFormModel",method:"get",params:{flowMod:t}})}function E(t){return On({url:"/flow/flowModel/getChildFlowModels",method:"get",params:{flowMod:t}})}function I(t){return On({url:"/flow/getFlowProcByModel",method:"get",params:t})}function L(t){return On({url:"/busiCompoent/FuiCompoentController/findOrgs",method:"get",params:t})}function R(t){return On({url:"/busiCompoent/FuiCompoentController/findAllDutyLines",method:"get",params:t})}function P(t){return On({url:"/busiCompoent/FuiCompoentController/findProjects",method:"get",params:t})}function O(t){return On({url:"/busiCompoent/FuiStaffSelectAddonController/findStaffByIds",method:"get",params:t})}function D(t){return On({url:"/busiCompoent/FuiCompoentController/loadRoles",method:"post",data:{roleIds:t}})}function M(){return On({url:"/flow/flowFormModel/getSysFuncMenuItems",method:"get"})}function N(){return On({url:"/flow/flowModel/getFlowMod",method:"get"})}function B(t,e,i,n,o,r,a,s){var l="function"==typeof t?t.options:t;e&&(l.render=e,l.staticRenderFns=i,l._compiled=!0),n&&(l.functional=!0),r&&(l._scopeId="data-v-"+r);var h;if(a?(h=function(t){t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,t||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),o&&o.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(a)},l._ssrRegister=h):o&&(h=s?function(){o.call(this,this.$root.$options.shadowRoot)}:o),h)if(l.functional){l._injectStyles=h;var c=l.render;l.render=function(t,e){return h.call(e),c(t,e)}}else{var u=l.beforeCreate;l.beforeCreate=u?[].concat(u,h):[h]}return{exports:t,options:l}}function F(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window;if(t){var n=Object.keys(t);if(n.length){var o=t[n[0]][0].field,r=e.find(function(t){return t.prop===o}).$el;i===window?v(i,window.pageYOffset,r.getBoundingClientRect().top+window.pageYOffset-100):v(i,i.scrollTop,r.getBoundingClientRect().top+i.scrollTop-i.getBoundingClientRect().top)}}}function z(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,n)}return i}function V(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?z(Object(i),!0).forEach(function(e){U(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):z(Object(i)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}function U(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function j(t,e,i,n,o,r,a){try{var s=t[r](a),l=s.value}catch(t){return void i(t)}s.done?e(l):Promise.resolve(l).then(n,o)}function H(t){return function(){var e=this,i=arguments;return new Promise(function(n,o){function r(t){j(s,n,o,r,a,"next",t)}function a(t){j(s,n,o,r,a,"throw",t)}var s=t.apply(e,i);r(void 0)})}}function W(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,n)}return i}function G(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?W(Object(i),!0).forEach(function(e){Z(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):W(Object(i)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}function Z(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function X(t,e,i,n,o,r,a){try{var s=t[r](a),l=s.value}catch(t){return void i(t)}s.done?e(l):Promise.resolve(l).then(n,o)}function Y(t){return function(){var e=this,i=arguments;return new Promise(function(n,o){function r(t){X(s,n,o,r,a,"next",t)}function a(t){X(s,n,o,r,a,"throw",t)}var s=t.apply(e,i);r(void 0)})}}function $(t,e,i,n,o,r,a){try{var s=t[r](a),l=s.value}catch(t){return void i(t)}s.done?e(l):Promise.resolve(l).then(n,o)}function q(t){return function(){var e=this,i=arguments;return new Promise(function(n,o){function r(t){$(s,n,o,r,a,"next",t)}function a(t){$(s,n,o,r,a,"throw",t)}var s=t.apply(e,i);r(void 0)})}}function K(t,e,i,n,o,r,a){try{var s=t[r](a),l=s.value}catch(t){return void i(t)}s.done?e(l):Promise.resolve(l).then(n,o)}function J(t){return function(){var e=this,i=arguments;return new Promise(function(n,o){function r(t){K(s,n,o,r,a,"next",t)}function a(t){K(s,n,o,r,a,"throw",t)}var s=t.apply(e,i);r(void 0)})}}function Q(t){return it(t)||et(t)||tt()}function tt(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function et(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function it(t){if(Array.isArray(t)){for(var e=0,i=new Array(t.length);e<t.length;e++)i[e]=t[e];return i}}function nt(t){return t?"string"==typeof t?document.querySelector(t):t:null}function ot(t,e){return e.x===t.x&&e.y<t.y?na.handleUp():e.x>t.x&&e.y<t.y?na.handleRUp():e.x>t.x&&e.y===t.y?na.handleRight():e.x>t.x&&e.y>t.y?na.handleRDown():e.x===t.x&&e.y>t.y?na.handleDown():e.x<t.x&&e.y>t.y?na.handleLDown():e.x<t.x&&e.y===t.y?na.handleLeft():e.x<t.x&&e.y<t.y?na.handleLUp():na.handleLoop()}function rt(t,e,i){var n=t.getCenterLocation(),o=e.getCenterLocation();return na._setAttrs(t,e,i),ot(n,o)}function at(t,e,i,n){var o=rt(e,i,n),r=o.position,a=o.style,s=o.point;Object.keys(a).forEach(function(e){t.setStyle(e,a[e])}),t.setPosition(r),t.setPoints(null),s.forEach(function(e){t.addPoint(e)})}function st(t,e){var i=t.getFromLinks();i&&i.forEach(function(i){var n=i._toNode;at(i,t,n,e)});var n=t.getToLinks();n&&n.forEach(function(i){at(i,i._fromNode,t,e)})}function lt(t){var e=t.col,i=t.row,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=en.startCenterLocation,r=o.x,a=o.y,s=o.procy;return{x:e*en.repulsion.column+r,y:i*en.repulsion.row+(n?s:a)}}function ht(t){var e=t.x,i=t.y,n=en.startCenterLocation,o=n.x,r=n.y;return{col:~~((e-o)/en.repulsion.column),row:~~((i-r)/en.repulsion.row)}}function ct(t,e){var i=t.getCenterLocation(),n=e.x>i.x,o=e.y>i.y,r=n?tn.rect.w/2:en.repulsion.column-tn.rect.w/2,a=o?tn.rect.h/2:en.repulsion.row-tn.rect.h/2;return i.x+=r,i.y+=a,i}function ut(t,e,i){t.setCenterLocation(e),st(t,i)}function dt(t,e,i){ut(t,lt(e),i)}function ft(t){return{x:en.startCenterLocation.x-en.repulsion.column/2+en.repulsion.column*t,y:0}}function pt(t,e){var i=e||"",n=t||{},o=n.nameLength;if(!o||!Array.isArray(o)||o.length<2)return i;i=i.length>o[1]?"".concat(i.substr(0,o[1]-2),".."):i;var r=new RegExp("(.{".concat(o[0],"})."),"g");return"".concat(i).replace(r,function(t,e){return t.replace(e,"".concat(e,"\n"))})}function gt(t){var e=en.startCenterLocation;return~~((+t.width-2*e.x)/en.repulsion.column)-1+2}function _t(t,e){var i=e.col,n=e.row;return t[i][n]}function mt(t,e,i){var n=e.col,o=e.row;t[n][o]=i}function vt(t,e,i){var n=_t(t,e);mt(t,e,_t(t,i)),mt(t,i,n)}function yt(t){return t&&t.length?lt(t.reduce(function(t,e,i){if(t.col=i,e.length<t.row+2)return t;for(var n=t.row+1;n<e.length;n++)e[n]&&(t.row=n);return t},{col:0,row:0})).y+tn.rect.h:0}function wt(t){if(!t.length)return 0;var e=t.sort(function(t,e){return+t.getClient("start")-+e.getClient("start")});if(0!==t[0].getClient("start"))return 0;var i=e.find(function(t,i){var n=e[i+1]?e[i+1].getClient("start"):-1;return t.getClient("end")!==n});return i?+i.getClient("end"):-1}function bt(t){return{x:en.startCenterLocation.x-en.repulsion.column/2+en.repulsion.column*t,y:0}}function xt(t){var e=w(),i=t.elementConfig,n=t.formTables;if(!i||!i.length)return[];var o=n&&n.length?n.map(function(t){return{label:t.tableName,value:t.tableName,children:[]}}):[{label:i[0].tableName,value:i[0].tableName,children:[]}];return o.forEach(function(t){var n=i.filter(function(e){return e.tableName===t.value&&oa.includes(e.xtype)&&!ra.includes(e.id)});t.children=n.map(function(t){var i=t.formElementAttrs,n=i.ELEMENT_NAME_CN.value,o=i.ELEMENT_NAME.value,r=i.ELEMENT_NAME_US.value;return{label:"en"===f()?r:n,value:t.fieldName||o,children:[{label:e("utils.currentValue"),value:"VALUE"},{label:e("utils.defaultValue"),value:"DEFAULT_VALUE"}]}})}),[{label:e("utils.tableVar"),value:"$TABLE",children:o}]}function At(t){var e=t.elementConfig,i=t.formTables,n=["ORG_NAME","REGION_NAME"],o={ORG_NAME:"申请人部门",REGION_NAME:"申请人区域"},r={ORG_NAME:"25",REGION_NAME:"region",CUR_DATE:"8",STAFF_NAME:"24"};if(!e||!e.length)return[];var a=i&&i.length?i.map(function(t){return{label:t.tableName,children:[]}}):[{label:e[0].tableName,value:e[0].tableName,children:[]}];return a.forEach(function(t){var i=e.filter(function(e){return e.tableName===t.label&&oa.includes(e.xtype)&&!ra.includes(e.id)});t.children=i.map(function(e){var a=e.formElementAttrs,s=a.DEFAULT_VALUE.value,l=a.DEFAULT_VALUE_TYPE.value,h=e.xtype,c=e.id,u=void 0!==e.formatType?e.formatType.value:"",d="",p="9"===h&&e.formElementAttrs.DATA_CONFIG_DEFINE&&"F"===e.formElementAttrs.DATA_CONFIG_DEFINE.value?e.formElementAttrs.INIT_SQL.value:"",g=e.formElementAttrs.ELEMENT_NAME.value,_=n.includes(c)?o[c]:e.formElementAttrs.ELEMENT_NAME_CN.value,m=e.formElementAttrs.ELEMENT_NAME_US.value;if("3"===h&&!e.childrenUid){var v=i.find(function(t){return t.childrenUid===e.id});v&&v.cascadeOptionsCfg.options.forEach(function(t){if(t.children){var i=t.children.map(function(t){return{label:"en"===f()?t.labelUs:t.label,value:t.value}});e.options=[].concat(Q(e.options),Q(i))}})}var y=e.options?e.options.map(function(t){return t?{MEAN:t.label,CODE:t.value}:{}}):[];return"9"===h&&e.formElementAttrs.DATA_CONFIG_DEFINE&&"T"===e.formElementAttrs.DATA_CONFIG_DEFINE.value?d=e.formElementAttrs.ELEMENT_NAME.value:"9"===h&&e.formElementAttrs.DATA_CONFIG_OFTER&&e.formElementAttrs.DATA_CONFIG_OFTER.value&&(d=e.formElementAttrs.DATA_CONFIG_OFTER.value),{defauleType:l,defauleValue:s,formatType:"CUR_DATE"===c?"DATETIME":u,tree:{domainType:d,domainSql:p},options:y,elementType:void 0!==r[c]?r[c]:h,label:"en"===f()?m:_,value:"".concat(t.label,".").concat(g)}})}),1===a.length&&(a[0].label=""),a}function Ct(t,e,i){return!!_t(i,ht({x:t,y:e}))}function Tt(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=t.getFromLinks(),o=n._as.some(function(t){var i=t.getToNode().getClient("data");return"0BT"===i.canReturn&&-1!==(i.canReturnTaches||"").indexOf(e)});return!!o||(n.forEach(function(t){if(!o){var n=t.getToNode(),r=t.getToNode().getClient("data");n.getFromLinks()&&"".concat(r.tchMod)!==e&&!i.includes("".concat(r.tchMod))&&(i.push("".concat(r.tchMod)),Tt(n,e,i))}}),!1)}function kt(t,e){return It(t)||Et(t,e)||St()}function St(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function Et(t,e){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)){var i=[],n=!0,o=!1,r=void 0;try{for(var a,s=t[Symbol.iterator]();!(n=(a=s.next()).done)&&(i.push(a.value),!e||i.length!==e);n=!0);}catch(t){o=!0,r=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw r}}return i}}function It(t){if(Array.isArray(t))return t}function Lt(t,e,i,n,o,r,a){try{var s=t[r](a),l=s.value}catch(t){return void i(t)}s.done?e(l):Promise.resolve(l).then(n,o)}function Rt(t){return function(){var e=this,i=arguments;return new Promise(function(n,o){function r(t){Lt(s,n,o,r,a,"next",t)}function a(t){Lt(s,n,o,r,a,"throw",t)}var s=t.apply(e,i);r(void 0)})}}function Pt(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,n)}return i}function Ot(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?Pt(Object(i),!0).forEach(function(e){Dt(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):Pt(Object(i)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}function Dt(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function Mt(t){return Object.keys(t).reduce(function(e,i){return e[t[i]]=i,e},{})}function Nt(t){return(Nt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Bt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ft(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function zt(t,e,i){return e&&Ft(t.prototype,e),i&&Ft(t,i),t}function Vt(t,e){return!e||"object"!==Nt(e)&&"function"!=typeof e?jt(t):e}function Ut(t){return(Ut=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function jt(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ht(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Wt(t,e)}function Wt(t,e){return(Wt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Gt(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function Zt(t){return(Zt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Xt(t,e){if(null==t)return{};var i,n,o=Yt(t,e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);for(n=0;n<r.length;n++)i=r[n],e.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(t,i)&&(o[i]=t[i])}return o}function Yt(t,e){if(null==t)return{};var i,n,o={},r=Object.keys(t);for(n=0;n<r.length;n++)i=r[n],e.indexOf(i)>=0||(o[i]=t[i]);return o}function $t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function qt(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Kt(t,e,i){return e&&qt(t.prototype,e),i&&qt(t,i),t}function Jt(t,e){return!e||"object"!==Zt(e)&&"function"!=typeof e?Qt(t):e}function Qt(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function te(t){return(te=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ee(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ie(t,e)}function ie(t,e){return(ie=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function ne(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,n)}return i}function oe(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?ne(Object(i),!0).forEach(function(e){re(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):ne(Object(i)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}function re(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function ae(t){return(ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function se(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function le(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function he(t,e,i){return e&&le(t.prototype,e),i&&le(t,i),t}function ce(t,e){return!e||"object"!==ae(e)&&"function"!=typeof e?ue(t):e}function ue(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function de(t){return(de=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function fe(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&pe(t,e)}function pe(t,e){return(pe=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function ge(t){return(ge="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _e(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,n)}return i}function me(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?_e(Object(i),!0).forEach(function(e){ve(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):_e(Object(i)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}function ve(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function ye(t,e){if(null==t)return{};var i,n,o=we(t,e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);for(n=0;n<r.length;n++)i=r[n],e.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(t,i)&&(o[i]=t[i])}return o}function we(t,e){if(null==t)return{};var i,n,o={},r=Object.keys(t);for(n=0;n<r.length;n++)i=r[n],e.indexOf(i)>=0||(o[i]=t[i]);return o}function be(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function xe(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Ae(t,e,i){return e&&xe(t.prototype,e),i&&xe(t,i),t}function Ce(t,e){return!e||"object"!==ge(e)&&"function"!=typeof e?Te(t):e}function Te(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ke(t){return(ke=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Se(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ee(t,e)}function Ee(t,e){return(Ee=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Ie(t){return(Ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Le(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Re(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Pe(t,e,i){return e&&Re(t.prototype,e),i&&Re(t,i),t}function Oe(t,e){return!e||"object"!==Ie(e)&&"function"!=typeof e?Me(t):e}function De(t){return(De=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Me(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ne(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Be(t,e)}function Be(t,e){return(Be=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Fe(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function ze(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ve(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Ue(t,e,i){return e&&Ve(t.prototype,e),i&&Ve(t,i),t}function je(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function He(t,e){return Math.atan2(e.y-t.y,e.x-t.x)}function We(t,e){var i=[],n=t.getFromLinks();return n&&(i=n._as.map(function(t){return"".concat(t.getClient("data").nextTchMod)}),n.forEach(function(t){var n=t.getClient("data"),o=n.nextTchMod;i.forEach(function(t){if(t==="".concat(o)){var i=(n.excludePath||"").split(";");i.includes("".concat(e))||i.push("".concat(e)),n.excludePath=i.join(";")}}),t.setClient("data",n)})),i}function Ge(t,e,i,n,o,r,a){try{var s=t[r](a),l=s.value}catch(t){return void i(t)}s.done?e(l):Promise.resolve(l).then(n,o)}function Ze(t){return function(){var e=this,i=arguments;return new Promise(function(n,o){function r(t){Ge(s,n,o,r,a,"next",t)}function a(t){Ge(s,n,o,r,a,"throw",t)}var s=t.apply(e,i);r(void 0)})}}function Xe(t,e,i,n,o,r,a){try{var s=t[r](a),l=s.value}catch(t){return void i(t)}s.done?e(l):Promise.resolve(l).then(n,o)}function Ye(t){return function(){var e=this,i=arguments;return new Promise(function(n,o){function r(t){Xe(s,n,o,r,a,"next",t)}function a(t){Xe(s,n,o,r,a,"throw",t)}var s=t.apply(e,i);r(void 0)})}}function $e(t){return($e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function qe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ke(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Je(t,e,i){return e&&Ke(t.prototype,e),i&&Ke(t,i),t}function Qe(t,e){return!e||"object"!==$e(e)&&"function"!=typeof e?ti(t):e}function ti(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ei(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ai(t,e)}function ii(t){var e="function"==typeof Map?new Map:void 0;return(ii=function(t){function i(){return oi(t,arguments,si(this).constructor)}if(null===t||!ri(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,i)}return i.prototype=Object.create(t.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),ai(i,t)})(t)}function ni(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function oi(t,e,i){return oi=ni()?Reflect.construct:function(t,e,i){var n=[null];n.push.apply(n,e);var o=Function.bind.apply(t,n),r=new o;return i&&ai(r,i.prototype),r},oi.apply(null,arguments)}function ri(t){return-1!==Function.toString.call(t).indexOf("[native code]")}function ai(t,e){return(ai=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function si(t){return(si=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function li(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,n)}return i}function hi(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?li(Object(i),!0).forEach(function(e){gi(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):li(Object(i)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}function ci(t,e){if(null==t)return{};var i,n,o=ui(t,e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);for(n=0;n<r.length;n++)i=r[n],e.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(t,i)&&(o[i]=t[i])}return o}function ui(t,e){if(null==t)return{};var i,n,o={},r=Object.keys(t);for(n=0;n<r.length;n++)i=r[n],e.indexOf(i)>=0||(o[i]=t[i]);return o}function di(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function fi(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function pi(t,e,i){return e&&fi(t.prototype,e),i&&fi(t,i),t}function gi(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function _i(t){return yi(t)||vi(t)||mi()}function mi(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function vi(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function yi(t){if(Array.isArray(t)){for(var e=0,i=new Array(t.length);e<t.length;e++)i[e]=t[e];return i}}function wi(t,e){var i={from:"getFromNode",to:"getToNode"}[t];if(!i)return null;var n=e[i]();if(!n)return null;var o=(e.getStyle("link.".concat(t,".position"))||"").replace(".",""),r=e.getStyle("link.".concat(t,".xoffset")),a=e.getStyle("link.".concat(t,".yoffset")),s=n.getCenterLocation(),l="midstItem"!==n.getClient("type"),h=l?tn.circle.r:tn.rect.rect.w/2,c=l?tn.circle.r:tn.rect.rect.h/2,u=Za[o];return u?u(h,c,r,a,s):null}function bi(t,e){if(null==t)return{};var i,n,o=xi(t,e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);for(n=0;n<r.length;n++)i=r[n],e.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(t,i)&&(o[i]=t[i])}return o}function xi(t,e){if(null==t)return{};var i,n,o={},r=Object.keys(t);for(n=0;n<r.length;n++)i=r[n],e.indexOf(i)>=0||(o[i]=t[i]);return o}function Ai(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ci(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Ti(t,e,i){return e&&Ci(t.prototype,e),i&&Ci(t,i),t}function ki(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function Si(t){return(Si="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ei(t,e){if(null==t)return{};var i,n,o=Ii(t,e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);for(n=0;n<r.length;n++)i=r[n],e.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(t,i)&&(o[i]=t[i])}return o}function Ii(t,e){if(null==t)return{};var i,n,o={},r=Object.keys(t);for(n=0;n<r.length;n++)i=r[n],e.indexOf(i)>=0||(o[i]=t[i]);return o}function Li(t){return Oi(t)||Pi(t)||Ri()}function Ri(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function Pi(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function Oi(t){if(Array.isArray(t)){for(var e=0,i=new Array(t.length);e<t.length;e++)i[e]=t[e];return i}}function Di(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,n)}return i}function Mi(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?Di(Object(i),!0).forEach(function(e){Ni(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):Di(Object(i)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}function Ni(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function Bi(t,e,i,n,o,r,a){try{var s=t[r](a),l=s.value}catch(t){return void i(t)}s.done?e(l):Promise.resolve(l).then(n,o)}function Fi(t){return function(){var e=this,i=arguments;return new Promise(function(n,o){function r(t){Bi(s,n,o,r,a,"next",t)}function a(t){Bi(s,n,o,r,a,"throw",t)}var s=t.apply(e,i);r(void 0)})}}function zi(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Vi(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Ui(t,e,i){return e&&Vi(t.prototype,e),i&&Vi(t,i),t}function ji(t,e){return!e||"object"!==Si(e)&&"function"!=typeof e?Wi(t):e}function Hi(t){return(Hi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Wi(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Gi(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Zi(t,e)}function Zi(t,e){return(Zi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Xi(t){return qi(t)||$i(t)||Yi()}function Yi(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function $i(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function qi(t){if(Array.isArray(t)){for(var e=0,i=new Array(t.length);e<t.length;e++)i[e]=t[e];return i}}if(i.r(e),"undefined"!=typeof window){i("f6fd");var Ki;(Ki=window.document.currentScript)&&(Ki=Ki.src.match(/(.+\/)[^\/]+\.js(\?.*)?$/))&&(i.p=Ki[1])}var Ji=(i("d1cd"),{active:"#409EFF",normal:"#707070",line:"#888888",background:"#FFF",poly:"#F99E49",success:"#67C23A"}),Qi={normal:"12px Microsoft YaHei",btn:"16px Microsoft YaHei",poly:"14px Microsoft YaHei"},tn={circle:{w:52,h:52,r:25},rect:{w:100,h:52,rect:{x:-45,y:-17,w:90,h:34}},point:{r:2},btnBackground:{w:160,h:200,r:66,mr:58},clickBtn:{w:68,h:68,r:33},poly:{w:16,h:16,r:7}},en={repulsion:{column:200,row:86},startCenterLocation:{x:102,y:92,procy:78}},nn={remove:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAApklEQVQ4T+WT0Q3CMAxErxMAE8AGwAaswgY3AiO8UToCI3QEOgFsUORIrdpAhErFF/mJFZ9PPudcaeGp3tXbbiTts1wDHHN8iaCTtAEeUWB7LekOvODTg+0ArmaqaYHdwGj7EgRAuksnx/2OIGQBoT1JHMWTTosd2O76oWXxPxEsG+K3Pgj/n3sLF/bkKqkGiPz4Gw+RkLT9YOlW0gm4TQhm7sEAfwLnwpsRm1PyHAAAAABJRU5ErkJggg==",edit:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAqUlEQVQ4T+2TYQ3CMBSEbw5wAhKGApCAhE8CEk7CULBJGA6QggRyDMiyjNH9p0nTpH335fVdrgI2klpJtZbXxfZpWlIBSDpm277/gHyegUZSF8A5t7afZ8l6iXfpejVgLE7HqwBTcbotBsyJiwHfxEWAOTHQxQHbzeIXgPgem+uxxUAvqY9zxTMY2/sHSNMZZMoH2/uSHKQGuA3xGWxMnGPLthQg6fpO7wMIKo8RQqYQaQAAAABJRU5ErkJggg==",add:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAWElEQVQ4T+2TwRXAIAxCcTLtRozCSDqZffF5jbbmas6EAx8SgpdW/yQrgC7p8XQ7g26PklzdNQBGBjPt/JNoNToRgyapXAqTgpc+yXCVbUy2hXI0pi+9eAE59zsRJ+6T5QAAAABJRU5ErkJggg==",del:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAPklEQVQ4T2NkoBAwUqifYdQABiqFQUFBwQEGBgZ7EmPkwIQJExzBsUCmAQcnTJjgMBqN1IpGEqMPRTnFsQAAT2AKEdDNgQEAAAAASUVORK5CYII="},on={shape:"circle",r:tn.point.r,lineColor:Ji.line,fill:Ji.line},rn={right:function(t){return{cx:t,visible:function(t){return c(t,"right.right")}}},top:function(t){return{cy:-t,visible:function(t){return c(t,"top.top")}}},bottom:function(t){return{cy:t,visible:function(t){return c(t,"bottom.bottom")}}}},an={w:tn.btnBackground.w,h:tn.btnBackground.h,v:[{shape:"circle",r:tn.btnBackground.r,line:{width:20,color:Ji.normal},alpha:.55},{shape:"circle",r:tn.btnBackground.mr,fill:Ji.line,alpha:.1}]},sn={font:Qi.btn,w:tn.clickBtn.w,h:tn.clickBtn.h,fill:function(t){return Ji[t.getClient("focus")||t.getClient("hover")?"active":"background"]},v:[{shape:"circle",r:tn.clickBtn.r,shadow:{blur:10,shadowOffsetX:10,color:Ji.line}}]},ln={font:Qi.normal,fill:function(t){return t.getClient("nowFlow")?t.getClient("success")?Ji.background:Ji.active:Ji.background},line:function(t){var e=t.getClient("flowed"),i=t.getClient("success")?Ji.success:e?Ji.active:"";return{width:e&&t.getClient("focus")?2:1,color:i||Ji[t.getClient("focus")||t.getClient("hover")?"active":"normal"]}}},hn=l({},ln,{w:tn.circle.w,h:tn.circle.h,v:[{shape:"circle",r:25}]}),cn=l({},hn,{v:[{shape:"circle",r:25}].concat(n(u("circle",["right","bottom"])))}),un={shape:"circle",fill:Ji.poly,line:{width:0},cx:-tn.rect.rect.w/2,cy:-tn.rect.rect.h/2,r:tn.poly.r},dn={shape:"text",text:"M",textAlign:"center",x:-tn.rect.rect.w/2,y:-tn.rect.rect.h/2,w:2*tn.poly.r},fn=l({},ln,{line:function(t){var e=t.getClient("flowed"),i=t.getClient("data"),n=t.getClient("success")?Ji.success:e?Ji.active:"",o={width:e&&t.getClient("focus")?2:1,color:n||Ji[t.getClient("focus")||t.getClient("hover")?"active":"normal"]};return i&&4==+i.tchType&&(o.color=Ji.poly),o},w:tn.rect.w,h:tn.rect.h,outlineWidth:0,v:function(t){var e=[{shape:"rect",rect:tn.rect.rect}].concat(n(u("rect",["top","right","bottom"])));return(t.getClient("data").flowMode||[]).find(function(t){return["multiInst","serial"].includes(t)})&&(e.push(un),e.push(dn)),e}}),pn={w:en.repulsion.column,h:en.repulsion.row,line:{width:4,color:Ji.active},v:[{shape:"rect",rect:{x:-en.repulsion.column/2,y:-en.repulsion.row/2,w:en.repulsion.column,h:en.repulsion.row}}]},gn={font:Qi.normal,fill:Ji.background,line:function(t){return{width:1,color:Ji[t.getClient("focus")?"active":"line"]}},w:function(t){var e=t.getClient("col")||1;return en.repulsion.column*e},h:function(t){return+t.getClient("height")||234},origin:{x:0,y:0},v:[{shape:"rect",rect:function(t){var e=t.getClient("col")||1;return{w:en.repulsion.column*e,h:34,y:1}}},{shape:"line",p1:function(t){var e=t.getClient("col")||1;return{x:en.repulsion.column*e,y:34}},p2:function(t){var e=t.getClient("col")||1;return{x:en.repulsion.column*e,y:+t.getClient("height")||234}},line:{width:1},alpha:.3},{shape:"line",p1:{x:0,y:34},p2:function(t){return{x:0,y:+t.getClient("height")||234}},line:{width:1},alpha:.3}]},_n={w:4,h:200,line:{width:1,color:Ji.active,alpha:.3},v:[{shape:"line",x1:0,y1:-17,x2:0,y2:160}]},mn=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:12,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:12,o=new Image;o.src=e,twaver.Util.registerImage(t,o,i,n)},vn={w:0,h:0,origin:{x:0,y:0},v:[{x:0,y:0}]};twaver.Util.registerImage("fmd_end_item",hn),twaver.Util.registerImage("fmd_start_item",cn),twaver.Util.registerImage("fmd_midst_item",fn),twaver.Util.registerImage("fmd_btn_bg_item",an),twaver.Util.registerImage("fmd_btn_item",sn),twaver.Util.registerImage("fmd_placeholder",pn),twaver.Util.registerImage("fmd_lane",gn),twaver.Util.registerImage("fmd_placeholder_lane",_n);var yn=function(t){return{w:24,h:24,v:[{shape:"vector",name:"fmd_icon_bg"},{shape:"vector",name:t,x:-6,y:-6}]}};mn("fmd_icon_remove",nn.remove),mn("fmd_icon_edit",nn.edit),mn("fmd_icon_add",nn.add),mn("fmd_icon_del",nn.del),twaver.Util.registerImage("fmd_icon_bg",{w:24,h:24,v:[{shape:"rect",rect:{x:-12,y:-12,w:24,h:24},fill:function(t){return t.getClient("hover")?"#B0D6F8":"#fff"}}]}),twaver.Util.registerImage("fmd_btn_remove",yn("fmd_icon_remove")),twaver.Util.registerImage("fmd_btn_edit",yn("fmd_icon_edit")),twaver.Util.registerImage("fmd_btn_add",yn("fmd_icon_add")),twaver.Util.registerImage("fmd_btn_del",yn("fmd_icon_del")),twaver.Util.registerImage("fmd_info_menu",vn),twaver.Util.registerImage("fmd_point",{w:10,h:10,fill:Ji.active,v:[{shape:"circle",r:5}]});var wn,bn=i("9cad"),xn=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"fmd-flow-model"},[i("div",{staticClass:"fmd-flow-model__toolbar"},[i("fmd-toolbar",{attrs:{editable:t.editable&&t.flowCenter}})],1),i("div",{staticClass:"fmd-flow-model__content",class:{"is-flowpro":t.proc}}),i("div",{staticClass:"fmd-flow-model__footer"},[i("div",{staticClass:"fmd-flow-model__footer__legend"},[i("fmd-legend",{attrs:{editable:t.editable&&t.flowCenter}})],1),i("div",{staticClass:"fmd-flow-model__footer__btn-group"},[t.flowCenter&&t.editable?[i("fi-button",{attrs:{size:"small",plain:""},on:{click:function(e){return t.buttonClick("do-prev",!1)}}},[t._v(t._s(t.preText))]),i("fi-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){return t.buttonClick("do-next")}}},[t._v(t._s(t.nextText))])]:t._e(),!t.flowCenter&&t.proc&&t.proc.taches&&t.proc.taches.length?[i("fi-button",{attrs:{size:"large",type:"primary",plain:"",icon:t.isPlay?"el-icon-video-pause":"el-icon-video-play"},on:{click:t.play}},[t.isPlay?i("span",[t._v(t._s(t.t("flowModel.pause")))]):i("span",[t._v(t._s(t.t("flowModel.play")))])])]:t._e()],2)]),i("fmd-info-menu",{directives:[{name:"show",rawName:"v-show",value:t.infoMenuShow,expression:"infoMenuShow"}],staticClass:"xx",style:{top:t.infoMenuLocation.top,left:t.infoMenuLocation.left},attrs:{node:t.infoMenuNode,data:t.infoMenuDate}}),"node"===t.selectedType&&t.editorDialog?i("fmd-editor-node",{attrs:{toolOptions:t.toolOptions,relationFlows:t.relationFlows,disabled:!t.editable||!t.flowCenter,visible:t.editorDialog,tchModel:t.selectedElement,flowModel:t.flowModel},on:{submit:t.onInfoSubmit,"update:visible":function(e){t.editorDialog=e}}}):t._e(),"link"===t.selectedType&&t.editorDialog?i("fmd-editor-link",{attrs:{disabled:!t.editable||!t.flowCenter,visible:t.editorDialog,pathModel:t.selectedElement},on:{"update:visible":function(e){t.editorDialog=e}}}):t._e()],1)},An=[],Cn=i("570c"),Tn=i.n(Cn),kn=i("6194"),Sn="zh-CN",En={nodes:[],setNodes:function(t){this.nodes=t},addNode:function(t){this.nodes.push({tchMod:t.tchMod,tchName:t.tchName,tchNameUs:t.tchNameUs})},delNode:function(t){var e=this.nodes.findIndex(function(e){return"".concat(e.tchMod)==="".concat(t.tchMod)});-1!==e&&this.nodes.splice(e,1)},updateNode:function(t){this.nodes.forEach(function(e){"".concat(e.tchMod)==="".concat(t.tchMod)&&(e.tchName=t.tchName,e.tchNameUs=t.tchNameUs)})},getNodes:function(){return this.nodes}},In=i("cebe"),Ln=i.n(In),Rn={baseURL:"/",headers:{Pragma:"no-cache","Cache-Control":"no-cache"}},Pn=Ln.a.create(Rn);Pn.interceptors.request.use(function(t){return x({},t,{params:x({},t.params||{},{_t:+new Date})})},function(t){return Promise.reject(t)}),Pn.interceptors.response.use(function(t){var e=t.data||{},i=e.code,n=e.msg,o=e.errorMsg;return(i&&"0"!==i||o)&&C(n||o),Promise.resolve(t.data)},function(t){console.error(t);var e;return e=t.response&&t.response.data&&t.response.data.msg?t.response.data.msg:t.message,Object(kn.Message)({showClose:!0,message:e,type:"error",duration:5e3}),Promise.reject(t)});var On=Pn,Dn=i("8bbf"),Mn=i.n(Dn),Nn=new Mn.a,Bn={TOOLBAR_CLICK:"toolbar_click",ELEMENT_EDIT:"element_edit",SHOW_INFO_MENU:"show_info_menu",STOP_PLAY:"stop_play"},Fn=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("fi-button-group",{staticClass:"fmd-toolbar"},[t._l(t.buttonList,function(e){return[e.show?i("fi-button",t._b({key:e.key,staticClass:"fmd-toolbar__btn",attrs:{"event-type":e.key,plain:"",size:"small"},on:{click:function(i){return t.handleItemClick(e)}}},"fi-button",e.attr,!1)):t._e()]})],2)},zn=[],Vn={name:"FmdToolbar",mixins:[bn.localeMixin],props:{editable:{type:Boolean,default:!1}},data:function(){return{isLinkActive:!1,isHideShowLane:!0}},computed:{linkTitle:function(){return this.isLinkActive?this.t("toolbar.disLink"):this.t("toolbar.link")},laneTitle:function(){return this.isHideShowLane?this.t("toolbar.hideLane"):this.t("toolbar.showLane")},buttonList:function(){return[{key:"toolbar_link",attr:{title:this.linkTitle,icon:"fa fa-arrows-v",class:this.isLinkActive?"is-custom-active":""},show:this.editable},{key:"toolbar_plus",attr:{title:this.t("toolbar.magnify"),icon:"fa fa-search-plus"},show:!0},{key:"toolbar_minus",attr:{title:this.t("toolbar.shrink"),icon:"fa fa-search-minus"},show:!0},{key:"toolbar_addLane",attr:{title:this.t("toolbar.addLane"),icon:"fa fa-columns"},show:this.editable},{key:"toolbar_lane",attr:{title:this.laneTitle,icon:"fa fa-columns",class:this.isHideShowLane?"":"is-custom-active"},show:!this.editable}]}},methods:{handleItemClick:function(t){var e=t.key;this.isLinkActive="toolbar_link"===e&&!this.isLinkActive,"toolbar_lane"===e&&(this.isHideShowLane=!this.isHideShowLane),Nn.$emit(Bn.TOOLBAR_CLICK,{key:e,isLinkActive:this.isLinkActive,isHideShowLane:this.isHideShowLane})}}},Un=Vn,jn=(i("60a3"),B(Un,Fn,zn,!1,null,"3675a0d1",null)),Hn=jn.exports,Wn=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("fi-dialog",{attrs:{visible:t.dialogVisible,"close-on-click-modal":t.disabled,"close-on-press-escape":t.disabled,width:"685px",top:"0","custom-class":"fmd-editor-node","before-close":t.handleClose},on:{"update:visible":function(e){t.dialogVisible=e}}},[i("fi-row",{attrs:{slot:"title"},slot:"title"},[i("fi-tabs",{on:{"tab-click":t.handleClick},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},t._l(t.tabs,function(t){return i("fi-tab-pane",{key:t.name,attrs:{name:t.name,label:t.label}})}),1)],1),i("fi-row",{staticClass:"fmd-editor-node__content"},[i("fmd-tache-attr",{directives:[{name:"show",rawName:"v-show",value:"tacheAttr"===t.activeName,expression:"activeName==='tacheAttr'"}],ref:"fmdTchAttr",attrs:{toolOptions:t.toolOptions,preTchs:t.dirCondition.getPreTcheInfoData,disabled:t.disabled,tchModel:t.tchModel,node:t.node},on:{change:t.onAttrChange,canReturn:t.canReturn}}),t.isLoadOver?i("fmd-tache-rule",{directives:[{name:"show",rawName:"v-show",value:"tacheRule"===t.activeName,expression:"activeName==='tacheRule'"}],ref:"fmdTchRule",attrs:{revisionId:t.revisionId,dirCondition:t.dirCondition,ruleTacheStaffData:t.ruleTacheStaffData,ruleReaderStaffData:t.ruleReaderStaffData,disabled:t.disabled,node:t.node,tableOptions:t.tableOptions},on:{getAdvancedProperties:t.getAdvancedProperties}}):t._e(),t.isLoadOver?i("fmd-nexttch-rule",{directives:[{name:"show",rawName:"v-show",value:"nextTchRule"===t.activeName,expression:"activeName==='nextTchRule'"}],ref:"nexttch",attrs:{revisionId:t.revisionId,dirCondition:t.dirCondition,ruleNextTacheData:t.ruleNextTacheData,disabled:t.disabled,tableOptions:t.tableOptions,node:t.node},on:{getAdvancedProperties:t.getAdvancedProperties}}):t._e(),i("fmd-display-setting",{directives:[{name:"show",rawName:"v-show",value:"fieldSetting"===t.activeName&&!t.disabled,expression:"activeName==='fieldSetting' && !disabled"}],ref:"fmdDisplaySetting",attrs:{disabled:t.disabled,node:t.node}}),i("fmd-advance-setting",{directives:[{name:"show",rawName:"v-show",value:"advanceSetting"===t.activeName,expression:"activeName==='advanceSetting'"}],ref:"fmdAdvance",attrs:{disabled:t.disabled,tableOptions:t.tableOptions,revisionId:t.revisionId,dirCondition:t.dirCondition,ruleRoleGroupData:t.ruleRoleGroupData,node:t.node},on:{getAdvancedProperties:t.getAdvancedProperties}})],1),i("fi-row",{staticClass:"footer",attrs:{slot:"footer"},slot:"footer"},[i("fi-button",{attrs:{size:"mini"},on:{click:t.handleClose}},[t._v(t._s(t.disabled?t.t("editNode.close"):t.t("editNode.cancel")))]),t.disabled?t._e():i("fi-button",{attrs:{type:"primary",size:"mini"},on:{click:t.submit}},[t._v(t._s(t.t("editNode.confirm")))])],1)],1)},Gn=[],Zn=i("a34a"),Xn=i.n(Zn),Yn=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("fi-form",{ref:"tacheAttr",staticClass:"fmd-tache-attr",attrs:{model:t.tacheAttr,disabled:t.disabled,rules:t.tacheAttrRules,size:"small","label-width":"160px"}},[i("fi-row",[i("fi-form-item",{attrs:{label:t.t("tacheAttr.tchMod"),prop:"tchMod"}},[i("fi-input",{attrs:{readonly:""},model:{value:t.tacheAttr.tchMod,callback:function(e){t.$set(t.tacheAttr,"tchMod",e)},expression:"tacheAttr.tchMod"}})],1)],1),i("fi-row",[i("fi-form-item",{attrs:{label:t.t("tacheAttr.tchNum"),prop:"tchNum"}},[i("fi-input",{model:{value:t.tacheAttr.tchNum,callback:function(e){t.$set(t.tacheAttr,"tchNum",e)},expression:"tacheAttr.tchNum"}})],1)],1),i("fi-row",[i("fi-form-item",{attrs:{label:t.t("tacheAttr.tchName"),prop:"tchName"}},[i("fi-input",{model:{value:t.tacheAttr.tchName,callback:function(e){t.$set(t.tacheAttr,"tchName",e)},expression:"tacheAttr.tchName"}})],1)],1),i("fi-row",[i("fi-form-item",{attrs:{label:t.t("tacheAttr.tchNameUs"),prop:"tchNameUs"}},[i("fi-input",{model:{value:t.tacheAttr.tchNameUs,callback:function(e){t.$set(t.tacheAttr,"tchNameUs",e)},expression:"tacheAttr.tchNameUs"}})],1)],1),i("fi-row",[i("fi-form-item",{attrs:{label:t.t("tacheAttr.tchType"),prop:"tchType"}},[i("fi-select",{attrs:{disabled:["1","2"].includes(t.node.tchType)},model:{value:t.tacheAttr.tchType,callback:function(e){t.$set(t.tacheAttr,"tchType",e)},expression:"tacheAttr.tchType"}},t._l(t.options.tchType,function(t){return i("fi-option",{key:t.id,attrs:{value:t.id,label:t.label,disabled:["1","2"].includes(t.id)}})}),1)],1)],1),i("fi-row",[i("fi-form-item",{attrs:{label:t.t("tacheAttr.funcMenu"),prop:"tools"}},[i("fi-select",{staticClass:"w100",attrs:{multiple:""},model:{value:t.tacheAttr.funcMenuItemIds,callback:function(e){t.$set(t.tacheAttr,"funcMenuItemIds",e)},expression:"tacheAttr.funcMenuItemIds"}},t._l(t.options.tools||[],function(t){return i("fi-option",{key:t.funcMenuItemId,attrs:{value:t.funcMenuItemId,label:t.itemLabel}})}),1)],1)],1),"2"!==t.tacheAttr.tchType?i("fi-row",[i("fi-form-item",{attrs:{label:t.t("tacheAttr.flowMode"),prop:"flowMode"}},[i("fi-checkbox-group",{model:{value:t.flowMode,callback:function(e){t.flowMode=e},expression:"flowMode"}},[i("fi-checkbox",{attrs:{label:"serial"}},[t._v(t._s(t.t("tacheAttr.serial")))]),i("fi-checkbox",{attrs:{label:"multiInst"}},[t._v(t._s(t.t("tacheAttr.parallel")))])],1)],1)],1):t._e(),i("fi-row",[i("fi-form-item",{attrs:{label:t.t("tacheAttr.model")}},[i("fi-radio-group",{model:{value:t.model,callback:function(e){t.model=e},expression:"model"}},[i("fi-radio",{attrs:{label:"layer"}},[t._v(t._s(t.t("tacheAttr.layer")))]),i("fi-radio",{attrs:{label:"form"}},[t._v(t._s(t.t("tacheAttr.form")))])],1)],1)],1),["1","2"].includes(t.tacheAttr.tchType)?t._e():i("fi-row",[i("fi-col",{attrs:{span:20}},[i("fi-form-item",{attrs:{prop:"subFlowMod",label:t.t("tacheAttr.subFlowMod")}},[i("fi-select",{staticStyle:{width:"100%"},attrs:{filterable:"",placeholder:t.t("tacheAttr.subFlowPlace"),clearable:""},on:{change:t.onSubFlowModChange},model:{value:t.tacheAttr.subFlowMod,callback:function(e){t.$set(t.tacheAttr,"subFlowMod",e)},expression:"tacheAttr.subFlowMod"}},t._l(t.options.childFlow,function(t){return i("fi-option",{key:t.flowMod,attrs:{value:t.flowMod,label:t.flowName}})}),1)],1)],1),i("fi-col",{attrs:{span:2,offset:1}},[i("fi-button",{attrs:{type:"text"},on:{click:t.createNewChildFlow}},[t._v(t._s(t.t("tacheAttr.createNewChildFlow")))])],1)],1),"2"!==t.tacheAttr.tchType?i("fi-row",[i("fi-form-item",{attrs:{label:t.t("tacheAttr.canCancelBack"),"label-width":t.$i18n&&"en"===t.$i18n.locale?"300px":"160px",prop:"advancedProperties.canCancelBackto"}},[i("fi-switch",{attrs:{"active-text":t.t("tacheAttr.yes"),"active-value":"0BT","inactive-text":t.t("tacheAttr.no"),"inactive-value":"0BF",type:"inside"},model:{value:t.tacheAttr.advancedProperties.canCancelBackto,callback:function(e){t.$set(t.tacheAttr.advancedProperties,"canCancelBackto",e)},expression:"tacheAttr.advancedProperties.canCancelBackto"}})],1)],1):t._e(),t.options.canReturnTchs.length>0&&"2"!==t.tacheAttr.tchType?i("fi-row",[i("fi-form-item",{attrs:{label:t.t("tacheAttr.canReturn"),prop:"canReturn"}},[i("fi-switch",{attrs:{"active-text":t.t("tacheAttr.yes"),"active-value":"0BT","inactive-text":t.t("tacheAttr.no"),"inactive-value":"0BF",type:"inside"},on:{change:t.onCanReturn},model:{value:t.tacheAttr.canReturn,callback:function(e){t.$set(t.tacheAttr,"canReturn",e)},expression:"tacheAttr.canReturn"}})],1)],1):t._e(),t.canReturnTchsShow&&"2"!==t.tacheAttr.tchType?i("fi-row",[i("fi-form-item",{attrs:{label:t.t("tacheAttr.canReturnTchs")}},[i("fi-select",{attrs:{multiple:""},on:{change:t.onReturnTchChange,"remove-tag":t.onRemoveReturnTch},model:{value:t.canReturnTch,callback:function(e){t.canReturnTch=e},expression:"canReturnTch"}},t._l(t.options.canReturnTchs,function(t){return i("fi-option",{key:t.tchMod,attrs:{value:t.tchMod,label:t.tchName}})}),1)],1)],1):t._e(),"2"!==t.tacheAttr.tchType?i("fi-row",[i("fi-form-item",{attrs:{label:t.t("tacheAttr.canTransfer"),prop:"canTransfer"}},[i("fi-switch",{attrs:{"active-text":t.t("tacheAttr.yes"),"active-value":"0BT","inactive-text":t.t("tacheAttr.no"),"inactive-value":"0BF",type:"inside"},on:{change:t.onCanTransferChange},model:{value:t.tacheAttr.canTransfer,callback:function(e){t.$set(t.tacheAttr,"canTransfer",e)},expression:"tacheAttr.canTransfer"}})],1)],1):t._e(),"2"!==t.tacheAttr.tchType&&"0BT"===t.tacheAttr.canTransfer&&(t.tacheAttr.flowMode||[]).includes("multiInst")?i("fi-row",[i("fi-form-item",{attrs:{label:t.t("tacheAttr.canMultiTransfer"),prop:"canMultiTransfer"}},[i("fi-switch",{attrs:{"active-text":t.t("tacheAttr.yes"),"active-value":"0BT","inactive-text":t.t("tacheAttr.no"),"inactive-value":"0BF",type:"inside"},model:{value:t.tacheAttr.canMultiTransfer,callback:function(e){t.$set(t.tacheAttr,"canMultiTransfer",e)},expression:"tacheAttr.canMultiTransfer"}})],1)],1):t._e(),i("fi-row",[i("fi-col",{attrs:{span:22}},[i("fi-form-item",{attrs:{label:t.t("tacheAttr.consultAdvices"),prop:"consultAdvices"}},[i("div",[t._v(t._s(t.t("tacheAttr.consultPlace")))])])],1),i("fi-col",{attrs:{span:2}},[i("fi-button",{staticClass:"add-question",attrs:{type:"text"},on:{click:t.addQuestion}},[t._v("+"+t._s(t.t("tacheAttr.addQuestion")))])],1)],1),t._l(t.tacheAttr.consultAdvices,function(e,n){return i("fi-row",{key:n},[i("fi-col",{attrs:{span:12}},[i("div",{staticClass:"del-question"},[i("i",{staticClass:"el-icon-remove",attrs:{title:t.t("tacheAttr.delQuestion")},on:{click:function(e){return t.delQuestion(n)}}})]),i("fi-form-item",{attrs:{label:"",prop:"consultQuestion"}},[i("fi-input",{attrs:{placeholder:t.t("tacheAttr.enterQuestion")},model:{value:e.consultQuestion,callback:function(i){t.$set(e,"consultQuestion",i)},expression:"item.consultQuestion"}})],1)],1),i("fi-col",{attrs:{span:12}},[i("fi-form-item",{attrs:{label:"","label-width":"40px"}},[i("import-answer",{attrs:{answer:e,index:n},on:{change:t.onAnswerChange}})],1)],1)],1)}),i("fi-row",[i("fi-col",{attrs:{span:22}},[i("fi-form-item",{attrs:{label:t.t("tacheAttr.flowHs")}},[i("span",[t._v(t._s(t.t("tacheAttr.flowNamed"))+"\n          "),i("fi-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.t("tacheAttr.flowContent"),placement:"bottom"}},[i("fi-button",{attrs:{type:"text",icon:"el-icon-question"}})],1)],1)])],1),i("fi-col",{attrs:{span:2}},[i("fi-button",{staticClass:"flow-speech--btn",class:{"el-icon-arrow-down":t.showFlowSpeech,"el-icon-arrow-right":!t.showFlowSpeech},attrs:{type:"text"},on:{click:function(e){t.showFlowSpeech=!t.showFlowSpeech}}})],1)],1),t._l(t.flowSpeechComp,function(e,n){return i("fi-row",{directives:[{name:"show",rawName:"v-show",value:t.showFlowSpeech,expression:"showFlowSpeech"}],key:n},[i("fi-form-item",{attrs:{label:""}},[i("fi-col",{attrs:{span:8}},[i("div",[t._v(t._s(e.tchName)+"->"+t._s(t.flowSpeechType[e.type])+t._s(t.tacheAttr.tchName))])]),i("fi-col",{attrs:{span:8}},[i("fi-input",{attrs:{placeholder:t.t("tacheAttr.enterNameCn"),"suffix-icon":"el-icon-edit"},on:{change:t.flowSpeechChange},model:{value:e.changeTchName,callback:function(i){t.$set(e,"changeTchName",i)},expression:"item.changeTchName"}})],1),i("fi-col",{attrs:{span:8}},[i("fi-input",{attrs:{placeholder:t.t("tacheAttr.enterNameUs"),"suffix-icon":"el-icon-edit"},on:{change:t.flowSpeechChange},model:{value:e.changeTchNameUs,callback:function(i){t.$set(e,"changeTchNameUs",i)},expression:"item.changeTchNameUs"}})],1)],1)],1)}),i("fi-row",[i("fi-form-item",{attrs:{label:t.t("tacheAttr.procTimeoutRule")}},[i("fi-col",{attrs:{span:12}},[i("fi-checkbox",{attrs:{"true-label":"true","false-label":"false"},on:{change:t.clearTime},model:{value:t.isChoose,callback:function(e){t.isChoose=e},expression:"isChoose"}},[t._v(t._s(t.t("tacheAttr.tchRemainsTimeOut")))])],1),i("fi-col",{attrs:{span:4}},[i("fi-input",{attrs:{disabled:"false"===t.isChoose},model:{value:t.tacheAttr.slaTime,callback:function(e){t.$set(t.tacheAttr,"slaTime",e)},expression:"tacheAttr.slaTime"}})],1),i("fi-col",{attrs:{span:5,offset:1}},[i("fi-select",{attrs:{disabled:"false"===t.isChoose},model:{value:t.tacheAttr.slaUnit,callback:function(e){t.$set(t.tacheAttr,"slaUnit",e)},expression:"tacheAttr.slaUnit"}},t._l(t.options.procTimeoutUnit,function(t){return i("fi-option",{key:t.value,attrs:{value:t.value,label:t.label}})}),1)],1)],1)],1)],2)},$n=[],qn={nodes:[],setNodes:function(t){this.nodes=t},addNode:function(t){this.nodes.some(function(e){return e.pid===t.pid&&e.id===t.id})||this.nodes.push(t)},delNode:function(t){var e=this,i=t.canReturn,n=t.canReturnTaches,o=t.tchMod;(this.nodes.filter(function(t){return t.id==="".concat(o)}).forEach(function(t){var i=e.nodes.findIndex(function(e){return t.id===e.id});-1!==i&&e.nodes.splice(i,1)}),"0BT"===i&&n)&&n.split(",").forEach(function(t){var i=e.nodes.findIndex(function(e){return"".concat(t)===e.id&&"".concat(e.pid)==="".concat(o)});-1!==i&&e.nodes.splice(i,1)})},delNodeByLink:function(t,e){var i=e.getClient("data"),n=i.canReturn,o=i.canReturnTaches,r=this.nodes.findIndex(function(e){return"".concat(t.id)===e.id&&"".concat(e.pid)==="".concat(t.pid)});if(-1!==r&&this.nodes.splice(r,1),"0BT"===n&&o){var a=o.split(","),s=a.filter(function(e){return"".concat(e)!=="".concat(t.pid)});i.canReturnTaches=s.join(","),e.setClient("data",i)}},delNodeByCanReturn:function(t){var e=this.nodes.findIndex(function(e){return t.id===e.id&&t.pid===e.pid});-1!==e&&this.nodes.splice(e,1)},findCanReturnNodes:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return this.nodes.filter(function(e){return e.id===t.id}).forEach(function(t){i.includes(t.pid)||i.push(t.pid);var o=e.nodes.find(function(e){return e.id===t.pid});o&&!n.some(function(t){return t.id===o.id&&t.pid===o.pid})&&(n.push(o),e.findCanReturnNodes(o,i,n))}),i},getCanReturnNodes:function(t){var e=this.findCanReturnNodes(t),i=[];return e.forEach(function(t){var e=En.nodes.find(function(e){return"".concat(e.tchMod)==="".concat(t)});e&&i.push(e)}),i.map(function(t){return{tchMod:"".concat(t.tchMod),tchName:t.tchName,tchNameUs:t.tchNameUs}})}},Kn=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"import-answer",attrs:{tabindex:"0"}},[i("fi-row",[i("fi-col",{attrs:{span:12}},[i("fi-input",{staticClass:"import-answer--input",attrs:{placeholder:t.t("importAnswer.placeholder")},model:{value:t.answerObj.consultAnswer,callback:function(e){t.$set(t.answerObj,"consultAnswer",e)},expression:"answerObj.consultAnswer"}})],1),i("fi-col",{attrs:{span:12}},[i("fi-upload",{staticClass:"upload-answer",attrs:{action:"/form/attach/upload",limit:1,name:"attachFile",data:t.uploadParams,"on-success":t.onUploadSuccess,"before-upload":t.onBeforeUpload,"on-remove":t.onRemoveAnswerAttach,"file-list":t.answerObj.consultAdviceAttaches}},[i("fi-button",{attrs:{type:"text",disabled:1===t.answerObj.consultAdviceAttaches.length}},[t._v(t._s(t.t("importAnswer.uploadAnswer")))])],1)],1)],1)],1)},Jn=[],Qn={name:"import-answer",props:{answer:Object,index:Number},mixins:[bn.localeMixin],data:function(){return{uploadParams:{path:"consultAdvice"}}},computed:{answerObj:{set:function(t){this.$emit("change",{answer:t,index:this.index})},get:function(){return this.answer}}},methods:{onUploadSuccess:function(t,e,i){var n=i.map(function(t){return V({},t,{attachName:t.name})});this.answerObj.consultAdviceAttaches=n},onBeforeUpload:function(t){this.uploadParams={path:"consultAdvice",attachFile:[t]}},onRemoveAnswerAttach:function(t,e){var i=e.map(function(t){return V({},t,{attachName:t.name})});this.answerObj.consultAdviceAttaches=i}}},to=Qn,eo=(i("6dc4"),B(to,Kn,Jn,!1,null,"87ca2070",null)),io=eo.exports,no={name:"fmd-tache-attr",mixins:[bn.localeMixin],props:{node:Object,tchModel:Object,disabled:Boolean,preTchs:Array,toolOptions:[Object,Array]},components:{ImportAnswer:io},computed:{canReturnTch:{get:function(){return Array.isArray(this.tacheAttr.canReturnTaches)?this.tacheAttr.canReturnTaches:this.tacheAttr.canReturnTaches?this.tacheAttr.canReturnTaches.split(","):[]},set:function(t){this.tacheAttr.canReturnTaches=t.join(",")}},flowSpeechComp:{get:function(){var t=this;return this.flowSpeech.length>0&&this.tacheAttr.pathTchModels&&this.tacheAttr.pathTchModels.forEach(function(e){var i=t.flowSpeech.findIndex(function(t){return t.tchMod==="".concat(e.sTchMod)});-1!==i&&(t.flowSpeech[i].changeTchName=e.tchName||t.tacheAttr.tchName,t.flowSpeech[i].changeTchNameUs=e.tchNameUs||t.tacheAttr.tchNameUs)}),this.flowSpeech},set:function(t){this.tacheAttr.pathTchModels=t.map(function(t){return G({},t,{sTchMod:t.tchMod,tchName:t.changeTchName,tchNameUs:t.changeTchNameUs})})}},model:{get:function(){return this.node.advancedProperties&&this.node.advancedProperties.windConfigInfo&&this.node.advancedProperties.windConfigInfo.model||"layer"},set:function(t){this.node.advancedProperties.windConfigInfo.model=t}},canReturnTchsShow:function(){return"0BT"===this.tacheAttr.canReturn||!1},flowMode:{get:function(){return"string"==typeof this.tacheAttr.flowMode&&this.tacheAttr.flowMode.length?[this.tacheAttr.flowMode]:this.tacheAttr.flowMode||[]},set:function(t){this.tacheAttr.flowMode=t}}},data:function(){var t=this,e=function(e,i,n){i?i.length>48?n(new Error(t.t("tacheAttr.errorMessage2"))):n():n(new Error(t.t("tacheAttr.errorMessage1")))},i=function(e,i,n){i?i.length>32?n(new Error(t.t("tacheAttr.errorMessage4"))):i.match(/^[A-Za-z0-9-_]+$/)?n():n(new Error(t.t("tacheAttr.errorMessage5"))):n(new Error(t.t("tacheAttr.errorMessage3")))};return{isChoose:"false",tacheAttr:this.node,flowSpeech:this.preTchs,flowSpeechType:{1:this.t("tacheAttr.goto"),2:this.t("tacheAttr.back"),3:this.t("tacheAttr.transfer")},options:{tchType:[{id:"1",label:this.t("tacheAttr.beginTch")},{id:"2",label:this.t("tacheAttr.endTch")},{id:"3",label:this.t("tacheAttr.execTch")},{id:"4",label:this.t("tacheAttr.virTch")}],childFlow:[],canReturnTchs:[],tools:[],goReturn:[],procTimeoutUnit:[{value:"h",label:this.t("options.hour")},{value:"m",label:this.t("options.minute")},{value:"d",label:this.t("options.day")}]},canReturn:!0,tacheAttrRules:{tchName:[{required:!0,validator:e,trigger:"change"}],tchNum:[{required:!0,validator:i,trigger:"change"}]},showFlowSpeech:!1}},created:function(){var t=this;window.refreshChildFlowOption=function(e){return t.refreshChildFlowOption(e)}},mounted:function(){this.$emit("change"),this.getCanReturnTchs(),this.getSysFuncMenuItems(),this.tacheAttr.tchNum=this.tacheAttr.tchNum?this.tacheAttr.tchNum:"T_".concat(this.tacheAttr.tchMod),this.tacheAttr.canReturn=this.tacheAttr.canReturn?this.tacheAttr.canReturn:"0BF",this.tacheAttr.canTransfer=this.tacheAttr.canTransfer?this.tacheAttr.canTransfer:"0BF",this.onCanReturn(this.tacheAttr.canReturn),this.fetchChildFlows(),this.isChoose=""!==this.tacheAttr.slaTime&&null!==this.tacheAttr.slaTime?"true":"false"},methods:{fetchChildFlows:function(){var t=this;E(this.tacheAttr.flowMod).then(function(e){t.options.childFlow=e})},onSubFlowModChange:function(t){this.tacheAttr.tchType=t?"4":"3"},addQuestion:function(){var t={consultAdviceAttaches:[],consultAnswer:"",consultQuestion:""};this.tacheAttr.consultAdvices.push(t)},delQuestion:function(t){this.tacheAttr.consultAdvices.splice(t,1)},onAnswerChange:function(t){var e=t.answer,i=t.index;this.tacheAttr.consultAdviceAttaches[i].consultAnswer=e},getCanReturnTchs:function(){var t=this;this.options.canReturnTchs=qn.getCanReturnNodes({id:"".concat(this.tacheAttr.tchMod)});var e=this.options.canReturnTchs.findIndex(function(e){return"".concat(e.tchMod)==="".concat(t.tacheAttr.tchMod)});-1!==e&&this.options.canReturnTchs.splice(e,1),this.filterCanGoAndReturnTchs(),this.$emit("change")},filterCanGoAndReturnTchs:function(){var t=this,e=this.tacheAttr,i=e.canReturn,n=e.canReturnTaches,o=[],r=this.tchModel.getFromLinks();r&&(r.forEach(function(e){var r=e.getToNode().getClient("data"),a=r.tchMod;if("0BT"===i&&n){o=n.split(",");var s=o.findIndex(function(t){return"".concat(t)==="".concat(a)});-1!==s&&o.splice(s,1)}var l=t.options.canReturnTchs.findIndex(function(t){return"".concat(t.tchMod)==="".concat(a)});-1!==l&&t.options.canReturnTchs.splice(l,1)}),this.tacheAttr.canReturnTaches=o.join(","))},onCanReturn:function(t){t&&"0BF"!==t||(this.canReturnTch=[]),this.$emit("canReturn","0BT"===t)},submitTchAttrForm:function(){return this.$refs.tacheAttr.validate()},getSysFuncMenuItems:function(){function t(){return e.apply(this,arguments)}var e=H(Xn.a.mark(function t(){var e;return Xn.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.toolOptions||!(this.tacheAttr.funcMenuItemIds.length>0)){t.next=7;break}return t.next=3,M();case 3:e=t.sent,this.options.tools=e.map(function(t){var e=/<\/?.+?\/?>/g;return G({},t,{itemLabel:(t.itemLabel||"").replace(e,"")})}),t.next=8;break;case 7:this.options.tools=this.toolOptions;case 8:case"end":return t.stop()}},t,this)}));return t}(),onCanTransferChange:function(){this.$emit("change")},onReturnTchChange:function(t){var e=this;t.forEach(function(t){qn.addNode({id:"".concat(t),pid:"".concat(e.tacheAttr.tchMod)})}),this.$emit("change")},onRemoveReturnTch:function(t){qn.delNodeByCanReturn({id:t,pid:"".concat(this.tacheAttr.tchMod)})},createNewChildFlow:function(){function t(){return e.apply(this,arguments)}var e=H(Xn.a.mark(function t(){var e,i,n,o;return Xn.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=_(window.location.search),i=e.flowMod,n=window.location.href,t.next=4,N();case 4:o=t.sent,-1===n.indexOf("localhost")?window.open("/flow/flowCenter/flowFormModel?flowMod=".concat(o,"&fFlowMod=").concat(i,"&type=new")):window.open("/flowFormModel?flowMod=".concat(o,"&fFlowMod=").concat(i,"&type=new"));case 6:case"end":return t.stop()}},t)}));return t}(),refreshChildFlowOption:function(t){this.tacheAttr.subFlowMod=t,this.fetchChildFlows()},flowSpeechChange:function(){this.tacheAttr.pathTchModels=this.flowSpeechComp.map(function(t){return G({},t,{sTchMod:parseInt(t.tchMod),tchName:t.changeTchName,tchNameUs:t.changeTchNameUs})})},clearTime:function(){this.tacheAttr.slaUnit="h","false"===this.isChoose&&(this.tacheAttr.slaTime="",this.tacheAttr.slaUnit="h")}}},oo=no,ro=(i("8a0d"),B(oo,Yn,$n,!1,null,"05318a08",null)),ao=ro.exports,so=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("fi-form",{ref:"tacheRule",staticClass:"fmd-tache-rule",attrs:{rules:t.rules,model:t.tacheRule,disabled:t.disabled,size:"small","label-width":"110px"}},[i("div",{staticClass:"cancle-people"},[i("div",{staticClass:"title"},[i("div",{staticClass:"add-tch-people"},[i("span",{staticClass:"divider"}),t._v(t._s(t.t("options.tacheHander"))+"\n        "),i("fi-dropdown",{attrs:{trigger:"click"}},[i("span",{staticClass:"el-dropdown-link"},[i("fi-button",{attrs:{type:"text"}},[t._v(t._s(t.dropdown.rootModel)),i("i",{staticClass:"el-icon-caret-bottom"})])],1),i("fi-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},t._l(t.options.modal,function(e){return i("fi-dropdown-item",{key:e.id,attrs:{disabled:t.disabled},nativeOn:{click:function(i){return t.onDropDownModal("rootModel",e)}}},[t._v(t._s(e.label))])}),1)],1),2===t.dropdownValue.rootModel?i("div",{staticClass:"self-modal-add"},[i("fi-dropdown",{attrs:{type:"text"}},[i("fi-button",{attrs:{type:"text"}},[t._v("\n                "+t._s(t.t("tchRule.add"))),i("i",{staticClass:"el-icon-caret-bottom el-icon--right"})]),i("fi-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[i("fi-dropdown-item",{nativeOn:{click:function(e){t.addFoldLayers(t.t("options.tacheHander"),2)}}},[t._v(t._s(t.t("tchRule.addRule")))])],1)],1)],1):t._e()],1),i("div",{staticClass:"notice"},[i("fi-form-item",{staticClass:"notice-type",attrs:{label:t.t("options.notyfyType"),"label-width":"90px"}},[i("fi-checkbox",{attrs:{"true-label":"true","false-label":"false"},model:{value:t.tacheRule.processorNotifyCfg.sms.selected,callback:function(e){t.$set(t.tacheRule.processorNotifyCfg.sms,"selected",e)},expression:"tacheRule.processorNotifyCfg.sms.selected"}},[t._v(t._s(t.t("options.sms")))]),i("fi-checkbox",{attrs:{"true-label":"true","false-label":"false"},model:{value:t.tacheRule.processorNotifyCfg.mail.selected,callback:function(e){t.$set(t.tacheRule.processorNotifyCfg.mail,"selected",e)},expression:"tacheRule.processorNotifyCfg.mail.selected"}},[t._v(t._s(t.t("options.email")))])],1)],1)]),2===t.dropdownValue.rootModel?i("div",[i("fmd-tache-cfg",{attrs:{node:t.node,revisionId:t.revisionId,dirCondition:t.dirCondition,foldingLayer:t.ruleTacheStaffData,disabled:t.disabled,type:2}})],1):t._e(),1===t.dropdownValue.rootModel?i("div",{staticClass:"content"},[i("fi-row",{staticClass:"one-row"},[i("fi-col",{attrs:{span:t.$i18n&&"en"===t.$i18n.locale?24:12}},[i("fi-form-item",{attrs:{label:t.t("options.staffCreateType"),"label-width":t.$i18n&&"en"===t.$i18n.locale?"200px":"110px"}},[i("fi-select",{staticClass:"w100",attrs:{placeholder:t.t("options.staffCreateType")},on:{change:function(e){return t.onChangeStaffType("rootOrgType",t.tacheRule.staffCreateType)}},model:{value:t.tacheRule.staffCreateType,callback:function(e){t.$set(t.tacheRule,"staffCreateType",e)},expression:"tacheRule.staffCreateType"}},t._l(t.options.staffCreateType,function(t){return i("fi-option",{key:t.id,attrs:{value:t.id,label:t.label}})}),1)],1)],1),i("fi-col",{attrs:{span:t.$i18n&&"en"===t.$i18n.locale?24:12}},[i("fi-form-item",{attrs:{label:t.t("options.beginOrgValue"),"label-width":t.$i18n&&"en"===t.$i18n.locale?"200px":"110px"}},[i("processing-scope",{attrs:{editable:!t.disabled,type:t.tacheRule.staffCreateType,disabled:""===t.tacheRule.staffCreateType,placeholder:t.t("options.beginOrgValue")},on:{change:function(e){return t.onBeginOrgValueChange()}},model:{value:t.tacheRule.beginOrgValue,callback:function(e){t.$set(t.tacheRule,"beginOrgValue",e)},expression:"tacheRule.beginOrgValue"}})],1)],1)],1),i("fi-row",{staticClass:"three-row"},[i("fi-form-item",{attrs:{prop:"rootOrgValue","label-width":"0"}},[i("fi-const-textarea",{ref:"rootConst",attrs:{custom:"form"===t.tacheRule.rootOrgType,options:t.tableOptions,disabled:""===t.tacheRule.staffCreateType,"show-label":!1,"click-before":t.onRootOrgClickBefore},model:{value:t.tacheRule.rootOrgValue,callback:function(e){t.$set(t.tacheRule,"rootOrgValue",e)},expression:"tacheRule.rootOrgValue"}},[i("div",{staticClass:"h32"},[i("fi-tooltip",{staticClass:"item",attrs:{slot:"suffix",effect:"dark",placement:"bottom"},slot:"suffix"},[i("div",{attrs:{slot:"content"},slot:"content"},[t._v("\n                  "+t._s(t.t("tchRule.rootOrgValueContent"))+"\n                ")]),i("i",{staticClass:"fa fa-question-circle-o"})]),t._v(t._s(t.t("options.rootOrgType"))+"：\n              "),""!==t.tacheRule.staffCreateType?i("fi-select",{staticClass:"fmd-tache-rule--select",attrs:{clearable:""},on:{change:function(e){return t.onTypeChange("rootOrgValue")}},model:{value:t.tacheRule.rootOrgType,callback:function(e){t.$set(t.tacheRule,"rootOrgType",e)},expression:"tacheRule.rootOrgType"}},t._l(t.options.rootOrgType,function(t){return i("fi-option",{key:t.id,attrs:{value:t.id,label:t.label}})}),1):t._e(),""!==t.tacheRule.staffCreateType?i("fi-checkbox",{staticClass:"can-change",attrs:{"true-label":"0BT","false-label":"0BF"},model:{value:t.tacheRule.rootOrgCanChange,callback:function(e){t.$set(t.tacheRule,"rootOrgCanChange",e)},expression:"tacheRule.rootOrgCanChange"}},[t._v(t._s(t.t("tchRule.allowUpdate")))]):t._e()],1)])],1)],1),i("fi-row",{staticClass:"four-row"},[i("fi-form-item",{attrs:{prop:"defaultStaffValue","label-width":"0"}},[i("fi-const-textarea",{attrs:{custom:"form"===t.tacheRule.defaultStaffType,options:t.tableOptions,"show-label":!1,"click-before":t.onDefaultStaffClickBefore},model:{value:t.tacheRule.defaultStaffValue,callback:function(e){t.$set(t.tacheRule,"defaultStaffValue",e)},expression:"tacheRule.defaultStaffValue"}},[i("div",[t._v("\n              "+t._s(t.t("options.defaultHander"))+"：\n              "),i("fi-select",{staticClass:"fmd-tache-rule--select",attrs:{clearable:""},on:{change:function(e){return t.onTypeChange("defaultStaffValue")}},model:{value:t.tacheRule.defaultStaffType,callback:function(e){t.$set(t.tacheRule,"defaultStaffType",e)},expression:"tacheRule.defaultStaffType"}},t._l(t.options.rootOrgType,function(t){return i("fi-option",{key:t.id,attrs:{value:t.id,label:t.label}})}),1),i("fi-checkbox",{staticClass:"can-change",attrs:{"true-label":"0BT","false-label":"0BF"},model:{value:t.tacheRule.defaultStaffCanChange,callback:function(e){t.$set(t.tacheRule,"defaultStaffCanChange",e)},expression:"tacheRule.defaultStaffCanChange"}},[t._v(t._s(t.t("tchRule.allowUpdate")))])],1)])],1)],1),"0BT"===t.tacheRule.defaultStaffCanChange?i("fi-row",{staticClass:"four-row"},[i("fi-form-item",{attrs:{prop:"filterStaffWhere","label-width":"0"}},[i("fi-const-textarea",{attrs:{"show-label":!1,"click-before":t.onFilterStaffClickBefore},model:{value:t.tacheRule.filterStaffWhere,callback:function(e){t.$set(t.tacheRule,"filterStaffWhere",e)},expression:"tacheRule.filterStaffWhere"}},[i("div",[t._v("\n              "+t._s(t.t("tchRule.filterHander"))+"：\n              "),i("fi-select",{staticClass:"fmd-tache-rule--select",attrs:{clearable:""},on:{change:function(e){return t.onTypeChange("filterStaffWhere")}},model:{value:t.tacheRule.filterStaffWhereType,callback:function(e){t.$set(t.tacheRule,"filterStaffWhereType",e)},expression:"tacheRule.filterStaffWhereType"}},t._l(t.options.filterStaffWhereType,function(t){return i("fi-option",{key:t.id,attrs:{value:t.id,label:t.label}})}),1)],1)])],1)],1):t._e(),"fix"===t.tacheRule.defaultStaffType?i("fi-row",[i("fi-form-item",{attrs:{prop:"reference",label:t.t("tchRule.beginOrgValue"),"label-width":t.$i18n&&"en"===t.$i18n.locale?"150px":"110px"}},[i("reference-staff",{attrs:{"root-org":t.selectRootNode,"begin-org":t.tacheRule.beginOrgValue,"root-org-can-change":t.tacheRule.rootOrgCanChange,"staff-create-type":t.tacheRule.staffCreateType,placeholder:t.t("tchRule.selectRecommend")},model:{value:t.tacheRule.recommendStaffValue,callback:function(e){t.$set(t.tacheRule,"recommendStaffValue",e)},expression:"tacheRule.recommendStaffValue"}})],1)],1):t._e()],1):t._e()]),i("div",{staticClass:"cancle-people"},[i("div",{staticClass:"title"},[i("div",{staticClass:"add-tch-people"},[i("span",{staticClass:"divider"}),t._v(t._s(t.t("options.tacheCC"))+"\n        "),i("fi-dropdown",{attrs:{trigger:"click"}},[i("span",{staticClass:"el-dropdown-link"},[i("fi-button",{attrs:{type:"text"}},[t._v(t._s(t.dropdown.notifyRootModel)),i("i",{staticClass:"el-icon-caret-bottom"})])],1),i("fi-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},t._l(t.options.modal,function(e){return i("fi-dropdown-item",{key:e.id,attrs:{disabled:t.disabled},nativeOn:{click:function(i){return t.onDropDownModal("notifyRootModel",e)}}},[t._v(t._s(e.label))])}),1)],1),2===t.dropdownValue.notifyRootModel?i("div",{staticClass:"self-modal-add"},[i("fi-dropdown",{attrs:{type:"text"}},[i("fi-button",{attrs:{type:"text"}},[t._v("\n                "+t._s(t.t("tchRule.add"))),i("i",{staticClass:"el-icon-caret-bottom el-icon--right"})]),i("fi-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[i("fi-dropdown-item",{nativeOn:{click:function(e){t.addFoldLayers(t.t("options.tacheCC"),4)}}},[t._v(t._s(t.t("tchRule.addRule")))])],1)],1)],1):t._e()],1),i("div",{staticClass:"notice"},[i("fi-form-item",{staticClass:"notice-type",attrs:{label:t.t("options.notyfyType"),"label-width":"90px"}},[i("fi-checkbox",{attrs:{"true-label":"true","false-label":"false"},model:{value:t.tacheRule.circularNotifyCfg.sms.selected,callback:function(e){t.$set(t.tacheRule.circularNotifyCfg.sms,"selected",e)},expression:"tacheRule.circularNotifyCfg.sms.selected"}},[t._v(t._s(t.t("options.sms")))]),i("fi-checkbox",{attrs:{"true-label":"true","false-label":"false"},model:{value:t.tacheRule.circularNotifyCfg.mail.selected,callback:function(e){t.$set(t.tacheRule.circularNotifyCfg.mail,"selected",e)},expression:"tacheRule.circularNotifyCfg.mail.selected"}},[t._v(t._s(t.t("options.email")))])],1)],1)]),2===t.dropdownValue.notifyRootModel?i("div",[i("fmd-tache-cfg",{attrs:{node:t.node,revisionId:t.revisionId,dirCondition:t.dirCondition,foldingLayer:t.ruleReaderStaffData,type:4,disabled:t.disabled}})],1):t._e(),1===t.dropdownValue.notifyRootModel?i("div",{staticClass:"content"},[i("fi-row",{staticClass:"one-row"},[i("fi-col",{attrs:{span:24}},[i("fi-form-item",{attrs:{label:t.t("options.staffCreateType"),"label-width":t.$i18n&&"en"===t.$i18n.locale?"160px":"110px"}},[i("fi-select",{staticClass:"w100",attrs:{placeholder:t.t("options.staffCreateType")},on:{change:function(e){return t.onChangeStaffType("notifyRootOrgType",t.tacheRule.notifyStaffCreateType)}},model:{value:t.tacheRule.notifyStaffCreateType,callback:function(e){t.$set(t.tacheRule,"notifyStaffCreateType",e)},expression:"tacheRule.notifyStaffCreateType"}},t._l(t.options.staffCreateType,function(t){return i("fi-option",{key:t.id,attrs:{value:t.id,label:t.label}})}),1)],1)],1)],1),i("fi-row",{staticClass:"two-row"},[i("fi-form-item",{attrs:{prop:"notifyRootOrgValue","label-width":"0"}},[i("fi-const-textarea",{attrs:{custom:"form"===t.tacheRule.notifyRootOrgType,options:t.tableOptions,disabled:""===t.tacheRule.notifyStaffCreateType,"show-label":!1,"click-before":t.onNotifyRootClickBefore},model:{value:t.tacheRule.notifyRootOrgValue,callback:function(e){t.$set(t.tacheRule,"notifyRootOrgValue",e)},expression:"tacheRule.notifyRootOrgValue"}},[i("div",{staticClass:"h32"},[i("fi-tooltip",{staticClass:"item",attrs:{slot:"suffix",effect:"dark",placement:"bottom"},slot:"suffix"},[i("div",{attrs:{slot:"content"},slot:"content"},[t._v("\n                  "+t._s(t.t("tchRule.rootOrgValueContent"))+"\n                ")]),i("i",{staticClass:"fa fa-question-circle-o"})]),t._v(t._s(t.t("options.rootOrgType"))+"：\n              "),""!==t.tacheRule.notifyStaffCreateType?i("fi-select",{staticClass:"fmd-tache-rule--select",attrs:{clearable:""},on:{change:function(e){return t.onTypeChange("notifyRootOrgValue")}},model:{value:t.tacheRule.notifyRootOrgType,callback:function(e){t.$set(t.tacheRule,"notifyRootOrgType",e)},expression:"tacheRule.notifyRootOrgType"}},t._l(t.options.rootOrgType,function(t){return i("fi-option",{key:t.id,attrs:{value:t.id,label:t.label}})}),1):t._e(),""!==t.tacheRule.notifyStaffCreateType?i("fi-checkbox",{staticClass:"can-change",attrs:{"true-label":"0BT","false-label":"0BF"},model:{value:t.tacheRule.notifyRootOrgCanChange,callback:function(e){t.$set(t.tacheRule,"notifyRootOrgCanChange",e)},expression:"tacheRule.notifyRootOrgCanChange"}},[t._v(t._s(t.t("tchRule.allowUpdate")))]):t._e()],1)])],1)],1),i("fi-row",{staticClass:"four-row"},[i("fi-form-item",{attrs:{prop:"notifyStaffValue","label-width":"0"}},[i("fi-const-textarea",{attrs:{custom:"form"===t.tacheRule.notifyStaffType,options:t.tableOptions,"show-label":!1,"click-before":t.onNotifyStaffClickBefore},model:{value:t.tacheRule.notifyStaffValue,callback:function(e){t.$set(t.tacheRule,"notifyStaffValue",e)},expression:"tacheRule.notifyStaffValue"}},[i("div",[t._v("\n             "+t._s(t.t("options.defaultHander"))+"：\n              "),i("fi-select",{staticClass:"fmd-tache-rule--select",attrs:{clearable:""},on:{change:function(e){return t.onTypeChange("notifyStaffValue")}},model:{value:t.tacheRule.notifyStaffType,callback:function(e){t.$set(t.tacheRule,"notifyStaffType",e)},expression:"tacheRule.notifyStaffType"}},t._l(t.options.rootOrgType,function(t){return i("fi-option",{key:t.id,attrs:{value:t.id,label:t.label}})}),1),i("fi-checkbox",{staticClass:"can-change",attrs:{"true-label":"0BT","false-label":"0BF"},model:{value:t.tacheRule.notifyStaffCanChange,callback:function(e){t.$set(t.tacheRule,"notifyStaffCanChange",e)},expression:"tacheRule.notifyStaffCanChange"}},[t._v(t._s(t.t("tchRule.allowUpdate")))])],1)])],1)],1)],1):t._e()]),t.disabled?t._e():i("fui-el-dialog-transfer-choice",{attrs:{"dialog-visible":t.orgDialogVisible,action:"ORG","start-paths":t.tacheRule.beginOrgValue,"selected-node":t.selectRootNode,"is-top":!t.tacheRule.beginOrgValue,multiple:t.multiple},on:{"on-cancel-after":t.doCancelAfter,"on-sure-after":t.doOnSureAfter},model:{value:t.checkedOrganzations,callback:function(e){t.checkedOrganzations=e},expression:"checkedOrganzations"}}),t.disabled?t._e():i("fui-el-dialog-transfer-choice",{attrs:{"dialog-visible":t.teamDialogVisible,action:"TEAM","start-paths":t.tacheRule.beginOrgValue,"selected-node":t.selectRootNode,"is-top":!1,multiple:t.multiple},on:{"on-cancel-after":t.doCancelAfter,"on-sure-after":t.doOnSureAfter},model:{value:t.checkedTeam,callback:function(e){t.checkedTeam=e},expression:"checkedTeam"}}),t.disabled?t._e():i("fui-el-dialog-transfer-choice",{attrs:{"dialog-visible":t.notifyOrgDialogVisible,action:"ORG","selected-node":t.selectNotifyRootNode,multiple:t.multiple},on:{"on-cancel-after":t.doNotifyCancelAfter,"on-sure-after":t.doNotifyOnSureAfter},model:{value:t.notifyCheckedOrganzations,callback:function(e){t.notifyCheckedOrganzations=e},expression:"notifyCheckedOrganzations"}}),t.disabled?t._e():i("fui-el-dialog-transfer-choice",{attrs:{"dialog-visible":t.notifyTeamDialogVisible,action:"TEAM","selected-node":t.selectNotifyRootNode,multiple:t.multiple},on:{"on-cancel-after":t.doNotifyCancelAfter,"on-sure-after":t.doNotifyOnSureAfter},model:{value:t.notifyCheckedTeam,callback:function(e){t.notifyCheckedTeam=e},expression:"notifyCheckedTeam"}})],1)},lo=[],ho=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"processing-scope"},[t.labelName?i("fi-tag",{staticClass:"process-tag",attrs:{size:"small","disable-transitions":"",type:"info",closable:!t.disabled},on:{close:t.handleClose}},[i("div",{staticClass:"process-tag--text",attrs:{title:t.labelName}},[t._v(t._s(t.labelName))])]):i("div",{staticClass:"processing-holder"},[t._v(t._s(t.placeholder))]),i("fi-button",{staticClass:"process-btn",attrs:{disabled:t.disabled,size:"small",type:"text"},on:{click:t.open}},[t._v(t._s(t.btnText))])],1),t.editable&&null!=t.startPathsVals&&""!=t.startPathsVals?i("fui-el-dialog-transfer-choice",{attrs:{"dialog-visible":t.orgDialogVisible,"selected-node":t.selectedNode,"start-paths":t.startPathsVals,"is-top":t.isStartParths,multiple:t.multiple,action:"ORG"},on:{"on-visible-change":t.doVisibleChange,"on-sure-after":t.doOnSureAfter},model:{value:t.checkedOrganzations,callback:function(e){t.checkedOrganzations=e},expression:"checkedOrganzations"}}):i("fui-el-dialog-transfer-choice",{attrs:{"dialog-visible":t.orgDialogVisible,"selected-node":t.selectedNode,multiple:t.multiple,action:"ORG"},on:{"on-visible-change":t.doVisibleChange,"on-sure-after":t.doOnSureAfter},model:{value:t.checkedOrganzations,callback:function(e){t.checkedOrganzations=e},expression:"checkedOrganzations"}}),t.editable&&null!=t.startPathsVals&&""!=t.startPathsVals?i("fui-el-dialog-transfer-choice",{attrs:{"dialog-visible":t.teamDialogVisible,"start-paths":t.startPathsVals,"is-top":t.isStartParths,"selected-node":t.selectedNode,multiple:t.multiple,action:"TEAM"},on:{"on-visible-change":t.doVisibleChange,"on-sure-after":t.doOnSureAfter},model:{value:t.checkedOrganzations,callback:function(e){t.checkedOrganzations=e},expression:"checkedOrganzations"}}):i("fui-el-dialog-transfer-choice",{attrs:{"dialog-visible":t.teamDialogVisible,"selected-node":t.selectedNode,multiple:t.multiple,action:"TEAM"},on:{"on-visible-change":t.doVisibleChange,"on-sure-after":t.doOnSureAfter},model:{value:t.checkedOrganzations,callback:function(e){t.checkedOrganzations=e},expression:"checkedOrganzations"}}),t.editable?i("fui-el-dialog-transfer-choice",{attrs:{"dialog-visible":t.dutyDialogVisible,"selected-node":t.selectedNode,multiple:t.multiple,action:"DUTY_LINE"},on:{"on-visible-change":t.doVisibleChange,"on-sure-after":t.doOnSureAfter},model:{value:t.checkedOrganzations,callback:function(e){t.checkedOrganzations=e},expression:"checkedOrganzations"}}):t._e(),t.editable?i("fui-el-dialog-choice-role",{ref:"dialog",attrs:{"start-paths":t.startPathsVals,"is-top":t.isStartParths,multiple:t.multiple},model:{value:t.selectedRoles,callback:function(e){t.selectedRoles=e},expression:"selectedRoles"}}):t._e()],1)},co=[],uo={2:"ORG",3:"TEAM",4:"DUTY_LINE",5:"ROLE"},fo={name:"processing-scope",mixins:[bn.localeMixin],props:{placeholder:String,type:[String,Number],disabled:Boolean,value:[String,Number],editable:Boolean,startPathsVal:{type:String,default:"0"},isStartParth:{type:Boolean,default:!0}},data:function(){return{orgDialogVisible:!1,teamDialogVisible:!1,dutyDialogVisible:!1,checkedOrganzations:[],multiple:!1,selectedNode:"",values:[],labelName:"",selectedRoles:this.value?[this.value]:[]}},mounted:function(){},watch:{selectedRoles:function(t){this.type&&"5"===this.type&&(this.labelName=1===t.length?t[0].role_name_cn:"",this.$emit("input",1===t.length?t[0].role_id.toString():""))},value:{immediate:!0,handler:function(t){this.$emit("change",t)}}},computed:{btnText:function(){return this.value?(this.initLabel(this.value),this.t("tacheComp.update")):(this.labelName="",this.t("tacheComp.add"))},action:function(){return uo[this.type]},startPathsVals:function(){return this.startPathsVal},isStartParths:function(){return this.isStartParth}},methods:{initLabel:function(t){var e=this;this.type&&"2"===this.type?L({orgIds:t}).then(function(t){e.selectedNode=t.length>0?"".concat(t[0].org_id):"",e.labelName=t.length>0?t[0].org_name:""}):this.type&&"3"===this.type?P({projectIds:t}).then(function(t){e.selectedNode=t.length>0?"".concat(t[0].group_id):"",e.labelName=t.length>0?t[0].group_name:""}):this.type&&"4"===this.type?R({dutyIds:t}).then(function(t){e.selectedNode=t.length>0?"".concat(t[0].duty_id):"",e.labelName=t.length>0?t[0].duty_name:""}):this.type&&"5"===this.type&&D(t).then(function(t){e.labelName=t.length>0?t[0].role_name_cn:""})},handleClose:function(){this.labelName="",this.$emit("input","")},open:function(){function t(){return e.apply(this,arguments)}var e=Y(Xn.a.mark(function t(){return Xn.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.value){t.next=6;break}this.labelName="",this.selectedNode="",this.values=[],t.next=8;break;case 6:return t.next=8,this.initLabel(this.value);case 8:this.type&&"5"===this.type?this.$refs.dialog.show():this.dialogChange(!0);case 9:case"end":return t.stop()}},t,this)}));return t}(),doOnSureAfter:function(t){this.type&&"2"===this.type?this.$emit("input",1===t.length?t[0].org_id.toString():""):this.type&&"3"===this.type?this.$emit("input",1===t.length?t[0].group_id.toString():""):this.type&&"4"===this.type&&this.$emit("input",1===t.length?t[0].duty_id.toString():""),this.$emit("change",t),this.dialogChange(!1)},doVisibleChange:function(t){this.dialogChange(t)},dialogChange:function(t){this.type&&"2"===this.type?this.orgDialogVisible=t:this.type&&"3"===this.type?this.teamDialogVisible=t:this.type&&"4"===this.type&&(this.dutyDialogVisible=t)}}},po=fo,go=(i("ff02"),B(po,ho,co,!1,null,null,null)),_o=go.exports,mo=i("2166"),vo=function(t){return new mo.StaffSelectAddonExtends(t)},yo=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"reference-staff"},[t.showPlaceholder?i("div",{staticClass:"reference-staff__holder"},[t._v(t._s(t.placeholder))]):i("div",t._l(t.staffItems,function(e,n){return i("fi-tag",{key:n,staticClass:"reference-staff__tag",attrs:{closable:!t.disabled,type:"info"},on:{close:function(i){return t.handleClose(e)}}},[t._v(t._s(e.STAFF_NAME))])}),1),i("fi-button",{staticClass:"reference-staff__btn",attrs:{disabled:t.disabled,type:"text"},on:{click:t.openStaffDialog}},[t._v(t._s(t.btnText))])],1)])},wo=[],bo={name:"reference-staff",mixins:[bn.localeMixin],props:{value:String,placeholder:String,disabled:Boolean,staffCreateType:String,beginOrg:[String,Object],rootOrg:[String,Object],rootOrgCanChange:String},data:function(){return{staffItems:[]}},computed:{btnText:function(){return 0===this.staffItems.length?this.t("tacheComp.add"):this.t("tacheComp.update")},showPlaceholder:function(){return 0===this.staffItems.length&&this.placeholder}},created:function(){var t=this;this.value&&O({staffIds:this.value}).then(function(e){t.staffItems=e})},methods:{handleClose:function(t){this.staffItems=this.staffItems.filter(function(e){return e.STAFF_ID!==t.STAFF_ID});var e=this.staffItems.map(function(t){return t.STAFF_ID}).join(",");this.$emit("input",e)},openStaffDialog:function(){var t={multiple:!0,confirmCallBack:this.staffInfoCallBack},e=vo(t);e.setPersons(this.staffItems);var i=null,n=!1;"0BT"===this.rootOrgCanChange?(i=this.beginOrg?"".concat(this.beginOrg):null,n=!i):(i=this.rootOrg?"".concat(this.rootOrg):null,n=!1),e.setChoiceSourceTreeConfig({organization:{startPathIds:i,selectedOrgID:this.rootOrg,isTop:n,hidden:!["","2"].includes(this.staffCreateType)},project:{startPathIds:i,selectedOrgID:this.rootOrg,isTop:n,hidden:!["","3"].includes(this.staffCreateType)},dutyLine:{hidden:!0},projectDefined:{hidden:!0}}),e.show()},staffInfoCallBack:function(t){var e=t.map(function(t){return t.STAFF_ID}).join(",");this.staffItems=t,this.$emit("input",e)}}},xo=bo,Ao=(i("cab6"),B(xo,yo,wo,!1,null,"d38bf084",null)),Co=Ao.exports,To=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("fi-row",[i("fi-col",{attrs:{span:24,id:"tachecfg"}},[i("div",{staticClass:"regular-title"},[0==t.foldingLayer.length?i("span",{staticClass:"regular-title-span"},[t._v(t._s(t.t("tacheComp.notRule")))]):i("tch-regular",{attrs:{foldingLayer:t.foldingLayer,dirCondition:t.dirCondition,type:t.type,tacheRule:t.tacheRule,node:t.node,disabled:t.disabled}})],1)]),i("div",[i("fi-dialog",{staticClass:"publicDialog",attrs:{title:"提示","close-on-click-modal":!1,"close-on-press-escape":!1,visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[i("span",[i("span",{staticClass:"ruleTip"},[i("i",{staticClass:"el-icon-warning"})]),i("span",{staticStyle:{color:"#666666"}},[t._v(t._s(t.t("tacheComp.defaultRule")))]),i("p",{staticClass:"ruleTip2"},[t._v(t._s(t.t("tacheComp.delRule")))])]),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("fi-button",{attrs:{type:"primary"},on:{click:function(e){t.dialogVisible=!1}}},[t._v(t._s(t.t("tacheComp.know")))])],1)])],1)],1)},ko=[],So=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("section",{attrs:{id:"tchRegular"}},[0!=t.foldingLayer.length?i("fi-collapse",{attrs:{accordion:""},on:{change:t.loadChangeTitle},model:{value:t.currentCollapse,callback:function(e){t.currentCollapse=e},expression:"currentCollapse"}},t._l(t.foldingLayer,function(e,n){return i("fi-collapse-item",{key:n,attrs:{name:n}},[i("template",{slot:"title"},[""!=e.conditionDesc||e.isSetDeRult?t._e():i("span",{staticClass:"case-layout-title"},[t._v(t._s(t.t("tacheComp.editRule")))]),""!=e.conditionDesc||e.isSetDeRult?i("span",{staticClass:"case-layout-title",attrs:{title:e.conditionTypeDesc+e.conditionDesc}},[e.isSetDeRult?i("fi-button",{attrs:{type:"text"}},[t._v("（"+t._s(t.$i18n&&"en"===t.$i18n.locale?"Default":"默认")+"）")]):t._e(),t._v(t._s(e.conditionTypeDesc)+t._s(e.conditionDesc))],1):t._e(),t.disabled?t._e():i("i",{staticClass:"el-icon-delete",staticStyle:{color:"#999999"},on:{click:function(e){return e.stopPropagation(),t.removeFoldingLayes(n)}}})]),16!=e.resultType?i("fi-row",[i("regular-condition",{attrs:{type:t.type,foldingLayes:e,foldingLayer:t.foldingLayer,disabled:t.disabled,Layindex:n,dirCondition:t.dirCondition}}),2==t.type||4==t.type||5==t.type?i("regular-staff",{attrs:{type:t.type,foldingLayes:e,foldingLayer:t.foldingLayer,Layindex:n,dirCondition:t.dirCondition,disabled:t.disabled}}):t._e()],1):t._e(),1==t.type&&16!=e.resultType?i("fi-row",[i("regular-option",{attrs:{foldingLayes:e,dirCondition:t.dirCondition,tacheRule:t.tacheRule,disabled:t.disabled}})],1):t._e()],2)}),1):t._e()],1)},Eo=[],Io=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("section",{attrs:{id:"regularStaff"}},[i("div",[t.type-5!=0?i("fi-row",{staticClass:"case-margin-t"},[i("fi-col",{staticClass:"case-title-line",attrs:{span:t.$i18n&&"en"===t.$i18n.locale?8:4}},[i("span",[t._v(t._s(t.t("tacheComp.staffSelectAttr"))+"：")])]),i("fi-col",{attrs:{span:1}},[i("fi-row",{staticClass:"case-title-line"},[i("fi-checkbox",{attrs:{"true-label":"T","false-label":"F"},model:{value:t.foldingLayes.isCanChange,callback:function(e){t.$set(t.foldingLayes,"isCanChange",e)},expression:"foldingLayes.isCanChange"}})],1)],1),i("fi-col",{staticClass:"case-title-line",attrs:{span:9}},[i("span",[t._v(t._s(t.t("tacheComp.allowByOrg")))])])],1):t._e(),t.type-5==0||"T"==t.foldingLayes.isCanChange?i("fi-row",{staticClass:"case-margin-t",staticStyle:{border:"1px solid #bfcbd9","margin-top":"10px","border-radius":"3px"}},[i("fi-row",{staticStyle:{padding:"15px"}},[i("fi-row",[i("fi-col",{staticClass:"case-title-line",attrs:{span:t.$i18n&&"en"===t.$i18n.locale?9:4}},[i("span",[t._v(t._s(t.t("tacheComp.orgSelType"))+"：")])]),i("fi-col",{attrs:{span:t.$i18n&&"en"===t.$i18n.locale?15:20}},[i("fi-row",[i("fi-col",{attrs:{span:8}},[i("fi-select",{attrs:{size:"small"},on:{change:function(e){return t.showChoiceDetail()}},model:{value:t.foldingLayes.choiceWay,callback:function(e){t.$set(t.foldingLayes,"choiceWay",e)},expression:"foldingLayes.choiceWay"}},t._l(t.commonData.staffChoiceWayList,function(t,e){return i("fi-option",{key:e,attrs:{label:t.text,value:t.value}})}),1)],1),t.type-5!=0?i("fi-col",{staticClass:"case-padding-f",attrs:{span:16}},[i("fi-select",{attrs:{size:"small"},model:{value:t.foldingLayes.filterWay,callback:function(e){t.$set(t.foldingLayes,"filterWay",e)},expression:"foldingLayes.filterWay"}},t._l(t.commonData.staffChoiceWay,function(t,e){return i("fi-option",{key:e,attrs:{label:t.text,value:t.value}})}),1)],1):t._e()],1)],1)],1),""==t.foldingLayes.choiceWay||"2"!=t.type&&"5"!=t.type?t._e():i("fi-row",{staticClass:"case-margin-t"},[i("fi-col",{staticClass:"case-title-line",attrs:{span:t.$i18n&&"en"===t.$i18n.locale?6:4}},[i("span",[t._v(t._s(t.t("tacheComp.orgScope"))+"：")])]),i("fi-col",{attrs:{span:20}},[i("fi-row",[i("fi-col",{attrs:{span:8}},[i("fi-select",{attrs:{size:"small"},on:{change:t.clearDealFar},model:{value:t.foldingLayes.orgFarWay,callback:function(e){t.$set(t.foldingLayes,"orgFarWay",e)},expression:"foldingLayes.orgFarWay"}},t._l(t.commonData.farChoiceStyle,function(t,e){return i("fi-option",{key:e,attrs:{label:t.text,value:t.value}})}),1)],1),t.foldingLayes.orgFarWay-1==0?i("fi-col",{staticClass:"case-padding-f",attrs:{span:16}},[i("processing-scope",{attrs:{editable:!0,type:t.foldingLayes.choiceWay,disabled:t.disabled,placeholder:t.t("options.beginOrgValue")},on:{change:t.changeNodeFun},model:{value:t.foldingLayes.dealFar,callback:function(e){t.$set(t.foldingLayes,"dealFar",e)},expression:"foldingLayes.dealFar"}})],1):t._e()],1)],1)],1),""!=t.foldingLayes.choiceWay&&t.foldingLayes.orgFarWay-2!=0?i("fi-row",{staticClass:"case-margin-t"},[i("fi-col",{staticClass:"case-title-line",attrs:{span:t.$i18n&&"en"===t.$i18n.locale?9:4}},[i("span",[t._v(t._s(t.t("tacheComp.openOrg"))+"：")])]),i("fi-col",{attrs:{span:20}},[i("fi-row",[i("fi-col",{attrs:{span:8}},[i("fi-select",{attrs:{size:"small"},on:{change:t.clearDealNode},model:{value:t.foldingLayes.orgNodeWay,callback:function(e){t.$set(t.foldingLayes,"orgNodeWay",e)},expression:"foldingLayes.orgNodeWay"}},t._l(t.commonData.farChoiceStyle,function(t,e){return i("fi-option",{key:e,attrs:{label:t.text,value:t.value}})}),1)],1),t.foldingLayes.orgNodeWay-1==0?i("fi-col",{staticClass:"case-padding-f",attrs:{span:16}},[i("processing-scope",{attrs:{editable:!0,type:t.foldingLayes.choiceWay,startPathsVal:t.foldingLayes.dealFar,isStartParth:!1,disabled:t.disabled,placeholder:t.t("options.errorMessage1")},model:{value:t.foldingLayes.dealNode,callback:function(e){t.$set(t.foldingLayes,"dealNode",e)},expression:"foldingLayes.dealNode"}})],1):t._e()],1)],1)],1):t._e()],1)],1):t._e(),t.type-5!=0?i("fi-row",{staticClass:"case-margin-t"},[i("fi-col",{staticClass:"case-title-line",attrs:{span:4}},[i("span",[t._v(t._s(t.t("options.defaultHander")))])]),i("fi-col",{attrs:{span:20}},[i("fi-row",[i("fi-col",{attrs:{span:8}},[i("div",[i("fi-select",{attrs:{size:"small",placeholder:t.t("options.placeHolder")},model:{value:t.foldingLayes.dealWay,callback:function(e){t.$set(t.foldingLayes,"dealWay",e)},expression:"foldingLayes.dealWay"}},t._l(t.commonData.staffChoiceStyle,function(t){return i("fi-option",{key:t.value,attrs:{label:t.text,value:t.value}})}),1)],1)]),"fromOrg"==t.foldingLayes.dealWay?i("fi-col",{staticClass:"case-padding-f",attrs:{span:16}},[i("choic-staff",{attrs:{foldingLayes:t.foldingLayes,staffArr:t.foldingLayes.staff,disabled:t.disabled},on:{getResultStaff:function(e){return t.setDealStaff(e,t.foldingLayes)}}})],1):t._e(),"fromFlow"==t.foldingLayes.dealWay?i("fi-col",{staticClass:"case-padding-f",attrs:{span:8}},[i("fi-select",{attrs:{size:"small",placeholder:t.t("options.placeHolder")},on:{change:function(e){return t.flowMultiChioce(t.Layindex)}},model:{value:t.foldingLayes.selectBox,callback:function(e){t.$set(t.foldingLayes,"selectBox",e)},expression:"foldingLayes.selectBox"}},t._l(t.commonData.flowInstance,function(t,e){return i("fi-option",{key:e,attrs:{label:t.text,value:t.value}})}),1)],1):t._e(),"fromFlow"==t.foldingLayes.dealWay&&t.foldingLayes.selectBox-1==0?i("fi-col",{staticClass:"case-padding-f",attrs:{span:8}},[i("fi-select",{attrs:{size:"small",placeholder:t.t("options.placeHolder")},model:{value:t.foldingLayes.selectValue,callback:function(e){t.$set(t.foldingLayes,"selectValue",e)},expression:"foldingLayes.selectValue"}},t._l(t.commonData.flowStart,function(t,e){return i("fi-option",{key:e,attrs:{label:t.text,value:t.value}})}),1)],1):t._e(),"fromFlow"==t.foldingLayes.dealWay&&t.foldingLayes.selectBox-2==0?i("fi-col",{staticClass:"case-padding-f",attrs:{span:8}},[i("fi-select",{attrs:{size:"small",placeholder:t.t("options.placeHolder")},model:{value:t.foldingLayes.selectValue,callback:function(e){t.$set(t.foldingLayes,"selectValue",e)},expression:"foldingLayes.selectValue"}},t._l(t.commonData.preTacheDeal,function(t,e){return i("fi-option",{key:e,attrs:{label:t.text,value:t.value}})}),1)],1):t._e(),"fromFlow"==t.foldingLayes.dealWay&&t.foldingLayes.selectBox-3==0?i("fi-col",{staticClass:"case-padding-f",attrs:{span:8}},[i("fi-cascader",{staticClass:"cascaderCss",attrs:{options:t.dirCondition.relationFlow,filterable:"","show-all-levels":!1},model:{value:t.foldingLayes.selectArray,callback:function(e){t.$set(t.foldingLayes,"selectArray",e)},expression:"foldingLayes.selectArray"}})],1):t._e()],1)],1)],1):t._e(),t.type-5!=0?i("fi-row",{staticClass:"case-margin-t"},[i("fi-col",{staticClass:"case-title-line",attrs:{span:t.$i18n&&"en"===t.$i18n.locale?9:4}},[i("span",[t._v("\n                  "+t._s(t.t("tacheComp.recommendHander"))+"\n                  "),i("fi-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"bottom"}},[i("div",{attrs:{slot:"content"},slot:"content"},[i("div",[t._v(" "+t._s(t.t("tacheComp.recommendMessage1")))]),i("div",[t._v(" "+t._s(t.t("tacheComp.recommendMessage2")))]),i("div",[t._v(" "+t._s(t.t("tacheComp.recommendMessage3")))]),i("div",[t._v(" "+t._s(t.t("tacheComp.recommendMessage4")))])]),i("i",{staticClass:"el-icon-question regular-header-tool"})])],1)]),i("fi-col",{attrs:{span:20}},[i("fi-row",[i("fi-col",{attrs:{span:8}},[i("div",[i("fi-select",{attrs:{size:"small",placeholder:t.t("options.placeHolder")},model:{value:t.foldingLayes.recommendWay,callback:function(e){t.$set(t.foldingLayes,"recommendWay",e)},expression:"foldingLayes.recommendWay"}},t._l(t.commonData.staffChoiceStyle,function(t){return i("fi-option",{key:t.value,attrs:{label:t.text,value:t.value}})}),1)],1)]),"fromOrg"==t.foldingLayes.recommendWay?i("fi-col",{staticClass:"case-padding-f",attrs:{span:16}},[i("choic-staff",{attrs:{foldingLayes:t.foldingLayes,staffArr:t.foldingLayes.recommendStaffArr,disabled:t.disabled},on:{getResultStaff:function(e){return t.setCommendStaff(e,t.foldingLayes)}}})],1):t._e(),"fromFlow"==t.foldingLayes.recommendWay?i("fi-col",{staticClass:"case-padding-f",attrs:{span:8}},[i("fi-select",{attrs:{size:"small",placeholder:t.t("options.placeHolder")},on:{change:function(e){t.foldingLayes.recommendStaffValue=""}},model:{value:t.foldingLayes.recommendBox,callback:function(e){t.$set(t.foldingLayes,"recommendBox",e)},expression:"foldingLayes.recommendBox"}},t._l(t.commonData.flowInstance,function(t,e){return i("fi-option",{key:e,attrs:{label:t.text,value:t.value}})}),1)],1):t._e(),"fromFlow"==t.foldingLayes.recommendWay&&t.foldingLayes.recommendBox-1==0?i("fi-col",{staticClass:"case-padding-f",attrs:{span:8}},[i("fi-select",{attrs:{size:"small",placeholder:t.t("options.placeHolder")},model:{value:t.foldingLayes.recommendStaffValue,callback:function(e){t.$set(t.foldingLayes,"recommendStaffValue",e)},expression:"foldingLayes.recommendStaffValue"}},t._l(t.commonData.flowStart,function(t,e){return i("fi-option",{key:e,attrs:{label:t.text,value:t.value}})}),1)],1):t._e(),"fromFlow"==t.foldingLayes.recommendWay&&t.foldingLayes.recommendBox-2==0?i("fi-col",{staticClass:"case-padding-f",attrs:{span:8}},[i("fi-select",{attrs:{size:"small",placeholder:t.t("options.placeHolder")},model:{value:t.foldingLayes.recommendStaffValue,callback:function(e){t.$set(t.foldingLayes,"recommendStaffValue",e)},expression:"foldingLayes.recommendStaffValue"}},t._l(t.commonData.preTacheDeal,function(t,e){return i("fi-option",{key:e,attrs:{label:t.text,value:t.value}})}),1)],1):t._e(),"fromFlow"==t.foldingLayes.recommendWay&&t.foldingLayes.recommendBox-3==0?i("fi-col",{staticClass:"case-padding-f",attrs:{span:8}},[i("fi-cascader",{staticClass:"cascaderCss",attrs:{size:"small",options:t.dirCondition.relationFlow,filterable:"","show-all-levels":!1},model:{value:t.foldingLayes.recommendArray,callback:function(e){t.$set(t.foldingLayes,"recommendArray",e)},expression:"foldingLayes.recommendArray"}})],1):t._e()],1)],1)],1):t._e()],1)])},Lo=[],Ro={loadCommonData:function(t){return{flowInstance:[{value:"1",text:t("commonData.flowStaff")},{value:"2",text:t("commonData.lastTacheStaff")},{value:"3",text:t("commonData.relFlow")}],flowStart:[{value:"1",text:t("commonData.leader")},{value:"2",text:t("commonData.depAllPeople")},{value:"3",text:t("commonData.startPeople")}],preTacheDeal:[{value:"1",text:t("commonData.leader")},{value:"2",text:t("commonData.depAllPeople")}],nextDimenSionType:[{value:"form",text:t("commonData.formDim")},{value:"tache",text:t("commonData.tacheDim")},{value:"staff",text:t("commonData.handerDim")}],DimenSionType:[{value:"form",text:t("commonData.formDim")},{value:"tache",text:t("commonData.tacheDim")},{value:"staff",text:t("commonData.handerDim")}],conditionType:[{value:"===",text:t("commonData.equal")},{value:"!==",text:t("commonData.noEqual")},{value:"<",text:t("commonData.xiaoyu")},{value:">",text:t("commonData.dayu")},{value:"<=",text:t("commonData.smallOrEqual")},{value:">=",text:t("commonData.bigOrEqual")},{value:"include",text:t("commonData.include")},{value:"noinclude",text:t("commonData.noinclude")},{value:"inlist",text:t("commonData.inlist")},{value:"noinlist",text:t("commonData.noinlist")}],conditionType1:[{value:"===",text:t("commonData.equal")},{value:"!==",text:t("commonData.noEqual")},{value:"<",text:t("commonData.xiaoyu")},{value:">",text:t("commonData.dayu")},{value:"<=",text:t("commonData.smallOrEqual")},{value:">=",text:t("commonData.bigOrEqual")}],conditionType6:[{value:"===",text:t("commonData.equal")},{value:"!==",text:t("commonData.noEqual")},{value:"include",text:t("commonData.include")},{value:"noinclude",text:t("commonData.noinclude")},{value:"inlist",text:t("commonData.inlist")},{value:"noinlist",text:t("commonData.noinlist")}],conditionType2:[{value:"===",text:t("commonData.equal")},{value:"!==",text:t("commonData.noEqual")}],conditionType3:[{value:"===",text:t("commonData.equal")},{value:"!==",text:t("commonData.noEqual")},{value:"include",text:t("commonData.include")},{value:"noinclude",text:t("commonData.noinclude")}],conditionType4:[{value:"===",text:t("commonData.equal")},{value:"!==",text:t("commonData.noEqual")},{value:"include",text:t("commonData.include")},{value:"noinclude",text:t("commonData.noinclude")},{value:"in-org",text:t("commonData.haveChildLevel")},{value:"notin-org",text:t("commonData.nohaveChildLevel")}],conditionType5:[{value:"===",text:t("commonData.equal")},{value:"!==",text:t("commonData.noEqual")},{value:"in-org",text:t("commonData.haveChildLevel")},{value:"notin-org",text:t("commonData.nohaveChildLevel")}],conditionTypeAll:[{value:"===",text:t("commonData.equal")},{value:"!==",text:t("commonData.noEqual")},{value:"<",text:t("commonData.xiaoyu")},{value:">",text:t("commonData.dayu")},{value:"<=",text:t("commonData.smallOrEqual")},{value:">=",text:t("commonData.bigOrEqual")},{value:"include",text:t("commonData.include")},{value:"noinclude",text:t("commonData.noinclude")},{value:"inlist",text:t("commonData.inlist")},{value:"noinlist",text:t("commonData.noinlist")},{value:"in-org",text:t("commonData.haveChildLevel")},{value:"notin-org",text:t("commonData.nohaveChildLevel")}],staffChoiceStyle:[{value:"fromOrg",text:t("commonData.orgSelect")},{value:"fromFlow",text:t("commonData.getFlow")}],groupRoleChoice:[{value:"1",text:t("commonData.staff")},{value:"2",text:t("commonData.officeLeader")},{value:"3",text:t("commonData.manager")}],stffDimenSion:[{paramCompCode:"GLOBAL_VAR.STAFF_ID",paramCompName:t("commonData.lastTacheStaff")},{paramCompCode:"GLOBAL_VAR.ORG_ID",paramCompName:t("commonData.lastTacheStaffOrg")},{paramCompCode:"GLOBAL_VAR.REGION_ID",paramCompName:t("commonData.lastTacheStaffRegion")}],tacheDimension:[{paramCompCode:"FLOW.TCH_NUM",paramCompName:t("commonData.lastTache")},{paramCompCode:"TACHE.ACTION",paramCompName:t("commonData.lastTchAction")}],nextTacheDimension:[{paramCompCode:"preTchMod",paramCompName:t("commonData.lastTache")},{paramCompCode:"preTchAction",paramCompName:t("commonData.lastTchAction")}],nextTacheAction:[{value:1,text:t("commonData.goto")},{value:2,text:t("commonData.backto")},{value:3,text:t("commonData.transfer")}],tacheAction:[{value:"run",text:t("commonData.goto")},{value:"return",text:t("commonData.backto")},{value:"transfer",text:t("commonData.transfer")}],condition:[{value:"1",text:t("commonData.allMeet")},{value:"2",text:t("commonData.arbSatify")}],staffChoiceWayList:[{value:"",text:t("commonData.allOrg")},{value:"2",text:t("commonData.staffDep")},{value:"3",text:t("commonData.team")}],staffChoiceWay:[{value:"1",text:t("commonData.noFilterRule")},{value:"2",text:t("commonData.filterLeader")}],farChoiceStyle:[{value:"1",text:t("commonData.orgSelect")},{value:"2",text:t("commonData.handlerDep")}]}},loadTreeData:function(t){return On({url:"/flow/flowCfgRulesController/loadTreeData",method:"get",params:t})},loadFlowInfo:function(t){return On({url:"/flow/flowCfgRulesController/loadFlowInfo",method:"get",params:t})},loadTchInfo:function(t){return On({url:"/flow/flowCfgRulesController/loadTchInfo",method:"get",params:t})},loadHistoryData:function(t){return On({url:"/flow/flowCfgRulesController/loadHistoryData",method:"get",params:t})},loadDimensionType:function(t){return On({url:"/flow/flowCfgRulesController/loadDimensionType",method:"get",params:t})},loadInitSqlInfo:function(t){return On({url:"/flow/flowCfgRulesController/loadInitSqlInfo",method:"get",params:t})},loadOrgTreeData:function(){return On({url:"/flow/flowCfgRulesController/loadOrgTreeData",method:"get"})},loadRegionTreeData:function(){return On({url:"/flow/flowCfgRulesController/loadRegionTreeData",method:"get"})},getCallbackTacheInfo:function(t){return On({url:"/flow/flowCfgRulesController/getCallbackTacheInfo",method:"get",params:t})},commitRules:function(t){return On({url:"/flow/flowCfgRulesController/commitRules",method:"post",params:t})},editRules:function(t){return On({url:"/flow/flowCfgRulesController/editRules",method:"post",params:t})},getRevisionIdByTchMod:function(t){return On({url:"/flow/flowCfgRulesController/getRevisionIdByTchMod",method:"get",params:t})},deleteRules:function(t){return On({url:"/flow/flowCfgRulesController/deleteRules",method:"post",params:t})},deleteAlarmRules:function(t){return On({url:"/flow/flowCfgRulesController/deleteAlarmRules",method:"post",params:t})},saveOperaInfo:function(t){return On({url:"/flow/flowCfgRulesController/saveOperaInfo",method:"post",params:t})},saveAlarmCfgRule:function(t){return On({url:"/flow/flowCfgRulesController/saveAlarmCfgRule",method:"post",params:t})},saveStaffRules:function(t){return On({url:"/flow/flowCfgRulesController/saveStaffRules",method:"post",params:t})},saveTacheRules:function(t){return On({url:"/flow/flowCfgRulesController/saveTacheRules",method:"post",params:t})},updateRules:function(t){return On({url:"/flow/flowCfgRulesController/updateRules",method:"get",params:{data:t}})},upgradeRule:function(t){return On({url:"/flow/flowCfgRulesController/upgradeRule",method:"post",params:t})},degradeRule:function(t){return On({url:"/flow/flowCfgRulesController/degradeRule",method:"post",params:t})},loadAlarmRules:function(t){return On({url:"/flow/flowCfgRulesController/loadAlarmRules",method:"get",params:t})},getCountRule:function(t){return On({url:"/flow/flowCfgRulesController/getCountRule",method:"get",params:t})},loadMultiOpinion:function(t){return On({url:"/flow/flowCfgRulesController/loadMultiOpinion",method:"get",params:t})},getTacheByTchMod:function(t){return On({url:"/flow/flowCfgRulesController/getTacheByTchMod",method:"get",params:t})},commitTacheRulesSteps:function(t){return On({url:"/flow/flowCfgRulesController/commitTacheRulesSteps",method:"post",params:t})},commitRulesStaffSteps:function(t){return On({url:"/flow/flowCfgRulesController/commitRulesStaffSteps",method:"post",data:t})},unDoedit:function(t){return On({url:"/flow/flowCfgRulesController/unDoedit",method:"post",params:t})},loadInitData:function(t){return On({url:"/flow/flowNewCfgRulesController/loadInitCommonData",method:"get",params:t})},deleteRuleExitPck:function(t){return On({url:"/flow/flowCfgRulesController/deleteRuleExitPck",method:"post",data:t})},commitDefault:function(t){return On({url:"/flow/flowCfgRulesController/commitDefault",method:"get",params:t})},loadAllFlowModel:function(t){return On({url:"/flow/flowCfgRulesController/loadAllFlowModel",method:"get",params:{data:t}})},loadDutyInfoByPage:function(t){return On({url:"/flow/flowCfgRulesController/loadDutyInfoByPage",method:"get",params:t})},loadProjectGroupByPage:function(t){return On({url:"/flow/flowCfgRulesController/loadProjectGroupByPage",method:"get",params:t})},loadAllOrgData:function(t){return On({url:"/flow/flowCfgRulesController/loadAllOrgData",method:"get",params:{data:t}})},revisionDate:function(t){return On({url:"/flow/flowCfgRulesController/revisionDate",method:"get",params:t})},loadTacheAttrInfo:function(t){return On({url:"/flow/flowCfgRulesController/loadTacheAttrInfo",method:"get",params:t})},moveRules:function(t){return On({url:"/flow/flowCfgRulesController/moveRules",method:"get",params:t})},getUserOrgInfo:function(t){return On({url:"/security/orgs",method:"get",params:t})},getFlowUrlByFlowMod:function(t){return On({url:"/flow/flowCfgRulesController/getFlowUrlByFlowMod",method:"get",params:t})},loadTransferData:function(t){return On({url:"/flow/flowCfgRulesController/loadTransferData",method:"get",params:t})},saveNewStaffRules:function(t){return On({url:"/flow/flowNewCfgRulesController/saveNewStaffRules",method:"post",data:t})},setSqlToTree:function(t){return On({url:"/formComponent/setSqlToTree",method:"post",data:t})},getTreeByDomainType:function(t){return On({url:"/form/common/treeCofigController/getTreeModel",method:"get",params:t})}},Po=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("section",{attrs:{id:"tchChoicStaff"}},[i("fi-row",[i("fi-col",{staticClass:"staff-content",attrs:{span:24}},[i("fi-row",{staticStyle:{position:"relative"}},[i("fi-row",{directives:[{name:"show",rawName:"v-show",value:t.showStaffCase,expression:"showStaffCase"}],staticClass:"staff-select-tab"},[i("fi-scrollbar",{style:{height:32*t.staffArr.length+"px","max-height":"220px"},nativeOn:{mouseover:function(e){t.showStaffCase=!0},mouseout:function(e){t.showStaffCase=!1}}},t._l(t.staffArr,function(e,n){return i("fi-row",{key:n,staticClass:"staff-select-row"},[i("fi-col",{staticStyle:{"padding-left":"20px"},attrs:{span:22}},[t._v(t._s(e.name))]),i("fi-col",{attrs:{span:2}},[t.disabled?t._e():i("i",{staticClass:"el-icon-close",on:{click:function(i){return t.handleClose(t.staffArr,e.id)}}})])],1)}),1)],1),i("fi-row",[i("fi-col",{staticClass:"staff-header",attrs:{span:20}},[i("div",[0==t.staffArr.length?i("div",{staticClass:"staff-holder"},[t._v(t._s(t.t("tacheComp.chooseHander")))]):i("div",[i("fi-tag",{staticClass:"tag-line",attrs:{size:"small",type:"info",closable:!t.disabled,"disable-transitions":!1},on:{close:function(e){return t.handleClose(t.staffArr,t.staffArr[0].id)}}},[i("span",{staticStyle:{"max-width":"65px",float:"left",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap"}},[t._v(t._s(t.staffArr[0].name))])]),t.staffArr.length>1?i("fi-tag",{staticClass:"tag-line",attrs:{size:"small",type:"info",closable:!t.disabled,"disable-transitions":!1},on:{close:function(e){return t.handleClose(t.staffArr,t.staffArr[1].id)}}},[i("span",{staticStyle:{"max-width":"65px",float:"left",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap"}},[t._v(t._s(t.staffArr[1].name))])]):t._e(),t.staffArr.length>2?i("fi-tag",{staticClass:"tag-line cur-link",attrs:{type:"info"},on:{click:t.showStaffFun}},[i("span",[t._v("+"+t._s(t.staffArr.length-2))])]):t._e()],1)])]),i("fi-col",{staticStyle:{"line-height":"32px","text-align":"right","padding-right":"10px"},attrs:{span:4}},[i("fi-button",{attrs:{type:"text",size:"small"},on:{click:t.orgMultiChioce}},[t._v(t._s(t.t("tacheComp.add")))])],1)],1)],1)],1)],1)],1)},Oo=[],Do=i("2166"),Mo={name:"tchChoicStaff",mixins:[bn.localeMixin],props:["foldingLayes","staffArr","disabled"],data:function(){return{showStaffCase:!1}},methods:{orgMultiChioce:function(){this.foldingLayes.selectBox=1,this.showStaffChoice()},showStaffChoice:function(){var t=this,e=new Do.StaffSelectAddonExtends({multiple:!0,confirmCallBack:function(e){for(var i=[],n=0;n<e.length;n++){var o=e[n].STAFF_ID,r=e[n].STAFF_NAME,a={id:o,name:r,type:"staff"};i.push(a)}t.$emit("getResultStaff",Array.from(new Set(i)))}}),i=null===t.foldingLayes.dealFar||""===t.foldingLayes.dealFar||"F"===t.foldingLayes.isCanChange;if(t.foldingLayes.choiceWay-3==0?e.setChoiceSourceTreeConfig({project:{startPathIds:i?null:"".concat(t.foldingLayes.dealFar),selectedOrgID:t.foldingLayes.dealNode,isTop:i},organization:{hidden:!0},dutyLine:{hidden:!0},projectDefined:{hidden:!0}}):t.foldingLayes.choiceWay-2==0?e.setChoiceSourceTreeConfig({organization:{startPathIds:i?null:"".concat(t.foldingLayes.dealFar),selectedOrgID:t.foldingLayes.dealNode,isTop:i},project:{hidden:!0},dutyLine:{hidden:!0},projectDefined:{hidden:!0}}):e.setChoiceSourceTreeConfig({organization:{startPathIds:i?null:"".concat(t.foldingLayes.dealFar),selectedOrgID:t.foldingLayes.dealNode,isTop:i},dutyLine:{hidden:!0}}),Array.isArray(t.staffArr)&&t.staffArr.length>0){var n=t.staffArr.map(function(t){return{STAFF_ID:t.id,STAFF_NAME:t.name}});e.setPersons(n)}e.show()},handleClose:function(t,e){if(this.disabled)return!1;var i=t.findIndex(function(t){return t.id-e==0});return i>-1&&(t.splice(i,1),this.$emit("getResultStaff",Array.from(new Set(t)))),0===t.length&&(this.showStaffCase=!1),!0},showStaffFun:function(){this.showStaffCase=!this.showStaffCase}}},No=Mo,Bo=(i("d880"),B(No,Po,Oo,!1,null,null,null)),Fo=Bo.exports,zo={name:"regularCondition",mixins:[bn.localeMixin],props:["foldingLayes","dirCondition","Layindex","foldingLayer","type","disabled"],data:function(){return{commonData:{},staffDefault:[],showStaffCase:!1,currentDealFar:""}},components:{ProcessingScope:_o,choicStaff:Fo},created:function(){this.commonData=Ro.loadCommonData(this.t),this.currentDealFar=this.foldingLayer[this.Layindex].dealFar},methods:{showChoiceDetail:function(){this.foldingLayes.orgFarWay="1",this.foldingLayes.orgNodeWay="1",this.foldingLayes.dealFar="",this.foldingLayes.dealNode="",null!=this.foldingLayes.staff&&(this.foldingLayes.staff=[]),null!=this.foldingLayes.recommendStaffArr&&(this.foldingLayes.recommendStaffArr=[])},clearDealNode:function(t){t-1!=0&&(this.foldingLayes.dealNode="")},clearDealFar:function(t){t-1!=0&&(this.foldingLayes.dealFar="",this.foldingLayes.orgNodeWay="1",this.foldingLayes.dealNode="")},flowMultiChioce:function(t){this.foldingLayer[t].selectValue=""},changeNodeFun:function(){this.currentDealFar!==this.foldingLayes.dealFar&&(this.foldingLayes.dealNode="",this.currentDealFar=this.foldingLayes.dealFar)},setDealStaff:function(t,e){e.staff=t,e.dealStaff=JSON.stringify(t)},setCommendStaff:function(t,e){e.recommendStaffArr=t,e.recommendStaff=JSON.stringify(t)}}},Vo=zo,Uo=(i("6678"),B(Vo,Io,Lo,!1,null,null,null)),jo=Uo.exports,Ho=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{attrs:{id:"regularCondition"}},[n("div",[n("fi-row",{staticClass:"regular-header"},[n("fi-col",{staticClass:"regular-header-left",attrs:{span:"en"===t.$i18n.locale?7:3}},[n("span",[t._v(t._s(t.t("tacheComp.followCondition"))+":")])]),n("fi-col",{attrs:{span:9}},[n("span",[n("fi-select",{attrs:{slot:"prepend",size:"small",placeholder:t.t("options.placeHolder"),disabled:t.foldingLayes.isSetDeRult},slot:"prepend",model:{value:t.foldingLayes.conditionType,callback:function(e){t.$set(t.foldingLayes,"conditionType",e)},expression:"foldingLayes.conditionType"}},t._l(t.commonData.condition,function(t,e){return n("fi-option",{key:e,attrs:{label:t.text,value:t.value}})}),1)],1)]),n("fi-col",{attrs:{span:3}},[n("fi-button",{attrs:{type:"text",size:"small"},on:{click:function(e){return t.clearCondition(t.Layindex)}}},[t._v(t._s(t.t("tacheComp.clearConditions")))])],1),n("fi-col",{staticClass:"regular-header-right",attrs:{span:"en"===t.$i18n.locale?7:9}},[n("span",[n("span",[n("fi-checkbox",{on:{change:function(e){return t.setDefaultRule(e,t.Layindex)}},model:{value:t.foldingLayes.isSetDeRult,callback:function(e){t.$set(t.foldingLayes,"isSetDeRult",e)},expression:"foldingLayes.isSetDeRult"}},[n("span",{staticStyle:{"font-size":"13px"}},[t._v(t._s(t.t("tacheComp.setDefaultRule")))])])],1),n("fi-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.t("tacheComp.rule"),placement:"top-start"}},[n("i",{staticClass:"el-icon-question regular-header-tool"})])],1)])],1)],1),n("div",{staticClass:"regular-body"},t._l(t.foldingLayes.condition,function(e,o){return n("fi-row",{key:o,staticStyle:{margin:"15px 12px"}},[n("fi-col",{attrs:{span:22}},[n("fi-row",[2==t.type||4==t.type||5==t.type?n("fi-col",{attrs:{span:6}},[n("fi-select",{attrs:{size:"small",placeholder:t.t("options.placeHolder"),disabled:t.foldingLayes.isSetDeRult},on:{change:function(i){return t.callMethod(e)}},model:{value:e.type,callback:function(i){t.$set(e,"type",i)},expression:"ruleDatas.type"}},t._l(t.commonData.DimenSionType,function(t,e){return n("fi-option",{key:e,attrs:{label:t.text,value:t.value}})}),1)],1):n("fi-col",{attrs:{span:6}},[n("fi-select",{attrs:{size:"small",placeholder:t.t("options.placeHolder"),disabled:t.foldingLayes.isSetDeRult},on:{change:function(i){return t.callMethod(e)}},model:{value:e.type,callback:function(i){t.$set(e,"type",i)},expression:"ruleDatas.type"}},t._l(t.commonData.nextDimenSionType,function(t,e){return n("fi-option",{key:e,attrs:{label:t.text,value:t.value}})}),1)],1),"form"==e.type||""==e.type?n("fi-col",{staticClass:"case-padding-t",attrs:{span:6}},[n("fi-select",{staticClass:"w100",attrs:{size:"small",placeholder:t.t("options.placeHolder"),disabled:t.foldingLayes.isSetDeRult},on:{change:function(i){return t.getFouthData(e)}},model:{value:e.id,callback:function(i){t.$set(e,"id",i)},expression:"ruleDatas.id"}},t._l(t.dirCondition.loadDimenData,function(e){return n("fi-option-group",{key:e.label,attrs:{label:e.label}},t._l(e.children,function(t){return n("fi-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)}),1)],1):t._e(),"tache"==e.type&&[2,4].includes(t.type)?n("fi-col",{staticClass:"case-padding-t",attrs:{span:6}},[n("fi-select",{attrs:{size:"small",placeholder:t.t("options.placeHolder"),disabled:t.foldingLayes.isSetDeRult},on:{change:function(i){return t.getFouthData(e)}},model:{value:e.id,callback:function(i){t.$set(e,"id",i)},expression:"ruleDatas.id"}},t._l(t.commonData.tacheDimension,function(t,e){return n("fi-option",{key:e,attrs:{label:t.paramCompName,value:t.paramCompCode}})}),1)],1):t._e(),"tache"==e.type&&[1].includes(t.type)?n("fi-col",{staticClass:"case-padding-t",attrs:{span:6}},[n("fi-select",{attrs:{size:"small",placeholder:t.t("options.placeHolder"),disabled:t.foldingLayes.isSetDeRult},on:{change:function(i){return t.getFouthData(e)}},model:{value:e.id,callback:function(i){t.$set(e,"id",i)},expression:"ruleDatas.id"}},t._l(t.commonData.nextTacheDimension,function(t,e){return n("fi-option",{key:e,attrs:{label:t.paramCompName,value:t.paramCompCode}})}),1)],1):t._e(),"staff"==e.type?n("fi-col",{staticClass:"case-padding-t",attrs:{span:6}},[n("fi-select",{attrs:{size:"small",placeholder:t.t("options.placeHolder"),disabled:t.foldingLayes.isSetDeRult},on:{change:function(i){return t.getFouthData(e)}},model:{value:e.id,callback:function(i){t.$set(e,"id",i)},expression:"ruleDatas.id"}},[t._l(t.commonData.stffDimenSion,function(t,e){return n("fi-option",{key:e,attrs:{label:t.paramCompName,value:t.paramCompCode}})}),5==t.type?n("fi-option",{attrs:{label:"'"+t.t("tacheComp.previousRole")+"'",value:"GLOBAL_VAR.ROLE_GROUP"}}):t._e()],2)],1):t._e(),"form"==e.type&&["1","2","20"].includes(e.elementType)?n("fi-col",{staticClass:"case-padding-t",attrs:{span:6}},[n("fi-select",{attrs:{size:"small",placeholder:t.t("options.placeHolder"),disabled:t.foldingLayes.isSetDeRult},model:{value:e.oper,callback:function(i){t.$set(e,"oper",i)},expression:"ruleDatas.oper"}},t._l(t.commonData.conditionType,function(t,e){return n("fi-option",{key:e,attrs:{label:t.text,value:t.value}})}),1)],1):t._e(),"form"==e.type&&["3","4","6","7"].includes(e.elementType)?n("fi-col",{staticClass:"case-padding-t",attrs:{span:6}},[n("fi-select",{attrs:{size:"small",placeholder:t.t("options.placeHolder"),disabled:t.foldingLayes.isSetDeRult},model:{value:e.oper,callback:function(i){t.$set(e,"oper",i)},expression:"ruleDatas.oper"}},t._l(t.commonData.conditionType6,function(t,e){return n("fi-option",{key:e,attrs:{label:t.text,value:t.value}})}),1)],1):t._e(),"form"==e.type&&["8","23"].includes(e.elementType)?n("fi-col",{staticClass:"case-padding-t",attrs:{span:6}},[n("fi-select",{attrs:{size:"small",placeholder:t.t("options.placeHolder"),disabled:t.foldingLayes.isSetDeRult},model:{value:e.oper,callback:function(i){t.$set(e,"oper",i)},expression:"ruleDatas.oper"}},t._l(t.commonData.conditionType1,function(t,e){return n("fi-option",{key:e,attrs:{label:t.text,value:t.value}})}),1)],1):t._e(),"form"==e.type&&"37"==e.elementType||"tache"==e.type||"staff"==e.type&&"GLOBAL_VAR.ORG_ID"!=e.id||"region"==e.elementType?n("fi-col",{staticClass:"case-padding-t",attrs:{span:6}},[n("fi-select",{attrs:{size:"small",placeholder:t.t("options.placeHolder"),disabled:t.foldingLayes.isSetDeRult},model:{value:e.oper,callback:function(i){t.$set(e,"oper",i)},expression:"ruleDatas.oper"}},t._l(t.commonData.conditionType2,function(t,e){return n("fi-option",{key:e,attrs:{label:t.text,value:t.value}})}),1)],1):t._e(),"staff"==e.type&&"GLOBAL_VAR.ORG_ID"==e.id?n("fi-col",{staticClass:"case-padding-t",attrs:{span:6}},[n("fi-select",{attrs:{size:"small",placeholder:t.t("options.placeHolder"),disabled:t.foldingLayes.isSetDeRult},model:{value:e.oper,callback:function(i){t.$set(e,"oper",i)},expression:"ruleDatas.oper"}},t._l(t.commonData.conditionType5,function(t,e){return n("fi-option",{key:e,attrs:{label:t.text,value:t.value}})}),1)],1):t._e(),"form"==e.type&&["9","24","28","44"].includes(e.elementType)?n("fi-col",{staticClass:"case-padding-t",attrs:{span:6}},[n("fi-select",{attrs:{size:"small",placeholder:t.t("options.placeHolder"),disabled:t.foldingLayes.isSetDeRult},model:{value:e.oper,callback:function(i){t.$set(e,"oper",i)},expression:"ruleDatas.oper"}},t._l(t.commonData.conditionType3,function(t,e){return n("fi-option",{key:e,attrs:{label:t.text,value:t.value}})}),1)],1):t._e(),"form"==e.type&&"25"==e.elementType?n("fi-col",{staticClass:"case-padding-t",attrs:{span:6}},[n("fi-select",{attrs:{size:"small",placeholder:t.t("options.placeHolder"),disabled:t.foldingLayes.isSetDeRult},model:{value:e.oper,callback:function(i){t.$set(e,"oper",i)},expression:"ruleDatas.oper"}},t._l(t.commonData.conditionType4,function(t,e){return n("fi-option",{key:e,attrs:{label:t.text,value:t.value}})}),1)],1):t._e(),"form"==e.type&&["1","2","20"].includes(e.elementType)||""==e.id?n("fi-col",{staticClass:"case-padding-t",attrs:{span:6}},[n("span",{staticClass:"fi-input_public"},[n("fi-input",{attrs:{size:"small",placeholder:t.t("options.inputHolder"),disabled:t.foldingLayes.isSetDeRult},model:{value:e.value,callback:function(i){t.$set(e,"value",i)},expression:"ruleDatas.value"}})],1)]):t._e(),"form"==e.type&&["3","4","6","7","37"].includes(e.elementType)?n("fi-col",{staticClass:"case-padding-t",attrs:{span:6}},[n("fi-select",{attrs:{size:"small",multiple:!0,placeholder:t.t("options.placeHolder"),disabled:t.foldingLayes.isSetDeRult},model:{value:e.value,callback:function(i){t.$set(e,"value",i)},expression:"ruleDatas.value"}},t._l(e.initSqlArr,function(t,e){return n("fi-option",{key:e,attrs:{label:t.MEAN,value:t.CODE}})}),1)],1):t._e(),"form"==e.type&&"8"==e.elementType?n("fi-col",{staticClass:"case-padding-t",attrs:{span:6}},["TIME"==e.formatType||"time"==e.formatType?n("fi-time-picker",{staticStyle:{width:"auto"},attrs:{size:"small",format:"HH:mm:ss","value-format":"HH:mm:ss",placeholder:t.t("options.placeHolder"),disabled:t.foldingLayes.isSetDeRult},model:{value:e.value,callback:function(i){t.$set(e,"value",i)},expression:"ruleDatas.value"}}):"DATE"==e.formatType||"date"==e.formatType?n("fi-date-picker",{staticStyle:{width:"auto"},attrs:{size:"small",type:"date",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd",placeholder:t.t("options.placeHolder"),disabled:t.foldingLayes.isSetDeRult},model:{value:e.value,callback:function(i){t.$set(e,"value",i)},expression:"ruleDatas.value"}}):"MONTHS"==e.formatType||"months"==e.formatType?n("fi-date-picker",{staticStyle:{width:"auto"},attrs:{size:"small",type:"month",format:"yyyy-MM","value-format":"yyyy-MM",placeholder:t.t("options.placeHolder"),disabled:t.foldingLayes.isSetDeRult},model:{value:e.value,callback:function(i){t.$set(e,"value",i)},expression:"ruleDatas.value"}}):n("fi-date-picker",{staticStyle:{width:"auto"},attrs:{size:"small",type:"datetime",format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:t.t("options.placeHolder"),disabled:t.foldingLayes.isSetDeRult},model:{value:e.value,callback:function(i){t.$set(e,"value",i)},expression:"ruleDatas.value"}})],1):t._e(),"form"==e.type&&"9"==e.elementType?n("fi-col",{staticClass:"case-padding-t",attrs:{span:6}},[n("fi-cascader",{ref:"tree"+o,refInFor:!0,staticClass:"tree-cascader",attrs:{size:"small",options:e.initSqlArr,props:{multiple:!0,checkStrictly:!0},"show-all-levels":!1},on:{"visible-change":function(i){return t.handLabelToRule(o,e)},change:function(i){return t.changeToRule(i,o,e)}},model:{value:e.value,callback:function(i){t.$set(e,"value",i)},expression:"ruleDatas.value"}})],1):t._e(),"form"==e.type&&"23"==e.elementType?n("fi-col",{staticClass:"case-padding-t",attrs:{span:6}},[n("fi-input",{attrs:{size:"small",placeholder:t.t("options.inputHolder"),disabled:t.foldingLayes.isSetDeRult,type:"number"},model:{value:e.value,callback:function(i){t.$set(e,"value",i)},expression:"ruleDatas.value"}})],1):t._e(),"form"==e.type&&"24"==e.elementType?n("fi-col",{staticClass:"case-padding-t",attrs:{span:6}},[n("span",{staticClass:"fi-input_public",on:{click:function(i){return t.showStaffChoice(e,!0)}}},[n("fi-input",{attrs:{size:"small",placeholder:t.t("tacheComp.selectPerson"),readonly:""},model:{value:e.staffName,callback:function(i){t.$set(e,"staffName",i)},expression:"ruleDatas.staffName"}})],1)]):t._e(),"form"==e.type&&"25"==e.elementType?n("fi-col",{staticClass:"case-padding-t",attrs:{span:6}},[n("div",{on:{click:function(i){return t.openStaffOrg(e,!0)}}},[n("fi-input",{attrs:{size:"small",placeholder:t.t("tacheComp.selectDep"),disabled:t.foldingLayes.isSetDeRult},model:{value:e.valueName,callback:function(i){t.$set(e,"valueName",i)},expression:"ruleDatas.valueName"}})],1)]):t._e(),"form"==e.type&&"28"==e.elementType?n("fi-col",{staticClass:"case-padding-t",attrs:{span:6}},[n("ffitm-ne-choice",{staticClass:"ne-choice",attrs:{fullField:!1,multiple:!0},model:{value:e.value,callback:function(i){t.$set(e,"value",i)},expression:"ruleDatas.value"}})],1):t._e(),"form"==e.type&&"44"==e.elementType?n("fi-col",{staticClass:"case-padding-t",attrs:{span:6}},[n("fi-flow-select",{attrs:{multiple:!0},on:{change:function(i){return t.filterValue(e,e.elementType)}},model:{value:e.value,callback:function(i){t.$set(e,"value",i)},expression:"ruleDatas.value"}})],1):t._e(),"form"==e.type&&"region"==e.elementType?n("fi-col",{staticClass:"case-padding-t",attrs:{span:6}},[n("fi-type-tree",{staticStyle:{width:"100%"},attrs:{type:"REGION"},on:{"node-click":function(i){return t.changeArea(i,e)}},model:{value:e.value,callback:function(i){t.$set(e,"value",i)},expression:"ruleDatas.value"}})],1):t._e(),"staff"==e.type&&"GLOBAL_VAR.STAFF_ID"==e.id?n("fi-col",{staticClass:"case-padding-t",attrs:{span:6}},[n("span",{staticClass:"fi-input_public",on:{click:function(i){return t.showStaffChoice(e,!1)}}},[n("fi-input",{attrs:{size:"small",placeholder:t.t("tacheComp.selectPerson"),readonly:""},model:{value:e.staffName,callback:function(i){t.$set(e,"staffName",i)},expression:"ruleDatas.staffName"}})],1)]):t._e(),"staff"==e.type&&"GLOBAL_VAR.ORG_ID"==e.id?n("fi-col",{staticClass:"case-padding-t",attrs:{span:6}},[n("div",{on:{click:function(i){return t.openStaffOrg(e,!1)}}},[n("fi-input",{attrs:{size:"small",placeholder:t.t("tacheComp.selectDep"),disabled:t.foldingLayes.isSetDeRult},model:{value:e.valueName,callback:function(i){t.$set(e,"valueName",i)},expression:"ruleDatas.valueName"}})],1)]):t._e(),"staff"==e.type&&"GLOBAL_VAR.REGION_ID"==e.id?n("fi-col",{staticClass:"case-padding-t",attrs:{span:6}},[n("fi-type-tree",{staticStyle:{width:"100%"},attrs:{type:"REGION"},on:{"node-click":function(i){return t.changeArea(i,e)}},model:{value:e.value,callback:function(i){t.$set(e,"value",i)},expression:"ruleDatas.value"}})],1):t._e(),"staff"==e.type&&"GLOBAL_VAR.ROLE_GROUP"==e.id?n("fi-col",{staticClass:"case-padding-t",attrs:{span:6}},[n("fi-select",{attrs:{size:"small",placeholder:t.t("options.placeHolder"),disabled:t.foldingLayes.isSetDeRult},on:{change:function(i){return t.getValueName(e,i)}},model:{value:e.value,callback:function(i){t.$set(e,"value",i)},expression:"ruleDatas.value"}},t._l(t.commonData.groupRoleChoice,function(t,e){return n("fi-option",{key:e,attrs:{label:t.text,value:t.value}})}),1)],1):t._e(),"tache"==e.type&&["FLOW.TCH_NUM","preTchMod"].includes(e.id)?n("fi-col",{staticClass:"case-padding-t",attrs:{span:6}},[n("fi-select",{attrs:{size:"small",placeholder:t.t("options.placeHolder"),disabled:t.foldingLayes.isSetDeRult},model:{value:e.value,callback:function(i){t.$set(e,"value",i)},expression:"ruleDatas.value"}},t._l(t.dirCondition.getPreTcheInfoData,function(t,e){return n("fi-option",{key:e,attrs:{label:t.tchName,value:t.tchMod}})}),1)],1):t._e(),"tache"==e.type&&["TACHE.ACTION"].includes(e.id)?n("fi-col",{staticClass:"case-padding-t",attrs:{span:6}},[n("fi-select",{attrs:{size:"small",placeholder:t.t("options.placeHolder"),disabled:t.foldingLayes.isSetDeRult},model:{value:e.value,callback:function(i){t.$set(e,"value",i)},expression:"ruleDatas.value"}},t._l(t.commonData.tacheAction,function(t,e){return n("fi-option",{key:e,attrs:{label:t.text,value:t.value}})}),1)],1):t._e(),"tache"==e.type&&["preTchAction"].includes(e.id)?n("fi-col",{staticClass:"case-padding-t",attrs:{span:6}},[n("fi-select",{attrs:{size:"small",placeholder:t.t("options.placeHolder"),disabled:t.foldingLayes.isSetDeRult},model:{value:e.value,callback:function(i){t.$set(e,"value",i)},expression:"ruleDatas.value"}},t._l(t.commonData.nextTacheAction,function(t,e){return n("fi-option",{key:e,attrs:{label:t.text,value:t.value}})}),1)],1):t._e()],1)],1),n("fi-col",{staticStyle:{"line-height":"35px","text-align":"center"},attrs:{span:2}},[n("span",[n("span",{on:{click:function(e){return t.addRules(t.Layindex)}}},[n("img",{attrs:{src:i("62fb")}})]),n("span",{on:{click:function(e){return t.deleteRules(t.Layindex,o)}}},[n("img",{attrs:{src:i("8dae")}})])])])],1)}),1),n("fui-el-dialog-transfer-choice",{attrs:{"dialog-visible":t.dialogVisible,"choice-values":t.checkedOrganzations,multiple:t.staffIsMultiple,action:"ORG"},on:{"on-visible-change":t.doVisibleChange,"on-sure-after":t.doOnSureAfter},model:{value:t.checkedOrganzations,callback:function(e){t.checkedOrganzations=e},expression:"checkedOrganzations"}})],1)},Wo=[],Go=i("2166"),Zo={name:"regularCondition",mixins:[bn.localeMixin],props:["foldingLayes","dirCondition","Layindex","foldingLayer","type","disabled"],data:function(){return{commonData:{},dialogVisible:!1,checkedOrganzations:[],currentRowObj:[],checkedRegion:[],staffIsMultiple:!1}},created:function(){this.commonData=Ro.loadCommonData(this.t)},methods:{handLabelToRule:function(t,e){var i=this.$refs["tree".concat(t)][0].checkedNodes;i&&i.length>0&&(e.valueName="",i.forEach(function(t){e.valueName+="".concat(t.label,",")}),e.valueName=e.valueName.substring(0,e.valueName.length-1))},changeToRule:function(t,e,i){var n=this.$refs["tree".concat(e)][0].checkedNodes;t.length>0&&n&&t.length<n.length&&(i.valueName="",t.forEach(function(t){n.forEach(function(e){t[t.length-1]===e.value&&(i.valueName+="".concat(e.label,","))})}),i.valueName=i.valueName.substring(0,i.valueName.length-1)),0===t.length&&(i.valueName="")},getValueName:function(t,e){var i=this.commonData.groupRoleChoice.findIndex(function(t){return t.value===e});t.valueName=this.commonData.groupRoleChoice[i].text},callMethod:function(t){t.id="",t.value="",t.oper="",t.elementType="",t.valueName="",t.formatType=""},getFouthData:function(){function t(t){return e.apply(this,arguments)}var e=q(Xn.a.mark(function t(e){var i=this;return Xn.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:"form"===e.type&&this.dirCondition.loadDimenData.forEach(function(t){var n=t.children.find(function(t){return t.value===e.id});if(n)if(e.elementType=n.elementType,e.formatType=n.formatType,"9"===e.elementType){var o=n.tree.domainType,r=n.tree.domainSql;if(o){var a=i.getTreeByDomainType(o);a.then(function(t){e.initSqlArr=t})}else if(r){var s=i.setSqlToTree(r);s.then(function(t){e.initSqlArr=t})}}else e.initSqlArr=n.options}),e.oper="",e.value="",e.valueName="";case 4:case"end":return t.stop()}},t,this)}));return t}(),getTreeByDomainType:function(){function t(t){return e.apply(this,arguments)}var e=q(Xn.a.mark(function t(e){var i;return Xn.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Ro.getTreeByDomainType({domainType:e});case 2:return i=t.sent,t.abrupt("return",i);case 4:case"end":return t.stop()}},t)}));return t}(),setSqlToTree:function(){function t(t){return e.apply(this,arguments)}var e=q(Xn.a.mark(function t(e){var i;return Xn.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Ro.setSqlToTree({sql:e});case 2:return i=t.sent,t.abrupt("return",i);case 4:case"end":return t.stop()}},t)}));return t}(),loadInitSqlInfo:function(t,e){var i={initSql:t};Ro.loadInitSqlInfo(i).then(function(t){e.initSqlArr=t.returnData})},addRules:function(t){if(this.disabled||this.foldingLayes.isSetDeRult)return!1;var e={type:"",id:"",elementType:"",oper:"",value:"",valueName:"",staffName:"",initSqlArr:[],formatType:""};return this.foldingLayer[t].condition.push(e),!0},deleteRules:function(t,e){if(this.disabled||this.foldingLayes.isSetDeRult)return!1;if(1===this.foldingLayer[t].condition.length){this.foldingLayer[t].condition=[];var i={type:"",id:"",elementType:"",oper:"",value:"",valueName:"",staffName:"",initSqlArr:[],formatType:""};this.foldingLayer[e].condition.push(i)}else this.foldingLayer[t].condition.splice(e,1);return!0},clearCondition:function(t){this.foldingLayer[t].conditionType="",this.foldingLayer[t].condition=[];var e={type:"",id:"",elementType:"",oper:"",value:"",valueName:"",staffName:"",initSqlArr:[],formatType:""};this.foldingLayer[t].condition.push(e)},setDefaultRule:function(t,e){if(t){for(var i="-1",n=0;n<this.foldingLayer.length;n++)if(this.foldingLayer[n].isSetDeRult&&n!==e){i="1";break}"1"===i?(this.$message({message:this.t("tacheComp.hasExist"),type:"warning"}),this.foldingLayer[e].isSetDeRult=!1):(this.foldingLayer[e].conditionType="",this.foldingLayer[e].conditionTypeDesc="",this.foldingLayer[e].condition=[{type:"",id:"",elementType:"",oper:"",value:"",initSqlArr:[],valueName:"",staffName:"",formatType:""}])}},showStaffChoice:function(t,e){var i=new Go.StaffSelectAddonExtends({multiple:e,confirmCallBack:function(i){e?(t.value="",t.staffName="",i.length>0&&(i.forEach(function(e){t.value+="".concat(e.STAFF_ID,","),t.staffName+="".concat(e.STAFF_NAME,",")}),t.value=t.value.substring(0,t.value.length-1),t.staffName=t.staffName.substring(0,t.staffName.length-1))):(t.value=i.STAFF_ID,t.staffName=i.STAFF_NAME),t.valueName=""}});if(e){if(""!==t.value){var n=[],o=t.value.split(",");o.forEach(function(t){n.push({STAFF_ID:t})}),n.length>0&&i.setPersons(n)}}else""!==t.value&&i.setPersons({STAFF_ID:t.value});i.show()},openStaffOrg:function(t,e){var i=this;this.staffIsMultiple=e,this.currentRowObj=t,this.checkedOrganzations.length=0,""!==this.currentRowObj.value&&(e?this.currentRowObj.value.split(",").forEach(function(t){i.checkedOrganzations.push({org_id:t})}):this.checkedOrganzations.push(this.currentRowObj.value)),this.dialogVisible=!0},doVisibleChange:function(t){this.dialogVisible=t},doOnSureAfter:function(t){var e=this;this.currentRowObj.staffName="",this.currentRowObj.value="",this.currentRowObj.valueName="",t.length>0&&(t.forEach(function(t){e.currentRowObj.value+="".concat(t.org_id,","),e.currentRowObj.valueName+="".concat(t.org_name,",")}),this.currentRowObj.value=this.currentRowObj.value.substring(0,this.currentRowObj.value.length-1),this.currentRowObj.valueName=this.currentRowObj.valueName.substring(0,this.currentRowObj.valueName.length-1))},changeArea:function(t,e){var i=e;i.valueName=t.region_name,i.value=t.region_id.toString(),i.staffName=""},filterValue:function(t,e){"44"===e&&(t.value=t.value.map(function(t){return{flowId:t.flowId,flowName:t.flowName}}))}}},Xo=Zo,Yo=(i("eba4"),B(Xo,Ho,Wo,!1,null,null,null)),$o=Yo.exports,qo=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("section",{attrs:{id:"regularOption"}},[i("div",{staticClass:"option-header"},[t.tacheRule.opinionCfg.display?i("fi-row",{staticClass:"case-row-height"},[i("fi-col",{attrs:{span:3}},[t._v(t._s(t.t("options.handOption"))+"：")]),i("fi-col",{attrs:{span:21}},t._l(t.tacheRule.opinionCfg.options,function(e,n){return i("fi-row",{key:n,staticClass:"case-row-height"},[""!=e.text?i("fi-col",{staticClass:"align-center",attrs:{span:3}},[i("span",[t._v(t._s(e.text))])]):t._e(),""!=e.text?i("fi-col",{staticClass:"case-padding",attrs:{span:21}},[t._l(t.foldingLayes.tacheObj.tacheArr,function(n,o){return i("fi-row",{key:o},[n.key==e.value&&""!=e.text?i("div",[i("fi-col",{attrs:{span:2}},[i("i",{staticClass:"el-icon-remove option-delete",attrs:{title:t.t("options.delete")},on:{click:function(e){return t.removeOpinions(o)}}})]),i("fi-col",{attrs:{span:13}},[i("fi-select",{attrs:{size:"small",placeholder:t.t("options.tacheName")},on:{change:function(e){return t.setTacheName(e,n,t.foldingLayes,o)}},model:{value:n.tchMod,callback:function(e){t.$set(n,"tchMod",e)},expression:"tch.tchMod"}},t._l(t.dirCondition.tacheData2,function(t,e){return i("fi-option",{key:e,attrs:{label:t.tchName,value:t.tchMod}})}),1)],1),i("fi-col",{staticClass:"case-padding",attrs:{span:6}},[i("fi-checkbox",{on:{change:function(i){return t.changeNextTacheDefault(i,o,t.foldingLayes,e.value)}},model:{value:n.isSetDeRult,callback:function(e){t.$set(n,"isSetDeRult",e)},expression:"tch.isSetDeRult"}},[t._v(t._s(t.t("tacheComp.defaultSelect")))])],1)],1):t._e()])}),i("fi-row",{staticClass:"case-row-height"},[i("fi-col",{attrs:{span:18}},[i("fi-button",{attrs:{type:"primary",plain:""},on:{click:function(i){return t.addNextTch(e.value,t.foldingLayes.tacheObj.tacheArr)}}},[t._v(t._s(t.t("options.addNextTache")))])],1)],1)],2):t._e()],1)}),1)],1):i("fi-row",{staticClass:"case-row-height"},[i("fi-col",{attrs:{span:4}},[t._v(t._s(t.t("options.nextTache"))+"：")]),i("fi-col",{attrs:{span:20}},[t._l(t.foldingLayes.tacheObj.tacheArr,function(e,n){return i("fi-row",{key:n,staticClass:"case-row-height"},[i("fi-col",{attrs:{span:2}},[i("i",{staticClass:"el-icon-remove option-delete",attrs:{title:t.t("options.delete")},on:{click:function(e){return t.removeOpinions(n)}}})]),i("fi-col",{attrs:{span:13}},[i("fi-select",{attrs:{size:"small",placeholder:t.t("options.tacheName")},on:{change:function(i){return t.setTacheName(i,e,t.foldingLayes)}},model:{value:e.tchMod,callback:function(i){t.$set(e,"tchMod",i)},expression:"tch.tchMod"}},t._l(t.dirCondition.tacheData2,function(t,e){return i("fi-option",{key:e,attrs:{label:t.tchName,value:t.tchMod}})}),1)],1),i("fi-col",{staticClass:"case-padding",attrs:{span:6}},[i("fi-checkbox",{on:{change:function(e){return t.changeNextTacheDefault(e,n,t.foldingLayes,"")}},model:{value:e.isSetDeRult,callback:function(i){t.$set(e,"isSetDeRult",i)},expression:"tch.isSetDeRult"}},[t._v(t._s(t.t("tacheComp.defaultSelect")))])],1)],1)}),i("fi-row",{staticClass:"case-row-height"},[i("fi-col",{attrs:{span:18}},[i("fi-button",{attrs:{type:"primary",plain:""},on:{click:function(e){return t.addNextTch("",t.foldingLayes.tacheObj.tacheArr)}}},[t._v(t._s(t.t("options.addNextTache")))])],1)],1)],2)],1)],1)])},Ko=[],Jo={name:"regular-option",mixins:[bn.localeMixin],props:["dirCondition","foldingLayes","tacheRule","disabled"],created:function(){var t=this;this.$busManage.$on("regularOption",function(){t.foldingLayes.tacheObj.tacheArr.length=0})},methods:{changeNextTacheDefault:function(t,e,i,n){var o=i;if(t){var r=-1;r=n?o.tacheObj.tacheArr.findIndex(function(t,i){return t.isSetDeRult&&e!==i&&n===t.key}):o.tacheObj.tacheArr.findIndex(function(t,i){return t.isSetDeRult&&e!==i}),r>-1&&(o.tacheObj.tacheArr[r].isSetDeRult=!1)}},addNextTch:function(t,e){var i=0;this.tacheRule.opinionCfg.display||(i=e.length);for(var n=0;n<e.length;n++)e[n].key===t&&""!==e[n].key&&i++;if(i<this.dirCondition.tacheData2.length){e.push({key:t,tchMod:"",tchName:"",isSetDeRult:!1})}else this.$message({message:this.t("tacheComp.addCap"),type:"warning"})},setTacheName:function(t,e,i,n){for(var o=!0,r=e,a=0;a<i.tacheObj.tacheArr.length;a++)e.key===i.tacheObj.tacheArr[a].key&&t===i.tacheObj.tacheArr[a].tchMod&&""!==i.tacheObj.tacheArr[a].tchName&&i.tacheObj.tacheArr[a].tchName!==e.tchName&&a!==n&&(this.$message({message:this.t("tacheComp.addMessage"),type:"warning"}),o=!1,r.tchMod="",r.tchName="",r.isSetDeRult=!1);if(o){var s=this.dirCondition.tacheData2.findIndex(function(e){return t-e.tchMod==0});r.tchName=this.dirCondition.tacheData2[s].tchName}},removeOpinions:function(t){return!this.disabled&&(this.foldingLayes.tacheObj.tacheArr.splice(t,1),!0)}},beforeDestroy:function(){this.$busManage.$off("regularOption")}},Qo=Jo,tr=(i("bd6a"),B(Qo,qo,Ko,!1,null,null,null)),er=tr.exports,ir={name:"tchRegular",mixins:[bn.localeMixin],data:function(){return{currentIndex:-1,commonData:{},currentCollapse:""}},props:["foldingLayer","dirCondition","type","tacheRule","node","disabled"],computed:{regDisable:function(){return this.disabled}},created:function(){var t=this;this.commonData=Ro.loadCommonData(this.t),this.$busManage.$on("openCollapse",function(e){t.type===e&&(t.currentIndex>-1&&t.createTitle(t.currentIndex),t.currentCollapse=t.foldingLayer.length-1)})},components:{regularStaff:jo,regularCondition:$o,regularOption:er},methods:{removeFoldingLayes:function(t){this.foldingLayer.splice(t,1)},loadChangeTitle:function(t){""!==t?this.currentIndex=t:this.createTitle(this.currentIndex)},createTitleForm:function(t,e,i,n,o){var r=this,a="";if(this.dirCondition.loadDimenData.forEach(function(e){e.children.forEach(function(e){e.value===n.id&&(t+=e.label,a="".concat(e.elementType))})}),this.commonData.conditionTypeAll.forEach(function(e){e.value===n.oper&&(t+=r.t(e.text))}),["3","4","6","7","37"].includes(a))n.value.forEach(function(e){n.initSqlArr.forEach(function(i){e===i.CODE&&(t+="".concat(i.MEAN,","))})}),n.value.length>0&&(t=t.substring(0,t.length-1)),e!==o[i].condition.length-1&&(o[i].conditionType-1==0&&(t+="】".concat(this.t("options.and"),"【")),o[i].conditionType-2==0&&(t+="】".concat(this.t("options.or"),"【")));else if(["24"].includes(a))e===o[i].condition.length-1?t+=n.staffName:(o[i].conditionType-1==0&&(t+="".concat(n.staffName,"】").concat(this.t("options.and"),"【")),o[i].conditionType-2==0&&(t+="".concat(n.staffName,"】").concat(this.t("options.or"),"【")));else if(["25","9","region"].includes(a))e===o[i].condition.length-1?t+=n.valueName:(o[i].conditionType-1==0&&(t+="".concat(n.valueName,"】").concat(this.t("options.and"),"【")),o[i].conditionType-2==0&&(t+="".concat(n.valueName,"】").concat(this.t("options.or"),"【")));else if(["28","44"].includes(a)){var s="";n.value.length>0&&(n.value.forEach(function(t){a-28==0?r.$i18n&&"en"===r.$i18n.locale?s+="".concat(t.instName,","):s+="".concat(t.instNameCn,","):s+="".concat(t.flowName,",")}),""!==s&&(s=s.substring(0,s.length-1))),e===o[i].condition.length-1?t+=s:(o[i].conditionType-1==0&&(t+="".concat(s,"】").concat(this.t("options.and"),"【")),o[i].conditionType-2==0&&(t+="".concat(s,"】").concat(this.t("options.or"),"【")))}else e===o[i].condition.length-1?t+=n.value:(o[i].conditionType-1==0&&(t+="".concat(n.value,"】").concat(this.t("options.and"),"【")),o[i].conditionType-2==0&&(t+="".concat(n.value,"】").concat(this.t("options.or"),"【")));return t},createTitleTache:function(t,e,i,n,o){var r=this,a="";return this.commonData.tacheDimension.forEach(function(e){e.paramCompCode===n.id&&(t+=e.paramCompName,a=e.paramCompCode)}),this.commonData.nextTacheDimension.forEach(function(e){e.paramCompCode===n.id&&(t+=e.paramCompName,a=e.paramCompCode)}),this.commonData.conditionTypeAll.forEach(function(e){e.value===n.oper&&(t+=r.t(e.text))}),["FLOW.TCH_NUM","preTchMod"].includes(a)?this.dirCondition.getPreTcheInfoData.forEach(function(a){n.value===a.tchMod&&(e===o[i].condition.length-1?t+=a.tchName:(o[i].conditionType-1==0&&(t+="".concat(a.tchName,"】").concat(r.t("options.and"),"【")),o[i].conditionType-2==0&&(t+="".concat(a.tchName,"】").concat(r.t("options.or"),"【"))))}):["TACHE.ACTION"].includes(a)?this.commonData.tacheAction.forEach(function(a){n.value===a.value&&(e===o[i].condition.length-1?t+=a.text:(o[i].conditionType-1==0&&(t+="".concat(a.text,"】").concat(r.t("options.and"),"【")),o[i].conditionType-2==0&&(t+="".concat(a.text,"】").concat(r.t("options.or"),"【"))))}):"preTchAction"===a&&this.commonData.nextTacheAction.forEach(function(a){n.value===a.value&&(e===o[i].condition.length-1?t+=a.text:(o[i].conditionType-1==0&&(t+="".concat(a.text,"】").concat(r.t("options.and"),"【")),o[i].conditionType-2==0&&(t+="".concat(a.text,"】").concat(r.t("options.or"),"【"))))}),t},createTitleStaff:function(t,e,i,n,o){var r=this,a="";return"GLOBAL_VAR.ROLE_GROUP"===n.id?(a="GLOBAL_VAR.ROLE_GROUP",t+=this.t("tacheComp.previousRole")):this.commonData.stffDimenSion.forEach(function(e){e.paramCompCode===n.id&&(t+=e.paramCompName,a=e.paramCompCode)}),this.commonData.conditionTypeAll.forEach(function(e){e.value===n.oper&&(t+=r.t(e.text))}),["GLOBAL_VAR.ORG_ID","GLOBAL_VAR.REGION_ID","GLOBAL_VAR.ROLE_GROUP"].includes(a)?e===o[i].condition.length-1?t+=n.valueName:(o[i].conditionType-1==0&&(t+="".concat(n.valueName,"】").concat(this.t("options.and"),"【")),o[i].conditionType-2==0&&(t+="".concat(n.valueName,"】").concat(this.t("options.or"),"【"))):"GLOBAL_VAR.STAFF_ID"===a&&(e===o[i].condition.length-1?t+=n.staffName:(o[i].conditionType-1==0&&(t+="".concat(n.staffName,"】").concat(this.t("options.and"),"【")),o[i].conditionType-2==0&&(t+="".concat(n.staffName,"】").concat(this.t("options.or"),"【")))),t},createTitle:function(t){var e=this,i="";i=this.type-1==0?this.t("options.nextTache"):this.type-2==0?this.t("options.tacheHander"):this.type-5==0?this.t("togetherComp.linkBranchPeople"):this.t("options.tacheCC");var n=this.foldingLayer;this.commonData.condition.forEach(function(e){n[t].conditionType===e.value&&(n[t].conditionTypeDesc=e.text)});var o="【";if(n[t].condition.forEach(function(i,r){"form"===i.type?o=e.createTitleForm(o,r,t,i,n):"tache"===i.type?o=e.createTitleTache(o,r,t,i,n):"staff"===i.type&&(o=e.createTitleStaff(o,r,t,i,n))}),this.type-5!=0)if(n[t].isSetDeRult?o=this.t("tacheComp.unconditionally"):o+="】".concat(this.t("tacheComp.time"),","),i===this.t("options.nextTache")){if(0!==n[t].tacheObj.tacheArr.length)if(this.tacheRule.opinionCfg.display){o+=this.t("tacheComp.handOption");for(var r=0;r<this.node.advancedProperties.opinionCfg.options.length;r++){for(var a="",s=0;s<n[t].tacheObj.tacheArr.length;s++)this.node.advancedProperties.opinionCfg.options[r].value===n[t].tacheObj.tacheArr[s].key&&(a+="".concat(n[t].tacheObj.tacheArr[s].tchName,";"));""!==a&&(o+='"'.concat(this.node.advancedProperties.opinionCfg.options[r].text,'",'),o+=a),this.node.advancedProperties.opinionCfg.selected===this.node.advancedProperties.opinionCfg.options[r].value&&(o+=this.t("tacheComp.defaultSelect"))}}else for(var l=0;l<n[t].tacheObj.tacheArr.length;l++)o+="".concat(n[t].tacheObj.tacheArr[l].tchName,";")}else if("fromFlow"===n[t].dealWay){var h="";if(n[t].selectBox-1==0)for(var c=0;c<this.commonData.flowStart.length;c++)n[t].selectValue===this.commonData.flowStart[c].value&&(h=this.commonData.flowStart[c].text);if(n[t].selectBox-2==0)for(var u=0;u<this.commonData.preTacheDeal.length;u++)n[t].selectValue===this.commonData.preTacheDeal[u].value&&(h=this.commonData.preTacheDeal[u].text);if(n[t].selectBox-3==0)for(var d=0;d<this.dirCondition.relationFlow.length;d++)if(n[t].selectArray[0]===this.dirCondition.relationFlow[d].value){h="".concat(this.t("tacheComp.relFlow"),"-").concat(this.dirCondition.relationFlow[d].label);for(var f=0;f<this.dirCondition.relationFlow[d].children.length;f++)if(n[t].selectArray[1]===this.dirCondition.relationFlow[d].children[f].value){h+="-".concat(this.t("tacheComp.tache"),"：").concat(this.dirCondition.relationFlow[d].children[f].label),n[t].selectValue=this.dirCondition.relationFlow[d].children[f].value;break}}o+="".concat(i,":").concat(h)}else{for(var p="",g=0;g<n[t].staff.length;g++)n[t].staff.length-1===g?p+=n[t].staff[g].name:p+="".concat(n[t].staff[g].name,",");o+="".concat(i,":").concat(p)}else n[t].isSetDeRult?o=this.t("tacheComp.unconditional"):o+="】";n[t].conditionDesc=o}},beforeDestroy:function(){this.$busManage.$off("openCollapse")}},nr=ir,or=(i("84dc"),B(nr,So,Eo,!1,null,null,null)),rr=or.exports,ar={name:"fmd-tache-deal",mixins:[bn.localeMixin],components:{tchRegular:rr},props:["revisionId","dirCondition","foldingLayer","tacheRule","node","type","disabled"],created:function(){var t=this;this.$busManage.$on("addRule",function(e){t.type===e.type&&t.addFoldLayer()})},data:function(){return{dialogVisible:!1}},methods:{addFoldLayer:function(){var t={typeArr:this.type,rulesTchMod:this.node.tchMod,revisionId:this.revisionId,isSetDeRult:!1,flowCfgRuleId:"",conditionDesc:"",conditionType:"1",conditionTypeDesc:"",dealWay:"fromOrg",selectBox:"",selectValue:"",selectArray:[],staff:[],condition:[{type:"",id:"",elementType:"",oper:"",value:"",initSqlArr:[],staffName:""}],resultType:"",result:"",dealFar:"",dealFarName:"",dealNode:"",dealNodeName:"",dealStaff:"",dealStaffName:"",choiceWay:"2",tacheObj:{tacheArr:[]},recommendStaff:"",recommendStaffArr:[],recommendWay:"fromOrg",recommendType:"",recommendBox:"",recommendArray:[],recommendStaffValue:"",isCanChange:"T",filterWay:"1",orgFarWay:"1",orgNodeWay:"1"};this.foldingLayer.push(t),this.$busManage.$emit("openCollapse",this.type)}},beforeDestroy:function(){this.$busManage.$off("addRule")}},sr=ar,lr=(i("6cef"),B(sr,To,ko,!1,null,null,null)),hr=lr.exports,cr={name:"fmd-tache-rule",mixins:[bn.localeMixin],components:{ReferenceStaff:Co,ProcessingScope:_o,FmdTacheCfg:hr},props:{node:Object,disabled:Boolean,tableOptions:Array,revisionId:String,dirCondition:Object,ruleTacheStaffData:Array,ruleReaderStaffData:Array},computed:{selectRootNode:function(){var t=/<i:[A-Za-z0-9\s*|\u4e00-\u9fa5|:|\/|\\|-]+>/g;return(this.tacheRule.rootOrgValue||"").replace(t,"")},selectNotifyRootNode:function(){var t=/<i:[A-Za-z0-9\s*|\u4e00-\u9fa5|:|\/|\\|-]+>/g;return(this.tacheRule.notifyRootOrgValue||"").replace(t,"")}},data:function(){var t=this,e=/^(([a-zA-Z0-9]+[.])[.]*.*)*([\w]*\.?[\w]+)\((.*)\)/,i=function(i,n,o){if(["form","fix"].includes(t.tacheRule.defaultStaffType)&&!n)o(new Error(t.t("tchRule.errorMessage1")));else if(["sqlFunc","js"].includes(t.tacheRule.defaultStaffType)){var r=n.match(e);r&&r[0]===n?o():o(new Error(t.t("tchRule.errorMessage2")))}else!t.tacheRule.defaultStaffType&&n?o(new Error(t.t("tchRule.errorMessage3"))):o()},n=function(i,n,o){if(["form","fix"].includes(t.tacheRule.rootOrgType)&&!n)o(new Error(t.t("tchRule.errorMessage4")));else if(["sqlFunc","js"].includes(t.tacheRule.rootOrgType)){var r=n.match(e);r&&r[0]===n?o():o(new Error(t.t("tchRule.errorMessage2")))}else!t.tacheRule.rootOrgType&&n?o(new Error(t.t("tchRule.errorMessage5"))):o()},o=function(i,n,o){if(["form","fix"].includes(t.tacheRule.filterStaffWhereType)&&!n)o(new Error(t.t("tchRule.errorMessage6")));else if(["sqlFunc","js"].includes(t.tacheRule.filterStaffWhereType)){var r=n.match(e);r&&r[0]===n?o():o(new Error(t.t("tchRule.errorMessage2")))}else!t.tacheRule.filterStaffWhereType&&n?o(new Error(t.t("tchRule.errorMessage7"))):o()},r=function(i,n,o){if(["form","fix"].includes(t.tacheRule.notifyStaffType)&&!n)o(new Error(t.t("tchRule.errorMessage1")));else if(["sqlFunc","js"].includes(t.tacheRule.notifyStaffType)){var r=n.match(e);r&&r[0]===n?o():o(new Error(t.t("tchRule.errorMessage2")))}else!t.tacheRule.notifyStaffType&&n?o(new Error(t.t("tchRule.errorMessage3"))):o()},a=function(i,n,o){if(["form","fix"].includes(t.tacheRule.notifyRootOrgType)&&!n)o(new Error(t.t("tchRule.errorMessage4")));else if(["sqlFunc","js"].includes(t.tacheRule.notifyRootOrgType)){var r=n.match(e);r&&r[0]===n?o():o(new Error(t.t("tchRule.errorMessage2")))}else!t.tacheRule.notifyRootOrgType&&n?o(new Error(t.t("tchRule.errorMessage5"))):o()};return{tacheRule:this.node.advancedProperties||{},closeIcon:!1,dropdown:{rootOrgType:this.t("options.placeHolder"),notifyRootOrgType:this.t("options.placeHolder"),rootModel:this.t("options.devMode"),notifyRootModel:this.t("options.devMode"),defaultStaffType:this.t("options.placeHolder"),notifyStaffType:this.t("options.placeHolder")},dropdownValue:{rootModel:1,notifyRootModel:1},options:{staffCreateType:[{id:"",label:this.t("options.allOrg")},{id:"2",label:this.t("options.staffDep")},{id:"3",label:this.t("options.team")}],rootOrgType:[{id:"fix",label:this.t("options.fix")},{id:"form",label:this.t("options.formElement")},{id:"sqlFunc",label:this.t("options.sqlFunc")},{id:"js",label:this.t("options.jsFunc")}],filterStaffWhereType:[{id:"fix",label:this.t("options.fix")},{id:"sqlFunc",label:this.t("options.sqlFunc")},{id:"js",label:this.t("options.jsFunc")}],modal:[{id:1,label:this.t("options.devMode")},{id:2,label:this.t("options.customMode")}]},orgDialogVisible:!1,teamDialogVisible:!1,checkedTeam:[],notifyTeamDialogVisible:!1,notifyCheckedTeam:[],notifyOrgDialogVisible:!1,notifyCheckedOrganzations:[],checkedOrganzations:[],multiple:!1,setValue:"",rules:{defaultStaffValue:[{validator:i,trigger:["change","blur"]}],rootOrgValue:[{validator:n,trigger:["change","blur"]}],filterStaffWhere:[{validator:o,trigger:["change","blur"]}],notifyStaffValue:[{validator:r,trigger:["change","blur"]}],notifyRootOrgValue:[{validator:a,trigger:["change","blur"]}]},orgChangeCount:1}},created:function(){var t=this;["rootOrgType","notifyRootOrgType","defaultStaffType","notifyStaffType"].forEach(function(e){t.initDropdown(e)}),this.tacheRule.staffCreateType=this.tacheRule.staffCreateType||"",this.tacheRule.rootOrgCanChange=this.tacheRule.rootOrgCanChange||"0BT",this.tacheRule.notifyRootOrgCanChange=this.tacheRule.notifyRootOrgCanChange||"0BT",this.tacheRule.defaultStaffCanChange=this.tacheRule.defaultStaffCanChange||"0BT",this.tacheRule.notifyStaffCanChange=this.tacheRule.notifyStaffCanChange||"0BT",this.tacheRule.notifyStaffCreateType=this.tacheRule.notifyStaffCreateType||"",this.dropdown.rootModel="rule"===this.tacheRule.defaultStaffType?this.t("options.customMode"):this.t("options.devMode"),this.dropdownValue.rootModel="rule"===this.tacheRule.defaultStaffType?2:1,this.dropdown.notifyRootModel="rule"===this.tacheRule.notifyStaffType?this.t("options.customMode"):this.t("options.devMode"),this.dropdownValue.notifyRootModel="rule"===this.tacheRule.notifyStaffType?2:1,this.initStaff(),this.initRootOrgValue("rootOrgType","rootOrgValue","staffCreateType"),this.initRootOrgValue("notifyRootOrgType","notifyRootOrgValue","notifyStaffCreateType")},methods:{initDropdown:function(t){var e=this;if(this.tacheRule&&this.tacheRule[t]){var i=this.options.rootOrgType.find(function(i){return i.id===e.tacheRule[t]});this.dropdown[t]=i&&i.label||this.t("options.placeHolder")}},initStaff:function(){var t=this;if("fix"===this.tacheRule.defaultStaffType&&this.tacheRule.defaultStaffValue)if("1"===this.node.multiInstMerge&&"multiInst"===this.node.flowMode)for(var e=this.tacheRule.defaultStaffValue.split("|"),i=0;i<e.length;i++)for(var n=e[i].split(":"),o=0;o<n.length;o++)this.initMultiInstMergeStaff(n[o],i,o);else O({staffIds:this.tacheRule.defaultStaffValue}).then(function(e){e.forEach(function(e,i){0===i?t.tacheRule.defaultStaffValue="".concat(e.STAFF_ID,"<i:").concat(e.STAFF_NAME,">"):t.tacheRule.defaultStaffValue+=",".concat(e.STAFF_ID,"<i:").concat(e.STAFF_NAME,">")})});"fix"===this.tacheRule.notifyStaffType&&this.tacheRule.notifyStaffValue&&O({staffIds:this.tacheRule.notifyStaffValue}).then(function(e){e.forEach(function(e,i){0===i?t.tacheRule.notifyStaffValue="".concat(e.STAFF_ID,"<i:").concat(e.STAFF_NAME,">"):t.tacheRule.notifyStaffValue+=",".concat(e.STAFF_ID,"<i:").concat(e.STAFF_NAME,">")})})},initMultiInstMergeStaff:function(){function t(t,i,n){return e.apply(this,arguments)}var e=J(Xn.a.mark(function t(e,i,n){var o,r;return Xn.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,O({staffIds:e});case 2:o=t.sent,r=o.map(function(t){return"".concat(t.STAFF_ID,"<i:").concat(t.STAFF_NAME,">")}).join(","),0===n&&0===i?this.tacheRule.defaultStaffValue=r:1===n?this.tacheRule.defaultStaffValue+=":".concat(r):0===n&&0!==i&&(this.tacheRule.defaultStaffValue+="|".concat(r));case 5:case"end":return t.stop()}},t,this)}));return t}(),initRootOrgValue:function(t,e,i){var n=this;"fix"===this.tacheRule[t]&&this.tacheRule[e]&&("2"===this.tacheRule[i]&&L({orgIds:this.tacheRule[e]}).then(function(t){n.tacheRule[e]="".concat(t[0].org_id,"<i:").concat(t[0].org_name,">")}),"3"===this.tacheRule[i]&&P({projectIds:this.tacheRule[e]}).then(function(t){n.tacheRule[e]="".concat(t[0].group_id,"<i:").concat(t[0].group_name,">")}))},onChangeStaffType:function(t,e){"rootOrgType"===t&&(this.tacheRule.beginOrgValue=""),this.dropdown[t]=""===e?this.t("options.placeHolder"):this.t("options.fix"),this.tacheRule[t]=""===e?"":"fix"},onDropDownModal:function(t,e){this.dropdown[t]=e.label,this.dropdownValue[t]=e.id,this.tacheRule["rootModel"===t?"defaultStaffType":"notifyStaffType"]=2===e.id?"rule":""},onRootOrgClickBefore:function(t){return"fix"===this.tacheRule.rootOrgType?(this.setValue=t,"2"===this.tacheRule.staffCreateType?this.orgDialogVisible=!0:this.teamDialogVisible=!0,!1):""!==this.tacheRule.rootOrgType||(this.$message.warning(this.t("tchRule.errorMessage8")),!1)},onNotifyRootClickBefore:function(t){return""===this.tacheRule.notifyRootOrgType?(this.$message.warning(this.t("tchRule.errorMessage8")),!1):"fix"!==this.tacheRule.notifyRootOrgType||(this.setValue=t,"2"===this.tacheRule.notifyStaffCreateType?this.notifyOrgDialogVisible=!0:this.notifyTeamDialogVisible=!0,!1)},onDefaultStaffClickBefore:function(t){if(""===this.tacheRule.defaultStaffType)return this.$message.warning(this.t("tchRule.errorMessage8")),!1;if("fix"===this.tacheRule.defaultStaffType){this.setValue=t;var e={multiple:!0,confirmCallBack:this.staffCallback},i=vo(e),n=null,o=!1;return"0BT"===this.tacheRule.rootOrgCanChange?(n=this.tacheRule.beginOrgValue?"".concat(this.tacheRule.beginOrgValue):null,o=!n):(n=this.selectRootNode?"".concat(this.selectRootNode):null,o=!1),i.setChoiceSourceTreeConfig({organization:{startPathIds:n,selectedOrgID:this.selectRootNode,isTop:o,hidden:!["","2"].includes(this.tacheRule.staffCreateType)},project:{startPathIds:n,selectedOrgID:this.selectRootNode,isTop:o,hidden:!["","3"].includes(this.tacheRule.staffCreateType)},dutyLine:{hidden:!0},projectDefined:{hidden:!0}}),i.show(),!1}return!0},onFilterStaffClickBefore:function(t){if(""===this.tacheRule.filterStaffWhereType)return this.$message.warning(this.t("tchRule.errorMessage8")),!1;if("fix"===this.tacheRule.filterStaffWhereType){this.setValue=t;var e={multiple:!0,confirmCallBack:this.filterStaffCallback},i=vo(e),n=null,o=!1;return"0BT"===this.tacheRule.rootOrgCanChange?(n=this.tacheRule.beginOrgValue?"".concat(this.tacheRule.beginOrgValue):null,o=!n):(n=this.selectRootNode?"".concat(this.selectRootNode):null,o=!1),i.setChoiceSourceTreeConfig({organization:{startPathIds:n,selectedOrgID:this.selectRootNode,isTop:o,hidden:!["","2"].includes(this.tacheRule.staffCreateType)},project:{startPathIds:n,selectedOrgID:this.selectRootNode,isTop:o,hidden:!["","3"].includes(this.tacheRule.staffCreateType)},dutyLine:{hidden:!0},projectDefined:{hidden:!0}}),i.show(),!1}return!0},onNotifyStaffClickBefore:function(t){if(""===this.tacheRule.notifyStaffType)return this.$message.warning(this.t("tchRule.errorMessage8")),!1;if("fix"===this.tacheRule.notifyStaffType){this.setValue=t;var e={multiple:!0,confirmCallBack:this.staffCallback},i=vo(e),n=null,o=!1;return"0BT"===this.tacheRule.notifyRootOrgCanChange?(n=null,o=!n):(n=this.selectNotifyRootNode?"".concat(this.selectNotifyRootNode):null,o=!1),i.setChoiceSourceTreeConfig({organization:{startPathIds:n,selectedOrgID:this.selectNotifyRootNode,isTop:o,hidden:!["","2"].includes(this.tacheRule.notifyStaffCreateType)},project:{startPathIds:n,selectedOrgID:this.selectNotifyRootNode,isTop:o,hidden:!["","3"].includes(this.tacheRule.notifyStaffCreateType)},dutyLine:{hidden:!0},projectDefined:{hidden:!0}}),i.show(),!1}return!0},filterStaffCallback:function(t){if(t&&1===t.length)this.setValue("type:STAFF AND -id:".concat(t[0].STAFF_ID,"_STAFF"));else if(t&&t.length>1){var e;t.forEach(function(t,i){0===i?e="".concat(t.STAFF_ID,"_STAFF"):e+=" OR ".concat(t.STAFF_ID,"_STAFF")}),this.setValue("type:STAFF AND -id:(".concat(e,")"))}},staffCallback:function(t){if(t){var e="";t.forEach(function(t,i){0===i?e="".concat(t.STAFF_ID,"<i:").concat(t.STAFF_NAME,">"):e+=",".concat(t.STAFF_ID,"<i:").concat(t.STAFF_NAME,">")}),this.setValue(e)}},doCancelAfter:function(){"2"===this.tacheRule.staffCreateType?this.orgDialogVisible=!1:this.teamDialogVisible=!1},doNotifyCancelAfter:function(){"2"===this.tacheRule.notifyStaffCreateType?this.notifyOrgDialogVisible=!1:this.notifyTeamDialogVisible=!1},doNotifyOnSureAfter:function(t){1===t.length&&this.setValue?(this.notifyOrgDialogVisible&&(this.tacheRule.notifyRootOrgValue="".concat(t[0].org_id,"<i:").concat(t[0].org_name,">"),this.setValue("".concat(t[0].org_id,"<i:").concat(t[0].org_name,">"))),this.notifyTeamDialogVisible&&(this.tacheRule.notifyRootOrgValue="".concat(t[0].group_id,"<i:").concat(t[0].group_name,">"),this.setValue("".concat(t[0].group_id,"<i:").concat(t[0].group_name,">")))):this.setValue(""),"2"===this.tacheRule.notifyStaffCreateType?this.notifyOrgDialogVisible=!1:this.notifyTeamDialogVisible=!1},doOnSureAfter:function(t){1===t.length&&this.setValue?(this.orgDialogVisible&&(this.tacheRule.rootOrgValue="".concat(t[0].org_id,"<i:").concat(t[0].org_name,">"),this.setValue("".concat(t[0].org_id,"<i:").concat(t[0].org_name,">"))),this.teamDialogVisible&&(this.tacheRule.rootOrgValue="".concat(t[0].group_id,"<i:").concat(t[0].group_name,">"),this.setValue("".concat(t[0].group_id,"<i:").concat(t[0].group_name,">")))):this.setValue(""),"2"===this.tacheRule.staffCreateType?this.orgDialogVisible=!1:this.teamDialogVisible=!1},addFoldLayers:function(t,e){var i={name:t,type:e};this.$busManage.$emit("addRule",i)},submitTacheRule:function(){return this.$refs.tacheRule.validate()},onBeginOrgValueChange:function(){if(1===this.orgChangeCount)return void this.orgChangeCount++;this.tacheRule.rootOrgValue="",this.tacheRule.defaultStaffValue="",this.tacheRule.filterStaffWhere=""},onTypeChange:function(t){this.tacheRule[t]=""}},beforeDestroy:function(){var t=/<i:[A-Za-z0-9\s*|\u4e00-\u9fa5|:|\/|\\|-]+>/g;if("fix"===this.tacheRule.rootOrgType&&this.tacheRule.rootOrgValue&&(this.tacheRule.rootOrgValue=this.tacheRule.rootOrgValue.replace(t,"")),"fix"===this.tacheRule.defaultStaffType&&this.tacheRule.defaultStaffValue)if("multiInst"===this.node.flowMode&&"1"===this.node.multiInstMerge)this.tacheRule.defaultStaffValue=this.tacheRule.defaultStaffValue.replace(t,"");else{var e=this.tacheRule.defaultStaffValue.split(","),i=e.map(function(e){return e.replace(t,"")}).join(",");this.tacheRule.defaultStaffValue=i}if("fix"===this.tacheRule.notifyRootOrgType&&this.tacheRule.notifyRootOrgValue&&(this.tacheRule.notifyRootOrgValue=this.tacheRule.notifyRootOrgValue.replace(t,"")),"fix"===this.tacheRule.notifyStaffType&&this.tacheRule.notifyStaffValue){var n=this.tacheRule.notifyStaffValue.split(","),o=n.map(function(e){return e.replace(t,"")}).join(",");this.tacheRule.notifyStaffValue=o}this.$emit("getAdvancedProperties",this.tacheRule)}},ur=cr,dr=(i("fcc2"),B(ur,so,lo,!1,null,"031bbf36",null)),fr=dr.exports,pr=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("fi-form",{ref:"nextTacheRule",staticClass:"fmd-nexttch-rule",attrs:{model:t.tacheRule,disabled:t.disabled,size:"small","label-width":"110px"}},[i("fi-row",[i("fi-form-item",{attrs:{label:t.t("nextTchRule.handOption"),prop:"opinionCfg.display","label-width":t.$i18n&&"en"===t.$i18n.locale?"150px":"95px"}},[i("fi-checkbox",{on:{change:t.reloadTacheOption},model:{value:t.tacheRule.opinionCfg.display,callback:function(e){t.$set(t.tacheRule.opinionCfg,"display",e)},expression:"tacheRule.opinionCfg.display"}},[t._v(t._s(t.t("nextTchRule.isShow")))]),t.tacheRule.opinionCfg.display?[t._l(t.tacheRule.opinionCfg.options,function(e,n){return i("fi-row",{key:n,staticClass:"fmd-nexttch-rule--content_opinion"},[t.disabled?t._e():i("fi-col",{staticStyle:{"margin-right":"10px"},attrs:{span:1,title:t.t("nextTchRule.delete")}},[i("i",{staticClass:"el-icon-remove fmd-nexttch-rule--content_opinion__icon",on:{click:function(e){return t.removeOpinions(n)}}})]),i("fi-col",{attrs:{span:8}},[i("fi-form-item",{staticStyle:{"margin-bottom":"10px"},attrs:{prop:"opinionCfg.options."+n+".text",rules:[{required:!0,message:t.t("nextTchRule.errorMessage1"),trigger:["blur","change"]}]}},[i("fi-input",{attrs:{title:"选项文本",placeholder:t.t("nextTchRule.textPlace"),clearable:""},model:{value:e.text,callback:function(i){t.$set(e,"text",i)},expression:"item.text"}})],1)],1),i("fi-col",{attrs:{span:4,offset:1}},[i("fi-form-item",{staticStyle:{"margin-bottom":"10px"},attrs:{prop:"opinionCfg.options."+n+".value",rules:[{required:!0,message:t.t("nextTchRule.errorMessage2"),trigger:["blur","change"]}]}},[i("fi-input",{attrs:{placeholder:t.t("nextTchRule.valuePlace"),title:t.t("nextTchRule.valueText"),clearable:""},model:{value:e.value,callback:function(i){t.$set(e,"value",i)},expression:"item.value"}})],1)],1),i("fi-col",{attrs:{span:4,offset:1}},[i("fi-checkbox",{attrs:{"true-label":e.value},model:{value:t.tacheRule.opinionCfg.selected,callback:function(e){t.$set(t.tacheRule.opinionCfg,"selected",e)},expression:"tacheRule.opinionCfg.selected"}},[t._v(t._s(t.t("nextTchRule.defaultSelect")))])],1)],1)}),t.disabled?t._e():i("fi-row",[i("fi-button",{on:{click:t.addOpinions}},[t._v("+"+t._s(t.t("nextTchRule.addOpinion")))])],1)]:t._e()],2)],1),i("div",{staticClass:"fmd-nexttch-rule--setting"},[i("div",{staticClass:"fmd-nexttch-rule--title"},[i("div",{staticClass:"fmd-nexttch-rule--title_row"},[i("span",{staticClass:"fmd-nexttch-rule--divider"}),t._v(t._s(t.t("nextTchRule.nextTache"))+"\n        "),i("fi-dropdown",{attrs:{trigger:"click"}},[i("span",{staticClass:"el-dropdown-link"},[i("fi-button",{attrs:{type:"text"}},[t._v(t._s(t.dropdown.ruleModel)),i("i",{staticClass:"el-icon-caret-bottom"})])],1),i("fi-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},t._l(t.options.modal,function(e){return i("fi-dropdown-item",{key:e.id,attrs:{disabled:t.disabled},nativeOn:{click:function(i){return t.onDropDownModal("ruleModel",e)}}},[t._v(t._s(e.label))])}),1)],1),2===t.dropdownValue.ruleModel?i("div",{staticClass:"fmd-nexttch-rule--add"},[i("fi-dropdown",{attrs:{type:"text"}},[i("fi-button",{attrs:{type:"text"}},[t._v("\n              "+t._s(t.t("nextTchRule.add"))),i("i",{staticClass:"el-icon-caret-bottom el-icon--right"})]),i("fi-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[i("fi-dropdown-item",{nativeOn:{click:function(e){t.addFoldLayers(t.t("nextTchRule.nextTache"),1)}}},[t._v(t._s(t.t("nextTchRule.addRule")))])],1)],1)],1):t._e()],1)]),2===t.dropdownValue.ruleModel?i("div",[i("fmd-tache-cfg",{attrs:{node:t.node,revisionId:t.revisionId,dirCondition:t.dirCondition,tacheRule:t.tacheRule,foldingLayer:t.ruleNextTacheData,disabled:t.disabled,type:1}})],1):t._e(),1===t.dropdownValue.ruleModel?i("div",{staticClass:"fmd-nexttch-rule--content"},[i("fi-row",{staticClass:"fmd-nexttch-rule--content_row"},[i("fi-const-textarea",{attrs:{options:t.tableItems,custom:"form"===t.tacheRule.nextTchsType||"fix"===t.tacheRule.nextTchsType,"show-label":!1},model:{value:t.tacheRule.nextTchsValue,callback:function(e){t.$set(t.tacheRule,"nextTchsValue",e)},expression:"tacheRule.nextTchsValue"}},[i("div",[i("i",{staticClass:"fa fa-question-circle-o"}),t._v(t._s(t.t("nextTchRule.defaultCfg"))+"：\n            "),i("fi-select",{staticClass:"fmd-nexttch-rule--select",attrs:{clearable:""},on:{change:t.onNextTchsTypeChange},model:{value:t.tacheRule.nextTchsType,callback:function(e){t.$set(t.tacheRule,"nextTchsType",e)},expression:"tacheRule.nextTchsType"}},t._l(t.options.nextTchsType,function(t){return i("fi-option",{key:t.id,attrs:{value:t.id,label:t.label}})}),1),i("fi-checkbox",{staticClass:"fmd-nexttch-rule--content_check",attrs:{"true-label":"0BT","false-label":"0BF"},model:{value:t.tacheRule.nextTchsCanChange,callback:function(e){t.$set(t.tacheRule,"nextTchsCanChange",e)},expression:"tacheRule.nextTchsCanChange"}},[t._v(t._s(t.t("nextTchRule.allowUpdate")))]),i("fi-checkbox",{staticClass:"fmd-nexttch-rule--content_check",attrs:{"true-label":"0BT","false-label":"0BF"},model:{value:t.tacheRule.nextTchsIsSelected,callback:function(e){t.$set(t.tacheRule,"nextTchsIsSelected",e)},expression:"tacheRule.nextTchsIsSelected"}},[t._v(t._s(t.t("nextTchRule.defaultSelect")))]),i("fi-checkbox",{staticClass:"fmd-nexttch-rule--content_check",attrs:{"true-label":"0BT","false-label":"0BF"},model:{value:t.tacheRule.nextTchsIsHiddenOther,callback:function(e){t.$set(t.tacheRule,"nextTchsIsHiddenOther",e)},expression:"tacheRule.nextTchsIsHiddenOther"}},[t._v(t._s(t.t("nextTchRule.hideOther")))])],1)])],1)],1):t._e()])],1)},gr=[],_r={name:"fmd-nexttch-rule",mixins:[bn.localeMixin],props:{node:Object,tableOptions:Array,disabled:Boolean,revisionId:String,dirCondition:Object,ruleNextTacheData:Array},components:{FmdTacheCfg:hr},computed:{},data:function(){return{tacheRule:this.node.advancedProperties||{},dropdown:{ruleModel:this.t("options.devMode"),nextTchsType:this.t("options.placeHolder")},dropdownValue:{ruleModel:1},options:{nextTchsType:[{id:"fix",label:this.t("options.fix")},{id:"form",label:this.t("options.formElement")},{id:"sqlFunc",label:this.t("options.sqlFunc")},{id:"js",label:this.t("options.jsFunc")}],modal:[{id:1,label:this.t("options.devMode")},{id:2,label:this.t("options.customMode")}]},tableItems:this.tableOptions||[]}},created:function(){var t=this;["nextTchsType"].forEach(function(e){t.initDropdown(e)}),this.dropdown.ruleModel="rule"===this.tacheRule.nextTchsType?this.t("options.customMode"):this.t("options.devMode"),this.dropdownValue.ruleModel="rule"===this.tacheRule.nextTchsType?2:1},methods:{initDropdown:function(t){var e=this;if(this.tacheRule&&this.tacheRule[t]){var i=this.options.nextTchsType.find(function(i){return i.id===e.tacheRule[t]});this.dropdown[t]=i&&i.label||this.t("options.placeHolder")}},onNextTchsTypeChange:function(t){this.tableItems="fix"===t?[]:this.tableOptions},onDropDownModal:function(t,e){this.dropdown[t]=e.label,this.dropdownValue[t]=e.id,this.tacheRule.nextTchsType=2===e.id?"rule":""},addOpinions:function(){var t={text:"",value:"".concat(this.tacheRule.opinionCfg.options.length+1)};this.tacheRule.opinionCfg.options.push(t)},removeOpinions:function(t){this.tacheRule.opinionCfg.options.splice(t,1)},validate:function(){return this.$refs.nextTacheRule.validate()},addFoldLayers:function(t,e){var i={name:t,type:e};this.$busManage.$emit("addRule",i)},reloadTacheOption:function(t){this.$busManage.$emit("regularOption",t)}},beforeDestroy:function(){this.$emit("getAdvancedProperties",this.tacheRule)}},mr=_r,vr=(i("f79e"),B(mr,pr,gr,!1,null,"2e4e08a4",null)),yr=vr.exports,wr=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"fmd-display-setting"},[i("fi-table",{attrs:{data:t.tableData,border:"",size:"small","span-method":t.objectSpanMethod}},[i("fi-table-column",{attrs:{prop:"infoBlock",label:t.t("displaySetting.infoBlock")}}),i("fi-table-column",{attrs:{prop:t.$i18n&&"en"===t.$i18n.locale?"fieldNameUs":"fieldNameCn",label:t.t("displaySetting.fieldNameCn")}}),i("fi-table-column",{scopedSlots:t._u([{key:"header",fn:function(e){return[i("fi-checkbox",{attrs:{disabled:t.disabled,label:t.t("displaySetting.show")},on:{change:function(e){return t.onCheckedAll(t.isShowAll,"isShow")}},model:{value:t.isShowAll,callback:function(e){t.isShowAll=e},expression:"isShowAll"}})]}},{key:"default",fn:function(e){return[i("fi-checkbox",{attrs:{disabled:t.disabled,"true-label":"T","false-label":"F"},model:{value:e.row.isShow,callback:function(i){t.$set(e.row,"isShow",i)},expression:"scope.row.isShow"}},[t._v(t._s(t.t("displaySetting.show")))])]}}])}),i("fi-table-column",{attrs:{prop:"isReadonly",label:t.t("displaySetting.readonly")},scopedSlots:t._u([{key:"header",fn:function(e){return[i("fi-checkbox",{attrs:{disabled:t.disabled,label:t.t("displaySetting.isReadonly")},on:{change:function(e){return t.onCheckedAll(t.isReadOnlyAll,"isReadonly")}},model:{value:t.isReadOnlyAll,callback:function(e){t.isReadOnlyAll=e},expression:"isReadOnlyAll"}})]}},{key:"default",fn:function(e){return[i("fi-checkbox",{attrs:{disabled:t.disabled||"F"===e.row.isShow,"true-label":"T","false-label":"F"},on:{change:function(t){e.row.isRequire="T"===e.row.isReadonly?"F":e.row.isRequire}},model:{value:e.row.isReadonly,callback:function(i){t.$set(e.row,"isReadonly",i)},expression:"scope.row.isReadonly"}},[t._v(t._s(t.t("displaySetting.readonly")))])]}}])}),i("fi-table-column",{attrs:{prop:"isRequire",label:t.t("displaySetting.require")},scopedSlots:t._u([{key:"header",fn:function(e){return[i("fi-checkbox",{attrs:{disabled:t.disabled,label:t.t("displaySetting.require")},on:{change:function(e){return t.onCheckedAll(t.isRequireAll,"isRequire")}},model:{value:t.isRequireAll,callback:function(e){t.isRequireAll=e},expression:"isRequireAll"}})]}},{key:"default",fn:function(e){return[i("fi-checkbox",{attrs:{disabled:t.disabled||"F"===e.row.isShow||"T"===e.row.isReadonly,"true-label":"T","false-label":"F"},model:{value:e.row.isRequire,callback:function(i){t.$set(e.row,"isRequire",i)},expression:"scope.row.isRequire"}},[t._v(t._s(t.t("displaySetting.require")))])]}}])})],1),i("fi-form",{staticStyle:{"margin-top":"10px"},attrs:{model:t.node.tacheForm,"label-width":t.$i18n&&"en"===t.$i18n.locale?"138px":"100px"}},[i("fi-form-item",{attrs:{prop:"formAction"}},[i("template",{slot:"label"},[i("fi-popover",{attrs:{placement:"bottom-start",width:"100%",trigger:"hover"}},[i("p",[t._v(t._s(t.t("displaySetting.formAction1")))]),i("p",[t._v(t._s(t.t("displaySetting.formAction2")))]),i("p",[t._v(t._s(t.t("displaySetting.formAction3")))]),i("p",[t._v(t._s(t.t("displaySetting.formAction4")))]),i("div",{staticClass:"model-select",attrs:{slot:"reference"},slot:"reference"},[i("i",{staticClass:"fa fa-question-circle-o"}),t._v(t._s(t.t("displaySetting.displayMode"))+"：\n          ")])])],1),i("fi-radio-group",{attrs:{disabled:t.disabled||t.formActionDisabled},model:{value:t.node.tacheForm.formAction,callback:function(e){t.$set(t.node.tacheForm,"formAction",e)},expression:"node.tacheForm.formAction"}},[i("fi-radio",{attrs:{disabled:!t.formActionDisabled,label:"C"}},[t._v(t._s(t.t("displaySetting.createMode")))]),i("fi-radio",{attrs:{label:"E"}},[t._v(t._s(t.t("displaySetting.writeMode")))]),i("fi-radio",{attrs:{label:"R"}},[t._v(t._s(t.t("displaySetting.readMode")))]),i("fi-radio",{attrs:{label:"M"}},[t._v(t._s(t.t("displaySetting.mixMode")))])],1)],2)],1)],1)},br=[],xr=["5","21","22","36","39","41","43","46","98","99"],Ar={name:"fmd-display-setting",mixins:[bn.localeMixin],props:{node:Object,disabled:Boolean},data:function(){var t=this;return{orderIndexArr:[],isShowAll:!1,isReadOnlyAll:!1,isRequireAll:!1,isAppendAll:!1,formActionDisabled:!1,tableData:this.node.tacheForm.fieldRights.filter(function(e){return!xr.includes(e.xtype)&&e.infoBlock!==t.t("displaySetting.staffInfo")&&e.infoBlock})}},mounted:function(){"1"===this.node.tchType&&(this.node.tacheForm.formAction="C",this.formActionDisabled=!0),this.getSpanArr()},methods:{objectSpanMethod:function(t){var e=t.rowIndex;if(0===t.columnIndex){var i=this.orderIndexArr[e];return{rowspan:i,colspan:i>0?1:0}}return!1},getSpanArr:function(){var t=this,e=0;this.tableData=this.tableData.sort(this.compareFieldRights("infoBlock")),this.tableData.forEach(function(i,n){0===n?(t.orderIndexArr.push(1),e=0):i.infoBlock===t.tableData[n-1].infoBlock?(t.orderIndexArr[e]+=1,t.orderIndexArr.push(0)):(t.orderIndexArr.push(1),e=n)})},compareFieldRights:function(t){return function(e,i){var n=e[t],o=i[t];return n>o?1:n<o?-1:0}},onCheckedAll:function(t,e){this.tableData.forEach(function(i){i[e]=t?"T":"F"})}}},Cr=Ar,Tr=(i("b25f"),B(Cr,wr,br,!1,null,"18cf8b1e",null)),kr=Tr.exports,Sr=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("fi-form",{ref:"advanceForm",staticClass:"fmd-advance-setting",attrs:{rules:t.advanceFormRule,disabled:t.disabled,model:t.advanceForm,size:"small","label-width":"165px"}},[i("fi-row",[i("fi-form-item",{attrs:{prop:"onCreate",label:t.t("advanceSetting.onCreate")}},[i("fi-const-textarea",{attrs:{options:t.tableItems,"show-label":!1},model:{value:t.advanceForm.onCreate,callback:function(e){t.$set(t.advanceForm,"onCreate",e)},expression:"advanceForm.onCreate"}},[i("fi-select",{attrs:{placeholder:t.t("advanceSetting.onPlaceHolder"),clearable:"",options:t.options.before},model:{value:t.advanceForm.onCreateType,callback:function(e){t.$set(t.advanceForm,"onCreateType",e)},expression:"advanceForm.onCreateType"}})],1)],1)],1),i("fi-row",[i("fi-form-item",{attrs:{prop:"onAfterCreate",label:t.t("advanceSetting.onAfterCreate")}},[i("fi-const-textarea",{attrs:{options:t.tableItems,"show-label":!1},model:{value:t.advanceForm.onAfterCreate,callback:function(e){t.$set(t.advanceForm,"onAfterCreate",e)},expression:"advanceForm.onAfterCreate"}},[i("fi-select",{attrs:{placeholder:t.t("advanceSetting.onPlaceHolder"),clearable:"",options:t.options.after},model:{value:t.advanceForm.onAfterCreateType,callback:function(e){t.$set(t.advanceForm,"onAfterCreateType",e)},expression:"advanceForm.onAfterCreateType"}})],1)],1)],1),i("fi-row",[i("fi-form-item",{attrs:{prop:"onBeforeFinish",label:t.t("advanceSetting.onBeforeFinish")}},[i("fi-const-textarea",{attrs:{v:"","show-label":!1},model:{value:t.advanceForm.onBeforeFinish,callback:function(e){t.$set(t.advanceForm,"onBeforeFinish",e)},expression:"advanceForm.onBeforeFinish"}},[i("fi-select",{attrs:{placeholder:t.t("advanceSetting.placeHolder"),clearable:"",options:t.options.before},model:{value:t.advanceForm.onBeforeFinishType,callback:function(e){t.$set(t.advanceForm,"onBeforeFinishType",e)},expression:"advanceForm.onBeforeFinishType"}})],1)],1)],1),i("fi-row",[i("fi-form-item",{attrs:{prop:"onAfterFinish",label:t.t("advanceSetting.onAfterFinish")}},[i("fi-const-textarea",{attrs:{v:"","show-label":!1},model:{value:t.advanceForm.onAfterFinish,callback:function(e){t.$set(t.advanceForm,"onAfterFinish",e)},expression:"advanceForm.onAfterFinish"}},[i("fi-select",{attrs:{placeholder:t.t("advanceSetting.placeHolder"),clearable:"",options:t.options.after},model:{value:t.advanceForm.onAfterFinishType,callback:function(e){t.$set(t.advanceForm,"onAfterFinishType",e)},expression:"advanceForm.onAfterFinishType"}})],1)],1)],1),i("fi-row",[i("fi-form-item",{attrs:{prop:"defaultOpinionValue",label:t.t("advanceSetting.defaultOpinionValue")}},[i("fi-const-textarea",{attrs:{custom:t.isCustom,options:t.tableItems,"show-label":!1},model:{value:t.advanceForm.defaultOpinionValue,callback:function(e){t.$set(t.advanceForm,"defaultOpinionValue",e)},expression:"advanceForm.defaultOpinionValue"}},[i("fi-select",{attrs:{placeholder:t.t("advanceSetting.opinionPlace")},on:{change:t.onDefaultOpinionTypeChange},model:{value:t.advanceForm.defaultOpinionType,callback:function(e){t.$set(t.advanceForm,"defaultOpinionType",e)},expression:"advanceForm.defaultOpinionType"}},t._l(t.options.defaultOptions,function(t){return i("fi-option",{key:t.value,attrs:{value:t.value,label:t.label}})}),1)],1)],1)],1),i("fi-row",[i("fi-col",[i("fi-form-item",{attrs:{label:t.t("advanceSetting.isAuto"),prop:"isAuto","label-width":t.$i18n&&"en"===t.$i18n.locale?"250px":"165px"}},[i("fi-switch",{attrs:{"active-text":t.t("advanceSetting.yes"),"active-value":"0BT","inactive-text":t.t("advanceSetting.no"),"inactive-value":"0BF",type:"inside"},model:{value:t.advanceForm.isAuto,callback:function(e){t.$set(t.advanceForm,"isAuto",e)},expression:"advanceForm.isAuto"}})],1)],1)],1),"2"!==t.node.tchType?i("fi-row",[i("fi-form-item",{attrs:{prop:"execDesc",label:t.t("advanceSetting.execDesc"),"label-width":t.$i18n&&"en"===t.$i18n.locale?"250px":"165px"}},[i("fi-input",{model:{value:t.advanceForm.execDesc,callback:function(e){t.$set(t.advanceForm,"execDesc",e)},expression:"advanceForm.execDesc"}})],1)],1):t._e(),i("fi-row",[i("fi-form-item",{attrs:{label:t.t("advanceSetting.execStaffLabel"),"label-width":t.$i18n&&"en"===t.$i18n.locale?"250px":"165px"}},[i("fi-checkbox",{model:{value:t.advanceForm.backCfg.isDefaultTacheExecStaff,callback:function(e){t.$set(t.advanceForm.backCfg,"isDefaultTacheExecStaff",e)},expression:"advanceForm.backCfg.isDefaultTacheExecStaff"}},[t._v(t._s(t.t("advanceSetting.isDefaultTacheExecStaff")))])],1)],1),"2"!==t.node.tchType?i("fi-row",[i("fi-form-item",{attrs:{label:t.t("advanceSetting.opinionType"),prop:"opinionType"}},[i("fi-radio-group",{model:{value:t.advanceForm.opinionType,callback:function(e){t.$set(t.advanceForm,"opinionType",e)},expression:"advanceForm.opinionType"}},[i("fi-radio",{attrs:{label:"H"}},[t._v(t._s(t.t("advanceSetting.H")))]),i("fi-radio",{attrs:{label:"SO"}},[t._v(t._s(t.t("advanceSetting.SO")))]),i("fi-radio",{attrs:{label:"SR"}},[t._v(t._s(t.t("advanceSetting.SR")))])],1)],1)],1):t._e(),i("fi-row",[i("fi-form-item",{attrs:{prop:"endTaskTitle",label:t.t("advanceSetting.endTaskTitle"),"label-width":t.$i18n&&"en"===t.$i18n.locale?"250px":"165px"}},[i("fi-input",{attrs:{placeholder:t.t("advanceSetting.taskPlace")},model:{value:t.advanceForm.endTaskTitle,callback:function(e){t.$set(t.advanceForm,"endTaskTitle",e)},expression:"advanceForm.endTaskTitle"}})],1)],1),i("fi-row",[i("fi-form-item",{attrs:{prop:"endTaskTitleUs",label:t.t("advanceSetting.endTaskTitleUs"),"label-width":t.$i18n&&"en"===t.$i18n.locale?"250px":"165px"}},[i("fi-input",{attrs:{placeholder:t.t("advanceSetting.taskPlaceUs")},model:{value:t.advanceForm.endTaskTitleUs,callback:function(e){t.$set(t.advanceForm,"endTaskTitleUs",e)},expression:"advanceForm.endTaskTitleUs"}})],1)],1),i("fi-row",[i("fi-form-item",{attrs:{label:t.t("advanceSetting.sortId"),prop:"sortId","label-width":t.$i18n&&"en"===t.$i18n.locale?"250px":"165px"}},[i("fi-input-number",{attrs:{min:0,label:t.t("advanceSetting.sortId")},model:{value:t.advanceForm.sortId,callback:function(e){t.$set(t.advanceForm,"sortId",e)},expression:"advanceForm.sortId"}})],1)],1),"2"!==t.node.tchType?i("fi-row",[i("fi-form-item",{attrs:{label:t.t("advanceSetting.isPool"),prop:"isPool","label-width":t.$i18n&&"en"===t.$i18n.locale?"250px":"165px"}},[i("fi-switch",{attrs:{"active-text":t.t("advanceSetting.yes"),"active-value":"0BT","inactive-text":t.t("advanceSetting.no"),"inactive-value":"0BF",type:"inside"},model:{value:t.advanceForm.isPool,callback:function(e){t.$set(t.advanceForm,"isPool",e)},expression:"advanceForm.isPool"}})],1)],1):t._e(),i("fi-form-item",{attrs:{label:t.t("advanceSetting.dialogLabel"),"label-width":t.$i18n&&"en"===t.$i18n.locale?"250px":"165px"}},[i("fi-col",{attrs:{span:6}},[i("fi-checkbox",{attrs:{"true-label":"1","false-label":"0"},model:{value:t.advanceForm.winStyle.fullScreen,callback:function(e){t.$set(t.advanceForm.winStyle,"fullScreen",e)},expression:"advanceForm.winStyle.fullScreen"}},[t._v(t._s(t.t("advanceSetting.isFull")))])],1),"1"!==t.advanceForm.winStyle.fullScreen?[i("fi-col",{attrs:{span:8}},[i("fi-input",{attrs:{placeholder:t.t("advanceSetting.dialogWidth"),clearable:""},model:{value:t.advanceForm.winStyle.width,callback:function(e){t.$set(t.advanceForm.winStyle,"width",e)},expression:"advanceForm.winStyle.width"}})],1),i("fi-col",{attrs:{span:7,offset:1}},[i("fi-input",{attrs:{placeholder:t.t("advanceSetting.dialogHeight"),clearable:""},model:{value:t.advanceForm.winStyle.height,callback:function(e){t.$set(t.advanceForm.winStyle,"height",e)},expression:"advanceForm.winStyle.height"}})],1)]:t._e()],2),i("fi-form-item",{attrs:{label:t.t("advanceSetting.isFreeFlow"),prop:"isFreeFlow"}},[i("fi-switch",{attrs:{"active-text":t.t("advanceSetting.yes"),"active-value":"0BT","inactive-text":t.t("advanceSetting.no"),"inactive-value":"0BF",type:"inside"},model:{value:t.advanceForm.isFreeFlow,callback:function(e){t.$set(t.advanceForm,"isFreeFlow",e)},expression:"advanceForm.isFreeFlow"}})],1),t.node.flowMode&&t.node.flowMode.includes("multiInst")||t.node.flowMode&&t.node.flowMode.includes("serial")?i("div",{staticClass:"countersign-cfg"},[i("h4",[t._v(t._s(t.t("advanceSetting.countersignCfg"))+"：")]),t.node.flowMode&&t.node.flowMode.includes("multiInst")?i("fi-row",[i("fi-form-item",{attrs:{label:t.t("advanceSetting.parallelCfg")}},[i("fi-col",{attrs:{span:6}},[i("fi-checkbox",{on:{change:function(e){return t.serialCheckChange(t.advanceForm.countersignCfg.parallel.checked,"serial")}},model:{value:t.advanceForm.countersignCfg.parallel.checked,callback:function(e){t.$set(t.advanceForm.countersignCfg.parallel,"checked",e)},expression:"advanceForm.countersignCfg.parallel.checked"}},[t._v(t._s(t.t("advanceSetting.isChecked")))])],1),i("fi-col",{attrs:{span:6}},[i("fi-checkbox",{model:{value:t.advanceForm.countersignCfg.parallel.display,callback:function(e){t.$set(t.advanceForm.countersignCfg.parallel,"display",e)},expression:"advanceForm.countersignCfg.parallel.display"}},[t._v(t._s(t.t("advanceSetting.isShow")))])],1),i("fi-col",{attrs:{span:6}},[i("fi-input",{attrs:{placeholder:t.t("advanceSetting.parallelText")},model:{value:t.advanceForm.countersignCfg.parallel.text,callback:function(e){t.$set(t.advanceForm.countersignCfg.parallel,"text",e)},expression:"advanceForm.countersignCfg.parallel.text"}})],1),i("fi-col",{attrs:{span:6}},[i("fi-input",{attrs:{placeholder:t.t("advanceSetting.parallelUs")},model:{value:t.advanceForm.countersignCfg.parallel.textus,callback:function(e){t.$set(t.advanceForm.countersignCfg.parallel,"textus",e)},expression:"advanceForm.countersignCfg.parallel.textus"}})],1)],1)],1):t._e(),t.node.flowMode&&t.node.flowMode.includes("serial")?i("fi-row",[i("fi-form-item",{attrs:{label:t.t("advanceSetting.serialCfg")}},[i("fi-col",{attrs:{span:6}},[i("fi-checkbox",{on:{change:function(e){return t.serialCheckChange(t.advanceForm.countersignCfg.serial.checked,"parallel")}},model:{value:t.advanceForm.countersignCfg.serial.checked,callback:function(e){t.$set(t.advanceForm.countersignCfg.serial,"checked",e)},expression:"advanceForm.countersignCfg.serial.checked"}},[t._v(t._s(t.t("advanceSetting.isChecked")))])],1),i("fi-col",{attrs:{span:6}},[i("fi-checkbox",{model:{value:t.advanceForm.countersignCfg.serial.display,callback:function(e){t.$set(t.advanceForm.countersignCfg.serial,"display",e)},expression:"advanceForm.countersignCfg.serial.display"}},[t._v(t._s(t.t("advanceSetting.isShow")))])],1),i("fi-col",{attrs:{span:6}},[i("fi-input",{attrs:{placeholder:t.t("advanceSetting.parallelText")},model:{value:t.advanceForm.countersignCfg.serial.text,callback:function(e){t.$set(t.advanceForm.countersignCfg.serial,"text",e)},expression:"advanceForm.countersignCfg.serial.text"}})],1),i("fi-col",{attrs:{span:6}},[i("fi-input",{attrs:{placeholder:t.t("advanceSetting.parallelUs")},model:{value:t.advanceForm.countersignCfg.serial.textus,callback:function(e){t.$set(t.advanceForm.countersignCfg.serial,"textus",e)},expression:"advanceForm.countersignCfg.serial.textus"}})],1)],1)],1):t._e(),t.node.flowMode&&t.node.flowMode.includes("multiInst")?i("fi-row",[i("fi-form-item",{attrs:{label:t.t("advanceSetting.multiInstMerge"),"label-width":t.$i18n&&"en"===t.$i18n.locale?"230px":"165px"}},[i("fi-switch",{attrs:{"active-text":t.t("advanceSetting.yes"),"active-value":"1","inactive-text":t.t("advanceSetting.no"),"inactive-value":"0",type:"inside"},model:{value:t.node.multiInstMerge,callback:function(e){t.$set(t.node,"multiInstMerge",e)},expression:"node.multiInstMerge"}})],1)],1):t._e()],1):t._e(),"2"!==t.node.tchType?i("fi-row",[i("fi-form-item",{attrs:{label:t.t("advanceSetting.isStartOa"),prop:"oa.isStartOa","label-width":t.$i18n&&"en"===t.$i18n.locale?"230px":"165px"}},[i("fi-switch",{attrs:{"active-text":t.t("advanceSetting.yes"),"active-value":"0BT","inactive-text":t.t("advanceSetting.no"),"inactive-value":"0BF",type:"inside"},on:{change:t.onStartOaChange},model:{value:t.advanceForm.oa.isStartOa,callback:function(e){t.$set(t.advanceForm.oa,"isStartOa",e)},expression:"advanceForm.oa.isStartOa"}})],1)],1):t._e(),"0BT"===t.advanceForm.oa.isStartOa?i("fi-row",[i("together-manager",{attrs:{disabled:t.disabled,oaData:t.advanceForm.oa,node:t.node,dirCondition:t.dirCondition,ruleRoleGroupData:t.ruleRoleGroupData}})],1):t._e()],1)},Er=[],Ir=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("fi-form",{staticClass:"together-manage",attrs:{model:t.managerData,rules:t.rules,disabled:t.disabled}},[i("fi-divider"),i("div",{staticClass:"together-manage--modal"},[i("span",{staticClass:"together-manage--modal_text"},[t._v("  "+t._s(t.t("togetherComp.linkBranchPeople")))]),i("fi-dropdown",{attrs:{trigger:"click"}},[i("span",{staticClass:"together-manage--modal_dropdown"},[i("fi-button",{attrs:{type:"text"}},[t._v(t._s(t.dropdown.label)),i("i",{staticClass:"el-icon-caret-bottom"})])],1),i("fi-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},t._l(t.options.modal,function(e){return i("fi-dropdown-item",{key:e.id,attrs:{disabled:t.disabled},nativeOn:{click:function(i){return t.onDropDownModal(e)}}},[t._v(t._s(e.label))])}),1)],1),2===t.dropdown.id?i("fi-button",{staticClass:"together-manage--modal_btn",attrs:{type:"text"},nativeOn:{click:function(e){t.addFoldLayers(t.t("togetherComp.linkBranchPeople"),5)}}},[i("i",{staticClass:"el-icon-circle-plus-outline"})]):t._e(),i("div",{staticClass:"notice"},[i("fi-form-item",{attrs:{label:t.t("options.notyfyType"),"label-width":"90px"}},[i("fi-checkbox",{attrs:{"true-label":"true","false-label":"false"},model:{value:t.managerData.notifyConfig.sms.selected,callback:function(e){t.$set(t.managerData.notifyConfig.sms,"selected",e)},expression:"managerData.notifyConfig.sms.selected"}},[t._v(t._s(t.t("options.sms")))]),i("fi-checkbox",{attrs:{"true-label":"true","false-label":"false"},model:{value:t.managerData.notifyConfig.mail.selected,callback:function(e){t.$set(t.managerData.notifyConfig.mail,"selected",e)},expression:"managerData.notifyConfig.mail.selected"}},[t._v(t._s(t.t("options.email")))])],1)],1),i("fi-divider"),2===t.dropdown.id?i("div",[i("fmd-tache-cfg",{attrs:{node:t.node,revisionId:t.revisionId,dirCondition:t.dirCondition,foldingLayer:t.ruleRoleGroupData,disabled:t.disabled,type:5}})],1):i("div",[i("fi-row",[i("fi-col",{staticStyle:{"margin-top":"13px"},attrs:{span:10}},[i("fi-form-item",{attrs:{prop:"staffCreateType",label:t.t("options.staffCreateType"),"label-width":"110px"}},[i("fi-select",{staticClass:"w100",attrs:{size:"small",placeholder:t.t("options.staffCreateType")},on:{change:function(e){return t.onChangeStaffType(t.managerData.staffCreateType)}},model:{value:t.managerData.staffCreateType,callback:function(e){t.$set(t.managerData,"staffCreateType",e)},expression:"managerData.staffCreateType"}},t._l(t.options.staffCreateType,function(t){return i("fi-option",{key:t.id,attrs:{value:t.id,label:t.label}})}),1)],1)],1),i("fi-col",{attrs:{span:14}},[i("fi-form-item",{attrs:{label:t.t("options.beginOrgValue")}},[i("processing-scope",{attrs:{editable:!t.disabled,type:t.managerData.staffCreateType,disabled:""===t.managerData.staffCreateType,placeholder:t.t("options.placeHolder")},model:{value:t.managerData.beginOrgValue,callback:function(e){t.$set(t.managerData,"beginOrgValue",e)},expression:"managerData.beginOrgValue"}})],1)],1)],1),i("fi-row",[i("fi-form-item",{attrs:{prop:"rootOrgValue","label-width":"0"}},[i("fi-const-textarea",{attrs:{custom:"form"===t.managerData.rootOrgType,options:t.tableOptions,disabled:""===t.managerData.staffCreateType,"show-label":!1,"click-before":t.onRootOrgClickBefore},model:{value:t.managerData.rootOrgValue,callback:function(e){t.$set(t.managerData,"rootOrgValue",e)},expression:"managerData.rootOrgValue"}},[i("div",{staticClass:"h32"},[i("fi-tooltip",{attrs:{slot:"suffix",effect:"dark",placement:"bottom"},slot:"suffix"},[i("div",{attrs:{slot:"content"},slot:"content"},[t._v("\n                  "+t._s(t.t("togetherComp.rootOrgValueTip"))+"\n                ")]),i("i",{staticClass:"fa fa-question-circle-o"})]),t._v(t._s(t.t("options.rootOrgType"))+"：\n              "),""!==t.managerData.staffCreateType?i("fi-select",{staticClass:"together-manage--modal_select",attrs:{size:"small",clearable:""},model:{value:t.managerData.rootOrgType,callback:function(e){t.$set(t.managerData,"rootOrgType",e)},expression:"managerData.rootOrgType"}},t._l(t.options.rootOrgType,function(t){return i("fi-option",{key:t.id,attrs:{value:t.id,label:t.label}})}),1):t._e()],1)])],1)],1)],1)],1),i("div",{staticClass:"together-manage--role"},[i("span",{staticClass:"together-manage--role_text"},[t._v(t._s(t.t("togetherComp.roleConfig")))]),i("div",{staticClass:"together-manage--role_btn"},[i("fi-button",{staticClass:"together-manage--role_detail",attrs:{type:"text"},on:{click:t.openOaRolePage}},[t._v(t._s(t.t("togetherComp.detailBtn")))]),i("fi-button",{staticClass:"together-manage--role_new",attrs:{type:"text"},on:{click:function(e){t.isShowAdd=!0}}},[t._v(t._s(t.t("togetherComp.newCreateBtn")))])],1)]),i("fi-row",[null!=t.roleGroupDir&&t.roleGroupDir.length>0?i("fi-select",{attrs:{size:"small",clearable:"",placeholder:t.t("togetherComp.roleGroupPlace")},model:{value:t.managerData.roleGroupId,callback:function(e){t.$set(t.managerData,"roleGroupId",e)},expression:"managerData.roleGroupId"}},t._l(t.roleGroupDir,function(t,e){return i("fi-option",{key:e,attrs:{label:t.ROLE_GROUP_NAME,value:t.ROLE_GROUP_ID}})}),1):t._e()],1),i("fi-row",{staticClass:"together-manage_lastline"},[i("fi-divider")],1),t.disabled?t._e():i("fui-el-dialog-transfer-choice",{attrs:{"dialog-visible":t.orgDialogVisible,action:"ORG","start-paths":t.managerData.beginOrgValue,"selected-node":t.selectRootNode,"is-top":!t.managerData.beginOrgValue,multiple:!1},on:{"on-cancel-after":t.doCancelAfter,"on-sure-after":t.doOnSureAfter},model:{value:t.checkedOrganzations,callback:function(e){t.checkedOrganzations=e},expression:"checkedOrganzations"}}),t.disabled?t._e():i("fui-el-dialog-transfer-choice",{attrs:{"dialog-visible":t.teamDialogVisible,action:"TEAM","start-paths":t.managerData.beginOrgValue,"selected-node":t.selectRootNode,"is-top":!1,multiple:!1},on:{"on-cancel-after":t.doCancelAfter,"on-sure-after":t.doOnSureAfter},model:{value:t.checkedTeam,callback:function(e){t.checkedTeam=e},expression:"checkedTeam"}}),i("oa-roler-page",{attrs:{visible:t.isShowPage,roleGroupDir:t.roleGroupDir,ruleRoleGroupData:t.ruleRoleGroupData,roleGroupId:t.managerData.roleGroupId},on:{"update:visible":function(e){t.isShowPage=e}}}),i("oa-roler-add",{attrs:{visible:t.isShowAdd},on:{"update:visible":function(e){t.isShowAdd=e},reloadGroupDir:t.getRoleGroupDir}})],1)},Lr=[],Rr=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("section",{attrs:{id:"oaRolePage"}},[i("fi-dialog",{attrs:{title:t.t("tacheComp.roleConfig"),visible:t.dialogFormVisible,"close-on-click-modal":!1,"close-on-press-escape":!1,width:"935px","before-close":t.beforeClose},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[i("fi-row",[i("fi-col",{attrs:{span:8}},[i("fi-col",{attrs:{span:13}},[null!=t.roleGroupList&&t.roleGroupList.length>0?i("fi-select",{attrs:{size:"small",placeholder:t.t("tacheComp.selectRoleGroup")},on:{change:t.searchData},model:{value:t.searchQuery.roleGroupId,callback:function(e){t.$set(t.searchQuery,"roleGroupId",e)},expression:"searchQuery.roleGroupId"}},t._l(t.roleGroupList,function(t,e){return i("fi-option",{key:e,attrs:{label:t.ROLE_GROUP_NAME,value:t.ROLE_GROUP_ID}})}),1):t._e()],1),i("fi-col",{staticClass:"header-padding",attrs:{span:11}},[""!=t.searchQuery.roleGroupId?i("fi-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){return t.addRow(t.tableDataTemp)}}},[t._v(t._s(t.t("tacheComp.createStaff")))]):t._e()],1)],1),i("fi-col",{attrs:{span:4,offset:7}},[i("fi-select",{attrs:{size:"small",placeholder:t.t("tacheComp.selectRole")},on:{change:t.searchData},model:{value:t.searchQuery.roleType,callback:function(e){t.$set(t.searchQuery,"roleType",e)},expression:"searchQuery.roleType"}},[i("fi-option",{attrs:{value:"",label:t.t("tacheComp.allRole")}}),t._l(t.roleDir,function(t,e){return i("fi-option",{key:e,attrs:{label:t.text,value:t.value}})})],2)],1),i("fi-col",{staticClass:"header-padding",attrs:{span:5}},[i("fi-input",{staticClass:"edit-cell",attrs:{size:"small",placeholder:t.t("tacheComp.searchStaff"),"suffix-icon":"el-icon-search"},on:{change:t.searchData},model:{value:t.searchQuery.staffName,callback:function(e){t.$set(t.searchQuery,"staffName",e)},expression:"searchQuery.staffName"}})],1)],1),i("fi-row",{staticClass:"content-top"},[i("fi-table",{staticStyle:{width:"100%"},attrs:{data:t.tableDataTemp,"tooltip-effect":"dark",border:"","header-row-class-name":"header-bg-style",size:"small","header-align":"center"}},[i("fi-table-column",{attrs:{prop:"STAFF_NAME","header-align":"center",align:"center",width:"138"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return["T"==n.IS_EDITOR?i("div",{on:{click:function(e){return t.showStaffChoice(n)}}},[i("fi-input",{staticClass:"edit-cell",attrs:{size:"small",placeholder:t.t("tacheComp.enterName"),"suffix-icon":"el-icon-user"},model:{value:n.STAFF_NAME,callback:function(e){t.$set(n,"STAFF_NAME",e)},expression:"row.STAFF_NAME"}})],1):i("span",[t._v(t._s(n.STAFF_NAME))])]}}])},[i("template",{slot:"header"},[i("span",[t.isEditor?i("span",{staticClass:"span-label"},[t._v("*")]):t._e(),t._v(t._s(t.t("tacheComp.name")))])])],2),i("fi-table-column",{attrs:{label:t.t("tacheComp.dep"),prop:"ORG_NAME","header-align":"center",align:"center","show-overflow-tooltip":!0}}),i("fi-table-column",{attrs:{label:t.t("tacheComp.phone"),prop:"MOBILE","header-align":"center",align:"center",width:"138"}}),i("fi-table-column",{attrs:{prop:"ROLE_TYPE","header-align":"center",align:"center",width:"138"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return["T"==n.IS_EDITOR?i("div",[i("fi-select",{attrs:{size:"small",placeholder:t.t("tacheComp.selectRole")},model:{value:n.ROLE_TYPE,callback:function(e){t.$set(n,"ROLE_TYPE",e)},expression:"row.ROLE_TYPE"}},t._l(t.roleDir,function(t,e){return i("fi-option",{key:e,attrs:{label:t.text,value:t.value}})}),1)],1):i("span",[i("fi-select",{attrs:{size:"small",placeholder:t.t("tacheComp.selectRole"),disabled:""},model:{value:n.ROLE_TYPE,callback:function(e){t.$set(n,"ROLE_TYPE",e)},expression:"row.ROLE_TYPE"}},t._l(t.roleDir,function(t,e){return i("fi-option",{key:e,attrs:{label:t.text,value:t.value}})}),1)],1)]}}])},[i("template",{slot:"header"},[i("span",[t.isEditor?i("span",{staticClass:"span-label"},[t._v("*")]):t._e(),t._v(t._s(t.t("tacheComp.role")))])])],2),t.isEditor?i("fi-table-column",{attrs:{fixed:"right",label:"操作",width:"100","header-align":"center",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row,o=e.$index;return["T"==n.IS_EDITOR?i("i",{staticClass:"el-icon-circle-check-outline cur-span",on:{click:function(e){return t.handleUpdate(o,n)}}}):t._e(),"T"==n.IS_EDITOR?i("i",{staticClass:"el-icon-delete cur-span cur-margin",on:{click:function(e){return t.handleCancel(o,t.tableDataTemp,n)}}}):t._e(),"F"==n.IS_EDITOR?i("i",{staticClass:"el-icon-edit-outline cur-span",on:{click:function(e){return t.handleEditor(n)}}}):t._e(),"F"==n.IS_EDITOR?i("i",{staticClass:"el-icon-delete cur-span cur-margin",on:{click:function(e){return t.handleDelete(o,t.tableDataTemp,n)}}}):t._e()]}}],null,!1,2601637976)}):t._e()],1)],1),i("fi-row",{staticClass:"content-top"},[i("fi-pagination",{directives:[{name:"show",rawName:"v-show",value:t.pagination.total>0,expression:"pagination.total>0"}],staticClass:"sc-fr",attrs:{"current-page":t.pagination.currentPage,"page-size":t.pagination.pagerSize,layout:"prev, pager, next, jumper,total",total:t.pagination.total},on:{"current-change":t.reloadTableMsg,"update:currentPage":function(e){return t.$set(t.pagination,"currentPage",e)},"update:current-page":function(e){return t.$set(t.pagination,"currentPage",e)}}})],1)],1)],1)},Pr=[],Or={getRoleGroupByPage:function(t){return On({url:"/flow/tacheOaRole/getRoleGroupByPage",method:"post",data:t})},deleteRoleGroup:function(t){return On({url:"/flow/tacheOaRole/deleteRoleGroup",method:"get",params:t})},addRoleGroup:function(t){return On({url:"/flow/tacheOaRole/addRoleGroup",method:"get",params:t})},updateRoleGroup:function(t){return On({url:"/flow/tacheOaRole/updateRoleGroup",method:"post",data:t})},addGroupStaff:function(t){return On({url:"/flow/tacheOaRole/addGroupStaff",method:"post",data:t})},updateGroupStaff:function(t){return On({url:"/flow/tacheOaRole/updateGroupStaff",method:"post",data:t})},deleteStaffByStaffId:function(t){return On({url:"/flow/tacheOaRole/deleteStaffByStaffId",method:"get",params:t})},getMsgByStaffId:function(t){return On({url:"/flow/tacheOaRole/getMsgByStaffId",method:"get",params:t})},getRoleGroupDir:function(){return On({url:"/flow/tacheOaRole/getRoleGroupDir",method:"get"})}},Dr=i("2166"),Mr={name:"oaRolePage",mixins:[bn.localeMixin],props:{roleGroupId:{type:[String,Number],default:""},isEditor:{type:Boolean,default:!0},visible:{type:Boolean,default:!1},roleGroupDir:Array,ruleRoleGroupData:Array},data:function(){return{currentState:!1,tableDataTemp:[],searchQuery:{page:0,size:5,roleGroupId:"",roleType:"",staffName:""},pagination:{currentPage:1,pagerSize:5,total:0},roleDir:[{value:"1",text:this.t("tacheComp.staff")},{value:"2",text:this.t("tacheComp.leader")},{value:"3",text:this.t("tacheComp.manager")}]}},computed:{roleGroupList:function(){return null===this.roleGroupDir||void 0===this.roleGroupDir?[]:this.roleGroupDir},ruleRoleGroupList:function(){return null===this.ruleRoleGroupData||void 0===this.ruleRoleGroupData?[]:this.ruleRoleGroupData},staffCfg:function(){var t={isProject:!0,isOrg:!0,orgStartIds:"",projStartIds:""};0===this.ruleRoleGroupList.length&&(t.isProject=!1,t.isOrg=!1);for(var e=0;e<this.ruleRoleGroupList.length;e++){if(this.ruleRoleGroupList[e].orgFarWay-2==0){t.isOrg=!1,t.isProject=!1,t.orgStartIds="",t.projStartIds="";break}this.ruleRoleGroupList[e].choiceWay-2==0?(t.isOrg=!1,null!==this.ruleRoleGroupList[e].dealFar&&""!==this.ruleRoleGroupList[e].dealFar&&(t.orgStartIds+="".concat(this.ruleRoleGroupList[e].dealFar,","))):this.ruleRoleGroupList[e].choiceWay-3==0?(t.isProject=!1,null!==this.ruleRoleGroupList[e].dealFar&&""!==this.ruleRoleGroupList[e].dealFar&&(t.projStartIds+="".concat(this.ruleRoleGroupList[e].dealFar,","))):t.isOrg=!1}return""===t.orgStartIds||t.orgStartIds.substring(0,t.orgStartIds.length-1),""===t.projStartIds||t.projStartIds.substring(0,t.projStartIds.length-1),t},dialogFormVisible:{get:function(){return this.visible&&(this.initData(),this.reloadTableMsg()),this.visible},set:function(t){this.$emit("update:visible",t)}}},methods:{initData:function(){null===this.roleGroupId||""===this.roleGroupId?(this.searchQuery.roleGroupId="",this.ruleRoleGroupList.length>0&&(this.searchQuery.roleGroupId=this.ruleRoleGroupList[0].ROLE_GROUP_ID)):this.searchQuery.roleGroupId=this.roleGroupId},addRow:function(t){this.checkCurrentState()&&t.push({STAFF_ID:"",STAFF_NAME:"",ORG_NAME:"",ROLE_GROUP_ID:this.searchQuery.roleGroupId,MOBILE:"",OA_STAFF_ID:"",ROLE_TYPE:this.searchQuery.roleType,IS_EDITOR:"T",STATUS:!1})},handleUpdate:function(t,e){var i=this,n=e,o=JSON.parse(JSON.stringify(n));this.checkRowRegular(n)&&(void 0!==n.STATUS&&!1===n.STATUS?Or.addGroupStaff(o).then(function(t){"success"===t.result?(n.IS_EDITOR="F",i.reloadTableMsg(),i.currentState=!1):i.$message({message:i.t("tacheComp.roleAddMessage"),type:"error"})}):Or.updateGroupStaff(o).then(function(){n.STATUS=!0,n.IS_EDITOR="F",i.currentState=!1}))},handleCancel:function(t,e,i){var n=i;void 0!==n.STATUS&&!1===n.STATUS?("T"===i.IS_EDITOR&&(this.currentState=!1),e.splice(t,1)):this.handleDelete(t,e,i)},handleDelete:function(t,e,i){var n=this;Or.deleteStaffByStaffId({oaStaffId:e[t].OA_STAFF_ID}).then(function(){"T"===i.IS_EDITOR&&(n.currentState=!1),n.reloadTableMsg()})},handleEditor:function(t){this.checkCurrentState()&&(t.IS_EDITOR="T")},checkCurrentState:function(){return this.currentState?(this.$message({message:this.t("tacheComp.saveMessage"),type:"error"}),!1):(this.currentState=!0,!0)},beforeClose:function(){this.checkCurrentState()&&(this.currentState=!1,this.dialogFormVisible=!1)},checkRowRegular:function(t){return""===t.STAFF_ID?(this.$message({message:this.t("tacheComp.selectRoleInfo"),type:"error"}),!1):""!==t.ROLE_TYPE||(this.$message({message:this.t("tacheComp.selectRoleMessage"),type:"error"}),!1)},reloadTableMsg:function(){var t=this;this.searchQuery.page=this.pagination.currentPage-1,this.searchQuery.size=this.pagination.pagerSize,Or.getRoleGroupByPage(this.searchQuery).then(function(e){t.tableDataTemp=e.content,t.pagination.total=e.totalElements,t.currentState=!1})},searchData:function(){var t=this;this.searchQuery.page=0,this.searchQuery.size=this.pagination.pagerSize,Or.getRoleGroupByPage(this.searchQuery).then(function(e){t.tableDataTemp=e.content,t.pagination.total=e.totalElements,t.currentState=!1})},showStaffChoice:function(t){var e=this,i=new Dr.StaffSelectAddonExtends({multiple:!1,confirmCallBack:function(i){null!==i&&(t.STAFF_ID=i.STAFF_ID,t.STAFF_NAME=i.STAFF_NAME,e.setStaffMsg(i.STAFF_ID,t))}});""!==t.STAFF_ID&&i.setPersons([{STAFF_ID:t.STAFF_ID}]),i.setChoiceSourceTreeConfig({organization:{startPathIds:null===e.staffCfg.orgStartIds||""===e.staffCfg.orgStartIds?null:"".concat(e.staffCfg.orgStartIds),isTop:null===e.staffCfg.orgStartIds||""===e.staffCfg.orgStartIds,hidden:e.staffCfg.isOrg},project:{startPathIds:null===e.staffCfg.projStartIds||""===e.staffCfg.projStartIds?null:"".concat(e.staffCfg.projStartIds),isTop:null===e.staffCfg.projStartIds||""===e.staffCfg.projStartIds,hidden:e.staffCfg.isProject},dutyLine:{hidden:!0},projectDefined:{hidden:!0}}),i.show()},setStaffMsg:function(t,e){var i=e;Or.getMsgByStaffId({staffId:t}).then(function(t){null!==t&&(i.ORG_NAME=t.ORG_NAME,i.MOBILE=t.MOBILE)})}}},Nr=Mr,Br=(i("1328"),B(Nr,Rr,Pr,!1,null,null,null)),Fr=Br.exports,zr=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("section",{attrs:{id:"oaRolerAdd"}},[i("fi-dialog",{attrs:{title:t.t("tacheComp.addRoleGroup"),visible:t.dialogFormVisible,"close-on-click-modal":!1,"close-on-press-escape":!1,width:"500px"},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[i("fi-input",{staticClass:"edit-cell",attrs:{size:"small",placeholder:t.t("tacheComp.enterRole")},model:{value:t.roleGroupName,callback:function(e){t.roleGroupName=e},expression:"roleGroupName"}}),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("fi-button",{attrs:{size:"small"},on:{click:function(e){t.dialogFormVisible=!1}}},[t._v(t._s(t.t("options.cancel")))]),i("fi-button",{attrs:{size:"small",type:"primary"},on:{click:t.addRoleGroup}},[t._v(t._s(t.t("options.confirm")))])],1)],1)],1)},Vr=[],Ur={name:"oaRolerAdd",mixins:[bn.localeMixin],props:{visible:{type:Boolean,default:!1}},data:function(){return{roleGroupName:""}},computed:{dialogFormVisible:{get:function(){return this.visible},set:function(t){this.$emit("update:visible",t)}}},methods:{addRoleGroup:function(){var t=this;return""===this.roleGroupName?(this.$message({message:this.t("tacheComp.enterAddRole"),type:"warning"}),!1):(Or.addRoleGroup({roleGroupName:this.roleGroupName}).then(function(){t.$emit("reloadGroupDir"),t.$message({message:t.t("tacheComp.addSuccess"),type:"success"}),t.dialogFormVisible=!1}),!0)}}},jr=Ur,Hr=(i("e075"),B(jr,zr,Vr,!1,null,null,null)),Wr=Hr.exports,Gr={name:"together-mange",mixins:[bn.localeMixin],components:{ProcessingScope:_o,FmdTacheCfg:hr,oaRolerPage:Fr,oaRolerAdd:Wr},props:{disabled:Boolean,oaData:{type:Object,default:function(){}},tableOptions:Array,revisionId:String,dirCondition:Object,ruleRoleGroupData:Array,node:Object},created:function(){this.getRoleGroupDir()},data:function(){var t=this,e=function(e,i,n){if(["form","fix"].includes(t.managerData.rootOrgType)&&!i)n(new Error(t.t("options.errorMessage1")));else if(["sqlFunc","js"].includes(t.managerData.rootOrgType)){var o=i.match(/([\w]*\.?[\w]+)\((.*)\)/);o&&o[0]===i?n():n(new Error(t.t("options.errorMessage2")))}else!t.managerData.rootOrgType&&i?n(new Error(t.t("options.errorMessage3"))):n()};return{isShowPage:!1,isShowAdd:!1,roleGroupDir:[],dropdown:{label:this.t("options.customMode"),id:2},options:{modal:[{id:1,label:this.t("options.devMode")},{id:2,label:this.t("options.customMode")}],staffCreateType:[{id:"",label:this.t("options.allOrg")},{id:"2",label:this.t("options.staffDep")},{id:"3",label:this.t("options.team")}],rootOrgType:[{id:"fix",label:this.t("options.fix")},{id:"form",label:this.t("options.formElement")},{id:"sqlFunc",label:this.t("options.sqlFunc")},{id:"js",label:this.t("options.jsFunc")}]},managerData:this.oaData,setValue:"",checkedOrganzations:[],orgDialogVisible:!1,checkedTeam:[],teamDialogVisible:!1,rules:{rootOrgValue:[{validator:e,trigger:["change","blur"]}]}}},computed:{selectRootNode:function(){var t=/<.*>/;return(this.managerData.rootOrgValue||"").replace(t,"")}},mounted:function(){var t=this;this.dropdown.label="rule"===this.managerData.defaultStaffType?this.t("options.customMode"):this.t("options.devMode"),this.dropdown.id="rule"===this.managerData.defaultStaffType?2:1,"fix"===this.managerData.rootOrgType&&this.managerData.rootOrgValue&&("2"===this.managerData.staffCreateType&&L({orgIds:this.managerData.rootOrgValue}).then(function(e){t.managerData.rootOrgValue="".concat(e[0].org_id,"<i:").concat(e[0].org_name,">")}),"3"===this.managerData.staffCreateType&&P({projectIds:this.managerData.rootOrgValue}).then(function(e){t.managerData.rootOrgValue="".concat(e[0].group_id,"<i:").concat(e[0].group_name,">")}))},methods:{onDropDownModal:function(t){this.dropdown=t,2===t.id?(this.managerData.defaultStaffType="rule",this.managerData.beginOrgValue="",this.managerData.rootOrgType="",this.managerData.rootOrgValue="",this.managerData.staffCreateType=""):this.managerData.defaultStaffType=""},onChangeStaffType:function(t){t||(this.managerData.rootOrgType="")},onRootOrgClickBefore:function(t){return"fix"!==this.managerData.rootOrgType||(this.setValue=t,"2"===this.managerData.staffCreateType?this.orgDialogVisible=!0:this.teamDialogVisible=!0,!1)},doOnSureAfter:function(t){1===t.length&&this.setValue?(this.orgDialogVisible&&(this.managerData.rootOrgValue="".concat(t[0].org_id,"<i:").concat(t[0].org_name,">"),this.setValue("".concat(t[0].org_id,"<i:").concat(t[0].org_name,">"))),this.teamDialogVisible&&(this.managerData.rootOrgValue="".concat(t[0].group_id,"<i:").concat(t[0].group_name,">"),this.setValue("".concat(t[0].group_id,"<i:").concat(t[0].group_name,">")))):this.setValue(""),"2"===this.managerData.staffCreateType?this.orgDialogVisible=!1:this.teamDialogVisible=!1},doCancelAfter:function(){"2"===this.managerData.staffCreateType?this.orgDialogVisible=!1:this.teamDialogVisible=!1},addFoldLayers:function(t,e){var i={name:t,type:e};this.$busManage.$emit("addRule",i)},getRoleGroupDir:function(){var t=this;Or.getRoleGroupDir().then(function(e){t.roleGroupDir=e})},openOaRolePage:function(){this.managerData.roleGroupId?this.isShowPage=!0:this.$message({type:"warning",message:this.t("togetherComp.roleMessage")})}},beforeDestroy:function(){var t=/<.*>/;"fix"===this.managerData.rootOrgType&&this.managerData.rootOrgValue&&(this.managerData.rootOrgValue=this.managerData.rootOrgValue.replace(t,""))}},Zr=Gr,Xr=(i("4f7e"),B(Zr,Ir,Lr,!1,null,"169fc8e4",null)),Yr=Xr.exports,$r={name:"fmd-advance-setting",mixins:[bn.localeMixin],components:{TogetherManager:Yr},props:{node:Object,tableOptions:Array,disabled:Boolean,revisionId:String,dirCondition:Object,ruleRoleGroupData:Array},data:function(){var t=this,e=/^(([a-zA-Z0-9]+[.])[.]*.*)*([\w]*\.?[\w]+)\((.*)\)/,i=function(i,n,o){if(t.advanceForm.onCreateType&&n){var r=n.match(e);r&&r[0]===n?o():o(new Error(t.t("advanceSetting.validateMessage1")))}else t.advanceForm.onCreateType&&!n?o(new Error(t.t("advanceSetting.validateMessage2"))):!t.advanceForm.onCreateType&&n?o(new Error(t.t("advanceSetting.validateMessage3"))):o()},n=function(i,n,o){if(t.advanceForm.onAfterCreateType&&n){var r=n.match(e);r&&r[0]===n?o():o(new Error(t.t("advanceSetting.validateMessage1")))}else t.advanceForm.onAfterCreateType&&!n?o(new Error(t.t("advanceSetting.validateMessage2"))):!t.advanceForm.onAfterCreateType&&n?o(new Error(t.t("advanceSetting.validateMessage3"))):o()},o=function(i,n,o){if(t.advanceForm.onBeforeFinishType&&n){var r=n.match(e);r&&r[0]===n?o():o(new Error(t.t("advanceSetting.validateMessage1")))}else t.advanceForm.onBeforeFinishType&&!n?o(new Error(t.t("advanceSetting.validateMessage2"))):!t.advanceForm.onBeforeFinishType&&n?o(new Error(t.t("advanceSetting.validateMessage3"))):o()},r=function(i,n,o){if(t.advanceForm.onAfterFinishType&&n){var r=n.match(e);r&&r[0]===n?o():o(new Error(t.t("advanceSetting.validateMessage1")))}else t.advanceForm.onAfterFinishType&&!n?o(new Error(t.t("advanceSetting.validateMessage2"))):!t.advanceForm.onAfterFinishType&&n?o(new Error(t.t("advanceSetting.validateMessage3"))):o()};return{advanceForm:this.node.advancedProperties,tableItems:this.tableOptions||[],options:{defaultOptions:[{value:"fix",label:this.t("options.fix")},{value:"form",label:this.t("options.formElement")},{value:"sqlFunc",label:this.t("options.sqlFunc")},{value:"js",label:this.t("options.jsFunc")}],before:[{value:"js",label:this.t("options.jsFunc")},{value:"sqlProc",label:this.t("options.sqlProc")}],after:[{value:"js",label:this.t("options.jsFunc")},{value:"sqlProc",label:this.t("options.sqlProc")},{value:"java",label:"java"}]},advanceFormRule:{onCreate:[{validator:i,trigger:["change","blur"]}],onAfterCreate:[{validator:n,trigger:["change","blur"]}],onBeforeFinish:[{validator:o,trigger:["change","blur"]}],onAfterFinish:[{validator:r,trigger:["change","blur"]}]},isCustom:!1}},created:function(){this.advanceForm.isPool||(this.advanceForm.isPool="0BF"),this.advanceForm.isAuto||(this.advanceForm.isAuto="0BF")},methods:{onDefaultOpinionTypeChange:function(t){["fix","form"].includes(t)&&(this.isCustom=!0,this.tableItems="fix"===t?[]:this.tableOptions)},submitAdvanceSetting:function(){var t=this;return new Promise(function(e,i){t.$refs.advanceForm.validate(function(n,o){return n?e():i({error:o,fields:t.$refs.advanceForm.fields})})})},onStartOaChange:function(t){this.advanceForm.oa.defaultStaffType="0BT"===t?"rule":""},serialCheckChange:function(t,e){t&&(this.advanceForm.countersignCfg[e].checked=!t)}},beforeDestroy:function(){this.$emit("getAdvancedProperties",this.advanceForm)}},qr=$r,Kr=(i("0cad"),B(qr,Sr,Er,!1,null,null,null)),Jr=Kr.exports,Qr=en.repulsion,ta=Qr.column,ea=Qr.row,ia=(tn.rect.w-tn.rect.rect.w)/2,na={fromLinkPoints:{},toLinkPoints:{},fromRect:{},toRect:{},from:{},to:{},nodeMap:{},_setAttrs:function(t,e,i){this.fromLinkPoints=this.getLinkPointsByNode(t),this.toLinkPoints=this.getLinkPointsByNode(e),this.fromRect=t.getRect(),this.toRect=e.getRect(),this.from=t,this.to=e,this.nodeMap=i,this.from.setStyle({}),this.to.setStyle({})},getLinkPointsByNode:function(t){var e=t.getCenterLocation(),i=e.x,n=e.y,o=t.getRect(),r=o.width,a=o.height;return{top:{x:i,y:n-a/2},topTop:{x:i,y:n-ea/2},topLeft:{x:i-r/4,y:n-ea/2},topRight:{x:i+r/4,y:n-ea/2},right:{x:i+r/2,y:n},rightRight:{x:i+ta/2,y:n},rightTop:{x:i+ta/2,y:n-a/4},rightBottom:{x:i+ta/2,y:n+a/4},bottom:{x:i,y:n+a/2},bottomBottom:{x:i,y:n+ea/2},bottomLeft:{x:i-r/4,y:n+ea/2},bottomRight:{x:i+r/4,y:n+ea/2},left:{x:i-r/2,y:n},leftLeft:{x:i-ta/2,y:n},leftTop:{x:i-ta/2,y:n-a/4},leftBottom:{x:i-ta/2,y:n+a/4}}},handleLoop:function(){return{isLoop:!0,position:"",style:this.resetOffset(),point:[]}},handleUp:function(){var t={isLoop:!1,position:"top.bottom",style:this.resetOffset(),point:[]};return t.style["link.from.yoffset"]=ia,t.style["link.from.xoffset"]=ia,t.style["link.to.xoffset"]=ia,this.isRowBoundary("up")?(t.position="left.left",t.style["link.from.yoffset"]=0,t.style["link.to.xoffset"]=0,t.point=[{x:this.fromLinkPoints.left.x-10,y:this.fromLinkPoints.left.y},{x:this.toLinkPoints.left.x-10,y:this.toLinkPoints.left.y}]):t.style["link.from.yoffset"]=ia,t},handleRUp:function(){var t={isLoop:!1,position:"right.bottom",style:this.resetOffset(),point:[]};return"endItem"===this.to.type?this.isColumnBoundary("right")?(t.style["link.from.yoffset"]=-this.fromRect.height/4,t.style["link.from.xoffset"]=-ia,t.point=[this.fromLinkPoints.rightTop,{x:this.fromLinkPoints.rightTop.x,y:this.toLinkPoints.bottomLeft.y},this.toLinkPoints.bottomBottom]):(t.style["link.from.xoffset"]=-ia,t.point=[{x:this.toLinkPoints.bottom.x,y:this.fromLinkPoints.right.y}]):(t.style={"link.from.xoffset":-ia,"link.from.yoffset":-this.fromRect.height/4,"link.to.xoffset":-this.toRect.width/4},t.point=[this.fromLinkPoints.rightTop,{x:this.fromLinkPoints.rightTop.x,y:this.toLinkPoints.bottomLeft.y},this.toLinkPoints.bottomLeft]),t},handleRight:function(){var t={isLoop:!1,position:"right.left",style:this.resetOffset(),point:[]};return this.isColumnBoundary("right")?(t.style["link.from.yoffset"]=ia,t.position="top.top",t.point=[{x:this.fromLinkPoints.top.x,y:this.fromLinkPoints.top.y-10},{x:this.toLinkPoints.top.x,y:this.toLinkPoints.top.y-10}]):t.style["link.from.xoffset"]=-ia,t},handleRDown:function(){var t={isLoop:!1,position:"bottom.left",style:this.resetOffset(),point:[]};return"startItem"===this.from.type?(t.style["link.from.yoffset"]=-ia,t.point=[{x:this.fromLinkPoints.bottom.x,y:this.toLinkPoints.left.y}]):(t.position="right.top",t.style={"link.from.xoffset":-ia,"link.from.yoffset":this.fromRect.height/4,"link.to.xoffset":-this.toRect.width/4},t.point=[this.fromLinkPoints.rightBottom,{x:this.fromLinkPoints.rightBottom.x,y:this.toLinkPoints.topTop.y},this.toLinkPoints.topLeft]),t},handleDown:function(){var t={isLoop:!1,position:"bottom.top",style:this.resetOffset(),point:[]};return this.isRowBoundary("down")?(t.position="right.right",t.point=[{x:this.fromLinkPoints.right.x+10,y:this.fromLinkPoints.right.y},{x:this.toLinkPoints.right.x+10,y:this.toLinkPoints.right.y}]):t.style["link.from.yoffset"]=-ia,t},handleLDown:function(){return{isLoop:!1,position:"left.top",style:{"link.from.xoffset":ia,"link.from.yoffset":this.fromRect.height/4,"link.to.xoffset":this.toRect.width/4,"shapelink.type":"lineto"},point:[this.fromLinkPoints.leftBottom,{x:this.fromLinkPoints.leftBottom.x,y:this.toLinkPoints.topTop.y},this.toLinkPoints.topRight]}},handleLeft:function(){var t={isLoop:!1,position:"left.right",style:this.resetOffset(),point:[]};return this.isColumnBoundary("left")?(t.position="bottom.bottom",t.point=[{x:this.fromLinkPoints.bottom.x,y:this.fromLinkPoints.bottom.y+10},{x:this.toLinkPoints.bottom.x,y:this.toLinkPoints.bottom.y+10}]):t.style["link.from.xoffset"]=ia,t},handleLUp:function(){return{isLoop:!1,position:"left.bottom",style:{"link.from.xoffset":ia,"link.to.xoffset":this.toRect.width/4,"link.from.yoffset":-this.fromRect.height/4},point:[this.fromLinkPoints.leftTop,{x:this.fromLinkPoints.leftTop.x,y:this.toLinkPoints.bottomLeft.y},this.toLinkPoints.bottomRight]}},isColumnBoundary:function(t){for(var e=!1,i=this.from.getCenterLocation(),n=this.to.getCenterLocation(),o=Math.abs(n.x-i.x),r=o/ta,a=Object.keys(Array.from({length:r-1})).map(function(e){return"right"===t?{x:i.x+(1+~~e)*ta,y:i.y}:{x:i.x-(1+~~e)*ta,y:i.y}}),s=0;s<a.length;s++)if(Ct(a[s].x,a[s].y,this.nodeMap)){e=!0;break}return e},isRowBoundary:function(t){for(var e=!1,i=this.from.getCenterLocation(),n=this.to.getCenterLocation(),o=Math.abs(n.y-i.y),r=o/ea,a=Object.keys(Array.from({length:r-1})).map(function(e){return"down"===t?{x:i.x,y:i.y+(1+~~e)*ea}:{x:i.x,y:i.y-(1+~~e)*ea}}),s=0;s<a.length;s++)if(Ct(a[s].x,a[s].y,this.nodeMap)){e=!0;break}return e},resetOffset:function(){return{"link.from.yoffset":0,"link.from.xoffset":0,"link.to.xoffset":0,"link.to.yoffset":0,"shapelink.type":"lineto"}}},oa=["1","2","3","4","6","7","8","9","20","23","24","25","27","28","37","44"],ra=["STAFF_ID","REGION_ID","ORG_ID"],aa={startItem:{nameLength:[2,4]},endItem:{nameLength:[2,4]},midstItem:{nameLength:[6,12]}},sa={name:"fmd-editor-node",mixins:[bn.localeMixin],components:{FmdAdvanceSetting:Jr,FmdDisplaySetting:kr,FmdTacheRule:fr,FmdNexttchRule:yr,FmdTacheAttr:ao},props:{visible:Boolean,tchModel:Object,disabled:Boolean,flowModel:Object,relationFlows:Array,toolOptions:[Object,Array]},computed:{dialogVisible:{get:function(){return this.visible},set:function(t){this.$emit("update:visible",t)}}},data:function(){return{node:{},tabs:[{name:"tacheAttr",label:this.t("editNode.tacheAttr"),roleByTchType:["1","2","3","4"]},{name:"tacheRule",label:this.t("editNode.tacheRule"),roleByTchType:["1","3","4"]},{name:"nextTchRule",label:this.t("editNode.nextTache"),roleByTchType:["1","3","4"]},{name:"fieldSetting",label:this.t("editNode.fieldSetting"),roleByTchType:["1","3","4"],disabled:this.disabled},{name:"advanceSetting",label:this.t("editNode.advanceSetting"),roleByTchType:["1","2","3","4"]}],activeName:"tacheAttr",tempNode:{},tableOptions:[],options:{goReturn:[]},revisionId:"",commonData:{},dirCondition:{relationFlow:[],getPreTcheInfoData:[],loadDimenData:[],tacheData2:[]},tacheResultData:{nextTacheData:[],dealTacheData:[],readTacheData:[],roleGroupData:[],revisionId:""},isLoadOver:!1,ruleNextTacheData:[],ruleTacheStaffData:[],ruleReaderStaffData:[],ruleRoleGroupData:[],advancedProperties:{actionBackTitle:"",actionRunTitle:"",actionTransferTitle:"",backCfg:this.flowModel&&this.flowModel.advancedProperties&&JSON.parse(JSON.stringify(this.flowModel.advancedProperties.backCfg))||{isDefaultTacheExecStaff:!1},beginOrgType:"",beginOrgValue:"",canCancelBackto:"",canCancelBacktoType:"",circularNotifyCfg:this.flowModel&&this.flowModel.advancedProperties&&JSON.parse(JSON.stringify(this.flowModel.advancedProperties.circularNotifyCfg))||{sms:{},mail:{}},countersignCfg:{display:!0,parallel:{checked:!1,display:!0,text:this.t("editNode.parallel"),textus:"Parallel"},serial:{checked:!1,display:!0,text:this.t("editNode.serial"),textus:"Serial"}},defaultOpinionType:"",defaultOpinionValue:"",defaultStaffCanChange:"0BT",defaultStaffCanChangeTrnsf:"",defaultStaffDisabled:"",defaultStaffName:"",defaultStaffSelected:"",defaultStaffType:"",defaultStaffValue:"",endTaskTitle:"",execDesc:"",execDescUs:"",filterStaffWhere:"",isAuto:"",isMailCanChange:"",isPool:"",isSmsCanChange:"",nextTchsCanChange:"",nextTchsIsHiddenOther:"",nextTchsIsSelected:"",nextTchsType:"",nextTchsValue:"",notifyRootOrgCanChange:"0BT",notifyRootOrgType:"",notifyRootOrgValue:"",notifyStaffCanChange:"0BT",notifyStaffCreateType:"",notifyStaffDisabled:"",notifyStaffSelected:"",notifyStaffType:"",notifyStaffValue:"",onAfterCreate:"",onAfterCreateType:"",onAfterFinish:"",onAfterFinishType:"",onBeforeCreate:"",onBeforeCreateType:"",onBeforeFinish:"",onBeforeFinishType:"",onCreate:"",onCreateType:"",onFinish:"",onFinishType:"",opinionCfg:{display:!1,options:[{text:this.t("editNode.agree"),value:"0BT"},{text:this.t("editNode.disagree"),value:"0BF"}],selected:"0BT",refresh:!0},opinionType:"",processorNotifyCfg:this.flowModel&&this.flowModel.advancedProperties&&JSON.parse(JSON.stringify(this.flowModel.advancedProperties.processorNotifyCfg))||{sms:{},mail:{}},recommendStaffValue:"",rootOrgCanChange:"0BT",rootOrgType:"",rootOrgValue:"",sortId:0,staffCreateType:"",tchMod:0,tacheRulesData:{nextTacheData:[],dealTacheData:[],readTacheData:[],roleGroupData:[]},windConfigInfo:{showSaveSucceed:!1,showFlowName:!0,showAttach:!0,model:"layer"},oa:{isStartOa:"0BF",roleGroupId:"",defaultStaffType:"",staffCreateType:"",beginOrgType:"fix",beginOrgValue:"",rootOrgType:"",rootOrgValue:"",notifyConfig:{sms:{display:"true",selected:"true",canChange:"true"},mail:{display:"true",selected:"true",canChange:"true"}}},winStyle:this.flowModel&&this.flowModel.advancedProperties&&this.flowModel.advancedProperties.winStyle||{},isFreeFlow:"0BF"}}},created:function(){var t=this;this.tempNode=Tn()(this.tchModel.getClient("data")),this.node=this.tchModel.getClient("data"),this.node.advancedProperties?(this.node.advancedProperties.backCfg||(this.node.advancedProperties.backCfg=this.advancedProperties.backCfg),this.node.advancedProperties.winStyle?this.node.advancedProperties.winStyle.fullScreen||this.node.advancedProperties.winStyle.height||this.node.advancedProperties.winStyle.width||(this.node.advancedProperties.winStyle=this.advancedProperties.winStyle):this.node.advancedProperties.winStyle=this.advancedProperties.winStyle,this.node.advancedProperties.opinionCfg||(this.node.advancedProperties.opinionCfg=this.advancedProperties.opinionCfg),this.node.advancedProperties.circularNotifyCfg?this.node.advancedProperties.circularNotifyCfg.sms||this.node.advancedProperties.circularNotifyCfg.mail||(this.node.advancedProperties.circularNotifyCfg=this.advancedProperties.circularNotifyCfg):this.node.advancedProperties.circularNotifyCfg=this.advancedProperties.circularNotifyCfg,this.node.advancedProperties.processorNotifyCfg?this.node.advancedProperties.processorNotifyCfg.sms||this.node.advancedProperties.processorNotifyCfg.mail||(this.node.advancedProperties.processorNotifyCfg=this.advancedProperties.processorNotifyCfg):this.node.advancedProperties.processorNotifyCfg=this.advancedProperties.processorNotifyCfg,this.node.advancedProperties.tacheRulesData||(this.node.advancedProperties.tacheRulesData=this.advancedProperties.tacheRulesData),this.node.advancedProperties.windConfigInfo||(this.node.advancedProperties.windConfigInfo=this.advancedProperties.windConfig),this.node.advancedProperties.oa||(this.node.advancedProperties.oa=this.advancedProperties.oa),this.node.advancedProperties.countersignCfg||(this.node.advancedProperties.countersignCfg=this.advancedProperties.countersignCfg),this.node.advancedProperties.isFreeFlow||(this.node.advancedProperties.isFreeFlow=this.advancedProperties.isFreeFlow)):this.node.advancedProperties=Tn()(this.advancedProperties),this.tabs=this.tabs.filter(function(e){return e.roleByTchType.includes(t.node.tchType)&&!e.disabled}),this.tableOptions=this.tchModel.getClient("tableOptions"),this.commonData=Ro.loadCommonData(this.t),this.loadInitData()},methods:{handleClose:function(){this.tchModel.setClient("data",this.tempNode),this.dialogVisible=!1},submit:function(){function t(){return e.apply(this,arguments)}var e=Rt(Xn.a.mark(function t(){var e,i,n,o,r,a,s,l,h,c,u,d,f,p,g,_,m,v,y,w,b,x=this;return Xn.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=function(t,e,i){return!t||(x.$message({type:"error",message:t}),x.activeName=e,i&&i(),!1)},i=function(t,e){return t.then(function(t){return[null,t]}).catch(function(t){return[e,t]})},t.next=4,i(this.$refs.fmdTchAttr.submitTchAttrForm(),this.t("editNode.validateMessage1"));case 4:if(n=t.sent,o=kt(n,1),r=o[0],e(r,"tacheAttr")){t.next=9;break}return t.abrupt("return");case 9:return t.next=11,i(this.$refs.fmdTchRule.submitTacheRule(),this.t("editNode.validateMessage2"));case 11:if(a=t.sent,s=kt(a,1),l=s[0],e(l,"tacheRule")){t.next=16;break}return t.abrupt("return");case 16:return t.next=18,i(this.$refs.nexttch.validate(),this.t("editNode.validateMessage3"));case 18:if(h=t.sent,c=kt(h,1),u=c[0],e(u,"nextTchRule")){t.next=23;break}return t.abrupt("return");case 23:return t.next=25,i(this.$refs.fmdAdvance.submitAdvanceSetting(),this.t("editNode.validateMessage4"));case 25:if(d=t.sent,f=kt(d,2),p=f[0],g=f[1],e(p,"advanceSetting",function(){x.$nextTick(function(){F(g.error,g.fields,document.querySelector(".fmd-editor-node__content").parentElement)})})){t.next=31;break}return t.abrupt("return");case 31:if(2!==this.$refs.fmdTchRule.dropdownValue.rootModel){t.next=38;break}if(_=this.checkfoldingLayer(this.ruleTacheStaffData,this.t("editNode.tacheHander"))){t.next=35;break}return t.abrupt("return");case 35:this.tacheResultData.dealTacheData=this.makeJsonData(this.ruleTacheStaffData,this.t("editNode.tacheHander")),this.tacheResultData.revisionId=this.revisionId,this.node.advancedProperties.defaultStaffValue="";case 38:if(2!==this.$refs.fmdTchRule.dropdownValue.notifyRootModel){t.next=45;break}if(m=this.checkfoldingLayer(this.ruleReaderStaffData,this.t("editNode.tacheCC"))){t.next=42;break}return t.abrupt("return");case 42:this.tacheResultData.readTacheData=this.makeJsonData(this.ruleReaderStaffData,this.t("editNode.tacheCC")),this.tacheResultData.revisionId=this.revisionId,this.node.advancedProperties.notifyStaffValue="";case 45:if(2!==this.$refs.nexttch.dropdownValue.ruleModel){t.next=52;break}if(v=this.checkfoldingLayer(this.ruleNextTacheData,this.t("editNode.nextTache"))){t.next=49;break}return t.abrupt("return");case 49:this.tacheResultData.nextTacheData=this.makeJsonData(this.ruleNextTacheData,this.t("editNode.nextTache")),this.tacheResultData.revisionId=this.revisionId,this.node.advancedProperties.nextTchsValue="";case 52:if("rule"!==this.node.advancedProperties.oa.defaultStaffType){t.next=58;break}if(y=this.checkfoldingLayer(this.ruleRoleGroupData,this.t("editNode.branchStaff"))){t.next=56;break}return t.abrupt("return");case 56:this.tacheResultData.roleGroupData=this.makeJsonData(this.ruleRoleGroupData,this.t("editNode.branchStaff")),this.tacheResultData.revisionId=this.revisionId;case 58:this.node.advancedProperties.tacheRulesData.cache=!0,this.node.advancedProperties.tacheRulesData.nextTacheData=this.tacheResultData.nextTacheData,this.node.advancedProperties.tacheRulesData.dealTacheData=this.tacheResultData.dealTacheData,this.node.advancedProperties.tacheRulesData.readTacheData=this.tacheResultData.readTacheData,this.node.advancedProperties.tacheRulesData.roleGroupData=this.tacheResultData.roleGroupData,this.setFieldRights(),w=this.tchModel.type,b=this.$i18n&&"en"===this.$i18n.locale?this.node.tchNameUs:this.node.tchName,this.tchModel.setName(pt(aa[w],b)),this.tchModel.setToolTip(b),this.tchModel.realName=b,this.tchModel.setClient("data",this.node),En.updateNode(this.node),this.$emit("submit"),this.dialogVisible=!1;case 73:case"end":return t.stop()}},t,this)}));return t}(),setFieldRights:function(){var t=this,e=this.$refs.fmdDisplaySetting.tableData,i=[],n=[],o=this.node.tacheForm.formAction;this.node.tacheForm.fieldRights.forEach(function(t){"21"===t.xtype&&i.push(t),"22"!==t.xtype&&"38"!==t.xtype||n.push(t)}),n.forEach(function(i){var n=["环节简要步骤","员工信息导航"],r=["38"];if(!n.includes(i.fieldNameCn)&&!r.includes(i.xtype)){var a=t.node.tacheForm.fieldRights.filter(function(t){return t.pid===i.id});i.isShow=a.every(function(t){return"F"===t.isShow})?"F":"T","M"===o&&(i.isReadonly=a.every(function(t){return"F"===t.isReadonly})?"F":"T"),e.push(i)}}),i.forEach(function(t){var i=n.filter(function(e){return e.pid===t.id});t.isShow=i.length&&i.every(function(t){return"F"===t.isShow})?"F":"T","M"===o&&(t.isReadonly=i.length&&i.every(function(t){return"F"===t.isReadonly})?"F":"T"),e.push(t)}),this.node.tacheForm.fieldRights=e},handleClick:function(t){this.activeName=t.name},getAdvancedProperties:function(t){this.node.advancedProperties=Object.assign(this.node.advancedProperties||{},t)},loadInitData:function(){this.dirCondition.relationFlow=this.relationFlows,this.dirCondition.loadDimenData=this.tchModel.getClient("tableFields"),this.dirCondition.getPreTcheInfoData=this.getPreTchOptions(),void 0!==this.node.advancedProperties.tacheRulesData.cache&&this.node.advancedProperties.tacheRulesData.cache?(this.ruleNextTacheData=this.loadData(this.node.advancedProperties.tacheRulesData.nextTacheData,"save"),this.ruleTacheStaffData=this.loadData(this.node.advancedProperties.tacheRulesData.dealTacheData,"save"),this.ruleReaderStaffData=this.loadData(this.node.advancedProperties.tacheRulesData.readTacheData,"save"),this.ruleRoleGroupData=this.loadData(this.node.advancedProperties.tacheRulesData.roleGroupData,"save")):(this.ruleNextTacheData=this.loadData(this.node.advancedProperties.tacheRulesData.nextTacheData,"load"),this.ruleTacheStaffData=this.loadData(this.node.advancedProperties.tacheRulesData.dealTacheData,"load"),this.ruleReaderStaffData=this.loadData(this.node.advancedProperties.tacheRulesData.readTacheData,"load"),this.ruleRoleGroupData=this.loadData(this.node.advancedProperties.tacheRulesData.roleGroupData,"load")),this.revisionId=this.node.advancedProperties.tacheRulesData.revisionId,this.isLoadOver=!0},loadData:function(t,e){var i=this;if(null===t||void 0===t)return[];for(var n=[],o=0;o<t.length;o++)!function(o){var r=!1;null===t[o].conditionType&&(t[o].conditionType=""),null===t[o].conditionTypeDesc&&(t[o].conditionTypeDesc=""),"true"!==t[o].isSetDeRult&&!0!==t[o].isSetDeRult||(r=!0);var a=[],s="";if(0===JSON.parse(t[o].condition).length){var l={type:"",id:"",elementType:"",oper:"",value:"",initSqlArr:[],valueName:"",staffName:""};a.push(l)}else{a=JSON.parse(t[o].condition);for(var h=0;h<a.length;h++)!function(t){if("form"===a[t].type)for(var e=0;e<i.dirCondition.loadDimenData.length;e++){for(var n=0;n<i.dirCondition.loadDimenData[e].children.length;n++)if(i.dirCondition.loadDimenData[e].children[n].value===a[t].id)if("9"===a[t].elementType){var o=i.dirCondition.loadDimenData[e].children[n].tree.domainType,r=i.dirCondition.loadDimenData[e].children[n].tree.domainSql;o?i.getTreeByDomainType(o).then(function(e){a[t].initSqlArr=e}):r&&i.setSqlToTree(r).then(function(e){a[t].initSqlArr=e})}else a[t].initSqlArr=i.dirCondition.loadDimenData[e].children[n].options;a=i.changeStringToArr(a)}}(h);s=t[o].conditionType}var c="";if(t[o].resultType-16==0){var u=JSON.parse(t[o].resultValue);c="".concat(u.packageName,".").concat(u.procName,"(").concat(u.params,")")}else c=t[o].resultValue;var d=[];void 0!==t[o].dealStaff&&""!==t[o].dealStaff&&null!==t[o].dealStaff&&(d=JSON.parse(t[o].dealStaff));var f="",p=t[o].typeArr,g=[],_=[],m="",v=[];"fromOrg"===t[o].recommendWay?void 0!==t[o].recommendStaff&&""!==t[o].recommendStaff&&null!==t[o].recommendStaff&&(v=JSON.parse(t[o].recommendStaff)):"fromFlow"===t[o].recommendWay&&(m=t[o].recommendStaff),"load"===e?(f=JSON.parse(t[o].dealTacheInfo),t[o].selectBox-3==0&&(g.push(t[o].flowTache[0].flowMod),g.push(t[o].flowTache[0].tacheMod)),t[o].recommendBox-3==0&&(_.push(t[o].recommendFlowMod),_.push(t[o].recommendTacheMod))):(f=JSON.parse(t[o].tacheObj),g=t[o].selectArray,_=t[o].recommendArray);var y={condition:a,conditionDesc:t[o].conditionDesc,conditionType:s,conditionTypeDesc:t[o].conditionTypeDesc,dealWay:t[o].dealWay,flowCfgRuleId:t[o].flowCfgRuleId,isSetDeRult:r,revisionId:t[o].revisionId,selectBox:t[o].selectBox,selectValue:t[o].selectValue,selectArray:g,staff:d,typeArr:p,resultType:t[o].resultType,dealFar:t[o].dealFar,dealNode:t[o].dealNode,dealStaff:t[o].dealStaff,choiceWay:t[o].choiceWay,isCanChange:t[o].isCanChange,recommendStaff:t[o].recommendStaff,recommendBox:t[o].recommendBox,recommendStaffArr:v,recommendArray:_,recommendStaffValue:m,recommendWay:t[o].recommendWay,filterWay:t[o].filterWay,orgFarWay:t[o].orgFarWay,orgNodeWay:t[o].orgNodeWay,tacheObj:f,result:c};n.push(y)}(o);return n},changeStringToArr:function(t){var e=JSON.parse(JSON.stringify(t));return e.forEach(function(t){["3","4","6","7"].includes(t.elementType)&&!Array.isArray(t.value)&&(t.value=""===t.value?[]:t.value.split(","))}),e},getTreeByDomainType:function(){function t(t){return e.apply(this,arguments)}var e=Rt(Xn.a.mark(function t(e){var i;return Xn.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Ro.getTreeByDomainType({domainType:e});case 2:return i=t.sent,t.abrupt("return",i);case 4:case"end":return t.stop()}},t)}));return t}(),setSqlToTree:function(){function t(t){return e.apply(this,arguments)}var e=Rt(Xn.a.mark(function t(e){var i;return Xn.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Ro.setSqlToTree({sql:e});case 2:return i=t.sent,t.abrupt("return",i);case 4:case"end":return t.stop()}},t)}));return t}(),createTitleForm:function(t,e,i,n,o){var r=this,a="";if(this.dirCondition.loadDimenData.forEach(function(e){e.children.forEach(function(e){e.value===n.id&&(t+=e.label,a="".concat(e.elementType))})}),this.commonData.conditionTypeAll.forEach(function(e){e.value===n.oper&&(t+=r.t(e.text))}),["3","4","6","7","37"].includes(a))n.value.forEach(function(e){n.initSqlArr.forEach(function(i){e===i.CODE&&(t+="".concat(i.MEAN,","))})}),n.value.length>0&&(t=t.substring(0,t.length-1)),e!==o[i].condition.length-1&&(o[i].conditionType-1==0&&(t+="】".concat(this.t("options.and"),"【")),o[i].conditionType-2==0&&(t+="】".concat(this.t("options.or"),"【")));else if(["24"].includes(a))e===o[i].condition.length-1?t+=n.staffName:(o[i].conditionType-1==0&&(t+="".concat(n.staffName,"】").concat(this.t("options.and"),"【")),o[i].conditionType-2==0&&(t+="".concat(n.staffName,"】").concat(this.t("options.or"),"【")));else if(["25","9","region"].includes(a))e===o[i].condition.length-1?t+=n.valueName:(o[i].conditionType-1==0&&(t+="".concat(n.valueName,"】").concat(this.t("options.and"),"【")),o[i].conditionType-2==0&&(t+="".concat(n.valueName,"】").concat(this.t("options.or"),"【")));else if(["28","44"].includes(a)){var s="";n.value.length>0&&(n.value.forEach(function(t){a-28==0?r.$i18n&&"en"===r.$i18n.locale?s+="".concat(t.instName,","):s+="".concat(t.instNameCn,","):s+="".concat(t.flowName,",")}),""!==s&&(s=s.substring(0,s.length-1))),e===o[i].condition.length-1?t+=s:(o[i].conditionType-1==0&&(t+="".concat(s,"】").concat(this.t("options.and"),"【")),o[i].conditionType-2==0&&(t+="".concat(s,"】").concat(this.t("options.or"),"【")))}else e===o[i].condition.length-1?t+=n.value:(o[i].conditionType-1==0&&(t+="".concat(n.value,"】").concat(this.t("options.and"),"【")),o[i].conditionType-2==0&&(t+="".concat(n.value,"】").concat(this.t("options.or"),"【")));return t},createTitleTache:function(t,e,i,n,o){var r=this,a="";return this.commonData.tacheDimension.forEach(function(e){e.paramCompCode===n.id&&(t+=e.paramCompName,a=e.paramCompCode)}),this.commonData.nextTacheDimension.forEach(function(e){e.paramCompCode===n.id&&(t+=e.paramCompName,a=e.paramCompCode)}),this.commonData.conditionTypeAll.forEach(function(e){e.value===n.oper&&(t+=r.t(e.text))}),["FLOW.TCH_NUM","preTchMod"].includes(a)?this.dirCondition.getPreTcheInfoData.forEach(function(a){n.value===a.tchMod&&(e===o[i].condition.length-1?t+=a.tchName:(o[i].conditionType-1==0&&(t+="".concat(a.tchName,"】").concat(r.t("options.and"),"【")),o[i].conditionType-2==0&&(t+="".concat(a.tchName,"】").concat(r.t("options.or"),"【"))))}):["TACHE.ACTION"].includes(a)?this.commonData.tacheAction.forEach(function(a){n.value===a.value&&(e===o[i].condition.length-1?t+=a.text:(o[i].conditionType-1==0&&(t+="".concat(a.text,"】").concat(r.t("options.and"),"【")),o[i].conditionType-2==0&&(t+="".concat(a.text,"】").concat(r.t("options.or"),"【"))))}):"preTchAction"===a&&this.commonData.nextTacheAction.forEach(function(a){n.value===a.value&&(e===o[i].condition.length-1?t+=a.text:(o[i].conditionType-1==0&&(t+="".concat(a.text,"】").concat(r.t("options.and"),"【")),o[i].conditionType-2==0&&(t+="".concat(a.text,"】").concat(r.t("options.or"),"【"))))}),t},createTitleStaff:function(t,e,i,n,o){var r=this,a="";return"GLOBAL_VAR.ROLE_GROUP"===n.id?(a="GLOBAL_VAR.ROLE_GROUP",t+=this.t("tacheComp.previousRole")):this.commonData.stffDimenSion.forEach(function(e){e.paramCompCode===n.id&&(t+=e.paramCompName,a=e.paramCompCode)}),this.commonData.conditionTypeAll.forEach(function(e){e.value===n.oper&&(t+=r.t(e.text))}),["GLOBAL_VAR.ORG_ID","GLOBAL_VAR.REGION_ID","GLOBAL_VAR.ROLE_GROUP"].includes(a)?e===o[i].condition.length-1?t+=n.valueName:(o[i].conditionType-1==0&&(t+="".concat(n.valueName,"】").concat(this.t("options.and"),"【")),o[i].conditionType-2==0&&(t+="".concat(n.valueName,"】").concat(this.t("options.or"),"【"))):"GLOBAL_VAR.STAFF_ID"===a&&(e===o[i].condition.length-1?t+=n.staffName:(o[i].conditionType-1==0&&(t+="".concat(n.staffName,"】").concat(this.t("options.and"),"【")),o[i].conditionType-2==0&&(t+="".concat(n.staffName,"】").concat(this.t("options.or"),"【")))),t},makeJsonData:function(t,e){for(var i=this,n=[],o=0;o<t.length;o++)!function(o){t[o].selectArray=null===t[o].selectArray||void 0===t[o].selectArray?[]:t[o].selectArray,t[o].staff=null===t[o].staff||void 0===t[o].staff?[]:t[o].staff,t[o].recommendStaffArr=null===t[o].recommendStaffArr||void 0===t[o].recommendStaffArr?[]:t[o].recommendStaffArr,t[o].recommendArray=null===t[o].recommendArray||void 0===t[o].recommendArray?[]:t[o].recommendArray;for(var r=[],a=0;a<t[o].condition.length;a++){var s=JSON.parse(JSON.stringify(t[o].condition[a]));"form"===s.type&&(s.initSqlArr=[]),r.push(s)}for(var l="",h=0;h<i.commonData.condition.length;h++)t[o].conditionType===i.commonData.condition[h].value&&(l=i.commonData.condition[h].text,t[o].conditionTypeDesc=l);var c="【";if(t[o].condition.forEach(function(e,n){"form"===e.type?c=i.createTitleForm(c,n,o,e,t):"tache"===e.type?c=i.createTitleTache(c,n,o,e,t):"staff"===e.type&&(c=i.createTitleStaff(c,n,o,e,t))}),e!==i.t("editNode.branchStaff"))if(t[o].isSetDeRult?c=i.t("editNode.unconditionally"):c+="】".concat(i.t("editNode.time"),","),e===i.t("editNode.nextTache")){if(0!==t[o].tacheObj.tacheArr.length)if(i.node.advancedProperties.opinionCfg.display){c+=i.t("editNode.handOption");for(var u=0;u<i.node.advancedProperties.opinionCfg.options.length;u++){for(var d="",f=0;f<t[o].tacheObj.tacheArr.length;f++)i.node.advancedProperties.opinionCfg.options[u].value===t[o].tacheObj.tacheArr[f].key&&(d+="".concat(t[o].tacheObj.tacheArr[f].tchName,";"));""!==d&&(c+='"'.concat(i.node.advancedProperties.opinionCfg.options[u].text,'",'),c+=d),i.node.advancedProperties.opinionCfg.selected===i.node.advancedProperties.opinionCfg.options[u].value&&(c+=i.t("editNode.defaultSelect"))}}else for(var p=0;p<t[o].tacheObj.tacheArr.length;p++)c+="".concat(t[o].tacheObj.tacheArr[p].tchName,";")}else if("fromFlow"===t[o].dealWay){var g="";if(t[o].selectBox-1==0)for(var _=0;_<i.commonData.flowStart.length;_++)t[o].selectValue===i.commonData.flowStart[_].value&&(g=i.commonData.flowStart[_].text);if(t[o].selectBox-2==0)for(var m=0;m<i.commonData.preTacheDeal.length;m++)t[o].selectValue===i.commonData.preTacheDeal[m].value&&(g=i.commonData.preTacheDeal[m].text);if(t[o].selectBox-3==0)for(var v=0;v<i.dirCondition.relationFlow.length;v++)if(t[o].selectArray[0]===i.dirCondition.relationFlow[v].value){g="".concat(i.t("editNode.relFlow"),"-").concat(i.dirCondition.relationFlow[v].label);for(var y=0;y<i.dirCondition.relationFlow[v].children.length;y++)if(t[o].selectArray[1]===i.dirCondition.relationFlow[v].children[y].value){g+="-".concat(i.t("editNode.tache"),"：").concat(i.dirCondition.relationFlow[v].children[y].label),t[o].selectValue=i.dirCondition.relationFlow[v].children[y].value;break}}c+="".concat(e,":").concat(g)}else{for(var w="",b=0;b<t[o].staff.length;b++)t[o].staff.length-1===b?w+=t[o].staff[b].name:w+="".concat(t[o].staff[b].name,",");c+="".concat(e,":").concat(w)}else t[o].isSetDeRult?c=i.t("editNode.unconditional"):c+="】";var x="";if(t[o].resultType-16==0){c=i.t("editNode.procedureFetch");var A=t[o].result.replace(/(^\s*)|(\s*$)/g,""),C=A.substring(0,A.indexOf(".")),T=A.substring(A.indexOf(".")+1,A.indexOf("(")),k=A.substring(A.indexOf("(")+1,A.lastIndexOf(")")),S={packageName:C,procName:T,params:k};x=JSON.stringify(S)}else x=t[o].result;t[o].conditionDesc=c,"fromFlow"===t[o].recommendWay&&(t[o].recommendStaff=t[o].recommendStaffValue);var E={rulesTchMod:i.node.tchMod,revisionId:i.revisionId,typeArr:t[o].typeArr,flowCfgRuleId:t[o].flowCfgRuleId,conditionDesc:t[o].conditionDesc,conditionType:t[o].conditionType,isSetDeRult:t[o].isSetDeRult,selectArray:t[o].selectArray,conditionTypeDesc:l,dealWay:t[o].dealWay,selectBox:t[o].selectBox,selectValue:t[o].selectValue,staff:t[o].staff,condition:JSON.stringify(r),resultType:t[o].resultType,resultValue:x,dealFar:t[o].dealFar,dealNode:t[o].dealNode,dealStaff:t[o].dealStaff,choiceWay:t[o].choiceWay,tacheObj:JSON.stringify(t[o].tacheObj),isCanChange:t[o].isCanChange,recommendStaff:t[o].recommendStaff,recommendStaffValue:t[o].recommendStaffValue,recommendWay:t[o].recommendWay,recommendBox:t[o].recommendBox,filterWay:t[o].filterWay,orgFarWay:t[o].orgFarWay,orgNodeWay:t[o].orgNodeWay};n.push(E)}(o);return n},checkfoldingLayer:function(t,e){if(0===t.length)return this.$message({message:this.t("editNode.nextError3"),type:"warning"}),!1;for(var i=0;i<t.length;i++){if(e!==this.t("editNode.branchStaff"))if(e===this.t("editNode.nextTache")){if(!(t[i].tacheObj.tacheArr.length>0))return this.$message({message:this.t("editNode.nextError2"),type:"warning"}),!1;for(var n=0;n<t[i].tacheObj.tacheArr.length;n++)if(""===t[i].tacheObj.tacheArr[n].tchName)return this.$message({message:this.t("editNode.nextError1"),type:"warning"}),!1}else if("F"===t[i].isCanChange){if("fromOrg"===t[i].dealWay&&0===t[i].staff.length){if("fromOrg"===t[i].recommendWay&&0===t[i].recommendStaffArr.length)return this.tipMethod(e,i),!1;if("fromFlow"===t[i].recommendWay&&""===t[i].recommendStaffValue&&0===t[i].recommendArray.length)return this.tipMethod(e,i),!1}if("fromFlow"===t[i].dealWay&&""===t[i].selectValue&&0===t[i].selectArray.length){if("fromOrg"===t[i].recommendWay&&0===t[i].recommendStaffArr.length)return this.tipMethod(e,i),!1;if("fromFlow"===t[i].recommendWay&&""===t[i].recommendStaffValue&&0===t[i].recommendArray.length)return this.tipMethod(e,i),!1}}if(""===t[i].conditionType&&!t[i].isSetDeRult)return this.tipMethod(e,i),!1;for(var o=0;o<t[i].condition.length;o++)if((""===t[i].condition[o].type||""===t[i].condition[o].id||""===t[i].condition[o].oper||""===t[i].condition[o].value)&&!t[i].isSetDeRult)return this.tipMethod(e,i),!1}return!0},tipMethod:function(t,e){this.$message({message:"请将".concat(t,"的第").concat(e+1,"条规则信息填写完整！"),type:"warning"})},getGoCurTchs:function(){var t=this,e=[];if(this.tchModel.getToLinks()){this.tchModel.getToLinks().forEach(function(t){e.push(t.getFromNode().getClient("data"))}),e=e.map(function(e){return{type:1,tchMod:"".concat(e.tchMod),tchName:t.$i18n&&"en"===t.$i18n.locale?e.tchNameUs:e.tchName,changeTchName:"",changeTchNameUs:""}})}return e},getCanReturnToCurTch:function(t,e){var i=this,n="".concat(this.node.tchMod);if(t.getFromLinks()){t.getFromLinks().forEach(function(t){var o=t.getToNode(),r=o.getClient("data");(r.canReturnTaches||"").split(",").some(function(t){return t===n})&&i.options.goReturn.push({type:2,tchMod:"".concat(r.tchMod),tchName:i.$i18n&&"en"===i.$i18n.locale?r.tchNameUs:r.tchName,changeTchName:"",changeTchNameUs:""}),o.getFromLinks()&&"".concat(r.tchMod)!==n&&!e.includes("".concat(r.tchMod))&&(e.push("".concat(r.tchMod)),i.getCanReturnToCurTch(o,e))})}},getPreTchOptions:function(){var t=[];this.options.goReturn=[];var e=this.getGoCurTchs(),i=[],n=[];this.getCanReturnToCurTch(this.tchModel,n);var o={},r=this.options.goReturn.reduce(function(t,e){return o[e.tchMod]||(o[e.tchMod]=t.push(e)),t},[]);return"0BT"===this.node.canTransfer&&i.push({type:3,tchMod:"".concat(this.node.tchMod),tchName:this.t("editNode.transfer"),changeTchName:"",changeTchNameUs:""}),t.concat(e,r,i)},getNextTchOptions:function(){var t=this,e=[];if(this.tchModel.getFromLinks()){var i=[];this.tchModel.getFromLinks().forEach(function(t){i.push(t.getToNode().getClient("data"))}),e=i.map(function(e){return{type:1,tchMod:"".concat(e.tchMod),tchName:"".concat(t.t("editNode.goto"),"：").concat(t.$i18n&&"en"===t.$i18n.locale?e.tchNameUs:e.tchName)}})}var n=this.node,o=n.canReturnTaches;return"0BT"===n.canTransfer&&e.push(this.getCanTransfer()),o&&(e=e.concat(this.getCanReturns(o))),e},getCanReturns:function(t){var e=this,i=this.$refs.fmdTchAttr.options.canReturnTchs;i=i.map(function(t){return{type:2,tchMod:"".concat(t.tchMod),tchName:"".concat(e.t("editNode.backto"),"：").concat(e.$i18n&&"en"===e.$i18n.locale?t.tchNameUs:t.tchName)}});var n=t.split(",");return i.filter(function(t){return n.some(function(e){return t.tchMod===e})})},getCanTransfer:function(){var t=this.node,e=t.tchName,i=t.tchMod,n=t.tchNameUs;return{type:3,tchName:"".concat(this.t("editNode.transfer"),"：").concat(this.$i18n&&"en"===this.$i18n.locale?n:e),tchMod:"".concat(i)}},onAttrChange:function(){this.dirCondition.tacheData2=this.getNextTchOptions()},canReturn:function(t){this.node.advancedProperties.backCfg.isDefaultTacheExecStaff=t}}},la=sa,ha=(i("9f57"),B(la,Wn,Gn,!1,null,"169040c1",null)),ca=ha.exports,ua=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("fi-dialog",{attrs:{visible:t.dialogVisible,"close-on-click-modal":t.disabled,"close-on-press-escape":t.disabled,width:"685px",top:"0","custom-class":"fmd-editor-link","before-close":t.handleClose},on:{"update:visible":function(e){t.dialogVisible=e}}},[i("fi-row",{attrs:{slot:"title"},slot:"title"},[i("div",{staticClass:"title"},[t._v(t._s(t.t("editLink.lunk"))+t._s(t.currentPathInfo)+" "+t._s(t.t("editLink.baseInfo")))])]),i("fi-row",[i("fi-form",{ref:"pathForm",attrs:{disabled:t.disabled,model:t.pathForm,"label-width":"160px",size:"small"}},[i("fi-row",[i("fi-form-item",{attrs:{label:t.t("editLink.pathName")}},[i("fi-input",{attrs:{placeholder:t.t("editLink.inpuPathName")},model:{value:t.pathForm.pathName,callback:function(e){t.$set(t.pathForm,"pathName",e)},expression:"pathForm.pathName"}})],1)],1),i("fi-row",[t.excludeGroup.length?i("fi-form-item",{attrs:{label:t.t("editLink.mutexConfig")}},[i("fi-checkbox-group",{model:{value:t.pathForm.excludePath,callback:function(e){t.$set(t.pathForm,"excludePath",e)},expression:"pathForm.excludePath"}},t._l(t.excludeGroup,function(e,n){return i("fi-checkbox",{key:n,attrs:{label:e.id}},[t._v(t._s(e.label))])}),1)],1):t._e()],1),t.showMulti?i("fi-row",[i("fi-form-item",{attrs:{label:t.t("editLink.convergentType")}},[i("fi-select",{attrs:{placeholder:t.t("editLink.placeHolder")},on:{change:t.multiGroupChange},model:{value:t.pathForm.convergentType,callback:function(e){t.$set(t.pathForm,"convergentType",e)},expression:"pathForm.convergentType"}},t._l(t.multiGroup,function(t){return i("fi-option",{key:t.id,attrs:{value:t.id,label:t.label}})}),1)],1)],1):t._e(),t.showMulti?i("fi-row",[i("fi-form-item",{attrs:{label:t.t("editLink.convergentTache"),prop:"convergentTache"}},[i("fi-input",{attrs:{disabled:t.multiIsDisabled},model:{value:t.pathForm.convergentTache,callback:function(e){t.$set(t.pathForm,"convergentTache",e)},expression:"pathForm.convergentTache"}})],1)],1):t._e()],1)],1),i("fi-row",{staticClass:"footer",attrs:{slot:"footer"},slot:"footer"},[i("fi-button",{attrs:{size:"mini"},on:{click:t.handleClose}},[t._v(t._s(t.disabled?t.t("editLink.close"):t.t("editLink.cancle")))]),t.disabled?t._e():i("fi-button",{attrs:{type:"primary",size:"mini"},on:{click:t.submit}},[t._v(t._s(t.t("editLink.confirm")))])],1)],1)},da=[],fa={name:"fmd-editor-link",mixins:[bn.localeMixin],props:{visible:Boolean,pathModel:Object,disabled:Boolean},computed:{dialogVisible:{get:function(){return this.visible},set:function(t){this.$emit("update:visible",t)}}},data:function(){return{pathForm:{},showMulti:!1,fromNode:{},toNode:{},excludeGroup:[],currentPathInfo:"",tempForm:{},multiGroup:[{id:"F",label:this.t("editLink.divMulInst")},{id:"H",label:this.t("editLink.conMulInst")},{id:"P",label:this.t("editLink.parMulInst")}],multiIsDisabled:!1}},created:function(){this.pathModel&&(this.fromNode=this.pathModel.getFromNode(),this.toNode=this.pathModel.getToNode(),this.tempForm=JSON.parse(JSON.stringify(this.pathModel.getClient("data"))),this.pathForm=this.pathModel.getClient("data"),this.pathForm.excludePath=this.pathForm.excludePath?this.pathForm.excludePath.split(";"):[],this.getExcludeGroup(),this.getReturnExcludeGroup(),this.isShowMultiType(),this.multiGroupChange(this.pathForm.convergentType))},methods:{getExcludeGroup:function(){var t=this;this.excludeGroup=[];var e=this.fromNode.getFromLinks(),i=this.fromNode.getClient("data").tchName;e&&e.forEach(function(e){var n=e.getToNode(),o=n.getClient("data"),r=o.tchName,a=o.tchMod;if(e!==t.pathModel){var s={id:a.toString(),label:"".concat(i,"->").concat(r)};t.excludeGroup.push(s)}else t.currentPathInfo="(".concat(i,"->").concat(r,")")})},getReturnExcludeGroup:function(){var t=this,e=this.fromNode.getClient("data"),i=En.getNodes(),n=e.tchName,o=e.canReturnTaches;if(o){o.split(",").forEach(function(e){var o=i.find(function(t){return"".concat(t.tchMod)==="".concat(e)});if(o&&-1===t.excludeGroup.findIndex(function(t){return t.id==="".concat(o.tchMod)})){var r={id:"".concat(o.tchMod),label:"".concat(n,"->").concat(o.tchName)};t.excludeGroup.push(r),t.pathForm.excludePath.push("".concat(o.tchMod))}})}},isShowMultiType:function(){this.showMulti=this.isMulti(this.fromNode)&&this.isMulti(this.toNode)},isMulti:function(t){var e=t.getClient("data"),i=e.flowMode;return i&&i.includes("multiInst")},handleClose:function(){this.pathModel.setClient("data",this.tempForm),this.dialogVisible=!1},submit:function(){this.pathForm.excludePath=this.pathForm.excludePath.join(";"),this.pathModel.setClient("data",this.pathForm),this.pathModel.setName(this.pathForm.pathName),this.setAllExcludePath(),this.dialogVisible=!1},setAllExcludePath:function(){var t=this;this.fromNode.getFromLinks().forEach(function(e){if(e!==t.pathModel){var i=e.getClient("data"),n=i.nextTchMod;t.pathForm.excludePath.split(";").forEach(function(e){if(e==="".concat(n)){var o=(i.excludePath||"").split(";");o.includes("".concat(t.pathForm.nextTchMod))||o.push("".concat(t.pathForm.nextTchMod)),i.excludePath=o.join(";")}});var o=(i.excludePath||"").split(";");o.forEach(function(e,n){e==="".concat(t.pathForm.nextTchMod)&&((t.pathForm.excludePath||"").split(";").includes("".concat(i.nextTchMod))||(o.splice(n,1),i.excludePath=o.join(";")))}),e.setClient("data",i)}})},multiGroupChange:function(t){if(t)if("F"===t)this.multiIsDisabled=!0;else if("H"===t)this.multiIsDisabled=!1;else{var e=this.fromNode.getClient("data");this.pathForm.convergentTache=e.tchMod}}}},pa=fa,ga=(i("8541"),B(pa,ua,da,!1,null,"1b9342ee",null)),_a=ga.exports,ma={1:"startItem",2:"endItem",3:"midstItem",4:"midstItem"},va={1:"normal",2:"recall"},ya=Ot({},ma,{},Mt(ma)),wa=Ot({},va,{},Mt(va)),ba=function(t){function e(t,i,n){var o;return Bt(this,e),o=Vt(this,Ut(e).call(this,i)),Gt(jt(o),"_movable",!0),o.container=t,o.box=i,o.editable=n,o.container.appendChild(o.getView()),o.adjustBounds({width:t.offsetWidth-17,height:t.offsetHeight-17}),o.setDragToPan(!1),o.setKeyboardRemoveEnabled(!1),o.setWheelToZoom(!1),o.setMovableFunction(function(){return o.editable&&o._movable}),window.onresize=function(){o.adjustBounds({width:o.container.offsetWidth-17,height:o.container.offsetHeight-17})},o}return Ht(e,t),zt(e,[{key:"setNodeMovable",value:function(t){this._movable=t}}]),e}(twaver.vector.Network),xa=ba,Aa=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=arguments.length>4?arguments[4]:void 0;return{advancedProperties:{actionBackTitle:"",actionRunTitle:"",actionTransferTitle:"",beginOrgType:"",beginOrgValue:"",canCancelBackto:"",canCancelBacktoType:"",circularNotifyCfg:n,countersignCfg:{display:!0,parallel:{checked:!1,display:!0,text:o("emptyData.parallel"),textus:"Parallel"},serial:{checked:!1,display:!0,text:o("emptyData.serial"),textus:"Serial"}},defaultOpinionType:"",defaultOpinionValue:"",defaultStaffCanChange:"0BT",defaultStaffCanChangeTrnsf:"",defaultStaffDisabled:"",defaultStaffName:"",defaultStaffSelected:"",defaultStaffType:"",defaultStaffValue:"",endTaskTitle:"",execDesc:"",execDescUs:"",filterStaffWhere:"",isAuto:"",isPool:"",nextTchsCanChange:"",nextTchsIsHiddenOther:"",nextTchsIsSelected:"",nextTchsType:"",nextTchsValue:"",notifyRootOrgCanChange:"0BT",notifyRootOrgType:"",notifyRootOrgValue:"",notifyStaffCanChange:"0BT",notifyStaffCreateType:"",notifyStaffDisabled:"",notifyStaffSelected:"",notifyStaffType:"",notifyStaffValue:"",onAfterCreate:"",onAfterCreateType:"",onAfterFinish:"",onAfterFinishType:"",onBeforeCreate:"",onBeforeCreateType:"",onBeforeFinish:"",onBeforeFinishType:"",onCreate:"",onCreateType:"",onFinish:"",onFinishType:"",opinionCfg:{display:!1,options:[{text:o("emptyData.agree"),value:"0BT"},{text:o("emptyData.disagree"),value:"0BF"}],selected:"0BT",refresh:!0},opinionType:"",processorNotifyCfg:i,rootOrgCanChange:"0BT",rootOrgType:"",rootOrgValue:"",sortId:0,staffCreateType:"",tchMod:e,tacheRulesData:{nextTacheData:[],dealTacheData:[],readTacheData:[],roleGroupData:[]},winStyle:{},winConfig:"",recommendStaffValue:null,windConfigInfo:{showSaveSucceed:!1,showFlowName:!0,showAttach:!0,model:"layer"},oa:{isStartOa:"0BF",roleGroupId:"",defaultStaffType:"",staffCreateType:"",beginOrgType:"fix",beginOrgValue:"",rootOrgType:"",rootOrgValue:"",notifyConfig:{sms:{display:"true",selected:"true",canChange:"true"},mail:{display:"true",selected:"true",canChange:"true"}}},isFreeFlow:"0BF"},tacheForm:{formAction:null,fieldRights:[]},canReturnTaches:"",execMethod:"1",execProc:null,flowMod:t,flowMode:[],canReturn:"0BF",canTransfer:"0BF",multiInstMerge:"0",newFlowMod:null,remark:null,staffCreateType:null,staffFunc:null,state:"A",stateDate:null,subFlowMod:null,tacheSS:{col:0,row:0},tchMod:e,tchName:"",tchNum:"".concat(e),tchType:3,consultAdvices:[],slaTime:"",slaUnit:""}},Ca=function(t,e,i,n){return{excludePath:arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,pathSS:null,flowMod:t,multiType:"",nextTchMod:i,pathType:1,tchMod:e,pathName:"",convergentType:null,convergentTache:null}},Ta=function(t,e){return{flowMod:t,groupId:e,groupName:"",groupSS:{start:0,end:0}}},ka={node:Aa,link:Ca,lane:Ta},Sa={styles:{"select.style":"none","label.position":"center","label.color":Ji.normal}},Ea=function(t){return{startItem:{options:oe({},Sa,{image:"fmd_start_item"}),class:"fmd-edges",nameLength:"en"===t?[6,12]:[2,4]},endItem:{options:oe({},Sa,{image:"fmd_end_item"}),class:"fmd-edges",nameLength:"en"===t?[6,12]:[2,4]},midstItem:{options:oe({},Sa,{image:"fmd_midst_item"}),class:"fmd-midst",nameLength:"en"===t?[12,24]:[6,12]}}},Ia=function(t){function e(t){var i;$t(this,e);var n=t.data,o=void 0===n?{}:n,r=Xt(t,["data"]),a=r.type,s=r.name,l=void 0===s?"":s,h=r.toolTip,c=Xt(r,["type","name","toolTip"]),u=Ea(f())[a]||{};return i=Jt(this,te(e).call(this,oe({},u.options,{},c))),i.realName=l,i.type=a,i.setName(pt(Ea(f())[a],l)),"function"==typeof h?i.toolTip=h:i.setToolTip(h||l),Object.keys(o).forEach(function(t){i.setClient(t,o[t])}),i}return ee(e,t),Kt(e,[{key:"setNodeActive",value:function(t){if(!this.getClient("flowed")){var e=t||this.getClient("focus")||this.getClient("hover");this.setStyle("label.color",Ji[e?"active":"normal"])}}},{key:"setNodeActiveByReadOnly",value:function(t){this.setStyle("label.color",Ji[t?"success":"normal"])}},{key:"showLabelInput",value:function(t){var e=this;1!==t.getZoom()&&t.setZoom(1);var i=t.getView().getBoundingClientRect(),n=i.top,o=i.left,r=t.viewRect,a=r.x,s=r.y,l=t.getPosition("topleft.topright",this,{width:0,height:0},o-a,n-s),h=l.x,c=l.y,u=document.createElement("input"),d=u.style,p=Ea(f())[this.type],g=13*(+this.getClient("col")||1)-6;p.nameLength=[g,g],d.position="absolute",d.left="".concat(h+6,"px"),d.top="".concat(c+10,"px"),d.height="29px",d.width="80px",d.display="",d.outline="none",d.border="0px solid #cccccc";var _=this.realName||"";u.value=_,u.onblur=function(){var t=pt(p,u.value);e.setName(t),e.setToolTip(u.value),e.realName=u.value,e.getClient("data").tchName=u.value,document.body.removeChild(u)},document.body.appendChild(u),u.focus()}}]),e}(twaver.Node),La={style:{"link.color":Ji.line,"arrow.to":!0,"arrow.to.color":Ji.line,"arrow.to.shape":"arrow.delta","arrow.to.width":5,"arrow.to.height":8,"link.width":1,"select.style":"none","label.position":"center","label.fill":!0,"label.fill.color":Ji.background,"label.color":Ji.line,"label.font":Qi.normal},returnStyle:{"link.color":Ji.poly,"arrow.to.color":Ji.poly,"label.color":Ji.poly,"link.pattern":[5,2]},positionMap:{top:"top.bottom",right:"right.left",left:"left.right",bottom:"bottom.top"}},Ra=function(t){function e(t,i){var n;se(this,e);var o=t.data,r=t.type,a=t.name,s=t.fromNode,l=t.toNode,h=t.id;n=h?ce(this,de(e).call(this,h,s,l)):ce(this,de(e).call(this,s,l)),n.setName(a),n.type=r;var c="recall"===n.type?Object.assign({},La.style,La.returnStyle):La.style;return n.flowed=o.flowed,Object.keys(c).forEach(function(t){n.setStyle(t,c[t])}),Object.keys(o).forEach(function(t){n.setClient(t,o[t])}),n.setPosition(i),ce(n)}return fe(e,t),he(e,[{key:"setPosition",value:function(t){if(t){var e=t.split("."),i=La.positionMap,n=i[e[0]],o=i[e[1]||e[0]];this.setStyle("link.from.position",n),this.setStyle("link.to.position",o)}}},{key:"setFLowed",value:function(){this.flowed&&(this.setStyle("link.color",Ji.active),this.setStyle("label.color",Ji.active),this.setStyle("arrow.to.color",Ji.active))}},{key:"setLinkActive",value:function(t){if(!this.flowed){var e=t||this.getClient("focus")||this.getClient("hover"),i=Ji[e?"active":"line"];this.setStyle("link.color",i),this.setStyle("label.color",i),this.setStyle("arrow.to.color",i)}}},{key:"getCenterLocation",value:function(t){return t.getPosition("center",this,{width:0,height:0},0,0)}},{key:"showLabelInput",value:function(t){var e=this;1!==t.getZoom()&&t.setZoom(1);var i=t.getView().getBoundingClientRect(),n=i.top,o=i.left,r=t.viewRect,a=r.x,s=r.y,l=t.getPosition("topleft.topright",this,{width:0,height:0},o-a,n-s),h=l.x,c=l.y,u=document.createElement("input"),d=u.style;d.width="60px",d.textAlign="center",d.position="absolute",d.left="".concat(h-30,"px"),d.top="".concat(c-13,"px"),d.height="25px",d.display="",d.outline="none",d.border="1px solid #cccccc";var f=this.getName()?this.getName():"";u.value=f,u.onblur=function(){var t=u.value?u.value:f;e.setName(t),e.getClient("data").pathName=t,document.body.removeChild(u)},document.body.appendChild(u),u.focus()}}]),e}(twaver.ShapeLink),Pa={laneItem:{options:{styles:{"select.style":"none","label.position":"topleft.topright","label.yoffset":26,"label.xoffset":10,"label.color":Ji.normal},image:"fmd_lane"},class:"fmd-lane",nameLength:[14,14]}},Oa=function(t){function e(t){var i;be(this,e);var n=t.data,o=void 0===n?{}:n,r=ye(t,["data"]),a=r.type,s=void 0===a?"laneItem":a,l=r.name,h=void 0===l?"":l,c=r.toolTip,u=ye(r,["type","name","toolTip"]),d=Pa[s]||{};i=Ce(this,ke(e).call(this,me({},d.options,{},u,{movable:!1}))),i.realName=h,i.type=s;var f=14*(+o.col||1)-5;return d.nameLength=[f,f],i.setName(pt(d,h)),"function"==typeof c?i.toolTip=c:i.setToolTip(c||h),Object.keys(o).forEach(function(t){i.setClient(t,o[t])}),i}return Se(e,t),Ae(e,[{key:"setNodeActive",value:function(t){var e=t||this.getClient("focus")||this.getClient("hover");this.setStyle("label.color",Ji[e?"active":"normal"])}},{key:"showLabelInput",value:function(t){var e=this,i=t.getView().getBoundingClientRect(),n=i.top,o=i.left,r=t.viewRect,a=r.x,s=r.y,l=t.getPosition("topleft.topright",this,{width:0,height:0},o-a,n-s),h=l.x,c=l.y,u=document.createElement("input"),d=u.style,f=Pa[this.type],p=14*(+this.getClient("col")||1)-5;f.nameLength=[p,p],d.position="absolute",d.left="".concat(h+10,"px"),d.top="".concat(c+4,"px"),d.height="25px",d.width="".concat(13*p,"px"),d.display="",d.outline="none",d.border="1px solid #cccccc";var g=this.realName||"";u.value=g,u.onblur=function(){var t=pt(f,u.value);e.setName(t),e.setToolTip(u.value),e.realName=u.value,e.getClient("data").groupName=u.value,document.body.removeChild(u)},document.body.appendChild(u),u.focus()}}]),e}(twaver.Node),Da=i("0e15"),Ma=i.n(Da),Na=function(t){function e(t,i){var n;return Le(this,e),n=Oe(this,De(e).call(this,t)),Fe(Me(n),"_fmdHost",null),i&&Object.keys(i).forEach(function(t){n.setClient(t,i[t])}),n}return Ne(e,t),Pe(e,[{key:"setNodeActive",value:function(t){var e=t||this.getClient("focus")||this.getClient("hover");this.setStyle("label.color",Ji[e?"background":"normal"])}},{key:"bindHost",value:function(t){this._fmdHost=t,t instanceof twaver.Node&&this.setHost(t)}},{key:"getBindHost",value:function(){return this._fmdHost||this.getHost()}}]),e}(twaver.Follower),Ba=Na,Fa=function(){function t(){var e=this;ze(this,t),je(this,"isToolBarLinkActive",!1),je(this,"showPlaceholder",Ma()(10,function(t){t instanceof Ia&&e.$eventHandler.state.clickSelected&&e.$eventHandler.dispatch("node/showPlaceholder")}))}return Ue(t,[{key:"addEventListener",value:function(t,e){if(e&&"function"==typeof e){this.network.getView().addEventListener(t,e)}}},{key:"_initEvent",value:function(){if(this._initToolbarEvent(),this.editable){this.$eventHandler.dispatch("link/initDropLink"),this.$eventHandler.dispatch("node/initNodePlaceholder"),this.$eventHandler.dispatch("menu/initMenu"),this._editableMousemoveEvent(),this._editableMouseDownEvent(),this._editableMouseUpEvent(),this._editableMouseLeaveEvent();var t=this.$eventHandler.state.menu,e=t.nodeMenu,i=t.linkMenu,n=t.laneMenu;Object.assign(this,{nodeMenu:e,linkMenu:i,laneMenu:n})}else this._readonlyMouseDown()}},{key:"_initToolbarEvent",value:function(){var t=this;Nn.$on(Bn.TOOLBAR_CLICK,function(){t._toolbarClick.apply(t,arguments)})}},{key:"_toolbarClick",value:function(t){var e=t.key,i=t.isLinkActive;switch(this.$eventHandler.commit("link/setIsToolBarLinkActive",i),e){case"toolbar_link":this.$eventHandler.dispatch("link/onLink");break;case"toolbar_plus":this.network.zoomIn();break;case"toolbar_minus":this.network.zoomOut();break;case"toolbar_addLane":this.$eventHandler.dispatch("lane/addLane");break;case"toolbar_lane":this.$eventHandler.dispatch("lane/toggleLane")}}},{key:"_readonlyMousemoveEvent",value:function(){var t=this;this.addEventListener("mousemove",function(e){var i=t.network.getElementAt(e);t.box.forEach(function(e){t._elementHover(i,e)})})}},{key:"_editableMousemoveEvent",value:function(){var t=this;this.addEventListener("mousemove",function(e){var i=t.network.getElementAt(e),n=t.$eventHandler.state.link.isToolBarLinkActive;t.box.forEach(function(e){t._elementHover(i,e,n)}),n&&t.$eventHandler.dispatch("link/setCurrentPoint",e),i instanceof Ba&&"icon"!==i.getClient("menuType")&&t.network.setToolTipEnabled(!1),t.network.setToolTipEnabled(!0),t.showPlaceholder(i)})}},{key:"_readonlyMouseDown",value:function(){var t=this;this.addEventListener("mousedown",function(e){var i=t.network.getElementAt(e);t.$eventHandler.dispatch("menu/infoMenuClick",i),t.box.forEach(function(e){t._elementClick(i,e)})})}},{key:"_editableMouseDownEvent",value:function(){var t=this;this.addEventListener("mousedown",function(e){if(t.$eventHandler.state.link.isToolBarLinkActive)t._hideMenu(),t.$eventHandler.dispatch("link/nodeLinking",e);else{t._hideMenu();var i=t.network.getElementAt(e);t.box.forEach(function(e){t._elementClick(i,e)}),(i instanceof Ia||i instanceof Ra||i instanceof Oa)&&t.$eventHandler.dispatch("setClickSelected",i),t.$eventHandler.dispatch("menu/menuClick",i)}})}},{key:"mouseUpevent",value:function(t){var e=this.$eventHandler.state.clickSelected,i=e||{},n=i.target;!this.$eventHandler.state.link.isToolBarLinkActive&&e&&(this.network.isMovingElement()||t?n instanceof Ia&&this.$eventHandler.dispatch("node/moveNode",e):this._activeMenu(n),this.$eventHandler.dispatch("node/hidePlaceholder"),this.$eventHandler.dispatch("setClickSelected",null))}},{key:"_editableMouseUpEvent",value:function(){var t=this;this.addEventListener("mouseup",function(){t.mouseUpevent()})}},{key:"_editableMouseLeaveEvent",value:function(){var t=this;this.addEventListener("mouseleave",function(){t.$eventHandler.state.clickSelected&&t.mouseUpevent(!0)})}},{key:"_activeMenu",value:function(t){return t instanceof Ia?void this.nodeMenu.setActive(t,!0):t instanceof Ra?void this.linkMenu.setActive(t,!0):void(t instanceof Oa&&this.laneMenu.setActive(t,!0))}},{key:"_hideMenu",value:function(){this.editable&&(this.laneMenu.setActive(null,!1),this.nodeMenu.setActive(null,!1),this.linkMenu.setActive(null,!1))}},{key:"_elementHover",value:function(t,e,i){if(e instanceof Ia||e instanceof Ba){var n=e===t;e.setClient("hover",n),e.setNodeActive()}if(!i&&e instanceof twaver.Link){var o=e===t;e.setClient("hover",o),e.setLinkActive()}}},{key:"_elementClick",value:function(t,e){var i=e===t;(e instanceof Ia||e instanceof Oa)&&(e instanceof Ia&&!this.editable?this.setSuccessStyle(e,i):(e.setClient("focus",i),e.setNodeActive(i))),this.editable&&e instanceof twaver.Link&&(e.setClient("focus",i),e.setLinkActive())}},{key:"setSuccessStyle",value:function(t,e){t.setClient("success",e),t.setNodeActiveByReadOnly(e);var i=t.getFromLinks();i&&i.forEach(function(t){t.setStyle("link.color",e?Ji.success:Ji.line),t.setStyle("arrow.to.color",e?Ji.success:Ji.line),t.setStyle("label.color",e?Ji.success:Ji.poly),t.getToNode()&&t.getToNode().setClient("success",e),t.getToNode()&&t.getToNode().setNodeActiveByReadOnly(e)})}}]),t}(),za={state:{isToolBarLinkActive:!1,fromNode:null,toNode:null,currentPoint:null,singleLink:!1},mutations:{setIsToolBarLinkActive:function(t,e){t.isToolBarLinkActive=e},setCurrentPoint:function(t,e){t.currentPoint=e},setFromNode:function(t,e){t.fromNode=e},setToNode:function(t,e){t.toNode=e},setSingleLink:function(t,e){t.singleLink=e},closeSingleLink:function(t){t.singleLink&&(t.isToolBarLinkActive=!1,t.singleLink=!1)}},actions:{linkFromNode:function(t,e){var i=t.commit;i("setIsToolBarLinkActive",!0),i("setSingleLink",!0),i("setFromNode",e)},createLink:function(t,e){var i=t.rootState,n=e.fromNode,o=e.toNode,r=e.type,a=void 0===r?"normal":r,s=e.id,l=rt(n,o,i.node.nodeMap),h=l.position,c=l.style,u=l.point,d=n.getClient("data").tchMod,f=o.getClient("data").tchMod,p={pid:"".concat(d),id:"".concat(f)};qn.addNode(p);var g=We(n,f),_=ka.link(i.flowMod,d,f,a,g.join(";")),m=new Ra({id:s,fromNode:n,toNode:o,type:a,data:{data:_,type:a}},h);return Object.keys(c).forEach(function(t){m.setStyle(t,c[t])}),u.forEach(function(t){m.addPoint(t)}),i.box.add(m),m},setCurrentPoint:function(t,e){var i=t.rootState;(0,t.commit)("setCurrentPoint",i.network.getLogicalPoint(e)),i.network.invalidateElementUIs()},nodeLinking:function(t,e){var i=t.state,n=t.commit,o=t.rootState,r=t.dispatch,a=w(),s=o.network.getElementAt(e);if(s instanceof Ia){var l=i.fromNode,h=i.toNode;if(l)h||n("setToNode",s);else{if("endItem"===s.type)return void g({type:"warning",message:a("link.nodeLinking")});n("setFromNode",s)}i.fromNode&&i.toNode&&r("canLinking",{fromNode:i.fromNode,toNode:i.toNode})&&r("addLink")}else n("closeSingleLink"),r("clearSelectNode")},canLinking:function(t,e){var i=t.commit,n=t.dispatch,o=e.fromNode,r=e.toNode,a=o.getFromLinks(),s=w(),l=!0;return a&&a.forEach(function(t){t._toNode===r&&(l=!1,g({type:"warning",message:s("link.canLinking")}),i("closeSingleLink"),n("clearSelectNode"))}),o===r&&(l=!1,i("closeSingleLink"),n("clearSelectNode")),l},addLink:function(t){var e=t.rootState,i=t.state,n=t.commit,o=t.dispatch,r=i.fromNode,a=i.toNode,s=null,l=rt(r,a,e.node.nodeMap),h=r.getClient("data").tchMod,c=a.getClient("data").tchMod,u={pid:"".concat(h),id:"".concat(c)};qn.addNode(u);var d=r.getClient("data"),f=d.canReturn,p=d.canReturnTaches;if("0BT"===f&&p){var g=p.split(","),_=g.filter(function(t){return"".concat(t)!=="".concat(c)}).join(",");d.canReturnTaches=_,r.setClient("data",d)}var m=We(r,c),v=ka.link(e.flowMod,h,c,"normal",m.join(";")),y=l.position,w=l.style,b=l.point;s=new Ra({fromNode:r,toNode:a,type:"normal",data:{data:v,type:"normal"}},y),Object.keys(w).forEach(function(t){s.setStyle(t,w[t])}),b.forEach(function(t){s.addPoint(t)}),e.box.add(s),n("closeSingleLink"),o("clearSelectNode")},delLink:function(t,e){var i=e.getFromNode().getClient("data"),n=e.getToNode().getClient("data");qn.delNodeByLink({pid:"".concat(i.tchMod),id:"".concat(n.tchMod)},e.getToNode())},clearSelectNode:function(t){var e=t.state,i=t.commit,n=e.fromNode,o=e.toNode;n&&i("setFromNode",null),o&&i("setToNode",null)},initDropLink:function(t){var e=t.rootState,i=t.state,n=Ji.line;e.network.paintTop=function(t){if(i.isToolBarLinkActive&&i.fromNode&&i.currentPoint){var e=i.fromNode.getCenterLocation(),o=i.currentPoint;t.strokeStyle=n,t.lineWidth=2,t.beginPath(),t.moveTo(e.x,e.y),t.lineTo(o.x,o.y),t.stroke(),t.beginPath(),t.fillStyle=n;var r={x:o.x-12,y:o.y-6},a={x:o.x-8,y:o.y},s={x:o.x-12,y:o.y+6},l=He(e,o),h=_twaver.math.createMatrix(l,o.x,o.y);r=h.transform(r),a=h.transform(a),s=h.transform(s),t.moveTo(o.x,o.y),t.lineTo(r.x,r.y),t.lineTo(a.x,a.y),t.lineTo(s.x,s.y),t.closePath(),t.fill()}}},onLink:function(t){var e=t.dispatch,i=t.state,n=t.rootState,o=t.commit;i.isToolBarLinkActive&&o("setSingleLink",!1),n.network.setNodeMovable(!i.isToolBarLinkActive),e("clearSelectNode")}}},Va={state:{laneMap:[],height:0,isShow:!0,loading:!1},mutations:{setLaneMap:function(t,e){t.laneMap=e},addLane:function(t,e){t.laneMap.push(e)},delLane:function(t,e){var i=t.laneMap.findIndex(function(t){return t===e});t.laneMap.splice(i,1)},setHeight:function(t,e){t.height=e},setIsShowLane:function(t,e){t.isShow=!e},setLoading:function(t,e){t.loading=e}},actions:{addLane:function(){function t(t){return e.apply(this,arguments)}var e=Ze(Xn.a.mark(function t(e){var i,n,o,r,a,s,l,h;return Xn.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(i=e.state,n=e.rootState,o=e.commit,r=w(),!i.loading){t.next=4;break}return t.abrupt("return");case 4:if(!((a=wt(i.laneMap))<0)){t.next=7;break}return t.abrupt("return");case 7:return o("setLoading",!0),t.next=10,k();case 10:s=t.sent,o("setLoading",!1),l=ka.lane(n.flowMod,s),h=new Oa({id:s,name:r("lane.name"),location:bt(a),data:{type:"laneItem",col:1,start:a,end:a+1,height:i.height,data:l}}),h.showLabelInput(n.network),o("addLane",h),n.box.add(h);case 17:case"end":return t.stop()}},t)}));return t}(),removeLane:function(t,e){var i=t.rootState;(0,t.commit)("delLane",e),i.box.remove(e)},addCol:function(t,e){var i=t.state,n=i.laneMap,o=n.sort(function(t,e){return+t.getClient("start")-+e.getClient("start")}),r=o.findIndex(function(t){return t===e});if(!(r<0)&&(e.setClient("end",+e.getClient("end")+1),e.setClient("col",+e.getClient("col")+1),r<o.length-1&&e.getClient("end")-1===o[r+1].getClient("start")))for(var a=r+1;a<o.length;a++){var s=o[a],l=+s.getClient("start")+1;s.setClient("end",+s.getClient("end")+1),s.setClient("start",l),s.setLocation(bt(l))}},delCol:function(t,e){var i=t.state,n=w();if(1===e.getClient("col"))return void g({type:"warning",message:n("lane.min")});var o=i.laneMap,r=o.sort(function(t,e){return+t.getClient("start")-+e.getClient("start")}),a=r.findIndex(function(t){return t===e});e.setClient("end",+e.getClient("end")-1),e.setClient("col",+e.getClient("col")-1);for(var s=a+1;s<r.length;s++){var l=r[s],h=+l.getClient("start")-1;l.setClient("end",+l.getClient("end")-1),l.setClient("start",h),l.setLocation(bt(h))}},updateLaneMap:function(t,e){var i=t.commit,n=t.dispatch,o=t.rootState;i("setLaneMap",e),n("resizeLaneHeight",o.network.viewRect.height)},resizeLaneHeight:function(t){var e=t.state,i=t.rootState,n=t.commit,o=yt(i.node.nodeMap),r=i.network.viewRect.height,a=Math.max(o,r);a!==e.height&&(e.laneMap.forEach(function(t){t.setClient("height",a)}),n("setHeight",a))},toggleLane:function(t){var e=t.state;(0,t.commit)("setIsShowLane",e.isShow),e.laneMap.forEach(function(t){t.setVisible(e.isShow)})}}},Ua=function(t){function e(){return qe(this,e),Qe(this,si(e).apply(this,arguments))}return ei(e,t),Je(e,[{key:"pushData",value:function(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];this.push({type:t,data:i})}}]),e}(ii(Array)),ja={state:{nodeMap:[],placeholderNode:null,loading:!1,fieldRights:[],processorNotifyCfg:{},circularNotifyCfg:{}},mutations:{setNodeMap:function(t,e){t.nodeMap=e},setPlaceholderNode:function(t,e){t.placeholderNode=e},setLoading:function(t,e){t.loading=e},setFieldRights:function(t,e){t.fieldRights=e},setProcessorNotifyCfg:function(t,e){t.processorNotifyCfg=e},setCircularNotifyCfg:function(t,e){t.circularNotifyCfg=e}},actions:{createNodeOption:function(){function t(t){return e.apply(this,arguments)}var e=Ye(Xn.a.mark(function t(e){var i,n,o,r,a,s,l,h,c,u,d,f,p,g,_,m,v,y,b=arguments;return Xn.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=e.rootState,n=b.length>1&&void 0!==b[1]?b[1]:{},o=w(),t.next=5,T();case 5:return r=t.sent,a=n.type,s=void 0===a?"midstItem":a,l=n.index,h=void 0===l?{}:l,c=n.tableFields,u=void 0===c?[]:c,d=i.node,f=d.processorNotifyCfg,p=d.circularNotifyCfg,g=ka.node(i.flowMod,r,f,p,o),_="3",m={midstItem:r,startItem:o("tacheModel.startNode"),endItem:o("tacheModel.endNode")}[s],g.tchType=_,g.tchName=m,g.tchNameUs=m,g.tacheForm.fieldRights=JSON.parse(JSON.stringify(i.node.fieldRights)),g.tacheForm.formAction="R",v=lt(h),y=new Ia({name:m,type:s,data:{data:g,tableFields:u,type:s},centerLocation:v,index:h}),i.box.add(y),t.abrupt("return",y);case 20:case"end":return t.stop()}},t)}));return t}(),addNode:function(){function t(t,i){return e.apply(this,arguments)}var e=Ye(Xn.a.mark(function t(e,i){var n,o,r,a,s,l,h,c,u,d,f,p,g,_,m,v,y;return Xn.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.dispatch,o=e.state,r=e.rootState,a=e.commit,!o.loading){t.next=3;break}return t.abrupt("return");case 3:return a("setLoading",!0),s=i.getClient("tableFields"),t.next=7,n("createNodeOption",{tableFields:s});case 7:l=t.sent,En.addNode(l.getClient("data")),a("setLoading",!1),h=o.nodeMap,c=i.getCenterLocation(),u=ht(c),d={col:u.col+1,row:u.row},f=u.col+1===h.length-1,p=h[h.length-1][0],d.col===h.length-1&&h.splice(u.col+1,0,[]),f&&(g={col:h.length-1,row:0},dt(p,g,h)),_=h[d.col],m=u.row,v=_.findIndex(function(t,e){return e>=m&&!t}),-1===v&&(v=_[d.row]?_.length:d.row),_[v]=l,y=lt({col:d.col,row:v}),l.setCenterLocation(y),n("link/createLink",{fromNode:i,toNode:l},{root:!0}),n("lane/resizeLaneHeight",null,{root:!0}),l.showLabelInput(r.network),st(i,h);case 29:case"end":return t.stop()}},t)}));return t}(),removeNode:function(t,e){var i=t.state,n=t.rootState,o=t.dispatch,r=new Ua,a=i.nodeMap,s=ht(e.getCenterLocation());mt(a,s),n.box.remove(e),r.pushData("removeNode",e),En.delNode(e.getClient("data")),qn.delNode(e.getClient("data"));var l=!a[s.col].some(function(t){return t})&&a.length>n.fitColumns,h=!a.some(function(t){return t[s.row]});return l&&(a.splice(s.col,1),a.forEach(function(t,e){e>=s.col&&t.forEach(function(t,i){if(t){var n={col:e,row:i};!h&&r.pushData("moveNode",t,n),ut(t,lt(n),a)}})})),h&&a.forEach(function(t,e){t.splice(s.row,1),t.forEach(function(t,i){if(t&&i>=s.row){var n={col:e,row:i};r.pushData("moveNode",t,n),ut(t,lt(n),a)}})}),o("lane/resizeLaneHeight",null,{root:!0}),r},moveNode:function(t,e){var i=t.state,n=t.rootState,o=t.dispatch,r=e.target,a=e.centerLocation,s=r.getClient("moveAction"),l=i.nodeMap,h=new Ua;if(!s)return r.setCenterLocation(a),h;var c=ht(a),u=s.h,d=s.v;if(s.exchange){var f={col:u.index,row:d.index},p=_t(l,f);return dt(p,c,l),h.pushData("moveNode",p,c),dt(r,f,l),h.pushData("moveNode",r,f),vt(l,c,f),h}mt(l,c);var g={col:u.index,row:d.index},_={},m=l.length+("insert"===u.type)>n.fitColumns,v=c.col!==g.col&&!l[c.col].some(function(t){return t})&&m,y=!l.some(function(t){return t[c.row]});return v&&(_.col=c.col),y&&(_.row=c.row),"insert"===u.type&&(_.col+=!u.toRight,l.splice(g.col,0,[]),l.forEach(function(t,e){e>g.col&&t.forEach(function(t,i){if(t){var n={col:e,row:i};!v&&!y&&"insert"!==d.type&&h.pushData("moveNode",t,n),ut(t,lt(n),l)}})})),"insert"===d.type&&(_.row+=!d.toBottom,l.forEach(function(t,e){t.splice(g.row,0,void 0),t.forEach(function(t,i){if(t&&i>g.row){var n={col:e,row:i};!v&&!y&&h.pushData("moveNode",t,n),ut(t,lt(n),l)}})})),v&&(g.col-=u.toRight,l.splice(_.col,1),l.forEach(function(t,e){e>=_.col&&t.forEach(function(t,i){if(t){var n={col:e,row:i};!y&&h.pushData("moveNode",t,n),ut(t,lt(n),l)}})})),y&&(g.row-=d.toBottom,l.forEach(function(t,e){t.splice(_.row,1),t.forEach(function(t,i){if(t&&i>=_.row){var n={col:e,row:i};h.pushData("moveNode",t,n),ut(t,lt(n),l)}})})),mt(l,g,r),h.pushData("moveNode",r,g),ut(r,lt(g),l),r.setClient("moveAction",null),o("lane/resizeLaneHeight",null,{root:!0}),h},showPlaceholder:function(t){var e=t.state,i=t.rootState,n=t.dispatch;if(i.clickSelected){var o=i.clickSelected,r=o.target,a=o.centerLocation;if(r&&a){var s=n("getPlaceholderLocation",{target:r,originalLocation:a})||{},l=s.targetLoc,h=void 0===l?a:l,c=s.moveAction,u=void 0===c?null:c;r.setClient("moveAction",u),e.placeholderNode.setCenterLocation(h),e.placeholderNode.setVisible(!0)}}},getPlaceholderLocation:function(t,e){var i=t.state,n=e.target,o=e.originalLocation,r=i.nodeMap,a=n.getCenterLocation(),s=ht(ct(n,o)),l=lt(s),h=en.repulsion,c=h.row,u=h.column,d=o.x<l.x,f=o.y<l.y,p={},g=a.x>l.x-tn.rect.w/2&&a.x<l.x+tn.rect.w/2,_=a.x>l.x;if(s.col<0||0===s.col&&!_||s.col>r.length-1||s.col===r.length-1&&_)return null;if("startItem"===n.type&&0!==s.col)return null;if(r[s.col].some(function(t){return t&&n!==t})){var m=_?s.col+1:s.col-1;g&&0!==s.col&&s.col!==r.length-1?p.h={type:"move",index:s.col,toRight:d}:r[m].some(function(t){return t&&t!==n})?(l.x=_?l.x+u/2:l.x-u/2,p.h={type:"insert",index:m+!_,toRight:d}):(l.x=_?l.x+u:l.x-u,p.h={type:"move",index:m,toRight:d})}else p.h={type:"move",index:s.col,toRight:d};var v=a.y>l.y-tn.rect.h/2&&a.y<l.y+tn.rect.h/2,y=a.y>=l.y;if(s.row<0||0===s.row&&a.y<l.y-tn.rect.h/2)return null;if(r.some(function(t){return t[s.row]&&t[s.row]!==n})){var w=y?s.row+1:s.row-1;v?p.v={type:"move",index:s.row,toBottom:f}:r.some(function(t){return t[w]&&t[w]!==n})?(l.y=y?l.y+c/2:l.y-c/2,p.v={type:"insert",index:w+!y,toBottom:f}):(l.y=y?l.y+c:l.y-c,p.v={type:"move",index:w,toBottom:f})}else p.v={type:"move",index:s.row,toBottom:f};return"move"===p.h.type&&"move"===p.v.type&&r[p.h.index][p.v.index]&&(p.exchange=!0),{targetLoc:l,moveAction:p}},hidePlaceholder:function(t){t.state.placeholderNode.setVisible(!1)},initNodePlaceholder:function(t){var e=t.rootState,i=t.commit,n=new twaver.Node({image:"fmd_placeholder",movable:!1,visible:!1});i("setPlaceholderNode",n),e.box.add(n)},initFieldRights:function(t,e){var i=t.commit;e.forEach(function(t){t.isReadonly="T"}),i("setFieldRights",e)},initProcessorNotifyCfg:function(t,e){(0,t.commit)("setProcessorNotifyCfg",e)},initCircularNotifyCfg:function(t,e){(0,t.commit)("setCircularNotifyCfg",e)}}},Ha=function(t){return{styles:{"select.style":"none","label.position":"center","label.color":Ji.normal},menuType:{node:[{name:t("menu.addBtn"),data:{event:"menuNodeAdd",type:"nodeAdd"}},{name:t("menu.delBtn"),data:{event:"menuNodeDel",type:"nodeDel"}},{name:t("menu.editBtn"),data:{event:"menuNodeEdit",type:"nodeEdit"}},{name:t("menu.linkBtn"),data:{event:"menu_linkAdd",type:"linkAdd"}}],link:[{name:t("menu.editBtn"),data:{event:"menuLinkEdit",type:"linkEdit"}},{name:t("menu.delBtn"),data:{event:"menuLinkDel",type:"linkDel"}},{name:t("menu.renameBtn"),data:{event:"menuLinkRename",type:"linkRename"}}],lane:[{img:"fmd_btn_del",toolTip:t("menu.delColBtn"),data:{menuType:"icon",event:"menuLaneDelCol",type:"laneDelCol"}},{img:"fmd_btn_add",toolTip:t("menu.addColBtn"),data:{menuType:"icon",event:"menuLaneAddCol",type:"laneAddCol"}},{img:"fmd_btn_remove",toolTip:t("menu.delBtn"),data:{menuType:"icon",event:"menuLaneDel",type:"laneDel"}},{img:"fmd_btn_edit",toolTip:t("menu.renameBtn"),data:{menuType:"icon",event:"menuLaneRename",type:"laneRename"}}]},positionMap:["left","right","top","bottom"]}},Wa=function(){function t(e){var i=e.type,n=e.box,o=e.network;di(this,t),gi(this,"_isActive",!1),this.type=i,this.box=n,this.network=o;var r=w(),a=Ha(r),s=a.menuType,l=a.styles,h=s[i]||[],c="".concat(i,"BaseFollowerBtnLayer"),u="".concat(i,"FollowerBtnLayer");"lane"!==i&&(this._baseLayer=new twaver.Layer(c),n.getLayerBox().add(this._baseLayer),this._bgFollower=new Ba({image:"fmd_btn_bg_item",layerId:c,styles:l,visible:!1,movable:!1}),n.add(this._bgFollower)),this._layer=new twaver.Layer(u),n.getLayerBox().add(this._layer),this.menuItems=h.map(function(t){var e=t.data,i=ci(t,["data"]),o=new Ba(hi({image:t.img||"fmd_btn_item",layerId:u,styles:l,visible:!1,movable:!1},i),e);return n.add(o),o}),"lane"!==i&&this.menuItems.unshift(this._bgFollower)}return pi(t,[{key:"setActive",value:function(t,e){var i=this,n=w();if((e!==this._isActive||e)&&(this._isActive=e,this.menuItems.forEach(function(t){t.setVisible(!1)}),e)){var o=t.getClient("type"),r="node"===this.type?this.menuItems.filter(function(t){return"startItem"===o?"nodeDel"!==t.getClient("type"):"endItem"!==o||!["nodeDel","nodeAdd","linkAdd"].includes(t.getClient("type"))}):this.menuItems,a=Ha(n),s=a.positionMap;this._btnCount=r.length-1,r.forEach(function(e,n){e.bindHost(t),"lane"!==i.type?i.setNodeCenterLocation(e,t,s[n-1]):i.setIconNodeCenterLocation(e,t,n),e.setVisible(!0)})}}},{key:"generateNodeCenterLocation",value:function(t,e){var i=e.getCenterLocation(this.network),n=i.x,o=i.y;if(!t)return{x:n,y:o};var r=tn.circle.r+tn.clickBtn.r,a=3===this._btnCount?tn.clickBtn.r/2:0;switch(t){case"left":return{x:n-r,y:o+a};case"right":return{x:n+r,y:o+a};case"top":return{x:n,y:o-r};case"bottom":return{x:n,y:o+r};default:return{x:n,y:o}}}},{key:"setNodeCenterLocation",value:function(t,e,i){var n=this.generateNodeCenterLocation(i,e);t.setCenterLocation(n)}},{key:"setIconNodeCenterLocation",value:function(t,e,i){var n=e.getClient("col"),o=e.getLocation().x+en.repulsion.column*n-22*i-16;t.setCenterLocation({x:o,y:17})}}]),t}(),Ga={state:{nodeMenu:null,linkMenu:null,laneMenu:null,infoMenu:null},mutations:{setNodeMenu:function(t,e){t.nodeMenu=e},setLinkMenu:function(t,e){t.linkMenu=e},setLaneMenu:function(t,e){t.laneMenu=e},setInfoMenu:function(t,e){t.infoMenu=e}},actions:{initMenu:function(t){var e=t.rootState,i=t.commit,n=e.network,o=e.box,r=new Wa({type:"node",network:n,box:o}),a=new Wa({type:"link",network:n,box:o}),s=new Wa({type:"lane",network:n,box:o});i("setNodeMenu",r),i("setLinkMenu",a),i("setLaneMenu",s)},infoMenuClick:function(t,e){var i=t.rootState,n=e instanceof Ia,o=i.network;if(!n)return void Nn.$emit(Bn.SHOW_INFO_MENU,{isShow:!1});var r=e.getClient("flowedInfo");if(!r)return Nn.$emit(Bn.ELEMENT_EDIT,e,"node"),void Nn.$emit(Bn.SHOW_INFO_MENU,{isShow:!1});var a=o.getView().getBoundingClientRect(),s=a.top,l=a.left,h=o.viewRect,c=h.x,u=h.y,d="midstItem"===e.getClient("type"),f=d?tn.rect.h+5:tn.circle.h+5,p=o.getPosition("topleft.topright",e,{width:0,height:0},l-c,s-u+f);Nn.$emit(Bn.SHOW_INFO_MENU,{isShow:!0,node:e,flowedInfo:r,location:p})},menuClick:function(t,e){var i=t.dispatch,n=t.rootState,o=w();if(e instanceof Ba){var r=e.getClient("event"),a=e.getBindHost();switch(r){case"menuNodeDel":p({msg:"".concat(o("menu.confirmDel1"),"【").concat(a.getName(),"】").concat(o("menu.confirmDel2"))}).then(function(){i("node/removeNode",a,{root:!0})});break;case"menuNodeAdd":i("node/addNode",a,{root:!0});break;case"menu_linkAdd":i("link/linkFromNode",a,{root:!0});break;case"menuLaneRename":case"menuLinkRename":a.showLabelInput(n.network);break;case"menuLinkDel":var s=a.getName()?"【".concat(a.getName(),"】"):o("menu.the");p({msg:"".concat(o("menu.confirmDel1")).concat(s).concat(o("menu.confirmDel3"))}).then(function(){i("link/delLink",a,{root:!0}),n.box.remove(a)});break;case"menuLaneDel":var l=a.getName()?"【".concat(a.getName(),"】"):o("menu.the");p({msg:"".concat(o("menu.confirmDel1")).concat(l).concat(o("menu.confirmDel4"))}).then(function(){i("lane/removeLane",a,{root:!0})});break;case"menuLaneAddCol":i("lane/addCol",a,{root:!0});break;case"menuLaneDelCol":i("lane/delCol",a,{root:!0});break;case"menuNodeEdit":Nn.$emit(Bn.ELEMENT_EDIT,a,"node");break;case"menuLinkEdit":Nn.$emit(Bn.ELEMENT_EDIT,a,"link")}}}}},Za={topbottom:function(t,e,i,n,o){return{x:o.x+i,y:o.y-e+n}},bottomtop:function(t,e,i,n,o){return{x:o.x+i,y:o.y+e+n}},leftright:function(t,e,i,n,o){return{x:o.x-t+i,y:o.y+n}},rightleft:function(t,e,i,n,o){return{x:o.x+t+i,y:o.y+n}},center:function(t,e,i,n,o){return{x:o.x,y:o.y}}},Xa={state:{flowdTaches:null,flowdPaths:null,flowedPathInfo:null,timers:[],point:null,animates:null,nowPlayIndex:0},mutations:{setflowdTaches:function(t,e){t.flowdTaches=e},setflowdflowdPaths:function(t,e){t.flowdPaths=e},setFlowedPathInfo:function(t,e){t.flowedPathInfo=e},setTimers:function(t,e){t.timers=e},setPoint:function(t,e){t.point=e},setAnimates:function(t,e){t.animates=e},setNowPlayIndex:function(t,e){t.nowPlayIndex=e}},actions:{createPoint:function(t){var e=t.commit,i=t.rootState,n=new twaver.Layer("pointLayer");i.box.getLayerBox().add(n);var o=new twaver.Node({image:"fmd_point",layerId:"pointLayer",visible:!1});i.box.add(o),e("setPoint",o)},initFlowed:function(t,e){var i=t.dispatch,n=t.commit,o=t.state,r=e.taches,a=e.paths;n("setflowdTaches",r),n("setflowdflowdPaths",a),n("setFlowedPathInfo",[]),o.point||i("createPoint"),r&&r.length&&i("nodeFlowed",r),a&&a.length&&i("linkFlowed",a)},nodeFlowed:function(t,e){var i=t.rootState;e.forEach(function(t){var e=t.tchMod,n=i.box.getDataById(e);if(n){n.setClient("flowed",!0);var o=n.getClient("flowedInfo")||[];o.push(t),n.setClient("flowedInfo",o),"A"!==n.state&&(n.state=t.state,n.setStyle("label.color",Ji.active)),"A"===t.state&&(n.setStyle("label.color",Ji.background),n.setClient("nowFlow",!0))}})},linkFlowed:function(t,e){var i=t.rootState,n=t.dispatch,o=t.state,r=i.box;_i(e).reverse().forEach(function(t,i){var o,a=t.tchMod,s=t.nextTchMod,l=t.pathType,h="".concat(a,"-").concat(s);if(o=r.getDataById(h),"1"===l?(o.flowed=!0,o.setFLowed()):"2"!==l||o||(o=n("createReturnLink",t)),o){var c=o.getName()||"";o.setName("[".concat(e.length-i,"] ").concat(c))}n("setLinkFlowedPoint",o)}),o.flowedPathInfo.reverse(),n("createAnimate")},createReturnLink:function(t,e){var i=t.rootState,n=t.dispatch,o=e.tchMod,r=e.nextTchMod;return n("link/createLink",{fromNode:i.box.getDataById(o),toNode:i.box.getDataById(r),type:"recall",id:"".concat(o,"-").concat(r)},{root:!0})},setLinkFlowedPoint:function(t,e){var i,n=t.state,o=[],r=Tn()(e.getPoints());o.push(wi("to",e)),r&&r._as.length&&o.push.apply(o,_i(r._as.reverse())),o.push(wi("from",e)),(i=n.flowedPathInfo).push.apply(i,o)},play:function(t){var e=t.state,i=e.flowedPathInfo,n=e.point,o=e.animates,r=e.nowPlayIndex;n&&i&&i.length&&o&&o.length&&(n.setCenterLocation(i[r]),n.setVisible(!0),o[r].play())},createAnimate:function(t){var e=t.state,i=t.commit;e.animate&&e.animate.stop();for(var n=e.point,o=e.flowedPathInfo,r=[],a=0;a<o.length-1;a++){var s=new twaver.Animate({source:n,from:o[a],to:o[a+1],type:"point",attr:"centerLocation",onDone:function(){var t=e.nowPlayIndex;t<e.animates.length-1?(i("setNowPlayIndex",t+1),e.animates[t+1].play()):Nn.$emit(Bn.STOP_PLAY)}});r.push(s)}i("setAnimates",r)},stop:function(t){var e=t.state,i=t.commit;e.animates[e.nowPlayIndex].stop(),e.point.setVisible(!1),i("setNowPlayIndex",0)}}},Ya={state:{errorStack:[],data:{pathModels:[],tacheModels:[],tacheModelGroupRels:[],tacheModelGroups:[]}},mutations:{setErrorStack:function(t,e){t.errorStack=e},clear:function(t){t.errorStack=[],t.data={pathModels:[],tacheModels:[],tacheModelGroupRels:[],tacheModelGroups:[]}}},actions:{shipment:function(t,e){var i=t.rootState,n=t.commit,o=t.dispatch,r=t.state,a=e.valid,s=w();n("clear");for(var l=i.box._dataList._as,h=0;h<l.length;h++){var c=l[h];c instanceof Ra&&o("setLinksData",{valid:a,link:c}),c instanceof Ia&&o("setNodesData",{valid:a,node:c}),c instanceof Oa&&o("setLanesData",{valid:a,lane:c})}r.data.tacheModels.length<3&&r.errorStack.push(s("tacheModel.validateTaches"));var u=r.data,d=u.tacheModelGroups,f=u.tacheModelGroupRels;if(d.forEach(function(t){if(!f.find(function(e){return e.groupId===t.groupId})){var e=t.groupSS,i=e.start,n=e.end,o=t.name?"【".concat(t.name,"】"):"【".concat(i,"-").concat(n,"】").concat(s("tacheModel.validateGroups_1"));r.errorStack.push("".concat(o).concat(s("tacheModel.validateGroups_2")))}}),r.errorStack&&r.errorStack.length){return{code:1,msg:r.errorStack.map(function(t,e){return"".concat(e+1,"、").concat(t,";")}).join("\n")}}return{code:0,data:r.data}},setLinksData:function(t,e){var i=t.state,n=e.valid,o=e.link,r=w(),a=Tn()(o.getClient("data"));if(n){var s=a.pathName;m(s)>48&&i.errorStack.push("【".concat(s,"】").concat(r("paths.nameLength")))}i.data.pathModels.push(a)},setNodesData:function(t,e){var i=t.state,n=e.valid,o=e.node,r=w(),a=Tn()(o.getClient("data"));if(n){var s=o.realName,l=!!o.getFromLinks()&&!!o.getFromLinks()._as.length,h=!!o.getToLinks()&&!!o.getToLinks()._as.length,c=a.canReturn,u=!!o.getFromLinks()&&Tt(o,"".concat(a.tchMod));l||h||i.errorStack.push("【".concat(s,"】").concat(r("tacheModel.aloneTache"))),h&&!l&&"endItem"!==o.type&&"0BT"!==c&&i.errorStack.push("【".concat(s,"】").concat(r("tacheModel.aloneTache"))),h||!l||"startItem"===o.type||u||i.errorStack.push("【".concat(s,"】").concat(r("tacheModel.aloneTache")))}return a.tacheSS=ht(o.getCenterLocation()),a.tacheForm.fieldRights=a.tacheForm.fieldRights.map(function(t){t.infoBlock,t.id,t.pid,t.xtype;return bi(t,["infoBlock","id","pid","xtype"])}),i.data.tacheModels.push(a),!1},setLanesData:function(t,e){var i,n=t.state,o=t.rootState,r=e.valid,a=e.lane,s=w(),l=Tn()(a.getClient("data")),h=a.getClient("start"),c=a.getClient("end"),u=a.realName,d=l.groupId,f=o.node.nodeMap;l.groupSS={start:h,end:c},r&&(u||n.errorStack.push("【".concat(h,"-").concat(c,"】").concat(s("tacheModel.validateGroups_3"))));var p=[];return f.slice(h,c).forEach(function(t){t&&t.forEach(function(t){t&&p.push({groupId:d,tchMod:t.getClient("data").tchMod})})}),n.data.tacheModelGroups.push(l),(i=n.data.tacheModelGroupRels).push.apply(i,p),!1}}},$a=function(){function t(e,i,n){Ai(this,t),ki(this,"state",{link:za.state,node:ja.state,menu:Ga.state,lane:Va.state,flowed:Xa.state,data:Ya.state,clickSelected:null,fitColumns:0,flowMod:0}),ki(this,"mutations",{link:za.mutations,node:ja.mutations,menu:Ga.mutations,lane:Va.mutations,data:Ya.mutations,flowed:Xa.mutations,setClickSelected:function(t,e){t.clickSelected=e},setFitColumns:function(t,e){t.fitColumns=e},setFlowMod:function(t,e){t.flowMod=e}}),ki(this,"actions",{link:za.actions,node:ja.actions,menu:Ga.actions,lane:Va.actions,data:Ya.actions,flowed:Xa.actions,setClickSelected:function(t,e){var i=t.commit,n=t.rootState.network;i("setClickSelected",e?{target:e,centerLocation:e.getCenterLocation(n)}:e)},clear:function(t){var e=t.commit;e("lane/setLaneMap",[],{root:!0}),e("node/setNodeMap",[],{root:!0})}}),this.state.network=e,this.state.box=i,this.state.editable=n,this.commit("setFitColumns",gt(e.viewRect))}return Ti(t,[{key:"_commit",value:function(t,e,i,n){var o=t.split("/"),r=o.reduce(function(t,e){return t[e]},i);o.pop(),r(n,e)}},{key:"_dispatch",value:function(t,e,i,n,o){var r=this,a=t.split("/"),s=a.reduce(function(t,e){return t[e]},n);a.pop();var l=this.mutations,h=a.reduce(function(t,e){return t[e]},i),c=this.actions,u=a.reduce(function(t,e){return t[e]},n),d=function(t,e){if(e.root){var i=t.split("/");return i.pop(),i.reduce(function(t,e){return t[e]},r.state)}return o};return s({rootState:this.state,state:o,dispatch:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return r._dispatch(t,e,i.root?l:h,i.root?c:u,d(t,i))},commit:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return r._commit(t,e,i.root?l:h,d(t,i))}},e)}},{key:"commit",value:function(t,e){var i=t.split("/");i.pop();var n=i.reduce(function(t,e){return t[e]},this.state);this._commit(t,e,this.mutations,n)}},{key:"dispatch",value:function(t,e){var i=t.split("/");i.pop();var n=i.reduce(function(t,e){return t[e]},this.state);return this._dispatch(t,e,this.mutations,this.actions,n)}}]),t}(),qa=function(t){function e(t){var i,n=t.container,o=t.toolbar,r=t.editable,a=void 0!==r&&r;zi(this,e),i=ji(this,Hi(e).call(this)),i.container=nt(n),i.toolbar=nt(o),i.editable=a,i.box=new twaver.ElementBox,i.network=new xa(i.container,i.box,a);var s=Wi(i),l=s.network,h=s.box;return i.$eventHandler=new $a(l,h,a),h.getSelectionModel().setSelectionMode("singleSelection"),i._initEvent(),i}return Gi(e,t),Ui(e,[{key:"createNode",value:function(t){var e,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"ModeNode";return"ModeNode"===i?e=new Ia(t):"LaneNode"===i&&(e=new Oa(t)),this.box.add(e),e}},{key:"createLink",value:function(t){var e=t.fromNode,i=t.toNode,n=rt(e,i,this.$eventHandler.state.node.nodeMap),o=n.position,r=n.style,a=n.point,s=new Ra(t,o);return Object.keys(r).forEach(function(t){s.setStyle(t,r[t])}),a.forEach(function(t){s.addPoint(t)}),this.box.add(s),s}},{key:"render",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=i.advancedProperties,o=n.processorNotifyCfg,r=n.circularNotifyCfg;this.clear(),this.$eventHandler.commit("setFlowMod",t.flowMod),this.$eventHandler.dispatch("node/initProcessorNotifyCfg",o),this.$eventHandler.dispatch("node/initCircularNotifyCfg",r),this._processingInitData(t),e&&this.$eventHandler.dispatch("flowed/initFlowed",e)}},{key:"_processingInitData",value:function(){function t(t){return e.apply(this,arguments)}var e=Fi(Xn.a.mark(function t(e){var i,n,o,r,a,s,l,h,c;return Xn.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(i=e.linkList,n=e.laneList,o=e.formModel,r=e.nodeList,r.length){t.next=12;break}return a={col:0,row:0},t.next=6,this.getEmptyNodeOption("startItem",a,e.flowMod);case 6:return s=t.sent,l={col:gt(this.network.viewRect)-1,row:0},t.next=10,this.getEmptyNodeOption("endItem",l,e.flowMod);case 10:h=t.sent,r=[s,h];case 12:c=r.map(function(t){return t.data.data}),this._processingFormModel(o,c),this._processingInitLaneData(n),this._processingInitNodeData(r,o),this._processingInitLinkData(i);case 17:case"end":return t.stop()}},t,this)}));return t}()},{key:"_processingFormModel",value:function(t,e){if(!t||!t.elementConfig||!t.elementConfig.length)return void e.forEach(function(t){t.tacheForm.fieldRights=[]});var i=t.elementConfig,n=t.elementConfig.reduce(function(t,e){var n=e.xtype,o=e.pid;if("21"===n||"22"===n){var r=e.formElementAttrs.ELEMENT_NAME.value,a=e.formElementAttrs.ELEMENT_NAME_CN.value,s=i.filter(function(t){return t.formElementAttrs.ELEMENT_NAME.value===o});t[r]=s.length>0?s[0].formElementAttrs.ELEMENT_NAME_CN.value:a}return t},{}),o=[];i.forEach(function(t){var e=t.fieldName||t.formElementAttrs.ELEMENT_NAME.value,i=t.formElementAttrs,r=void 0===i?{}:i,a=t.tableName,s=t.tableFieldId,l=t.pid,h=t.xtype,c=(r.ELEMENT_NAME_CN||{}).value,u=(r.ELEMENT_NAME_US||{}).value,d=(r.ELEMENT_NAME||{}).value;o.push({infoBlock:l?n[l]:c,id:d,pid:l,xtype:h,fieldName:e,fieldNameCn:c,fieldNameUs:u,tableName:a,tableFieldId:s,isAppend:"F",isReadonly:"F",isRequire:r.IS_EMPTY?"T"===r.IS_EMPTY.value?"F":"T":"F",isShow:"T"})}),e.forEach(function(t){var e=t.tacheForm?t.tacheForm.fieldRights:[];o.forEach(function(i){i.isReadonly="3"===t.tchType?"T":"F";var n=e.find(function(t){return t.fieldName===i.fieldName});if(n){var o=n.isAppend,r=n.isReadonly,a=n.isRequire,s=n.isShow;Object.assign(i,{isAppend:o,isReadonly:r,isRequire:a,isShow:s})}}),t.tacheForm.fieldRights=o.map(function(t){return Mi({},t)})}),this.$eventHandler.dispatch("node/initFieldRights",o.map(function(t){return Mi({},t)}))}},{key:"updateFormModel",value:function(t){var e=[],i=xt(t),n=At(t);this.box.forEach(function(t){t instanceof Ia&&(t.setClient("tableOptions",i),t.setClient("tableFields",n),e.push(t.getClient("data")))}),this._processingFormModel(t,e)}},{key:"_processingInitNodeData",value:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.editable?xt(i):[],o=At(i),r=Math.max.apply(Math,Li(t.map(function(t){return t.index.col}))),a=Li(Array.from({length:r},function(){return[]}));t&&t.length?t.forEach(function(t){var i=t.index,r=i.col,s=i.row,l=Ei(t,["index"]);l.data.tableOptions=n,l.data.tableFields=o;var h=e.createNode(l);e.addCanReturnRelationNodes(l.data.data),e.setIsDefaultTacheExecStaff(h),a[+r]||(a[+r]=[]),a[+r][+s]=h}):this._initModelDraw(),this.$eventHandler.commit("node/setNodeMap",a),this.$eventHandler.dispatch("lane/resizeLaneHeight",a)}},{key:"addCanReturnRelationNodes",value:function(t){var e=t.canReturn,i=t.canReturnTaches,n=t.tchMod;if("0BT"===e&&i){i.split(",").forEach(function(t){var e={pid:"".concat(n),id:"".concat(t)};qn.addNode(e)})}}},{key:"setIsDefaultTacheExecStaff",value:function(t){function e(e){if(r)r&&!r.backCfg?i.advancedProperties.backCfg={isDefaultTacheExecStaff:e}:r&&r.backCfg&&(i.advancedProperties.backCfg.isDefaultTacheExecStaff=i.advancedProperties.backCfg.isDefaultTacheExecStaff);else{var n={backCfg:{isDefaultTacheExecStaff:e}};i.advancedProperties=n}t.setClient("data",i)}var i=t.getClient("data"),n=i.canReturn,o=i.canReturnTaches,r=i.advancedProperties;e(!("0BT"!==n||!o))}},{key:"_initModelDraw",value:function(){}},{key:"_processingInitLaneData",value:function(t){var e=this,i=[];t&&t.forEach(function(t){var n=e.createNode(t,"LaneNode");i.push(n)}),this.$eventHandler.dispatch("lane/updateLaneMap",i)}},{key:"_processingInitLinkData",value:function(){var t=this;(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).forEach(function(e){var i=e.fromNode,n=e.toNode,o=t.box.getDataById(i),r=t.box.getDataById(n),a={pid:"".concat(e.fromNode),id:"".concat(e.toNode)};qn.addNode(a),t.createLink(Object.assign(e,{fromNode:o,toNode:r}))})}},{key:"clear",value:function(){var t=this;console.log(this.data,"clear"),this._hideMenu(),this.$eventHandler.dispatch("clear");var e=[];this.box.forEach(function(t){(t instanceof Oa||t instanceof Ia||t instanceof Ra)&&e.push(t)}),e.forEach(function(e){t.box.remove(e)}),this.refreshUI()}},{key:"getEmptyNodeOption",value:function(){function t(){return e.apply(this,arguments)}var e=Fi(Xn.a.mark(function t(){var e,i,n,o,r,a,s,l,h,c=arguments;return Xn.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=c.length>0&&void 0!==c[0]?c[0]:"midstItem",i=c.length>1?c[1]:void 0,n=c.length>2?c[2]:void 0,o=w(),t.next=6,T();case 6:return r=t.sent,a=ka.node(n,r,{},{},o),s=ya[e],l={midstItem:o("tacheModel.midstNode"),startItem:o("tacheModel.startNode"),endItem:o("tacheModel.endNode")}[e],a.tchType=s,a.tchName=l,h=lt(i),t.abrupt("return",{name:l,type:e,data:{data:a,type:e},centerLocation:h,index:i});case 14:case"end":return t.stop()}},t)}));return t}()},{key:"shipment",value:function(t,e){return this.$eventHandler.dispatch("data/shipment",{valid:t,isBreak:e})}},{key:"play",value:function(){this.$eventHandler.dispatch("flowed/play")}},{key:"stop",value:function(){this.$eventHandler.dispatch("flowed/stop")}},{key:"refreshUI",value:function(){this.network.invalidate()}}]),e}(Fa),Ka=qa,Ja={methods:{processing:function(t,e){var i=t||{},n=i.tacheModels,o=i.pathModels,r=i.tacheModelGroups,a=i.flowModel,s=i.formModel,l=a.flowMod;return{flowMod:void 0===l?0:l,linkList:this.processingLinkData(o||[]),nodeList:this.processingNodeData(n||[],a,e),laneList:this.processingLaneData(r||[]),formModel:s}},processingLinkData:function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).map(function(t){var e=t.tchMod,i=t.nextTchMod,n=t.pathType,o=wa[n];return{id:"".concat(e,"-").concat(i),name:t.pathName,type:o,fromNode:e,toNode:i,data:{data:t,type:o}}})},processingNodeData:function(){function t(t){var e=t.tchType,i=t.tacheSS,o=t.tchMod,r=t.tchName,h=ya[e],c=lt(i,n);return t.tacheForm||(t.tacheForm={fieldRights:[],formAction:""}),!t.advancedProperties||!t.advancedProperties.winStyle||t.advancedProperties.winStyle.fullScreen||t.advancedProperties.winStyle.height||t.advancedProperties.winStyle.width||(t.advancedProperties.winStyle=null),t.advancedProperties&&t.advancedProperties.processorNotifyCfg&&t.advancedProperties.processorNotifyCfg.mail&&t.advancedProperties.processorNotifyCfg.mail.display&&(t.advancedProperties.processorNotifyCfg.mail.display=a.mail.display),t.advancedProperties&&t.advancedProperties.processorNotifyCfg&&t.advancedProperties.processorNotifyCfg.mail&&t.advancedProperties.processorNotifyCfg.mail.canChange&&(t.advancedProperties.processorNotifyCfg.mail.canChange=a.mail.canChange),t.advancedProperties&&t.advancedProperties.processorNotifyCfg&&t.advancedProperties.processorNotifyCfg.sms&&t.advancedProperties.processorNotifyCfg.sms.display&&(t.advancedProperties.processorNotifyCfg.mail.display=a.mail.display),t.advancedProperties&&t.advancedProperties.processorNotifyCfg&&t.advancedProperties.processorNotifyCfg.sms&&t.advancedProperties.processorNotifyCfg.sms.canChange&&(t.advancedProperties.processorNotifyCfg.sms.canChange=a.sms.canChange),t.advancedProperties&&t.advancedProperties.circularNotifyCfg&&t.advancedProperties.circularNotifyCfg.mail&&t.advancedProperties.circularNotifyCfg.mail.display&&(t.advancedProperties.circularNotifyCfg.mail.display=s.mail.display),t.advancedProperties&&t.advancedProperties.circularNotifyCfg&&t.advancedProperties.circularNotifyCfg.mail&&t.advancedProperties.circularNotifyCfg.mail.canChange&&(t.advancedProperties.circularNotifyCfg.mail.canChange=s.mail.canChange),t.advancedProperties&&t.advancedProperties.circularNotifyCfg&&t.advancedProperties.circularNotifyCfg.sms&&t.advancedProperties.circularNotifyCfg.sms.display&&(t.advancedProperties.circularNotifyCfg.mail.display=s.mail.display),t.advancedProperties&&t.advancedProperties.circularNotifyCfg&&t.advancedProperties.circularNotifyCfg.sms&&t.advancedProperties.circularNotifyCfg.sms.canChange&&(t.advancedProperties.circularNotifyCfg.sms.canChange=s.sms.canChange),t.flowMode&&"string"==typeof t.flowMode&&(t.flowMode=[t.flowMode]),{id:o,name:"en"===l?t.tchNameUs:r,type:h,data:{data:t,type:h},centerLocation:c,index:i}}var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,o=i.version,r=i.advancedProperties,a=r.processorNotifyCfg,s=r.circularNotifyCfg,l=this.$i18n&&this.$i18n.locale;if("1"!==o){var h=gt({width:this.$el.querySelector(".fmd-flow-model__content").offsetWidth}),c=e.filter(function(t){return["1","2"].includes(t.tchType)}),u=e.filter(function(t){return!["1","2"].includes(t.tchType)}),d=c.map(function(e){return"1"===e.tchType?e.tacheSS={col:0,row:0}:e.tacheSS={col:h-1,row:0},t(e)}),f=u.map(function(e,i){var n=~~(i/(h-2));return e.tacheSS={col:i-(h-2)*n+1,row:n},t(e)});return[].concat(Xi(d),Xi(f))}return e.map(t)},processingLaneData:function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).map(function(t){var e=t.groupSS,i=t.groupName,n=t.groupId,o=e.start,r=e.end,a=+r-+o;return{id:n,name:i,location:ft(o),type:"laneItem",data:{type:"laneItem",col:a,start:o,end:r,data:t}}})}}},Qa=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"model-info-menu"},[t.data.length?i("div",{staticClass:"model-info-menu__row model-info-menu__header"},[i("div",{staticClass:"model-info-menu__header__title"},[t._v("\n      "+t._s(t.data[0].tchName)+"\n    ")]),i("div",{staticClass:"model-info-menu__header__action",on:{click:t.onClick}},[t._v("\n      "+t._s(t.t("process.linkAttrbutes"))+"\n    ")])]):t._e(),t._l(t.data,function(e,n){return i("div",{key:n},[i("div",{staticClass:"model-info-menu__row model-info-menu__legend"},[i("div",{staticClass:"model-info-menu__legend__icon",class:e.state}),i("div",{staticClass:"model-info-menu__legend__label"},[t._v(" "+t._s(t.statusMap[e.state]))])]),i("div",{staticClass:"model-info-menu__row model-info-menu__time"},[t._v("\n      "+t._s(e.finishDate||e.createdDate)+"\n    ")]),i("div",{staticClass:"model-info-menu__row model-info-menu__info"},[t._v("\n      "+t._s(e.flowStaff?e.flowStaff.map(function(t){return(t||{}).staffName}).join(","):"")+" "+t._s(e.resultDesc?"：":"")+" "+t._s(e.resultDesc)+"\n    ")])])})],2)},ts=[],es={name:"fmd-info-menu",props:{data:Array,default:function(){return[]},node:Object},mixins:[bn.localeMixin],data:function(){return{statusMap:{A:this.t("process.created"),E:this.t("process.executed"),L:this.t("process.withdrawn"),C:this.t("process.executing"),F:this.t("process.completed")}}},methods:{onClick:function(){Nn.$emit(Bn.ELEMENT_EDIT,this.node,"node")}}},is=es,ns=(i("1d14"),B(is,Qa,ts,!1,null,null,null)),os=ns.exports,rs=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"fmd-legend"},t._l(t.options,function(e){return i("div",{key:e.class,staticClass:"fmd-legend__item",class:e.class},[t._v("\n    "+t._s(e.label)+"\n  ")])}),0)},as=[],ss={name:"fmd-legend",mixins:[bn.localeMixin],props:{editable:{type:Boolean}},data:function(){return{}},computed:{options:function(){return this.editable?[{class:"multiple",label:this.t("process.multiInstanceLink")},{class:"virtual",label:this.t("process.virtualLink")}]:[{class:"multiple",label:this.t("process.multiInstanceLink")},{class:"current",label:this.t("process.currentLink")},{class:"flowed",label:this.t("process.flowedLink")},{class:"beFlow",label:this.t("process.beFlowLink")},{class:"virtual",label:this.t("process.virtualLink")},{class:"flowed-link",label:this.t("process.completedLink")},{class:"beFlow-link",label:this.t("process.unCompleteLink")},{class:"recall-link",label:this.t("process.returnLink")}]}}},ls=ss,hs=(i("a77d"),B(ls,rs,as,!1,null,"bd9fee78",null)),cs=hs.exports,us={name:"FmdFlowModel",mixins:[Ja,bn.localeMixin],components:{FmdLegend:cs,FmdInfoMenu:os,FmdToolbar:Hn,FmdEditorNode:ca,FmdEditorLink:_a},inject:{fiWorkflow:{default:""}},props:{data:{type:Object},flowMod:{type:[Number,String]},flowId:{type:[Number,String]},editable:{type:Boolean,default:!1},flowCenter:{type:Boolean},prevLabel:String,nextLabel:String,relationFlows:Array,toolOptions:{type:[Object,Array],default:null}},data:function(){return{painter:null,editorDialog:!1,selectedElement:{},selectedType:"",fetchData:null,proc:null,isPlay:!1,infoMenuDate:[],infoMenuLocation:{x:0,y:0},infoMenuShow:!1,infoMenuNode:null}},computed:{flowParams:function(){if(this.flowMod||this.flowId)return{flowMod:this.flowMod,flowId:this.flowId};if(this.fiWorkflow){var t=this.fiWorkflow.flowContext.flow.flowMod;return{flowMod:t.flowMod,flowId:t.flowId}}var e=_(window.location.search);return{flowMod:e.flowMod,flowId:e.flowId}},preText:function(){return this.prevLabel||this.t("flowModel.prevLabel")},nextText:function(){return this.nextLabel||this.t("flowModel.nextLabel")}},watch:{flowParams:function(t){var e=this;this.flowCenter||S(t).then(function(t){e.fetchData=t.flowFormModel,e.proc=t.flow,e.render()})},data:function(){this.flowCenter&&this.render()}},created:function(){Nn.$on(Bn.ELEMENT_EDIT,this.elementSelected),Nn.$on(Bn.SHOW_INFO_MENU,this.showInfoMenu),Nn.$on(Bn.STOP_PLAY,this.play),y(this.t),d(this.$i18n&&this.$i18n.locale)},mounted:function(){var t=this,e=this.$el.querySelector(".fmd-flow-model__content"),i=this.$el.querySelector(".fmd-toolbar"),n=this.editable;this.painter=new Ka({container:e,toolbar:i,editable:n&&this.flowCenter}),this.flowCenter?this.render():I(this.flowParams).then(function(e){t.fetchData=e.flowFormModel,t.proc=e.flow,t.render()})},beforeDestroy:function(){Nn.$off(Bn.ELEMENT_EDIT,this.elementSelected),Nn.$off(Bn.SHOW_INFO_MENU,this.showInfoMenu),Nn.$off(Bn.TOOLBAR_CLICK),Nn.$off(Bn.STOP_PLAY,this.play)},methods:{getData:function(){return this.flowCenter?Tn()(this.data):Tn()(this.fetchData)},setNodes:function(t){var e=t.map(function(t){return{tchMod:t.tchMod,tchName:t.tchName,tchNameUs:t.tchNameUs}});En.setNodes(e)},render:function(){var t=this.getData();if(t){this.flowModel=t.flowModel,this.setNodes(t.tacheModels);var e=this.processing(t,this.proc);this.painter.render(e,this.proc,this.flowModel)}},updateFormModel:function(t){var e=t||this.data.formModel;this.painter.updateFormModel(e)},elementSelected:function(t,e){this.editorDialog=!0,this.selectedType=e,this.selectedElement=t},showInfoMenu:function(t){var e=t.node,i=t.location,n=t.isShow,o=t.flowedInfo;if(!n)return void(this.infoMenuShow=n);this.infoMenuDate=o,this.infoMenuNode=e;var r=this.$el.getBoundingClientRect(),a=this.$el,s=a.offsetTop,l=a.offsetLeft;this.infoMenuLocation={left:"".concat(i.x-r.left+l,"px"),top:"".concat(i.y-r.top+s,"px")},this.infoMenuShow=n},buttonClick:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=this.painter.shipment(e);e&&0!==i.code&&this.$message({type:"error",message:i.msg,duration:5e3,showClose:!0,customClass:"pre-line-message"}),this.$emit(t,i.data,0===i.code)},play:function(){this.isPlay?this.painter.stop():this.painter.play(),this.isPlay=!this.isPlay},onInfoSubmit:function(){this.painter.refreshUI()}}},ds=us,fs=(i("4034"),B(ds,xn,An,!1,null,"8eccbce0",null)),ps=fs.exports;ps.install=function(t){t.component(ps.name,ps)};var gs=ps,_s=function(){var t=i("4790"),e={};return t.keys().forEach(function(i){var n=i.match(/([A-Za-z0-9-_]+)\./i);if(n&&n.length>1){var o=n[1];e[o]=t(i).default}}),e}(),ms=[gs],vs={install:function(t){t.prototype.$busManage=new t}};bn.i18n4Lib.use({messages:_s,local:"zh-CN"});var ys=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};bn.i18n4Lib.use(e.i18n||{messages:_s,local:"zh-CN"});var i=e.baseUrl||"";On.defaults.baseURL=i,ms.map(function(e){return t.component(e.name,e)}),t.use(vs)};"undefined"!=typeof window&&window.Vue&&ys(window.Vue);var ws={version:"1.5.4",install:ys,FlowModel:gs,StaffSelect:vo};e.default=ws},fcc2:function(t,e,i){"use strict";var n=i("d49e"),o=i.n(n);o.a},fdd3:function(t,e,i){},ff02:function(t,e,i){"use strict";var n=i("32b1"),o=i.n(n);o.a}}).default},bbc0:function(t,e,i){function n(t){var e=this.__data__;if(o){var i=e[t];return i===r?void 0:i}return s.call(e,t)?e[t]:void 0}var o=i("6044"),r="__lodash_hash_undefined__",a=Object.prototype,s=a.hasOwnProperty;t.exports=n},bc3a:function(t,e,i){t.exports=i("cee4")},c098:function(t,e){function i(t,e){var i=typeof t;return!!(e=null==e?n:e)&&("number"==i||"symbol"!=i&&o.test(t))&&t>-1&&t%1==0&&t<e}var n=9007199254740991,o=/^(?:0|[1-9]\d*)$/;t.exports=i},c2b6:function(t,e,i){function n(t,e,i){var n=t.constructor;switch(e){case m:return o(t);case h:case c:return new n(+t);case v:return r(t,i);case y:case w:case b:case x:case A:case C:case T:case k:case S:return l(t,i);case u:return new n;case d:case g:return new n(t);case f:return a(t);case p:return new n;case _:return s(t)}}var o=i("f8af"),r=i("5d89"),a=i("6f6c"),s=i("a2db"),l=i("c8fe"),h="[object Boolean]",c="[object Date]",u="[object Map]",d="[object Number]",f="[object RegExp]",p="[object Set]",g="[object String]",_="[object Symbol]",m="[object ArrayBuffer]",v="[object DataView]",y="[object Float32Array]",w="[object Float64Array]",b="[object Int8Array]",x="[object Int16Array]",A="[object Int32Array]",C="[object Uint8Array]",T="[object Uint8ClampedArray]",k="[object Uint16Array]",S="[object Uint32Array]";t.exports=n},c345:function(t,e,i){"use strict";var n=i("c532"),o=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];t.exports=function(t){var e,i,r,a={};return t?(n.forEach(t.split("\n"),function(t){if(r=t.indexOf(":"),e=n.trim(t.substr(0,r)).toLowerCase(),i=n.trim(t.substr(r+1)),e){if(a[e]&&o.indexOf(e)>=0)return;a[e]="set-cookie"===e?(a[e]?a[e]:[]).concat([i]):a[e]?a[e]+", "+i:i}}),a):a}},c3fc:function(t,e,i){function n(t){return r(t)&&o(t)==a}var o=i("42a2"),r=i("1310"),a="[object Set]";t.exports=n},c401:function(t,e,i){"use strict";var n=i("c532");t.exports=function(t,e,i){return n.forEach(i,function(i){t=i(t,e)}),t}},c532:function(t,e,i){"use strict";function n(t){return"[object Array]"===C.call(t)}function o(t){return"[object ArrayBuffer]"===C.call(t)}function r(t){return"undefined"!=typeof FormData&&t instanceof FormData}function a(t){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(t):t&&t.buffer&&t.buffer instanceof ArrayBuffer}function s(t){return"string"==typeof t}function l(t){return"number"==typeof t}function h(t){return void 0===t}function c(t){return null!==t&&"object"==typeof t}function u(t){return"[object Date]"===C.call(t)}function d(t){return"[object File]"===C.call(t)}function f(t){return"[object Blob]"===C.call(t)}function p(t){return"[object Function]"===C.call(t)}function g(t){return c(t)&&p(t.pipe)}function _(t){return"undefined"!=typeof URLSearchParams&&t instanceof URLSearchParams}function m(t){return t.replace(/^\s*/,"").replace(/\s*$/,"")}function v(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product)&&("undefined"!=typeof window&&"undefined"!=typeof document)}function y(t,e){if(null!==t&&void 0!==t)if("object"!=typeof t&&(t=[t]),n(t))for(var i=0,o=t.length;i<o;i++)e.call(null,t[i],i,t);else for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.call(null,t[r],r,t)}function w(){function t(t,i){"object"==typeof e[i]&&"object"==typeof t?e[i]=w(e[i],t):e[i]=t}for(var e={},i=0,n=arguments.length;i<n;i++)y(arguments[i],t);return e}function b(t,e,i){return y(e,function(e,n){t[n]=i&&"function"==typeof e?x(e,i):e}),t}var x=i("1d2b"),A=i("c7ce"),C=Object.prototype.toString;t.exports={isArray:n,isArrayBuffer:o,isBuffer:A,isFormData:r,isArrayBufferView:a,isString:s,isNumber:l,isObject:c,isUndefined:h,isDate:u,isFile:d,isBlob:f,isFunction:p,isStream:g,isURLSearchParams:_,isStandardBrowserEnv:v,forEach:y,merge:w,extend:b,trim:m}},c7ce:function(t,e){t.exports=function(t){return null!=t&&null!=t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}},c869:function(t,e,i){var n=i("0b07"),o=i("2b3e"),r=n(o,"Set");t.exports=r},c87c:function(t,e){function i(t){var e=t.length,i=new t.constructor(e);return e&&"string"==typeof t[0]&&o.call(t,"index")&&(i.index=t.index,i.input=t.input),i}var n=Object.prototype,o=n.hasOwnProperty;t.exports=i},c8af:function(t,e,i){"use strict";var n=i("c532");t.exports=function(t,e){n.forEach(t,function(i,n){n!==e&&n.toUpperCase()===e.toUpperCase()&&(t[e]=i,delete t[n])})}},c8ba:function(t,e){var i;i=function(){return this}();try{i=i||new Function("return this")()}catch(t){"object"==typeof window&&(i=window)}t.exports=i},c8fe:function(t,e,i){function n(t,e){var i=e?o(t.buffer):t.buffer;return new t.constructor(i,t.byteOffset,t.length)}var o=i("f8af");t.exports=n},cb5a:function(t,e,i){function n(t,e){for(var i=t.length;i--;)if(o(t[i][0],e))return i;return-1}var o=i("9638");t.exports=n},cc45:function(t,e,i){var n=i("1a2d"),o=i("b047"),r=i("99d3"),a=r&&r.isMap,s=a?o(a):n;t.exports=s},cee4:function(t,e,i){"use strict";function n(t){var e=new a(t),i=r(a.prototype.request,e);return o.extend(i,a.prototype,e),o.extend(i,e),i}var o=i("c532"),r=i("1d2b"),a=i("0a06"),s=i("2444"),l=n(s);l.Axios=a,l.create=function(t){return n(o.merge(s,t))},l.Cancel=i("7a77"),l.CancelToken=i("8df4"),l.isCancel=i("2e67"),l.all=function(t){return Promise.all(t)},l.spread=i("0df6"),t.exports=l,t.exports.default=l},d02c:function(t,e,i){function n(t,e){var i=this.__data__;if(i instanceof o){var n=i.__data__;if(!r||n.length<s-1)return n.push([t,e]),this.size=++i.size,this;i=this.__data__=new a(n)}return i.set(t,e),this.size=i.size,this}var o=i("5e2e"),r=i("79bc"),a=i("7b83"),s=200;t.exports=n},d327:function(t,e){function i(){return[]}t.exports=i},d370:function(t,e,i){var n=i("253c"),o=i("1310"),r=Object.prototype,a=r.hasOwnProperty,s=r.propertyIsEnumerable,l=n(function(){return arguments}())?n:function(t){return o(t)&&a.call(t,"callee")&&!s.call(t,"callee")};t.exports=l},d62c:function(module,__webpack_exports__,__webpack_require__){"use strict";function _toArray(t){return _arrayWithHoles(t)||_iterableToArray(t)||_unsupportedIterableToArray(t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function _iterableToArray(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function _arrayWithHoles(t){if(Array.isArray(t))return t}function asyncGeneratorStep(t,e,i,n,o,r,a){try{var s=t[r](a),l=s.value}catch(t){return void i(t)}s.done?e(l):Promise.resolve(l).then(n,o)}function _asyncToGenerator(t){return function(){var e=this,i=arguments;return new Promise(function(n,o){function r(t){asyncGeneratorStep(s,n,o,r,a,"next",t)}function a(t){asyncGeneratorStep(s,n,o,r,a,"throw",t)}var s=t.apply(e,i);r(void 0)})}}function filterFormTemplate(t,e){if("form"===e){var i=t;return t.indexOf("REGION_NAME")>-1?i=t.replace("REGION_NAME","REGION_ID"):t.indexOf("ORG_NAME")>-1?i=t.replace("ORG_NAME","ORG_ID"):t.indexOf("STAFF_NAME")>-1&&(i=t.replace("STAFF_NAME","STAFF_ID")),"$TABLE.".concat(i,".VALUE")}return"$".concat(t)}function isInOrg(t,e,i){return _isInOrg.apply(this,arguments)}function _isInOrg(){return _isInOrg=_asyncToGenerator(D_gitNew_ffitm_workflow_ui_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark(function t(e,i,n){var o,r,a,s;return D_gitNew_ffitm_workflow_ui_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(_api_workflow__WEBPACK_IMPORTED_MODULE_1__.p)({type:e,arg:i});case 2:if(o=t.sent,null!==o.result&&""!==o.result&&null!==n&&""!==n){t.next=5;break}return t.abrupt("return",!1);case 5:r=o.result.split("/"),a=n.split(","),s=0;case 8:if(!(s<a.length)){t.next=14;break}if(!r.includes(a[s])){t.next=11;break}return t.abrupt("return",!0);case 11:s++,t.next=8;break;case 14:return t.abrupt("return",!1);case 15:case"end":return t.stop()}},t)})),_isInOrg.apply(this,arguments)}function getRegularValue(t,e){return _getRegularValue.apply(this,arguments)}function _getRegularValue(){return _getRegularValue=_asyncToGenerator(D_gitNew_ffitm_workflow_ui_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark(function t(e,i){var n;return D_gitNew_ffitm_workflow_ui_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(_api_workflow__WEBPACK_IMPORTED_MODULE_1__.p)({type:e,arg:i});case 2:return n=t.sent,t.abrupt("return",n.result);case 4:case"end":return t.stop()}},t)})),_getRegularValue.apply(this,arguments)}function getRegularTacheValue(t,e,i,n){return _getRegularTacheValue.apply(this,arguments)}function _getRegularTacheValue(){return _getRegularTacheValue=_asyncToGenerator(D_gitNew_ffitm_workflow_ui_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark(function t(e,i,n,o){var r;return D_gitNew_ffitm_workflow_ui_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(_api_workflow__WEBPACK_IMPORTED_MODULE_1__.q)({type:e,flowId:i,tchId:n,flowMod:o});case 2:return r=t.sent,t.abrupt("return",r.result);case 4:case"end":return t.stop()}},t)})),_getRegularTacheValue.apply(this,arguments)}function filterComponentValue(t,e){var i=[];if(["9","28","44"].includes(t)&&Array.isArray(e))e.forEach(function(n,o){Array.isArray(n)&&n.length>0?i.push(n[n.length-1]):"9"===t&&o===e.length-1?i.push(n):"28"===t?i.push(n.instName):"44"===t&&i.push(n.flowId)});else{if(Array.isArray(e))return e.join(",").split(",");["3","4","6","7","24","25","33","37"].includes(t)&&""!==e&&null!==e&&(i=e.split(","))}return i}function compareComponentValue(t,e,i,n){for(var o=!1,r=filterComponentValue(i,t),a=filterComponentValue(i,e),s=0;s<a.length;s++)if(o=!0,!r.includes(a[s])){o=!1;break}switch(n){case"===":return o&&r.length===a.length;case"!==":return!o||r.length!==a.length;case"include":return o;case"noinclude":return!o;default:return o}}function isContain(t,e,i,n){return _isContain.apply(this,arguments)}function _isContain(){return _isContain=_asyncToGenerator(D_gitNew_ffitm_workflow_ui_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark(function _callee4(a,b,oper,elementType){var firstNullFilter,filterXtype,textXtype,resutl,_resutl;return D_gitNew_ffitm_workflow_ui_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap(function _callee4$(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:if(firstNullFilter=["noinclude","noinlist","in-org","!=="].includes(oper),""!==b){_context4.next=5;break}return _context4.abrupt("return",!1);case 5:if(""!==a||!firstNullFilter){_context4.next=9;break}return _context4.abrupt("return",!0);case 9:if(""!==a||firstNullFilter){_context4.next=11;break}return _context4.abrupt("return",!1);case 11:filterXtype=["9","28","44"],textXtype=["1","2","20"],filterXtype.includes(elementType)&&a&&(a=JSON.parse(a)),_context4.t0=oper,_context4.next="include"===_context4.t0?17:"noinclude"===_context4.t0?24:"inlist"===_context4.t0?31:"noinlist"===_context4.t0?38:"in-org"===_context4.t0?45:"notin-org"===_context4.t0?49:53;break;case 17:if(!mutilesXtype.includes(elementType)){_context4.next=21;break}return _context4.abrupt("return",compareComponentValue(a,b,elementType,oper));case 21:if(!textXtype.includes(elementType)){_context4.next=23;break}return _context4.abrupt("return",a.indexOf(b)>-1);case 23:return _context4.abrupt("return",a.split(",").includes(b));case 24:if(!mutilesXtype.includes(elementType)){_context4.next=28;break}return _context4.abrupt("return",!compareComponentValue(a,b,elementType,oper));case 28:if(!textXtype.includes(elementType)){_context4.next=30;break}return _context4.abrupt("return",-1===a.indexOf(b));case 30:return _context4.abrupt("return",!a.split(",").includes(b));case 31:if(!mutilesXtype.includes(elementType)){_context4.next=35;break}return _context4.abrupt("return",compareComponentValue(b,a,elementType,oper));case 35:if(!textXtype.includes(elementType)){_context4.next=37;break}return _context4.abrupt("return",b.indexOf(a)>-1);case 37:return _context4.abrupt("return",b.split(",").includes(a));case 38:if(!mutilesXtype.includes(elementType)){_context4.next=42;break}return _context4.abrupt("return",!compareComponentValue(b,a,elementType,oper));case 42:if(!textXtype.includes(elementType)){_context4.next=44;break}return _context4.abrupt("return",-1===b.indexOf(a));case 44:return _context4.abrupt("return",!b.split(",").includes(a));case 45:return _context4.next=47,isInOrg("orgPath",a,b);case 47:return resutl=_context4.sent,_context4.abrupt("return",resutl);case 49:return _context4.next=51,isInOrg("orgPath",a,b);case 51:return _resutl=_context4.sent,_context4.abrupt("return",!_resutl);case 53:if(!mutilesXtype.includes(elementType)){_context4.next=55;break}return _context4.abrupt("return",compareComponentValue(b,a,elementType,oper));case 55:return _context4.abrupt("return",eval("'".concat(a,"' ").concat(oper," '").concat(b,"'")));case 56:case"end":return _context4.stop()}},_callee4)})),_isContain.apply(this,arguments)}function filterCondition(){return _filterCondition.apply(this,arguments)}function _filterCondition(){return _filterCondition=_asyncToGenerator(D_gitNew_ffitm_workflow_ui_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark(function _callee5(){var data,global,_data,rule,other,conditionType,conditions,fit,result,configCondition,i,condition,template,value,realFormValue,flowId,tchId,flowMod,resultCheck,_args5=arguments;return D_gitNew_ffitm_workflow_ui_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap(function _callee5$(_context5){for(;;)switch(_context5.prev=_context5.next){case 0:if(data=_args5.length>0&&void 0!==_args5[0]?_args5[0]:[],global=_args5.length>1?_args5[1]:void 0,data.length){_context5.next=4;break}return _context5.abrupt("return");case 4:if(_data=_toArray(data),rule=_data[0],other=_data.slice(1),conditionType=rule.conditionType,conditions=rule.condition,fit=!1,conditions.length&&"16"!==rule.resultType||(fit=!0),fit){_context5.next=70;break}configCondition=[],i=0;case 12:if(!(i<conditions.length)){_context5.next=61;break}if(condition=conditions[i],!condition.resultContain||![!0,!1].includes(condition.resultContain)){_context5.next=18;break}fit=condition.resultContain,_context5.next=55;break;case 18:if(template=filterFormTemplate(condition.id,condition.type),value=condition.value,global.tache||!(template.indexOf("$TACHE")>-1)){_context5.next=22;break}return _context5.abrupt("break",61);case 22:realFormValue="",_context5.t0=condition.id,_context5.next="preTchMod"===_context5.t0?26:"preTchAction"===_context5.t0?31:"overTache"===_context5.t0?36:44;break;case 26:return _context5.next=28,getRegularValue("preTchMod",Object(_tool__WEBPACK_IMPORTED_MODULE_2__.g)("$FLOW.TCH_ID","",global).template);case 28:return realFormValue=_context5.sent,fit=!(!condition.chooseConfig||"1"!==condition.chooseConfig)||eval("'".concat(realFormValue,"' ").concat(condition.oper," '").concat(value,"'")),_context5.abrupt("break",53);case 31:return _context5.next=33,getRegularValue("preTchAction",Object(_tool__WEBPACK_IMPORTED_MODULE_2__.g)("$FLOW.TCH_ID","",global).template);case 33:return realFormValue=_context5.sent,fit=!(!condition.chooseConfig||"1"!==condition.chooseConfig)||eval("'".concat(realFormValue,"' ").concat(condition.oper," '").concat(value,"'")),_context5.abrupt("break",53);case 36:return flowId=Object(_tool__WEBPACK_IMPORTED_MODULE_2__.g)("$FLOW.FLOW_ID","",global).template,tchId=Object(_tool__WEBPACK_IMPORTED_MODULE_2__.g)("$FLOW.TCH_ID","",global).template,flowMod=Object(_tool__WEBPACK_IMPORTED_MODULE_2__.g)("$FLOW.FLOW_MOD","",global).template,_context5.next=41,getRegularTacheValue("passTchMod",flowId,tchId,flowMod);case 41:return realFormValue=_context5.sent,realFormValue&&(fit=!(!condition.chooseConfig||"1"!==condition.chooseConfig)||compareComponentValue(realFormValue,value,"3",condition.oper)),_context5.abrupt("break",53);case 44:if(realFormValue=Object(_tool__WEBPACK_IMPORTED_MODULE_2__.g)(template,"",global).template,!condition.chooseConfig||"1"!==condition.chooseConfig){_context5.next=49;break}fit=!0,_context5.next=52;break;case 49:return _context5.next=51,isContain(realFormValue,value,condition.oper,condition.elementType);case 51:fit=_context5.sent;case 52:return _context5.abrupt("break",53);case 53:condition.chooseConfig&&"1"===condition.chooseConfig&&configCondition.push({key:i,type:condition.type,value:realFormValue,oper:condition.oper,elementType:condition.elementType,keyCheck:condition.id,keyCodeVal:value}),condition.resultContain=fit;case 55:if(result=result?"1"===conditionType?result&&fit:result||fit:fit,!("1"===conditionType&&!result||"2"===conditionType&&result&&"1"!==condition.chooseConfig)){_context5.next=58;break}return _context5.abrupt("break",61);case 58:i++,_context5.next=12;break;case 61:if(!(configCondition.length>0&&fit)){_context5.next=70;break}return _context5.next=64,Object(_api_workflow__WEBPACK_IMPORTED_MODULE_1__.u)({condition:configCondition,conditionType:conditionType});case 64:resultCheck=_context5.sent,configCondition.forEach(function(t){conditions[t.key]=resultCheck.checkResult}),fit=resultCheck.checkResult,rule.dealStaffValue=resultCheck.dealStaffValue,rule.recommendStaffValue=resultCheck.recommendStaffValue,rule.resultCheck=resultCheck.checkResult;case 70:if(fit){_context5.next=73;break}return _context5.next=73,filterCondition(other,global);case 73:case"end":return _context5.stop()}},_callee5)})),_filterCondition.apply(this,arguments)}__webpack_require__.d(__webpack_exports__,"a",function(){return filterCondition});var D_gitNew_ffitm_workflow_ui_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("a34a"),D_gitNew_ffitm_workflow_ui_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(D_gitNew_ffitm_workflow_ui_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__),_api_workflow__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("f36f"),_tool__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("4642"),mutilesXtype=["3","4","6","7","9","24","25","28","33","37","44"]},d7ee:function(t,e,i){var n=i("c3fc"),o=i("b047"),r=i("99d3"),a=r&&r.isSet,s=a?o(a):n;t.exports=s},d925:function(t,e,i){"use strict";t.exports=function(t){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(t)}},da03:function(t,e,i){var n=i("2b3e"),o=n["__core-js_shared__"];t.exports=o},dc57:function(t,e){function i(t){if(null!=t){try{return o.call(t)}catch(t){}try{return t+""}catch(t){}}return""}var n=Function.prototype,o=n.toString;t.exports=i},e24b:function(t,e,i){function n(t){var e=-1,i=null==t?0:t.length;for(this.clear();++e<i;){var n=t[e];this.set(n[0],n[1])}}var o=i("49f4"),r=i("1efc"),a=i("bbc0"),s=i("7a48"),l=i("2524");n.prototype.clear=o,n.prototype.delete=r,n.prototype.get=a,n.prototype.has=s,n.prototype.set=l,t.exports=n},e538:function(t,e,i){(function(t){function n(t,e){if(e)return t.slice();var i=t.length,n=h?h(i):new t.constructor(i);return t.copy(n),n}var o=i("2b3e"),r=e&&!e.nodeType&&e,a=r&&"object"==typeof t&&t&&!t.nodeType&&t,s=a&&a.exports===r,l=s?o.Buffer:void 0,h=l?l.allocUnsafe:void 0;t.exports=n}).call(this,i("62e4")(t))},e619:function(t,e,i){},e683:function(t,e,i){"use strict";t.exports=function(t,e){return e?t.replace(/\/+$/,"")+"/"+e.replace(/^\/+/,""):t}},eac5:function(t,e){function i(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||n)}var n=Object.prototype;t.exports=i},ec69:function(t,e,i){function n(t){return a(t)?o(t):r(t)}var o=i("6fcd"),r=i("03dd"),a=i("30c9");t.exports=n},ec8c:function(t,e){function i(t){var e=[];if(null!=t)for(var i in Object(t))e.push(i);return e}t.exports=i},ed08:function(t,e,i){"use strict";function n(t){function e(i,n,o){if(i===n)return void(r&&r());var a=i+o>n?n:i+o;i>n&&(a=i-o<n?n:i-o),t===window?window.scrollTo(a,a):t.scrollTop=a,window.requestAnimationFrame(function(){return e(a,n,o)})}var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:500,r=arguments.length>4?arguments[4]:void 0;window.requestAnimationFrame||(window.requestAnimationFrame=window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(t){return window.setTimeout(t,1e3/60)});var a=Math.abs(i-n);e(i,n,Math.ceil(a/o*50))}function o(t){var e=t.split("?")[1];return e?JSON.parse('{"'.concat(decodeURIComponent(e).replace(/"/g,'\\"').replace(/&/g,'","').replace(/=/g,'":"'),'"}')):{}}function r(t){var e=/[^_]?[a-z]([A-Z])/g,i=/_(\w)/g;return t.replace(e,function(t,e){return t.replace(e,"_".concat(e))}).toLocaleLowerCase().replace(i,function(t,e){return e.toUpperCase()})}function a(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"_";if(!/[a-z]/.test(t))return t;var i=/[A-Z]/g;return t.replace(i,function(t){return"".concat(e).concat(t)}).toUpperCase()}function s(t){return t.getBoundingClientRect().top}function l(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:window;if(t){var r=Object.keys(t);if(r.length){var a=t[r[0]][0].field,l=e.find(function(t){return t.prop===a}).$el,h=o===window?0:s(o),c=o===window?window.pageYOffset:o.scrollTop;n(o,window.pageYOffset,s(l)-h+c-i)}}}function h(t){var e="#".concat(t,"\\.\\{ds\\}"),i=document.querySelector(e);return i&&"TEXTAREA"===i.tagName.toUpperCase()?i.value:""}function c(t){var e=h(t);return e?JSON.parse(e):e}function u(t,e){if(t>0){var i=new Date;i.setTime(t);var n=i.getFullYear(),o=i.getMonth()+1;o=o<10?"0".concat(o):o;var r=i.getDate();r=r<10?"0".concat(r):r;var a=i.getHours();a=a<10?"0".concat(a):a;var s=i.getMinutes(),l=i.getSeconds();return s=s<10?"0".concat(s):s,l=l<10?"0".concat(l):l,"YYYY-MM-DD hh:mm:ss"===e?"".concat(n,"-").concat(o,"-").concat(r," ").concat(a,":").concat(s,":").concat(l):"YYYY-MM-DD hh:mm"===e?"".concat(n,"-").concat(o,"-").concat(r," ").concat(a,":").concat(s):"MM-DD hh:mm"===e?"".concat(o,"-").concat(r," ").concat(a,":").concat(s):"".concat(n,"-").concat(o,"-").concat(r)}return""}i.d(e,"c",function(){return o}),i.d(e,"f",function(){return r}),i.d(e,"a",function(){return a}),i.d(e,"d",function(){return l}),i.d(e,"b",function(){return c}),i.d(e,"e",function(){return u})},efb6:function(t,e,i){function n(){this.__data__=new o,this.size=0}var o=i("5e2e");t.exports=n},f28c:function(t,e){function i(){throw new Error("setTimeout has not been defined")}function n(){throw new Error("clearTimeout has not been defined")}function o(t){if(c===setTimeout)return setTimeout(t,0);if((c===i||!c)&&setTimeout)return c=setTimeout,setTimeout(t,0);try{return c(t,0)}catch(e){try{return c.call(null,t,0)}catch(e){return c.call(this,t,0)}}}function r(t){if(u===clearTimeout)return clearTimeout(t);if((u===n||!u)&&clearTimeout)return u=clearTimeout,clearTimeout(t);try{return u(t)}catch(e){try{return u.call(null,t)}catch(e){return u.call(this,t)}}}function a(){g&&f&&(g=!1,f.length?p=f.concat(p):_=-1,p.length&&s())}function s(){if(!g){var t=o(a);g=!0;for(var e=p.length;e;){for(f=p,p=[];++_<e;)f&&f[_].run();_=-1,e=p.length}f=null,g=!1,r(t)}}function l(t,e){this.fun=t,this.array=e}function h(){}var c,u,d=t.exports={};!function(){try{c="function"==typeof setTimeout?setTimeout:i}catch(t){c=i}try{u="function"==typeof clearTimeout?clearTimeout:n}catch(t){u=n}}();var f,p=[],g=!1,_=-1;d.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)e[i-1]=arguments[i];p.push(new l(t,e)),1!==p.length||g||o(s)},l.prototype.run=function(){this.fun.apply(null,this.array)},d.title="browser",d.browser=!0,d.env={},d.argv=[],d.version="",d.versions={},d.on=h,d.addListener=h,d.once=h,d.off=h,d.removeListener=h,d.removeAllListeners=h,d.emit=h,d.prependListener=h,d.prependOnceListener=h,d.listeners=function(t){return[]},d.binding=function(t){throw new Error("process.binding is not supported")},d.cwd=function(){return"/"},d.chdir=function(t){throw new Error("process.chdir is not supported")},d.umask=function(){return 0}},f36f:function(t,e,i){"use strict";function n(t){return Object(j.a)({url:"/form/getFlowForm",method:"get",params:t})}function o(t){return Object(j.a)({url:"/flow/getNextTch",method:"get",params:t})}function r(t){return Object(j.a)({url:"/flow/saveFlow",method:"post",data:t})}function a(t){return Object(j.a)({url:"/form/saveForm",method:"post",data:t})}function s(t){return Object(j.a)({url:"/flow/exeExprVal",method:"post",data:t})}function l(t){return Object(j.a)({url:"/flow/getFuncVal",method:"post",data:t})}function h(t){return Object(j.a)({url:"/flow/getStaffFlowOpinion",type:"get",params:t})}function c(t){return Object(j.a)({url:"/flow/getFlowOpinion",type:"get",params:t})}function u(t){return Object(j.a)({url:"/flow/saveFlowOpinion",method:"post",data:t})}function d(t){return Object(j.a)({url:"/flow/delFlowOftenStaff",method:"post",data:t})}function f(t){return Object(j.a)({url:"/flow/getStaffNotifyTaches",method:"get",params:t})}function p(t){return Object(j.a)({url:"/flow/auditTache",method:"post",data:t})}function g(t){return Object(j.a)({url:"/flow/flowCfgRulesController/getResultByProc",method:"get",params:{procInfo:t}})}function _(t){return Object(j.a)({url:"/flow/flowCfgRulesController/getResultByType",method:"get",params:t})}function m(t){return Object(j.a)({url:"/flow/flowCfgRulesController/SaveMoveCfgResult",method:"post",data:t})}function v(t){return Object(j.a)({url:"/flow/getFlowStartUrl",method:"get",params:{flowMod:t}})}function y(t){return Object(j.a)({url:"/flow/cancelNextTch",method:"get",params:t})}function w(t){return Object(j.a)({url:"/flow/batchAuditTache",method:"get",params:t})}function b(t){return Object(j.a)({url:"/flow/doReceive",method:"get",params:{tchId:t}})}function x(t){return Object(j.a)({url:"/flow/cancelReceive",method:"get",params:{tchId:t}})}function A(t){return Object(j.a)({url:"/flow/branch/getBranchList",method:"get",params:t})}function C(t){return Object(j.a)({url:"/flow/branch/getBranchConfig",method:"get",params:t})}function T(t){return Object(j.a)({url:"/flow/branch/delBranchs",method:"get",params:t})}function k(t){return Object(j.a)({url:"/flow/branch/saveBranch",method:"post",data:t})}function S(t){return Object(j.a)({url:"/flow/addFlowAttention",method:"get",params:t})}function E(t){return Object(j.a)({url:"/flow/delFlowAttention",method:"get",params:t})}function I(t){return Object(j.a)({url:"/form/component/getLangSource",method:"get",params:t})}function L(t){return Object(j.a)({url:"/flow/getDynamicRuleCondition",method:"get",params:t})}function R(t){return Object(j.a)({url:"/flow/getDynamicRuleObjectCondition",method:"post",data:t})}function P(t){return Object(j.a)({url:"/flow/flowCfgRulesController/getFlowRuleConfigResultValue",method:"post",data:t})}function O(t){return Object(j.a)({url:"/form/getFormFieldTurn",method:"get",params:t})}function D(t){return Object(j.a)({url:"/flow/getFlowSuspendApplyData",method:"post",data:t})}function M(t){return Object(j.a)({url:"/flow/saveFlowSuspendApply",method:"post",data:t})}function N(t){return Object(j.a)({url:"/flow/approveFlowSuspendApply",method:"post",data:t})}function B(t){return Object(j.a)({url:"/flow/backFlowSuspendApply",method:"post",data:t})}function F(t){return Object(j.a)({url:"/flow/cancelFlowSuspendApply",method:"post",data:t})}function z(t){return Object(j.a)({url:"/flow/getLeaderList",method:"post",data:t})}function V(t){return Object(j.a)({url:"/flow/toPdf",method:"post",data:t})}function U(t){return Object(j.a)({url:"/flow/toWord",method:"post",data:t})}i.d(e,"s",function(){return n}),i.d(e,"z",function(){return o}),i.d(e,"I",function(){return r}),i.d(e,"L",function(){return a}),i.d(e,"l",function(){return s}),i.d(e,"w",function(){return l}),i.d(e,"C",function(){return h}),i.d(e,"t",function(){return c}),i.d(e,"J",function(){return u}),i.d(e,"j",function(){return d}),i.d(e,"D",function(){return f}),i.d(e,"c",function(){return p}),i.d(e,"A",function(){return g}),i.d(e,"B",function(){return _}),i.d(e,"M",function(){return m}),i.d(e,"E",function(){return v}),i.d(e,"f",function(){return y}),i.d(e,"m",function(){return w}),i.d(e,"k",function(){return b}),i.d(e,"g",function(){return x}),i.d(e,"o",function(){return A}),i.d(e,"n",function(){return C}),i.d(e,"h",function(){return T}),i.d(e,"H",function(){return k}),i.d(e,"a",function(){return S}),i.d(e,"i",function(){return E}),i.d(e,"x",function(){return I}),i.d(e,"p",function(){return L}),i.d(e,"q",function(){return R}),i.d(e,"u",function(){return P}),i.d(e,"v",function(){return O}),i.d(e,"r",function(){return D}),i.d(e,"K",function(){return M}),i.d(e,"b",function(){return N}),i.d(e,"d",function(){return B}),i.d(e,"e",function(){return F}),i.d(e,"y",function(){return z}),i.d(e,"F",function(){return V}),i.d(e,"G",function(){return U});var j=i("b775")},f6b4:function(t,e,i){"use strict";function n(){this.handlers=[]}var o=i("c532");n.prototype.use=function(t,e){return this.handlers.push({fulfilled:t,rejected:e}),this.handlers.length-1},n.prototype.eject=function(t){this.handlers[t]&&(this.handlers[t]=null)},n.prototype.forEach=function(t){o.forEach(this.handlers,function(e){null!==e&&t(e)})},t.exports=n},f6fd:function(t,e){!function(t){var e=t.getElementsByTagName("script");"currentScript"in t||Object.defineProperty(t,"currentScript",{get:function(){try{throw new Error}catch(n){var t,i=(/.*at [^\(]*\((.*):.+:.+\)$/gi.exec(n.stack)||[!1])[1];for(t in e)if(e[t].src==i||"interactive"==e[t].readyState)return e[t];return null}}})}(document)},f8af:function(t,e,i){function n(t){var e=new t.constructor(t.byteLength);return new o(e).set(new o(t)),e}var o=i("2474");t.exports=n},fa21:function(t,e,i){function n(t){return"function"!=typeof t.constructor||a(t)?{}:o(r(t))}var o=i("7530"),r=i("2dcb"),a=i("eac5");t.exports=n},fb15:function(t,e,i){"use strict";function n(t){return s(t)||a(t)||r(t)||o()}function o(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function r(t,e){if(t){if("string"==typeof t)return l(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?l(t,e):void 0}}function a(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function s(t){if(Array.isArray(t))return l(t)}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function h(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,n)}return i}function c(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?h(Object(i),!0).forEach(function(e){u(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):h(Object(i)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}function u(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function d(t,e,i){var o=t.menuRule,r=t.menuItem,a=[],s=[];return o.every(function(t){return Object(Ye.a)(t.funcMenuRule,i,e)&&(a=a.concat(t.enabledMenuItem||[]),s=s.concat(t.disabledMenuItem||[])),"0BT"!==t.isBreak}),a=n(new Set(a.join(",").split(","))),s=n(new Set(s.join(",").split(","))),t.menuItem=$e(r,a,s),t}function f(t,e,i,n,o,r,a){try{var s=t[r](a),l=s.value}catch(t){return void i(t)}s.done?e(l):Promise.resolve(l).then(n,o)}function p(t){return function(){var e=this,i=arguments;return new Promise(function(n,o){function r(t){f(s,n,o,r,a,"next",t)}function a(t){f(s,n,o,r,a,"throw",t)}var s=t.apply(e,i);r(void 0)})}}function g(t){return Object(qe.a)({url:"/busiCompoent/FuiStaffSelectAddonController/findStaffByIds",method:"get",params:{staffIds:t}})}function _(t){return g(t).then(function(t){return t.filter(function(t){return"2VX"!==t.STATE}).map(function(t){return{staffId:"".concat(t.STAFF_ID),staffName:t.STAFF_NAME,orgId:t.ORG_ID,regionId:t.REGION_ID}})})}function m(t){var e=Object.assign({},Ke,t);return e.orgId=e.orgId||"0",Object(qe.a)({url:"/busiCompoent/FuiStaffSelectAddonController/searchStaffByName",method:"post",data:e})}function v(t){return Object(qe.a)({url:"/flow/getPreTacheStaff",method:"get",params:t})}function y(t){return Object(qe.a)({url:"/busiCompoent/staffRegularController/filterStaffRegular",method:"get",params:t})}function w(t){return b.apply(this,arguments)}function b(){return b=p(Ue.a.mark(function t(e){var i,n,o,r=arguments;return Ue.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=r.length>1&&void 0!==r[1]?r[1]:null,t.next=3,y(e);case 3:if(n=t.sent,i){t.next=7;break}return Object.keys(n).forEach(function(t){n[t]=(n[t]||[]).map(function(t){return{staffId:"".concat(t.STAFF_ID),staffName:t.STAFF_NAME,orgId:t.ORG_ID,regionId:t.REGION_ID}})}),t.abrupt("return",n);case 7:return o=(n[i]||[]).map(function(t){return{staffId:"".concat(t.STAFF_ID),staffName:t.STAFF_NAME,orgId:t.ORG_ID,regionId:t.REGION_ID}}),t.abrupt("return",o);case 9:case"end":return t.stop()}},t)})),b.apply(this,arguments)}function x(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,n)}return i}function A(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?x(Object(i),!0).forEach(function(e){C(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):x(Object(i)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}function C(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function T(t){return E(t)||S(t)||R(t)||k()}function k(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function S(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function E(t){if(Array.isArray(t))return P(t)}function I(t,e){return D(t)||O(t,e)||R(t,e)||L()}function L(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function R(t,e){if(t){if("string"==typeof t)return P(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?P(t,e):void 0}}function P(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function O(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var i=[],n=!0,o=!1,r=void 0;try{for(var a,s=t[Symbol.iterator]();!(n=(a=s.next()).done)&&(i.push(a.value),!e||i.length!==e);n=!0);}catch(t){o=!0,r=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw r}}return i}}function D(t){if(Array.isArray(t))return t}function M(t,e,i,n,o,r,a){try{var s=t[r](a),l=s.value}catch(t){return void i(t)}s.done?e(l):Promise.resolve(l).then(n,o)}function N(t){return function(){var e=this,i=arguments;return new Promise(function(n,o){function r(t){M(s,n,o,r,a,"next",t)}function a(t){M(s,n,o,r,a,"throw",t)}var s=t.apply(e,i);r(void 0)})}}function B(){return F.apply(this,arguments)}function F(){return F=N(Ue.a.mark(function t(){var e,i,n,o,r,a,s,l,h,c,u,d,f,p,g,m,v,y,w,b,x,A,C,k,S=arguments;return Ue.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e=S.length>0&&void 0!==S[0]?S[0]:[],i=S.length>1?S[1]:void 0,n=S.length>2?S[2]:void 0,o=S.length>3?S[3]:void 0,r=S.length>4?S[4]:void 0,a=S.length>5?S[5]:void 0,s=S.length>6?S[6]:void 0,l=S.length>7&&void 0!==S[7]?S[7]:null,h=S.length>8&&void 0!==S[8]?S[8]:[],c=Object(Je.b)(),u=r.defaultStaffDisabled,d=r.defaultStaffSelected,f=r.defaultStaffCanChange,p=r.staffCreateType,g="0BT"===f,m=!e.length||"0BF"===u||!u,v=[],y=[],b=!0,"0BT"!==d&&d||!e.length||(i&&e.length?(v=[{staffId:e.map(function(t){return t.staffId}).join(","),staffName:i,orgId:e.map(function(t){return t.orgId}).join(","),orgIdSplit:e.map(function(t){return t.orgId}).join("|")}],x=T(e)):v=T(e)),!("string"==typeof l&&l||l&&l.length)){t.next=39;break}if("string"!=typeof l){t.next=25;break}return t.next=21,_(l);case 21:A=t.sent,y=A.map(function(t){return{oftenType:1,staffId:"".concat(t.staffId),staffName:t.staffName}}),t.next=35;break;case 25:if(!(C=l.map(function(t){return t.staffId}).join(","))){t.next=32;break}return t.next=29,_(C);case 29:t.t0=t.sent,t.next=33;break;case 32:t.t0=[];case 33:k=t.t0,y=k.map(function(t){return{oftenType:1,staffId:"".concat(t.staffId),staffName:t.staffName}});case 35:w=c("create_next_tch_info.recommender"),b=!0,t.next=40;break;case 39:y.length||(y=(r.often||[]).filter(function(t){return"1"===t.oftenType}),y.length&&(y.length?(w=c("create_next_tch_info.common_staff"),b=!g,v.length&&(m=!1)):(y=h.map(function(t){return{oftenType:1,staffId:"".concat(t.staffId),staffName:t.staffName}}),w=c("create_next_tch_info.recommender"),b=!0)));case 40:a.operator.staffCfg={canChange:g,defaultStaffDisabled:u,candidate:y,candidateLabel:w,candidateEditDisabled:b,realStaff:x,staffCreateType:p,candidateIsShow:m,orgId:n,beginOrgId:o,rootOrgCanChange:"0BT"===r.rootOrgCanChange,filterStaffWhere:r.filterStaffWhere},a.operator.value.staff=v,r.ready=!0,Qe(s,"operator");case 44:case"end":return t.stop()}},t)})),F.apply(this,arguments)}function z(t,e,i){return V.apply(this,arguments)}function V(){return V=N(Ue.a.mark(function t(e,i,n){var o;return Ue.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,w({staffId:e||"",isRequireOftenStaff:i,beginOrgId:n},"oftenUsePerson");case 2:return o=t.sent,t.abrupt("return",o);case 4:case"end":return t.stop()}},t)})),V.apply(this,arguments)}function U(){return j.apply(this,arguments)}function j(){return j=N(Ue.a.mark(function t(){var e,i,n,o,r,a,s,l,h,c,u,d,f,p,g,_,m,v,y,w,b,x,A,C,k,S,E,I,L,R,P=arguments;return Ue.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:for(e=P.length>0&&void 0!==P[0]?P[0]:[],i=P.length>1?P[1]:void 0,n=P.length>2?P[2]:void 0,o=P.length>3?P[3]:void 0,r=P.length>4?P[4]:void 0,a=P.length>5?P[5]:void 0,s=P.length>6?P[6]:void 0,l=P.length>7&&void 0!==P[7]?P[7]:null,h=Object(Je.b)(),c=r.defaultStaffDisabled,u=r.defaultStaffSelected,d=r.defaultStaffCanChange,f=r.staffCreateType,p=r.rootOrgCanChange,g="0BT"===d,_=[],m=[],y=!1,b=0;b<e.length;b++)x=e[b],A=!x.length||"0BF"===c||!c,"0BT"!==u&&1!==x.length||(i&&x.length?(_=[{staffId:x.map(function(t){return t.staffId}).join(","),staffName:i,orgId:x.map(function(t){return t.orgId}).join(","),orgIdSplit:x.map(function(t){return t.orgId}).join("|")}],w=T(x)):_=T(x)),l[b]?(m=l[b].map(function(t){return{oftenType:1,staffId:"".concat(t.staffId),staffName:t.staffName}}),v=h("create_next_tch_info.recommender"),y=!0):l[b]||(C="0BT",k="0BT"===p?o||0:n,S=z(x.map(function(t){return t.staffId}).join(","),C,k),m=S.map(function(t){return{oftenType:1,staffId:"".concat(t.staffId),staffName:t.staffName}}),v=h("create_next_tch_info.recommender"),y=!0),m.length||(m=(r.often||[]).filter(function(t){return"1"===t.oftenType}),m.length&&(m.length?(v=h("create_next_tch_info.common_staff"),y=!g):(E="0BT",I="0BT"===p?o||0:n,L=z(x.map(function(t){return t.staffId}).join(","),E,I),m=L.map(function(t){return{oftenType:1,staffId:"".concat(t.staffId),staffName:t.staffName}}),v=h("create_next_tch_info.recommender"),y=!0))),a.operator.staffCfg={canChange:g,candidate:m,candidateLabel:v,candidateEditDisabled:y,defaultStaffDisabled:c,realStaff:w,staffCreateType:f,candidateIsShow:A,orgId:n,beginOrgId:o,rootOrgCanChange:"0BT"===r.rootOrgCanChange,filterStaffWhere:r.filterStaffWhere},R={title:{display:!1},serial:{display:!1},parallel:{display:!1}},b>0&&(a.operator.countersignCfg=R),a.operator.value.staff=_,a.multiInstOperator.push(JSON.parse(JSON.stringify(a.operator)));0===e.length&&a.multiInstOperator.push(a.operator),r.ready=!0,Qe(s,"operator");case 18:case"end":return t.stop()}},t)})),j.apply(this,arguments)}function H(t,e,i,n,o,r,a){return W.apply(this,arguments)}function W(){return W=N(Ue.a.mark(function t(e,i,n,o,r,a,s){var l,h,c,u,d,f,p,g,m;return Ue.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:for(l=r.defaultStaffSelected,h="".concat(e).split("|"),c={staff:[],candidate:[]},u=0;u<h.length;u++)d="".concat(h[u]).split(":"),f="",p="",1===d.length?("0BT"===l&&(p=d[0]),f=d[0],p=d[0]):(f=d[0],p=d[1]),g=w({staffIds:p,isRequireOftenStaff:"0BF",beginOrgId:n||o},"dealStaff"),g&&c.staff.push(g),m=f?_(f):[],c.candidate.push(m);return t.next=6,Promise.all(c.staff);case 6:return c.staff=t.sent,t.next=9,Promise.all(c.candidate);case 9:c.candidate=t.sent,U(c.staff,i,n,o,r,a,s,c.candidate);case 11:case"end":return t.stop()}},t)})),W.apply(this,arguments)}function G(t,e,i,n){return Z.apply(this,arguments)}function Z(){return Z=N(Ue.a.mark(function t(e,i,n,o){var r,a,s,l,h,c,u,d,f,p,g,_,m,y,b,x,A,C,T,k,S,E,L,R,P,O,D,M,F,z,V,j,W,G,Z,X,Y,$;return Ue.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.defaultStaffType,a=e.defaultStaffValue,s=e.backCfg,l=e.defaultStaffNameValue,h=e.tchNum,c=e.tchMod,u=e.tacheAction,d=e.multiInstMerge,f=e.multiInst,p=Object.assign({tache:{tchNum:h,tchMod:c,action:u}},n),g=!1,m=e.tchMod,"return"!==u||!s||!s.isDefaultTacheExecStaff){t.next=12;break}return y=n.flow.tchId,t.next=8,v({tchId:y,nextTchMod:m});case 8:b=t.sent,b&&b.staffIds?(g=!0,_=new Promise(function(t){t(b)})):(x={template:a,type:r,$global:p,key:"defaultStaffValue",nullValue:"rule"===r?{tchMod:m,ruleType:"2"}:null},_=Object(Ye.c)(x)),t.next=14;break;case 12:A={template:a,type:r,$global:p,key:"defaultStaffValue",nullValue:"rule"===r?{tchMod:m,ruleType:"2"}:null},_=Object(Ye.c)(A);case 14:return C={template:l,type:r,$global:p,nullValue:null,key:"defaultStaffName"},T=Object(Ye.c)(C),k=e.rootOrgValue,S=e.rootOrgType,E={template:k,type:"rule"===r?"rule":S,$global:p,nullValue:"rule"===r?{tchMod:m,ruleType:"2"}:null,key:"rootOrgValue"},L=Object(Ye.c)(E),R=[_,T,L],P=e.beginOrgValue,O=e.beginOrgType,D={template:P,type:"rule"===r?"rule":O,$global:p,nullValue:"rule"===r?{tchMod:m,ruleType:"2"}:null,key:"beginOrgValue"},M=Object(Ye.c)(D),R.push(M),F=null,z=null,V=null,"rule"===r&&(j={template:a,type:r,$global:p,key:"staffCreateType",nullValue:{tchMod:m,ruleType:"2"}},F=Object(Ye.c)(j),W={template:a,type:r,$global:p,key:"defaultStaffCanChange",nullValue:{tchMod:m,ruleType:"2"}},z=Object(Ye.c)(W),G={template:a,type:r,$global:p,key:"candidate",nullValue:{tchMod:m,ruleType:"2"}},V=Object(Ye.c)(G)),R.push(F),R.push(z),R.push(V),Z=e.filterStaffWhere,X=e.filterStaffWhereType,Y={template:Z,type:"rule"===r?"rule":X,$global:p,nullValue:"rule"===r?{tchMod:m,ruleType:"2"}:null,key:"filterStaffWhere"},$=Object(Ye.c)(Y),R.push($),t.abrupt("return",Promise.all(R).then(function(){var t=N(Ue.a.mark(function t(n){var a,s,l,h,c,u,p,_,m,v,y,b,x,A;return Ue.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:a=I(n,8),s=a[0],l=a[1],h=a[2],c=a[3],u=a[4],p=a[5],_=a[6],m=a[7],u&&(e.staffCreateType=u),p&&(e.defaultStaffCanChange=p&&"F"!==p?"0BT":"0BF"),c&&"rule"===r&&(e.rootOrgCanChange="0BT"),m&&(e.filterStaffWhere=m),s&&"null"!==s?"1"===d&&"1"===f?(v=g?s.staffIds:s,H(v,l,h,c,e,i,o)):(y=g?s.staffIds:s,b="".concat(y).split(":"),1===b.length?y=b[0]:(_=b[0],y=b[1]),x="0BT"===e.rootOrgCanChange?c||0:h,w({staffIds:y,isRequireOftenStaff:"0BT",beginOrgId:x}).then(function(t){B(t.dealStaff,l,h,c,e,i,o,_,t.oftenUsePerson)})):"1"===f&&"1"===d?U([],l,h,c,e,i,o,[]):(A="0BT"===e.rootOrgCanChange?c||0:h,w({staffIds:"",isRequireOftenStaff:"0BT",beginOrgId:A}).then(function(t){B(t.dealStaff||[],l,h,c,e,i,o,_,t.oftenUsePerson)}));case 6:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()));case 36:case"end":return t.stop()}},t)})),Z.apply(this,arguments)}function X(){return Y.apply(this,arguments)}function Y(){return Y=N(Ue.a.mark(function t(){var e,i,n,o,r,a,s,l,h,c,u,d,f,p,g,m,v,y,w=arguments;return Ue.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e=w.length>0&&void 0!==w[0]?w[0]:[],i=w.length>1?w[1]:void 0,n=w.length>2?w[2]:void 0,o=w.length>3?w[3]:void 0,r=w.length>4?w[4]:void 0,a=w.length>5&&void 0!==w[5]?w[5]:null,s=Object(Je.b)(),l=n.notifyStaffDisabled,h=n.notifyStaffSelected,c=n.notifyStaffCanChange,u=n.notifyStaffCreateType,d="0BT"===c,f=!e.length||"0BF"===l||!l,p=[],g=[],v=!1,"0BT"!==h&&h||(p=e),!a){t.next=27;break}if("string"!=typeof a){t.next=22;break}return t.next=18,_(a);case 18:y=t.sent,g=y.map(function(t){return{oftenType:1,staffId:"".concat(t.staffId),staffName:t.staffName}}),t.next=23;break;case 22:g=a;case 23:m=s("create_next_tch_info.recommender"),v=!0,t.next=28;break;case 27:e.length?"0BF"===l?(g=e.map(function(t){return A({},t)}),m=s("create_next_tch_info.click_select"),v=!0):(g=[],v=!0):(g=n.often.filter(function(t){return"2"===t.oftenType}),m=s("create_next_tch_info.common_staff"),v=!d);case 28:o.cc.staffCfg={candidate:g,canChange:d,candidateLabel:m,candidateEditDisabled:v,isRange:"0BF"===c,orgId:i,staffCreateType:u,rootOrgCanChange:"0BT"===n.notifyRootOrgCanChange,candidateIsShow:f},o.cc.value.staff=p,Qe(r,"cc");case 31:case"end":return t.stop()}},t)})),Y.apply(this,arguments)}function $(t,e,i,n){return q.apply(this,arguments)}function q(){return q=N(Ue.a.mark(function t(e,i,n,o){return Ue.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if("rule"!==e.defaultStaffType&&"rule"!==e.notifyStaffType){t.next=5;break}return t.next=3,n.context.parent.filterConditionValue(e.tchMod,"2");case 3:return t.next=5,n.context.parent.filterConditionValue(e.tchMod,"4");case 5:ti(e,i),ei(e,i),ii(e,o.serialState,i),G(e,i,n,o),ni(e,i,n,o),i.loaded=!0;case 11:case"end":return t.stop()}},t)})),q.apply(this,arguments)}function K(t,e,i,n,o){var r=[];return(o||1===t.length)&&(r=1===t.length?t:o),n.nextTchReady.operatorCount=r.length,n.nextTchReady.ccCount=r.length,n.nextTchReady.operator=!1,n.nextTchReady.cc=!1,t.map(function(t){var e=t.tchNum,o=t.tchMod,a=t.displayTchName,s=t.tacheAction;i.nextItemTchMod=t.tchMod;var l=r.map(function(t){return t.tchMod}),h={multiInstOperator:[],operator:{staffCfg:{candidate:[],canChange:!0,candidateLabel:void 0,candidateEditDisabled:!0,realStaff:void 0},noticeCfg:{display:!1,isCustomNotify:!1,sms:{},mail:{}},countersignCfg:{title:{display:!1},serial:{display:!1},parallel:{display:!1}},value:{staff:[],sendMail:"0",sendSms:"0",countersignValue:void 0,notifyContent:""}},cc:{staffCfg:{candidate:[],canChange:!1},noticeCfg:{display:!1,sms:{},mail:{}},countersignCfg:void 0,value:{staff:[],sendMail:"0",sendSms:"0"}},notEnd:"end"!==s,tchMod:o,tchNum:e,displayTchName:a,info:t,tacheAction:s,excludePath:t.excludePath};return l.includes(t.tchMod)&&$(t,h,i,n),h})}function J(t,e){if(null==t)return{};var i,n,o=Q(t,e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);for(n=0;n<r.length;n++)i=r[n],e.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(t,i)&&(o[i]=t[i])}return o}function Q(t,e){if(null==t)return{};var i,n,o={},r=Object.keys(t);for(n=0;n<r.length;n++)i=r[n],e.indexOf(i)>=0||(o[i]=t[i]);return o}function tt(t,e,i,n,o,r,a){try{var s=t[r](a),l=s.value}catch(t){return void i(t)}s.done?e(l):Promise.resolve(l).then(n,o)}function et(t){return function(){var e=this,i=arguments;return new Promise(function(n,o){function r(t){tt(s,n,o,r,a,"next",t)}function a(t){tt(s,n,o,r,a,"throw",t)}var s=t.apply(e,i);r(void 0)})}}function it(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,n)}return i}function nt(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?it(Object(i),!0).forEach(function(e){ot(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):it(Object(i)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}function ot(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function rt(t){return ht(t)||lt(t)||st(t)||at()}function at(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function st(t,e){if(t){if("string"==typeof t)return ct(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?ct(t,e):void 0}}function lt(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function ht(t){if(Array.isArray(t))return ct(t)}function ct(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function ut(t){"@babel/helpers - typeof";return(ut="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function dt(t,e){return ft.apply(this,arguments)}function ft(){return ft=et(Ue.a.mark(function t(e,i){var n,o,r,a,s,l,h,c,u,d,f,p,g,_,m,v,y,w,b,x,A,C,T,k,S,E,I,L;return Ue.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=i.flow.tchName,o=e.tache,r=o.nextTchMods,a=o.layerStyle,s=o.defaultOpinionType,l=o.defaultOpinionValue,h=o.opinionType,c=o.opinion,u=o.defaultFlowNameValue,d=o.defaultFlowNameType,f=o.serialState,p=o.endTaskTitle,g=o.nextTchsValue,_=o.nextTchsType,m=o.nextTchsCanChange,v=o.nextTchsIsHiddenOther,y=o.nextTchsIsSelected,w=o.execDesc,b=o.opinionCfg,x=o.sysFlowWinCfg.showAttach,A=J(o,["nextTchMods","layerStyle","defaultOpinionType","defaultOpinionValue","opinionType","opinion","defaultFlowNameValue","defaultFlowNameType","serialState","endTaskTitle","nextTchsValue","nextTchsType","nextTchsCanChange","nextTchsIsHiddenOther","nextTchsIsSelected","execDesc","opinionCfg","sysFlowWinCfg"]),C=e.opinion,T=i.flow.opinionCfg||si(b),i.flow.opinionStatus=T.selected,k={dialogStyle:ai(a,x),opinionCfg:T,turnTitle:i.flow.flowName||n,nextTchMap:{},isRelateTchClosed:!r.find(function(t){return"0"===t.conTchClosed}),info:A,nextTchMods:r,serialState:f,endTaskTitle:p,nextTchs:[],selectedTchs:[],defaultTchs:[],nextTchReady:{all:!1,operator:!1,cc:!1},execDesc:w},k.turnTitle=hi(u,d,i,k),k.opinionConfig=li(k,i,C,c,s,l,h),"rule"!==_){t.next=11;break}return t.next=11,i.context.parent.filterConditionValue(i.flow.tchMod,"1");case 11:return S=fi(k,i,r,g,_,m,v,y),E=S.nextTchs,I=S.selectedTchs,L=S.nextTchMap,k.nextTchs=E,k.selectedTchs=I,k.nextTchMap=L,t.abrupt("return",k);case 16:case"end":return t.stop()}},t)})),ft.apply(this,arguments)}function pt(t){return{isSerialing:"inProgress"===t.tache.serialState,isParalleling:!!t.tache.nextTchMods.find(function(t){return"0"===t.conTchClosed})}}function gt(t){return wt(t)||yt(t)||mt(t)||_t()}function _t(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function mt(t,e){if(t){if("string"==typeof t)return vt(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?vt(t,e):void 0}}function vt(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function yt(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function wt(t){if(Array.isArray(t))return t}function bt(t,e,i,n,o,r,a){try{var s=t[r](a),l=s.value}catch(t){return void i(t)}s.done?e(l):Promise.resolve(l).then(n,o)}function xt(t){return function(){var e=this,i=arguments;return new Promise(function(n,o){function r(t){bt(s,n,o,r,a,"next",t)}function a(t){bt(s,n,o,r,a,"throw",t)}var s=t.apply(e,i);r(void 0)})}}function At(t,e,i,n,o,r,a,s){var l="function"==typeof t?t.options:t;e&&(l.render=e,l.staticRenderFns=i,l._compiled=!0),n&&(l.functional=!0),r&&(l._scopeId="data-v-"+r);var h;if(a?(h=function(t){t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,t||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),o&&o.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(a)},l._ssrRegister=h):o&&(h=s?function(){o.call(this,(l.functional?this.parent:this).$root.$options.shadowRoot)}:o),h)if(l.functional){l._injectStyles=h;var c=l.render;l.render=function(t,e){return h.call(e),c(t,e)}}else{var u=l.beforeCreate;l.beforeCreate=u?[].concat(u,h):[h]}return{exports:t,options:l}}function Ct(t){return Et(t)||St(t)||kt(t)||Tt()}function Tt(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function kt(t,e){if(t){if("string"==typeof t)return It(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?It(t,e):void 0}}function St(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function Et(t){if(Array.isArray(t))return It(t)}function It(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function Lt(t){return Dt(t)||Ot(t)||Pt(t)||Rt()}function Rt(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Pt(t,e){if(t){if("string"==typeof t)return Mt(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?Mt(t,e):void 0}}function Ot(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function Dt(t){if(Array.isArray(t))return Mt(t)}function Mt(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function Nt(t){return Vt(t)||zt(t)||Ft(t)||Bt()}function Bt(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Ft(t,e){if(t){if("string"==typeof t)return Ut(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?Ut(t,e):void 0}}function zt(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function Vt(t){if(Array.isArray(t))return Ut(t)}function Ut(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function jt(t,e){if(null==t)return{};var i,n,o=Ht(t,e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);for(n=0;n<r.length;n++)i=r[n],e.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(t,i)&&(o[i]=t[i])}return o}function Ht(t,e){if(null==t)return{};var i,n,o={},r=Object.keys(t);for(n=0;n<r.length;n++)i=r[n],e.indexOf(i)>=0||(o[i]=t[i]);return o}function Wt(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function Gt(t){return $t(t)||Yt(t)||Xt(t)||Zt()}function Zt(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Xt(t,e){if(t){if("string"==typeof t)return qt(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?qt(t,e):void 0}}function Yt(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function $t(t){if(Array.isArray(t))return qt(t)}function qt(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function Kt(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,n)}return i}function Jt(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?Kt(Object(i),!0).forEach(function(e){Qt(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):Kt(Object(i)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}function Qt(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function te(t,e,i,n,o,r,a){try{var s=t[r](a),l=s.value}catch(t){return void i(t)}s.done?e(l):Promise.resolve(l).then(n,o)}function ee(t){return function(){var e=this,i=arguments;return new Promise(function(n,o){function r(t){te(s,n,o,r,a,"next",t)}function a(t){te(s,n,o,r,a,"throw",t)}var s=t.apply(e,i);r(void 0)})}}function ie(t,e,i,n,o,r,a){try{var s=t[r](a),l=s.value}catch(t){return void i(t)}s.done?e(l):Promise.resolve(l).then(n,o)}function ne(t){return function(){var e=this,i=arguments;return new Promise(function(n,o){function r(t){ie(s,n,o,r,a,"next",t)}function a(t){ie(s,n,o,r,a,"throw",t)}var s=t.apply(e,i);r(void 0)})}}function oe(t){return ue(t)||re(t)||le(t)||se()}function re(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function ae(t,e){return ue(t)||ce(t,e)||le(t,e)||se()}function se(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function le(t,e){if(t){if("string"==typeof t)return he(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?he(t,e):void 0}}function he(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function ce(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var i=[],n=!0,o=!1,r=void 0;try{for(var a,s=t[Symbol.iterator]();!(n=(a=s.next()).done)&&(i.push(a.value),!e||i.length!==e);n=!0);}catch(t){o=!0,r=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw r}}return i}}function ue(t){if(Array.isArray(t))return t}function de(t,e,i,n,o,r,a){try{var s=t[r](a),l=s.value}catch(t){return void i(t)}s.done?e(l):Promise.resolve(l).then(n,o)}function fe(t){return function(){var e=this,i=arguments;return new Promise(function(n,o){function r(t){de(s,n,o,r,a,"next",t)}function a(t){de(s,n,o,r,a,"throw",t)}var s=t.apply(e,i);r(void 0)})}}function pe(t,e,i,n,o,r,a){try{var s=t[r](a),l=s.value}catch(t){return void i(t)}s.done?e(l):Promise.resolve(l).then(n,o)}function ge(t){return function(){var e=this,i=arguments;return new Promise(function(n,o){function r(t){pe(s,n,o,r,a,"next",t)}function a(t){pe(s,n,o,r,a,"throw",t)}var s=t.apply(e,i);r(void 0)})}}function _e(t,e,i,n,o,r,a){try{var s=t[r](a),l=s.value}catch(t){return void i(t)}s.done?e(l):Promise.resolve(l).then(n,o)}function me(t){return function(){var e=this,i=arguments;return new Promise(function(n,o){function r(t){_e(s,n,o,r,a,"next",t)}function a(t){_e(s,n,o,r,a,"throw",t)}var s=t.apply(e,i);r(void 0)})}}function ve(t,e){if(null==t)return{};var i,n,o=ye(t,e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);for(n=0;n<r.length;n++)i=r[n],e.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(t,i)&&(o[i]=t[i])}return o}function ye(t,e){if(null==t)return{};var i,n,o={},r=Object.keys(t);for(n=0;n<r.length;n++)i=r[n],e.indexOf(i)>=0||(o[i]=t[i]);return o}function we(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,n)}return i}function be(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?we(Object(i),!0).forEach(function(e){xe(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):we(Object(i)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}function xe(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function Ae(t){return Se(t)||ke(t)||Te(t)||Ce()}function Ce(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Te(t,e){if(t){if("string"==typeof t)return Ee(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?Ee(t,e):void 0}}function ke(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function Se(t){if(Array.isArray(t))return Ee(t)}function Ee(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function Ie(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,n)}return i}function Le(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?Ie(Object(i),!0).forEach(function(e){Re(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):Ie(Object(i)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}function Re(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function Pe(t,e,i,n,o,r,a){try{var s=t[r](a),l=s.value}catch(t){return void i(t)}s.done?e(l):Promise.resolve(l).then(n,o)}function Oe(t){return function(){var e=this,i=arguments;return new Promise(function(n,o){function r(t){Pe(s,n,o,r,a,"next",t)}function a(t){Pe(s,n,o,r,a,"throw",t)}var s=t.apply(e,i);r(void 0)})}}if(i.r(e),"undefined"!=typeof window){i("f6fd");var De;(De=window.document.currentScript)&&(De=De.src.match(/(.+\/)[^\/]+\.js(\?.*)?$/))&&(i.p=De[1])}var Me=i("b934"),Ne=i.n(Me),Be=i("9cad"),Fe=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"fi-workflow",class:{"fi-workflow-cmdb":t.isIframeForm},attrs:{id:"fiWorkflow"}},[i("input",{staticClass:"ie-hack",attrs:{id:"_ieHack"}}),t.hangUpMsgState?i("fi-alert",{attrs:{title:t.t("workflow_hangup.approvalInfo"),type:"warning",center:""}}):t._e(),i("fi-workflow-bar",{directives:[{name:"show",rawName:"v-show",value:!t.isIframeForm,expression:"!isIframeForm"}],ref:"toolBar",attrs:{menu:t.menu,"exc-method":t.excMenuEvent}}),i("fi-row",{staticClass:"fi-workflow-scoller",attrs:{id:"_fiWorkflowScoller"}},[i("fi-form",{ref:"fiForm",class:{"fi-workflow-form":!0,"fi-workflow-width":t.isScoller},attrs:{model:t.model,"label-width":t.labelWidth,rules:t.formRules,"validate-on-rule-change":!1,"fi-attrs":t.formContext.attrs,id:"fiForm"}},[t._t("default")],2)],1),i("fi-workflow-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],ref:"workflowDialog",attrs:{visible:t.workflowDialogVisible,id:"workflowDialog",rules:t.formAppendRules,tchData:t.tchData},on:{"update:visible":function(e){t.workflowDialogVisible=e},openDialog:t.openDialog}},[t._t("append")],2),t.opinionCfg.append?i("fi-workflow-opinion-console",{attrs:{visible:t.opinionCfg.show},on:{"update:visible":function(e){return t.$set(t.opinionCfg,"show",e)}}}):t._e(),t.approve.show?i("fi-workflow-approve",{attrs:{visible:t.approve.visible},on:{"update:visible":function(e){return t.$set(t.approve,"visible",e)}}}):t._e(),i("fi-workflow-receiving",{attrs:{"tch-id":t.flowContext.flow&&t.flowContext.flow.tchId,visible:t.receivingVisible},on:{"update:visible":function(e){t.receivingVisible=e},submit:t.receiving}}),t.togetherWork.show?i("fi-workflow-together-work",{attrs:{visible:t.togetherWork.visible},on:{"update:visible":function(e){return t.$set(t.togetherWork,"visible",e)}}}):t._e(),t.togetherWorkDetail.show?i("fi-workflow-together-work-detail",{attrs:{visible:t.togetherWorkDetail.visible},on:{"update:visible":function(e){return t.$set(t.togetherWorkDetail,"visible",e)}}}):t._e(),t.hangUpDetail.show?i("fi-workflow-hangup",{attrs:{hangTitle:t.hangUpDetail.hangTitle,visible:t.hangUpDetail.visible,hangData:t.hangData,hangUpMsgState:t.hangUpMsgState},on:{"update:visible":function(e){return t.$set(t.hangUpDetail,"visible",e)},getHangUpStatue:t.getHangUpStatue}}):t._e(),i("iframe",{staticStyle:{display:"none"},attrs:{id:"download"}})],1)},ze=[],Ve=i("a34a"),Ue=i.n(Ve),je=i("0644"),He=i.n(je),We=i("323e"),Ge=i.n(We),Ze=(i("e619"),i("f36f")),Xe=i("ed08"),Ye=i("4642"),$e=function t(e,i,n){return e.map(function(e){var o=e.disabled;return i.includes(e.funcMenuItemId)&&(o="0BF"),n.includes(e.funcMenuItemId)&&(o="0BT"),c(c({},e),{},{disabled:o,children:t(e.children||[],i,n)})})},qe=i("b775"),Ke={pageSize:10,searchType:"STAFF"},Je=i("2ee6"),Qe=function(t,e){var i="".concat(e,"Count"),n=t.nextTchReady[i]-1;t.nextTchReady[i]=n,n<=0&&(t.nextTchReady[e]=!0)},ti=function(t,e){var i={},n=t.smsJson,o=void 0===n?{}:n,r=t.mailJson,a=void 0===r?{}:r,s=t.isShowCustomSms;i.sms={display:"0BT"===o.display,disabled:"0BF"===o.canchange,isShowCustomSms:"0BT"===s};var l="0BT"===o.selected?"1":"0";i.mail={display:"0BT"===a.display,disabled:"0BF"===a.canchange};var h="0BT"===a.selected?"1":"0";i.display="0BT"===o.display||"0BT"===a.display,e.operator.noticeCfg=i,e.operator.value.sendMail=h,e.operator.value.sendSms=l},ei=function(t,e){var i=t.notifyCfg||{},n=i.mail,o=void 0===n?{}:n,r=i.sms,a=void 0===r?{}:r;e.cc.noticeCfg={mail:{display:"true"===o.display,disabled:"true"!==o.canChange},sms:{display:"true"===a.display,disabled:"true"!==a.canChange},display:"true"===o.display||"true"===a.display},e.cc.value.sendMail="true"===o.selected?"1":"0",e.cc.value.sendSms="true"===a.selected?"1":"0"},ii=function(t,e,i){var n=t.multiInst,o=t.canSerial,r=t.countersignCfg,a=void 0===r?{}:r,s=a.parallel,l=void 0===s?{}:s,h=a.serial,c=void 0===h?{}:h,u={display:a.display,text:a.text,textus:a.textus},d="transfer"===t.tacheAction,f="inProgress"===e;c.display=u.display&&c.display&&"0BT"===o&&!d&&!f,l.display=u.display&&l.display&&"1"===n&&!f;var p="1"===n&&!f&&l.checked?"parallel":"";p="0BT"!==o||d||f||!c.checked?p:"serial",i.operator.value.countersignValue=p,i.operator.countersignCfg={title:u,serial:c,parallel:l}},ni=function(t,e,i,n){var o=t.notifyStaffType,r=t.notifyStaffValue,a=t.tchNum,s=t.tchMod,l=t.tacheAction,h=Object.assign({tache:{tchNum:a,tchMod:s,action:l}},i),c={template:r,type:o,$global:h,key:"notifyStaffValue",nullValue:"rule"===o?{tchMod:s,ruleType:"4"}:null},u=Object(Ye.c)(c),d=t.notifyRootOrgValue,f=t.notifyRootOrgType,p={template:d,type:"rule"===o?"rule":f,$global:h,key:"notifyRootOrgValue",nullValue:"rule"===o?{tchMod:s,ruleType:"4"}:null},g=Object(Ye.c)(p),m=null,v=null,y=null;if("rule"===o){var w={template:r,type:o,$global:h,key:"notifyStaffCreateType",nullValue:{tchMod:s,ruleType:"4"}};m=Object(Ye.c)(w);var b={template:r,type:o,$global:h,key:"notifyStaffCanChange",nullValue:{tchMod:s,ruleType:"4"}};v=Object(Ye.c)(b);var x={template:r,type:o,$global:h,key:"notifyCandidate",nullValue:{tchMod:s,ruleType:"4"}};y=Object(Ye.c)(x)}return Promise.all([u,g,m,v,y]).then(function(i){var o=I(i,5),r=o[0],a=o[1],s=o[2],l=o[3],h=o[4];if(s&&(t.notifyStaffCreateType=s),l&&(t.notifyStaffCanChange=l&&"F"!==l?"0BT":"0BF"),r&&"null"!==r){var c="".concat(r).split(":");return 1===c.length?r=c[0]:(h=c[1],r=c[0]),_(r).then(function(i){return X(i,a,t,e,n,h)})}return X([],a,t,e,n,h)})},oi={run:"actionRunTitle",return:"actionBackTitle",transfer:"actionTransferTitle"},ri={H:"H",SO:"SO",SR:"SR"},ai=function(t,e){var i=t.fullScreen,n=t.width;return{fullScreen:"0"!==i,width:isNaN(n)?n:"".concat(n,"px"),showAttach:e}},si=function(t){var e=Object(Je.b)(),i=t||{},n=i.options,o=void 0===n?[]:n,r=i.display,a=void 0!==r&&r,s=i.refresh,l=void 0===s||s,h=i.selected;if(!a||!Array.isArray(o))return{display:a};var c=2===o.length&&o.every(function(t){return"string"==typeof t});if(!o.length||c)return{display:a,selected:h||"0BT",refresh:l,items:[{text:o[0]||e("create_tch_data.agree"),value:"0BT"},{text:o[1]||e("create_tch_data.disagree"),value:"0BF"}]};var u=o.reduce(function(t,e,i){return"string"==typeof e?t.push({text:e,value:e}):"object"===ut(e)&&t.push({text:e.text,value:e.value||e.text||i}),t},[]);return{display:a,selected:h||0===h?h:u[0].value,refresh:l,items:u}},li=function(t,e){for(var i=arguments.length,n=new Array(i>2?i-2:0),o=2;o<i;o++)n[o-2]=arguments[o];var r=n[0],a=n[1],s=n[2],l=n[3],h=n[4],c={list:r||[],display:h!==ri.H,required:h===ri.SR,default:null===a?"":a,ready:!1};if(!c.default&&c.display){var u=t.opinionCfg;if(u&&u.display){var d=u.items,f=u.selected,p=void 0===f?d[0]:d.find(function(t){return t.value===f});c.default=(p||{}).text}}if(null===a&&l){var g={template:l,type:s,$global:e,nullValue:null,key:"defaultOpinionValue"};Object(Ye.c)(g).then(function(t){c.default=t,c.ready=!0})}else c.ready=!0;return c},hi=function(t,e,i,n){var o=Object(Je.b)();if(t){var r={template:t,type:e,$global:i,nullValue:null,key:"defaultFlowNameValue"};Object(Ye.c)(r).then(function(t){n.turnTitle=t||o("create_tch_data.tch_handle")})}return n.turnTitle||o("create_tch_data.tch_handle")},ci=function(t){if(t.length<=1)return!1;var e=t.map(function(t){return t.tacheAction});if(rt(new Set(e)).length===e.length)return!0;if(t.every(function(t){return!t.excludePath}))return!1;for(var i=!0,n=0;n<t.length;n++){if("break"===function(e){var n=t[e],o=n.excludePath?n.excludePath.match(/(.)*[^;]/g)[0].split(";"):[];if(o.length&&(i=t.every(function(t){var e=!0;return o.length&&(e=o.includes(t.tchMod)),n===t||n.tacheAction!==t.tacheAction||e})),!i)return"break"}(n))break}return i},ui=function(t,e){for(var i=arguments.length,n=new Array(i>2?i-2:0),o=2;o<i;o++)n[o-2]=arguments[o];var r=n[0],a=n[1],s=n[2],l=n[3],h=n[4],c=[],u=h&&1===l.length?[l[0].tchMod]:[];if(t&&("0BF"===r||"0BT"===a)){var d="".concat(t).split(":")[0].split(",");d=d.filter(function(t){return e[t]}),d=rt(new Set(d)),c=d.map(function(t){return e[t]}),u="".concat(t).includes(":")?"".concat(t).split(":")[1].split(","):"0BT"===s?"".concat(t).split(","):[],u=u.filter(function(t){return d.includes(t)});var f=u.map(function(t){return e[t]});return f.length&&ci(f)&&(u=[]),h&&!u.length&&d.length&&(u=[d[0]]),{nextTchMods:c,defaultTchs:u}}if(h&&!u.length&&"0BT"===s&&!"".concat(t).includes(":")){u=["".concat(t).split(",")[0]]}return{nextTchMods:l,defaultTchs:u}},di=function(t){return t.reduce(function(t,e){return t[e.tchMod]=e,t},{})},fi=function(t,e){for(var i=t.opinionCfg,n=arguments.length,o=new Array(n>2?n-2:0),r=2;r<n;r++)o[r-2]=arguments[r];var a=o[0],s=o[1],l=o[2],h=o[3],c=o[4],u=o[5],d=[],f=[],p=e.flow.tchMod,g=a.map(function(t){var e=t.tchName,i=t.tacheAction,n=t.customTchName,o=t[oi[i]],r=o?o.replace(/%TCH_NAME%/gi,e):e;return r=n||r,nt(nt({},t),{},{displayTchName:r})});t.isRelateTchClosed||(g=g.filter(function(t){return"1"===t.conTchClosed}));var _=di(g);if(s||"rule"===l){var m={template:s,type:l,$global:e,nullValue:i&&"rule"===l?{tchMod:p,ruleType:"1",opinionCfg:i}:null,key:"nextTchsValue"};Object(Ye.c)(m).then(function(i){var n=ui(i,t.nextTchMap,h,c,u,g,t.isRelateTchClosed),o=n.defaultTchs.map(function(t){return _[t]});if(d=K(n.nextTchMods,t.serialState,e,t,o),_=di(d),f=n.defaultTchs.map(function(t){return _[t]}),d.length||(t.nextTchReady.all=!0),!t.isRelateTchClosed){var r={endTask:!0,tchMod:"endTask"};d.unshift(r),f.length||f.push(r)}t.nextTchs=d,t.nextTchMap=_,t.selectedTchs=f})}else{d=K(g,t.serialState,e,t),d.length||(t.nextTchReady.all=!0);var v=t.isRelateTchClosed&&1===d.length?[d[0].tchMod]:[];if(_=di(d),f=v.map(function(t){return _[t]}),!t.isRelateTchClosed){var y={endTask:!0,tchMod:"endTask"};d.unshift(y),f.length||f.push(y)}}return{nextTchs:d,selectedTchs:f,nextTchMap:_}},pi=i("d62c"),gi={setContext:function(t){this.workflow=t},setFormApproveContext:function(t){this.formApproveContext=t},getCurTchText:function(t){var e=Object(Je.b)(),i=this.workflow.flowContext.form.formName;return this.workflow.fiForm.getDynamicFormName&&(i=this.workflow.fiForm.getDynamicFormName(i)),'<div class="workflow-toolbar-text">\n              '.concat(t?'<span class="flow-name-icon">'.concat(t,"</span>"):"",'\n              <span class="flow-name">').concat(i,'</span>\n              <span class="tch-name">(').concat(e("workflow_context.current_tache")).concat(this.workflow.flowContext.flow.tchName,")</span>\n            </div>")},doFlowOnLayer:function(){this.workflow.openFlowDialog()},viewFlowProc:function(){var t=this.workflow.flowContext.flow,e=t.tchId,i=t.flowId,n=t.flowMod,o=t.topFlowId,r=qe.a.defaults.baseURL?"/aiops/app/form/flowProcess/index.html?topFlowId=".concat(o,"&flowId=").concat(i,"&tchId=").concat(e,"&flowMod=").concat(n):"/commonForm/flowProcess?topFlowId=".concat(o,"&flowId=").concat(i,"&tchId=").concat(e,"&flowMod=").concat(n);window.open(r)},viewFlowModel:function(){var t=this.workflow.flowContext.flow,e=t.flowMod,i=t.flowId,n=qe.a.defaults.baseURL?"/aiops/app/form/flowModel/index.html?flowMod=".concat(e,"&flowId=").concat(i):"/commonForm/flowModel?flowMod=".concat(e,"&flowId=").concat(i);window.open(n)},orderReassign:function(){this.workflow.orderReassign()},doApprove:function(){this.workflow.showApprove()},doSaveFlowForm:function(){var t;(t=this.workflow).doSaveFlowForm.apply(t,arguments)},doOpinion:function(){this.workflow.doOpinion()},flowTo:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(t.isPrompt=void 0===t.isPrompt||t.isPrompt,!t.tchNum)return void console.log("未配置tchNum");void 0===t.auto&&(t.auto=!1),this.workflow.flowToConfirm(t,this.workflow.doAutoTurn,t)},flowToNext:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.tchNum;if(t.isPrompt=void 0===t.isPrompt||t.isPrompt,!e)return void console.log("未配置tchNum");void 0===t.auto&&(t.auto=!0),this.workflow.flowToConfirm(t,this.workflow.doAutoTurn,t)},flowToDefault:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};void 0===t.auto&&(t.auto=!0),t.tchNum=void 0,t.isPrompt=void 0===t.isPrompt||t.isPrompt,this.workflow.flowToConfirm(t,this.workflow.doAutoTurn,t)},closePopup:function(){this.workflow.workflowDialogVisible=!1},getTchOpinion:function(){return this.workflow.workflowDialog?this.workflow.workflowDialog.opinion:""},flowCanceNextTch:function(){this.workflow.doFlowCanceNextTch()},flowAutoRead:function(){this.workflow.doFlowAutoRead()},receivingTask:function(){this.workflow.receivingVisible=!0},receiving:function(){this.workflow.receivingPool()},release:function(){this.workflow.releasingPool()},doFormApprove:function(){this.formApproveContext.doSubmit()},doOaWork:function(){this.workflow.showTogetherWork()},doOaWorkDetail:function(){this.workflow.showTogetherWorkDetail()},addFlowAttention:function(){this.workflow.addFlowAttention()},delFlowAttention:function(){this.workflow.delFlowAttention()},filterConditionValue:function(){function t(t,i){return e.apply(this,arguments)}var e=xt(Ue.a.mark(function t(e,i){var n,o,r,a,s;return Ue.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=this.workflow.tacheRules,r=this.workflow.$global(),"1"!==i?(a=n.nextCfg[e],o=a.cfg.filter(function(t){return t.ruleType===i}),r.tache=a.tache):o=n.cfg.filter(function(t){return t.ruleType===i}),o.length){t.next=5;break}return t.abrupt("return","");case 5:return s=Object(pi.a)(o,r),t.abrupt("return",s);case 7:case"end":return t.stop()}},t,this)}));return t}(),addHangUp:function(){this.workflow.addHangUp()},cancelHangUp:function(){this.workflow.cancelHangUp()},formTurn:function(t,e){var i=this.workflow.model.REQUEST_ID,n=this.workflow.flowContext.flow,o=n.flowId,r=n.tchId,a=n.flowMod;if(!e){var s=window.location.href,l=s.split("?");l.length&&(e="".concat(l[0],"?flowMod=").concat(a))}t?(window.mainFlow=this.workflow.model,window.mainRequestId=i,window.mainFormId=this.workflow.flowContext.form.formId,window.mainFlowId=o,window.mainTchId=r,window.open(e,"CONFIG_TURN")):(sessionStorage.setItem("mainFlow",JSON.stringify(this.workflow.model)),sessionStorage.setItem("mainRequestId",i),sessionStorage.setItem("mainFlowId",o),sessionStorage.setItem("mainTchId",r),window.open(e,"TURN"))},getConditionCampare:function(t,e){function i(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(!t.length)return"";var e=gt(t),n=e[0],a=e.slice(1),l=n.conditionType,u=n.condition;if(u.length&&"16"!==n.resultType||(f=!0),!f){var d;if(n.resultCheck)f=!0;else for(var p=0;p<u.length;p++){var g=u[p],_="form"===g.type?"$TABLE.".concat(g.id,".VALUE"):"$".concat(g.id);if(!s.tache&&_.indexOf("$TACHE")>-1)break;if(f=g.resultContain,d=d?"1"===l?d&&f:d||f:f,"1"===l&&!d||"2"===l&&d)break}}if(f){var m=n.resultType,v=n.dealStaff,y=n.dealNode,w=n.dealFar,b=n.choiceWay,x=n.isCanChange,A=n.dealTacheInfo,C=n.recommendType,T=n.recommendStaff,k=n.result,S=n.solrText,E=n.orgFarWay;if(o&&["rootOrgValue","notifyRootOrgValue"].includes(o))return y;if(o&&"beginOrgValue"===o){if("T"===x&&"2"===E){return s.globalVar.orgId}return w}if(o&&["staffCreateType","notifyStaffCreateType"].includes(o))return b;if(o&&["defaultStaffCanChange","notifyStaffCanChange"].includes(o))return x;if(o&&"filterStaffWhere"===o)return S;if(o&&"nextTchsValue"===o){var I=r.selected,L=r.display,R=A.tacheArr,P=[];P="0"!==L&&L?R?R.filter(function(t){return t.key===I}):[]:R||[];var O=[];if(P.length>1&&P.forEach(function(t){t.isSetDeRult&&O.push(t)}),P.length){var D=O.map(function(t){return t.tchMod}).join(","),M=P.map(function(t){return t.tchMod}).join(",");return D?"".concat(M,":").concat(D):M}}if(o&&["candidate","notifyCandidate"].includes(o)){if(void 0!==n.resultCheck)return n.recommendStaffValue;if("1"===C)return T?T.map(function(t){return{oftenType:"candidate"===o?1:2,staffId:"".concat(t.id),staffName:t.name}}):null;if("10"===C)return Object(Ye.g)(T,"",s).template;var N={tchId:h,flowId:c,resultType:C,resultValue:T};return Object(Ze.B)(N).then(function(t){return t.returnData})}if(void 0!==n.resultCheck)return n.dealStaffValue;if(["1","11","12","13"].includes(m))return v?v.map(function(t){return t.id}).join(","):null;if("6"===m)return Object(Ye.g)("$TABLE.".concat(k,".VALUE"),"",s).template;if("16"===m){var B=k.packageName,F=k.procName,z=k.params,V=Object(Ye.g)("".concat(B,".").concat(F,"(").concat(z,")"),"",s).template;return Object(Ze.A)(V).then(function(t){return t.returnData||""})}if("10"===m)return Object(Ye.g)(k,"",s).template;var U={tchId:h,flowId:c,resultType:m,resultValue:k};return Object(Ze.B)(U).then(function(t){return t.returnData})}return i(a)}var n,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=this.workflow.tacheRules,s=this.workflow.$global(),l=this.workflow.flowContext.flow,h=l.tchId,c=l.flowId,u=this.workflow.defineRegularRules.find(function(i){return i.tchMod-t==0&&i.type-e==0});if(u)return this.getDefinedRegularResult(u,e,o);if("1"!==e){var d=a.nextCfg[t];n=d.cfg.filter(function(t){return t.ruleType===e}),s.tache=d.tache}else n=a.cfg.filter(function(t){return t.ruleType===e});var f=!1;return n.length?i(n):""},getDefinedRegularResult:function(t,e,i){return"1"===e?i&&"nextTchsValue"===i&&t.nextTache?t.nextTache:"":i&&["candidate","notifyCandidate"].includes(i)?t.recommendStaff?t.recommendStaff:"":t.dealStaff?t.dealStaff:""},getMoveCampare:function(t,e){var i=this;if(!["1","2","4"].includes(e))return null;var n,o={1:["nextTchsValue","nextTchsType"],2:["defaultStaffValue","defaultStaffType"],4:["notifyStaffValue","notifyStaffType"]},r=this.workflow.$global(),a=this.workflow.tacheMoveRules[t]||[];return a.forEach(function(a){var s=a.rulesSign;if("A"===s){var l=o[e],h=a[l[0]],c=a[l[1]];n=Object(Ye.c)({template:h,type:c,$global:r,nullValue:null,key:l[0]}).then(function(i){return Object(Ze.M)({curTchMod:t,type:e,rulesSign:s,rulesSignByBResult:i}),i})}else new Promise(function(n){n(i.getConditionCampare(t,e))}).then(function(i){Object(Ze.M)({curTchMod:t,type:e,rulesSign:s,rulesSignByBResult:i})})}),n},execFlowUIHook:function(){this.workflow.hasAppend&&this.workflow.workflowDialogVisible&&this.workflow.refreshNextTchData()},isEnableForword:function(){var t=this.workflow.flowContext.flow.tchExecuter||"";return this.isTchEnd()||this.isView()||!(this.isFlowBegin()||this.isFlowModelFlowManager()||this.isExecuter()||this.isReceiver()&&!t)},isFlowBegin:function(){return["0","-1",0,-1].includes(this.workflow.flowContext.flow.tchId)},isExecuter:function(){var t=this.workflow.flowContext.global.staffId,e=this.workflow.flowContext.flow.tchExecuter||"";return!!e&&e.split(",").includes(t)},isReceiver:function(){var t=this.workflow.flowContext.global.staffId,e=this.workflow.flowContext.flow.tchReceiver||"";return this.isFlowModelFlowManager()||e.split(",").includes(t)},isFlowModelFlowManager:function(){return"1"===this.workflow.flowContext.flow.isFlowManager},isTchEnd:function(){var t=this.workflow.flowContext.flow,e=t.tchStatus,i=t.flowStatus;return"F"===e||"F"===i},isView:function(){return"view"===Object(Xe.c)(window.location.search).type},isTacheActive:function(){return"C"!==this.workflow.flowContext.flow.tchStatus},isPool:function(){return"0BT"===this.workflow.flowContext.flow.isPool},tchExecuterLength:function(){return(this.workflow.flowContext.flow.tchReceiver||"").split(",").length},isParalleling:function(){return this.workflow.isParalleling},isSerialing:function(){return this.workflow.isSerialing},getTchCancelPriv:function(){return this.workflow.flowContext.flow.cancelPrivTchId<=0},isFormModel:function(){return"form"===this.workflow.flowContext.flow.winModel},isStartOA:function(){return"0BT"===this.workflow.flowContext.flow.isStartOA},isTchBranch:function(){return!!this.workflow.flowContext.flow.tchBranchId},isAddFlowAttention:function(){return"0"===this.workflow.flowContext.flow.isAttention},isInOrg:function(){function t(t,i,n){return e.apply(this,arguments)}var e=xt(Ue.a.mark(function t(e,i,n){var o,r,a,s;return Ue.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(Ze.p)({type:e,arg:i});case 2:if(o=t.sent,null!==o.data.result&&""!==o.data.result&&null!==n&&""!==n){t.next=5;break}return t.abrupt("return",!1);case 5:r=o.data.result.split("/"),a=n.split(","),s=0;case 8:if(!(s<a.length)){t.next=14;break}if(r.includes(a[s])){t.next=11;break}return t.abrupt("return",!1);case 11:s++,t.next=8;break;case 14:return t.abrupt("return",!0);case 15:case"end":return t.stop()}},t)}));return t}(),getRegularValue:function(){function t(t,i){return e.apply(this,arguments)}var e=xt(Ue.a.mark(function t(e,i){var n;return Ue.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(Ze.p)({type:e,arg:i});case 2:return n=t.sent,t.abrupt("return",n.data.result);case 4:case"end":return t.stop()}},t)}));return t}(),isHangUp:function(){var t=this.workflow.flowContext.flow.suspend.state;return"apply"!==t&&"suspend"!==t},cancelHangUpRule:function(){var t=this.workflow.flowContext.flow.suspend.state;return"apply"===t||"suspend"===t},isApproveHangUp:function(){var t=this.workflow.flowContext.flow.suspend,e=t.state,i=t.approveStaffId,n=this.workflow.flowContext.global.staffId;return"apply"===e&&i.split(",").includes(n)},toPdf:function(t){this.workflow.toPdf(t)},toWord:function(t){this.workflow.toWord(t)}},_i=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"fi-workflow-bar"},[i("fi-workflow-menu",{attrs:{menu:t.menu,"exc-method":t.excMethod}})],1)},mi=[],vi=function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.menu.menuItem?i("div",{staticClass:"fi-workflow-menu"},[t.leftFlowName?i("div",{class:["fi-workflow-menu-item","label","left"],domProps:{innerHTML:t._s(t.leftFlowName)}}):t._e(),t._l(t.labelItems,function(e){return i("fi-workflow-menu-item",{key:e.funcMenuItemId,class:["fi-workflow-menu-item","label",e.itemAlign],attrs:{disabledType:t.menu.disabledType,menu:e,"exc-method":t.excMethod,type:"label"}})}),t._l(t.items,function(e,n){return[t.isHideMenu(e)?t._e():i("fi-workflow-menu-item",{key:e.funcMenuItemId,class:["fi-workflow-menu-item btn",{first:0===n},{last:!t.moreItems.length&&n===t.items.length-1}],attrs:{disabledType:t.menu.disabledType,menu:e,id:e.funcMenuItemId,"exc-method":t.excMethod}})]}),t.moreItems.length?i("fi-dropdown",{staticClass:"fi-workflow-menu-item__more"},[i("div",{staticClass:"fi-workflow-menu-item btn last"},[i("div",[t._v(t._s(t.t("workflow_menu.more")))])]),i("fi-dropdown-menu",{staticClass:"fi-workflow-menu-item__dropdown",attrs:{slot:"dropdown"},slot:"dropdown"},t._l(t.moreItems,function(e){return i("fi-dropdown-item",{key:e.funcMenuItemId},[t.isHideMenu(e)?t._e():i("fi-workflow-menu-item",{attrs:{menu:e,disabledType:t.menu.disabledType,id:e.funcMenuItemId,"exc-method":t.excMethod}})],1)}),1)],1):t._e()],2):t._e()},yi=[],wi=function(){var t=this,e=t.$createElement,i=t._self._c||e;return"label"===t.type?i("div",{domProps:{innerHTML:t._s(t.label)}}):i("div",{class:{"is-disabled":t.disabled},domProps:{innerHTML:t._s(t.itemLabel)},on:{click:t.excEvent}})},bi=[],xi={name:"FiWorkflowMenuItem",props:{type:{type:String,default:"item"},menu:{type:Object,default:function(){return{}}},excMethod:{type:Function},disabledType:String},computed:{label:function(){return this.menu.itemLabel||this.excMethod(this.menu)},itemLabel:function(){var t=this.menu.itemLabel;return/^(<div)[^>]*>[\s\S]*?<\/[^>]*(div>)$/.test(t)?t:'<div> <i class="'.concat(this.menu.ico,' icon"></i>').concat(t,"</div>")},disabled:function(){return"disabled"===this.disabledType&&"0BT"===this.menu.disabled}},methods:{excEvent:function(){this.disabled||this.excMethod(this.menu)}}},Ai=xi,Ci=At(Ai,wi,bi,!1,null,null,null),Ti=Ci.exports,ki={name:"FiWorkflowMenu",components:{FiWorkflowMenuItem:Ti},inject:{fiWorkflow:{default:""}},mixins:[Be.localeMixin],props:{menu:{type:Object,default:function(){return{}}},excMethod:{type:Function}},data:function(){return{labelItems:[],items:[],moreItems:[]}},computed:{receiveBtnActive:function(){return!![].concat(Ct(this.items),Ct(this.moreItems)).find(function(t){return"220010"===t.funcMenuItemId})},removeMenus:function(){return this.fiWorkflow&&this.fiWorkflow.removeMenus?this.fiWorkflow.removeMenus:[]},tchName:function(){return this.fiWorkflow.flowContext.flow&&this.fiWorkflow.flowContext.flow.tchName?'<span class="tch-name">('.concat(this.t("workflow_menu.tchName"),": ").concat(this.fiWorkflow.flowContext.flow&&this.fiWorkflow.flowContext.flow.tchName,")</span>"):""},leftFlowName:function(){return this.labelItems.some(function(t){return"220007"===t.funcMenuItemId})?"":'<div class="workflow-toolbar-text">\n              <span class="flow-name">'.concat(this.fiWorkflow.flowContext.form.formName,"</span>\n              ").concat(this.tchName,"\n            </div>")}},watch:{"menu.menuItem":{immediate:!0,handler:function(t){this.createMenu(t)}}},methods:{createMenu:function(t){if(t){var e=this.menu.maxShowNum||0===this.menu.maxShowNum?+this.menu.maxShowNum:3,i="hidden"===this.menu.disabledType,n=i?t.filter(function(t){return"0BF"===t.disabled}):t;this.labelItems=n.filter(function(t){return"label"===t.itemType});var o=n.filter(function(t){return"item"===t.itemType});e&&o.length>e?(this.items=o.splice(0,e),this.moreItems=o):this.items=o}},isHideMenu:function(t){return!("220001"!==t.funcMenuItemId||!this.receiveBtnActive||"C"===this.fiWorkflow.flowContext.flow.tchStatus)||("220010"===t.funcMenuItemId&&"C"===this.fiWorkflow.flowContext.flow.tchStatus||this.removeMenus.includes(t.funcMenuItemId))}}},Si=ki,Ei=At(Si,vi,yi,!1,null,null,null),Ii=Ei.exports;Ii.install=function(t){t.component(Ii.name,Ii)};var Li=Ii,Ri={name:"FiWorkflowBar",components:{FiWorkflowMenu:Li},props:{menu:{type:Object,default:function(){return{}}},excMethod:{type:Function}}},Pi=Ri,Oi=At(Pi,_i,mi,!1,null,null,null),Di=Oi.exports;Di.install=function(t){t.component(Di.name,Di)};var Mi=Di,Ni=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("fi-dialog",{ref:"fiDialog",staticClass:"fi-workflow-dialog",attrs:{top:"10px",visible:t.dialogVisible,fullscreen:t.tchData.dialogStyle&&t.tchData.dialogStyle.fullScreen,width:t.tchData.dialogStyle&&t.tchData.dialogStyle.width,"append-to-bodydialogStyle":"","close-on-click-modal":!1,"close-on-press-escape":!1,"before-close":t.beforeDialogClose,"modal-class":"fi-workflow-dialog-modal","lock-scroll":!1},on:{opened:t.onOpen,"update:visible":function(e){t.dialogVisible=e}}},[i("div",{staticClass:"fi-workflow-dialog__title",attrs:{slot:"title"},domProps:{innerHTML:t._s(t.tchData.turnTitle)},slot:"title"}),i("div",{staticClass:"fi-workflow-dialog__body"},[i("fi-workflow-exec-desc",{attrs:{content:t.tchData.execDesc}}),i("fi-form",{directives:[{name:"show",rawName:"v-show",value:t.hasAppend,expression:"hasAppend"}],ref:"fiAppendForm",staticClass:"fi-workflow-dialog-form",attrs:{id:"fiAppendForm",model:t.fiWorkflow.formContext.model,"label-width":t.fiWorkflow.labelWidth,rules:t.rules,"fi-attrs":t.fiWorkflow.formContext.attrs,append:t.fiWorkflow.formContext.append}},[t._t("default")],2),t.tchData.opinionConfig&&t.tchData.opinionConfig.display?i("fi-workflow-flow-opinion",{ref:"opinionRef",attrs:{isEnd:t.isEndTask,config:t.tchData.opinionCfg,list:t.tchData.opinionConfig&&t.tchData.opinionConfig.list,required:t.tchData.opinionConfig&&t.tchData.opinionConfig.required},model:{value:t.opinion,callback:function(e){t.opinion=e},expression:"opinion"}}):t._e(),i("fi-workflow-tch-panel",{attrs:{selected:t.nextTchSelected,"tch-data":t.tchData},on:{"update:selected":function(e){t.nextTchSelected=e}}}),i("div",{staticClass:"fi-workflow-dialog__attach"},[t.tchData.dialogStyle&&t.tchData.dialogStyle.showAttach?i("fi-workflow-upload",{attrs:{flow:""},model:{value:t.attaches,callback:function(e){t.attaches=e},expression:"attaches"}}):t._e()],1)],1),i("div",{staticClass:"fi-workflow-dialog__footer",attrs:{slot:"footer"},slot:"footer"},[i("fi-button",{attrs:{plain:"",disabled:t.isSubmitting},on:{click:t.dialogClose}},[t._v("\n      "+t._s(t.t("workflow_dialog.return_form"))+"\n    ")]),i("fi-button",{attrs:{type:"primary",loading:t.isSubmitting},on:{click:t.onSubmitBtnClick}},[t._v("\n      "+t._s(t.t("workflow_dialog.submit"))+"\n    ")])],1)])},Bi=[],Fi=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"fi-workflow-tch-panel"},[[!t.tchData.isRelateTchClosed||t.mutex?i("fi-collapse-card",{attrs:{shadow:"never",border:!1,hide:t.mutexHide}},[i("template",{slot:"header"},[i("div",{staticClass:"fi-workflow-tch-panel__radio-header"},[i("span",{staticClass:"fi-workflow-tch-panel__radio-header-text"},[t._v(t._s(t.t("workflow_tch_panel.next_tache")))]),i("fi-radio-group",{staticClass:"fi-workflow-tch-panel__radio-header-selector",model:{value:t.tchSelected[0],callback:function(e){t.$set(t.tchSelected,0,e)},expression:"tchSelected[0]"}},t._l(t.tchData.nextTchs,function(e){return i("fi-radio",{key:e.tchMod,staticClass:"fi-workflow-tch-panel__radio",attrs:{border:"",label:e},nativeOn:{change:function(i){return t.getInfo(e)}}},[t._v(t._s(e.endTask?t.tchData.endTaskTitle:e.displayTchName))])}),1)],1)]),t._l(t.tchData.nextTchs,function(e){return[e.endTask?t._e():i("fi-workflow-tch-selector",{directives:[{name:"show",rawName:"v-show",value:t.tchSelected.length&&t.tchSelected[0].tchMod===e.tchMod,expression:"tchSelected.length\n                                      && tchSelected[0].tchMod === tch.tchMod"}],key:e.tchMod,attrs:{tchData:t.tchData,tchInfo:e}})]})],2):i("fi-checkbox-group",{model:{value:t.tchSelected,callback:function(e){t.tchSelected=e},expression:"tchSelected"}},[t._l(t.tchData.nextTchs,function(e){return[i("fi-collapse-card",{key:e.tchMod,attrs:{shadow:"never",border:!1,hide:!t.selectedTchMod.includes(e.tchMod)}},[i("template",{slot:"header"},[i("span",{staticClass:"fi-workflow-tch-panel__checkbox-header"},[t._v(t._s(t.t("workflow_tch_panel.next_tache")))]),i("fi-checkbox",{staticClass:"fi-workflow-tch-panel__checkbox",attrs:{border:"",label:e},on:{change:t.onCheckboxChange},nativeOn:{change:function(i){return t.getInfo(e)}}},[t._v("\n                "+t._s(e.displayTchName)+"\n              ")])],1),i("fi-workflow-tch-selector",{key:e.tchMod,attrs:{tchInfo:e,tchData:t.tchData}})],2)]})],2)]],2)},zi=[],Vi=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"fi-workflow-tch-selector"},[t.tchInfo.notEnd&&!t.isMultiMerge?i("fi-workflow-tch-selector-item",{attrs:{label:t.t("workflow_tch_selector.executer"),oftenType:"1","custom-notify":"",tchMod:t.tchInfo.tchMod,config:t.tchInfo.operator,ready:t.operatorReady},model:{value:t.tchInfo.operator.value,callback:function(e){t.$set(t.tchInfo.operator,"value",e)},expression:"tchInfo.operator.value"}}):t._l(t.tchInfo.multiInstOperator,function(e,n){return i("div",{key:n,staticClass:"fi-workflow-tch-selector_operator"},[i("fi-workflow-tch-selector-item",{attrs:{label:t.t("workflow_tch_selector.executer"),oftenType:"1","custom-notify":"",tchMod:t.tchInfo.tchMod,"is-multi-merge":t.isMultiMerge,config:e,ready:t.operatorReady},model:{value:e.value,callback:function(i){t.$set(e,"value",i)},expression:"item.value"}},[t.isMultiMerge?i("fi-button",{staticClass:"fi-workflow-tch-selector_btn",attrs:{slot:"btn",icon:0===n?"el-icon-plus":"el-icon-delete",circle:""},on:{click:function(e){return t.dealMultiMerge(n)}},slot:"btn"}):t._e()],1)],1)}),i("fi-workflow-tch-selector-item",{attrs:{label:t.t("workflow_tch_selector.notify_staff"),config:t.tchInfo.cc,tchMod:t.tchInfo.tchMod,oftenType:"2",ready:t.cCReady},model:{value:t.tchInfo.cc.value,callback:function(e){t.$set(t.tchInfo.cc,"value",e)},expression:"tchInfo.cc.value"}})],2)},Ui=[],ji=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"fi-workflow-tch-selector-item"},[i("div",{staticClass:"fi-workflow-tch-selector-item__row",staticStyle:{"padding-bottom":"7px"}},[i("div",{staticClass:"fi-workflow-tch-selector-item__col label-col",style:{width:t.$i18n&&"en"===t.$i18n.locale?"130px":"70px"}},[t._v(t._s(t.label)+"["+t._s(t.staffValue.length)+"]")]),i("div",{staticClass:"fi-workflow-tch-selector-item__col grow2"},[t.ready?i("fi-workflow-staff-picker",{ref:"staffPickerRef",style:{width:t.isMultiMerge?"90%":"100%"},attrs:{multiple:"",disabled:!t.config.staffCfg.canChange,config:t.config.staffCfg},on:{"remove-tag":t.staffRemoveTag},model:{value:t.value.staff,callback:function(e){t.$set(t.value,"staff",e)},expression:"value.staff"}}):t._e(),t._t("btn")],2)]),i("div",{staticClass:"fi-workflow-tch-selector-item__row small"},[t.candidateShow?[i("div",{staticClass:"fi-workflow-tch-selector-item__col label-col second_label",class:[t.$i18n&&"en"===t.$i18n.locale?"candidate_label_en":"candidate_label_zh"]},[t._v(t._s(t.config.staffCfg.candidateLabel)+"：")]),i("div",{staticClass:"fi-workflow-tch-selector-item__col fi-workflow-tch-selector-item__w100"},[i("fi-work-flow-candidate",{staticClass:"fi-workflow-tch-selector-item__w100",staticStyle:{width:"100%"},attrs:{disabled:t.config.staffCfg.candidateEditDisabled,closable:""},on:{"show-num":t.showNum,"click-tag":t.onCandidateClick,"remove-tag":t.deleteCandidate},model:{value:t.realCandidateValue,callback:function(e){t.realCandidateValue=e},expression:"realCandidateValue"}},[t.config.staffCfg.candidate.length>t.showCount?i("fi-tag",{class:[{"fi-workflow-tch-selector-item__more-btn":t.showMore},{"fi-workflow-tch-selector-item__hide-btn":!t.showMore},{"label-tag":!t.config.staffCfg.candidate.length}],nativeOn:{click:function(e){return t.showMoreCandidate(e)}}},[t._v(t._s(t.showMore?t.t("workflow_tch_selector_item.more"):t.t("workflow_tch_selector_item.packUp")))]):t._e()],1)],1)]:t._e()],2),i("div",{staticClass:"fi-workflow-tch-selector-item__row small"},[t.countersignCfgShow?[i("div",{staticClass:"fi-workflow-tch-selector-item__col label-col second_label",style:{width:t.$i18n&&"en"===t.$i18n.locale?"330px":"70px",marginLeft:t.$i18n&&"en"===t.$i18n.locale?"12px":""},attrs:{title:t.$i18n&&"en"===t.$i18n.locale?t.config.countersignCfg.title.textus:t.config.countersignCfg.title.text}},[t._v("\n        "+t._s(t.$i18n&&"en"===t.$i18n.locale?t.config.countersignCfg.title.textus:t.config.countersignCfg.title.text)+"\n      ")]),i("div",{staticClass:"fi-workflow-tch-selector-item__col",style:{marginLeft:t.$i18n&&"en"===t.$i18n.locale?"5px":"",width:"60%"}},[t.config.countersignCfg.parallel.display?i("fi-checkbox",{attrs:{"true-label":"parallel","false-label":"",group:!1},model:{value:t.value.countersignValue,callback:function(e){t.$set(t.value,"countersignValue",e)},expression:"value.countersignValue"}},[t._v(t._s(t.$i18n&&"en"===t.$i18n.locale?t.config.countersignCfg.parallel.textus:t.config.countersignCfg.parallel.text))]):t._e(),t.config.countersignCfg.serial.display?i("fi-checkbox",{attrs:{"true-label":"serial","false-label":"",group:!1},model:{value:t.value.countersignValue,callback:function(e){t.$set(t.value,"countersignValue",e)},expression:"value.countersignValue"}},[t._v(t._s(t.$i18n&&"en"===t.$i18n.locale?t.config.countersignCfg.serial.textus:t.config.countersignCfg.serial.text))]):t._e()],1)]:t._e(),t.config.noticeCfg.display?[i("div",{staticStyle:{display:"flex"}},[i("div",{staticClass:"fi-workflow-tch-selector-item__col label-col second_label",style:{marginLeft:t.$i18n&&"en"===t.$i18n.locale?"70px":"80px"}},[t._v(t._s(t.t("workflow_tch_selector_item.remind_type")))]),i("div",{staticClass:"fi-workflow-tch-selector-item__col custom-notify"},[t.config.noticeCfg.mail.display?i("fi-checkbox",{attrs:{"true-label":"1","false-label":"0",disabled:t.config.noticeCfg.mail.disabled,group:!1},model:{value:t.value.sendMail,callback:function(e){t.$set(t.value,"sendMail",e)},expression:"value.sendMail"}},[t._v(t._s(t.t("workflow_tch_selector_item.email")))]):t._e(),t.config.noticeCfg.sms.display?i("fi-checkbox",{attrs:{"true-label":"1","false-label":"0",disabled:t.config.noticeCfg.sms.disabled,group:!1},model:{value:t.value.sendSms,callback:function(e){t.$set(t.value,"sendSms",e)},expression:"value.sendSms"}},[t._v(t._s(t.t("workflow_tch_selector_item.sms")))]):t._e(),t.customNotify&&t.config.noticeCfg.sms.display&&t.config.noticeCfg.sms.isShowCustomSms?[i("fi-switch",{staticClass:"custom-notify__switch",attrs:{type:"inside","active-text":t.t("workflow_tch_selector_item.switch_on"),"inactive-text":t.t("workflow_tch_selector_item.switch_off")},on:{change:t.isCustomNotifyChange},model:{value:t.config.noticeCfg.isCustomNotify,callback:function(e){t.$set(t.config.noticeCfg,"isCustomNotify",e)},expression:"config.noticeCfg.isCustomNotify"}}),i("fi-input",{directives:[{name:"show",rawName:"v-show",value:t.config.noticeCfg.isCustomNotify,expression:"config.noticeCfg.isCustomNotify"}],staticClass:"custom-notify__input",attrs:{placeholder:t.notifyPlaceholder,maxlength:140},model:{value:t.value.notifyContent,callback:function(e){t.$set(t.value,"notifyContent",e)},expression:"value.notifyContent"}})]:t._e()],2)])]:t._e()],2)])},Hi=[],Wi=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{ref:"candidate",staticClass:"fi-workflow-candidate"},[t.closable&&!t.disabled?[t._l(t.value,function(e,n){return[i("fi-popover",{key:n,staticClass:"fi-workflow-candidate__popover",attrs:{placement:"top",width:"160",trigger:"manual","blur-hide":""},model:{value:t.visibleMap[e.staffId],callback:function(i){t.$set(t.visibleMap,e.staffId,i)},expression:"visibleMap[item.staffId]"}},[i("p",[t._v(t._s(t.t("workflow_candidate.confirm_delete")))]),i("div",{staticStyle:{"text-align":"right",margin:"0"}},[i("fi-button",{attrs:{size:"mini",type:"text"},on:{click:function(i){t.visibleMap[e.staffId]=!1}}},[t._v(t._s(t.t("workflow_candidate.cancel")))]),i("fi-button",{attrs:{type:"primary",size:"mini"},on:{click:function(i){return t.removeCandidate(i,e)}}},[t._v(t._s(t.t("workflow_candidate.confirm")))])],1),i("fi-tag",t._b({key:n,attrs:{slot:"reference",type:e.type||t.type,closable:!0,title:e.staffName},on:{close:function(i){t.visibleMap[e.staffId]=!0}},nativeOn:{click:function(i){return t.$emit("click-tag",e)}},slot:"reference"},"fi-tag",t.$attrs,!1),[i("span",{staticClass:"tag",class:{"tag-en":t.$i18n&&"en"===t.$i18n.locale}},[t._v(t._s(e.staffName))])])],1)]}),t._t("default")]:[t._l(t.value,function(e,n){return i("fi-tag",t._b({key:n,attrs:{title:e.staffName,type:e.type||t.type},nativeOn:{click:function(i){return t.$emit("click-tag",e)}}},"fi-tag",t.$attrs,!1),[i("span",{staticClass:"tag",class:{"tag-en":t.$i18n&&"en"===t.$i18n.locale}},[t._v(t._s(e.staffName))])])}),t._t("default")]],2)},Gi=[],Zi={inheritAttrs:!1,name:"FiWorkFlowCandidate",mixins:[Be.localeMixin],props:{value:{type:Array,default:function(){return[]}},type:{type:String,default:"info"},closable:Boolean,disabled:Boolean},data:function(){return{visibleMap:[],candidateWidth:null}},watch:{value:{immediate:!0,handler:function(t){var e={};t.forEach(function(t){e[t.staffId]=!1}),this.visibleMap=e}}},mounted:function(){this.candidateWidth=this.$refs.candidate.clientWidth;var t=this.$i18n&&"en"===this.$i18n.locale?140:68;this.$emit("show-num",this.candidateWidth/t)},methods:{hidePopover:function(t){this.visibleMap[t.staffId]=!1},removeCandidate:function(t,e){this.hidePopover(e);var i=this.value.indexOf(e);if(i>-1&&!this.disabled){var n=this.value.slice();n.splice(i,1),this.$emit("input",n),this.$emit("remove-tag",e)}t.stopPropagation()}}},Xi=Zi,Yi=At(Xi,Wi,Gi,!1,null,null,null),$i=Yi.exports,qi=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("fi-select",{ref:"select",class:["fi-workflow-staff-picker",{"fi-workflow-staff-picker--multiple":t.multiple},{"is-no-filterable":!t.isFilter}],attrs:{multiple:t.multiple,disabled:"0BT"===t.config.defaultStaffDisabled,placeholder:t.completePlaceholder,"remote-method":t.searchStaff,"popper-class":"fi-workflow-staff-picker__dropdown","value-key":"staffId","label-key":"staffName",clearable:"",filterable:t.isFilter,"reserve-keyword":"",remote:t.isRemote,"default-first-option":"",size:"medium"},on:{"remove-tag":t.removeTag},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.blur(e)}},model:{value:t.staff,callback:function(e){t.staff=e},expression:"staff"}},[t._l(t.list,function(e){return i("fi-option",{key:e.ID,attrs:{value:e.value,label:e.value.staffName},nativeOn:{click:function(e){return t.blur(e)}}},[i("fi-popover",{attrs:{placement:"bottom-end",trigger:"hover"}},[i("ul",{staticClass:"fi-workflow-staff-picker__option-list"},[i("li",[i("label",[t._v(t._s(e.value.staffName))]),i("span",[t._v(t._s(e.value.mobile))])]),i("li",[i("label",[t._v(t._s(t.t("workflow_staff_pick.region_name")))]),i("span",[t._v(t._s(e.value.regionName))])]),i("li",[i("label",[t._v(t._s(t.t("workflow_staff_pick.org_name")))]),i("span",[t._v(t._s(e.value.orgName))])]),e.value&&e.value.email?i("li",[i("label",[t._v(t._s(t.t("workflow_staff_pick.email")))]),i("span",[t._v(t._s(e.value.email))])]):t._e()]),i("div",{staticClass:"fi-workflow-staff-picker__option",style:{width:t.width},attrs:{slot:"reference"},slot:"reference"},[i("div",{staticClass:"fi-workflow-staff-picker__option__item",domProps:{innerHTML:t._s(e.STAFF_NAME_HTML)}}),i("div",{staticClass:"fi-workflow-staff-picker__option__item is-over-hidden",domProps:{innerHTML:t._s(e.ORG_NAME_HTML)}}),i("div",{staticClass:"fi-workflow-staff-picker__option__item",domProps:{innerHTML:t._s(e.ORG_NAME_HTML2)}}),i("div",{directives:[{name:"show",rawName:"v-show",value:e.MOBILE_HTML,expression:"item.MOBILE_HTML"}],staticClass:"fi-workflow-staff-picker__option__item",domProps:{innerHTML:t._s(e.MOBILE_HTML)}}),i("div",{directives:[{name:"show",rawName:"v-show",value:e.EMAIL_HTML,expression:"item.EMAIL_HTML"}],staticClass:"fi-workflow-staff-picker__option__item",domProps:{innerHTML:t._s(e.EMAIL_HTML)}})])])],1)}),i("span",{class:["fi-workflow-staff-picker__icon",{"is-disabled":t.completeDisabled}],attrs:{slot:"prefix"},on:{click:function(e){return e.stopPropagation(),t.pickerStaff()}},slot:"prefix"},[i("i",{staticClass:"fi fi-user-add"})]),i("div",{staticClass:"fi-workflow-staff-picker__append",attrs:{slot:"append"},slot:"append"},[t.list.length&&t.totalItem>1?i("fi-pagination",{staticClass:"fi-workflow-staff-picker__append__pagination",attrs:{small:"","current-page":t.currentPage,"page-size":10,layout:"prev, pager, next, jumper",total:t.totalItem},on:{"current-change":t.handleCurrentChange,"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e}}}):t._e()],1)],2)},Ki=[],Ji=i("2166"),Qi=function(t){return new Ji.StaffSelectAddonExtends(t)},tn={null:"ALL","":"ALL",2:"ORG",7:"ORG",4:"DUTY_LINE",3:"TEAM"},en={name:"FiWorkflowStaffPicker",inject:{elForm:{default:""},fiFormItem:{default:""}},mixins:[Be.localeMixin],props:{multiple:Boolean,filterable:{type:Boolean,default:!1},value:{required:!0},disabled:Boolean,placeholder:{type:String,default:""},pickerClick:Function,config:{type:Object,default:function(){return{init:!0,canChange:!0}}}},data:function(){return{currentPage:1,totalItem:0,list:[],key:"",loading:!1}},computed:{completeDisabled:function(){return!this.config.canChange||this.disabled||(this.fiFormItem||{}).disabled||(this.elForm||{}).disabled},completePlaceholder:function(){return this.completeDisabled?"":this.placeHolder},staff:{get:function(){return this.value},set:function(t){this.$emit("input",t)}},searchType:function(){var t=this.config.staffCreateType;return tn[t]||"STAFF"},organizationConfig:function(){if(this.config.init)return{};var t=null,e=!1;return this.config.rootOrgCanChange?(t=this.config.beginOrgId?"".concat(this.config.beginOrgId):null,e=!t):(t=this.config.orgId?"".concat(this.config.orgId):null,e=!1),{startPathIds:t,selectedOrgID:this.config.orgId,isTop:e,hidden:["TEAM","DUTY_LINE"].includes(this.searchType)}},dutyLineConfig:function(){if(this.config.init)return{};var t=null,e=!1;return this.config.rootOrgCanChange?(t=this.config.beginOrgId?"".concat(this.config.beginOrgId):null,e=!t):(t=this.config.orgId?"".concat(this.config.orgId):null,e=!1),"DUTY_LINE"===this.searchType?{startPathIds:t,selectedOrgID:this.config.orgId,isTop:e}:{hidden:!0}},projectdConfig:function(){if(this.config.init)return{};if("TEAM"===this.searchType||"ALL"===this.searchType){var t=null,e=!1;return this.config.rootOrgCanChange?(t=this.config.beginOrgId?"".concat(this.config.beginOrgId):null,e=!t):(t=this.config.orgId?"".concat(this.config.orgId):null,e=!1),{startPathIds:t,selectedOrgID:this.config.orgId,isTop:e,hidden:!1}}return{startPathIds:null,selectedOrgID:null,isTop:!0,hidden:"STAFF"!==this.searchType}},offsetWidth:function(){return this.$el.offsetWidth},width:function(){return this.offsetWidth?"".concat(this.offsetWidth<=0?"100":this.$el.offsetWidth-40,"px"):"auto"},placeHolder:function(){return this.placeholder||this.t("workflow_staff_pick.placeholder")},isRemote:function(){return this.config.canChange},isFilter:function(){return this.filterable||this.config.canChange}},watch:{value:{immediate:!0,handler:function(t){this.$emit("change",t)}}},methods:{handleCurrentChange:function(t){this.searchStaff(this.key,t)},searchStaff:function(t,e){var i=this;if(this.key=t,this.loading=!0,this.currentPage=e||1,!t)return this.list=[],void(this.totalItem=0);var n=null,o=!1;this.config.rootOrgCanChange?(n=this.config.beginOrgId?"".concat(this.config.beginOrgId):null,o=!n):(n=this.config.orgId?"".concat(this.config.orgId):null,o=!1);m({searchKey:t,startIndex:this.currentPage-1,searchType:"STAFF",entityType:"STAFF",searchConfig:{organization:function(){return i.config.init?{}:["ALL","ORG"].includes(i.searchType)?{startPathIds:n,selectedOrgID:i.config.orgId,isTop:o,hidden:["TEAM","DUTY_LINE"].includes(i.searchType)}:{isTop:o,hidden:!0}}(),dutyLine:function(){return i.config.init?{}:"DUTY_LINE"===i.searchType?{startPathIds:n,selectedOrgID:i.config.orgId,isTop:o,hidden:!1}:{isTop:o,hidden:!0}}(),project:function(){return i.config.init?{}:"TEAM"===i.searchType?{startPathIds:n,selectedOrgID:i.config.orgId,isTop:o,hidden:!1}:{isTop:o,hidden:!0}}(),projectDefined:{isTop:this.config.rootOrgCanChange},filter:this.config.filter||null,filterStaffWhere:this.config.filterStaffWhere||null}}).then(function(e){i.loading=!1,i.totalItem=e.totalItem,i.list=e.items.map(function(e){var i={};Object.keys(e).forEach(function(t){i[Object(Xe.f)(t)]=e[t]}),i.staffId="".concat(i.staffId);var n={value:i},o=(e.ORG_NAME||"").split("<-"),r=o.length>1?"<-".concat(o.pop()):"",a=o[0]?o.join("<-"):"";return n.STAFF_NAME_HTML=(e.STAFF_NAME||"").replace(new RegExp(t,"g"),'<span class="light">'.concat(t,"</span>")),n.ORG_NAME_HTML="(".concat(a.replace(new RegExp(t,"g"),'<span class="light">'.concat(t,"</span>"))),n.ORG_NAME_HTML2="".concat(r.replace(new RegExp(t,"g"),'<span class="light">'.concat(t,"</span>")),")"),n.MOBILE_HTML=(e.MOBILE||"").replace(new RegExp(t,"g"),'<span class="light">'.concat(t,"</span>")),n.EMAIL_HTML=(e.EMAIL||"").replace(new RegExp(t,"g"),'<span class="light">'.concat(t,"</span>")),n})}).catch(function(){i.loading=!1})},removeTag:function(t){this.$emit("remove-tag",t)},pickerStaff:function(){this.$refs.select.blur(),this.pickerClick&&"function"==typeof this.pickerClick&&!this.pickerClick(this.pickerStaff)||this.completeDisabled||this.selectStaff()},selectStaff:function(){if(this.config.canChange){var t={multiple:this.multiple,confirmCallBack:this.staffSelectCallBack},e=Qi(t),i=[];this.multiple?i=this.staff.map(function(t){return{STAFF_ID:t.staffId,STAFF_NAME:t.staffName}}):this.staff&&(i=[{STAFF_ID:this.staff.staffId,STAFF_NAME:this.staff.staffName}]),e.setPersons(i),e.setChoiceSourceTreeConfig({organization:this.organizationConfig,dutyLine:this.dutyLineConfig,project:this.projectdConfig,filter:this.config.filter||null,filterStaffWhere:this.config.filterStaffWhere||null,additionSearch:this.additionSearch||null}),e.show()}},staffSelectCallBack:function(t){if(this.multiple){var e,i=t.map(function(t){return{staffId:"".concat(t.STAFF_ID),staffName:t.STAFF_NAME,orgId:t.SELF_ORG_ID}});(e=this.staff).splice.apply(e,[0,this.staff.length].concat(Lt(i)))}else this.staff=t?{staffId:"".concat(t.STAFF_ID),staffName:t.STAFF_NAME,orgId:t.SELF_ORG_ID}:{}},blur:function(){var t=this;this.$refs.select.blur(),this.list=[],this.multiple&&this.$nextTick(function(){t.$refs.select.focus()})}}},nn=en,on=At(nn,qi,Ki,!1,null,null,null),rn=on.exports,an={name:"FiWorkflowTchSelectorItem",components:{FiWorkFlowCandidate:$i,FiWorkflowStaffPicker:rn},inject:["fiWorkflow"],mixins:[Be.localeMixin],props:{label:String,oftenType:String,value:{type:Object,required:!0},tchMod:[String,Number],config:{type:Object,default:function(){return{}}},ready:Boolean,customNotify:Boolean,isMultiMerge:Boolean},data:function(){return{notifyPlaceholder:this.t("workflow_tch_selector_item.notifyPlaceholder"),candidateWidth:null,showCount:0,showMore:!1}},computed:{size:function(){return this.$ELEMENT.size},staffValue:function(){return this.value.staff},candidateShow:function(){var t=this.config.staffCfg,e=t.candidateIsShow,i=t.candidate;return e&&i.length},countersignCfgShow:function(){var t=this.config.countersignCfg;return t&&t.title.display&&(t.serial.display||t.parallel.display)},realCandidateValue:{get:function(){return this.showMore?this.config.staffCfg.candidate.slice(1,this.showCount):this.config.staffCfg.candidate},set:function(t){this.config.staffCfg.candidate=t}}},watch:{staffValue:{immediate:!0,handler:function(t){var e=this,i=this.config.staffCfg.candidate;i.length&&i.forEach(function(i){var n=t.find(function(t){return t.staffId===i.staffId});n&&"primary"!==n.type&&e.$set(i,"type","primary"),n||"primary"!==i.type||e.$set(i,"type","info")})}}},methods:{staffRemoveTag:function(t){this.config.staffCfg.canChange||this.config.staffCfg.candidate.find(function(e){return e.staffId===t.staffId})||this.config.staffCfg.candidate.push(t)},onCandidateClick:function(t){var e=this.staffValue.findIndex(function(e){return e.staffId===t.staffId||e.staffId.split(",").includes(t.staffId)});e>-1?this.$delete(this.value.staff,e):this.value.staff.push(Object.assign({},t))},deleteCandidate:function(t){var e=this,i={oftenStaffIds:t.staffId,oftenType:this.oftenType,tchMod:this.tchMod};return Object(Ze.j)(i).then(function(){e.$message({showClose:!0,message:e.t("workflow_tch_selector_item.delete_success"),type:"success"})})},selectStaff:function(){this.$refs.staffPickerRef.selectStaff()},isCustomNotifyChange:function(t){t&&(this.value.sendSms="1"),t||(this.value.notifyContent="")},showMoreCandidate:function(){this.showMore=!this.showMore},showNum:function(t){this.showCount=Math.floor(2*t),this.showMore=this.config.staffCfg.candidate.length>Math.floor(2*t)}}},sn=an,ln=At(sn,ji,Hi,!1,null,null,null),hn=ln.exports;hn.install=function(t){t.component(hn.name,hn)};var cn=hn,un={name:"FiWorkflowTchSelector",components:{FiWorkflowTchSelectorItem:cn},mixins:[Be.localeMixin],props:{tchInfo:{type:Object,required:!0},tchData:Object},computed:{operatorReady:function(){return this.tchData.nextTchReady&&(this.tchData.nextTchReady.all||this.tchData.nextTchReady.operator)},cCReady:function(){return this.tchData.nextTchReady&&(this.tchData.nextTchReady.all||this.tchData.nextTchReady.cc)},isMultiMerge:function(){return"1"===this.tchInfo.info.multiInstMerge&&"1"===this.tchInfo.info.multiInst}},data:function(){return{operator:{staffCfg:{candidate:[],canChange:!0,candidateLabel:void 0,candidateEditDisabled:!1,realStaff:void 0},noticeCfg:{display:!0,isCustomNotify:!1,sms:{display:!0,disabled:!1},mail:{display:!0,disabled:!1}},countersignCfg:{title:{display:!1},serial:{display:!1},parallel:{display:!1}},value:{staff:[],sendMail:"0",sendSms:"0",countersignValue:void 0,notifyContent:""}}}},methods:{dealMultiMerge:function(t){0===t?this.tchInfo.multiInstOperator.push(this.operator):this.tchInfo.multiInstOperator.splice(t,1)}}},dn=un,fn=At(dn,Vi,Ui,!1,null,null,null),pn=fn.exports;pn.install=function(t){t.component(pn.name,pn)};var gn=pn,_n={name:"FiWorkflowTchPanel",inject:["getGlobal"],components:{FiWorkflowTchSelector:gn},mixins:[Be.localeMixin],props:{selected:{type:Array,required:!0,default:function(){return[]}},tchData:{type:Object,required:!0}},data:function(){return{isMutexHide:!1,endTask:{endTask:!0,tchMod:"endTask"}}},computed:{mutex:function(){return!!this.tchData.nextTchs&&(!(!Array.isArray(this.tchData.nextTchs)||1!==this.tchData.nextTchs.length)||ci(this.tchData.nextTchs))},mutexHide:function(){return!this.selectedTchMod.length&&this.isMutexHide},selectedTchMod:function(){return this.selected.map(function(t){return t.tchMod})},tchSelected:{get:function(){return this.selected},set:function(t){this.$emit("update:selected",t)}}},methods:{onCheckboxChange:function(t,e,i){if(t&&!(this.selected.length<1)){var n=Nt(this.selected);n.forEach(function(t,e){ci([t,i])&&(n[e]=void 0)}),n=n.filter(Boolean),n.length!==this.selected.length&&(n.push(i),this.$emit("update:selected",n))}},getInfo:function(t){if(t.loaded||t.endTask)return void(this.isMutexHide=!1);var e=this.getGlobal();e.nextItemTchMod=t.tchMod,$(this.tchData.nextTchMods.find(function(e){return e.tchMod===t.tchMod}),t,e,this.tchData),this.isMutexHide=!1}}},mn=_n,vn=At(mn,Fi,zi,!1,null,null,null),yn=vn.exports;yn.install=function(t){t.component(yn.name,yn)};var wn=yn,bn=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("fi-collapse-card",{attrs:{border:!1,shadow:"never"}},[i("template",{slot:"header"},[i("span",{class:{"fi-is-required":t.required}},[t._v(t._s(t.leftText))]),!t.isEnd&&t.config.display?i("fi-radio-group",{staticClass:"fi-workflow-flow-opinion__status",on:{change:t.refreshNextTchData},model:{value:t.opinionStatus,callback:function(e){t.opinionStatus=e},expression:"opinionStatus"}},t._l(t.config.items,function(e,n){return i("fi-radio",{key:n,staticClass:"fi-workflow-flow-opinion__radio",attrs:{label:e.value,border:""}},[t._v("\n        "+t._s(e.text)+"\n      ")])}),1):t._e()],1),i("div",{staticClass:"fi-workflow-flow-opinion",attrs:{gutter:20}},[i("div",{staticClass:"fi-workflow-flow-opinion__col",attrs:{span:12}},[i("fi-form",{ref:"opinionForm",attrs:{model:t.form}},[i("fi-form-item",{attrs:{rules:t.rules,prop:"content"}},[i("fi-input",{staticClass:"fi-workflow-flow-opinion__textarea",attrs:{type:"textarea",placeholder:t.placeHolder,disabled:t.disabled},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}})],1)],1),i("fi-button",{staticClass:"fi-workflow-flow-opinion__save-btn",attrs:{plain:""},on:{click:t.doSave}},[t._v(t._s(t.t("workflow_flow_opinion.save_as_common_opinion")))])],1),i("div",{staticClass:"fi-workflow-flow-opinion__col",attrs:{span:12}},[i("div",{staticClass:"fi-workflow-flow-opinion__often-shell"},[i("span",[t._v(t._s(t.t("workflow_flow_opinion.common_opinion")))]),i("div",{staticClass:"fi-workflow-flow-opinion__set-btn",on:{click:t.openOpinionConsole}},[i("i",{staticClass:"fi fi-setting"}),i("span",{staticClass:"fi-workflow-flow-opinion__set-btn__text"},[t._v(t._s(t.t("workflow_flow_opinion.manager_opinion")))])])]),i("ul",{staticClass:"fi-workflow-flow-opinion__list"},t._l(t.opinionList,function(e,n){return i("li",{key:n,staticClass:"fi-workflow-flow-opinion__list__item",attrs:{title:e[t.labelKey],type:"text"}},[i("a",{staticClass:"fi-workflow-flow-opinion__list__item__a",attrs:{href:"javascript:void(0)"},on:{click:function(i){return t.onSelect(e[t.labelKey])}}},[t._v("\n            "+t._s(e[t.labelKey])+"\n          ")])])}),0)]),t.loadingConsole?i("fi-workflow-opinion-console",{attrs:{visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e},close:t.refresh}}):t._e()],1)],2)},xn=[],An=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("fi-dialog",{staticClass:"fi-workflow-opinion-console",attrs:{top:"20px",title:t.t("workflow_opinion_console.title"),visible:t.dialogVisible,width:"880px","lock-scroll":!1,"append-to-body":""},on:{"update:visible":function(e){t.dialogVisible=e},close:t.closeDialog}},[i("fi-row",[i("div",{staticClass:"fi-workflow-opinion-console__col fi-workflow-opinion-console__col--list"},[i("div",{staticClass:"fi-workflow-opinion-console__header is-center"},[t._v(t._s(t.t("workflow_opinion_console.header")))]),i("div",{staticClass:"fi-workflow-opinion-console__body"},[i("ul",{staticClass:"fi-workflow-opinion-console__list"},t._l(t.typeList,function(e,n){return i("li",{key:n,staticClass:"fi-workflow-opinion-console__list__item",class:{"is-active":t.active.opinionType===e.opinionType}},[i("fi-button",{staticClass:"fi-workflow-opinion-console__list__item__btn",attrs:{type:"text"},on:{click:function(i){return t.onTypeClick(e)}}},[i("i",{staticClass:"fi-workflow-opinion-console__list__item__btn__icon\n            fa fa-sitemap"}),i("span",{staticClass:"fi-workflow-opinion-console__list__item__btn__icon",staticStyle:{display:"inline-block","margin-left":"5px"}},[t._v(t._s(e.opinionTypeName))])])],1)}),0)])]),i("div",{staticClass:"fi-workflow-opinion-console__col fi-workflow-opinion-console__col--table"},[i("div",{staticClass:"fi-workflow-opinion-console__header"},[i("fi-button",{attrs:{icon:"el-icon-plus",type:"primary",size:"mini"},on:{click:t.addItem}},[t._v("\n          "+t._s(t.t("workflow_opinion_console.add"))+"\n        ")]),i("fi-button",{attrs:{icon:"el-icon-close",size:"mini",type:"primary",plain:"",disabled:!t.currentRow},on:{click:t.delOpinion}},[t._v("\n          "+t._s(t.t("workflow_opinion_console.delete"))+"\n        ")]),i("fi-button",{attrs:{icon:"el-icon-refresh",size:"mini",type:"primary",plain:""},on:{click:t.refreshData}},[t._v("\n          "+t._s(t.t("workflow_opinion_console.refresh"))+"\n        ")]),i("fi-button",{directives:[{name:"show",rawName:"v-show",value:t.showSaveBtn,expression:"showSaveBtn"}],attrs:{type:"success",icon:"el-icon-check",size:"mini"},on:{click:t.saveModify}},[t._v("\n          "+t._s(t.t("workflow_opinion_console.save"))+"\n        ")])],1),i("div",{staticClass:"fi-workflow-opinion-console__body"},[i("fi-table",{staticStyle:{width:"100%"},attrs:{"max-height":"360",data:t.model,"highlight-current-row":""},on:{"current-change":t.handleCurrentChange}},[i("fi-table-column",{attrs:{type:"index",width:"50"}}),i("fi-table-column",{attrs:{prop:"opinionContent",label:t.t("workflow_opinion_console.common_opinion")},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[i("div",{directives:[{name:"show",rawName:"v-show",value:n.error,expression:"row.error"}],staticClass:"fi-workflow-opinion-console__error"},[t._v("\n                "+t._s(n.error)+"\n              ")]),i("div",{directives:[{name:"show",rawName:"v-show",value:!n.edit,expression:"!row.edit"}],class:{"is-modify":n.modify,"is-new":n.newId}},[t._v("\n                "+t._s(n.opinionContent)+"\n              ")]),n.edit?i("fi-input",{directives:[{name:"focus-input",rawName:"v-focus-input"}],attrs:{type:"textarea",maxlength:"100"},on:{blur:function(e){return t.checkData(n)},change:function(e){return t.updateData(n)}},model:{value:n.opinionContent,callback:function(e){t.$set(n,"opinionContent",e)},expression:"row.opinionContent"}}):t._e()]}}])}),i("fi-table-column",{attrs:{width:"50",label:t.t("workflow_opinion_console.edit")},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[i("i",{directives:[{name:"show",rawName:"v-show",value:!n.edit,expression:"!row.edit"}],staticClass:"fa fa-pencil-square-o row-icon",on:{click:function(e){return t.onClickEdit(n)}}}),i("i",{directives:[{name:"show",rawName:"v-show",value:n.edit,expression:"row.edit"}],staticClass:"el-icon-view row-icon",class:{"is-modify":n.modify,"is-new":n.newId},on:{click:function(e){return t.onCancelEdit(n)}}})]}}])}),i("fi-table-column",{attrs:{prop:"opinionTypeName",label:t.t("workflow_opinion_console.header"),width:"100"}})],1)],1)])])],1)},Cn=[],Tn={name:"FiWorkflowOpinionConsole",inject:{fiWorkflow:{default:""}},mixins:[Be.localeMixin],directives:{focusInput:{inserted:function(t){t.firstElementChild.focus()}}},props:{visible:Boolean},data:function(){return{typeList:[{opinionTypeName:this.t("workflow_opinion_console.current_flow"),opinionType:"FLOW_STAFF"},{opinionTypeName:this.t("workflow_opinion_console.current_tache"),opinionType:"TACHE_STAFF"},{opinionTypeName:this.t("workflow_opinion_console.all_flows"),opinionType:"STAFF"}],active:{},model:void 0,add:[],update:[],del:[],currentRow:null,isChange:!1}},computed:{dialogVisible:{get:function(){return this.visible},set:function(t){this.$emit("update:visible",t)}},showSaveBtn:function(){return this.add.length||this.update.length||this.del.length}},created:function(){var t=this.typeList[this.typeList.length-1];this.onTypeClick(t)},methods:{onTypeClick:function(t){this.active=t,this.refreshData()},refreshData:function(){var t=this,e=this.fiWorkflow.flowContext.flow,i=e.flowMod,n=e.tchMod,o={flowMod:i,tchMod:n,opinionType:this.active.opinionType};Object(Ze.C)(o).then(function(e){t.del=[],t.update=[],t.add=[],t.model=e})},onClickEdit:function(t){this.$set(t,"edit",!0)},onCancelEdit:function(t){this.$set(t,"edit",!1)},updateData:function(t){this.checkData(t),t.msgId&&!this.update.find(function(e){return e.msgId===t.msgId})&&(this.$set(t,"modify",!0),this.update.push(t))},checkData:function(t){var e=t.opinionContent,i=!0,n="";return e?e.length>100&&(n=this.t("workflow_opinion_console.common_opinion_size_tip"),i=!1):(n=this.t("workflow_opinion_console.common_opinion_is_null_tip"),i=!1),this.$set(t,"error",n),i},handleCurrentChange:function(t){this.currentRow=t},delOpinion:function(){var t=this.currentRow;if(t){var e=this.model.findIndex(function(e){return t.newId?e.newId===t.newId:e.msgId===t.msgId});if(this.$delete(this.model,e),t.newId){var i=this.add.findIndex(function(e){return e.newId===t.newId});this.$delete(this.add,i)}else{this.del.push(t);var n=this.update.findIndex(function(e){return e.msgId===t.msgId});this.$delete(this.update,n)}}},addItem:function(){var t=this.active,e=t.opinionType,i=t.opinionTypeName,n={newId:(new Date).getTime(),opinionType:e,opinionTypeName:i,opinionContent:"",error:"",edit:!0};this.model.push(n),this.add.push(n)},saveModify:function(){var t=this,e=this.model.find(function(t){return t.error});if(e){var i=e.opinionContent&&e.opinionContent.length>100?this.t("workflow_opinion_console.common_opinion_size_tip"):this.t("workflow_opinion_console.common_opinion_is_null_tip");this.$message({showClose:!0,message:i,type:"error"})}else{var n=this.fiWorkflow.flowContext.flow,o=n.flowMod,r=n.tchMod,a=function(t){t.error,t.newId,t.edit,t.modify;return jt(t,["error","newId","edit","modify"])},s={flowMod:o,tchMod:r,opinionType:this.active.opinionType,add:this.add.map(a),update:this.update.map(a),del:this.del.map(a)};Object(Ze.J)(s).then(function(e){t.isChange=!0,t.$message({showClose:!0,message:e.msg,type:"success"}),t.refreshData()})}},closeDialog:function(){this.$emit("close",this.isChange)}}},kn=Tn,Sn=At(kn,An,Cn,!1,null,null,null),En=Sn.exports;En.install=function(t){t.component(En.name,En)};var In=En,Ln={name:"FiWorkflowFlowOpinion",components:{FiWorkflowOpinionConsole:In},inject:{fiWorkflow:{default:""}},mixins:[Be.localeMixin],props:{value:String,leftLabel:{type:String,default:""},placeholder:{type:String,default:""},list:{type:Array,default:function(){return[]}},labelKey:{type:String,default:"opinionContent"},config:{type:Object,default:function(){return{}}},disabled:Boolean,required:Boolean,isInitList:Boolean,isEnd:Boolean},data:function(){return{maxLength:100,dialogVisible:!1,opinionList:[],loadingConsole:!1}},computed:{form:function(){return{content:this.value}},content:{get:function(){return this.form.content},set:function(t){this.$emit("input",t)}},rules:function(){var t=[];return this.required&&t.push({required:!0,message:this.t("workflow_flow_opinion.opinion_is_null_tip"),trigger:"blur"}),t},opinionStatus:{get:function(){return this.config.selected},set:function(t){this.config.selected=t,this.fiWorkflow.flowContext.flow.opinionStatus=t}},leftText:function(){return this.leftLabel||this.t("workflow_flow_opinion.handle_opinion")},placeHolder:function(){return this.placeholder||this.t("workflow_flow_opinion.placeholder")}},mounted:function(){this.isInitList?this.refresh():this.opinionList=this.list},methods:{refreshNextTchData:function(t){this.config.refresh&&this.fiWorkflow.refreshNextTchData(),this.fiWorkflow.$emit("onOpinionStatusChange",t);var e=this.config.items.find(function(e){return e.value===t}).text;this.$emit("input",e)},onSelect:function(t){var e=this;this.$emit("input",t),this.$nextTick(function(){e.validate()})},validate:function(){var t;return this.$refs.opinionForm.validate(function(e){t=e}),t||this.$el.querySelector("textarea").focus(),t},doSave:function(){var t=this;if(this.value){if(this.value.length>this.maxLength)return void this.$message({showClose:!0,message:"".concat(this.t("workflow_flow_opinion.common_opinion_size_exceed_before")," ").concat(this.maxLength," ").concat(this.t("workflow_flow_opinion.common_opinion_size_exceed_after")),type:"error"});var e=this.fiWorkflow.flowContext.flow,i=e.tchMod,n=e.flowMod,o={tchMod:i,flowMod:n,opinionType:"STAFF",add:[{opinionContent:this.value}],update:[],del:[]};Object(Ze.J)(o).then(function(e){t.list.unshift(Wt({},t.labelKey,t.value)),t.$message({showClose:!0,message:e.msg,type:"success"})}).then(function(){t.refresh()})}},refresh:function(){var t=this,e=this.fiWorkflow.flowContext.flow,i=e.tchMod,n=e.flowMod,o={tchMod:i,flowMod:n};Object(Ze.t)(o).then(function(e){t.opinionList=e})},openOpinionConsole:function(){this.loadingConsole=!0,this.dialogVisible=!0}}},Rn=Ln,Pn=At(Rn,bn,xn,!1,null,null,null),On=Pn.exports;On.install=function(t){t.component(On.name,On)};var Dn=On,Mn=function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.content?i("div",{staticClass:"fi-workflow-exec-desc"},[i("div",{staticClass:"fi-workflow-exec-desc__container"},[t._m(0),i("span",{staticClass:"fi-workflow-exec-desc__title"},[t._v(t._s(t.t("workflow_exec_desc.exec_desc")))]),i("span",{staticClass:"fi-workflow-exec-desc__content",domProps:{innerHTML:t._s(t.content)}})])]):t._e()},Nn=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("span",{staticClass:"fi-workflow-exec-desc__icon"},[i("i",{staticClass:"el-icon-warning"})])}],Bn={name:"FiWorkflowExecDesc",mixins:[Be.localeMixin],props:{content:String}},Fn=Bn,zn=At(Fn,Mn,Nn,!1,null,null,null),Vn=zn.exports,Un={name:"FiWorkflowDialog",components:{FiWorkflowExecDesc:Vn,FiWorkflowFlowOpinion:Dn,FiWorkflowTchPanel:wn},inject:["fiWorkflow"],mixins:[Be.localeMixin],props:{visible:Boolean,tchData:{type:[Object,void 0],required:!0},rules:{type:Object,default:function(){return{}}}},data:function(){return{isSubmitting:!1,isSaving:!1,attaches:[],opinionCache:""}},computed:{hasAppend:function(){return this.fiWorkflow.hasAppend},dialogVisible:{get:function(){return this.visible},set:function(t){this.$emit("update:visible",t)}},nextTchSelected:{get:function(){return this.tchData.selectedTchs},set:function(t){this.tchData.selectedTchs=t}},nextTchSelectedNoEndTask:function(){return this.tchData.selectedTchs&&this.tchData.selectedTchs[0]&&this.tchData.selectedTchs[0].endTask?[]:this.tchData.selectedTchs},isEndTask:function(){return this.tchData.selectedTchs&&this.tchData.selectedTchs[0]&&this.tchData.selectedTchs[0].endTask},opinion:{get:function(){if(this.tchData.opinionConfig&&!this.tchData.opinionConfig.default&&this.fiWorkflow.opinion){var t=this.fiWorkflow.opinion;return"function"==typeof t?t():t}return this.opinionCache?this.opinionCache:this.tchData.opinionConfig&&this.tchData.opinionConfig.default},set:function(t){this.tchData.opinionConfig.default=t,this.opinionCache=t}}},watch:{},methods:{onOpen:function(){this.$emit("openDialog")},beforeDialogClose:function(t){this.isSubmitting||t()},dialogClose:function(){this.isSubmitting||(this.dialogVisible=!1)},onSaveBtnClick:function(t,e,i){this.hasAppend&&this.fiWorkflow.$emit("onFormBeforeValid"),this.beforeDoSave(e,i)},beforeDoSave:function(t,e){var i=this;if(this.fiWorkflow.onFormSubmit&&"function"==typeof this.fiWorkflow.onFormSubmit){var n=this.fiWorkflow.onFormSubmit("save");n.then?(this.fiWorkflow.isOpening=!0,n.then(function(n){i.fiWorkflow.isOpening=!1,n&&i.doSave(t,e)}).catch(function(){i.fiWorkflow.isOpening=!1})):n&&this.doSave(t,e)}else this.doSave(t,e)},doSave:function(t,e){var i=this,n={form:this.createFormParam()};this.isSaving=!0,Object(Ze.L)(n).then(function(){!t&&i.fiWorkflow.$emit("onAfterSave",!0),i.afterSave(i.t("workflow_dialog.save_success"),t,i.afterSaveFormDoing,e)}).catch(function(){i.fiWorkflow.$emit("onAfterSave",!1),i.isSaving=!1})},afterSaveFormDoing:function(t){var e=this;this.fiWorkflow.afterSaveFormDoing().then(function(){t&&"function"==typeof t&&t(),e.fiWorkflow.$emit("onAfterSave",!0),e.isSaving=!1})},afterSave:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.t("workflow_dialog.submit_success"),e=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0;this.$message({showClose:!0,message:t,type:"success",offset:60,duration:1e3,onClose:function(){e?i&&i(n):(-1!==navigator.userAgent.indexOf("Firefox")||-1!==navigator.userAgent.indexOf("Chrome")?(window.location.href="about:blank",window.close()):(window.opener=null,window.open("","_self",""),window.close()),setTimeout(function(){location.reload()},100))}})},onSubmitBtnClick:function(){var t=this;this.hasAppend&&this.fiWorkflow.$emit("onFormBeforeValid"),this.$refs.fiAppendForm.validate(function(e,i){var n=!0;if(t.fiWorkflow.$refs.fiForm.validate(function(t){n=t}),e&&n){if(t.hasAppend&&t.fiWorkflow.onFormSubmit&&"function"==typeof t.fiWorkflow.onFormSubmit){var o=t.fiWorkflow.onFormSubmit("turn");if(o.then)return t.fiWorkflow.isOpening=!0,void o.then(function(e){if(t.fiWorkflow.isOpening=!1,e){var i=t.$refs.opinionRef.validate,n=t.validNextTchMods;i()&&n()&&t.doSubmit()}}).catch(function(){t.fiWorkflow.isOpening=!1});if(!o)return}var r=t.$refs.opinionRef.validate,a=t.validNextTchMods;r()&&a()&&t.doSubmit()}else Object(Xe.d)(i,t.$refs.fiAppendForm.fields,50,document.querySelector(".fi-workflow-dialog__body"))})},validNextTchMods:function(){var t=this,e=this.nextTchSelected,i=function(e){return t.$message({showClose:!0,message:e,type:"error"}),!1},n="";if(!this.tchData.isRelateTchClosed&&e[0].endTask)return!0;if(!e.length)return n=this.t("workflow_dialog.select_next_tache_tip"),i(n);if(!e[0].notEnd)return!0;var o=e.find(function(t){var e=t.info,i=e.multiInst,n=e.multiInstMerge;return"1"===i&&"1"===n&&t.multiInstOperator.find(function(t){return!t.value.staff.length})});if(o)return n="请选择 [".concat(o.info.tchName,"] 环节的执行人"),i(n);var r=e.find(function(t){return!t.operator.value.staff.length&&!t.multiInstOperator.length});if(r)return n="".concat(this.t("workflow_dialog.select_executer_tip_before")," [").concat(r.info.tchName,"] ").concat(this.t("workflow_dialog.select_executer_tip_after")),i(n);var a=e.find(function(t){return t.operator.noticeCfg.isCustomNotify&&!t.operator.value.notifyContent});return!a||(n="[".concat(a.info.tchName,"] ").concat(this.t("workflow_dialog.notify_content_tip")),i(n))},doSubmit:function(){var t=this;this.isSubmitting=!0;var e=this.fiWorkflow.$global(),i=this.tchData.info,n=i.onFinish,o=i.onFinishType;e.tache=this.getSelectedTacheInfo();var r={template:n,type:o,$global:e,key:"onFinish",nullValue:!0};Object(Ye.c)(r).then(function(i){if(!i)return void(t.isSubmitting=!1);var n=t.nextTchSelectedNoEndTask.map(function(t){var i=t.info,n=i.onCreate,o=i.onCreateType,r=i.tchNum,a=i.tchMod,s=i.tacheAction;e.nextItemTchMod=t.tchMod;var l=t.operator.value.notifyContent,h=Object.assign({},e,{tache:{tchNum:r,tchMod:a,action:s,notifyContent:l}}),c={template:n,type:o,$global:h,key:"onCreate",nullValue:!0};return Object(Ye.c)(c)});Promise.all(n).then(function(i){if(i.some(function(t){return!t}))return void(t.isSubmitting=!1);var n={form:t.createFormParam(),tache:t.createFlowParam()};Object(Ze.I)(n).then(function(){var i=t.tchData.info,o=i.onAfterFinish,r=i.onAfterFinishType;e.nextItemTchMod="";var a={template:o,type:r,$global:e,key:"onAfterFinish"};Object(Ye.d)(a),(n.tache.nextTchMods||[]).forEach(function(i){var n=t.tchData.nextTchMap[i.tchMod],o=n.info,r=o.onAfterCreate,a=o.onAfterCreateType,s=o.tchNum,l=o.tchMod,h=o.tacheAction;e.nextItemTchMod=n.tchMod;var c=Object.assign({},e,{tache:{tchNum:s,tchMod:l,action:h,staffId:n.operator.value.staff.map(function(t){return t.staffId}).join(","),notifyContent:n.operator.value.notifyContent}}),u={template:r,type:a,$global:c,key:"onAfterCreate"};"js"===a&&Object(Ye.d)(u)}),t.afterSave(),t.doAfterSubmitCallBack()}).catch(function(){t.isSubmitting=!1})}).catch(function(){t.isSubmitting=!1})}).catch(function(){t.isSubmitting=!1})},getSelectedTacheInfo:function(){var t={tchNum:[],tchMod:[],staffId:[],action:[],notifyContent:[]};return this.tchData&&this.nextTchSelectedNoEndTask&&this.nextTchSelectedNoEndTask.reduce(function(t,e){return t.tchNum.push(e.tchNum),t.tchMod.push(e.tchMod),t.action.push(e.tacheAction),t.notifyContent.push(e.operator.value.notifyContent),e.operator&&t.staffId.push(e.operator.value.staff),t},t),Object.keys(t).forEach(function(e){if("staffId"===e){var i=t[e].reduce(function(t,e){return t.push(e.map(function(t){return t.staffId}).join(",")),t},[]);t[e]=i.join("|")}else t[e]="notifyContent"===e?t[e].join("@@"):t[e].join(",")}),t},createFormParam:function(){var t=this.fiWorkflow.$global();t.tache=this.getSelectedTacheInfo();var e=this.fiWorkflow.createTable(),i=this.fiWorkflow.flowContext,n=i.flow,o=i.form,r=i.global;n.opinionCfg&&delete n.opinionCfg;var a=o.formCfg?{}:null;return a&&Object.keys(o.formCfg).forEach(function(e){a[e]=o.formCfg[e].map(function(e){var i=e.type,n=e.event,o={template:n,type:i,$global:t};return Object(Ye.e)(o)})}),{context:n,prop:o.formProp,action:o.formAction,appName:"flow",formId:o.formId,globalVar:r,table:e,formCfg:a}},createFlowParam:function(){var t=this.fiWorkflow.$global();t.tache=this.getSelectedTacheInfo();var e=t.flow,i=t.globalVar,n=this.attaches,o=this.tchData.info,r=o.onAfterFinish,a=o.onAfterFinishType,s={template:r,type:a,$global:t,key:"onAfterFinish"},l="js"===a?null:Object(Ye.e)(s),h=this.createNextTchModsParam(t);return Jt({curTchId:e.tchId,isSuperControl:0,todir:"flow",attaches:n,flowId:e.flowId,flowName:this.tchData.turnTitle,curTchContent:this.opinion,flowMod:e.flowMod,staffId:i.staffId,onAfterFinish:l,nextTchMods:h},this.getSourceInfo())},createNextTchModsParamByMulti:function(t,e,i){var n=e.multiInstOperator,o=e.tchMod,r=e.tchNum,a=e.tacheAction,s=e.info,l=s.onAfterCreate,h=s.onAfterCreateType;if(1===n.length){var c=n[0].value,u=c.notifyContent,d=c.staff.reduce(function(t,e){if(e.staffId.includes(",")){var i=e.orgIdSplit,n=void 0===i?"":i,o=e.staffId,r=void 0===o?"":o,a=e.staffName,s=n.split("|");r.split(",").forEach(function(e,i){t.push({staffId:e,orgId:s[i],staffName:a})})}else t.push(e);return t},[]),f=Object.assign({},i,{tache:{tchNum:r,tchMod:o,action:a,notifyContent:u}}),p={template:l,type:h,$global:f,key:"onAfterCreate"},g={tchDesc:e.info.tchName,isSendNMail:e.cc.value.sendMail,isSendNSms:e.cc.value.sendSms,isSendSms:c.sendSms,isSendMail:c.sendMail,notifyContent:c.notifyContent,tchMod:o,notifyStaffs:e.cc.value.staff.map(function(t){return t.staffId}).join(","),onAfterCreate:"js"===h?void 0:Object(Ye.e)(p),serialStaff:""};if("parallel"===c.countersignValue)d.forEach(function(e){t.push(Jt(Jt({},g),{},{nextStaff:e.staffId,nextGroup:e.orgId}))});else{var _=d.reduce(function(t,e){return t.nextStaff.push(e.staffId),t.nextGroup.push(e.orgId),t},{nextStaff:[],nextGroup:[]}),m=_.nextStaff,v=_.nextGroup,y=v.join(",").split(",");"serial"===c.countersignValue?t.push(Jt(Jt({},g),{},{nextStaff:m[0],serialStaff:m.join(","),nextGroup:Gt(new Set(y)).join(",")})):t.push(Jt(Jt({},g),{},{nextStaff:m.join(","),nextGroup:Gt(new Set(y)).join(",")}))}}else n.forEach(function(n){var s=n.value,c=s.notifyContent,u=s.staff.reduce(function(t,e){if(e.staffId.includes(",")){var i=e.orgIdSplit,n=void 0===i?"":i,o=e.staffId,r=void 0===o?"":o,a=e.staffName,s=n.split("|");r.split(",").forEach(function(e,i){t.push({staffId:e,orgId:s[i],staffName:a})})}else t.push(e);return t},[]),d=u.reduce(function(t,e){return t.nextStaff.push(e.staffId),t.nextGroup.push(e.orgId),t},{nextStaff:[],nextGroup:[]}),f=d.nextStaff,p=d.nextGroup,g=p.join(",").split(","),_=Object.assign({},i,{tache:{tchNum:r,tchMod:o,action:a,notifyContent:c}}),m={template:l,type:h,$global:_,key:"onAfterCreate"},v={tchDesc:e.info.tchName,isSendNMail:e.cc.value.sendMail,isSendNSms:e.cc.value.sendSms,isSendSms:s.sendSms,isSendMail:s.sendMail,notifyContent:s.notifyContent,tchMod:o,notifyStaffs:e.cc.value.staff.map(function(t){return t.staffId}).join(","),onAfterCreate:"js"===h?void 0:Object(Ye.e)(m),serialStaff:""};t.push(Jt(Jt({},v),{},{nextStaff:f.join(","),nextGroup:Gt(new Set(g)).join(",")}))})},createNextTchModsParam:function(t){var e=this;return this.nextTchSelectedNoEndTask.reduce(function(i,n){var o=n.tchMod,r=n.tchNum,a=n.tacheAction,s=n.info,l=s.onAfterCreate,h=s.onAfterCreateType,c=s.multiInst,u=s.multiInstMerge;if("1"===c&&"1"===u)e.createNextTchModsParamByMulti(i,n,t);else{var d=n.operator.value.notifyContent,f=n.operator.value.staff.reduce(function(t,e){if(e.staffId.includes(",")){var i=e.orgIdSplit,n=void 0===i?"":i,o=e.staffId,r=void 0===o?"":o,a=e.staffName,s=n.split("|");r.split(",").forEach(function(e,i){t.push({staffId:e,orgId:s[i],staffName:a})})}else t.push(e);return t},[]),p=Object.assign({},t,{tache:{tchNum:r,tchMod:o,action:a,notifyContent:d}}),g={template:l,type:h,$global:p,key:"onAfterCreate"},_={tchDesc:n.info.tchName,isSendNMail:n.cc.value.sendMail,isSendNSms:n.cc.value.sendSms,isSendSms:n.operator.value.sendSms,isSendMail:n.operator.value.sendMail,notifyContent:n.operator.value.notifyContent,tchMod:o,notifyStaffs:n.cc.value.staff.map(function(t){return t.staffId}).join(","),onAfterCreate:"js"===h?void 0:Object(Ye.e)(g),serialStaff:""};if("parallel"===n.operator.value.countersignValue)f.forEach(function(t){i.push(Jt(Jt({},_),{},{nextStaff:t.staffId,nextGroup:t.orgId}))});else{var m=f.reduce(function(t,e){return t.nextStaff.push(e.staffId),t.nextGroup.push(e.orgId),t},{nextStaff:[],nextGroup:[]}),v=m.nextStaff,y=m.nextGroup,w=y.join(",").split(",");"serial"===n.operator.value.countersignValue?i.push(Jt(Jt({},_),{},{nextStaff:v[0],serialStaff:v.join(","),nextGroup:Gt(new Set(w)).join(",")})):i.push(Jt(Jt({},_),{},{nextStaff:v.join(","),nextGroup:Gt(new Set(w)).join(",")}))}}return i},[])},doAfterSubmitCallBack:function(){var t=Object(Xe.c)(window.location.search).callback;return!(window.opener&&"refresh"===t&&!window.opener.closed)||(window.opener.name="refresh",window.opener.flowId=this.fiWorkflow.$global().flow.flowId,window.opener.postMessage("refresh","*")||!0)},getSourceInfo:function(){var t="",e="";if("CONFIG_TURN"===window.name){var i=window.opener.window,n=i.mainFlowId,o=i.mainTchId;return t=n,e=o,{sourceFlowId:t,sourceTchId:e}}return"TURN"===window.name?(t=sessionStorage.getItem("mainFlowId"),e=sessionStorage.getItem("mainTchId"),{sourceFlowId:t,sourceTchId:e}):{}}}},jn=Un,Hn=At(jn,Ni,Bi,!1,null,null,null),Wn=Hn.exports;Wn.install=function(t){t.component(Wn.name,Wn)};var Gn=Wn,Zn=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("fi-dialog",{attrs:{width:"500px",title:t.hangTitle,visible:t.dialogVisible,"modal-class":"fi-workflow-dialog-modal","lock-scroll":!1},on:{"update:visible":function(e){t.dialogVisible=e}}},[i("fi-form",{ref:"form",attrs:{model:t.form,"label-width":"125px","label-position":"left",rules:t.rules}},[i("fi-form-item",{attrs:{label:t.t("workflow_hangup.hangup_time")}},[i("fi-row",{attrs:{gutter:10}},[i("fi-col",{attrs:{span:11}},[i("fi-form-item",{attrs:{prop:"suspendDuration"}},[i("fi-input",{attrs:{type:"number",disabled:t.state},on:{input:function(e){t.form.suspendDuration=Number(t.form.suspendDuration.replace(/\D+/,""))}},model:{value:t.form.suspendDuration,callback:function(e){t.$set(t.form,"suspendDuration",e)},expression:"form.suspendDuration"}})],1)],1),i("fi-col",{attrs:{span:11}},[i("fi-form-item",{attrs:{prop:"suspendDurationUnit"}},[i("fi-select",{attrs:{disabled:t.state},model:{value:t.form.suspendDurationUnit,callback:function(e){t.$set(t.form,"suspendDurationUnit",e)},expression:"form.suspendDurationUnit"}},[i("fi-option",{attrs:{label:t.t("workflow_hangup.day"),value:"d"}}),i("fi-option",{attrs:{label:t.t("workflow_hangup.hour"),value:"h"}}),i("fi-option",{attrs:{label:t.t("workflow_hangup.minute"),value:"m"}})],1)],1)],1)],1)],1),i("fi-form-item",{attrs:{label:t.t("workflow_hangup.approval_per")}},[i("fi-row",{attrs:{gutter:10}},[i("fi-col",{attrs:{span:22}},[i("div",[t._v(t._s(t.form.approveStaffName))])])],1)],1),i("fi-form-item",{attrs:{label:t.t("workflow_hangup.hangup_reason")}},[i("fi-row",{attrs:{gutter:10}},[i("fi-col",{attrs:{span:22}},[i("fi-input",{attrs:{type:"textarea",disabled:t.state,rows:4},model:{value:t.form.suspendReason,callback:function(e){t.$set(t.form,"suspendReason",e)},expression:"form.suspendReason"}})],1)],1)],1),t.state?i("fi-form-item",{attrs:{label:t.t("workflow_hangup.approval_reason")}},[i("fi-row",{attrs:{gutter:10}},[i("fi-col",{attrs:{span:22}},[i("fi-input",{attrs:{type:"textarea",disabled:!t.hangUpMsgState,rows:4},model:{value:t.form.approveOpinion,callback:function(e){t.$set(t.form,"approveOpinion",e)},expression:"form.approveOpinion"}})],1)],1)],1):t._e()],1),!t.state||t.hangUpMsgState?i("div",{staticClass:"fi-workflow-dialog__footer",attrs:{slot:"footer"},slot:"footer"},[t.state?i("fi-button",{on:{click:t.backHangUp}},[t._v("\n      "+t._s(t.t("workflow_hangup.reject"))+"\n    ")]):t._e(),i("fi-button",{attrs:{type:"primary"},on:{click:function(e){return t.submitHangUp("form")}}},[t._v("\n      "+t._s(t.t("workflow_hangup.submit"))+"\n    ")])],1):t._e()],1)},Xn=[],Yn={name:"FiWorkflowHangup",mixins:[Be.localeMixin],inject:{fiWorkflow:{default:""}},props:{hangTitle:{type:String,required:!0},hangUpVisible:{type:Boolean,default:!1},visible:Boolean,hangUpMsgState:Boolean,hangData:{type:Object,default:function(){return{}}}},data:function(){return{form:{suspendDuration:"",suspendDurationUnit:"",suspendReason:"",approveOpinion:"",approveStaffName:"",approveStaffId:""},rules:{suspendDuration:[{required:!0,message:"请输入数字",trigger:"blur"}],suspendDurationUnit:[{required:!0,message:"请选择单位",trigger:"change"}]},state:!1}},created:function(){this.state=this.hangData.state,this.state?this.getFlowApplyData():this.getLeaderData()},computed:{dialogVisible:{get:function(){return this.visible},set:function(t){this.$emit("update:visible",t)}}},methods:{getLeaderData:function(){function t(){return e.apply(this,arguments)}var e=ee(Ue.a.mark(function t(){var e,i,n,o;return Ue.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e={staffId:this.hangData.global.staffId},t.next=3,Object(Ze.y)(e);case 3:i=t.sent,n=[],o=[],i.forEach(function(t){n.push(t.leaderName),o.push(t.leaderId)}),this.form.approveStaffName=n.join(","),this.form.approveStaffId=o.join(",");case 9:case"end":return t.stop()}},t,this)}));return t}(),getFlowApplyData:function(){function t(){return e.apply(this,arguments)}var e=ee(Ue.a.mark(function t(){var e,i,n,o,r,a;return Ue.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.hangData.global,i=e.staffId,n=e.staffName,o=e.flowSuspendApplyId,r={flowSuspendApplyId:o},t.next=4,Object(Ze.r)(r);case 4:a=t.sent,this.form={approveStaffName:n,approveStaffId:i,suspendDuration:a.suspendDuration,suspendDurationUnit:a.suspendDurationUnit,suspendReason:a.suspendReason,approveOpinion:a.approveOpinion||""};case 6:case"end":return t.stop()}},t,this)}));return t}(),submitHangUp:function(t){var e=this;this.$refs[t].validate(function(t){t&&(e.state?e.approveFlowSuspendApply(e.form):e.saveFlowSuspendApply(e.form))})},saveFlowSuspendApply:function(){function t(t){return e.apply(this,arguments)}var e=ee(Ue.a.mark(function t(e){var i,n,o,r,a,s,l,h,c,u,d,f;return Ue.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=this.hangData.global,n=i.flowId,o=i.tchMod,r=i.tchId,a=i.staffId,s=e.suspendDuration,l=e.suspendDurationUnit,h=e.suspendReason,c=e.approveStaffName,u=e.approveStaffId,d={tchId:r,flowId:n,tchMod:o,staffId:a,suspendDuration:s,suspendDurationUnit:l,suspendReason:h,approveStaffName:c,approveStaffId:u,createTime:Object(Xe.e)(new Date,"YYYY-MM-DD hh:mm:ss"),state:"apply"},t.next=5,Object(Ze.K)(d);case 5:f=t.sent,0===Number(f.code)&&(this.$message.success(f.msg),this.$emit("getHangUpStatue","1"));case 7:case"end":return t.stop()}},t,this)}));return t}(),approveFlowSuspendApply:function(){function t(t){return e.apply(this,arguments)}var e=ee(Ue.a.mark(function t(e){var i,n,o,r;return Ue.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=this.hangData.global.flowSuspendApplyId,n=e.approveOpinion,o={flowSuspendApplyId:i,approveOpinion:n,approveTime:Object(Xe.e)(new Date,"YYYY-MM-DD hh:mm:ss"),state:"suspend"},t.next=5,Object(Ze.b)(o);case 5:r=t.sent,0===Number(r.code)&&(this.$message.success(r.msg),this.$emit("getHangUpStatue","2"));case 7:case"end":return t.stop()}},t,this)}));return t}(),backHangUp:function(){function t(t){return e.apply(this,arguments)}var e=ee(Ue.a.mark(function t(e){var i,n,o,r;return Ue.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=this.hangData.global.flowSuspendApplyId,n=e.approveOpinion,o={flowSuspendApplyId:i,approveOpinion:n,approveTime:Object(Xe.e)(new Date,"YYYY-MM-DD hh:mm:ss"),state:"back"},t.next=5,Object(Ze.d)(o);case 5:r=t.sent,0===Number(r.code)&&(this.$message({message:"".concat(r.msg),type:"success"}),this.$emit("getHangUpStatue","2"),window.location.reload());case 7:case"end":return t.stop()}},t,this)}));return t}()}},$n=Yn,qn=At($n,Zn,Xn,!1,null,null,null),Kn=qn.exports;Kn.install=function(t){t.component(Kn.name,Kn)};var Jn=Kn,Qn=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("fi-dialog",{staticClass:"fi-workflow-approve-dialog",attrs:{top:"20px",visible:t.dialogVisible,fullscreen:!1,width:"800px","append-to-body":"","lock-scroll":!1,"close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(e){t.dialogVisible=e},close:t.dialogClose}},[i("div",{staticClass:"fi-workflow-dialog__title",attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.t("workflow_approve.tache_cc")))]),i("div",{staticClass:"fi-workflow-dialog__body"},[i("fi-workflow-flow-opinion",{attrs:{leftLabel:t.t("workflow_approve.cc_opinion"),required:!0,isInitList:!0},model:{value:t.curTchData.opinion,callback:function(e){t.$set(t.curTchData,"opinion",e)},expression:"curTchData.opinion"}}),i("div",{staticClass:"fi-workflow-tch-selector-item__shell"},[i("fi-workflow-tch-selector-item",{attrs:{label:t.t("workflow_approve.notify_staff"),oftenType:"2",config:t.config,ready:!0},model:{value:t.staffObj,callback:function(e){t.staffObj=e},expression:"staffObj"}})],1)],1),i("div",{staticClass:"fi-workflow-dialog__footer",attrs:{slot:"footer"},slot:"footer"},[i("fi-button",{attrs:{plain:"",icon:"el-icon-arrow-left"},on:{click:t.dialogClose}},[t._v(t._s(t.t("workflow_approve.return_menu")))]),i("fi-button",{attrs:{type:"primary",disabled:t.loading,loading:t.isSubmitting},on:{click:t.submit}},[t._v("\n            "+t._s(t.submitText)+"\n        ")])],1)])},to=[],eo={name:"FiWorkflowApprove",components:{FiWorkflowFlowOpinion:Dn,FiWorkflowTchSelectorItem:cn},mixins:[Be.localeMixin],inject:{fiWorkflow:{default:""}},props:{visible:Boolean},watch:{staffObj:{handler:function(t){this.curTchData.notifyStaffids=t.staff.map(function(t){return t.staffId}).join(),this.curTchData.isMail=t.sendMail,this.curTchData.isSms=t.sendSms},deep:!0},dialogVisible:{immediate:!0,handler:function(t){t?this.init():(this.loading=!0,this.isSubmitting=!0)}}},data:function(){return{loading:!0,isSubmitting:!0,staffIds:"",staffNotifyTaches:[],staffObj:{staff:[],sendMail:"0",sendSms:"0"},config:{noticeCfg:{display:!0,mail:{display:!0,disabled:!1},sms:{display:!0,disabled:!1}},staffCfg:{candidate:[],canChange:!0,candidateEditDisabled:!1}},saveParams:[],curTchData:{isMail:"0",isFree:"1",tchId:this.fiWorkflow.flowContext.flow.tchId,isSms:"0",notifyStaffids:void 0,opinion:""}}},computed:{dialogVisible:{get:function(){return this.visible},set:function(t){this.$emit("update:visible",t)}},submitText:function(){return this.loading?this.t("workflow_approve.data_loading"):this.t("workflow_approve.submit")}},mounted:function(){},methods:{init:function(){var t=this;Object(Ze.D)({flowId:this.fiWorkflow.flowContext.flow.flowId}).then(function(e){t.staffNotifyTaches=e,t.loading=!1,t.isSubmitting=!1})},dialogClose:function(){this.clearData(),this.isSubmitting||(this.dialogVisible=!1)},clearData:function(){this.staff=[],this.curTchData={isMail:"0",isFree:"1",tchId:this.fiWorkflow.flowContext.flow.tchId,isSms:"1",notifyStaffids:void 0,opinion:""}},submit:function(){var t=this;if(this.validate()){this.saveParams=[];window.location.href.includes("type=view")&&(this.staffNotifyTaches.forEach(function(e){var i=e.preTaches,n=t.fiWorkflow.flowContext.flow.tchId;i.forEach(function(e){n!==e.tchId&&t.saveParams.push({isFree:"0",tchId:e.tchId,opinion:t.curTchData.opinion})})}),this.curTchData.isFree="0"),this.saveParams.push(this.curTchData),Object(Ze.c)(this.saveParams).then(function(){t.clearData(),t.dialogVisible=!1,t.$message({showClose:!0,message:t.t("workflow_approve.submit_success"),type:"success",offset:60,duration:1e3,onClose:function(){window.close(),setTimeout(function(){location.reload()},100)}})})}},validate:function(){return!!this.curTchData.opinion||(this.$message({showClose:!0,message:this.t("workflow_approve.cc_opinion_null_tip"),type:"error"}),!1)}}},io=eo,no=At(io,Qn,to,!1,null,null,null),oo=no.exports;oo.install=function(t){t.component(oo.name,oo)};var ro=oo,ao=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("fi-dialog",{staticClass:"fi-workflow-receiving",attrs:{visible:t.dialogVisible,fullscreen:!1,width:"800px","append-to-body":"","lock-scroll":!1,"close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(e){t.dialogVisible=e},close:t.dialogClose}},[i("div",{staticClass:"fi-workflow-receiving__title",attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.t("workflow_receiving.protocol")))]),i("div",{staticClass:"fi-workflow-receiving__body"},[i("p",[t._v(t._s(t.t("workflow_receiving.protocol_title")))]),i("p",{staticClass:"fi-workflow-receiving__text"},[t._v(t._s(t.t("workflow_receiving.protocol_one")))]),i("p",{staticClass:"fi-workflow-receiving__text"},[t._v(t._s(t.t("workflow_receiving.protocol_two")))]),i("p",{staticClass:"fi-workflow-receiving__text"},[t._v(t._s(t.t("workflow_receiving.protocol_three")))]),i("p",{staticClass:"fi-workflow-receiving__text"},[t._v(t._s(t.t("workflow_receiving.protocol_four")))]),i("p",[t._v(t._s(t.t("workflow_receiving.protocol_confirm_tip")))])]),i("div",{staticClass:"fi-workflow-receiving__footer",attrs:{slot:"footer"},slot:"footer"},[i("fi-button",{attrs:{type:"primary",loading:t.isSubmitting},on:{click:t.submit}},[t._v("\n      "+t._s(t.t("workflow_receiving.protocol_confirm_btn"))+"\n    ")]),i("fi-button",{attrs:{plain:""},on:{click:t.dialogClose}},[t._v(t._s(t.t("workflow_receiving.protocol_confirm_cancel")))])],1)])},so=[],lo={name:"fiWorkflowReceiving",props:{visible:Boolean,tchId:[Number,String]},mixins:[Be.localeMixin],data:function(){return{isSubmitting:!1}},computed:{dialogVisible:{get:function(){return this.visible},set:function(t){this.$emit("update:visible",t)}}},methods:{dialogClose:function(){this.isSubmitting||(this.dialogVisible=!1)},submit:function(){function t(){return e.apply(this,arguments)}var e=ne(Ue.a.mark(function t(){return Ue.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.isSubmitting=!0,t.prev=1,t.next=4,Object(Ze.k)(this.tchId);case 4:this.$emit("submit"),this.isSubmitting=!1,this.dialogClose(),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(1),this.isSubmitting=!1;case 12:case"end":return t.stop()}},t,this,[[1,9]])}));return t}()}},ho=lo,co=At(ho,ao,so,!1,null,null,null),uo=co.exports,fo=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("fi-dialog",{staticClass:"fi-workflow-together-work-dialog",attrs:{top:"20px",visible:t.dialogVisible,fullscreen:!1,width:"800px","append-to-body":"","lock-scroll":!1,"close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(e){t.dialogVisible=e},close:t.dialogClose}},[i("div",{staticClass:"fi-workflow-dialog__title",attrs:{slot:"title"},slot:"title"},[t._v("发起协办")]),i("div",{staticClass:"fi-workflow-dialog__body"},[t.ready?i("fi-workflow-flow-opinion",{ref:"opinionRef",attrs:{leftLabel:"协办意见",placeholder:"请输入协办意见",required:!0,list:t.togetherData.opinion},model:{value:t.saveParams.resultDesc,callback:function(e){t.$set(t.saveParams,"resultDesc",e)},expression:"saveParams.resultDesc"}}):t._e(),t.togetherData.nextTchs?i("fi-collapse-card",{staticClass:"fi-workflow-together-work-dialog_colapse",attrs:{border:!1}},[i("template",{slot:"header"},[i("span",[t._v("下一环节")]),i("fi-radio-group",{staticClass:"fi-workflow-together-work-dialog_nexttchs",on:{change:t.onTchBranchChange},model:{value:t.saveParams.tchBranchMod,callback:function(e){t.$set(t.saveParams,"tchBranchMod",e)},expression:"saveParams.tchBranchMod"}},t._l(t.togetherData.nextTchs,function(e){return i("fi-radio",{key:e.id,attrs:{label:e.id}},[t._v(t._s(e.name))])}),1)],1)],2):t._e(),"1"!==t.saveParams.tchBranchMod?i("fi-collapse-card",{attrs:{border:!1,shadow:"never"}},[i("template",{slot:"header"},[i("span",[t._v("协办人")])]),i("div",[t.ready?i("fi-workflow-staff-picker",{attrs:{multiple:"",disabled:!1,config:t.staffCfg},model:{value:t.staffCfg.staff,callback:function(e){t.$set(t.staffCfg,"staff",e)},expression:"staffCfg.staff"}}):t._e()],1),t.ready&&(t.notifyConfig.sms.display||t.notifyConfig.mail.display)?i("div",{staticClass:"fi-workflow-together-work-dialog_tip"},[i("span",[t._v("提醒方式：")]),t.notifyConfig.mail.display?i("fi-checkbox",{attrs:{"true-label":"0BT","false-label":"0BF",disabled:!t.notifyConfig.mail.canChange,group:!1},model:{value:t.saveParams.isMail,callback:function(e){t.$set(t.saveParams,"isMail",e)},expression:"saveParams.isMail"}},[t._v("邮件")]):t._e(),t.notifyConfig.sms.display?i("fi-checkbox",{attrs:{"true-label":"0BT","false-label":"0BF",disabled:!t.notifyConfig.sms.canChange,group:!1},model:{value:t.saveParams.isSms,callback:function(e){t.$set(t.saveParams,"isSms",e)},expression:"saveParams.isSms"}},[t._v("短信")]):t._e()],1):t._e()],2):t._e()],1),i("div",{staticClass:"fi-workflow-dialog__footer",attrs:{slot:"footer"},slot:"footer"},[i("fi-button",{attrs:{plain:""},on:{click:t.dialogClose}},[t._v("取消")]),i("fi-button",{attrs:{type:"primary"},on:{click:t.submit}},[t._v("\n            提 交\n        ")])],1)])},po=[],go={name:"FiWorkflowTogetherWork",components:{FiWorkflowFlowOpinion:Dn,FiWorkflowTchSelectorItem:cn},inject:{fiWorkflow:{default:""}},props:{visible:Boolean},data:function(){return{saveParams:{resultDesc:"",tchId:"",receiver:"",tchBranchId:null,tchBranchMod:null,isSms:"OBT",isMail:"0BF"},togetherData:{opinion:[],tache:{},nextTchs:{}},notifyConfig:{},staffCfg:{staff:[],beginOrgId:"",orgId:"",staffCreateType:"",filterStaffWhere:"",canChange:!0,rootOrgCanChange:!0},ready:!1}},computed:{dialogVisible:{get:function(){return this.visible},set:function(t){this.$emit("update:visible",t)}}},created:function(){this.initData()},methods:{initData:function(){function t(){return e.apply(this,arguments)}var e=fe(Ue.a.mark(function t(){var e,i,n,o,r;return Ue.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.fiWorkflow.flowContext.flow,i=e.flowMod,n=e.tchMod,o=e.tchId,r=e.tchBranchId,t.next=3,Object(Ze.n)({flowMod:i,tchMod:n,tchBranchId:r});case 3:this.togetherData=t.sent,this.saveParams.tchBranchId=this.togetherData.tache.tchBranchId,this.saveParams.tchId=o,this.initNotifyConfig(),this.createStaffConfig(),this.ready=!0;case 9:case"end":return t.stop()}},t,this)}));return t}(),filterConditionValue:function(){function t(t){return e.apply(this,arguments)}var e=fe(Ue.a.mark(function t(e){var i,n,o,r;return Ue.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(i=this.togetherData.tache.tacheRulesCfg,n=this.workflow.$global(),o=i.filter(function(t){return t.ruleType===e}),o.length){t.next=5;break}return t.abrupt("return","");case 5:return r=Object(pi.a)(o,n),t.abrupt("return",r);case 7:case"end":return t.stop()}},t,this)}));return t}(),createStaffConfig:function(){function t(){return e.apply(this,arguments)}var e=fe(Ue.a.mark(function t(){var e,i,n,o,r,a,s,l,h,c,u,d,f,p,g,_,m=this;return Ue.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.fiWorkflow.$global(),t.next=3,this.filterConditionValue("1");case 3:i=this.togetherData.tache,n=i.defaultStaffType,o=i.staffCreateType,r=i.beginOrgType,a=i.beginOrgValue,s=i.rootOrgType,l=i.rootOrgValue,h=i.tacheRulesCfg,c={template:l,type:"rule"===n?"rule":s,$global:e,nullValue:"rule"===n?h:null,key:"rootOrgValue"},u=this.getAsyncExpressionValue(c),d={template:a,type:"rule"===n?"rule":r,$global:e,nullValue:"rule"===n?h:null,key:"beginOrgValue"},f=this.getAsyncExpressionValue(d),p={template:o,type:"rule"===n?"rule":r,$global:e,nullValue:"rule"===n?h:null,key:"staffCreateType"},g=this.getAsyncExpressionValue(p),_=[u,f,g],Promise.all(_).then(function(t){var e=ae(t,3),i=e[0],n=e[1],o=e[2];m.staffCfg.beginOrgId=n,m.staffCfg.orgId=i,m.staffCfg.staffCreateType=o});case 12:case"end":return t.stop()}},t,this)}));return t}(),onTchBranchChange:function(t){var e=this.togetherData.nextTchs.find(function(e){return e.id===t});e&&(this.staffCfg={staff:[],beginOrgId:e.beginOrgValue,orgId:"",staffCreateType:"",filterStaffWhere:e.filter,canChange:!0,rootOrgCanChange:!0})},initNotifyConfig:function(){var t=this.togetherData.tache.notifyConfig;if(t){var e=t.sms,i=t.mail;this.notifyConfig={sms:{display:"true"===e.display,selected:"true"===e.selected?"0BT":"0BF",canChange:"true"===e.canChange},mail:{display:"true"===i.display,selected:"true"===i.selected?"0BT":"0BF",canChange:"true"===i.canChange}}}else this.notifyConfig={sms:{display:!0,selected:"0BT",canChange:!0},mail:{display:!0,selected:"0BT",canChange:!0}};this.saveParams.isMail=this.notifyConfig.mail.selected,this.saveParams.isSms=this.notifyConfig.sms.selected},getAsyncExpressionValue:function(t){var e=this,i=t.template,n=t.type,o=t.$global,r=t.nullValue,a=t.key;if(n&&"rule"===n)return new Promise(function(t){t(e.getConditionCampare(r,o,a))});if(i&&n){var s=Object(Ye.g)(i,n,o);return Object(Ye.b)(s,n,o,Object(Xe.a)(a))}return new Promise(function(t){return t(r)})},getConditionCampare:function(t,e,i){function n(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(!t.length)return"";var o=oe(t),l=o[0],h=o.slice(1),c=l.conditionType,u=l.condition;if(u.length&&"16"!==l.resultType||(s=!0),!s)for(var d,f=0;f<u.length;f++){var p=u[f],g="form"===p.type?"$TABLE.".concat(p.id,".VALUE"):"$".concat(p.id);if(!e.tache&&g.indexOf("$TACHE")>-1)break;if(s=p.resultContain,d=d?"1"===c?d&&s:d||s:s,"1"===c&&!d||"2"===c&&d)break}if(s){var _=l.resultType,m=l.dealStaff,v=l.dealNode,y=l.dealFar,w=l.choiceWay,b=l.isCanChange,x=l.recommendType,A=l.recommendStaff,C=l.result,T=l.solrText;if(i&&["rootOrgValue","notifyRootOrgValue"].includes(i))return v;if(i&&"beginOrgValue"===i)return y;if(i&&["staffCreateType","notifyStaffCreateType"].includes(i))return w;if(i&&["defaultStaffCanChange","notifyStaffCanChange"].includes(i))return b;if(i&&"filterStaffWhere"===i)return T;if(i&&["candidate","notifyCandidate"].includes(i)){if("1"===x)return A?A.map(function(t){return{oftenType:"candidate"===i?1:2,staffId:"".concat(t.id),staffName:t.name}}):null;if("10"===x)return Object(Ye.g)(A,"",e).template;var k={tchId:r,flowId:a,resultType:x,resultValue:A};return Object(Ze.B)(k).then(function(t){return t.returnData})}if(["1","11","12","13"].includes(_))return m?m.map(function(t){return t.id}).join(","):null;if("6"===_)return Object(Ye.g)("$TABLE.".concat(C,".VALUE"),"",e).template;if("16"===_){var S=C.packageName,E=C.procName,I=C.params,L=Object(Ye.g)("".concat(S,".").concat(E,"(").concat(I,")"),"",e).template;return Object(Ze.A)(L).then(function(t){return t.returnData||""})}if("10"===_)return Object(Ye.g)(C,"",e).template;var R={tchId:r,flowId:a,resultType:_,resultValue:C};return Object(Ze.B)(R).then(function(t){return t.returnData})}return n(h)}var o=this.fiWorkflow.flowContext.flow,r=o.tchId,a=o.flowId,s=!1;return t.length?n(t):""},dialogClose:function(){this.dialogVisible=!1},submit:function(){function t(){return e.apply(this,arguments)}var e=fe(Ue.a.mark(function t(){var e;return Ue.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e=this.$refs.opinionRef.validate)()){t.next=8;break}return this.saveParams.receiver=this.staffCfg.staff.map(function(t){return t.staffId}).join(","),t.next=5,Object(Ze.H)(this.saveParams);case 5:this.fiWorkflow.workflowContext.isTchBranch()?this.$message({showClose:!0,message:"提交成功",type:"success",offset:60,duration:1e3,onClose:function(){window.close(),setTimeout(function(){location.reload()},100)}}):(this.$message({type:"success",message:"提交成功"}),setTimeout(function(){location.reload()},1e3)),this.fiWorkflow.refreshMenu(),this.dialogVisible=!1;case 8:case"end":return t.stop()}},t,this)}));return t}()},beforeDestroy:function(){this.saveParams.receiver=""}},_o=go,mo=At(_o,fo,po,!1,null,null,null),vo=mo.exports,yo=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("fi-dialog",{staticClass:"fi-workflow-together-work-detail-dialog",attrs:{top:"20px",visible:t.dialogVisible,fullscreen:!1,width:"800px","append-to-body":"","lock-scroll":!1,"close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(e){t.dialogVisible=e},close:t.dialogClose}},[i("div",{staticClass:"fi-workflow-dialog__title",attrs:{slot:"title"},slot:"title"},[t._v("协办详情")]),i("div",{staticClass:"fi-workflow-dialog__body"},[i("fi-table",{attrs:{data:t.tableData,loading:t.loading,stripe:"",border:"","header-cell-style":{background:"#F4F5F9"},height:"250"}},[i("fi-table-column",{attrs:{prop:"personName",label:"协办人员",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("fi-tag",{attrs:{type:t.stateColor[e.row.state]}},[t._v(t._s(t.stateMap[e.row.state]))]),t._v("\n                    "+t._s(e.row.personName)+"\n                ")]}}])}),i("fi-table-column",{attrs:{prop:"orgName",label:"部门",width:"150"}}),i("fi-table-column",{attrs:{prop:"resultDesc",label:"处理信息"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.child?i("div",t._l(t.getResultDesc(e.row),function(e,n){return i("p",{key:n},[i("span",{staticClass:"text-color"},[t._v(t._s(e.personName))]),e.receiver?i("span",[t._v(" 转送 "),i("span",{staticClass:"text-color"},[t._v(" "+t._s(e.receiver))])]):t._e(),"A"===e.state&&0===e.child.length?i("span",[t._v(" : 待处理")]):i("span",[i("span",[t._v(": "+t._s(e.resultDesc))]),i("span",{staticClass:"fi-workflow-together-work-detail-dialog_date"},[t._v(t._s(e.createdDate))])])])}),0):i("div",[t._v("\n                        "+t._s(e.row.resultDesc)+"\n                    ")])]}}])}),i("fi-table-column",{attrs:{label:"操作",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return["A"===e.row.state?i("fi-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(i){return i.preventDefault(),t.recallback(e.row)}}},[t._v("\n                        撤回\n                    ")]):t._e()]}}])})],1)],1),i("div",{staticClass:"fi-workflow-together-work-detail-dialog_footer",attrs:{slot:"footer"},slot:"footer"},[i("fi-button",{attrs:{plain:""},on:{click:t.dialogClose}},[t._v("返回表单")])],1)])},wo=[],bo={name:"FiWorkflowTogetherWorkDetail",props:{visible:Boolean},inject:{fiWorkflow:{default:""}},computed:{dialogVisible:{get:function(){return this.visible},set:function(t){this.$emit("update:visible",t)}}},data:function(){return{stateMap:{F:"完成",A:"进行",X:"撤销"},stateColor:{F:"success",A:"",X:"danger"},tableData:[],loading:!1,xFlag:!1,mainToOa:[]}},created:function(){this.fetchList()},methods:{fetchList:function(){function t(){return e.apply(this,arguments)}var e=ge(Ue.a.mark(function t(){var e,i,n,o=this;return Ue.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.fiWorkflow.flowContext.flow.tchId,this.loading=!0,t.next=4,Object(Ze.o)({tchId:e});case 4:i=t.sent,this.mainToOa=this.getMainToOa(i),n=this.transtChildrenToChild(i),n.forEach(function(t){t.child&&t.child.forEach(function(t){o.tableData.push(t)})}),this.loading=!1;case 9:case"end":return t.stop()}},t,this)}));return t}(),getMainToOa:function(t){var e=[];return t.forEach(function(t){var i=t.personName,n=t.resultDesc,o=t.children,r=t.finishDate,a=t.state,s=t.tchBranchId,l=Object(Xe.e)(r,"MM-DD hh:mm");if(o){var h=o.map(function(t){return t.personName}).join("、"),c=o.map(function(t){return t.tchBranchId}).join("、");e.push({personName:i,receiver:h,state:a,tchBranchId:s,receiverId:c,finishDate:r,createdDate:l,child:o,resultDesc:n})}}),e},transtChildrenToChild:function(t){var e=this;return t.forEach(function(t){t.children&&(t.child=t.children,delete t.children,e.transtChildrenToChild(t.child))}),t},dialogClose:function(){this.dialogVisible=!1,this.xFlag&&window.location.reload()},recallback:function(t){var e=this,i=t.tchId,n=t.tchBranchId;Object(Ze.h)({tchId:i,tchBranchId:n}).then(function(){e.$message({type:"success",message:"撤回成功"}),e.xFlag=!0,e.fetchList()})},getResultDesc:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=t.personName,r=t.resultDesc,a=t.child,s=t.finishDate,l=t.state,h=t.tchBranchId,c=Object(Xe.e)(s,"MM-DD hh:mm");if(this.isMainOa(i,h,n),a){var u=a.map(function(t){return t.personName}).join("、");i.push({personName:o,receiver:u,state:l,finishDate:s,tchBranchId:h,createdDate:c,child:a,resultDesc:"X"!==l||r?r:"已撤回"}),a.forEach(function(t){e.getResultDesc(t,i,n++)})}else i.push({personName:o,receiver:"",finishDate:s,tchBranchId:h,createdDate:c,state:l,child:a,resultDesc:"X"!==l||r?r:"已撤回"});return i},isMainOa:function(t,e,i){0===i&&this.mainToOa.forEach(function(i){i.receiverId.split("、").some(function(t){return t==="".concat(e)})&&t.push(i)})}}},xo=bo,Ao=At(xo,yo,wo,!1,null,"24b85522",null),Co=Ao.exports;Ge.a.configure({showSpinner:!1});var To={name:"FiWorkflow",provide:function(){return{getGlobal:this.$global,fiWorkflow:this}},mixins:[Be.localeMixin],inject:["fiForm"],components:{FiWorkflowReceiving:uo,FiWorkflowOpinionConsole:In,FiWorkflowDialog:Gn,FiWorkflowBar:Mi,FiWorkflowApprove:ro,FiWorkflowTogetherWork:vo,FiWorkflowTogetherWorkDetail:Co,FiWorkflowHangup:Jn},props:{model:{type:Object,required:!0},labelWidth:{type:String,default:"100px"},localContext:{type:Object,default:function(){return{}}},opinion:{type:[String,Function]},onFormSubmit:Function,onClickBefore:Function,viewForm:{type:Boolean,default:!0},removeMenus:{type:Array},isScoller:{type:Boolean,default:!1},defineRegular:{type:Array,default:function(){return[]}}},data:function(){return{dataReady:!1,formRules:{},formAppendRules:{},workflowDialogVisible:!1,isSerialing:void 0,isParalleling:void 0,tchData:{},flowContext:{global:{},flow:{},context:{},form:{}},formContext:{rules:{},attrs:{},append:{},tableMap:{},model:{},table:[],tableFields:[]},menu:{},opinionCfg:{append:!1,show:!1},approve:{show:!1,visible:!1},togetherWork:{show:!1,visible:!1},togetherWorkDetail:{show:!1,visible:!1},hangUpDetail:{show:!1,visible:!1,hangTitle:"表单挂起"},tacheRules:{},tacheMoveRules:{},initialData:{},unWatchAuto:void 0,isOpening:!1,receivingVisible:!1,hangData:{},hangUpMsgState:!1,isShowStatic:!1}},computed:{hasAppend:function(){var t=this.formContext,e=t.append,i=t.table,n=Object.keys(e);return i&&1===i.length?n.length>0:n.some(function(t){return Object.keys(e[t]).length>0})},workflowContext:function(){return be(be({},gi),this.localContext)},workflowDialog:function(){return this.$refs.workflowDialog},fiFormParent:function(){return this.$refs.fiForm},isIframeForm:function(){return"T"===Object(Xe.c)(window.location.search).isIframe},isCmdb:function(){return this.flowContext&&this.flowContext.form&&"CI"===this.flowContext.form.formType},historyId:function(){return Object(Xe.c)(window.location.search).historyId},defineRegularRules:function(){return this.defineRegular}},created:function(){Object(Je.d)(this.t),this.onCreated()},watch:{historyId:function(){this.onCreated()}},beforeDestroy:function(){"function"==typeof this.unWatchAuto&&this.unWatchAuto()},mounted:function(){document.getElementById("_ieHack").focus(),document.getElementById("_ieHack").blur(),!this.isIframeForm&&Ge.a.start()},methods:{openDialog:function(){this.$emit("opendialog")},onCreated:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object(Xe.c)(window.location.search),i=e.readOnly,n=e.historyId,o=Object(Xe.b)("getFlowForm");o?("0N"===window.name&&this.formFieldTurn(o,i),"0N"!==window.name&&this.initFormData(o,i)):this.getFlow({historyId:n}).then(function(e){"0N"===window.name&&t.formFieldTurn(e,i),"0N"!==window.name&&t.initFormData(e,i)}).catch(function(){!t.isIframeForm&&Ge.a.done()})},afterSaveFormDoing:function(){var t=this,e={};if(this.isCmdb){var i=this.flowContext.flow,n=i.classKey,o=i.instName,r=i.id,a=i.historyId,s=i.dataSetId;e={classKey:n,instName:o||r,historyId:a,dataSetId:s}}else{var l=this.flowContext.flow;e={flowMod:l.flowMod,flowId:l.flowId,tchId:l.tchId}}return!this.isIframeForm&&Ge.a.start(),Object(Ze.s)(e).then(function(e){t.initFormData(e,Object(Xe.c)(window.location.search).readOnly)}).catch(function(){!t.isIframeForm&&Ge.a.done()})},initFormData:function(t,e){var i=this;this.initialData=t;var n=t.global,o=t.menu,r=t.table,a=t.form,s=t.context;this.formContext.table=r,this.flowContext.global=n,this.flowContext.form=a,this.flowContext.flow=s,document.title=this.flowContext.flow.flowName,this.workflowContext.setContext(this);var l=Object(Je.a)(r,a.formAction,this.workflowContext,this.isCmdb,e),h=l.model,c=l.attrs,u=l.rules,f=l.tableMap,p=l.appendRules,g=l.append,_=l.tableFields;this.$emit("update:model",h),this.formContext.attrs=c,this.formContext.tableMap=f,this.formContext.append=g,this.formContext.model=h,this.formRules=u,this.formAppendRules=p,this.formContext.rules=u,this.formContext.appendRules=p,this.formContext.tableFields=_,this.menu=d(He()(o),this.workflowContext,this.$global());var m={globalVar:n,flow:s,form:a};this.isShowStatic=Object(Je.c)(r,e,this.workflowContext,this.isCmdb),this.fiForm.parent=this.workflowContext,this.fiForm.append$=g;var v=He()(m);v.attrs=c,v.rules=u,this.fiForm.global$=v,this.$emit("onFormReady"),this.$emit("init-options-rules"),this.$emit("onformready"),this.dataReady=!0,window.parent.workflow=this,!this.isIframeForm&&Ge.a.done(),this.initHangUpState(),this.$nextTick(function(){i.$refs.fiForm.clearValidate()}),"TURN"===window.name&&this.formFieldTurn(),"CONFIG_TURN"===window.name&&this.formFieldTurn()},getFlow:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object(Xe.c)(window.location.search),e=t.historyId,i=Object(Xe.c)(window.location.search),n=i.flowId,o=i.tchId,r=i.flowMod,a=i.flowNum,s=i.classKey,l=i.instName,h=i.id,c=i.dataSetId;return Object(Ze.s)({flowId:n,tchId:o,flowMod:r,flowNum:a,classKey:s,instName:l,id:h,historyId:e,dataSetId:c})},$global:function(){var t=this.flowContext;return{globalVar:t.global,flow:t.flow,tableMap:this.formContext.tableMap,table:this.createTable(!0).reduce(function(t,e){return t[Object(Xe.f)(e.name)]=e.field.reduce(function(t,e){return t[Object(Xe.f)(e.fieldName)]={value:e.value,defaultValue:e.defaultValue},t[Object(Xe.f)(e.elementName)]={value:e.value,defaultValue:e.defaultValue},t},{}),t},{}),query:Object(Xe.c)(window.location.search,!0),context:this.fiForm}},createTable:function(t){var e=this,i=this.formContext.table,n=1===i.length?xe({},i[0].name,this.formContext.model):this.formContext.model;return i.map(function(i){t||"CI"!==e.flowContext.form.formType||(i.field=i.field.filter(function(t){return!["21","22"].includes(t.elementType)}));var o=i.field;return be(be({},i),{},{field:o.map(function(o){var r=Object(Ye.f)(o),a=r.isChange,s=r.curValue,l=o.value,h=o.defaultValue,c=ve(o,["value","defaultValue"]),u="T"===a?s:n[i.name][o.elementName];if(["4","7"].includes(o.elementType)&&u&&Array.isArray(u)&&(u=u.join(",")),!t&&["12","13"].includes(o.elementType)&&(u=u.filter(function(t){return t.action})),"TURN"===window.name&&["12","13"].includes(o.elementType)){var d=e.flowContext.flow,f=d.flowId,p=d.tchId;u.forEach(function(t){t.action="C",t.flowId=f,t.tchId=p,t.requestId=""})}return be(be({},c),{},{defaultValue:t?l:h,value:u})})})})},excMenuEvent:function(t){var e=this.$global(),i="label"===t.itemType?t.dynamicTextEvent:t.event;return Object(Ye.a)(i,e,this.workflowContext)},refreshNextTchData:function(){var t=this;this.getTchData().then(function(e){t.generateTchData(e)})},openFlowDialog:function(){function t(){return e.apply(this,arguments)}var e=me(Ue.a.mark(function t(){var e,i,n,o,r=this,a=arguments;return Ue.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e=!(a.length>0&&void 0!==a[0])||a[0],i=this.flowContext.flow,n=i.isHasBranch,o=i.suspend.state,!o||"apply"!==o){t.next=5;break}return this.$message.warning(this.t("workflow.hangupTip")),t.abrupt("return");case 5:"0BT"===n?this.$confirm("还有未完成的协办，是否继续下一环节?","提示",{confirmButtonText:"是",cancelButtonText:"返回",lockScroll:!1,type:"warning"}).then(function(){r.dealOpenFlowDialog(e)}):this.dealOpenFlowDialog(e);case 6:case"end":return t.stop()}},t,this)}));return t}(),dealOpenFlowDialog:function(t){var e=this,i=function(i){t&&(e.workflowDialogVisible=!0),e.generateTchData(i)},n=function(){e.hasAppend||e.$emit("onFormBeforeValid"),e.getTchData().then(function(n){if(n.tache.flowValidateMode.all)e.formRules=e.formContext.rules,e.formAppendRules=e.formContext.appendRules,e.formValidate(n,t);else{if(e.formRules={},e.formAppendRules={},!e.hasAppend&&e.onFormSubmit&&"function"==typeof e.onFormSubmit){var o=e.onFormSubmit("turn");if(o.then)return e.isOpening=!0,void o.then(function(t){e.isOpening=!1,t&&i(n)}).catch(function(){e.isOpening=!1});if(!o)return void(e.isOpening=!1)}i(n),e.isOpening=!1}}).catch(function(){e.isOpening=!1})};if(!this.isOpening){if(this.isOpening=!0,this.onClickBefore&&"function"==typeof this.onClickBefore){var o=this.onClickBefore();if(o.then)return this.isOpening=!0,void o.then(function(t){e.isOpening=!1,t&&n()}).catch(function(){e.isOpening=!1});if(!o)return void(this.isOpening=!1)}n()}},doSaveFlowForm:function(t,e,i){var n=this,o=function(){n.hasAppend||n.$emit("onFormBeforeValid"),n.workflowDialog.onSaveBtnClick(t,e,i)};this.workflowDialog.isSaving||(t?o():this.$refs.fiForm.validate(function(t,e){var i=[];if(n.formContext.tableFields.forEach(function(t){i.push(n.$parent.$refs[t].handlerTableData())}),i.length&&i.some(function(t){return!t}))return void n.$message.error(n.t("workflow.tableSaveTip"));t&&i?o():(n.isOpening=!1,Object(Xe.d)(e,n.fiFormParent.fields,50,document.querySelector(".fi-workflow-scoller")))}))},getTchData:function(){var t=this.flowContext.flow,e=t.flowMod,i=t.flowId,n=t.tchMod,o=t.tchId;return Object(Ze.z)({flowMod:e,flowId:i,tchMod:n,tchId:o,flowType:"all"})},formValidate:function(t){var e=this,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=function(){i&&(e.workflowDialogVisible=!0),e.generateTchData(t)};this.$refs.fiForm.validate(function(t,i){var o=[];if(e.formContext.tableFields.forEach(function(t){e.$parent.$refs[t]&&o.push(e.$parent.$refs[t].handlerTableData())}),o.length&&o.some(function(t){return!t}))return e.$message.error(e.t("workflow.tableSaveTip")),void(e.isOpening=!1);var r=[],a=[];Object.keys(e.formAppendRules).forEach(function(t){r.push(t)}),i&&Object.keys(i).forEach(function(t){a.push(t)});var s=a.filter(function(t){return!r.includes(t)});if(t||s.length||(t=!0),t&&o){if(!e.hasAppend&&e.onFormSubmit&&"function"==typeof e.onFormSubmit){var l=e.onFormSubmit("turn");if(l.then)return e.isOpening=!0,void l.then(function(t){e.isOpening=!1,t&&n()}).catch(function(){e.isOpening=!1});if(!l)return void(e.isOpening=!1)}n(),e.isOpening=!1}else e.isOpening=!1,Object(Xe.d)(i,e.fiFormParent.fields,50,document.querySelector(".fi-workflow-scoller"))})},generateTchData:function(){function t(t){return e.apply(this,arguments)}var e=me(Ue.a.mark(function t(e){var i,n,o;return Ue.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=pt(e),n=i.isSerialing,o=i.isParalleling,this.isParalleling=o,this.isSerialing=n,this.tacheRules=this.getTacheRules(e),this.tacheMoveRules=this.getTacheMoveRules(e.tache),t.next=7,dt(e,this.$global());case 7:this.tchData=t.sent,this.flowContext.flow.opinionCfg=this.tchData.opinionCfg;case 9:case"end":return t.stop()}},t,this)}));return t}(),doOpinion:function(){this.opinionCfg.append=!0,this.opinionCfg.show=!0},showApprove:function(){this.approve.show=!0,this.approve.visible=!0},flowToConfirm:function(t,e,i){var n=t.text||this.t("workflow.confirm_submit");t.isPrompt?this.$confirm(n,this.t("workflow.confirm_title"),{confirmButtonText:this.t("workflow.confirm_btn"),cancelButtonText:this.t("workflow.cancel_btn")}).then(function(){e(i)}).catch(function(){i.loading=!1}):e(i)},doAutoTurn:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=e.tchNum,n=e.auto;this.openFlowDialog(!1),this.unWatch=this.$watch("tchData",function(o){var r=o.opinionConfig&&o.opinionConfig.ready,a=o.nextTchReady&&(o.nextTchReady.all||o.nextTchReady.operator&&o.nextTchReady.cc);if(r&&a){if(e.loading=!1,i){var s=o.nextTchs.filter(function(t){return t.tchNum===i});if(!s.length)return console.error("找不到".concat(i,"环节")),void t.unWatch();o.selectedTchs=s}var l=o.selectedTchs.map(function(t){return t.operator.value.staff}).find(function(t){return!t.length});n&&!l?(t.workflowDialog.$refs.fiDialog.rendered=!0,t.$nextTick(function(){(0,t.workflowDialog.$refs.opinionRef.validate)()?t.workflowDialog.onSubmitBtnClick():t.workflowDialogVisible=!0})):t.workflowDialogVisible=!0,t.unWatch()}},{deep:!0})},getTacheRules:function(t){var e={},i=t.tache;return e.souces=i,e.cfg=i.tacheRulesCfg,e.nextCfg=i.nextTchMods.reduce(function(t,e){return t[e.tchMod]={cfg:e.tacheRulesCfg,tache:{tchNum:e.tchNum,tchMod:e.tchNum,staffId:"",action:e.tacheAction}},t},{}),e},getTacheMoveRules:function(t){var e=xe({},t.tchMod,t.tacheMoveCfg);return t.nextTchMods.forEach(function(t){e[t.tchMod]=t.tacheMoveCfg}),e},doFlowCanceNextTch:function(){var t=this.flowContext.flow.cancelPrivTchId;t>0&&this.$confirm(this.t("workflow.confirm_question"),this.t("workflow.confirm_title"),{confirmButtonText:this.t("workflow.confirm_btn"),cancelButtonText:this.t("workflow.cancel_btn")}).then(function(){Object(Ze.f)({cancelPrivTchId:t}).then(function(){window.location.reload()})})},doFlowAutoRead:function(){var t=this,e=this.flowContext.flow.flowId,i=Object(Xe.c)(window.location.search),n=i.tchId,o={flowId:e,tchId:n};Object(Ze.m)(o).then(function(){t.$message({showClose:!0,message:t.t("workflow.read"),type:"success",offset:60,duration:1e3,onClose:function(){-1!==navigator.userAgent.indexOf("Firefox")||-1!==navigator.userAgent.indexOf("Chrome")?(window.location.href="about:blank",window.close()):(window.opener=null,window.open("","_self",""),window.close()),setTimeout(function(){location.reload()},100)}})})},receiving:function(){this.flowContext.flow.tchStatus="C",this.fiForm.global$.flow.tchStatus="C",this.refreshMenu(),this.$emit("received")},receivingPool:function(){var t=this,e=this.flowContext.flow.tchId;Object(Ze.k)(e).then(function(){t.flowContext.flow.tchStatus="C",t.fiForm.global$.flow.tchStatus="C",t.refreshMenu(),t.$emit("poolReceived")})},releasingPool:function(){var t=this,e=this.flowContext.flow.tchId;Object(Ze.g)(e).then(function(){t.flowContext.flow.tchStatus="A",t.fiForm.global$.flow.tchStatus="A",t.refreshMenu(),t.$emit("poolCancelReceived")})},addFlowAttention:function(){var t=this,e=this.flowContext.flow.flowId;Object(Ze.a)({flowId:e}).then(function(){t.flowContext.flow.isAttention="1",t.fiForm.global$.flow.isAttention="1",t.refreshMenu(),t.$message.success("关注成功"),t.$emit("addFlowAttention")})},delFlowAttention:function(){var t=this,e=this.flowContext.flow.flowId;Object(Ze.i)({flowId:e}).then(function(){t.flowContext.flow.isAttention="0",t.fiForm.global$.flow.isAttention="0",t.$message.success("已取消关注"),t.refreshMenu(),t.$emit("delFlowAttention")})},refreshMenu:function(){this.menu=d(He()(this.initialData.menu),this.workflowContext,this.$global())},showTogetherWork:function(){this.togetherWork.show=!0,this.togetherWork.visible=!0},showTogetherWorkDetail:function(){this.togetherWorkDetail.show=!0,this.togetherWorkDetail.visible=!0},getJsSourceByLang:function(t){var e=this,i=this.$i18n&&this.$i18n.locale||"zh-CN";Object(Ze.x)({type:i,formId:t}).then(function(t){e.fiForm.langDataVal=t})},formFieldTurn:function(){function t(t,i){return e.apply(this,arguments)}var e=me(Ue.a.mark(function t(e,i){var n,o,r,a,s,l,h,c,u,d,f,p,g,_,m,v,y,w,b,x,A,C,T=this,k=arguments;return Ue.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=k.length>2&&void 0!==k[2]?k[2]:"form","CONFIG_TURN"!==(o=window.name)){t.next=13;break}return r=window.opener.window,a=r.mainFlow,s=r.mainFormId,l=r.mainRequestId,h=this.flowContext.form.formId,c={domainType:1,requestId:l,mainFormId:s,subFormId:h},t.next=8,Object(Ze.v)(c);case 8:u=t.sent,d=u[0],f=d.tableNameMain,p=d.tableNameSub,g=d.formFieldTurns,g.forEach(function(t){var e=T.model[p]?T.model[p]:T.model,i=a[f]?a[f]:a;t.attaches?e[t.elementNameSub]=t.attaches.map(function(t){return t.action="C",t.response={requestId:t.requestId},t.toDir="form",t}):e[t.elementNameSub]=i[t.elementNameMain]}),t.next=14;break;case 13:"0N"===o?(_=["CUR_DATE","FLOW_ID","WORKFLOW_PROCESS","REQUEST_ID","STAFF_NAV_INFO","STAFF_NAME","ORG_NAME","STAFF_MOBILE","REGION_NAME","ADVICE_SUGGESTION"],m=JSON.parse(sessionStorage.getItem("historyTable")),v=e.table,y=e.context,w=y.flowId,b=y.tchId,v.forEach(function(t,e){t.field.forEach(function(t){if(!_.includes(t.fieldName)){var i=m[e].field.find(function(e){return e.fieldName===t.fieldName});i&&(t.value=i.value)}"12"===t.elementType&&t.value.length&&t.value.forEach(function(t){t.action="C",t.flowId=w,t.tchId=b,t.requestId=""}),"ORDER_NUM"===t.fieldName&&(t.value+="_0N")})}),this.initFormData(e,i)):"TURN"===o&&(x=["CUR_DATE","FLOW_ID","WORKFLOW_PROCESS","REQUEST_ID","STAFF_NAV_INFO","STAFF_NAME","ORG_NAME","STAFF_MOBILE","REGION_NAME","ADVICE_SUGGESTION"],A=JSON.parse(sessionStorage.getItem("mainFlow")),C=[],Object.keys(this.formContext.tableMap).forEach(function(t){C.push(t)}),1===C.length?Object.keys(this.$parent[n]).forEach(function(t){t in A&&!x.includes(t)?T.$parent[n][t]=A[t]:t in A||console.error("父表单中匹配不到字段")}):C.forEach(function(t){Object.keys(T.$parent[n][t]).forEach(function(e){e in A[t]&&!x.includes(e)?T.$parent[n][t][e]=A[t][e]:e in A[t]||console.error("父表单中匹配不到字段")})}));case 14:case"end":return t.stop()}},t,this)}));return t}(),orderReassign:function(){function t(){return e.apply(this,arguments)}var e=me(Ue.a.mark(function t(){var e,i,n,o,r,a,s,l;return Ue.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.flowContext.flow,i=e.flowMod,n=e.flowId,o=e.tchId,r=this.model.REQUEST_ID,a={flowMod:i,flowId:n,tchId:o},t.next=5,Object(Ze.s)(a);case 5:return s=t.sent,t.next=8,Object(Ze.E)(i);case 8:l=t.sent,sessionStorage.setItem("historyTable",JSON.stringify(s.table)),sessionStorage.setItem("mainRequestId",r),window.open(l,"0N");case 12:case"end":return t.stop()}},t,this)}));return t}(),addHangUp:function(){this.hangUpDetail.show=!0,this.hangUpDetail.visible=!0},cancelHangUp:function(){var t=this;this.$confirm("是否取消挂起?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.cancel()}).catch(function(){})},getHangUpStatue:function(t){this.hangUpDetail.show=!1,this.hangUpDetail.visible=!1,"2"===t&&(this.hangUpMsgState=!1),setTimeout(function(){window.location.reload()},1e3)},cancel:function(){function t(){return e.apply(this,arguments)}var e=me(Ue.a.mark(function t(){var e,i,n;return Ue.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.flowContext.flow.suspend.flowSuspendApplyId,i={flowSuspendApplyId:e,cancelTime:Object(Xe.e)(new Date,"YYYY-MM-DD hh:mm:ss"),state:"cancel"},t.next=4,Object(Ze.e)(i);case 4:n=t.sent,0===Number(n.code)&&(this.$message.success(n.msg),setTimeout(function(){window.location.reload()},1e3));case 6:case"end":return t.stop()}},t,this)}));return t}(),initHangUpState:function(){var t=this.flowContext.flow,e=t.flowId,i=t.tchMod,n=t.tchId,o=this.flowContext.flow.suspend,r=o.flowSuspendApplyId,a=o.state,s=o.approveStaffId,l=this.flowContext.global,h=l.staffId,c=l.staffName;this.hangData.global={staffId:h,staffName:c,flowId:e,tchId:n,tchMod:i,flowSuspendApplyId:r},"apply"===a&&s.split(",").includes(h)?(this.hangUpMsgState=!0,this.hangData.state=!0):this.hangData.state=!1},toPdf:function(){function t(t){return e.apply(this,arguments)}var e=me(Ue.a.mark(function t(e){var i,n,o,r,a,s,l;return Ue.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=qe.a.defaults.baseURL?qe.a.defaults.baseURL:"",n=this.fiForm.global$,o={flowFormJson:n,menuItemId:e},t.next=5,Object(Ze.F)(o);case 5:r=t.sent,a="".concat(this.fiForm.global$.flow.flowName,".pdf"),s="".concat(i,"/flow/downFile"),l="".concat(s,"?filename=").concat(window.encodeURIComponent(a),"&pathname=").concat(window.encodeURIComponent(r)),document.getElementById("download").src=l;case 10:case"end":return t.stop()}},t,this)}));return t}(),toWord:function(){function t(t){return e.apply(this,arguments)}var e=me(Ue.a.mark(function t(e){var i,n,o,r,a,s,l;return Ue.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=qe.a.defaults.baseURL?qe.a.defaults.baseURL:"",n=this.fiForm.global$,o={flowFormJson:n,menuItemId:e},t.next=5,Object(Ze.G)(o);case 5:r=t.sent,a="".concat(this.fiForm.global$.flow.flowName,".doc"),s="".concat(i,"/flow/downFile"),l="".concat(s,"?filename=").concat(window.encodeURIComponent(a),"&pathname=").concat(window.encodeURIComponent(r)),document.getElementById("download").src=l;case 10:case"end":return t.stop()}},t,this)}));return t}()}},ko=To,So=At(ko,Fe,ze,!1,null,null,null),Eo=So.exports;Eo.install=function(t){t.component(Eo.name,Eo)};var Io=Eo,Lo=function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.isShow?i("fmd-flow-model",{staticClass:"fi-workflow-flow-model",attrs:{"flow-mod":t.flowMod,"flow-id":t.flowId}}):t._e()},Ro=[],Po={name:"FiWorkflowFlowModel",inject:{fiWorkflow:{default:""}},props:{urlParam:Boolean},data:function(){return{unWatch:void 0,flowMod:"",flowId:""}},computed:{isShow:function(){return this.flowMod&&this.flowId}},created:function(){this.refresh()},methods:{refresh:function(){var t,e=this;if(this.urlParam){var i=Object(Xe.c)(window.location.search),n=i.flowId,o=i.flowMod;this.flowMod=o,this.flowId=n,t=!0}if(!t&&this.fiWorkflow){if(!this.fiWorkflow.dataReady)return void(this.unWatch=this.$watch("fiWorkflow.dataReady",function(){e.refresh(),e.unWatch()}));var r=this.fiWorkflow.flowContext.flow,a=r.flowId,s=r.flowMod;this.flowMod=s,this.flowId=a,t=!0}}}},Oo=Po,Do=At(Oo,Lo,Ro,!1,null,null,null),Mo=Do.exports;Mo.install=function(t){t.component(Mo.name,Mo)};var No=Mo;rn.install=function(t){t.component(rn.name,rn)};var Bo=rn;Ti.install=function(t){t.component(Ti.name,Ti)};var Fo=Ti,zo=function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.isShow&&t.isAppendShow?i(t.tag,t._g(t._b({tag:"component",staticClass:"fi-append-div"},"component",t.$attrs,!1),t.$listeners),[t._t("default")],2):t._e()},Vo=[],Uo={name:"FiAppendDiv",inject:{elForm:{default:""}},props:{prop:{type:String},appendShow:Boolean,tag:{type:String,default:"fi-row"}},computed:{attr:function(){var t=this.elForm?this.elForm.fiAttrs||{}:{};if(this.prop){var e=this.prop.split(".");return 1===e.length?t[this.prop]:t[e[0]]?t[e[0]][e[1]]:void 0}},fieldFormat:function(){return this.attr?this.attr.fieldFormat:void 0},options:function(){return this.attr?this.attr.options:[]},disabled:function(){return!!this.attr&&this.attr.disabled},itemLabel:function(){return this.attr?this.label||this.attr.label:this.label},isShow:function(){return!this.attr||this.attr.isShow},isFiAppend:function(){return!(!this.elForm||!this.elForm.append)&&this.getAppendByProp()},isFiAppendHide:function(){return this.elForm&&!this.elForm.append||this.elForm&&this.elForm.append&&void 0===this.getAppendByProp()},isAppend:function(){return!!this.attr&&this.attr.isAppend},isAppendShow:function(){return(!this.isAppend||this.appendShow||this.isFiAppend)&&!this.isFiAppendHide}},methods:{getAppendByProp:function(){var t=this.prop.split(".");return 1===t.length?this.elForm.append[this.prop]:this.elForm.append[t[0]]?this.elForm.append[t[0]][t[1]]:void 0}}},jo=Uo,Ho=At(jo,zo,Vo,!1,null,null,null),Wo=Ho.exports;Wo.install=function(t){t.component(Wo.name,Wo)};var Go=Wo,Zo=function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.showFormApprove?i("fi-form-card",{staticClass:"fi-workflow-form-approve",attrs:{label:t.label,anchor:t.anchor}},[t.dataReady?i("fi-form",{attrs:{model:t.tchData,"label-width":t.labelWidth}},[i("fi-row",[i("fi-form-item",{attrs:{label:"审批结论",rules:[{required:!0,message:"处理人不能为空",trigger:"blur"}]}},[t.tchData.opinionCfg.display?i("fi-radio-group",{on:{change:t.onOpinionChange},model:{value:t.tchData.opinionCfg.selected,callback:function(e){t.$set(t.tchData.opinionCfg,"selected",e)},expression:"tchData.opinionCfg.selected"}},t._l(t.tchData.opinionCfg.items,function(e,n){return i("fi-radio",{key:n,attrs:{label:e.value}},[t._v("\n            "+t._s(e.text)+"\n          ")])}),1):t._e()],1)],1),i("fi-row",[i("fi-form-item",{attrs:{label:"下一环节",rules:[{required:!0}]}},[i("fi-radio-group",{model:{value:t.nextTchSelected[0],callback:function(e){t.$set(t.nextTchSelected,0,e)},expression:"nextTchSelected[0]"}},t._l(t.tchData.nextTchs,function(e){return i("fi-radio",{key:e.tchMod,attrs:{label:e},nativeOn:{change:function(i){return t.getInfo(e)}}},[t._v(t._s(e.endTask?t.tchData.endTaskTitle:e.displayTchName))])}),1)],1)],1),i("fi-row",[i("fi-form-item",{attrs:{label:"审批意见",rules:[{required:!0}]}},[i("fi-input",{attrs:{type:"textarea",autosize:t.autoSize},model:{value:t.opinion,callback:function(e){t.opinion=e},expression:"opinion"}})],1)],1),t.operatorReady?i("fi-row",[t._l(t.tchData.nextTchs,function(e){return[e.endTask?t._e():i("div",{directives:[{name:"show",rawName:"v-show",value:t.nextTchSelected.length&&t.nextTchSelected[0].tchMod===e.tchMod,expression:"nextTchSelected.length && nextTchSelected[0].tchMod === tch.tchMod"}],key:e.tchMod},[i("fi-form-item",{attrs:{label:"处理人",rules:[{required:!0,message:"处理人不能为空",trigger:"blur"}]}},[i("fi-workflow-staff-picker",{attrs:{multiple:"",disabled:!1,config:e.operator.staffCfg},model:{value:e.operator.value.staff,callback:function(i){t.$set(e.operator.value,"staff",i)},expression:"tch.operator.value.staff"}})],1),i("fi-form-item",{staticClass:"fi-workflow-form-approve__remind",attrs:{label:"提醒方式"}},[e.operator.noticeCfg.display?i("div",{staticClass:"remind_type"},[e.operator.noticeCfg.mail.display?i("fi-checkbox",{attrs:{"true-label":"1","false-label":"0",disabled:e.operator.noticeCfg.mail.disabled,group:!1},model:{value:e.operator.value.sendMail,callback:function(i){t.$set(e.operator.value,"sendMail",i)},expression:"tch.operator.value.sendMail"}},[t._v("邮件")]):t._e(),e.operator.noticeCfg.sms.display?i("fi-checkbox",{attrs:{"true-label":"1","false-label":"0",disabled:e.operator.noticeCfg.sms.disabled,group:!1},model:{value:e.operator.value.sendSms,callback:function(i){t.$set(e.operator.value,"sendSms",i)},expression:"tch.operator.value.sendSms"}},[t._v("短信")]):t._e(),[i("fi-switch",{staticClass:"remind_switch",attrs:{type:"inside","active-text":"是","inactive-text":"否"},on:{change:function(i){return t.isCustomNotifyChange(e,e.operator.noticeCfg.isCustomNotify)}},model:{value:e.operator.noticeCfg.isCustomNotify,callback:function(i){t.$set(e.operator.noticeCfg,"isCustomNotify",i)},expression:"tch.operator.noticeCfg.isCustomNotify"}}),i("fi-input",{directives:[{name:"show",rawName:"v-show",value:e.operator.noticeCfg.isCustomNotify,expression:"tch.operator.noticeCfg.isCustomNotify"}],attrs:{placeholder:t.notifyPlaceholder,maxlength:140},model:{value:e.operator.value.notifyContent,callback:function(i){t.$set(e.operator.value,"notifyContent",i)},expression:"tch.operator.value.notifyContent"}})]],2):t._e()])],1)]})],2):t._e(),t.tchData.dialogStyle&&t.tchData.dialogStyle.showAttach?i("fi-form-item",{attrs:{label:"附件",rules:[{required:!1}]}},[i("fi-workflow-upload",{attrs:{flow:""},model:{value:t.attaches,callback:function(e){t.attaches=e},expression:"attaches"}})],1):t._e()],1):t._e()],1):t._e()},Xo=[],Yo={name:"FiWorkflowFormApprove",inject:["fiWorkflow","getGlobal"],props:{anchor:String,label:{type:String,default:"处理意见"},labelWidth:{type:String,default:"100px"},notifyPlaceholder:{type:String,default:"xx工单“xxx内容”,请您及时督促处理 xx部门 xx人 x年x月x日"},autoSize:Object},data:function(){return{dataReady:!1,tchData:{},attaches:[],opinionCache:"",count:0}},computed:{opinion:{get:function(){if(!this.tchData.opinionConfig.default&&this.fiWorkflow.opinion){var t=this.fiWorkflow.opinion;return"function"==typeof t?t():t}return this.opinionCache?this.opinionCache:this.tchData.opinionConfig.default},set:function(t){this.tchData.opinionConfig.default=t,this.opinionCache=t}},nextTchSelected:{get:function(){return this.tchData.selectedTchs},set:function(t){this.tchData.selectedTchs=t}},operatorReady:function(){return this.tchData.nextTchReady&&(this.tchData.nextTchReady.all||this.tchData.nextTchReady.operator)},showFormApprove:function(){return!!this.workflowDataReady&&(this.fiWorkflow.workflowContext.isFormModel()&&!this.fiWorkflow.workflowContext.isEnableForword()&&!this.fiWorkflow.workflowContext.isFlowBegin())},workflowDataReady:function(){return this.fiWorkflow.dataReady},nextTchSelectedNoEndTask:function(){return this.tchData.selectedTchs&&this.tchData.selectedTchs[0]&&this.tchData.selectedTchs[0].endTask?[]:this.tchData.selectedTchs}},watch:{showFormApprove:function(t){t&&this.getNextData()}},created:function(){},mounted:function(){},methods:{getNextData:function(){function t(){return e.apply(this,arguments)}var e=Oe(Ue.a.mark(function t(){var e,i,n,o,r,a;return Ue.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.fiWorkflow.flowContext.flow,i=e.flowMod,n=e.flowId,o=e.tchMod,r=e.tchId,t.next=3,Object(Ze.z)({flowMod:i,flowId:n,tchMod:o,tchId:r,flowType:"all"});case 3:a=t.sent,this.fiWorkflow.generateTchData(a),this.tchData=this.fiWorkflow.tchData,this.dataReady=!0,this.initStatus();case 8:case"end":return t.stop()}},t,this)}));return t}(),getInfo:function(t){var e=this.getGlobal();e.nextItemTchMod=t.tchMod,$(this.tchData.nextTchMods.find(function(e){return e.tchMod===t.tchMod}),t,e,this.tchData)},initStatus:function(){this.tchData.opinionConfig.default||this.changeOpinionContent(this.tchData.opinionCfg.selected),this.fiWorkflow.workflowContext.setFormApproveContext(this)},changeOpinionContent:function(t){var e=this.tchData.opinionCfg.items.filter(function(e){return e.value===t});this.opinion=1===e.length?e[0].text:this.opinion},onOpinionChange:function(t){this.tchData.opinionCfg.refresh&&this.getNextData(),this.changeOpinionContent(t)},isCustomNotifyChange:function(t,e){e&&(t.operator.value.sendSms="1"),e||(t.operator.value.notifyContent="")},validNextTchMods:function(){var t=this,e=this.nextTchSelected,i=function(e){return t.$message({showClose:!0,message:e,type:"error"}),!1},n="";if(!this.tchData.isRelateTchClosed&&e[0].endTask)return!0;if(!e.length)return n="请选择下一环节",i(n);if(!e[0].notEnd)return!0;var o=e.find(function(t){return!t.operator.value.staff.length});if(o)return n="请选择 [".concat(o.info.tchName,"] 环节的执行人"),i(n);var r=e.find(function(t){return t.operator.noticeCfg.isCustomNotify&&!t.operator.value.notifyContent});return!r||(n="[".concat(r.info.tchName,"] 环节的自定义短信内容不能为空"),i(n))},getSelectedTacheInfo:function(){var t={tchNum:[],tchMod:[],staffId:[],action:[],notifyContent:[]};return this.tchData&&this.nextTchSelectedNoEndTask&&this.nextTchSelectedNoEndTask.reduce(function(t,e){return t.tchNum.push(e.tchNum),t.tchMod.push(e.tchMod),t.action.push(e.tacheAction),t.notifyContent.push(e.operator.value.notifyContent),e.operator&&t.staffId.push(e.operator.value.staff),t},t),Object.keys(t).forEach(function(e){if("staffId"===e){var i=t[e].reduce(function(t,e){return t.push(e.map(function(t){return t.staffId}).join(",")),t},[]);t[e]=i.join("|")}else t[e]="notifyContent"===e?t[e].join("@@"):t[e].join(",")}),t},createFormParam:function(){var t=this.fiWorkflow.$global();t.tache=this.getSelectedTacheInfo();var e=this.fiWorkflow.createTable(),i=this.fiWorkflow.flowContext,n=i.flow,o=i.form,r=i.global,a=o.formCfg?{}:null;return a&&Object.keys(o.formCfg).forEach(function(e){a[e]=o.formCfg[e].map(function(e){var i=e.type,n=e.event,o={template:n,type:i,$global:t};return Object(Ye.e)(o)})}),{flow:n,prop:o.formProp,action:o.formAction,appName:"flow",formId:o.formId,globalVar:r,table:e,formCfg:a}},createNextTchModsParam:function(t){return this.nextTchSelectedNoEndTask.reduce(function(e,i){var n=i.tchMod,o=i.tchNum,r=i.tacheAction,a=i.operator.value.notifyContent,s=i.info,l=s.onAfterCreate,h=s.onAfterCreateType,c=i.operator.value.staff.reduce(function(t,e){if(e.staffId.includes(",")){var i=e.orgIdSplit,n=void 0===i?"":i,o=e.staffId,r=void 0===o?"":o,a=e.staffName,s=n.split("|");r.split(",").forEach(function(e,i){t.push({staffId:e,orgId:s[i],staffName:a})})}else t.push(e);return t},[]),u=Object.assign({},t,{tache:{tchNum:o,tchMod:n,action:r,notifyContent:a}}),d={template:l,type:h,$global:u,key:"onAfterCreate"},f={tchDesc:i.info.tchName,isSendNMail:i.cc.value.sendMail,isSendNSms:i.cc.value.sendSms,isSendSms:i.operator.value.sendSms,isSendMail:i.operator.value.sendMail,notifyContent:i.operator.value.notifyContent,tchMod:n,notifyStaffs:i.cc.value.staff.map(function(t){return t.staffId}).join(","),onAfterCreate:"js"===h?void 0:Object(Ye.e)(d),serialStaff:""};if("parallel"===i.operator.value.countersignValue)c.forEach(function(t){e.push(Le(Le({},f),{},{nextStaff:t.staffId,nextGroup:t.orgId}))});else{var p=c.reduce(function(t,e){return t.nextStaff.push(e.staffId),t.nextGroup.push(e.orgId),t},{nextStaff:[],nextGroup:[]}),g=p.nextStaff,_=p.nextGroup,m=_.join(",").split(",");"serial"===i.operator.value.countersignValue?e.push(Le(Le({},f),{},{nextStaff:g[0],serialStaff:g.join(","),nextGroup:Ae(new Set(m)).join(",")})):e.push(Le(Le({},f),{},{nextStaff:g.join(","),nextGroup:Ae(new Set(m)).join(",")}))}return e},[])},createFlowParam:function(){var t=this.fiWorkflow.$global();t.tache=this.getSelectedTacheInfo();var e=t.flow,i=t.globalVar,n=this.attaches,o=this.tchData.info,r=o.onAfterFinish,a=o.onAfterFinishType,s={template:r,type:a,$global:t,key:"onAfterFinish"},l="js"===a?null:Object(Ye.e)(s),h=this.createNextTchModsParam(t);return{curTchId:e.tchId,isSuperControl:0,todir:"flow",attaches:n,flowId:e.flowId,flowName:e.flowName,curTchContent:this.opinion,flowMod:e.flowMod,staffId:i.staffId,onAfterFinish:l,nextTchMods:h}},doAfterSubmitCallBack:function(){var t=Object(Xe.c)(window.location.search).callback;return!(window.opener&&"refresh"===t&&!window.opener.closed)||(window.opener.name="refresh",window.opener.postMessage("refresh","*")||!0)},afterSave:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"提交成功",e=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0;this.$message({showClose:!0,message:t,type:"success",offset:60,duration:1e3,onClose:function(){e?i&&i(n):(window.close(),setTimeout(function(){location.reload()},100))}})},doSubmit:function(){var t=this;if(!this.opinion)return void this.$message({type:"error",message:"审批意见不能为空"});var e=this.validNextTchMods;if(function(){return t.opinion}()&&e()&&0===this.count){var i=this.fiWorkflow.$global(),n=this.tchData.info,o=n.onFinish,r=n.onFinishType;i.tache=this.getSelectedTacheInfo();var a={template:o,type:r,$global:i,key:"onFinish",nullValue:!0};Object(Ye.c)(a).then(function(e){if(e){var n=t.nextTchSelectedNoEndTask.map(function(t){var e=t.info,n=e.onCreate,o=e.onCreateType,r=e.tchNum,a=e.tchMod,s=e.tacheAction;i.nextItemTchMod=t.tchMod;var l=t.operator.value.notifyContent,h=Object.assign({},i,{tache:{tchNum:r,tchMod:a,action:s,notifyContent:l}}),c={template:n,type:o,$global:h,key:"onCreate",nullValue:!0};return Object(Ye.c)(c)});Promise.all(n).then(function(e){if(!e.some(function(t){return!t})){var n={form:t.createFormParam(),tache:t.createFlowParam()};t.count++,Object(Ze.I)(n).then(function(){var e=t.tchData.info,o=e.onAfterFinish,r=e.onAfterFinishType;i.nextItemTchMod="";var a={template:o,type:r,$global:i,key:"onAfterFinish"};Object(Ye.d)(a),(n.tache.nextTchMods||[]).forEach(function(e){var n=t.tchData.nextTchMap[e.tchMod],o=n.info,r=o.onAfterCreate,a=o.onAfterCreateType,s=o.tchNum,l=o.tchMod,h=o.tacheAction;i.nextItemTchMod=n.tchMod;var c=Object.assign({},i,{tache:{tchNum:s,tchMod:l,action:h,staffId:n.operator.value.staff.map(function(t){return t.staffId}).join(","),notifyContent:n.operator.value.notifyContent}}),u={template:r,type:a,$global:c,key:"onAfterCreate"};"js"===a&&Object(Ye.d)(u)}),t.afterSave(),t.doAfterSubmitCallBack()}).catch(function(){})}}).catch(function(){})}}).catch(function(){})}}}},$o=Yo,qo=At($o,Zo,Xo,!1,null,null,null),Ko=qo.exports;Ko.install=function(t){t.component(Ko.name,Ko)};var Jo=Ko,Qo=(i("b20f"),function(){var t=i("4790"),e={};return t.keys().forEach(function(i){var n=i.match(/([A-Za-z0-9-_]+)\./i);if(n&&n.length>1){var o=n[1];e[o]=t(i).default}}),e}()),tr=[Io,Mi,Gn,Dn,In,wn,gn,cn,No,Bo,Li,Fo,Go,Jo];Be.i18n4Lib.use({messages:Qo,local:"zh-CN"});var er=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Be.i18n4Lib.use(e.i18n||{messages:Qo,local:"zh-CN"});var i=e.ApiBaseUrl||"";qe.a.defaults.baseURL=i,t.use(Ne.a,{baseUrl:i}),tr.map(function(e){return t.component(e.name,e)})};"undefined"!=typeof window&&window.Vue&&er(window.Vue);var ir={version:"1.14.1",install:er,Workflow:Io,WorkflowBar:Mi,WorkflowDialog:Gn,WorkflowFlowOpinion:Dn,WorkflowOpinionConsole:In,WorkflowTchPanel:wn,WorkflowTchSelector:gn,WorkflowTchSelectorItem:cn,WorkflowFlowModel:No,WorkflowStaffPicker:Bo,WorkflowMenu:Li,WorkflowMenuItem:Fo,StaffSelect:Qi,AppendDiv:Go,WorkflowFormApprove:Jo};e.default=ir},fba5:function(t,e,i){function n(t){return o(this.__data__,t)>-1}var o=i("cb5a");t.exports=n}}).default},function(t,e,i){t.exports=i(0)(162)},function(t,e,i){t.exports=i(0)(78)},function(t,e,i){t.exports=i(0)(2)},function(t,e){}]);